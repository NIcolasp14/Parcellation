nohup: ignoring input
============================================================================
Testing 20-View Conditioned Model
============================================================================
Model: /autofs/space/ballarat_004/users/np341/PRIR_Code/Training/White/Models_WM_Conditioned_V2_20views_7785741
Test data: /autofs/space/ballarat_004/users/np341/mindboggle2
Device: cuda:0
Log file: test_20views_20260204_001356.log
============================================================================
[GPU] PyTorch3D loaded - GPU raycasting AVAILABLE (FAST MODE: bin_size=None)
[GPU] PyTorch3D loaded - GPU raycasting AVAILABLE (will be enabled via --raycasting arg)
Auto-detected latest checkpoint: last.ckpt

Loading model from: /autofs/space/ballarat_004/users/np341/PRIR_Code/Training/White/Models_WM_Conditioned_V2_20views_7785741/last.ckpt
✓ Model loaded (using TRAIN mode due to corrupted BN running stats)

================================================================================
Testing VIEW-CONDITIONED model V2 with PyTorch3D pipeline
Checkpoint: /autofs/space/ballarat_004/users/np341/PRIR_Code/Training/White/Models_WM_Conditioned_V2_20views_7785741/last.ckpt
Test data: /autofs/space/ballarat_004/users/np341/mindboggle2
1. Generate predictions using V2 model (one-hot view encoding)
2. Iterative smoothing (α=0.75, 20 iter)
3. MRF with ICM (β=0.1)
================================================================================

Found 101 test subjects

================================================================================
Subject: Afterthought-1
================================================================================
  Step 0: Generating predictions with V2 model...
  Mesh: 130921 vertices, 261838 faces
  Rendering and predicting ALL 20 views...
    ✓ Front (view_id=0): shape (37, 800, 800)
    ✓ Back (view_id=1): shape (37, 800, 800)
    ✓ Left (view_id=2): shape (37, 800, 800)
    ✓ Right (view_id=3): shape (37, 800, 800)
    ✓ Top (view_id=4): shape (37, 800, 800)
    ✓ Bottom (view_id=5): shape (37, 800, 800)
    ✓ FrontLeft (view_id=6): shape (37, 800, 800)
    ✓ FrontRight (view_id=7): shape (37, 800, 800)
    ✓ BackLeft (view_id=8): shape (37, 800, 800)
    ✓ BackRight (view_id=9): shape (37, 800, 800)
    ✓ TopFront (view_id=10): shape (37, 800, 800)
    ✓ TopBack (view_id=11): shape (37, 800, 800)
    ✓ TopLeft (view_id=12): shape (37, 800, 800)
    ✓ TopRight (view_id=13): shape (37, 800, 800)
    ✓ BottomFront (view_id=14): shape (37, 800, 800)
    ✓ BottomBack (view_id=15): shape (37, 800, 800)
    ✓ BottomLeft (view_id=16): shape (37, 800, 800)
    ✓ BottomRight (view_id=17): shape (37, 800, 800)
    ✓ LeftTop (view_id=18): shape (37, 800, 800)
    ✓ RightTop (view_id=19): shape (37, 800, 800)
  ✓ Predictions from all 20 views aggregated
    P stats: min=0.0000, max=1.0000, mean=0.0251
    Non-zero vertices: 121819/130921
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 9102 1280 1073 3865    0 2000 1046 4061 6273]
  Ground Truth Stats:
    Labels shape: (130921,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/Afterthought-1/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.8164
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8732
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8734

  RESULTS:
  RAW:         median(top-10)=0.9246, mean(top-10)=0.9281, median(all)=0.8793, mean(all)=0.8164
  + SMOOTHING: median(top-10)=0.9502, mean(top-10)=0.9495, median(all)=0.9192, mean(all)=0.8732 [+0.0256]
  + MRF:       median(top-10)=0.9501, mean(top-10)=0.9496, median(all)=0.9194, mean(all)=0.8734 [-0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0255

================================================================================
Subject: Colin27-1
================================================================================
  Step 0: Generating predictions with V2 model...
  Mesh: 182414 vertices, 364824 faces
  Rendering and predicting ALL 20 views...
    ✓ Front (view_id=0): shape (37, 800, 800)
    ✓ Back (view_id=1): shape (37, 800, 800)
    ✓ Left (view_id=2): shape (37, 800, 800)
    ✓ Right (view_id=3): shape (37, 800, 800)
    ✓ Top (view_id=4): shape (37, 800, 800)
    ✓ Bottom (view_id=5): shape (37, 800, 800)
    ✓ FrontLeft (view_id=6): shape (37, 800, 800)
    ✓ FrontRight (view_id=7): shape (37, 800, 800)
    ✓ BackLeft (view_id=8): shape (37, 800, 800)
    ✓ BackRight (view_id=9): shape (37, 800, 800)
    ✓ TopFront (view_id=10): shape (37, 800, 800)
    ✓ TopBack (view_id=11): shape (37, 800, 800)
    ✓ TopLeft (view_id=12): shape (37, 800, 800)
    ✓ TopRight (view_id=13): shape (37, 800, 800)
    ✓ BottomFront (view_id=14): shape (37, 800, 800)
    ✓ BottomBack (view_id=15): shape (37, 800, 800)
    ✓ BottomLeft (view_id=16): shape (37, 800, 800)
    ✓ BottomRight (view_id=17): shape (37, 800, 800)
    ✓ LeftTop (view_id=18): shape (37, 800, 800)
    ✓ RightTop (view_id=19): shape (37, 800, 800)
  ✓ Predictions from all 20 views aggregated
    P stats: min=0.0000, max=1.0000, mean=0.0245
    Non-zero vertices: 165122/182414
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 17292  1881  1676  4535     0  2473  1425  5633  8894]
  Ground Truth Stats:
    Labels shape: (182414,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/Colin27-1/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7807
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8522
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8525

  RESULTS:
  RAW:         median(top-10)=0.9035, mean(top-10)=0.9099, median(all)=0.8434, mean(all)=0.7807
  + SMOOTHING: median(top-10)=0.9385, mean(top-10)=0.9378, median(all)=0.9023, mean(all)=0.8522 [+0.0350]
  + MRF:       median(top-10)=0.9390, mean(top-10)=0.9380, median(all)=0.9023, mean(all)=0.8525 [+0.0005]
  TOTAL IMPROVEMENT (median top-10): +0.0355

================================================================================
Subject: HLN-12-1
================================================================================
  Step 0: Generating predictions with V2 model...
  Mesh: 138729 vertices, 277454 faces
  Rendering and predicting ALL 20 views...
    ✓ Front (view_id=0): shape (37, 800, 800)
    ✓ Back (view_id=1): shape (37, 800, 800)
    ✓ Left (view_id=2): shape (37, 800, 800)
    ✓ Right (view_id=3): shape (37, 800, 800)
    ✓ Top (view_id=4): shape (37, 800, 800)
    ✓ Bottom (view_id=5): shape (37, 800, 800)
    ✓ FrontLeft (view_id=6): shape (37, 800, 800)
    ✓ FrontRight (view_id=7): shape (37, 800, 800)
    ✓ BackLeft (view_id=8): shape (37, 800, 800)
    ✓ BackRight (view_id=9): shape (37, 800, 800)
    ✓ TopFront (view_id=10): shape (37, 800, 800)
    ✓ TopBack (view_id=11): shape (37, 800, 800)
    ✓ TopLeft (view_id=12): shape (37, 800, 800)
    ✓ TopRight (view_id=13): shape (37, 800, 800)
    ✓ BottomFront (view_id=14): shape (37, 800, 800)
    ✓ BottomBack (view_id=15): shape (37, 800, 800)
    ✓ BottomLeft (view_id=16): shape (37, 800, 800)
    ✓ BottomRight (view_id=17): shape (37, 800, 800)
    ✓ LeftTop (view_id=18): shape (37, 800, 800)
    ✓ RightTop (view_id=19): shape (37, 800, 800)
  ✓ Predictions from all 20 views aggregated
    P stats: min=0.0000, max=0.9999, mean=0.0251
    Non-zero vertices: 129014/138729
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 9715 1234 1238 3377    0 2007 1272 5135 6943]
  Ground Truth Stats:
    Labels shape: (138729,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/HLN-12-1/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.8048
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8623
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8624

  RESULTS:
  RAW:         median(top-10)=0.9150, mean(top-10)=0.9156, median(all)=0.8679, mean(all)=0.8048
  + SMOOTHING: median(top-10)=0.9421, mean(top-10)=0.9426, median(all)=0.9110, mean(all)=0.8623 [+0.0271]
  + MRF:       median(top-10)=0.9422, mean(top-10)=0.9425, median(all)=0.9113, mean(all)=0.8624 [+0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0272

================================================================================
Subject: HLN-12-10
================================================================================
  Step 0: Generating predictions with V2 model...
  Mesh: 134639 vertices, 269274 faces
  Rendering and predicting ALL 20 views...
    ✓ Front (view_id=0): shape (37, 800, 800)
    ✓ Back (view_id=1): shape (37, 800, 800)
    ✓ Left (view_id=2): shape (37, 800, 800)
    ✓ Right (view_id=3): shape (37, 800, 800)
    ✓ Top (view_id=4): shape (37, 800, 800)
    ✓ Bottom (view_id=5): shape (37, 800, 800)
    ✓ FrontLeft (view_id=6): shape (37, 800, 800)
    ✓ FrontRight (view_id=7): shape (37, 800, 800)
    ✓ BackLeft (view_id=8): shape (37, 800, 800)
    ✓ BackRight (view_id=9): shape (37, 800, 800)
    ✓ TopFront (view_id=10): shape (37, 800, 800)
    ✓ TopBack (view_id=11): shape (37, 800, 800)
    ✓ TopLeft (view_id=12): shape (37, 800, 800)
    ✓ TopRight (view_id=13): shape (37, 800, 800)
    ✓ BottomFront (view_id=14): shape (37, 800, 800)
    ✓ BottomBack (view_id=15): shape (37, 800, 800)
    ✓ BottomLeft (view_id=16): shape (37, 800, 800)
    ✓ BottomRight (view_id=17): shape (37, 800, 800)
    ✓ LeftTop (view_id=18): shape (37, 800, 800)
    ✓ RightTop (view_id=19): shape (37, 800, 800)
  ✓ Predictions from all 20 views aggregated
    P stats: min=0.0000, max=1.0000, mean=0.0252
    Non-zero vertices: 125582/134639
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 9057 1304 1093 3170    0 2934 1438 4606 5662]
  Ground Truth Stats:
    Labels shape: (134639,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/HLN-12-10/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7977
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8520
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8523

  RESULTS:
  RAW:         median(top-10)=0.9178, mean(top-10)=0.9223, median(all)=0.8636, mean(all)=0.7977
  + SMOOTHING: median(top-10)=0.9383, mean(top-10)=0.9427, median(all)=0.9044, mean(all)=0.8520 [+0.0206]
  + MRF:       median(top-10)=0.9385, mean(top-10)=0.9432, median(all)=0.9042, mean(all)=0.8523 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0207

================================================================================
Subject: HLN-12-11
================================================================================
  Step 0: Generating predictions with V2 model...
  Mesh: 130710 vertices, 261416 faces
  Rendering and predicting ALL 20 views...
    ✓ Front (view_id=0): shape (37, 800, 800)
    ✓ Back (view_id=1): shape (37, 800, 800)
    ✓ Left (view_id=2): shape (37, 800, 800)
    ✓ Right (view_id=3): shape (37, 800, 800)
    ✓ Top (view_id=4): shape (37, 800, 800)
    ✓ Bottom (view_id=5): shape (37, 800, 800)
    ✓ FrontLeft (view_id=6): shape (37, 800, 800)
    ✓ FrontRight (view_id=7): shape (37, 800, 800)
    ✓ BackLeft (view_id=8): shape (37, 800, 800)
    ✓ BackRight (view_id=9): shape (37, 800, 800)
    ✓ TopFront (view_id=10): shape (37, 800, 800)
    ✓ TopBack (view_id=11): shape (37, 800, 800)
    ✓ TopLeft (view_id=12): shape (37, 800, 800)
    ✓ TopRight (view_id=13): shape (37, 800, 800)
    ✓ BottomFront (view_id=14): shape (37, 800, 800)
    ✓ BottomBack (view_id=15): shape (37, 800, 800)
    ✓ BottomLeft (view_id=16): shape (37, 800, 800)
    ✓ BottomRight (view_id=17): shape (37, 800, 800)
    ✓ LeftTop (view_id=18): shape (37, 800, 800)
    ✓ RightTop (view_id=19): shape (37, 800, 800)
  ✓ Predictions from all 20 views aggregated
    P stats: min=0.0000, max=1.0000, mean=0.0251
    Non-zero vertices: 121335/130710
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 9375 1195  980 3114    0 1958 1374 4186 5750]
  Ground Truth Stats:
    Labels shape: (130710,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/HLN-12-11/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.8056
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8599
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8602

  RESULTS:
  RAW:         median(top-10)=0.9238, mean(top-10)=0.9246, median(all)=0.8774, mean(all)=0.8056
  + SMOOTHING: median(top-10)=0.9504, mean(top-10)=0.9503, median(all)=0.9135, mean(all)=0.8599 [+0.0266]
  + MRF:       median(top-10)=0.9506, mean(top-10)=0.9506, median(all)=0.9136, mean(all)=0.8602 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0268

================================================================================
Subject: HLN-12-12
================================================================================
  Step 0: Generating predictions with V2 model...
  Mesh: 148128 vertices, 296252 faces
  Rendering and predicting ALL 20 views...
    ✓ Front (view_id=0): shape (37, 800, 800)
    ✓ Back (view_id=1): shape (37, 800, 800)
    ✓ Left (view_id=2): shape (37, 800, 800)
    ✓ Right (view_id=3): shape (37, 800, 800)
    ✓ Top (view_id=4): shape (37, 800, 800)
    ✓ Bottom (view_id=5): shape (37, 800, 800)
    ✓ FrontLeft (view_id=6): shape (37, 800, 800)
    ✓ FrontRight (view_id=7): shape (37, 800, 800)
    ✓ BackLeft (view_id=8): shape (37, 800, 800)
    ✓ BackRight (view_id=9): shape (37, 800, 800)
    ✓ TopFront (view_id=10): shape (37, 800, 800)
    ✓ TopBack (view_id=11): shape (37, 800, 800)
    ✓ TopLeft (view_id=12): shape (37, 800, 800)
    ✓ TopRight (view_id=13): shape (37, 800, 800)
    ✓ BottomFront (view_id=14): shape (37, 800, 800)
    ✓ BottomBack (view_id=15): shape (37, 800, 800)
    ✓ BottomLeft (view_id=16): shape (37, 800, 800)
    ✓ BottomRight (view_id=17): shape (37, 800, 800)
    ✓ LeftTop (view_id=18): shape (37, 800, 800)
    ✓ RightTop (view_id=19): shape (37, 800, 800)
  ✓ Predictions from all 20 views aggregated
    P stats: min=0.0000, max=1.0000, mean=0.0245
    Non-zero vertices: 134340/148128
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 13788  1325   959  3856     0  2390  1287  5891  7149]
  Ground Truth Stats:
    Labels shape: (148128,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/HLN-12-12/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7886
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8586
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8587

  RESULTS:
  RAW:         median(top-10)=0.9035, mean(top-10)=0.9075, median(all)=0.8530, mean(all)=0.7886
  + SMOOTHING: median(top-10)=0.9399, mean(top-10)=0.9407, median(all)=0.8977, mean(all)=0.8586 [+0.0364]
  + MRF:       median(top-10)=0.9402, mean(top-10)=0.9407, median(all)=0.8986, mean(all)=0.8587 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0367

================================================================================
Subject: HLN-12-2
================================================================================
  Step 0: Generating predictions with V2 model...
  Mesh: 146833 vertices, 293662 faces
  Rendering and predicting ALL 20 views...
    ✓ Front (view_id=0): shape (37, 800, 800)
    ✓ Back (view_id=1): shape (37, 800, 800)
    ✓ Left (view_id=2): shape (37, 800, 800)
    ✓ Right (view_id=3): shape (37, 800, 800)
    ✓ Top (view_id=4): shape (37, 800, 800)
    ✓ Bottom (view_id=5): shape (37, 800, 800)
    ✓ FrontLeft (view_id=6): shape (37, 800, 800)
    ✓ FrontRight (view_id=7): shape (37, 800, 800)
    ✓ BackLeft (view_id=8): shape (37, 800, 800)
    ✓ BackRight (view_id=9): shape (37, 800, 800)
    ✓ TopFront (view_id=10): shape (37, 800, 800)
    ✓ TopBack (view_id=11): shape (37, 800, 800)
    ✓ TopLeft (view_id=12): shape (37, 800, 800)
    ✓ TopRight (view_id=13): shape (37, 800, 800)
    ✓ BottomFront (view_id=14): shape (37, 800, 800)
    ✓ BottomBack (view_id=15): shape (37, 800, 800)
    ✓ BottomLeft (view_id=16): shape (37, 800, 800)
    ✓ BottomRight (view_id=17): shape (37, 800, 800)
    ✓ LeftTop (view_id=18): shape (37, 800, 800)
    ✓ RightTop (view_id=19): shape (37, 800, 800)
  ✓ Predictions from all 20 views aggregated
    P stats: min=0.0000, max=1.0000, mean=0.0250
    Non-zero vertices: 135665/146833
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 11168  1157  1108  3739     0  2216  1272  5141  6504]
  Ground Truth Stats:
    Labels shape: (146833,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/HLN-12-2/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7890
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8521
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8522

  RESULTS:
  RAW:         median(top-10)=0.9167, mean(top-10)=0.9196, median(all)=0.8474, mean(all)=0.7890
  + SMOOTHING: median(top-10)=0.9438, mean(top-10)=0.9454, median(all)=0.8954, mean(all)=0.8521 [+0.0271]
  + MRF:       median(top-10)=0.9436, mean(top-10)=0.9454, median(all)=0.8957, mean(all)=0.8522 [-0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0269

================================================================================
Subject: HLN-12-3
================================================================================
  Step 0: Generating predictions with V2 model...
  Mesh: 150991 vertices, 301978 faces
  Rendering and predicting ALL 20 views...
    ✓ Front (view_id=0): shape (37, 800, 800)
    ✓ Back (view_id=1): shape (37, 800, 800)
    ✓ Left (view_id=2): shape (37, 800, 800)
    ✓ Right (view_id=3): shape (37, 800, 800)
    ✓ Top (view_id=4): shape (37, 800, 800)
    ✓ Bottom (view_id=5): shape (37, 800, 800)
    ✓ FrontLeft (view_id=6): shape (37, 800, 800)
    ✓ FrontRight (view_id=7): shape (37, 800, 800)
    ✓ BackLeft (view_id=8): shape (37, 800, 800)
    ✓ BackRight (view_id=9): shape (37, 800, 800)
    ✓ TopFront (view_id=10): shape (37, 800, 800)
    ✓ TopBack (view_id=11): shape (37, 800, 800)
    ✓ TopLeft (view_id=12): shape (37, 800, 800)
    ✓ TopRight (view_id=13): shape (37, 800, 800)
    ✓ BottomFront (view_id=14): shape (37, 800, 800)
    ✓ BottomBack (view_id=15): shape (37, 800, 800)
    ✓ BottomLeft (view_id=16): shape (37, 800, 800)
    ✓ BottomRight (view_id=17): shape (37, 800, 800)
    ✓ LeftTop (view_id=18): shape (37, 800, 800)
    ✓ RightTop (view_id=19): shape (37, 800, 800)
  ✓ Predictions from all 20 views aggregated
    P stats: min=0.0000, max=1.0000, mean=0.0242
    Non-zero vertices: 135208/150991
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 15783  1156  1452  3361     0  2296  1092  4328  7953]
  Ground Truth Stats:
    Labels shape: (150991,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/HLN-12-3/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7847
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8541
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8541

  RESULTS:
  RAW:         median(top-10)=0.9069, mean(top-10)=0.9094, median(all)=0.8580, mean(all)=0.7847
  + SMOOTHING: median(top-10)=0.9507, mean(top-10)=0.9455, median(all)=0.9029, mean(all)=0.8541 [+0.0438]
  + MRF:       median(top-10)=0.9507, mean(top-10)=0.9456, median(all)=0.9034, mean(all)=0.8541 [+0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0438

================================================================================
Subject: HLN-12-4
================================================================================
  Step 0: Generating predictions with V2 model...
  Mesh: 137751 vertices, 275498 faces
  Rendering and predicting ALL 20 views...
    ✓ Front (view_id=0): shape (37, 800, 800)
    ✓ Back (view_id=1): shape (37, 800, 800)
    ✓ Left (view_id=2): shape (37, 800, 800)
    ✓ Right (view_id=3): shape (37, 800, 800)
    ✓ Top (view_id=4): shape (37, 800, 800)
    ✓ Bottom (view_id=5): shape (37, 800, 800)
    ✓ FrontLeft (view_id=6): shape (37, 800, 800)
    ✓ FrontRight (view_id=7): shape (37, 800, 800)
    ✓ BackLeft (view_id=8): shape (37, 800, 800)
    ✓ BackRight (view_id=9): shape (37, 800, 800)
    ✓ TopFront (view_id=10): shape (37, 800, 800)
    ✓ TopBack (view_id=11): shape (37, 800, 800)
    ✓ TopLeft (view_id=12): shape (37, 800, 800)
    ✓ TopRight (view_id=13): shape (37, 800, 800)
    ✓ BottomFront (view_id=14): shape (37, 800, 800)
    ✓ BottomBack (view_id=15): shape (37, 800, 800)
    ✓ BottomLeft (view_id=16): shape (37, 800, 800)
    ✓ BottomRight (view_id=17): shape (37, 800, 800)
    ✓ LeftTop (view_id=18): shape (37, 800, 800)
    ✓ RightTop (view_id=19): shape (37, 800, 800)
  ✓ Predictions from all 20 views aggregated
    P stats: min=0.0000, max=1.0000, mean=0.0249
    Non-zero vertices: 126700/137751
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 11051  1365  1186  3837     0  2181  1132  4157  6756]
  Ground Truth Stats:
    Labels shape: (137751,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/HLN-12-4/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7953
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8541
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8543

  RESULTS:
  RAW:         median(top-10)=0.9179, mean(top-10)=0.9182, median(all)=0.8581, mean(all)=0.7953
  + SMOOTHING: median(top-10)=0.9437, mean(top-10)=0.9460, median(all)=0.9022, mean(all)=0.8541 [+0.0257]
  + MRF:       median(top-10)=0.9438, mean(top-10)=0.9461, median(all)=0.9025, mean(all)=0.8543 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0259

================================================================================
Subject: HLN-12-5
================================================================================
  Step 0: Generating predictions with V2 model...
  Mesh: 167182 vertices, 334360 faces
  Rendering and predicting ALL 20 views...
    ✓ Front (view_id=0): shape (37, 800, 800)
    ✓ Back (view_id=1): shape (37, 800, 800)
    ✓ Left (view_id=2): shape (37, 800, 800)
    ✓ Right (view_id=3): shape (37, 800, 800)
    ✓ Top (view_id=4): shape (37, 800, 800)
    ✓ Bottom (view_id=5): shape (37, 800, 800)
    ✓ FrontLeft (view_id=6): shape (37, 800, 800)
    ✓ FrontRight (view_id=7): shape (37, 800, 800)
    ✓ BackLeft (view_id=8): shape (37, 800, 800)
    ✓ BackRight (view_id=9): shape (37, 800, 800)
    ✓ TopFront (view_id=10): shape (37, 800, 800)
    ✓ TopBack (view_id=11): shape (37, 800, 800)
    ✓ TopLeft (view_id=12): shape (37, 800, 800)
    ✓ TopRight (view_id=13): shape (37, 800, 800)
    ✓ BottomFront (view_id=14): shape (37, 800, 800)
    ✓ BottomBack (view_id=15): shape (37, 800, 800)
    ✓ BottomLeft (view_id=16): shape (37, 800, 800)
    ✓ BottomRight (view_id=17): shape (37, 800, 800)
    ✓ LeftTop (view_id=18): shape (37, 800, 800)
    ✓ RightTop (view_id=19): shape (37, 800, 800)
  ✓ Predictions from all 20 views aggregated
    P stats: min=0.0000, max=1.0000, mean=0.0244
    Non-zero vertices: 150979/167182
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 16203  1431  1881  3614     0  2417  1251  5825  7941]
  Ground Truth Stats:
    Labels shape: (167182,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/HLN-12-5/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7831
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8556
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8557

  RESULTS:
  RAW:         median(top-10)=0.9025, mean(top-10)=0.9041, median(all)=0.8426, mean(all)=0.7831
  + SMOOTHING: median(top-10)=0.9430, mean(top-10)=0.9422, median(all)=0.8908, mean(all)=0.8556 [+0.0405]
  + MRF:       median(top-10)=0.9429, mean(top-10)=0.9423, median(all)=0.8907, mean(all)=0.8557 [-0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0404

================================================================================
Subject: HLN-12-6
================================================================================
  Step 0: Generating predictions with V2 model...
  Mesh: 149409 vertices, 298814 faces
  Rendering and predicting ALL 20 views...
    ✓ Front (view_id=0): shape (37, 800, 800)
    ✓ Back (view_id=1): shape (37, 800, 800)
    ✓ Left (view_id=2): shape (37, 800, 800)
    ✓ Right (view_id=3): shape (37, 800, 800)
    ✓ Top (view_id=4): shape (37, 800, 800)
    ✓ Bottom (view_id=5): shape (37, 800, 800)
    ✓ FrontLeft (view_id=6): shape (37, 800, 800)
    ✓ FrontRight (view_id=7): shape (37, 800, 800)
    ✓ BackLeft (view_id=8): shape (37, 800, 800)
    ✓ BackRight (view_id=9): shape (37, 800, 800)
    ✓ TopFront (view_id=10): shape (37, 800, 800)
    ✓ TopBack (view_id=11): shape (37, 800, 800)
    ✓ TopLeft (view_id=12): shape (37, 800, 800)
    ✓ TopRight (view_id=13): shape (37, 800, 800)
    ✓ BottomFront (view_id=14): shape (37, 800, 800)
    ✓ BottomBack (view_id=15): shape (37, 800, 800)
    ✓ BottomLeft (view_id=16): shape (37, 800, 800)
    ✓ BottomRight (view_id=17): shape (37, 800, 800)
    ✓ LeftTop (view_id=18): shape (37, 800, 800)
    ✓ RightTop (view_id=19): shape (37, 800, 800)
  ✓ Predictions from all 20 views aggregated
    P stats: min=0.0000, max=1.0000, mean=0.0241
    Non-zero vertices: 133222/149409
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 16187  1253  1245  3940     0  2240  1095  5993  6580]
  Ground Truth Stats:
    Labels shape: (149409,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/HLN-12-6/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7698
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8475
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8478

  RESULTS:
  RAW:         median(top-10)=0.9045, mean(top-10)=0.9072, median(all)=0.8201, mean(all)=0.7698
  + SMOOTHING: median(top-10)=0.9364, mean(top-10)=0.9382, median(all)=0.8884, mean(all)=0.8475 [+0.0319]
  + MRF:       median(top-10)=0.9369, mean(top-10)=0.9385, median(all)=0.8889, mean(all)=0.8478 [+0.0005]
  TOTAL IMPROVEMENT (median top-10): +0.0324

================================================================================
Subject: HLN-12-7
================================================================================
  Step 0: Generating predictions with V2 model...
  Mesh: 122042 vertices, 244080 faces
  Rendering and predicting ALL 20 views...
    ✓ Front (view_id=0): shape (37, 800, 800)
    ✓ Back (view_id=1): shape (37, 800, 800)
    ✓ Left (view_id=2): shape (37, 800, 800)
    ✓ Right (view_id=3): shape (37, 800, 800)
    ✓ Top (view_id=4): shape (37, 800, 800)
    ✓ Bottom (view_id=5): shape (37, 800, 800)
    ✓ FrontLeft (view_id=6): shape (37, 800, 800)
    ✓ FrontRight (view_id=7): shape (37, 800, 800)
    ✓ BackLeft (view_id=8): shape (37, 800, 800)
    ✓ BackRight (view_id=9): shape (37, 800, 800)
    ✓ TopFront (view_id=10): shape (37, 800, 800)
    ✓ TopBack (view_id=11): shape (37, 800, 800)
    ✓ TopLeft (view_id=12): shape (37, 800, 800)
    ✓ TopRight (view_id=13): shape (37, 800, 800)
    ✓ BottomFront (view_id=14): shape (37, 800, 800)
    ✓ BottomBack (view_id=15): shape (37, 800, 800)
    ✓ BottomLeft (view_id=16): shape (37, 800, 800)
    ✓ BottomRight (view_id=17): shape (37, 800, 800)
    ✓ LeftTop (view_id=18): shape (37, 800, 800)
    ✓ RightTop (view_id=19): shape (37, 800, 800)
  ✓ Predictions from all 20 views aggregated
    P stats: min=0.0000, max=1.0000, mean=0.0250
    Non-zero vertices: 112913/122042
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 9129  924 1212 3260    0 2032 1113 4654 5136]
  Ground Truth Stats:
    Labels shape: (122042,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/HLN-12-7/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.8036
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8655
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8657

  RESULTS:
  RAW:         median(top-10)=0.9113, mean(top-10)=0.9135, median(all)=0.8782, mean(all)=0.8036
  + SMOOTHING: median(top-10)=0.9428, mean(top-10)=0.9402, median(all)=0.9102, mean(all)=0.8655 [+0.0315]
  + MRF:       median(top-10)=0.9428, mean(top-10)=0.9405, median(all)=0.9106, mean(all)=0.8657 [+0.0000]
  TOTAL IMPROVEMENT (median top-10): +0.0315

================================================================================
Subject: HLN-12-8
================================================================================
  Step 0: Generating predictions with V2 model...
  Mesh: 163705 vertices, 327406 faces
  Rendering and predicting ALL 20 views...
    ✓ Front (view_id=0): shape (37, 800, 800)
    ✓ Back (view_id=1): shape (37, 800, 800)
    ✓ Left (view_id=2): shape (37, 800, 800)
    ✓ Right (view_id=3): shape (37, 800, 800)
    ✓ Top (view_id=4): shape (37, 800, 800)
    ✓ Bottom (view_id=5): shape (37, 800, 800)
    ✓ FrontLeft (view_id=6): shape (37, 800, 800)
    ✓ FrontRight (view_id=7): shape (37, 800, 800)
    ✓ BackLeft (view_id=8): shape (37, 800, 800)
    ✓ BackRight (view_id=9): shape (37, 800, 800)
    ✓ TopFront (view_id=10): shape (37, 800, 800)
    ✓ TopBack (view_id=11): shape (37, 800, 800)
    ✓ TopLeft (view_id=12): shape (37, 800, 800)
    ✓ TopRight (view_id=13): shape (37, 800, 800)
    ✓ BottomFront (view_id=14): shape (37, 800, 800)
    ✓ BottomBack (view_id=15): shape (37, 800, 800)
    ✓ BottomLeft (view_id=16): shape (37, 800, 800)
    ✓ BottomRight (view_id=17): shape (37, 800, 800)
    ✓ LeftTop (view_id=18): shape (37, 800, 800)
    ✓ RightTop (view_id=19): shape (37, 800, 800)
  ✓ Predictions from all 20 views aggregated
    P stats: min=0.0000, max=1.0000, mean=0.0247
    Non-zero vertices: 149733/163705
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 13972  1215  1454  3914     0  2708  1482  5445  7062]
  Ground Truth Stats:
    Labels shape: (163705,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/HLN-12-8/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7879
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8558
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8561

  RESULTS:
  RAW:         median(top-10)=0.9039, mean(top-10)=0.9068, median(all)=0.8410, mean(all)=0.7879
  + SMOOTHING: median(top-10)=0.9331, mean(top-10)=0.9384, median(all)=0.8812, mean(all)=0.8558 [+0.0291]
  + MRF:       median(top-10)=0.9333, mean(top-10)=0.9386, median(all)=0.8820, mean(all)=0.8561 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0294

================================================================================
Subject: HLN-12-9
================================================================================
  Step 0: Generating predictions with V2 model...
  Mesh: 137393 vertices, 274782 faces
  Rendering and predicting ALL 20 views...
    ✓ Front (view_id=0): shape (37, 800, 800)
    ✓ Back (view_id=1): shape (37, 800, 800)
    ✓ Left (view_id=2): shape (37, 800, 800)
    ✓ Right (view_id=3): shape (37, 800, 800)
    ✓ Top (view_id=4): shape (37, 800, 800)
    ✓ Bottom (view_id=5): shape (37, 800, 800)
    ✓ FrontLeft (view_id=6): shape (37, 800, 800)
    ✓ FrontRight (view_id=7): shape (37, 800, 800)
    ✓ BackLeft (view_id=8): shape (37, 800, 800)
    ✓ BackRight (view_id=9): shape (37, 800, 800)
    ✓ TopFront (view_id=10): shape (37, 800, 800)
    ✓ TopBack (view_id=11): shape (37, 800, 800)
    ✓ TopLeft (view_id=12): shape (37, 800, 800)
    ✓ TopRight (view_id=13): shape (37, 800, 800)
    ✓ BottomFront (view_id=14): shape (37, 800, 800)
    ✓ BottomBack (view_id=15): shape (37, 800, 800)
    ✓ BottomLeft (view_id=16): shape (37, 800, 800)
    ✓ BottomRight (view_id=17): shape (37, 800, 800)
    ✓ LeftTop (view_id=18): shape (37, 800, 800)
    ✓ RightTop (view_id=19): shape (37, 800, 800)
  ✓ Predictions from all 20 views aggregated
    P stats: min=0.0000, max=1.0000, mean=0.0252
    Non-zero vertices: 127858/137393
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 9535 1154 1185 3295    0 2335 1335 4957 6297]
  Ground Truth Stats:
    Labels shape: (137393,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/HLN-12-9/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.8109
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8740
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8740

  RESULTS:
  RAW:         median(top-10)=0.9309, mean(top-10)=0.9305, median(all)=0.8917, mean(all)=0.8109
  + SMOOTHING: median(top-10)=0.9566, mean(top-10)=0.9581, median(all)=0.9329, mean(all)=0.8740 [+0.0257]
  + MRF:       median(top-10)=0.9566, mean(top-10)=0.9583, median(all)=0.9329, mean(all)=0.8740 [-0.0000]
  TOTAL IMPROVEMENT (median top-10): +0.0257

================================================================================
Subject: MMRR-21-1
================================================================================
  Step 0: Generating predictions with V2 model...
  Mesh: 130631 vertices, 261258 faces
  Rendering and predicting ALL 20 views...
    ✓ Front (view_id=0): shape (37, 800, 800)
    ✓ Back (view_id=1): shape (37, 800, 800)
    ✓ Left (view_id=2): shape (37, 800, 800)
    ✓ Right (view_id=3): shape (37, 800, 800)
    ✓ Top (view_id=4): shape (37, 800, 800)
    ✓ Bottom (view_id=5): shape (37, 800, 800)
    ✓ FrontLeft (view_id=6): shape (37, 800, 800)
    ✓ FrontRight (view_id=7): shape (37, 800, 800)
    ✓ BackLeft (view_id=8): shape (37, 800, 800)
    ✓ BackRight (view_id=9): shape (37, 800, 800)
    ✓ TopFront (view_id=10): shape (37, 800, 800)
    ✓ TopBack (view_id=11): shape (37, 800, 800)
    ✓ TopLeft (view_id=12): shape (37, 800, 800)
    ✓ TopRight (view_id=13): shape (37, 800, 800)
    ✓ BottomFront (view_id=14): shape (37, 800, 800)
    ✓ BottomBack (view_id=15): shape (37, 800, 800)
    ✓ BottomLeft (view_id=16): shape (37, 800, 800)
    ✓ BottomRight (view_id=17): shape (37, 800, 800)
    ✓ LeftTop (view_id=18): shape (37, 800, 800)
    ✓ RightTop (view_id=19): shape (37, 800, 800)
  ✓ Predictions from all 20 views aggregated
    P stats: min=0.0000, max=1.0000, mean=0.0249
    Non-zero vertices: 120159/130631
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 10472  1030  1131  3423     0  1641   957  4936  5671]
  Ground Truth Stats:
    Labels shape: (130631,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-1/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7968
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8653
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8652

  RESULTS:
  RAW:         median(top-10)=0.9164, mean(top-10)=0.9216, median(all)=0.8599, mean(all)=0.7968
  + SMOOTHING: median(top-10)=0.9521, mean(top-10)=0.9498, median(all)=0.9068, mean(all)=0.8653 [+0.0357]
  + MRF:       median(top-10)=0.9521, mean(top-10)=0.9498, median(all)=0.9072, mean(all)=0.8652 [-0.0000]
  TOTAL IMPROVEMENT (median top-10): +0.0357

================================================================================
Subject: MMRR-21-10
================================================================================
  Step 0: Generating predictions with V2 model...
  Mesh: 148162 vertices, 296320 faces
  Rendering and predicting ALL 20 views...
    ✓ Front (view_id=0): shape (37, 800, 800)
    ✓ Back (view_id=1): shape (37, 800, 800)
    ✓ Left (view_id=2): shape (37, 800, 800)
    ✓ Right (view_id=3): shape (37, 800, 800)
    ✓ Top (view_id=4): shape (37, 800, 800)
    ✓ Bottom (view_id=5): shape (37, 800, 800)
    ✓ FrontLeft (view_id=6): shape (37, 800, 800)
    ✓ FrontRight (view_id=7): shape (37, 800, 800)
    ✓ BackLeft (view_id=8): shape (37, 800, 800)
    ✓ BackRight (view_id=9): shape (37, 800, 800)
    ✓ TopFront (view_id=10): shape (37, 800, 800)
    ✓ TopBack (view_id=11): shape (37, 800, 800)
    ✓ TopLeft (view_id=12): shape (37, 800, 800)
    ✓ TopRight (view_id=13): shape (37, 800, 800)
    ✓ BottomFront (view_id=14): shape (37, 800, 800)
    ✓ BottomBack (view_id=15): shape (37, 800, 800)
    ✓ BottomLeft (view_id=16): shape (37, 800, 800)
    ✓ BottomRight (view_id=17): shape (37, 800, 800)
    ✓ LeftTop (view_id=18): shape (37, 800, 800)
    ✓ RightTop (view_id=19): shape (37, 800, 800)
  ✓ Predictions from all 20 views aggregated
    P stats: min=0.0000, max=1.0000, mean=0.0249
    Non-zero vertices: 136401/148162
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 11761  1260   992  4016     0  2346  1336  5250  7572]
  Ground Truth Stats:
    Labels shape: (148162,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-10/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.8043
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8681
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8681

  RESULTS:
  RAW:         median(top-10)=0.9189, mean(top-10)=0.9220, median(all)=0.8681, mean(all)=0.8043
  + SMOOTHING: median(top-10)=0.9438, mean(top-10)=0.9469, median(all)=0.9059, mean(all)=0.8681 [+0.0249]
  + MRF:       median(top-10)=0.9439, mean(top-10)=0.9469, median(all)=0.9066, mean(all)=0.8681 [+0.0000]
  TOTAL IMPROVEMENT (median top-10): +0.0249

================================================================================
Subject: MMRR-21-11
================================================================================
  Step 0: Generating predictions with V2 model...
  Mesh: 136982 vertices, 273960 faces
  Rendering and predicting ALL 20 views...
    ✓ Front (view_id=0): shape (37, 800, 800)
    ✓ Back (view_id=1): shape (37, 800, 800)
    ✓ Left (view_id=2): shape (37, 800, 800)
    ✓ Right (view_id=3): shape (37, 800, 800)
    ✓ Top (view_id=4): shape (37, 800, 800)
    ✓ Bottom (view_id=5): shape (37, 800, 800)
    ✓ FrontLeft (view_id=6): shape (37, 800, 800)
    ✓ FrontRight (view_id=7): shape (37, 800, 800)
    ✓ BackLeft (view_id=8): shape (37, 800, 800)
    ✓ BackRight (view_id=9): shape (37, 800, 800)
    ✓ TopFront (view_id=10): shape (37, 800, 800)
    ✓ TopBack (view_id=11): shape (37, 800, 800)
    ✓ TopLeft (view_id=12): shape (37, 800, 800)
    ✓ TopRight (view_id=13): shape (37, 800, 800)
    ✓ BottomFront (view_id=14): shape (37, 800, 800)
    ✓ BottomBack (view_id=15): shape (37, 800, 800)
    ✓ BottomLeft (view_id=16): shape (37, 800, 800)
    ✓ BottomRight (view_id=17): shape (37, 800, 800)
    ✓ LeftTop (view_id=18): shape (37, 800, 800)
    ✓ RightTop (view_id=19): shape (37, 800, 800)
  ✓ Predictions from all 20 views aggregated
    P stats: min=0.0000, max=1.0000, mean=0.0249
    Non-zero vertices: 126214/136982
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 10768  1742   909  2649     0  2172   969  4810  6485]
  Ground Truth Stats:
    Labels shape: (136982,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-11/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7067
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7585
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7586

  RESULTS:
  RAW:         median(top-10)=0.8909, mean(top-10)=0.8940, median(all)=0.8013, mean(all)=0.7067
  + SMOOTHING: median(top-10)=0.9217, mean(top-10)=0.9253, median(all)=0.8474, mean(all)=0.7585 [+0.0307]
  + MRF:       median(top-10)=0.9219, mean(top-10)=0.9256, median(all)=0.8476, mean(all)=0.7586 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0310

================================================================================
Subject: MMRR-21-12
================================================================================
  Step 0: Generating predictions with V2 model...
  Mesh: 102602 vertices, 205200 faces
  Rendering and predicting ALL 20 views...
    ✓ Front (view_id=0): shape (37, 800, 800)
    ✓ Back (view_id=1): shape (37, 800, 800)
    ✓ Left (view_id=2): shape (37, 800, 800)
    ✓ Right (view_id=3): shape (37, 800, 800)
    ✓ Top (view_id=4): shape (37, 800, 800)
    ✓ Bottom (view_id=5): shape (37, 800, 800)
    ✓ FrontLeft (view_id=6): shape (37, 800, 800)
    ✓ FrontRight (view_id=7): shape (37, 800, 800)
    ✓ BackLeft (view_id=8): shape (37, 800, 800)
    ✓ BackRight (view_id=9): shape (37, 800, 800)
    ✓ TopFront (view_id=10): shape (37, 800, 800)
    ✓ TopBack (view_id=11): shape (37, 800, 800)
    ✓ TopLeft (view_id=12): shape (37, 800, 800)
    ✓ TopRight (view_id=13): shape (37, 800, 800)
    ✓ BottomFront (view_id=14): shape (37, 800, 800)
    ✓ BottomBack (view_id=15): shape (37, 800, 800)
    ✓ BottomLeft (view_id=16): shape (37, 800, 800)
    ✓ BottomRight (view_id=17): shape (37, 800, 800)
    ✓ LeftTop (view_id=18): shape (37, 800, 800)
    ✓ RightTop (view_id=19): shape (37, 800, 800)
  ✓ Predictions from all 20 views aggregated
    P stats: min=0.0000, max=1.0000, mean=0.0252
    Non-zero vertices: 95692/102602
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 6910  960  940 1832    0 1604 1081 3505 4332]
  Ground Truth Stats:
    Labels shape: (102602,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-12/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7882
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8443
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8446

  RESULTS:
  RAW:         median(top-10)=0.9227, mean(top-10)=0.9224, median(all)=0.8586, mean(all)=0.7882
  + SMOOTHING: median(top-10)=0.9387, mean(top-10)=0.9387, median(all)=0.9005, mean(all)=0.8443 [+0.0160]
  + MRF:       median(top-10)=0.9388, mean(top-10)=0.9390, median(all)=0.9013, mean(all)=0.8446 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0162

================================================================================
Subject: MMRR-21-13
================================================================================
  Step 0: Generating predictions with V2 model...
  Mesh: 128887 vertices, 257770 faces
  Rendering and predicting ALL 20 views...
    ✓ Front (view_id=0): shape (37, 800, 800)
    ✓ Back (view_id=1): shape (37, 800, 800)
    ✓ Left (view_id=2): shape (37, 800, 800)
    ✓ Right (view_id=3): shape (37, 800, 800)
    ✓ Top (view_id=4): shape (37, 800, 800)
    ✓ Bottom (view_id=5): shape (37, 800, 800)
    ✓ FrontLeft (view_id=6): shape (37, 800, 800)
    ✓ FrontRight (view_id=7): shape (37, 800, 800)
    ✓ BackLeft (view_id=8): shape (37, 800, 800)
    ✓ BackRight (view_id=9): shape (37, 800, 800)
    ✓ TopFront (view_id=10): shape (37, 800, 800)
    ✓ TopBack (view_id=11): shape (37, 800, 800)
    ✓ TopLeft (view_id=12): shape (37, 800, 800)
    ✓ TopRight (view_id=13): shape (37, 800, 800)
    ✓ BottomFront (view_id=14): shape (37, 800, 800)
    ✓ BottomBack (view_id=15): shape (37, 800, 800)
    ✓ BottomLeft (view_id=16): shape (37, 800, 800)
    ✓ BottomRight (view_id=17): shape (37, 800, 800)
    ✓ LeftTop (view_id=18): shape (37, 800, 800)
    ✓ RightTop (view_id=19): shape (37, 800, 800)
  ✓ Predictions from all 20 views aggregated
    P stats: min=0.0000, max=1.0000, mean=0.0249
    Non-zero vertices: 118686/128887
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 10201  1092  1216  3111     0  1656   876  4794  6034]
  Ground Truth Stats:
    Labels shape: (128887,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-13/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7817
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8484
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8483

  RESULTS:
  RAW:         median(top-10)=0.9117, mean(top-10)=0.9115, median(all)=0.8540, mean(all)=0.7817
  + SMOOTHING: median(top-10)=0.9371, mean(top-10)=0.9375, median(all)=0.9015, mean(all)=0.8484 [+0.0254]
  + MRF:       median(top-10)=0.9372, mean(top-10)=0.9377, median(all)=0.9019, mean(all)=0.8483 [+0.0000]
  TOTAL IMPROVEMENT (median top-10): +0.0255

================================================================================
Subject: MMRR-21-14
================================================================================
  Step 0: Generating predictions with V2 model...
  Mesh: 127387 vertices, 254770 faces
  Rendering and predicting ALL 20 views...
    ✓ Front (view_id=0): shape (37, 800, 800)
    ✓ Back (view_id=1): shape (37, 800, 800)
    ✓ Left (view_id=2): shape (37, 800, 800)
    ✓ Right (view_id=3): shape (37, 800, 800)
    ✓ Top (view_id=4): shape (37, 800, 800)
    ✓ Bottom (view_id=5): shape (37, 800, 800)
    ✓ FrontLeft (view_id=6): shape (37, 800, 800)
    ✓ FrontRight (view_id=7): shape (37, 800, 800)
    ✓ BackLeft (view_id=8): shape (37, 800, 800)
    ✓ BackRight (view_id=9): shape (37, 800, 800)
    ✓ TopFront (view_id=10): shape (37, 800, 800)
    ✓ TopBack (view_id=11): shape (37, 800, 800)
    ✓ TopLeft (view_id=12): shape (37, 800, 800)
    ✓ TopRight (view_id=13): shape (37, 800, 800)
    ✓ BottomFront (view_id=14): shape (37, 800, 800)
    ✓ BottomBack (view_id=15): shape (37, 800, 800)
    ✓ BottomLeft (view_id=16): shape (37, 800, 800)
    ✓ BottomRight (view_id=17): shape (37, 800, 800)
    ✓ LeftTop (view_id=18): shape (37, 800, 800)
    ✓ RightTop (view_id=19): shape (37, 800, 800)
  ✓ Predictions from all 20 views aggregated
    P stats: min=0.0000, max=1.0000, mean=0.0249
    Non-zero vertices: 117399/127387
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 9988 1106 1076 2963    0 1944 1460 4394 5217]
  Ground Truth Stats:
    Labels shape: (127387,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-14/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7769
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8379
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8378

  RESULTS:
  RAW:         median(top-10)=0.9188, mean(top-10)=0.9203, median(all)=0.8384, mean(all)=0.7769
  + SMOOTHING: median(top-10)=0.9396, mean(top-10)=0.9432, median(all)=0.8907, mean(all)=0.8379 [+0.0208]
  + MRF:       median(top-10)=0.9396, mean(top-10)=0.9433, median(all)=0.8911, mean(all)=0.8378 [+0.0000]
  TOTAL IMPROVEMENT (median top-10): +0.0208

================================================================================
Subject: MMRR-21-15
================================================================================
  Step 0: Generating predictions with V2 model...
  Mesh: 137028 vertices, 274052 faces
  Rendering and predicting ALL 20 views...
    ✓ Front (view_id=0): shape (37, 800, 800)
    ✓ Back (view_id=1): shape (37, 800, 800)
    ✓ Left (view_id=2): shape (37, 800, 800)
    ✓ Right (view_id=3): shape (37, 800, 800)
    ✓ Top (view_id=4): shape (37, 800, 800)
    ✓ Bottom (view_id=5): shape (37, 800, 800)
    ✓ FrontLeft (view_id=6): shape (37, 800, 800)
    ✓ FrontRight (view_id=7): shape (37, 800, 800)
    ✓ BackLeft (view_id=8): shape (37, 800, 800)
    ✓ BackRight (view_id=9): shape (37, 800, 800)
    ✓ TopFront (view_id=10): shape (37, 800, 800)
    ✓ TopBack (view_id=11): shape (37, 800, 800)
    ✓ TopLeft (view_id=12): shape (37, 800, 800)
    ✓ TopRight (view_id=13): shape (37, 800, 800)
    ✓ BottomFront (view_id=14): shape (37, 800, 800)
    ✓ BottomBack (view_id=15): shape (37, 800, 800)
    ✓ BottomLeft (view_id=16): shape (37, 800, 800)
    ✓ BottomRight (view_id=17): shape (37, 800, 800)
    ✓ LeftTop (view_id=18): shape (37, 800, 800)
    ✓ RightTop (view_id=19): shape (37, 800, 800)
  ✓ Predictions from all 20 views aggregated
    P stats: min=0.0000, max=1.0000, mean=0.0246
    Non-zero vertices: 124968/137028
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 12060  1130  1295  3487     0  2410  1103  4112  6217]
  Ground Truth Stats:
    Labels shape: (137028,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-15/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.8117
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8757
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8758

  RESULTS:
  RAW:         median(top-10)=0.9207, mean(top-10)=0.9235, median(all)=0.8704, mean(all)=0.8117
  + SMOOTHING: median(top-10)=0.9480, mean(top-10)=0.9506, median(all)=0.9230, mean(all)=0.8757 [+0.0273]
  + MRF:       median(top-10)=0.9483, mean(top-10)=0.9509, median(all)=0.9235, mean(all)=0.8758 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0276

================================================================================
Subject: MMRR-21-16
================================================================================
  Step 0: Generating predictions with V2 model...
  Mesh: 147500 vertices, 294996 faces
  Rendering and predicting ALL 20 views...
    ✓ Front (view_id=0): shape (37, 800, 800)
    ✓ Back (view_id=1): shape (37, 800, 800)
    ✓ Left (view_id=2): shape (37, 800, 800)
    ✓ Right (view_id=3): shape (37, 800, 800)
    ✓ Top (view_id=4): shape (37, 800, 800)
    ✓ Bottom (view_id=5): shape (37, 800, 800)
    ✓ FrontLeft (view_id=6): shape (37, 800, 800)
    ✓ FrontRight (view_id=7): shape (37, 800, 800)
    ✓ BackLeft (view_id=8): shape (37, 800, 800)
    ✓ BackRight (view_id=9): shape (37, 800, 800)
    ✓ TopFront (view_id=10): shape (37, 800, 800)
    ✓ TopBack (view_id=11): shape (37, 800, 800)
    ✓ TopLeft (view_id=12): shape (37, 800, 800)
    ✓ TopRight (view_id=13): shape (37, 800, 800)
    ✓ BottomFront (view_id=14): shape (37, 800, 800)
    ✓ BottomBack (view_id=15): shape (37, 800, 800)
    ✓ BottomLeft (view_id=16): shape (37, 800, 800)
    ✓ BottomRight (view_id=17): shape (37, 800, 800)
    ✓ LeftTop (view_id=18): shape (37, 800, 800)
    ✓ RightTop (view_id=19): shape (37, 800, 800)
  ✓ Predictions from all 20 views aggregated
    P stats: min=0.0000, max=1.0000, mean=0.0249
    Non-zero vertices: 135630/147500
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 11870  1329  1534  3427     0  2415  1233  4972  6276]
  Ground Truth Stats:
    Labels shape: (147500,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-16/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.8031
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8671
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8671

  RESULTS:
  RAW:         median(top-10)=0.9207, mean(top-10)=0.9215, median(all)=0.8777, mean(all)=0.8031
  + SMOOTHING: median(top-10)=0.9486, mean(top-10)=0.9488, median(all)=0.9026, mean(all)=0.8671 [+0.0279]
  + MRF:       median(top-10)=0.9487, mean(top-10)=0.9486, median(all)=0.9028, mean(all)=0.8671 [+0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0280

================================================================================
Subject: MMRR-21-17
================================================================================
  Step 0: Generating predictions with V2 model...
  Mesh: 126138 vertices, 252272 faces
  Rendering and predicting ALL 20 views...
    ✓ Front (view_id=0): shape (37, 800, 800)
    ✓ Back (view_id=1): shape (37, 800, 800)
    ✓ Left (view_id=2): shape (37, 800, 800)
    ✓ Right (view_id=3): shape (37, 800, 800)
    ✓ Top (view_id=4): shape (37, 800, 800)
    ✓ Bottom (view_id=5): shape (37, 800, 800)
    ✓ FrontLeft (view_id=6): shape (37, 800, 800)
    ✓ FrontRight (view_id=7): shape (37, 800, 800)
    ✓ BackLeft (view_id=8): shape (37, 800, 800)
    ✓ BackRight (view_id=9): shape (37, 800, 800)
    ✓ TopFront (view_id=10): shape (37, 800, 800)
    ✓ TopBack (view_id=11): shape (37, 800, 800)
    ✓ TopLeft (view_id=12): shape (37, 800, 800)
    ✓ TopRight (view_id=13): shape (37, 800, 800)
    ✓ BottomFront (view_id=14): shape (37, 800, 800)
    ✓ BottomBack (view_id=15): shape (37, 800, 800)
    ✓ BottomLeft (view_id=16): shape (37, 800, 800)
    ✓ BottomRight (view_id=17): shape (37, 800, 800)
    ✓ LeftTop (view_id=18): shape (37, 800, 800)
    ✓ RightTop (view_id=19): shape (37, 800, 800)
  ✓ Predictions from all 20 views aggregated
    P stats: min=0.0000, max=1.0000, mean=0.0256
    Non-zero vertices: 119613/126138
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 6525 1408 1469 2653    0 2640 1237 4810 5576]
  Ground Truth Stats:
    Labels shape: (126138,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-17/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.8144
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8647
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8648

  RESULTS:
  RAW:         median(top-10)=0.9269, mean(top-10)=0.9282, median(all)=0.8884, mean(all)=0.8144
  + SMOOTHING: median(top-10)=0.9499, mean(top-10)=0.9473, median(all)=0.9167, mean(all)=0.8647 [+0.0230]
  + MRF:       median(top-10)=0.9502, mean(top-10)=0.9475, median(all)=0.9173, mean(all)=0.8648 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0233

================================================================================
Subject: MMRR-21-18
================================================================================
  Step 0: Generating predictions with V2 model...
  Mesh: 131379 vertices, 262754 faces
  Rendering and predicting ALL 20 views...
    ✓ Front (view_id=0): shape (37, 800, 800)
    ✓ Back (view_id=1): shape (37, 800, 800)
    ✓ Left (view_id=2): shape (37, 800, 800)
    ✓ Right (view_id=3): shape (37, 800, 800)
    ✓ Top (view_id=4): shape (37, 800, 800)
    ✓ Bottom (view_id=5): shape (37, 800, 800)
    ✓ FrontLeft (view_id=6): shape (37, 800, 800)
    ✓ FrontRight (view_id=7): shape (37, 800, 800)
    ✓ BackLeft (view_id=8): shape (37, 800, 800)
    ✓ BackRight (view_id=9): shape (37, 800, 800)
    ✓ TopFront (view_id=10): shape (37, 800, 800)
    ✓ TopBack (view_id=11): shape (37, 800, 800)
    ✓ TopLeft (view_id=12): shape (37, 800, 800)
    ✓ TopRight (view_id=13): shape (37, 800, 800)
    ✓ BottomFront (view_id=14): shape (37, 800, 800)
    ✓ BottomBack (view_id=15): shape (37, 800, 800)
    ✓ BottomLeft (view_id=16): shape (37, 800, 800)
    ✓ BottomRight (view_id=17): shape (37, 800, 800)
    ✓ LeftTop (view_id=18): shape (37, 800, 800)
    ✓ RightTop (view_id=19): shape (37, 800, 800)
  ✓ Predictions from all 20 views aggregated
    P stats: min=0.0000, max=1.0000, mean=0.0248
    Non-zero vertices: 120708/131379
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 10671   947  1428  2531     0  1834  1099  4249  5916]
  Ground Truth Stats:
    Labels shape: (131379,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-18/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.8018
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8636
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8639

  RESULTS:
  RAW:         median(top-10)=0.9334, mean(top-10)=0.9276, median(all)=0.8458, mean(all)=0.8018
  + SMOOTHING: median(top-10)=0.9588, mean(top-10)=0.9571, median(all)=0.8951, mean(all)=0.8636 [+0.0254]
  + MRF:       median(top-10)=0.9590, mean(top-10)=0.9572, median(all)=0.8965, mean(all)=0.8639 [+0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0255

================================================================================
Subject: MMRR-21-19
================================================================================
  Step 0: Generating predictions with V2 model...
  Mesh: 145253 vertices, 290502 faces
  Rendering and predicting ALL 20 views...
    ✓ Front (view_id=0): shape (37, 800, 800)
    ✓ Back (view_id=1): shape (37, 800, 800)
    ✓ Left (view_id=2): shape (37, 800, 800)
    ✓ Right (view_id=3): shape (37, 800, 800)
    ✓ Top (view_id=4): shape (37, 800, 800)
    ✓ Bottom (view_id=5): shape (37, 800, 800)
    ✓ FrontLeft (view_id=6): shape (37, 800, 800)
    ✓ FrontRight (view_id=7): shape (37, 800, 800)
    ✓ BackLeft (view_id=8): shape (37, 800, 800)
    ✓ BackRight (view_id=9): shape (37, 800, 800)
    ✓ TopFront (view_id=10): shape (37, 800, 800)
    ✓ TopBack (view_id=11): shape (37, 800, 800)
    ✓ TopLeft (view_id=12): shape (37, 800, 800)
    ✓ TopRight (view_id=13): shape (37, 800, 800)
    ✓ BottomFront (view_id=14): shape (37, 800, 800)
    ✓ BottomBack (view_id=15): shape (37, 800, 800)
    ✓ BottomLeft (view_id=16): shape (37, 800, 800)
    ✓ BottomRight (view_id=17): shape (37, 800, 800)
    ✓ LeftTop (view_id=18): shape (37, 800, 800)
    ✓ RightTop (view_id=19): shape (37, 800, 800)
  ✓ Predictions from all 20 views aggregated
    P stats: min=0.0000, max=1.0000, mean=0.0249
    Non-zero vertices: 133671/145253
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 11582  1664  1146  3234     0  1736  1232  5156  7571]
  Ground Truth Stats:
    Labels shape: (145253,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-19/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7802
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8421
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8423

  RESULTS:
  RAW:         median(top-10)=0.9123, mean(top-10)=0.9177, median(all)=0.8496, mean(all)=0.7802
  + SMOOTHING: median(top-10)=0.9379, mean(top-10)=0.9396, median(all)=0.8932, mean(all)=0.8421 [+0.0256]
  + MRF:       median(top-10)=0.9381, mean(top-10)=0.9398, median(all)=0.8931, mean(all)=0.8423 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0258

================================================================================
Subject: MMRR-21-2
================================================================================
  Step 0: Generating predictions with V2 model...
  Mesh: 148593 vertices, 297182 faces
  Rendering and predicting ALL 20 views...
    ✓ Front (view_id=0): shape (37, 800, 800)
    ✓ Back (view_id=1): shape (37, 800, 800)
    ✓ Left (view_id=2): shape (37, 800, 800)
    ✓ Right (view_id=3): shape (37, 800, 800)
    ✓ Top (view_id=4): shape (37, 800, 800)
    ✓ Bottom (view_id=5): shape (37, 800, 800)
    ✓ FrontLeft (view_id=6): shape (37, 800, 800)
    ✓ FrontRight (view_id=7): shape (37, 800, 800)
    ✓ BackLeft (view_id=8): shape (37, 800, 800)
    ✓ BackRight (view_id=9): shape (37, 800, 800)
    ✓ TopFront (view_id=10): shape (37, 800, 800)
    ✓ TopBack (view_id=11): shape (37, 800, 800)
    ✓ TopLeft (view_id=12): shape (37, 800, 800)
    ✓ TopRight (view_id=13): shape (37, 800, 800)
    ✓ BottomFront (view_id=14): shape (37, 800, 800)
    ✓ BottomBack (view_id=15): shape (37, 800, 800)
    ✓ BottomLeft (view_id=16): shape (37, 800, 800)
    ✓ BottomRight (view_id=17): shape (37, 800, 800)
    ✓ LeftTop (view_id=18): shape (37, 800, 800)
    ✓ RightTop (view_id=19): shape (37, 800, 800)
  ✓ Predictions from all 20 views aggregated
    P stats: min=0.0000, max=1.0000, mean=0.0245
    Non-zero vertices: 134596/148593
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 13997  1108  1227  4090     0  2316  1169  5056  6534]
  Ground Truth Stats:
    Labels shape: (148593,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-2/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7927
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8645
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8646

  RESULTS:
  RAW:         median(top-10)=0.9115, mean(top-10)=0.9114, median(all)=0.8632, mean(all)=0.7927
  + SMOOTHING: median(top-10)=0.9483, mean(top-10)=0.9479, median(all)=0.9075, mean(all)=0.8645 [+0.0368]
  + MRF:       median(top-10)=0.9484, mean(top-10)=0.9481, median(all)=0.9079, mean(all)=0.8646 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0370

================================================================================
Subject: MMRR-21-20
================================================================================
  Step 0: Generating predictions with V2 model...
  Mesh: 149927 vertices, 299850 faces
  Rendering and predicting ALL 20 views...
    ✓ Front (view_id=0): shape (37, 800, 800)
    ✓ Back (view_id=1): shape (37, 800, 800)
    ✓ Left (view_id=2): shape (37, 800, 800)
    ✓ Right (view_id=3): shape (37, 800, 800)
    ✓ Top (view_id=4): shape (37, 800, 800)
    ✓ Bottom (view_id=5): shape (37, 800, 800)
    ✓ FrontLeft (view_id=6): shape (37, 800, 800)
    ✓ FrontRight (view_id=7): shape (37, 800, 800)
    ✓ BackLeft (view_id=8): shape (37, 800, 800)
    ✓ BackRight (view_id=9): shape (37, 800, 800)
    ✓ TopFront (view_id=10): shape (37, 800, 800)
    ✓ TopBack (view_id=11): shape (37, 800, 800)
    ✓ TopLeft (view_id=12): shape (37, 800, 800)
    ✓ TopRight (view_id=13): shape (37, 800, 800)
    ✓ BottomFront (view_id=14): shape (37, 800, 800)
    ✓ BottomBack (view_id=15): shape (37, 800, 800)
    ✓ BottomLeft (view_id=16): shape (37, 800, 800)
    ✓ BottomRight (view_id=17): shape (37, 800, 800)
    ✓ LeftTop (view_id=18): shape (37, 800, 800)
    ✓ RightTop (view_id=19): shape (37, 800, 800)
  ✓ Predictions from all 20 views aggregated
    P stats: min=0.0000, max=1.0000, mean=0.0243
    Non-zero vertices: 134870/149927
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 15057  1398  1219  3280     0  2047  1077  5343  6439]
  Ground Truth Stats:
    Labels shape: (149927,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-20/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7938
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8639
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8641

  RESULTS:
  RAW:         median(top-10)=0.9127, mean(top-10)=0.9144, median(all)=0.8528, mean(all)=0.7938
  + SMOOTHING: median(top-10)=0.9481, mean(top-10)=0.9466, median(all)=0.8950, mean(all)=0.8639 [+0.0354]
  + MRF:       median(top-10)=0.9483, mean(top-10)=0.9468, median(all)=0.8950, mean(all)=0.8641 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0356

================================================================================
Subject: MMRR-21-21
================================================================================
  Step 0: Generating predictions with V2 model...
  Mesh: 137496 vertices, 274988 faces
  Rendering and predicting ALL 20 views...
    ✓ Front (view_id=0): shape (37, 800, 800)
    ✓ Back (view_id=1): shape (37, 800, 800)
    ✓ Left (view_id=2): shape (37, 800, 800)
    ✓ Right (view_id=3): shape (37, 800, 800)
    ✓ Top (view_id=4): shape (37, 800, 800)
    ✓ Bottom (view_id=5): shape (37, 800, 800)
    ✓ FrontLeft (view_id=6): shape (37, 800, 800)
    ✓ FrontRight (view_id=7): shape (37, 800, 800)
    ✓ BackLeft (view_id=8): shape (37, 800, 800)
    ✓ BackRight (view_id=9): shape (37, 800, 800)
    ✓ TopFront (view_id=10): shape (37, 800, 800)
    ✓ TopBack (view_id=11): shape (37, 800, 800)
    ✓ TopLeft (view_id=12): shape (37, 800, 800)
    ✓ TopRight (view_id=13): shape (37, 800, 800)
    ✓ BottomFront (view_id=14): shape (37, 800, 800)
    ✓ BottomBack (view_id=15): shape (37, 800, 800)
    ✓ BottomLeft (view_id=16): shape (37, 800, 800)
    ✓ BottomRight (view_id=17): shape (37, 800, 800)
    ✓ LeftTop (view_id=18): shape (37, 800, 800)
    ✓ RightTop (view_id=19): shape (37, 800, 800)
  ✓ Predictions from all 20 views aggregated
    P stats: min=0.0000, max=1.0000, mean=0.0248
    Non-zero vertices: 125993/137496
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 11503  1491  1255  3437     0  2111  1376  4751  6813]
  Ground Truth Stats:
    Labels shape: (137496,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-21/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7931
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8553
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8554

  RESULTS:
  RAW:         median(top-10)=0.9218, mean(top-10)=0.9193, median(all)=0.8543, mean(all)=0.7931
  + SMOOTHING: median(top-10)=0.9470, mean(top-10)=0.9451, median(all)=0.8906, mean(all)=0.8553 [+0.0252]
  + MRF:       median(top-10)=0.9474, mean(top-10)=0.9455, median(all)=0.8904, mean(all)=0.8554 [+0.0004]
  TOTAL IMPROVEMENT (median top-10): +0.0256

================================================================================
Subject: MMRR-21-3
================================================================================
  Step 0: Generating predictions with V2 model...
  Mesh: 144159 vertices, 288314 faces
  Rendering and predicting ALL 20 views...
    ✓ Front (view_id=0): shape (37, 800, 800)
    ✓ Back (view_id=1): shape (37, 800, 800)
    ✓ Left (view_id=2): shape (37, 800, 800)
    ✓ Right (view_id=3): shape (37, 800, 800)
    ✓ Top (view_id=4): shape (37, 800, 800)
    ✓ Bottom (view_id=5): shape (37, 800, 800)
    ✓ FrontLeft (view_id=6): shape (37, 800, 800)
    ✓ FrontRight (view_id=7): shape (37, 800, 800)
    ✓ BackLeft (view_id=8): shape (37, 800, 800)
    ✓ BackRight (view_id=9): shape (37, 800, 800)
    ✓ TopFront (view_id=10): shape (37, 800, 800)
    ✓ TopBack (view_id=11): shape (37, 800, 800)
    ✓ TopLeft (view_id=12): shape (37, 800, 800)
    ✓ TopRight (view_id=13): shape (37, 800, 800)
    ✓ BottomFront (view_id=14): shape (37, 800, 800)
    ✓ BottomBack (view_id=15): shape (37, 800, 800)
    ✓ BottomLeft (view_id=16): shape (37, 800, 800)
    ✓ BottomRight (view_id=17): shape (37, 800, 800)
    ✓ LeftTop (view_id=18): shape (37, 800, 800)
    ✓ RightTop (view_id=19): shape (37, 800, 800)
  ✓ Predictions from all 20 views aggregated
    P stats: min=0.0000, max=1.0000, mean=0.0250
    Non-zero vertices: 133508/144159
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 10651  1100  1138  3644     0  2177  1468  4658  6530]
  Ground Truth Stats:
    Labels shape: (144159,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-3/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.8065
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8710
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8711

  RESULTS:
  RAW:         median(top-10)=0.9157, mean(top-10)=0.9282, median(all)=0.8695, mean(all)=0.8065
  + SMOOTHING: median(top-10)=0.9590, mean(top-10)=0.9561, median(all)=0.9102, mean(all)=0.8710 [+0.0433]
  + MRF:       median(top-10)=0.9591, mean(top-10)=0.9562, median(all)=0.9107, mean(all)=0.8711 [+0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0434

================================================================================
Subject: MMRR-21-4
================================================================================
  Step 0: Generating predictions with V2 model...
  Mesh: 118034 vertices, 236064 faces
  Rendering and predicting ALL 20 views...
    ✓ Front (view_id=0): shape (37, 800, 800)
    ✓ Back (view_id=1): shape (37, 800, 800)
    ✓ Left (view_id=2): shape (37, 800, 800)
    ✓ Right (view_id=3): shape (37, 800, 800)
    ✓ Top (view_id=4): shape (37, 800, 800)
    ✓ Bottom (view_id=5): shape (37, 800, 800)
    ✓ FrontLeft (view_id=6): shape (37, 800, 800)
    ✓ FrontRight (view_id=7): shape (37, 800, 800)
    ✓ BackLeft (view_id=8): shape (37, 800, 800)
    ✓ BackRight (view_id=9): shape (37, 800, 800)
    ✓ TopFront (view_id=10): shape (37, 800, 800)
    ✓ TopBack (view_id=11): shape (37, 800, 800)
    ✓ TopLeft (view_id=12): shape (37, 800, 800)
    ✓ TopRight (view_id=13): shape (37, 800, 800)
    ✓ BottomFront (view_id=14): shape (37, 800, 800)
    ✓ BottomBack (view_id=15): shape (37, 800, 800)
    ✓ BottomLeft (view_id=16): shape (37, 800, 800)
    ✓ BottomRight (view_id=17): shape (37, 800, 800)
    ✓ LeftTop (view_id=18): shape (37, 800, 800)
    ✓ RightTop (view_id=19): shape (37, 800, 800)
  ✓ Predictions from all 20 views aggregated
    P stats: min=0.0000, max=1.0000, mean=0.0253
    Non-zero vertices: 110600/118034
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 7434  988 1027 2974    0 1993 1405 4098 4572]
  Ground Truth Stats:
    Labels shape: (118034,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-4/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.8014
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8550
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8554

  RESULTS:
  RAW:         median(top-10)=0.9283, mean(top-10)=0.9336, median(all)=0.8672, mean(all)=0.8014
  + SMOOTHING: median(top-10)=0.9560, mean(top-10)=0.9550, median(all)=0.9078, mean(all)=0.8550 [+0.0278]
  + MRF:       median(top-10)=0.9561, mean(top-10)=0.9551, median(all)=0.9082, mean(all)=0.8554 [+0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0279

================================================================================
Subject: MMRR-21-5
================================================================================
  Step 0: Generating predictions with V2 model...
  Mesh: 145215 vertices, 290426 faces
  Rendering and predicting ALL 20 views...
    ✓ Front (view_id=0): shape (37, 800, 800)
    ✓ Back (view_id=1): shape (37, 800, 800)
    ✓ Left (view_id=2): shape (37, 800, 800)
    ✓ Right (view_id=3): shape (37, 800, 800)
    ✓ Top (view_id=4): shape (37, 800, 800)
    ✓ Bottom (view_id=5): shape (37, 800, 800)
    ✓ FrontLeft (view_id=6): shape (37, 800, 800)
    ✓ FrontRight (view_id=7): shape (37, 800, 800)
    ✓ BackLeft (view_id=8): shape (37, 800, 800)
    ✓ BackRight (view_id=9): shape (37, 800, 800)
    ✓ TopFront (view_id=10): shape (37, 800, 800)
    ✓ TopBack (view_id=11): shape (37, 800, 800)
    ✓ TopLeft (view_id=12): shape (37, 800, 800)
    ✓ TopRight (view_id=13): shape (37, 800, 800)
    ✓ BottomFront (view_id=14): shape (37, 800, 800)
    ✓ BottomBack (view_id=15): shape (37, 800, 800)
    ✓ BottomLeft (view_id=16): shape (37, 800, 800)
    ✓ BottomRight (view_id=17): shape (37, 800, 800)
    ✓ LeftTop (view_id=18): shape (37, 800, 800)
    ✓ RightTop (view_id=19): shape (37, 800, 800)
  ✓ Predictions from all 20 views aggregated
    P stats: min=0.0000, max=1.0000, mean=0.0247
    Non-zero vertices: 132883/145215
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 12332  1396  1332  4313     0  1968  1207  3856  6110]
  Ground Truth Stats:
    Labels shape: (145215,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-5/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7991
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8648
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8651

  RESULTS:
  RAW:         median(top-10)=0.9164, mean(top-10)=0.9180, median(all)=0.8530, mean(all)=0.7991
  + SMOOTHING: median(top-10)=0.9455, mean(top-10)=0.9465, median(all)=0.9137, mean(all)=0.8648 [+0.0291]
  + MRF:       median(top-10)=0.9458, mean(top-10)=0.9466, median(all)=0.9141, mean(all)=0.8651 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0294

================================================================================
Subject: MMRR-21-6
================================================================================
  Step 0: Generating predictions with V2 model...
  Mesh: 128994 vertices, 257984 faces
  Rendering and predicting ALL 20 views...
    ✓ Front (view_id=0): shape (37, 800, 800)
    ✓ Back (view_id=1): shape (37, 800, 800)
    ✓ Left (view_id=2): shape (37, 800, 800)
    ✓ Right (view_id=3): shape (37, 800, 800)
    ✓ Top (view_id=4): shape (37, 800, 800)
    ✓ Bottom (view_id=5): shape (37, 800, 800)
    ✓ FrontLeft (view_id=6): shape (37, 800, 800)
    ✓ FrontRight (view_id=7): shape (37, 800, 800)
    ✓ BackLeft (view_id=8): shape (37, 800, 800)
    ✓ BackRight (view_id=9): shape (37, 800, 800)
    ✓ TopFront (view_id=10): shape (37, 800, 800)
    ✓ TopBack (view_id=11): shape (37, 800, 800)
    ✓ TopLeft (view_id=12): shape (37, 800, 800)
    ✓ TopRight (view_id=13): shape (37, 800, 800)
    ✓ BottomFront (view_id=14): shape (37, 800, 800)
    ✓ BottomBack (view_id=15): shape (37, 800, 800)
    ✓ BottomLeft (view_id=16): shape (37, 800, 800)
    ✓ BottomRight (view_id=17): shape (37, 800, 800)
    ✓ LeftTop (view_id=18): shape (37, 800, 800)
    ✓ RightTop (view_id=19): shape (37, 800, 800)
  ✓ Predictions from all 20 views aggregated
    P stats: min=0.0000, max=1.0000, mean=0.0248
    Non-zero vertices: 118173/128994
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 10821  1528  1170  3711     0  2113  1049  5096  4918]
  Ground Truth Stats:
    Labels shape: (128994,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-6/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7971
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8615
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8617

  RESULTS:
  RAW:         median(top-10)=0.9051, mean(top-10)=0.9102, median(all)=0.8608, mean(all)=0.7971
  + SMOOTHING: median(top-10)=0.9393, mean(top-10)=0.9402, median(all)=0.9027, mean(all)=0.8615 [+0.0342]
  + MRF:       median(top-10)=0.9398, mean(top-10)=0.9404, median(all)=0.9030, mean(all)=0.8617 [+0.0005]
  TOTAL IMPROVEMENT (median top-10): +0.0348

================================================================================
Subject: MMRR-21-7
================================================================================
  Step 0: Generating predictions with V2 model...
  Mesh: 148998 vertices, 297992 faces
  Rendering and predicting ALL 20 views...
    ✓ Front (view_id=0): shape (37, 800, 800)
    ✓ Back (view_id=1): shape (37, 800, 800)
    ✓ Left (view_id=2): shape (37, 800, 800)
    ✓ Right (view_id=3): shape (37, 800, 800)
    ✓ Top (view_id=4): shape (37, 800, 800)
    ✓ Bottom (view_id=5): shape (37, 800, 800)
    ✓ FrontLeft (view_id=6): shape (37, 800, 800)
    ✓ FrontRight (view_id=7): shape (37, 800, 800)
    ✓ BackLeft (view_id=8): shape (37, 800, 800)
    ✓ BackRight (view_id=9): shape (37, 800, 800)
    ✓ TopFront (view_id=10): shape (37, 800, 800)
    ✓ TopBack (view_id=11): shape (37, 800, 800)
    ✓ TopLeft (view_id=12): shape (37, 800, 800)
    ✓ TopRight (view_id=13): shape (37, 800, 800)
    ✓ BottomFront (view_id=14): shape (37, 800, 800)
    ✓ BottomBack (view_id=15): shape (37, 800, 800)
    ✓ BottomLeft (view_id=16): shape (37, 800, 800)
    ✓ BottomRight (view_id=17): shape (37, 800, 800)
    ✓ LeftTop (view_id=18): shape (37, 800, 800)
    ✓ RightTop (view_id=19): shape (37, 800, 800)
  ✓ Predictions from all 20 views aggregated
    P stats: min=0.0000, max=1.0000, mean=0.0247
    Non-zero vertices: 136072/148998
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 12926  1177  1505  3300     0  2292  1324  5388  6264]
  Ground Truth Stats:
    Labels shape: (148998,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-7/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.8046
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8662
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8663

  RESULTS:
  RAW:         median(top-10)=0.9106, mean(top-10)=0.9169, median(all)=0.8730, mean(all)=0.8046
  + SMOOTHING: median(top-10)=0.9445, mean(top-10)=0.9467, median(all)=0.9139, mean(all)=0.8662 [+0.0339]
  + MRF:       median(top-10)=0.9446, mean(top-10)=0.9468, median(all)=0.9142, mean(all)=0.8663 [+0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0340

================================================================================
Subject: MMRR-21-8
================================================================================
  Step 0: Generating predictions with V2 model...
  Mesh: 124399 vertices, 248794 faces
  Rendering and predicting ALL 20 views...
    ✓ Front (view_id=0): shape (37, 800, 800)
    ✓ Back (view_id=1): shape (37, 800, 800)
    ✓ Left (view_id=2): shape (37, 800, 800)
    ✓ Right (view_id=3): shape (37, 800, 800)
    ✓ Top (view_id=4): shape (37, 800, 800)
    ✓ Bottom (view_id=5): shape (37, 800, 800)
    ✓ FrontLeft (view_id=6): shape (37, 800, 800)
    ✓ FrontRight (view_id=7): shape (37, 800, 800)
    ✓ BackLeft (view_id=8): shape (37, 800, 800)
    ✓ BackRight (view_id=9): shape (37, 800, 800)
    ✓ TopFront (view_id=10): shape (37, 800, 800)
    ✓ TopBack (view_id=11): shape (37, 800, 800)
    ✓ TopLeft (view_id=12): shape (37, 800, 800)
    ✓ TopRight (view_id=13): shape (37, 800, 800)
    ✓ BottomFront (view_id=14): shape (37, 800, 800)
    ✓ BottomBack (view_id=15): shape (37, 800, 800)
    ✓ BottomLeft (view_id=16): shape (37, 800, 800)
    ✓ BottomRight (view_id=17): shape (37, 800, 800)
    ✓ LeftTop (view_id=18): shape (37, 800, 800)
    ✓ RightTop (view_id=19): shape (37, 800, 800)
  ✓ Predictions from all 20 views aggregated
    P stats: min=0.0000, max=1.0000, mean=0.0250
    Non-zero vertices: 114871/124399
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 9528 1153 1177 3198    0 1912 1173 4074 5780]
  Ground Truth Stats:
    Labels shape: (124399,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-8/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.8003
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8587
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8587

  RESULTS:
  RAW:         median(top-10)=0.9174, mean(top-10)=0.9201, median(all)=0.8716, mean(all)=0.8003
  + SMOOTHING: median(top-10)=0.9424, mean(top-10)=0.9449, median(all)=0.9110, mean(all)=0.8587 [+0.0250]
  + MRF:       median(top-10)=0.9427, mean(top-10)=0.9450, median(all)=0.9112, mean(all)=0.8587 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0253

================================================================================
Subject: MMRR-21-9
================================================================================
  Step 0: Generating predictions with V2 model...
  Mesh: 131827 vertices, 263650 faces
  Rendering and predicting ALL 20 views...
    ✓ Front (view_id=0): shape (37, 800, 800)
    ✓ Back (view_id=1): shape (37, 800, 800)
    ✓ Left (view_id=2): shape (37, 800, 800)
    ✓ Right (view_id=3): shape (37, 800, 800)
    ✓ Top (view_id=4): shape (37, 800, 800)
    ✓ Bottom (view_id=5): shape (37, 800, 800)
    ✓ FrontLeft (view_id=6): shape (37, 800, 800)
    ✓ FrontRight (view_id=7): shape (37, 800, 800)
    ✓ BackLeft (view_id=8): shape (37, 800, 800)
    ✓ BackRight (view_id=9): shape (37, 800, 800)
    ✓ TopFront (view_id=10): shape (37, 800, 800)
    ✓ TopBack (view_id=11): shape (37, 800, 800)
    ✓ TopLeft (view_id=12): shape (37, 800, 800)
    ✓ TopRight (view_id=13): shape (37, 800, 800)
    ✓ BottomFront (view_id=14): shape (37, 800, 800)
    ✓ BottomBack (view_id=15): shape (37, 800, 800)
    ✓ BottomLeft (view_id=16): shape (37, 800, 800)
    ✓ BottomRight (view_id=17): shape (37, 800, 800)
    ✓ LeftTop (view_id=18): shape (37, 800, 800)
    ✓ RightTop (view_id=19): shape (37, 800, 800)
  ✓ Predictions from all 20 views aggregated
    P stats: min=0.0000, max=1.0000, mean=0.0249
    Non-zero vertices: 121401/131827
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 10426  1048  1203  3713     0  1707  1059  4740  6071]
  Ground Truth Stats:
    Labels shape: (131827,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-9/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.8038
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8689
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8691

  RESULTS:
  RAW:         median(top-10)=0.9179, mean(top-10)=0.9214, median(all)=0.8522, mean(all)=0.8038
  + SMOOTHING: median(top-10)=0.9411, mean(top-10)=0.9444, median(all)=0.9096, mean(all)=0.8689 [+0.0232]
  + MRF:       median(top-10)=0.9412, mean(top-10)=0.9443, median(all)=0.9096, mean(all)=0.8691 [+0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0233

================================================================================
Subject: MMRR-3T7T-2-1
================================================================================
  Step 0: Generating predictions with V2 model...
  Mesh: 150156 vertices, 300308 faces
  Rendering and predicting ALL 20 views...
    ✓ Front (view_id=0): shape (37, 800, 800)
    ✓ Back (view_id=1): shape (37, 800, 800)
    ✓ Left (view_id=2): shape (37, 800, 800)
    ✓ Right (view_id=3): shape (37, 800, 800)
    ✓ Top (view_id=4): shape (37, 800, 800)
    ✓ Bottom (view_id=5): shape (37, 800, 800)
    ✓ FrontLeft (view_id=6): shape (37, 800, 800)
    ✓ FrontRight (view_id=7): shape (37, 800, 800)
    ✓ BackLeft (view_id=8): shape (37, 800, 800)
    ✓ BackRight (view_id=9): shape (37, 800, 800)
    ✓ TopFront (view_id=10): shape (37, 800, 800)
    ✓ TopBack (view_id=11): shape (37, 800, 800)
    ✓ TopLeft (view_id=12): shape (37, 800, 800)
    ✓ TopRight (view_id=13): shape (37, 800, 800)
    ✓ BottomFront (view_id=14): shape (37, 800, 800)
    ✓ BottomBack (view_id=15): shape (37, 800, 800)
    ✓ BottomLeft (view_id=16): shape (37, 800, 800)
    ✓ BottomRight (view_id=17): shape (37, 800, 800)
    ✓ LeftTop (view_id=18): shape (37, 800, 800)
    ✓ RightTop (view_id=19): shape (37, 800, 800)
  ✓ Predictions from all 20 views aggregated
    P stats: min=0.0000, max=1.0000, mean=0.0249
    Non-zero vertices: 138400/150156
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 11756  1555  1184  3679     0  1733  1271  5584  7488]
  Ground Truth Stats:
    Labels shape: (150156,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-3T7T-2-1/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7971
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8628
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8630

  RESULTS:
  RAW:         median(top-10)=0.9130, mean(top-10)=0.9186, median(all)=0.8607, mean(all)=0.7971
  + SMOOTHING: median(top-10)=0.9510, mean(top-10)=0.9506, median(all)=0.8967, mean(all)=0.8628 [+0.0381]
  + MRF:       median(top-10)=0.9512, mean(top-10)=0.9509, median(all)=0.8970, mean(all)=0.8630 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0382

================================================================================
Subject: MMRR-3T7T-2-2
================================================================================
  Step 0: Generating predictions with V2 model...
  Mesh: 135252 vertices, 270500 faces
  Rendering and predicting ALL 20 views...
    ✓ Front (view_id=0): shape (37, 800, 800)
    ✓ Back (view_id=1): shape (37, 800, 800)
    ✓ Left (view_id=2): shape (37, 800, 800)
    ✓ Right (view_id=3): shape (37, 800, 800)
    ✓ Top (view_id=4): shape (37, 800, 800)
    ✓ Bottom (view_id=5): shape (37, 800, 800)
    ✓ FrontLeft (view_id=6): shape (37, 800, 800)
    ✓ FrontRight (view_id=7): shape (37, 800, 800)
    ✓ BackLeft (view_id=8): shape (37, 800, 800)
    ✓ BackRight (view_id=9): shape (37, 800, 800)
    ✓ TopFront (view_id=10): shape (37, 800, 800)
    ✓ TopBack (view_id=11): shape (37, 800, 800)
    ✓ TopLeft (view_id=12): shape (37, 800, 800)
    ✓ TopRight (view_id=13): shape (37, 800, 800)
    ✓ BottomFront (view_id=14): shape (37, 800, 800)
    ✓ BottomBack (view_id=15): shape (37, 800, 800)
    ✓ BottomLeft (view_id=16): shape (37, 800, 800)
    ✓ BottomRight (view_id=17): shape (37, 800, 800)
    ✓ LeftTop (view_id=18): shape (37, 800, 800)
    ✓ RightTop (view_id=19): shape (37, 800, 800)
  ✓ Predictions from all 20 views aggregated
    P stats: min=0.0000, max=1.0000, mean=0.0249
    Non-zero vertices: 124493/135252
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 10759  1373  1147  2837     0  1672  1110  4075  6602]
  Ground Truth Stats:
    Labels shape: (135252,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-3T7T-2-2/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7964
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8571
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8569

  RESULTS:
  RAW:         median(top-10)=0.9164, mean(top-10)=0.9174, median(all)=0.8665, mean(all)=0.7964
  + SMOOTHING: median(top-10)=0.9505, mean(top-10)=0.9469, median(all)=0.9015, mean(all)=0.8571 [+0.0341]
  + MRF:       median(top-10)=0.9504, mean(top-10)=0.9468, median(all)=0.9017, mean(all)=0.8569 [-0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0340

================================================================================
Subject: NKI-RS-22-1
================================================================================
  Step 0: Generating predictions with V2 model...
  Mesh: 137338 vertices, 274672 faces
  Rendering and predicting ALL 20 views...
    ✓ Front (view_id=0): shape (37, 800, 800)
    ✓ Back (view_id=1): shape (37, 800, 800)
    ✓ Left (view_id=2): shape (37, 800, 800)
    ✓ Right (view_id=3): shape (37, 800, 800)
    ✓ Top (view_id=4): shape (37, 800, 800)
    ✓ Bottom (view_id=5): shape (37, 800, 800)
    ✓ FrontLeft (view_id=6): shape (37, 800, 800)
    ✓ FrontRight (view_id=7): shape (37, 800, 800)
    ✓ BackLeft (view_id=8): shape (37, 800, 800)
    ✓ BackRight (view_id=9): shape (37, 800, 800)
    ✓ TopFront (view_id=10): shape (37, 800, 800)
    ✓ TopBack (view_id=11): shape (37, 800, 800)
    ✓ TopLeft (view_id=12): shape (37, 800, 800)
    ✓ TopRight (view_id=13): shape (37, 800, 800)
    ✓ BottomFront (view_id=14): shape (37, 800, 800)
    ✓ BottomBack (view_id=15): shape (37, 800, 800)
    ✓ BottomLeft (view_id=16): shape (37, 800, 800)
    ✓ BottomRight (view_id=17): shape (37, 800, 800)
    ✓ LeftTop (view_id=18): shape (37, 800, 800)
    ✓ RightTop (view_id=19): shape (37, 800, 800)
  ✓ Predictions from all 20 views aggregated
    P stats: min=0.0000, max=1.0000, mean=0.0249
    Non-zero vertices: 126783/137338
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 10555  1305   899  3157     0  2204  1324  4895  5943]
  Ground Truth Stats:
    Labels shape: (137338,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-1/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.8028
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8605
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8605

  RESULTS:
  RAW:         median(top-10)=0.9194, mean(top-10)=0.9230, median(all)=0.8561, mean(all)=0.8028
  + SMOOTHING: median(top-10)=0.9519, mean(top-10)=0.9525, median(all)=0.8987, mean(all)=0.8605 [+0.0325]
  + MRF:       median(top-10)=0.9520, mean(top-10)=0.9525, median(all)=0.8988, mean(all)=0.8605 [+0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0326

================================================================================
Subject: NKI-RS-22-10
================================================================================
  Step 0: Generating predictions with V2 model...
  Mesh: 130448 vertices, 260892 faces
  Rendering and predicting ALL 20 views...
    ✓ Front (view_id=0): shape (37, 800, 800)
    ✓ Back (view_id=1): shape (37, 800, 800)
    ✓ Left (view_id=2): shape (37, 800, 800)
    ✓ Right (view_id=3): shape (37, 800, 800)
    ✓ Top (view_id=4): shape (37, 800, 800)
    ✓ Bottom (view_id=5): shape (37, 800, 800)
    ✓ FrontLeft (view_id=6): shape (37, 800, 800)
    ✓ FrontRight (view_id=7): shape (37, 800, 800)
    ✓ BackLeft (view_id=8): shape (37, 800, 800)
    ✓ BackRight (view_id=9): shape (37, 800, 800)
    ✓ TopFront (view_id=10): shape (37, 800, 800)
    ✓ TopBack (view_id=11): shape (37, 800, 800)
    ✓ TopLeft (view_id=12): shape (37, 800, 800)
    ✓ TopRight (view_id=13): shape (37, 800, 800)
    ✓ BottomFront (view_id=14): shape (37, 800, 800)
    ✓ BottomBack (view_id=15): shape (37, 800, 800)
    ✓ BottomLeft (view_id=16): shape (37, 800, 800)
    ✓ BottomRight (view_id=17): shape (37, 800, 800)
    ✓ LeftTop (view_id=18): shape (37, 800, 800)
    ✓ RightTop (view_id=19): shape (37, 800, 800)
  ✓ Predictions from all 20 views aggregated
    P stats: min=0.0000, max=1.0000, mean=0.0255
    Non-zero vertices: 122900/130448
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 7548 1239 1083 2627    0 1722 1228 4525 6670]
  Ground Truth Stats:
    Labels shape: (130448,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-10/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.8102
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8710
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8709

  RESULTS:
  RAW:         median(top-10)=0.9271, mean(top-10)=0.9300, median(all)=0.8821, mean(all)=0.8102
  + SMOOTHING: median(top-10)=0.9515, mean(top-10)=0.9530, median(all)=0.9157, mean(all)=0.8710 [+0.0244]
  + MRF:       median(top-10)=0.9516, mean(top-10)=0.9530, median(all)=0.9150, mean(all)=0.8709 [+0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0245

================================================================================
Subject: NKI-RS-22-11
================================================================================
  Step 0: Generating predictions with V2 model...
  Mesh: 138161 vertices, 276318 faces
  Rendering and predicting ALL 20 views...
    ✓ Front (view_id=0): shape (37, 800, 800)
    ✓ Back (view_id=1): shape (37, 800, 800)
    ✓ Left (view_id=2): shape (37, 800, 800)
    ✓ Right (view_id=3): shape (37, 800, 800)
    ✓ Top (view_id=4): shape (37, 800, 800)
    ✓ Bottom (view_id=5): shape (37, 800, 800)
    ✓ FrontLeft (view_id=6): shape (37, 800, 800)
    ✓ FrontRight (view_id=7): shape (37, 800, 800)
    ✓ BackLeft (view_id=8): shape (37, 800, 800)
    ✓ BackRight (view_id=9): shape (37, 800, 800)
    ✓ TopFront (view_id=10): shape (37, 800, 800)
    ✓ TopBack (view_id=11): shape (37, 800, 800)
    ✓ TopLeft (view_id=12): shape (37, 800, 800)
    ✓ TopRight (view_id=13): shape (37, 800, 800)
    ✓ BottomFront (view_id=14): shape (37, 800, 800)
    ✓ BottomBack (view_id=15): shape (37, 800, 800)
    ✓ BottomLeft (view_id=16): shape (37, 800, 800)
    ✓ BottomRight (view_id=17): shape (37, 800, 800)
    ✓ LeftTop (view_id=18): shape (37, 800, 800)
    ✓ RightTop (view_id=19): shape (37, 800, 800)
  ✓ Predictions from all 20 views aggregated
    P stats: min=0.0000, max=1.0000, mean=0.0248
    Non-zero vertices: 126566/138161
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 11595  1383  1280  3613     0  2310  1275  4162  5891]
  Ground Truth Stats:
    Labels shape: (138161,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-11/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.8005
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8650
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8649

  RESULTS:
  RAW:         median(top-10)=0.9218, mean(top-10)=0.9256, median(all)=0.8618, mean(all)=0.8005
  + SMOOTHING: median(top-10)=0.9482, mean(top-10)=0.9523, median(all)=0.9171, mean(all)=0.8650 [+0.0264]
  + MRF:       median(top-10)=0.9480, mean(top-10)=0.9524, median(all)=0.9171, mean(all)=0.8649 [-0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0263

================================================================================
Subject: NKI-RS-22-12
================================================================================
  Step 0: Generating predictions with V2 model...
  Mesh: 144832 vertices, 289660 faces
  Rendering and predicting ALL 20 views...
    ✓ Front (view_id=0): shape (37, 800, 800)
    ✓ Back (view_id=1): shape (37, 800, 800)
    ✓ Left (view_id=2): shape (37, 800, 800)
    ✓ Right (view_id=3): shape (37, 800, 800)
    ✓ Top (view_id=4): shape (37, 800, 800)
    ✓ Bottom (view_id=5): shape (37, 800, 800)
    ✓ FrontLeft (view_id=6): shape (37, 800, 800)
    ✓ FrontRight (view_id=7): shape (37, 800, 800)
    ✓ BackLeft (view_id=8): shape (37, 800, 800)
    ✓ BackRight (view_id=9): shape (37, 800, 800)
    ✓ TopFront (view_id=10): shape (37, 800, 800)
    ✓ TopBack (view_id=11): shape (37, 800, 800)
    ✓ TopLeft (view_id=12): shape (37, 800, 800)
    ✓ TopRight (view_id=13): shape (37, 800, 800)
    ✓ BottomFront (view_id=14): shape (37, 800, 800)
    ✓ BottomBack (view_id=15): shape (37, 800, 800)
    ✓ BottomLeft (view_id=16): shape (37, 800, 800)
    ✓ BottomRight (view_id=17): shape (37, 800, 800)
    ✓ LeftTop (view_id=18): shape (37, 800, 800)
    ✓ RightTop (view_id=19): shape (37, 800, 800)
  ✓ Predictions from all 20 views aggregated
    P stats: min=0.0000, max=1.0000, mean=0.0248
    Non-zero vertices: 133102/144832
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 11730  1278  1323  2801     0  2620  1293  4495  5943]
  Ground Truth Stats:
    Labels shape: (144832,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-12/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.8030
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8621
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8622

  RESULTS:
  RAW:         median(top-10)=0.9195, mean(top-10)=0.9204, median(all)=0.8694, mean(all)=0.8030
  + SMOOTHING: median(top-10)=0.9509, mean(top-10)=0.9475, median(all)=0.8910, mean(all)=0.8621 [+0.0314]
  + MRF:       median(top-10)=0.9509, mean(top-10)=0.9476, median(all)=0.8914, mean(all)=0.8622 [-0.0000]
  TOTAL IMPROVEMENT (median top-10): +0.0314

================================================================================
Subject: NKI-RS-22-13
================================================================================
  Step 0: Generating predictions with V2 model...
  Mesh: 121451 vertices, 242898 faces
  Rendering and predicting ALL 20 views...
    ✓ Front (view_id=0): shape (37, 800, 800)
    ✓ Back (view_id=1): shape (37, 800, 800)
    ✓ Left (view_id=2): shape (37, 800, 800)
    ✓ Right (view_id=3): shape (37, 800, 800)
    ✓ Top (view_id=4): shape (37, 800, 800)
    ✓ Bottom (view_id=5): shape (37, 800, 800)
    ✓ FrontLeft (view_id=6): shape (37, 800, 800)
    ✓ FrontRight (view_id=7): shape (37, 800, 800)
    ✓ BackLeft (view_id=8): shape (37, 800, 800)
    ✓ BackRight (view_id=9): shape (37, 800, 800)
    ✓ TopFront (view_id=10): shape (37, 800, 800)
    ✓ TopBack (view_id=11): shape (37, 800, 800)
    ✓ TopLeft (view_id=12): shape (37, 800, 800)
    ✓ TopRight (view_id=13): shape (37, 800, 800)
    ✓ BottomFront (view_id=14): shape (37, 800, 800)
    ✓ BottomBack (view_id=15): shape (37, 800, 800)
    ✓ BottomLeft (view_id=16): shape (37, 800, 800)
    ✓ BottomRight (view_id=17): shape (37, 800, 800)
    ✓ LeftTop (view_id=18): shape (37, 800, 800)
    ✓ RightTop (view_id=19): shape (37, 800, 800)
  ✓ Predictions from all 20 views aggregated
    P stats: min=0.0000, max=1.0000, mean=0.0251
    Non-zero vertices: 112679/121451
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 8772 1121 1007 2935    0 2178 1069 4087 4755]
  Ground Truth Stats:
    Labels shape: (121451,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-13/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.8055
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8633
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8635

  RESULTS:
  RAW:         median(top-10)=0.9267, mean(top-10)=0.9293, median(all)=0.8683, mean(all)=0.8055
  + SMOOTHING: median(top-10)=0.9509, mean(top-10)=0.9500, median(all)=0.9193, mean(all)=0.8633 [+0.0242]
  + MRF:       median(top-10)=0.9512, mean(top-10)=0.9502, median(all)=0.9192, mean(all)=0.8635 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0245

================================================================================
Subject: NKI-RS-22-14
================================================================================
  Step 0: Generating predictions with V2 model...
  Mesh: 142823 vertices, 285642 faces
  Rendering and predicting ALL 20 views...
    ✓ Front (view_id=0): shape (37, 800, 800)
    ✓ Back (view_id=1): shape (37, 800, 800)
    ✓ Left (view_id=2): shape (37, 800, 800)
    ✓ Right (view_id=3): shape (37, 800, 800)
    ✓ Top (view_id=4): shape (37, 800, 800)
    ✓ Bottom (view_id=5): shape (37, 800, 800)
    ✓ FrontLeft (view_id=6): shape (37, 800, 800)
    ✓ FrontRight (view_id=7): shape (37, 800, 800)
    ✓ BackLeft (view_id=8): shape (37, 800, 800)
    ✓ BackRight (view_id=9): shape (37, 800, 800)
    ✓ TopFront (view_id=10): shape (37, 800, 800)
    ✓ TopBack (view_id=11): shape (37, 800, 800)
    ✓ TopLeft (view_id=12): shape (37, 800, 800)
    ✓ TopRight (view_id=13): shape (37, 800, 800)
    ✓ BottomFront (view_id=14): shape (37, 800, 800)
    ✓ BottomBack (view_id=15): shape (37, 800, 800)
    ✓ BottomLeft (view_id=16): shape (37, 800, 800)
    ✓ BottomRight (view_id=17): shape (37, 800, 800)
    ✓ LeftTop (view_id=18): shape (37, 800, 800)
    ✓ RightTop (view_id=19): shape (37, 800, 800)
  ✓ Predictions from all 20 views aggregated
    P stats: min=0.0000, max=1.0000, mean=0.0246
    Non-zero vertices: 129955/142823
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 12868  1160  1281  2866     0  2317  1440  4572  6593]
  Ground Truth Stats:
    Labels shape: (142823,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-14/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7913
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8563
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8565

  RESULTS:
  RAW:         median(top-10)=0.9262, mean(top-10)=0.9271, median(all)=0.8604, mean(all)=0.7913
  + SMOOTHING: median(top-10)=0.9527, mean(top-10)=0.9506, median(all)=0.9109, mean(all)=0.8563 [+0.0265]
  + MRF:       median(top-10)=0.9528, mean(top-10)=0.9507, median(all)=0.9111, mean(all)=0.8565 [+0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0266

================================================================================
Subject: NKI-RS-22-15
================================================================================
  Step 0: Generating predictions with V2 model...
  Mesh: 158740 vertices, 317476 faces
  Rendering and predicting ALL 20 views...
    ✓ Front (view_id=0): shape (37, 800, 800)
    ✓ Back (view_id=1): shape (37, 800, 800)
    ✓ Left (view_id=2): shape (37, 800, 800)
    ✓ Right (view_id=3): shape (37, 800, 800)
    ✓ Top (view_id=4): shape (37, 800, 800)
    ✓ Bottom (view_id=5): shape (37, 800, 800)
    ✓ FrontLeft (view_id=6): shape (37, 800, 800)
    ✓ FrontRight (view_id=7): shape (37, 800, 800)
    ✓ BackLeft (view_id=8): shape (37, 800, 800)
    ✓ BackRight (view_id=9): shape (37, 800, 800)
    ✓ TopFront (view_id=10): shape (37, 800, 800)
    ✓ TopBack (view_id=11): shape (37, 800, 800)
    ✓ TopLeft (view_id=12): shape (37, 800, 800)
    ✓ TopRight (view_id=13): shape (37, 800, 800)
    ✓ BottomFront (view_id=14): shape (37, 800, 800)
    ✓ BottomBack (view_id=15): shape (37, 800, 800)
    ✓ BottomLeft (view_id=16): shape (37, 800, 800)
    ✓ BottomRight (view_id=17): shape (37, 800, 800)
    ✓ LeftTop (view_id=18): shape (37, 800, 800)
    ✓ RightTop (view_id=19): shape (37, 800, 800)
  ✓ Predictions from all 20 views aggregated
    P stats: min=0.0000, max=1.0000, mean=0.0248
    Non-zero vertices: 145854/158740
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 12886  1177  1492  3976     0  2008  1560  5545  7787]
  Ground Truth Stats:
    Labels shape: (158740,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-15/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7947
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8561
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8562

  RESULTS:
  RAW:         median(top-10)=0.8984, mean(top-10)=0.9099, median(all)=0.8490, mean(all)=0.7947
  + SMOOTHING: median(top-10)=0.9396, mean(top-10)=0.9395, median(all)=0.8995, mean(all)=0.8561 [+0.0412]
  + MRF:       median(top-10)=0.9394, mean(top-10)=0.9396, median(all)=0.8990, mean(all)=0.8562 [-0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0410

================================================================================
Subject: NKI-RS-22-16
================================================================================
  Step 0: Generating predictions with V2 model...
  Mesh: 137370 vertices, 274736 faces
  Rendering and predicting ALL 20 views...
    ✓ Front (view_id=0): shape (37, 800, 800)
    ✓ Back (view_id=1): shape (37, 800, 800)
    ✓ Left (view_id=2): shape (37, 800, 800)
    ✓ Right (view_id=3): shape (37, 800, 800)
    ✓ Top (view_id=4): shape (37, 800, 800)
    ✓ Bottom (view_id=5): shape (37, 800, 800)
    ✓ FrontLeft (view_id=6): shape (37, 800, 800)
    ✓ FrontRight (view_id=7): shape (37, 800, 800)
    ✓ BackLeft (view_id=8): shape (37, 800, 800)
    ✓ BackRight (view_id=9): shape (37, 800, 800)
    ✓ TopFront (view_id=10): shape (37, 800, 800)
    ✓ TopBack (view_id=11): shape (37, 800, 800)
    ✓ TopLeft (view_id=12): shape (37, 800, 800)
    ✓ TopRight (view_id=13): shape (37, 800, 800)
    ✓ BottomFront (view_id=14): shape (37, 800, 800)
    ✓ BottomBack (view_id=15): shape (37, 800, 800)
    ✓ BottomLeft (view_id=16): shape (37, 800, 800)
    ✓ BottomRight (view_id=17): shape (37, 800, 800)
    ✓ LeftTop (view_id=18): shape (37, 800, 800)
    ✓ RightTop (view_id=19): shape (37, 800, 800)
  ✓ Predictions from all 20 views aggregated
    P stats: min=0.0000, max=1.0000, mean=0.0248
    Non-zero vertices: 126081/137370
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 11289  1155  1300  3518     0  2220  1127  5053  5672]
  Ground Truth Stats:
    Labels shape: (137370,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-16/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7974
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8591
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8591

  RESULTS:
  RAW:         median(top-10)=0.9124, mean(top-10)=0.9138, median(all)=0.8624, mean(all)=0.7974
  + SMOOTHING: median(top-10)=0.9440, mean(top-10)=0.9463, median(all)=0.9029, mean(all)=0.8591 [+0.0315]
  + MRF:       median(top-10)=0.9439, mean(top-10)=0.9463, median(all)=0.9024, mean(all)=0.8591 [-0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0314

================================================================================
Subject: NKI-RS-22-17
================================================================================
  Step 0: Generating predictions with V2 model...
  Mesh: 161773 vertices, 323542 faces
  Rendering and predicting ALL 20 views...
    ✓ Front (view_id=0): shape (37, 800, 800)
    ✓ Back (view_id=1): shape (37, 800, 800)
    ✓ Left (view_id=2): shape (37, 800, 800)
    ✓ Right (view_id=3): shape (37, 800, 800)
    ✓ Top (view_id=4): shape (37, 800, 800)
    ✓ Bottom (view_id=5): shape (37, 800, 800)
    ✓ FrontLeft (view_id=6): shape (37, 800, 800)
    ✓ FrontRight (view_id=7): shape (37, 800, 800)
    ✓ BackLeft (view_id=8): shape (37, 800, 800)
    ✓ BackRight (view_id=9): shape (37, 800, 800)
    ✓ TopFront (view_id=10): shape (37, 800, 800)
    ✓ TopBack (view_id=11): shape (37, 800, 800)
    ✓ TopLeft (view_id=12): shape (37, 800, 800)
    ✓ TopRight (view_id=13): shape (37, 800, 800)
    ✓ BottomFront (view_id=14): shape (37, 800, 800)
    ✓ BottomBack (view_id=15): shape (37, 800, 800)
    ✓ BottomLeft (view_id=16): shape (37, 800, 800)
    ✓ BottomRight (view_id=17): shape (37, 800, 800)
    ✓ LeftTop (view_id=18): shape (37, 800, 800)
    ✓ RightTop (view_id=19): shape (37, 800, 800)
  ✓ Predictions from all 20 views aggregated
    P stats: min=0.0000, max=1.0000, mean=0.0248
    Non-zero vertices: 148359/161773
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 13414  1414  1119  4761     0  2780  1396  5580  8329]
  Ground Truth Stats:
    Labels shape: (161773,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-17/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7999
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8681
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8683

  RESULTS:
  RAW:         median(top-10)=0.9227, mean(top-10)=0.9247, median(all)=0.8775, mean(all)=0.7999
  + SMOOTHING: median(top-10)=0.9536, mean(top-10)=0.9535, median(all)=0.9213, mean(all)=0.8681 [+0.0309]
  + MRF:       median(top-10)=0.9540, mean(top-10)=0.9536, median(all)=0.9213, mean(all)=0.8683 [+0.0004]
  TOTAL IMPROVEMENT (median top-10): +0.0313

================================================================================
Subject: NKI-RS-22-18
================================================================================
  Step 0: Generating predictions with V2 model...
  Mesh: 147633 vertices, 295262 faces
  Rendering and predicting ALL 20 views...
    ✓ Front (view_id=0): shape (37, 800, 800)
    ✓ Back (view_id=1): shape (37, 800, 800)
    ✓ Left (view_id=2): shape (37, 800, 800)
    ✓ Right (view_id=3): shape (37, 800, 800)
    ✓ Top (view_id=4): shape (37, 800, 800)
    ✓ Bottom (view_id=5): shape (37, 800, 800)
    ✓ FrontLeft (view_id=6): shape (37, 800, 800)
    ✓ FrontRight (view_id=7): shape (37, 800, 800)
    ✓ BackLeft (view_id=8): shape (37, 800, 800)
    ✓ BackRight (view_id=9): shape (37, 800, 800)
    ✓ TopFront (view_id=10): shape (37, 800, 800)
    ✓ TopBack (view_id=11): shape (37, 800, 800)
    ✓ TopLeft (view_id=12): shape (37, 800, 800)
    ✓ TopRight (view_id=13): shape (37, 800, 800)
    ✓ BottomFront (view_id=14): shape (37, 800, 800)
    ✓ BottomBack (view_id=15): shape (37, 800, 800)
    ✓ BottomLeft (view_id=16): shape (37, 800, 800)
    ✓ BottomRight (view_id=17): shape (37, 800, 800)
    ✓ LeftTop (view_id=18): shape (37, 800, 800)
    ✓ RightTop (view_id=19): shape (37, 800, 800)
  ✓ Predictions from all 20 views aggregated
    P stats: min=0.0000, max=1.0000, mean=0.0247
    Non-zero vertices: 134828/147633
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 12805  1590  1122  3445     0  2453  1211  5334  7706]
  Ground Truth Stats:
    Labels shape: (147633,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-18/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7770
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8505
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8507

  RESULTS:
  RAW:         median(top-10)=0.9077, mean(top-10)=0.9170, median(all)=0.8454, mean(all)=0.7770
  + SMOOTHING: median(top-10)=0.9394, mean(top-10)=0.9421, median(all)=0.8936, mean(all)=0.8505 [+0.0317]
  + MRF:       median(top-10)=0.9395, mean(top-10)=0.9423, median(all)=0.8933, mean(all)=0.8507 [+0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0318

================================================================================
Subject: NKI-RS-22-19
================================================================================
  Step 0: Generating predictions with V2 model...
  Mesh: 141397 vertices, 282790 faces
  Rendering and predicting ALL 20 views...
    ✓ Front (view_id=0): shape (37, 800, 800)
    ✓ Back (view_id=1): shape (37, 800, 800)
    ✓ Left (view_id=2): shape (37, 800, 800)
    ✓ Right (view_id=3): shape (37, 800, 800)
    ✓ Top (view_id=4): shape (37, 800, 800)
    ✓ Bottom (view_id=5): shape (37, 800, 800)
    ✓ FrontLeft (view_id=6): shape (37, 800, 800)
    ✓ FrontRight (view_id=7): shape (37, 800, 800)
    ✓ BackLeft (view_id=8): shape (37, 800, 800)
    ✓ BackRight (view_id=9): shape (37, 800, 800)
    ✓ TopFront (view_id=10): shape (37, 800, 800)
    ✓ TopBack (view_id=11): shape (37, 800, 800)
    ✓ TopLeft (view_id=12): shape (37, 800, 800)
    ✓ TopRight (view_id=13): shape (37, 800, 800)
    ✓ BottomFront (view_id=14): shape (37, 800, 800)
    ✓ BottomBack (view_id=15): shape (37, 800, 800)
    ✓ BottomLeft (view_id=16): shape (37, 800, 800)
    ✓ BottomRight (view_id=17): shape (37, 800, 800)
    ✓ LeftTop (view_id=18): shape (37, 800, 800)
    ✓ RightTop (view_id=19): shape (37, 800, 800)
  ✓ Predictions from all 20 views aggregated
    P stats: min=0.0000, max=1.0000, mean=0.0246
    Non-zero vertices: 128484/141397
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 12913  1185  1302  3430     0  1724  1196  4816  5805]
  Ground Truth Stats:
    Labels shape: (141397,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-19/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7894
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8604
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8605

  RESULTS:
  RAW:         median(top-10)=0.9207, mean(top-10)=0.9191, median(all)=0.8492, mean(all)=0.7894
  + SMOOTHING: median(top-10)=0.9428, mean(top-10)=0.9446, median(all)=0.9028, mean(all)=0.8604 [+0.0222]
  + MRF:       median(top-10)=0.9430, mean(top-10)=0.9449, median(all)=0.9028, mean(all)=0.8605 [+0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0223

================================================================================
Subject: NKI-RS-22-2
================================================================================
  Step 0: Generating predictions with V2 model...
  Mesh: 137791 vertices, 275578 faces
  Rendering and predicting ALL 20 views...
    ✓ Front (view_id=0): shape (37, 800, 800)
    ✓ Back (view_id=1): shape (37, 800, 800)
    ✓ Left (view_id=2): shape (37, 800, 800)
    ✓ Right (view_id=3): shape (37, 800, 800)
    ✓ Top (view_id=4): shape (37, 800, 800)
    ✓ Bottom (view_id=5): shape (37, 800, 800)
    ✓ FrontLeft (view_id=6): shape (37, 800, 800)
    ✓ FrontRight (view_id=7): shape (37, 800, 800)
    ✓ BackLeft (view_id=8): shape (37, 800, 800)
    ✓ BackRight (view_id=9): shape (37, 800, 800)
    ✓ TopFront (view_id=10): shape (37, 800, 800)
    ✓ TopBack (view_id=11): shape (37, 800, 800)
    ✓ TopLeft (view_id=12): shape (37, 800, 800)
    ✓ TopRight (view_id=13): shape (37, 800, 800)
    ✓ BottomFront (view_id=14): shape (37, 800, 800)
    ✓ BottomBack (view_id=15): shape (37, 800, 800)
    ✓ BottomLeft (view_id=16): shape (37, 800, 800)
    ✓ BottomRight (view_id=17): shape (37, 800, 800)
    ✓ LeftTop (view_id=18): shape (37, 800, 800)
    ✓ RightTop (view_id=19): shape (37, 800, 800)
  ✓ Predictions from all 20 views aggregated
    P stats: min=0.0000, max=1.0000, mean=0.0247
    Non-zero vertices: 126142/137791
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 11649  1089  1062  3560     0  1654  1234  4464  6507]
  Ground Truth Stats:
    Labels shape: (137791,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-2/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7828
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8485
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8486

  RESULTS:
  RAW:         median(top-10)=0.9154, mean(top-10)=0.9139, median(all)=0.8622, mean(all)=0.7828
  + SMOOTHING: median(top-10)=0.9375, mean(top-10)=0.9415, median(all)=0.9113, mean(all)=0.8485 [+0.0221]
  + MRF:       median(top-10)=0.9376, mean(top-10)=0.9415, median(all)=0.9111, mean(all)=0.8486 [+0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0223

================================================================================
Subject: NKI-RS-22-20
================================================================================
  Step 0: Generating predictions with V2 model...
  Mesh: 140825 vertices, 281646 faces
  Rendering and predicting ALL 20 views...
    ✓ Front (view_id=0): shape (37, 800, 800)
    ✓ Back (view_id=1): shape (37, 800, 800)
    ✓ Left (view_id=2): shape (37, 800, 800)
    ✓ Right (view_id=3): shape (37, 800, 800)
    ✓ Top (view_id=4): shape (37, 800, 800)
    ✓ Bottom (view_id=5): shape (37, 800, 800)
    ✓ FrontLeft (view_id=6): shape (37, 800, 800)
    ✓ FrontRight (view_id=7): shape (37, 800, 800)
    ✓ BackLeft (view_id=8): shape (37, 800, 800)
    ✓ BackRight (view_id=9): shape (37, 800, 800)
    ✓ TopFront (view_id=10): shape (37, 800, 800)
    ✓ TopBack (view_id=11): shape (37, 800, 800)
    ✓ TopLeft (view_id=12): shape (37, 800, 800)
    ✓ TopRight (view_id=13): shape (37, 800, 800)
    ✓ BottomFront (view_id=14): shape (37, 800, 800)
    ✓ BottomBack (view_id=15): shape (37, 800, 800)
    ✓ BottomLeft (view_id=16): shape (37, 800, 800)
    ✓ BottomRight (view_id=17): shape (37, 800, 800)
    ✓ LeftTop (view_id=18): shape (37, 800, 800)
    ✓ RightTop (view_id=19): shape (37, 800, 800)
  ✓ Predictions from all 20 views aggregated
    P stats: min=0.0000, max=1.0000, mean=0.0251
    Non-zero vertices: 130649/140825
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 10176  1251  1014  3762     0  2551  1434  4846  6709]
  Ground Truth Stats:
    Labels shape: (140825,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-20/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7904
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8586
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8587

  RESULTS:
  RAW:         median(top-10)=0.9110, mean(top-10)=0.9153, median(all)=0.8556, mean(all)=0.7904
  + SMOOTHING: median(top-10)=0.9420, mean(top-10)=0.9418, median(all)=0.8892, mean(all)=0.8586 [+0.0311]
  + MRF:       median(top-10)=0.9421, mean(top-10)=0.9419, median(all)=0.8901, mean(all)=0.8587 [+0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0312

================================================================================
Subject: NKI-RS-22-21
================================================================================
  Step 0: Generating predictions with V2 model...
  Mesh: 138920 vertices, 277836 faces
  Rendering and predicting ALL 20 views...
    ✓ Front (view_id=0): shape (37, 800, 800)
    ✓ Back (view_id=1): shape (37, 800, 800)
    ✓ Left (view_id=2): shape (37, 800, 800)
    ✓ Right (view_id=3): shape (37, 800, 800)
    ✓ Top (view_id=4): shape (37, 800, 800)
    ✓ Bottom (view_id=5): shape (37, 800, 800)
    ✓ FrontLeft (view_id=6): shape (37, 800, 800)
    ✓ FrontRight (view_id=7): shape (37, 800, 800)
    ✓ BackLeft (view_id=8): shape (37, 800, 800)
    ✓ BackRight (view_id=9): shape (37, 800, 800)
    ✓ TopFront (view_id=10): shape (37, 800, 800)
    ✓ TopBack (view_id=11): shape (37, 800, 800)
    ✓ TopLeft (view_id=12): shape (37, 800, 800)
    ✓ TopRight (view_id=13): shape (37, 800, 800)
    ✓ BottomFront (view_id=14): shape (37, 800, 800)
    ✓ BottomBack (view_id=15): shape (37, 800, 800)
    ✓ BottomLeft (view_id=16): shape (37, 800, 800)
    ✓ BottomRight (view_id=17): shape (37, 800, 800)
    ✓ LeftTop (view_id=18): shape (37, 800, 800)
    ✓ RightTop (view_id=19): shape (37, 800, 800)
  ✓ Predictions from all 20 views aggregated
    P stats: min=0.0000, max=1.0000, mean=0.0246
    Non-zero vertices: 126635/138920
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 12285  1278  1344  3464     0  2263  1254  5019  6071]
  Ground Truth Stats:
    Labels shape: (138920,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-21/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.8022
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8676
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8677

  RESULTS:
  RAW:         median(top-10)=0.9149, mean(top-10)=0.9168, median(all)=0.8610, mean(all)=0.8022
  + SMOOTHING: median(top-10)=0.9359, mean(top-10)=0.9403, median(all)=0.9112, mean(all)=0.8676 [+0.0210]
  + MRF:       median(top-10)=0.9361, mean(top-10)=0.9405, median(all)=0.9116, mean(all)=0.8677 [+0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0212

================================================================================
Subject: NKI-RS-22-22
================================================================================
  Step 0: Generating predictions with V2 model...
  Mesh: 129976 vertices, 259948 faces
  Rendering and predicting ALL 20 views...
    ✓ Front (view_id=0): shape (37, 800, 800)
    ✓ Back (view_id=1): shape (37, 800, 800)
    ✓ Left (view_id=2): shape (37, 800, 800)
    ✓ Right (view_id=3): shape (37, 800, 800)
    ✓ Top (view_id=4): shape (37, 800, 800)
    ✓ Bottom (view_id=5): shape (37, 800, 800)
    ✓ FrontLeft (view_id=6): shape (37, 800, 800)
    ✓ FrontRight (view_id=7): shape (37, 800, 800)
    ✓ BackLeft (view_id=8): shape (37, 800, 800)
    ✓ BackRight (view_id=9): shape (37, 800, 800)
    ✓ TopFront (view_id=10): shape (37, 800, 800)
    ✓ TopBack (view_id=11): shape (37, 800, 800)
    ✓ TopLeft (view_id=12): shape (37, 800, 800)
    ✓ TopRight (view_id=13): shape (37, 800, 800)
    ✓ BottomFront (view_id=14): shape (37, 800, 800)
    ✓ BottomBack (view_id=15): shape (37, 800, 800)
    ✓ BottomLeft (view_id=16): shape (37, 800, 800)
    ✓ BottomRight (view_id=17): shape (37, 800, 800)
    ✓ LeftTop (view_id=18): shape (37, 800, 800)
    ✓ RightTop (view_id=19): shape (37, 800, 800)
  ✓ Predictions from all 20 views aggregated
    P stats: min=0.0000, max=1.0000, mean=0.0248
    Non-zero vertices: 119171/129976
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 10805  1222   990  3569     0  1802  1328  4432  5309]
  Ground Truth Stats:
    Labels shape: (129976,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-22/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.8071
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8741
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8743

  RESULTS:
  RAW:         median(top-10)=0.9259, mean(top-10)=0.9262, median(all)=0.8888, mean(all)=0.8071
  + SMOOTHING: median(top-10)=0.9594, mean(top-10)=0.9564, median(all)=0.9193, mean(all)=0.8741 [+0.0335]
  + MRF:       median(top-10)=0.9595, mean(top-10)=0.9564, median(all)=0.9193, mean(all)=0.8743 [+0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0336

================================================================================
Subject: NKI-RS-22-3
================================================================================
  Step 0: Generating predictions with V2 model...
  Mesh: 136714 vertices, 273424 faces
  Rendering and predicting ALL 20 views...
    ✓ Front (view_id=0): shape (37, 800, 800)
    ✓ Back (view_id=1): shape (37, 800, 800)
    ✓ Left (view_id=2): shape (37, 800, 800)
    ✓ Right (view_id=3): shape (37, 800, 800)
    ✓ Top (view_id=4): shape (37, 800, 800)
    ✓ Bottom (view_id=5): shape (37, 800, 800)
    ✓ FrontLeft (view_id=6): shape (37, 800, 800)
    ✓ FrontRight (view_id=7): shape (37, 800, 800)
    ✓ BackLeft (view_id=8): shape (37, 800, 800)
    ✓ BackRight (view_id=9): shape (37, 800, 800)
    ✓ TopFront (view_id=10): shape (37, 800, 800)
    ✓ TopBack (view_id=11): shape (37, 800, 800)
    ✓ TopLeft (view_id=12): shape (37, 800, 800)
    ✓ TopRight (view_id=13): shape (37, 800, 800)
    ✓ BottomFront (view_id=14): shape (37, 800, 800)
    ✓ BottomBack (view_id=15): shape (37, 800, 800)
    ✓ BottomLeft (view_id=16): shape (37, 800, 800)
    ✓ BottomRight (view_id=17): shape (37, 800, 800)
    ✓ LeftTop (view_id=18): shape (37, 800, 800)
    ✓ RightTop (view_id=19): shape (37, 800, 800)
  ✓ Predictions from all 20 views aggregated
    P stats: min=0.0000, max=1.0000, mean=0.0245
    Non-zero vertices: 123973/136714
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 12741  1312  1199  3423     0  2552  1274  4582  6922]
  Ground Truth Stats:
    Labels shape: (136714,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-3/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7976
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8591
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8593

  RESULTS:
  RAW:         median(top-10)=0.9094, mean(top-10)=0.9144, median(all)=0.8408, mean(all)=0.7976
  + SMOOTHING: median(top-10)=0.9406, mean(top-10)=0.9383, median(all)=0.9023, mean(all)=0.8591 [+0.0312]
  + MRF:       median(top-10)=0.9408, mean(top-10)=0.9386, median(all)=0.9031, mean(all)=0.8593 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0314

================================================================================
Subject: NKI-RS-22-4
================================================================================
  Step 0: Generating predictions with V2 model...
  Mesh: 169171 vertices, 338338 faces
  Rendering and predicting ALL 20 views...
    ✓ Front (view_id=0): shape (37, 800, 800)
    ✓ Back (view_id=1): shape (37, 800, 800)
    ✓ Left (view_id=2): shape (37, 800, 800)
    ✓ Right (view_id=3): shape (37, 800, 800)
    ✓ Top (view_id=4): shape (37, 800, 800)
    ✓ Bottom (view_id=5): shape (37, 800, 800)
    ✓ FrontLeft (view_id=6): shape (37, 800, 800)
    ✓ FrontRight (view_id=7): shape (37, 800, 800)
    ✓ BackLeft (view_id=8): shape (37, 800, 800)
    ✓ BackRight (view_id=9): shape (37, 800, 800)
    ✓ TopFront (view_id=10): shape (37, 800, 800)
    ✓ TopBack (view_id=11): shape (37, 800, 800)
    ✓ TopLeft (view_id=12): shape (37, 800, 800)
    ✓ TopRight (view_id=13): shape (37, 800, 800)
    ✓ BottomFront (view_id=14): shape (37, 800, 800)
    ✓ BottomBack (view_id=15): shape (37, 800, 800)
    ✓ BottomLeft (view_id=16): shape (37, 800, 800)
    ✓ BottomRight (view_id=17): shape (37, 800, 800)
    ✓ LeftTop (view_id=18): shape (37, 800, 800)
    ✓ RightTop (view_id=19): shape (37, 800, 800)
  ✓ Predictions from all 20 views aggregated
    P stats: min=0.0000, max=1.0000, mean=0.0248
    Non-zero vertices: 155274/169171
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 13897  1093  1260  4103     0  2833  1347  5633  7433]
  Ground Truth Stats:
    Labels shape: (169171,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-4/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7826
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8481
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8481

  RESULTS:
  RAW:         median(top-10)=0.9048, mean(top-10)=0.9074, median(all)=0.8480, mean(all)=0.7826
  + SMOOTHING: median(top-10)=0.9377, mean(top-10)=0.9381, median(all)=0.9008, mean(all)=0.8481 [+0.0328]
  + MRF:       median(top-10)=0.9379, mean(top-10)=0.9383, median(all)=0.9006, mean(all)=0.8481 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0330

================================================================================
Subject: NKI-RS-22-5
================================================================================
  Step 0: Generating predictions with V2 model...
  Mesh: 138967 vertices, 277930 faces
  Rendering and predicting ALL 20 views...
    ✓ Front (view_id=0): shape (37, 800, 800)
    ✓ Back (view_id=1): shape (37, 800, 800)
    ✓ Left (view_id=2): shape (37, 800, 800)
    ✓ Right (view_id=3): shape (37, 800, 800)
    ✓ Top (view_id=4): shape (37, 800, 800)
    ✓ Bottom (view_id=5): shape (37, 800, 800)
    ✓ FrontLeft (view_id=6): shape (37, 800, 800)
    ✓ FrontRight (view_id=7): shape (37, 800, 800)
    ✓ BackLeft (view_id=8): shape (37, 800, 800)
    ✓ BackRight (view_id=9): shape (37, 800, 800)
    ✓ TopFront (view_id=10): shape (37, 800, 800)
    ✓ TopBack (view_id=11): shape (37, 800, 800)
    ✓ TopLeft (view_id=12): shape (37, 800, 800)
    ✓ TopRight (view_id=13): shape (37, 800, 800)
    ✓ BottomFront (view_id=14): shape (37, 800, 800)
    ✓ BottomBack (view_id=15): shape (37, 800, 800)
    ✓ BottomLeft (view_id=16): shape (37, 800, 800)
    ✓ BottomRight (view_id=17): shape (37, 800, 800)
    ✓ LeftTop (view_id=18): shape (37, 800, 800)
    ✓ RightTop (view_id=19): shape (37, 800, 800)
  ✓ Predictions from all 20 views aggregated
    P stats: min=0.0000, max=1.0000, mean=0.0251
    Non-zero vertices: 128846/138967
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 10121  1369  1049  4204     0  2119  1398  4615  5070]
  Ground Truth Stats:
    Labels shape: (138967,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-5/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7950
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8558
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8559

  RESULTS:
  RAW:         median(top-10)=0.9117, mean(top-10)=0.9148, median(all)=0.8588, mean(all)=0.7950
  + SMOOTHING: median(top-10)=0.9425, mean(top-10)=0.9423, median(all)=0.8954, mean(all)=0.8558 [+0.0307]
  + MRF:       median(top-10)=0.9426, mean(top-10)=0.9424, median(all)=0.8958, mean(all)=0.8559 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0309

================================================================================
Subject: NKI-RS-22-6
================================================================================
  Step 0: Generating predictions with V2 model...
  Mesh: 185380 vertices, 370756 faces
  Rendering and predicting ALL 20 views...
    ✓ Front (view_id=0): shape (37, 800, 800)
    ✓ Back (view_id=1): shape (37, 800, 800)
    ✓ Left (view_id=2): shape (37, 800, 800)
    ✓ Right (view_id=3): shape (37, 800, 800)
    ✓ Top (view_id=4): shape (37, 800, 800)
    ✓ Bottom (view_id=5): shape (37, 800, 800)
    ✓ FrontLeft (view_id=6): shape (37, 800, 800)
    ✓ FrontRight (view_id=7): shape (37, 800, 800)
    ✓ BackLeft (view_id=8): shape (37, 800, 800)
    ✓ BackRight (view_id=9): shape (37, 800, 800)
    ✓ TopFront (view_id=10): shape (37, 800, 800)
    ✓ TopBack (view_id=11): shape (37, 800, 800)
    ✓ TopLeft (view_id=12): shape (37, 800, 800)
    ✓ TopRight (view_id=13): shape (37, 800, 800)
    ✓ BottomFront (view_id=14): shape (37, 800, 800)
    ✓ BottomBack (view_id=15): shape (37, 800, 800)
    ✓ BottomLeft (view_id=16): shape (37, 800, 800)
    ✓ BottomRight (view_id=17): shape (37, 800, 800)
    ✓ LeftTop (view_id=18): shape (37, 800, 800)
    ✓ RightTop (view_id=19): shape (37, 800, 800)
  ✓ Predictions from all 20 views aggregated
    P stats: min=0.0000, max=1.0000, mean=0.0241
    Non-zero vertices: 165342/185380
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 20038  1477  1823  3951     0  2925  1558  6640  8754]
  Ground Truth Stats:
    Labels shape: (185380,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-6/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7842
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8578
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8582

  RESULTS:
  RAW:         median(top-10)=0.9059, mean(top-10)=0.9133, median(all)=0.8582, mean(all)=0.7842
  + SMOOTHING: median(top-10)=0.9459, mean(top-10)=0.9485, median(all)=0.8926, mean(all)=0.8578 [+0.0400]
  + MRF:       median(top-10)=0.9462, mean(top-10)=0.9487, median(all)=0.8928, mean(all)=0.8582 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0403

================================================================================
Subject: NKI-RS-22-7
================================================================================
  Step 0: Generating predictions with V2 model...
  Mesh: 153181 vertices, 306358 faces
  Rendering and predicting ALL 20 views...
    ✓ Front (view_id=0): shape (37, 800, 800)
    ✓ Back (view_id=1): shape (37, 800, 800)
    ✓ Left (view_id=2): shape (37, 800, 800)
    ✓ Right (view_id=3): shape (37, 800, 800)
    ✓ Top (view_id=4): shape (37, 800, 800)
    ✓ Bottom (view_id=5): shape (37, 800, 800)
    ✓ FrontLeft (view_id=6): shape (37, 800, 800)
    ✓ FrontRight (view_id=7): shape (37, 800, 800)
    ✓ BackLeft (view_id=8): shape (37, 800, 800)
    ✓ BackRight (view_id=9): shape (37, 800, 800)
    ✓ TopFront (view_id=10): shape (37, 800, 800)
    ✓ TopBack (view_id=11): shape (37, 800, 800)
    ✓ TopLeft (view_id=12): shape (37, 800, 800)
    ✓ TopRight (view_id=13): shape (37, 800, 800)
    ✓ BottomFront (view_id=14): shape (37, 800, 800)
    ✓ BottomBack (view_id=15): shape (37, 800, 800)
    ✓ BottomLeft (view_id=16): shape (37, 800, 800)
    ✓ BottomRight (view_id=17): shape (37, 800, 800)
    ✓ LeftTop (view_id=18): shape (37, 800, 800)
    ✓ RightTop (view_id=19): shape (37, 800, 800)
  ✓ Predictions from all 20 views aggregated
    P stats: min=0.0000, max=1.0000, mean=0.0249
    Non-zero vertices: 140958/153181
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 12223  1198  1285  4360     0  2840  1220  4877  5666]
  Ground Truth Stats:
    Labels shape: (153181,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-7/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7985
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8621
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8625

  RESULTS:
  RAW:         median(top-10)=0.9164, mean(top-10)=0.9213, median(all)=0.8782, mean(all)=0.7985
  + SMOOTHING: median(top-10)=0.9436, mean(top-10)=0.9451, median(all)=0.9159, mean(all)=0.8621 [+0.0272]
  + MRF:       median(top-10)=0.9439, mean(top-10)=0.9454, median(all)=0.9165, mean(all)=0.8625 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0274

================================================================================
Subject: NKI-RS-22-8
================================================================================
  Step 0: Generating predictions with V2 model...
  Mesh: 158049 vertices, 316094 faces
  Rendering and predicting ALL 20 views...
    ✓ Front (view_id=0): shape (37, 800, 800)
    ✓ Back (view_id=1): shape (37, 800, 800)
    ✓ Left (view_id=2): shape (37, 800, 800)
    ✓ Right (view_id=3): shape (37, 800, 800)
    ✓ Top (view_id=4): shape (37, 800, 800)
    ✓ Bottom (view_id=5): shape (37, 800, 800)
    ✓ FrontLeft (view_id=6): shape (37, 800, 800)
    ✓ FrontRight (view_id=7): shape (37, 800, 800)
    ✓ BackLeft (view_id=8): shape (37, 800, 800)
    ✓ BackRight (view_id=9): shape (37, 800, 800)
    ✓ TopFront (view_id=10): shape (37, 800, 800)
    ✓ TopBack (view_id=11): shape (37, 800, 800)
    ✓ TopLeft (view_id=12): shape (37, 800, 800)
    ✓ TopRight (view_id=13): shape (37, 800, 800)
    ✓ BottomFront (view_id=14): shape (37, 800, 800)
    ✓ BottomBack (view_id=15): shape (37, 800, 800)
    ✓ BottomLeft (view_id=16): shape (37, 800, 800)
    ✓ BottomRight (view_id=17): shape (37, 800, 800)
    ✓ LeftTop (view_id=18): shape (37, 800, 800)
    ✓ RightTop (view_id=19): shape (37, 800, 800)
  ✓ Predictions from all 20 views aggregated
    P stats: min=0.0000, max=1.0000, mean=0.0248
    Non-zero vertices: 145209/158049
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 12840  1260  1268  4226     0  3067  1403  5090  6250]
  Ground Truth Stats:
    Labels shape: (158049,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-8/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7978
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8627
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8629

  RESULTS:
  RAW:         median(top-10)=0.9094, mean(top-10)=0.9157, median(all)=0.8524, mean(all)=0.7978
  + SMOOTHING: median(top-10)=0.9442, mean(top-10)=0.9429, median(all)=0.8947, mean(all)=0.8627 [+0.0347]
  + MRF:       median(top-10)=0.9445, mean(top-10)=0.9431, median(all)=0.8952, mean(all)=0.8629 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0351

================================================================================
Subject: NKI-RS-22-9
================================================================================
  Step 0: Generating predictions with V2 model...
  Mesh: 129746 vertices, 259488 faces
  Rendering and predicting ALL 20 views...
    ✓ Front (view_id=0): shape (37, 800, 800)
    ✓ Back (view_id=1): shape (37, 800, 800)
    ✓ Left (view_id=2): shape (37, 800, 800)
    ✓ Right (view_id=3): shape (37, 800, 800)
    ✓ Top (view_id=4): shape (37, 800, 800)
    ✓ Bottom (view_id=5): shape (37, 800, 800)
    ✓ FrontLeft (view_id=6): shape (37, 800, 800)
    ✓ FrontRight (view_id=7): shape (37, 800, 800)
    ✓ BackLeft (view_id=8): shape (37, 800, 800)
    ✓ BackRight (view_id=9): shape (37, 800, 800)
    ✓ TopFront (view_id=10): shape (37, 800, 800)
    ✓ TopBack (view_id=11): shape (37, 800, 800)
    ✓ TopLeft (view_id=12): shape (37, 800, 800)
    ✓ TopRight (view_id=13): shape (37, 800, 800)
    ✓ BottomFront (view_id=14): shape (37, 800, 800)
    ✓ BottomBack (view_id=15): shape (37, 800, 800)
    ✓ BottomLeft (view_id=16): shape (37, 800, 800)
    ✓ BottomRight (view_id=17): shape (37, 800, 800)
    ✓ LeftTop (view_id=18): shape (37, 800, 800)
    ✓ RightTop (view_id=19): shape (37, 800, 800)
  ✓ Predictions from all 20 views aggregated
    P stats: min=0.0000, max=1.0000, mean=0.0250
    Non-zero vertices: 120094/129746
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 9652 1250 1012 3263    0 2056 1399 4536 5853]
  Ground Truth Stats:
    Labels shape: (129746,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-9/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.8034
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8674
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8677

  RESULTS:
  RAW:         median(top-10)=0.9250, mean(top-10)=0.9271, median(all)=0.8605, mean(all)=0.8034
  + SMOOTHING: median(top-10)=0.9513, mean(top-10)=0.9488, median(all)=0.9005, mean(all)=0.8674 [+0.0264]
  + MRF:       median(top-10)=0.9511, mean(top-10)=0.9488, median(all)=0.9006, mean(all)=0.8677 [-0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0262

================================================================================
Subject: NKI-TRT-20-1
================================================================================
  Step 0: Generating predictions with V2 model...
  Mesh: 143932 vertices, 287860 faces
  Rendering and predicting ALL 20 views...
    ✓ Front (view_id=0): shape (37, 800, 800)
    ✓ Back (view_id=1): shape (37, 800, 800)
    ✓ Left (view_id=2): shape (37, 800, 800)
    ✓ Right (view_id=3): shape (37, 800, 800)
    ✓ Top (view_id=4): shape (37, 800, 800)
    ✓ Bottom (view_id=5): shape (37, 800, 800)
    ✓ FrontLeft (view_id=6): shape (37, 800, 800)
    ✓ FrontRight (view_id=7): shape (37, 800, 800)
    ✓ BackLeft (view_id=8): shape (37, 800, 800)
    ✓ BackRight (view_id=9): shape (37, 800, 800)
    ✓ TopFront (view_id=10): shape (37, 800, 800)
    ✓ TopBack (view_id=11): shape (37, 800, 800)
    ✓ TopLeft (view_id=12): shape (37, 800, 800)
    ✓ TopRight (view_id=13): shape (37, 800, 800)
    ✓ BottomFront (view_id=14): shape (37, 800, 800)
    ✓ BottomBack (view_id=15): shape (37, 800, 800)
    ✓ BottomLeft (view_id=16): shape (37, 800, 800)
    ✓ BottomRight (view_id=17): shape (37, 800, 800)
    ✓ LeftTop (view_id=18): shape (37, 800, 800)
    ✓ RightTop (view_id=19): shape (37, 800, 800)
  ✓ Predictions from all 20 views aggregated
    P stats: min=0.0000, max=1.0000, mean=0.0250
    Non-zero vertices: 132999/143932
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 10933  1105  1206  3372     0  2067  1245  4638  7827]
  Ground Truth Stats:
    Labels shape: (143932,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-1/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
    MRF iteration 5/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7954
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8601
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8600

  RESULTS:
  RAW:         median(top-10)=0.9047, mean(top-10)=0.9121, median(all)=0.8472, mean(all)=0.7954
  + SMOOTHING: median(top-10)=0.9450, mean(top-10)=0.9444, median(all)=0.9002, mean(all)=0.8601 [+0.0403]
  + MRF:       median(top-10)=0.9453, mean(top-10)=0.9445, median(all)=0.9005, mean(all)=0.8600 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0406

================================================================================
Subject: NKI-TRT-20-10
================================================================================
  Step 0: Generating predictions with V2 model...
  Mesh: 122978 vertices, 245952 faces
  Rendering and predicting ALL 20 views...
    ✓ Front (view_id=0): shape (37, 800, 800)
    ✓ Back (view_id=1): shape (37, 800, 800)
    ✓ Left (view_id=2): shape (37, 800, 800)
    ✓ Right (view_id=3): shape (37, 800, 800)
    ✓ Top (view_id=4): shape (37, 800, 800)
    ✓ Bottom (view_id=5): shape (37, 800, 800)
    ✓ FrontLeft (view_id=6): shape (37, 800, 800)
    ✓ FrontRight (view_id=7): shape (37, 800, 800)
    ✓ BackLeft (view_id=8): shape (37, 800, 800)
    ✓ BackRight (view_id=9): shape (37, 800, 800)
    ✓ TopFront (view_id=10): shape (37, 800, 800)
    ✓ TopBack (view_id=11): shape (37, 800, 800)
    ✓ TopLeft (view_id=12): shape (37, 800, 800)
    ✓ TopRight (view_id=13): shape (37, 800, 800)
    ✓ BottomFront (view_id=14): shape (37, 800, 800)
    ✓ BottomBack (view_id=15): shape (37, 800, 800)
    ✓ BottomLeft (view_id=16): shape (37, 800, 800)
    ✓ BottomRight (view_id=17): shape (37, 800, 800)
    ✓ LeftTop (view_id=18): shape (37, 800, 800)
    ✓ RightTop (view_id=19): shape (37, 800, 800)
  ✓ Predictions from all 20 views aggregated
    P stats: min=0.0000, max=1.0000, mean=0.0252
    Non-zero vertices: 114871/122978
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 8107 1238  850 2786    0 2345 1237 4265 6207]
  Ground Truth Stats:
    Labels shape: (122978,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-10/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.8050
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8600
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8601

  RESULTS:
  RAW:         median(top-10)=0.9221, mean(top-10)=0.9217, median(all)=0.8799, mean(all)=0.8050
  + SMOOTHING: median(top-10)=0.9462, mean(top-10)=0.9440, median(all)=0.9023, mean(all)=0.8600 [+0.0242]
  + MRF:       median(top-10)=0.9463, mean(top-10)=0.9441, median(all)=0.9025, mean(all)=0.8601 [+0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0243

================================================================================
Subject: NKI-TRT-20-11
================================================================================
  Step 0: Generating predictions with V2 model...
  Mesh: 146103 vertices, 292202 faces
  Rendering and predicting ALL 20 views...
    ✓ Front (view_id=0): shape (37, 800, 800)
    ✓ Back (view_id=1): shape (37, 800, 800)
    ✓ Left (view_id=2): shape (37, 800, 800)
    ✓ Right (view_id=3): shape (37, 800, 800)
    ✓ Top (view_id=4): shape (37, 800, 800)
    ✓ Bottom (view_id=5): shape (37, 800, 800)
    ✓ FrontLeft (view_id=6): shape (37, 800, 800)
    ✓ FrontRight (view_id=7): shape (37, 800, 800)
    ✓ BackLeft (view_id=8): shape (37, 800, 800)
    ✓ BackRight (view_id=9): shape (37, 800, 800)
    ✓ TopFront (view_id=10): shape (37, 800, 800)
    ✓ TopBack (view_id=11): shape (37, 800, 800)
    ✓ TopLeft (view_id=12): shape (37, 800, 800)
    ✓ TopRight (view_id=13): shape (37, 800, 800)
    ✓ BottomFront (view_id=14): shape (37, 800, 800)
    ✓ BottomBack (view_id=15): shape (37, 800, 800)
    ✓ BottomLeft (view_id=16): shape (37, 800, 800)
    ✓ BottomRight (view_id=17): shape (37, 800, 800)
    ✓ LeftTop (view_id=18): shape (37, 800, 800)
    ✓ RightTop (view_id=19): shape (37, 800, 800)
  ✓ Predictions from all 20 views aggregated
    P stats: min=0.0000, max=1.0000, mean=0.0252
    Non-zero vertices: 136006/146103
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 10097   750  1278  3785     0  2280  1346  4759  5397]
  Ground Truth Stats:
    Labels shape: (146103,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-11/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7808
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8388
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8390

  RESULTS:
  RAW:         median(top-10)=0.9167, mean(top-10)=0.9207, median(all)=0.8543, mean(all)=0.7808
  + SMOOTHING: median(top-10)=0.9529, mean(top-10)=0.9455, median(all)=0.8714, mean(all)=0.8388 [+0.0361]
  + MRF:       median(top-10)=0.9531, mean(top-10)=0.9456, median(all)=0.8718, mean(all)=0.8390 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0364

================================================================================
Subject: NKI-TRT-20-12
================================================================================
  Step 0: Generating predictions with V2 model...
  Mesh: 117868 vertices, 235732 faces
  Rendering and predicting ALL 20 views...
    ✓ Front (view_id=0): shape (37, 800, 800)
    ✓ Back (view_id=1): shape (37, 800, 800)
    ✓ Left (view_id=2): shape (37, 800, 800)
    ✓ Right (view_id=3): shape (37, 800, 800)
    ✓ Top (view_id=4): shape (37, 800, 800)
    ✓ Bottom (view_id=5): shape (37, 800, 800)
    ✓ FrontLeft (view_id=6): shape (37, 800, 800)
    ✓ FrontRight (view_id=7): shape (37, 800, 800)
    ✓ BackLeft (view_id=8): shape (37, 800, 800)
    ✓ BackRight (view_id=9): shape (37, 800, 800)
    ✓ TopFront (view_id=10): shape (37, 800, 800)
    ✓ TopBack (view_id=11): shape (37, 800, 800)
    ✓ TopLeft (view_id=12): shape (37, 800, 800)
    ✓ TopRight (view_id=13): shape (37, 800, 800)
    ✓ BottomFront (view_id=14): shape (37, 800, 800)
    ✓ BottomBack (view_id=15): shape (37, 800, 800)
    ✓ BottomLeft (view_id=16): shape (37, 800, 800)
    ✓ BottomRight (view_id=17): shape (37, 800, 800)
    ✓ LeftTop (view_id=18): shape (37, 800, 800)
    ✓ RightTop (view_id=19): shape (37, 800, 800)
  ✓ Predictions from all 20 views aggregated
    P stats: min=0.0000, max=1.0000, mean=0.0253
    Non-zero vertices: 110327/117868
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 7541 1061  920 3355    0 2524 1309 3573 5479]
  Ground Truth Stats:
    Labels shape: (117868,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-12/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7981
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8518
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8520

  RESULTS:
  RAW:         median(top-10)=0.9281, mean(top-10)=0.9268, median(all)=0.8711, mean(all)=0.7981
  + SMOOTHING: median(top-10)=0.9412, mean(top-10)=0.9444, median(all)=0.8894, mean(all)=0.8518 [+0.0131]
  + MRF:       median(top-10)=0.9414, mean(top-10)=0.9446, median(all)=0.8898, mean(all)=0.8520 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0133

================================================================================
Subject: NKI-TRT-20-13
================================================================================
  Step 0: Generating predictions with V2 model...
  Mesh: 168760 vertices, 337516 faces
  Rendering and predicting ALL 20 views...
    ✓ Front (view_id=0): shape (37, 800, 800)
    ✓ Back (view_id=1): shape (37, 800, 800)
    ✓ Left (view_id=2): shape (37, 800, 800)
    ✓ Right (view_id=3): shape (37, 800, 800)
    ✓ Top (view_id=4): shape (37, 800, 800)
    ✓ Bottom (view_id=5): shape (37, 800, 800)
    ✓ FrontLeft (view_id=6): shape (37, 800, 800)
    ✓ FrontRight (view_id=7): shape (37, 800, 800)
    ✓ BackLeft (view_id=8): shape (37, 800, 800)
    ✓ BackRight (view_id=9): shape (37, 800, 800)
    ✓ TopFront (view_id=10): shape (37, 800, 800)
    ✓ TopBack (view_id=11): shape (37, 800, 800)
    ✓ TopLeft (view_id=12): shape (37, 800, 800)
    ✓ TopRight (view_id=13): shape (37, 800, 800)
    ✓ BottomFront (view_id=14): shape (37, 800, 800)
    ✓ BottomBack (view_id=15): shape (37, 800, 800)
    ✓ BottomLeft (view_id=16): shape (37, 800, 800)
    ✓ BottomRight (view_id=17): shape (37, 800, 800)
    ✓ LeftTop (view_id=18): shape (37, 800, 800)
    ✓ RightTop (view_id=19): shape (37, 800, 800)
  ✓ Predictions from all 20 views aggregated
    P stats: min=0.0000, max=1.0000, mean=0.0246
    Non-zero vertices: 153658/168760
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 15102  1519  1817  4113     0  2804  1345  5058  7851]
  Ground Truth Stats:
    Labels shape: (168760,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-13/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7900
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8601
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8602

  RESULTS:
  RAW:         median(top-10)=0.9156, mean(top-10)=0.9180, median(all)=0.8546, mean(all)=0.7900
  + SMOOTHING: median(top-10)=0.9485, mean(top-10)=0.9482, median(all)=0.8817, mean(all)=0.8601 [+0.0328]
  + MRF:       median(top-10)=0.9489, mean(top-10)=0.9484, median(all)=0.8816, mean(all)=0.8602 [+0.0004]
  TOTAL IMPROVEMENT (median top-10): +0.0333

================================================================================
Subject: NKI-TRT-20-14
================================================================================
  Step 0: Generating predictions with V2 model...
  Mesh: 142909 vertices, 285814 faces
  Rendering and predicting ALL 20 views...
    ✓ Front (view_id=0): shape (37, 800, 800)
    ✓ Back (view_id=1): shape (37, 800, 800)
    ✓ Left (view_id=2): shape (37, 800, 800)
    ✓ Right (view_id=3): shape (37, 800, 800)
    ✓ Top (view_id=4): shape (37, 800, 800)
    ✓ Bottom (view_id=5): shape (37, 800, 800)
    ✓ FrontLeft (view_id=6): shape (37, 800, 800)
    ✓ FrontRight (view_id=7): shape (37, 800, 800)
    ✓ BackLeft (view_id=8): shape (37, 800, 800)
    ✓ BackRight (view_id=9): shape (37, 800, 800)
    ✓ TopFront (view_id=10): shape (37, 800, 800)
    ✓ TopBack (view_id=11): shape (37, 800, 800)
    ✓ TopLeft (view_id=12): shape (37, 800, 800)
    ✓ TopRight (view_id=13): shape (37, 800, 800)
    ✓ BottomFront (view_id=14): shape (37, 800, 800)
    ✓ BottomBack (view_id=15): shape (37, 800, 800)
    ✓ BottomLeft (view_id=16): shape (37, 800, 800)
    ✓ BottomRight (view_id=17): shape (37, 800, 800)
    ✓ LeftTop (view_id=18): shape (37, 800, 800)
    ✓ RightTop (view_id=19): shape (37, 800, 800)
  ✓ Predictions from all 20 views aggregated
    P stats: min=0.0000, max=1.0000, mean=0.0246
    Non-zero vertices: 129839/142909
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 13070  1125  1251  2973     0  2396  1325  4568  6555]
  Ground Truth Stats:
    Labels shape: (142909,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-14/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7878
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8493
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8495

  RESULTS:
  RAW:         median(top-10)=0.9284, mean(top-10)=0.9285, median(all)=0.8650, mean(all)=0.7878
  + SMOOTHING: median(top-10)=0.9484, mean(top-10)=0.9483, median(all)=0.9132, mean(all)=0.8493 [+0.0200]
  + MRF:       median(top-10)=0.9483, mean(top-10)=0.9483, median(all)=0.9136, mean(all)=0.8495 [-0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0199

================================================================================
Subject: NKI-TRT-20-15
================================================================================
  Step 0: Generating predictions with V2 model...
  Mesh: 133351 vertices, 266698 faces
  Rendering and predicting ALL 20 views...
    ✓ Front (view_id=0): shape (37, 800, 800)
    ✓ Back (view_id=1): shape (37, 800, 800)
    ✓ Left (view_id=2): shape (37, 800, 800)
    ✓ Right (view_id=3): shape (37, 800, 800)
    ✓ Top (view_id=4): shape (37, 800, 800)
    ✓ Bottom (view_id=5): shape (37, 800, 800)
    ✓ FrontLeft (view_id=6): shape (37, 800, 800)
    ✓ FrontRight (view_id=7): shape (37, 800, 800)
    ✓ BackLeft (view_id=8): shape (37, 800, 800)
    ✓ BackRight (view_id=9): shape (37, 800, 800)
    ✓ TopFront (view_id=10): shape (37, 800, 800)
    ✓ TopBack (view_id=11): shape (37, 800, 800)
    ✓ TopLeft (view_id=12): shape (37, 800, 800)
    ✓ TopRight (view_id=13): shape (37, 800, 800)
    ✓ BottomFront (view_id=14): shape (37, 800, 800)
    ✓ BottomBack (view_id=15): shape (37, 800, 800)
    ✓ BottomLeft (view_id=16): shape (37, 800, 800)
    ✓ BottomRight (view_id=17): shape (37, 800, 800)
    ✓ LeftTop (view_id=18): shape (37, 800, 800)
    ✓ RightTop (view_id=19): shape (37, 800, 800)
  ✓ Predictions from all 20 views aggregated
    P stats: min=0.0000, max=0.9999, mean=0.0252
    Non-zero vertices: 124176/133351
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 9175 1071 1100 3209    0 1936 1177 4912 5578]
  Ground Truth Stats:
    Labels shape: (133351,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-15/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.8002
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8585
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8586

  RESULTS:
  RAW:         median(top-10)=0.9241, mean(top-10)=0.9272, median(all)=0.8522, mean(all)=0.8002
  + SMOOTHING: median(top-10)=0.9548, mean(top-10)=0.9543, median(all)=0.9001, mean(all)=0.8585 [+0.0307]
  + MRF:       median(top-10)=0.9551, mean(top-10)=0.9544, median(all)=0.8999, mean(all)=0.8586 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0310

================================================================================
Subject: NKI-TRT-20-16
================================================================================
  Step 0: Generating predictions with V2 model...
  Mesh: 157852 vertices, 315700 faces
  Rendering and predicting ALL 20 views...
    ✓ Front (view_id=0): shape (37, 800, 800)
    ✓ Back (view_id=1): shape (37, 800, 800)
    ✓ Left (view_id=2): shape (37, 800, 800)
    ✓ Right (view_id=3): shape (37, 800, 800)
    ✓ Top (view_id=4): shape (37, 800, 800)
    ✓ Bottom (view_id=5): shape (37, 800, 800)
    ✓ FrontLeft (view_id=6): shape (37, 800, 800)
    ✓ FrontRight (view_id=7): shape (37, 800, 800)
    ✓ BackLeft (view_id=8): shape (37, 800, 800)
    ✓ BackRight (view_id=9): shape (37, 800, 800)
    ✓ TopFront (view_id=10): shape (37, 800, 800)
    ✓ TopBack (view_id=11): shape (37, 800, 800)
    ✓ TopLeft (view_id=12): shape (37, 800, 800)
    ✓ TopRight (view_id=13): shape (37, 800, 800)
    ✓ BottomFront (view_id=14): shape (37, 800, 800)
    ✓ BottomBack (view_id=15): shape (37, 800, 800)
    ✓ BottomLeft (view_id=16): shape (37, 800, 800)
    ✓ BottomRight (view_id=17): shape (37, 800, 800)
    ✓ LeftTop (view_id=18): shape (37, 800, 800)
    ✓ RightTop (view_id=19): shape (37, 800, 800)
  ✓ Predictions from all 20 views aggregated
    P stats: min=0.0000, max=1.0000, mean=0.0252
    Non-zero vertices: 146949/157852
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 10903  1358  1357  4337     0  2172  1350  5454  6791]
  Ground Truth Stats:
    Labels shape: (157852,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-16/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.8014
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8611
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8611

  RESULTS:
  RAW:         median(top-10)=0.9199, mean(top-10)=0.9231, median(all)=0.8657, mean(all)=0.8014
  + SMOOTHING: median(top-10)=0.9458, mean(top-10)=0.9460, median(all)=0.9002, mean(all)=0.8611 [+0.0258]
  + MRF:       median(top-10)=0.9460, mean(top-10)=0.9461, median(all)=0.9000, mean(all)=0.8611 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0260

================================================================================
Subject: NKI-TRT-20-17
================================================================================
  Step 0: Generating predictions with V2 model...
  Mesh: 135896 vertices, 271788 faces
  Rendering and predicting ALL 20 views...
    ✓ Front (view_id=0): shape (37, 800, 800)
    ✓ Back (view_id=1): shape (37, 800, 800)
    ✓ Left (view_id=2): shape (37, 800, 800)
    ✓ Right (view_id=3): shape (37, 800, 800)
    ✓ Top (view_id=4): shape (37, 800, 800)
    ✓ Bottom (view_id=5): shape (37, 800, 800)
    ✓ FrontLeft (view_id=6): shape (37, 800, 800)
    ✓ FrontRight (view_id=7): shape (37, 800, 800)
    ✓ BackLeft (view_id=8): shape (37, 800, 800)
    ✓ BackRight (view_id=9): shape (37, 800, 800)
    ✓ TopFront (view_id=10): shape (37, 800, 800)
    ✓ TopBack (view_id=11): shape (37, 800, 800)
    ✓ TopLeft (view_id=12): shape (37, 800, 800)
    ✓ TopRight (view_id=13): shape (37, 800, 800)
    ✓ BottomFront (view_id=14): shape (37, 800, 800)
    ✓ BottomBack (view_id=15): shape (37, 800, 800)
    ✓ BottomLeft (view_id=16): shape (37, 800, 800)
    ✓ BottomRight (view_id=17): shape (37, 800, 800)
    ✓ LeftTop (view_id=18): shape (37, 800, 800)
    ✓ RightTop (view_id=19): shape (37, 800, 800)
  ✓ Predictions from all 20 views aggregated
    P stats: min=0.0000, max=1.0000, mean=0.0249
    Non-zero vertices: 125131/135896
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 10765  1240  1387  3080     0  1858  1308  4867  6047]
  Ground Truth Stats:
    Labels shape: (135896,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-17/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7887
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8524
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8524

  RESULTS:
  RAW:         median(top-10)=0.9172, mean(top-10)=0.9242, median(all)=0.8662, mean(all)=0.7887
  + SMOOTHING: median(top-10)=0.9502, mean(top-10)=0.9524, median(all)=0.8985, mean(all)=0.8524 [+0.0330]
  + MRF:       median(top-10)=0.9504, mean(top-10)=0.9526, median(all)=0.8989, mean(all)=0.8524 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0333

================================================================================
Subject: NKI-TRT-20-18
================================================================================
  Step 0: Generating predictions with V2 model...
  Mesh: 132036 vertices, 264068 faces
  Rendering and predicting ALL 20 views...
    ✓ Front (view_id=0): shape (37, 800, 800)
    ✓ Back (view_id=1): shape (37, 800, 800)
    ✓ Left (view_id=2): shape (37, 800, 800)
    ✓ Right (view_id=3): shape (37, 800, 800)
    ✓ Top (view_id=4): shape (37, 800, 800)
    ✓ Bottom (view_id=5): shape (37, 800, 800)
    ✓ FrontLeft (view_id=6): shape (37, 800, 800)
    ✓ FrontRight (view_id=7): shape (37, 800, 800)
    ✓ BackLeft (view_id=8): shape (37, 800, 800)
    ✓ BackRight (view_id=9): shape (37, 800, 800)
    ✓ TopFront (view_id=10): shape (37, 800, 800)
    ✓ TopBack (view_id=11): shape (37, 800, 800)
    ✓ TopLeft (view_id=12): shape (37, 800, 800)
    ✓ TopRight (view_id=13): shape (37, 800, 800)
    ✓ BottomFront (view_id=14): shape (37, 800, 800)
    ✓ BottomBack (view_id=15): shape (37, 800, 800)
    ✓ BottomLeft (view_id=16): shape (37, 800, 800)
    ✓ BottomRight (view_id=17): shape (37, 800, 800)
    ✓ LeftTop (view_id=18): shape (37, 800, 800)
    ✓ RightTop (view_id=19): shape (37, 800, 800)
  ✓ Predictions from all 20 views aggregated
    P stats: min=0.0000, max=1.0000, mean=0.0254
    Non-zero vertices: 123876/132036
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 8160 1213 1007 3603    0 2114 1138 4382 6385]
  Ground Truth Stats:
    Labels shape: (132036,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-18/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.8004
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8530
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8531

  RESULTS:
  RAW:         median(top-10)=0.9194, mean(top-10)=0.9191, median(all)=0.8552, mean(all)=0.8004
  + SMOOTHING: median(top-10)=0.9402, mean(top-10)=0.9423, median(all)=0.8841, mean(all)=0.8530 [+0.0208]
  + MRF:       median(top-10)=0.9405, mean(top-10)=0.9424, median(all)=0.8842, mean(all)=0.8531 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0211

================================================================================
Subject: NKI-TRT-20-19
================================================================================
  Step 0: Generating predictions with V2 model...
  Mesh: 131542 vertices, 263080 faces
  Rendering and predicting ALL 20 views...
    ✓ Front (view_id=0): shape (37, 800, 800)
    ✓ Back (view_id=1): shape (37, 800, 800)
    ✓ Left (view_id=2): shape (37, 800, 800)
    ✓ Right (view_id=3): shape (37, 800, 800)
    ✓ Top (view_id=4): shape (37, 800, 800)
    ✓ Bottom (view_id=5): shape (37, 800, 800)
    ✓ FrontLeft (view_id=6): shape (37, 800, 800)
    ✓ FrontRight (view_id=7): shape (37, 800, 800)
    ✓ BackLeft (view_id=8): shape (37, 800, 800)
    ✓ BackRight (view_id=9): shape (37, 800, 800)
    ✓ TopFront (view_id=10): shape (37, 800, 800)
    ✓ TopBack (view_id=11): shape (37, 800, 800)
    ✓ TopLeft (view_id=12): shape (37, 800, 800)
    ✓ TopRight (view_id=13): shape (37, 800, 800)
    ✓ BottomFront (view_id=14): shape (37, 800, 800)
    ✓ BottomBack (view_id=15): shape (37, 800, 800)
    ✓ BottomLeft (view_id=16): shape (37, 800, 800)
    ✓ BottomRight (view_id=17): shape (37, 800, 800)
    ✓ LeftTop (view_id=18): shape (37, 800, 800)
    ✓ RightTop (view_id=19): shape (37, 800, 800)
  ✓ Predictions from all 20 views aggregated
    P stats: min=0.0000, max=1.0000, mean=0.0248
    Non-zero vertices: 120792/131542
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 10750  1274  1109  2854     0  2085  1174  4269  5632]
  Ground Truth Stats:
    Labels shape: (131542,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-19/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7984
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8599
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8602

  RESULTS:
  RAW:         median(top-10)=0.9153, mean(top-10)=0.9201, median(all)=0.8652, mean(all)=0.7984
  + SMOOTHING: median(top-10)=0.9448, mean(top-10)=0.9463, median(all)=0.9031, mean(all)=0.8599 [+0.0295]
  + MRF:       median(top-10)=0.9448, mean(top-10)=0.9465, median(all)=0.9032, mean(all)=0.8602 [+0.0000]
  TOTAL IMPROVEMENT (median top-10): +0.0295

================================================================================
Subject: NKI-TRT-20-2
================================================================================
  Step 0: Generating predictions with V2 model...
  Mesh: 174172 vertices, 348340 faces
  Rendering and predicting ALL 20 views...
    ✓ Front (view_id=0): shape (37, 800, 800)
    ✓ Back (view_id=1): shape (37, 800, 800)
    ✓ Left (view_id=2): shape (37, 800, 800)
    ✓ Right (view_id=3): shape (37, 800, 800)
    ✓ Top (view_id=4): shape (37, 800, 800)
    ✓ Bottom (view_id=5): shape (37, 800, 800)
    ✓ FrontLeft (view_id=6): shape (37, 800, 800)
    ✓ FrontRight (view_id=7): shape (37, 800, 800)
    ✓ BackLeft (view_id=8): shape (37, 800, 800)
    ✓ BackRight (view_id=9): shape (37, 800, 800)
    ✓ TopFront (view_id=10): shape (37, 800, 800)
    ✓ TopBack (view_id=11): shape (37, 800, 800)
    ✓ TopLeft (view_id=12): shape (37, 800, 800)
    ✓ TopRight (view_id=13): shape (37, 800, 800)
    ✓ BottomFront (view_id=14): shape (37, 800, 800)
    ✓ BottomBack (view_id=15): shape (37, 800, 800)
    ✓ BottomLeft (view_id=16): shape (37, 800, 800)
    ✓ BottomRight (view_id=17): shape (37, 800, 800)
    ✓ LeftTop (view_id=18): shape (37, 800, 800)
    ✓ RightTop (view_id=19): shape (37, 800, 800)
  ✓ Predictions from all 20 views aggregated
    P stats: min=0.0000, max=1.0000, mean=0.0243
    Non-zero vertices: 156720/174172
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 17452  1953  1483  5321     0  2689  1386  5820  8792]
  Ground Truth Stats:
    Labels shape: (174172,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-2/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7809
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8466
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8467

  RESULTS:
  RAW:         median(top-10)=0.8967, mean(top-10)=0.8985, median(all)=0.8462, mean(all)=0.7809
  + SMOOTHING: median(top-10)=0.9290, mean(top-10)=0.9308, median(all)=0.8994, mean(all)=0.8466 [+0.0323]
  + MRF:       median(top-10)=0.9292, mean(top-10)=0.9310, median(all)=0.8995, mean(all)=0.8467 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0325

================================================================================
Subject: NKI-TRT-20-20
================================================================================
  Step 0: Generating predictions with V2 model...
  Mesh: 147840 vertices, 295676 faces
  Rendering and predicting ALL 20 views...
    ✓ Front (view_id=0): shape (37, 800, 800)
    ✓ Back (view_id=1): shape (37, 800, 800)
    ✓ Left (view_id=2): shape (37, 800, 800)
    ✓ Right (view_id=3): shape (37, 800, 800)
    ✓ Top (view_id=4): shape (37, 800, 800)
    ✓ Bottom (view_id=5): shape (37, 800, 800)
    ✓ FrontLeft (view_id=6): shape (37, 800, 800)
    ✓ FrontRight (view_id=7): shape (37, 800, 800)
    ✓ BackLeft (view_id=8): shape (37, 800, 800)
    ✓ BackRight (view_id=9): shape (37, 800, 800)
    ✓ TopFront (view_id=10): shape (37, 800, 800)
    ✓ TopBack (view_id=11): shape (37, 800, 800)
    ✓ TopLeft (view_id=12): shape (37, 800, 800)
    ✓ TopRight (view_id=13): shape (37, 800, 800)
    ✓ BottomFront (view_id=14): shape (37, 800, 800)
    ✓ BottomBack (view_id=15): shape (37, 800, 800)
    ✓ BottomLeft (view_id=16): shape (37, 800, 800)
    ✓ BottomRight (view_id=17): shape (37, 800, 800)
    ✓ LeftTop (view_id=18): shape (37, 800, 800)
    ✓ RightTop (view_id=19): shape (37, 800, 800)
  ✓ Predictions from all 20 views aggregated
    P stats: min=0.0000, max=1.0000, mean=0.0249
    Non-zero vertices: 135988/147840
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 11852  1318  1440  3972     0  2049  1093  4495  5527]
  Ground Truth Stats:
    Labels shape: (147840,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-20/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.8044
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8644
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8646

  RESULTS:
  RAW:         median(top-10)=0.9136, mean(top-10)=0.9186, median(all)=0.8638, mean(all)=0.8044
  + SMOOTHING: median(top-10)=0.9472, mean(top-10)=0.9482, median(all)=0.9107, mean(all)=0.8644 [+0.0336]
  + MRF:       median(top-10)=0.9475, mean(top-10)=0.9484, median(all)=0.9110, mean(all)=0.8646 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0339

================================================================================
Subject: NKI-TRT-20-3
================================================================================
  Step 0: Generating predictions with V2 model...
  Mesh: 123781 vertices, 247558 faces
  Rendering and predicting ALL 20 views...
    ✓ Front (view_id=0): shape (37, 800, 800)
    ✓ Back (view_id=1): shape (37, 800, 800)
    ✓ Left (view_id=2): shape (37, 800, 800)
    ✓ Right (view_id=3): shape (37, 800, 800)
    ✓ Top (view_id=4): shape (37, 800, 800)
    ✓ Bottom (view_id=5): shape (37, 800, 800)
    ✓ FrontLeft (view_id=6): shape (37, 800, 800)
    ✓ FrontRight (view_id=7): shape (37, 800, 800)
    ✓ BackLeft (view_id=8): shape (37, 800, 800)
    ✓ BackRight (view_id=9): shape (37, 800, 800)
    ✓ TopFront (view_id=10): shape (37, 800, 800)
    ✓ TopBack (view_id=11): shape (37, 800, 800)
    ✓ TopLeft (view_id=12): shape (37, 800, 800)
    ✓ TopRight (view_id=13): shape (37, 800, 800)
    ✓ BottomFront (view_id=14): shape (37, 800, 800)
    ✓ BottomBack (view_id=15): shape (37, 800, 800)
    ✓ BottomLeft (view_id=16): shape (37, 800, 800)
    ✓ BottomRight (view_id=17): shape (37, 800, 800)
    ✓ LeftTop (view_id=18): shape (37, 800, 800)
    ✓ RightTop (view_id=19): shape (37, 800, 800)
  ✓ Predictions from all 20 views aggregated
    P stats: min=0.0000, max=1.0000, mean=0.0249
    Non-zero vertices: 114220/123781
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 9561 1069 1020 3501    0 1869 1000 4562 5432]
  Ground Truth Stats:
    Labels shape: (123781,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-3/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7971
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8582
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8585

  RESULTS:
  RAW:         median(top-10)=0.9197, mean(top-10)=0.9186, median(all)=0.8563, mean(all)=0.7971
  + SMOOTHING: median(top-10)=0.9442, mean(top-10)=0.9446, median(all)=0.9170, mean(all)=0.8582 [+0.0244]
  + MRF:       median(top-10)=0.9444, mean(top-10)=0.9449, median(all)=0.9177, mean(all)=0.8585 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0247

================================================================================
Subject: NKI-TRT-20-4
================================================================================
  Step 0: Generating predictions with V2 model...
  Mesh: 158207 vertices, 316410 faces
  Rendering and predicting ALL 20 views...
    ✓ Front (view_id=0): shape (37, 800, 800)
    ✓ Back (view_id=1): shape (37, 800, 800)
    ✓ Left (view_id=2): shape (37, 800, 800)
    ✓ Right (view_id=3): shape (37, 800, 800)
    ✓ Top (view_id=4): shape (37, 800, 800)
    ✓ Bottom (view_id=5): shape (37, 800, 800)
    ✓ FrontLeft (view_id=6): shape (37, 800, 800)
    ✓ FrontRight (view_id=7): shape (37, 800, 800)
    ✓ BackLeft (view_id=8): shape (37, 800, 800)
    ✓ BackRight (view_id=9): shape (37, 800, 800)
    ✓ TopFront (view_id=10): shape (37, 800, 800)
    ✓ TopBack (view_id=11): shape (37, 800, 800)
    ✓ TopLeft (view_id=12): shape (37, 800, 800)
    ✓ TopRight (view_id=13): shape (37, 800, 800)
    ✓ BottomFront (view_id=14): shape (37, 800, 800)
    ✓ BottomBack (view_id=15): shape (37, 800, 800)
    ✓ BottomLeft (view_id=16): shape (37, 800, 800)
    ✓ BottomRight (view_id=17): shape (37, 800, 800)
    ✓ LeftTop (view_id=18): shape (37, 800, 800)
    ✓ RightTop (view_id=19): shape (37, 800, 800)
  ✓ Predictions from all 20 views aggregated
    P stats: min=0.0000, max=1.0000, mean=0.0246
    Non-zero vertices: 143817/158207
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 14390  1290  1211  4140     0  2576  1369  5670  6795]
  Ground Truth Stats:
    Labels shape: (158207,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-4/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
    MRF iteration 5/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7787
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8472
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8474

  RESULTS:
  RAW:         median(top-10)=0.9072, mean(top-10)=0.9096, median(all)=0.8583, mean(all)=0.7787
  + SMOOTHING: median(top-10)=0.9435, mean(top-10)=0.9429, median(all)=0.8967, mean(all)=0.8472 [+0.0363]
  + MRF:       median(top-10)=0.9437, mean(top-10)=0.9430, median(all)=0.8966, mean(all)=0.8474 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0365

================================================================================
Subject: NKI-TRT-20-5
================================================================================
  Step 0: Generating predictions with V2 model...
  Mesh: 137753 vertices, 275502 faces
  Rendering and predicting ALL 20 views...
    ✓ Front (view_id=0): shape (37, 800, 800)
    ✓ Back (view_id=1): shape (37, 800, 800)
    ✓ Left (view_id=2): shape (37, 800, 800)
    ✓ Right (view_id=3): shape (37, 800, 800)
    ✓ Top (view_id=4): shape (37, 800, 800)
    ✓ Bottom (view_id=5): shape (37, 800, 800)
    ✓ FrontLeft (view_id=6): shape (37, 800, 800)
    ✓ FrontRight (view_id=7): shape (37, 800, 800)
    ✓ BackLeft (view_id=8): shape (37, 800, 800)
    ✓ BackRight (view_id=9): shape (37, 800, 800)
    ✓ TopFront (view_id=10): shape (37, 800, 800)
    ✓ TopBack (view_id=11): shape (37, 800, 800)
    ✓ TopLeft (view_id=12): shape (37, 800, 800)
    ✓ TopRight (view_id=13): shape (37, 800, 800)
    ✓ BottomFront (view_id=14): shape (37, 800, 800)
    ✓ BottomBack (view_id=15): shape (37, 800, 800)
    ✓ BottomLeft (view_id=16): shape (37, 800, 800)
    ✓ BottomRight (view_id=17): shape (37, 800, 800)
    ✓ LeftTop (view_id=18): shape (37, 800, 800)
    ✓ RightTop (view_id=19): shape (37, 800, 800)
  ✓ Predictions from all 20 views aggregated
    P stats: min=0.0000, max=1.0000, mean=0.0244
    Non-zero vertices: 124248/137753
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 13505  1303  1243  3498     0  2417  1204  4511  6947]
  Ground Truth Stats:
    Labels shape: (137753,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-5/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7993
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8628
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8627

  RESULTS:
  RAW:         median(top-10)=0.9184, mean(top-10)=0.9156, median(all)=0.8463, mean(all)=0.7993
  + SMOOTHING: median(top-10)=0.9405, mean(top-10)=0.9403, median(all)=0.9063, mean(all)=0.8628 [+0.0221]
  + MRF:       median(top-10)=0.9404, mean(top-10)=0.9404, median(all)=0.9066, mean(all)=0.8627 [-0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0220

================================================================================
Subject: NKI-TRT-20-6
================================================================================
  Step 0: Generating predictions with V2 model...
  Mesh: 158025 vertices, 316046 faces
  Rendering and predicting ALL 20 views...
    ✓ Front (view_id=0): shape (37, 800, 800)
    ✓ Back (view_id=1): shape (37, 800, 800)
    ✓ Left (view_id=2): shape (37, 800, 800)
    ✓ Right (view_id=3): shape (37, 800, 800)
    ✓ Top (view_id=4): shape (37, 800, 800)
    ✓ Bottom (view_id=5): shape (37, 800, 800)
    ✓ FrontLeft (view_id=6): shape (37, 800, 800)
    ✓ FrontRight (view_id=7): shape (37, 800, 800)
    ✓ BackLeft (view_id=8): shape (37, 800, 800)
    ✓ BackRight (view_id=9): shape (37, 800, 800)
    ✓ TopFront (view_id=10): shape (37, 800, 800)
    ✓ TopBack (view_id=11): shape (37, 800, 800)
    ✓ TopLeft (view_id=12): shape (37, 800, 800)
    ✓ TopRight (view_id=13): shape (37, 800, 800)
    ✓ BottomFront (view_id=14): shape (37, 800, 800)
    ✓ BottomBack (view_id=15): shape (37, 800, 800)
    ✓ BottomLeft (view_id=16): shape (37, 800, 800)
    ✓ BottomRight (view_id=17): shape (37, 800, 800)
    ✓ LeftTop (view_id=18): shape (37, 800, 800)
    ✓ RightTop (view_id=19): shape (37, 800, 800)
  ✓ Predictions from all 20 views aggregated
    P stats: min=0.0000, max=1.0000, mean=0.0248
    Non-zero vertices: 145259/158025
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 12766  1517  1123  3295     0  2186  1186  6195  8153]
  Ground Truth Stats:
    Labels shape: (158025,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-6/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
    MRF iteration 5/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.8049
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8695
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8697

  RESULTS:
  RAW:         median(top-10)=0.9055, mean(top-10)=0.9154, median(all)=0.8772, mean(all)=0.8049
  + SMOOTHING: median(top-10)=0.9435, mean(top-10)=0.9473, median(all)=0.9088, mean(all)=0.8695 [+0.0381]
  + MRF:       median(top-10)=0.9436, mean(top-10)=0.9473, median(all)=0.9087, mean(all)=0.8697 [+0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0382

================================================================================
Subject: NKI-TRT-20-7
================================================================================
  Step 0: Generating predictions with V2 model...
  Mesh: 145017 vertices, 290030 faces
  Rendering and predicting ALL 20 views...
    ✓ Front (view_id=0): shape (37, 800, 800)
    ✓ Back (view_id=1): shape (37, 800, 800)
    ✓ Left (view_id=2): shape (37, 800, 800)
    ✓ Right (view_id=3): shape (37, 800, 800)
    ✓ Top (view_id=4): shape (37, 800, 800)
    ✓ Bottom (view_id=5): shape (37, 800, 800)
    ✓ FrontLeft (view_id=6): shape (37, 800, 800)
    ✓ FrontRight (view_id=7): shape (37, 800, 800)
    ✓ BackLeft (view_id=8): shape (37, 800, 800)
    ✓ BackRight (view_id=9): shape (37, 800, 800)
    ✓ TopFront (view_id=10): shape (37, 800, 800)
    ✓ TopBack (view_id=11): shape (37, 800, 800)
    ✓ TopLeft (view_id=12): shape (37, 800, 800)
    ✓ TopRight (view_id=13): shape (37, 800, 800)
    ✓ BottomFront (view_id=14): shape (37, 800, 800)
    ✓ BottomBack (view_id=15): shape (37, 800, 800)
    ✓ BottomLeft (view_id=16): shape (37, 800, 800)
    ✓ BottomRight (view_id=17): shape (37, 800, 800)
    ✓ LeftTop (view_id=18): shape (37, 800, 800)
    ✓ RightTop (view_id=19): shape (37, 800, 800)
  ✓ Predictions from all 20 views aggregated
    P stats: min=0.0000, max=1.0000, mean=0.0243
    Non-zero vertices: 130622/145017
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 14395  1287  1219  3899     0  2130  1333  5021  5655]
  Ground Truth Stats:
    Labels shape: (145017,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-7/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7822
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8603
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8604

  RESULTS:
  RAW:         median(top-10)=0.9028, mean(top-10)=0.9075, median(all)=0.8504, mean(all)=0.7822
  + SMOOTHING: median(top-10)=0.9424, mean(top-10)=0.9450, median(all)=0.9072, mean(all)=0.8603 [+0.0396]
  + MRF:       median(top-10)=0.9423, mean(top-10)=0.9450, median(all)=0.9068, mean(all)=0.8604 [-0.0000]
  TOTAL IMPROVEMENT (median top-10): +0.0395

================================================================================
Subject: NKI-TRT-20-8
================================================================================
  Step 0: Generating predictions with V2 model...
  Mesh: 147404 vertices, 294804 faces
  Rendering and predicting ALL 20 views...
    ✓ Front (view_id=0): shape (37, 800, 800)
    ✓ Back (view_id=1): shape (37, 800, 800)
    ✓ Left (view_id=2): shape (37, 800, 800)
    ✓ Right (view_id=3): shape (37, 800, 800)
    ✓ Top (view_id=4): shape (37, 800, 800)
    ✓ Bottom (view_id=5): shape (37, 800, 800)
    ✓ FrontLeft (view_id=6): shape (37, 800, 800)
    ✓ FrontRight (view_id=7): shape (37, 800, 800)
    ✓ BackLeft (view_id=8): shape (37, 800, 800)
    ✓ BackRight (view_id=9): shape (37, 800, 800)
    ✓ TopFront (view_id=10): shape (37, 800, 800)
    ✓ TopBack (view_id=11): shape (37, 800, 800)
    ✓ TopLeft (view_id=12): shape (37, 800, 800)
    ✓ TopRight (view_id=13): shape (37, 800, 800)
    ✓ BottomFront (view_id=14): shape (37, 800, 800)
    ✓ BottomBack (view_id=15): shape (37, 800, 800)
    ✓ BottomLeft (view_id=16): shape (37, 800, 800)
    ✓ BottomRight (view_id=17): shape (37, 800, 800)
    ✓ LeftTop (view_id=18): shape (37, 800, 800)
    ✓ RightTop (view_id=19): shape (37, 800, 800)
  ✓ Predictions from all 20 views aggregated
    P stats: min=0.0000, max=1.0000, mean=0.0245
    Non-zero vertices: 133700/147404
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 13704  1506   955  3141     0  2219  1645  4737  7348]
  Ground Truth Stats:
    Labels shape: (147404,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-8/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7623
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8294
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8296

  RESULTS:
  RAW:         median(top-10)=0.8872, mean(top-10)=0.8954, median(all)=0.8314, mean(all)=0.7623
  + SMOOTHING: median(top-10)=0.9260, mean(top-10)=0.9269, median(all)=0.8661, mean(all)=0.8294 [+0.0387]
  + MRF:       median(top-10)=0.9259, mean(top-10)=0.9270, median(all)=0.8669, mean(all)=0.8296 [-0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0387

================================================================================
Subject: NKI-TRT-20-9
================================================================================
  Step 0: Generating predictions with V2 model...
  Mesh: 141802 vertices, 283600 faces
  Rendering and predicting ALL 20 views...
    ✓ Front (view_id=0): shape (37, 800, 800)
    ✓ Back (view_id=1): shape (37, 800, 800)
    ✓ Left (view_id=2): shape (37, 800, 800)
    ✓ Right (view_id=3): shape (37, 800, 800)
    ✓ Top (view_id=4): shape (37, 800, 800)
    ✓ Bottom (view_id=5): shape (37, 800, 800)
    ✓ FrontLeft (view_id=6): shape (37, 800, 800)
    ✓ FrontRight (view_id=7): shape (37, 800, 800)
    ✓ BackLeft (view_id=8): shape (37, 800, 800)
    ✓ BackRight (view_id=9): shape (37, 800, 800)
    ✓ TopFront (view_id=10): shape (37, 800, 800)
    ✓ TopBack (view_id=11): shape (37, 800, 800)
    ✓ TopLeft (view_id=12): shape (37, 800, 800)
    ✓ TopRight (view_id=13): shape (37, 800, 800)
    ✓ BottomFront (view_id=14): shape (37, 800, 800)
    ✓ BottomBack (view_id=15): shape (37, 800, 800)
    ✓ BottomLeft (view_id=16): shape (37, 800, 800)
    ✓ BottomRight (view_id=17): shape (37, 800, 800)
    ✓ LeftTop (view_id=18): shape (37, 800, 800)
    ✓ RightTop (view_id=19): shape (37, 800, 800)
  ✓ Predictions from all 20 views aggregated
    P stats: min=0.0000, max=1.0000, mean=0.0250
    Non-zero vertices: 131309/141802
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 10493  1650  1086  3285     0  2254  1241  5090  7843]
  Ground Truth Stats:
    Labels shape: (141802,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-9/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7912
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8516
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8515

  RESULTS:
  RAW:         median(top-10)=0.9162, mean(top-10)=0.9151, median(all)=0.8551, mean(all)=0.7912
  + SMOOTHING: median(top-10)=0.9470, mean(top-10)=0.9398, median(all)=0.8944, mean(all)=0.8516 [+0.0308]
  + MRF:       median(top-10)=0.9471, mean(top-10)=0.9398, median(all)=0.8946, mean(all)=0.8515 [+0.0000]
  TOTAL IMPROVEMENT (median top-10): +0.0308

================================================================================
Subject: OASIS-TRT-20-1
================================================================================
  Step 0: Generating predictions with V2 model...
  Mesh: 149052 vertices, 298100 faces
  Rendering and predicting ALL 20 views...
    ✓ Front (view_id=0): shape (37, 800, 800)
    ✓ Back (view_id=1): shape (37, 800, 800)
    ✓ Left (view_id=2): shape (37, 800, 800)
    ✓ Right (view_id=3): shape (37, 800, 800)
    ✓ Top (view_id=4): shape (37, 800, 800)
    ✓ Bottom (view_id=5): shape (37, 800, 800)
    ✓ FrontLeft (view_id=6): shape (37, 800, 800)
    ✓ FrontRight (view_id=7): shape (37, 800, 800)
    ✓ BackLeft (view_id=8): shape (37, 800, 800)
    ✓ BackRight (view_id=9): shape (37, 800, 800)
    ✓ TopFront (view_id=10): shape (37, 800, 800)
    ✓ TopBack (view_id=11): shape (37, 800, 800)
    ✓ TopLeft (view_id=12): shape (37, 800, 800)
    ✓ TopRight (view_id=13): shape (37, 800, 800)
    ✓ BottomFront (view_id=14): shape (37, 800, 800)
    ✓ BottomBack (view_id=15): shape (37, 800, 800)
    ✓ BottomLeft (view_id=16): shape (37, 800, 800)
    ✓ BottomRight (view_id=17): shape (37, 800, 800)
    ✓ LeftTop (view_id=18): shape (37, 800, 800)
    ✓ RightTop (view_id=19): shape (37, 800, 800)
  ✓ Predictions from all 20 views aggregated
    P stats: min=0.0000, max=1.0000, mean=0.0249
    Non-zero vertices: 137154/149052
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 11898  1371  1159  4261     0  2136  1313  4783  6530]
  Ground Truth Stats:
    Labels shape: (149052,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-1/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7864
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8511
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8513

  RESULTS:
  RAW:         median(top-10)=0.9238, mean(top-10)=0.9274, median(all)=0.8648, mean(all)=0.7864
  + SMOOTHING: median(top-10)=0.9468, mean(top-10)=0.9463, median(all)=0.8941, mean(all)=0.8511 [+0.0230]
  + MRF:       median(top-10)=0.9469, mean(top-10)=0.9464, median(all)=0.8939, mean(all)=0.8513 [+0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0232

================================================================================
Subject: OASIS-TRT-20-10
================================================================================
  Step 0: Generating predictions with V2 model...
  Mesh: 129540 vertices, 259076 faces
  Rendering and predicting ALL 20 views...
    ✓ Front (view_id=0): shape (37, 800, 800)
    ✓ Back (view_id=1): shape (37, 800, 800)
    ✓ Left (view_id=2): shape (37, 800, 800)
    ✓ Right (view_id=3): shape (37, 800, 800)
    ✓ Top (view_id=4): shape (37, 800, 800)
    ✓ Bottom (view_id=5): shape (37, 800, 800)
    ✓ FrontLeft (view_id=6): shape (37, 800, 800)
    ✓ FrontRight (view_id=7): shape (37, 800, 800)
    ✓ BackLeft (view_id=8): shape (37, 800, 800)
    ✓ BackRight (view_id=9): shape (37, 800, 800)
    ✓ TopFront (view_id=10): shape (37, 800, 800)
    ✓ TopBack (view_id=11): shape (37, 800, 800)
    ✓ TopLeft (view_id=12): shape (37, 800, 800)
    ✓ TopRight (view_id=13): shape (37, 800, 800)
    ✓ BottomFront (view_id=14): shape (37, 800, 800)
    ✓ BottomBack (view_id=15): shape (37, 800, 800)
    ✓ BottomLeft (view_id=16): shape (37, 800, 800)
    ✓ BottomRight (view_id=17): shape (37, 800, 800)
    ✓ LeftTop (view_id=18): shape (37, 800, 800)
    ✓ RightTop (view_id=19): shape (37, 800, 800)
  ✓ Predictions from all 20 views aggregated
    P stats: min=0.0000, max=1.0000, mean=0.0248
    Non-zero vertices: 118823/129540
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 10717  1248  1145  3808     0  2012  1106  4504  5231]
  Ground Truth Stats:
    Labels shape: (129540,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-10/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7994
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8580
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8584

  RESULTS:
  RAW:         median(top-10)=0.9281, mean(top-10)=0.9265, median(all)=0.8570, mean(all)=0.7994
  + SMOOTHING: median(top-10)=0.9479, mean(top-10)=0.9449, median(all)=0.9128, mean(all)=0.8580 [+0.0198]
  + MRF:       median(top-10)=0.9482, mean(top-10)=0.9451, median(all)=0.9132, mean(all)=0.8584 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0201

================================================================================
Subject: OASIS-TRT-20-11
================================================================================
  Step 0: Generating predictions with V2 model...
  Mesh: 146531 vertices, 293058 faces
  Rendering and predicting ALL 20 views...
    ✓ Front (view_id=0): shape (37, 800, 800)
    ✓ Back (view_id=1): shape (37, 800, 800)
    ✓ Left (view_id=2): shape (37, 800, 800)
    ✓ Right (view_id=3): shape (37, 800, 800)
    ✓ Top (view_id=4): shape (37, 800, 800)
    ✓ Bottom (view_id=5): shape (37, 800, 800)
    ✓ FrontLeft (view_id=6): shape (37, 800, 800)
    ✓ FrontRight (view_id=7): shape (37, 800, 800)
    ✓ BackLeft (view_id=8): shape (37, 800, 800)
    ✓ BackRight (view_id=9): shape (37, 800, 800)
    ✓ TopFront (view_id=10): shape (37, 800, 800)
    ✓ TopBack (view_id=11): shape (37, 800, 800)
    ✓ TopLeft (view_id=12): shape (37, 800, 800)
    ✓ TopRight (view_id=13): shape (37, 800, 800)
    ✓ BottomFront (view_id=14): shape (37, 800, 800)
    ✓ BottomBack (view_id=15): shape (37, 800, 800)
    ✓ BottomLeft (view_id=16): shape (37, 800, 800)
    ✓ BottomRight (view_id=17): shape (37, 800, 800)
    ✓ LeftTop (view_id=18): shape (37, 800, 800)
    ✓ RightTop (view_id=19): shape (37, 800, 800)
  ✓ Predictions from all 20 views aggregated
    P stats: min=0.0000, max=1.0000, mean=0.0244
    Non-zero vertices: 132515/146531
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 14016  1276  1263  4006     0  2566  1167  5014  7273]
  Ground Truth Stats:
    Labels shape: (146531,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-11/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7946
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8615
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8615

  RESULTS:
  RAW:         median(top-10)=0.9142, mean(top-10)=0.9194, median(all)=0.8517, mean(all)=0.7946
  + SMOOTHING: median(top-10)=0.9413, mean(top-10)=0.9420, median(all)=0.9075, mean(all)=0.8615 [+0.0271]
  + MRF:       median(top-10)=0.9415, mean(top-10)=0.9418, median(all)=0.9074, mean(all)=0.8615 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0272

================================================================================
Subject: OASIS-TRT-20-12
================================================================================
  Step 0: Generating predictions with V2 model...
  Mesh: 144559 vertices, 289114 faces
  Rendering and predicting ALL 20 views...
    ✓ Front (view_id=0): shape (37, 800, 800)
    ✓ Back (view_id=1): shape (37, 800, 800)
    ✓ Left (view_id=2): shape (37, 800, 800)
    ✓ Right (view_id=3): shape (37, 800, 800)
    ✓ Top (view_id=4): shape (37, 800, 800)
    ✓ Bottom (view_id=5): shape (37, 800, 800)
    ✓ FrontLeft (view_id=6): shape (37, 800, 800)
    ✓ FrontRight (view_id=7): shape (37, 800, 800)
    ✓ BackLeft (view_id=8): shape (37, 800, 800)
    ✓ BackRight (view_id=9): shape (37, 800, 800)
    ✓ TopFront (view_id=10): shape (37, 800, 800)
    ✓ TopBack (view_id=11): shape (37, 800, 800)
    ✓ TopLeft (view_id=12): shape (37, 800, 800)
    ✓ TopRight (view_id=13): shape (37, 800, 800)
    ✓ BottomFront (view_id=14): shape (37, 800, 800)
    ✓ BottomBack (view_id=15): shape (37, 800, 800)
    ✓ BottomLeft (view_id=16): shape (37, 800, 800)
    ✓ BottomRight (view_id=17): shape (37, 800, 800)
    ✓ LeftTop (view_id=18): shape (37, 800, 800)
    ✓ RightTop (view_id=19): shape (37, 800, 800)
  ✓ Predictions from all 20 views aggregated
    P stats: min=0.0000, max=1.0000, mean=0.0248
    Non-zero vertices: 132713/144559
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 11846  1256  1229  3342     0  2008  1273  5421  5125]
  Ground Truth Stats:
    Labels shape: (144559,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-12/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7956
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8538
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8536

  RESULTS:
  RAW:         median(top-10)=0.9069, mean(top-10)=0.9129, median(all)=0.8449, mean(all)=0.7956
  + SMOOTHING: median(top-10)=0.9347, mean(top-10)=0.9361, median(all)=0.8949, mean(all)=0.8538 [+0.0278]
  + MRF:       median(top-10)=0.9347, mean(top-10)=0.9360, median(all)=0.8947, mean(all)=0.8536 [-0.0000]
  TOTAL IMPROVEMENT (median top-10): +0.0278

================================================================================
Subject: OASIS-TRT-20-13
================================================================================
  Step 0: Generating predictions with V2 model...
  Mesh: 122339 vertices, 244674 faces
  Rendering and predicting ALL 20 views...
    ✓ Front (view_id=0): shape (37, 800, 800)
    ✓ Back (view_id=1): shape (37, 800, 800)
    ✓ Left (view_id=2): shape (37, 800, 800)
    ✓ Right (view_id=3): shape (37, 800, 800)
    ✓ Top (view_id=4): shape (37, 800, 800)
    ✓ Bottom (view_id=5): shape (37, 800, 800)
    ✓ FrontLeft (view_id=6): shape (37, 800, 800)
    ✓ FrontRight (view_id=7): shape (37, 800, 800)
    ✓ BackLeft (view_id=8): shape (37, 800, 800)
    ✓ BackRight (view_id=9): shape (37, 800, 800)
    ✓ TopFront (view_id=10): shape (37, 800, 800)
    ✓ TopBack (view_id=11): shape (37, 800, 800)
    ✓ TopLeft (view_id=12): shape (37, 800, 800)
    ✓ TopRight (view_id=13): shape (37, 800, 800)
    ✓ BottomFront (view_id=14): shape (37, 800, 800)
    ✓ BottomBack (view_id=15): shape (37, 800, 800)
    ✓ BottomLeft (view_id=16): shape (37, 800, 800)
    ✓ BottomRight (view_id=17): shape (37, 800, 800)
    ✓ LeftTop (view_id=18): shape (37, 800, 800)
    ✓ RightTop (view_id=19): shape (37, 800, 800)
  ✓ Predictions from all 20 views aggregated
    P stats: min=0.0000, max=1.0000, mean=0.0249
    Non-zero vertices: 112672/122339
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 9667 1206 1209 3218    0 1866 1224 4024 6126]
  Ground Truth Stats:
    Labels shape: (122339,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-13/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.8078
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8680
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8683

  RESULTS:
  RAW:         median(top-10)=0.9159, mean(top-10)=0.9184, median(all)=0.8524, mean(all)=0.8078
  + SMOOTHING: median(top-10)=0.9470, mean(top-10)=0.9447, median(all)=0.9093, mean(all)=0.8680 [+0.0311]
  + MRF:       median(top-10)=0.9467, mean(top-10)=0.9448, median(all)=0.9096, mean(all)=0.8683 [-0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0308

================================================================================
Subject: OASIS-TRT-20-14
================================================================================
  Step 0: Generating predictions with V2 model...
  Mesh: 128019 vertices, 256034 faces
  Rendering and predicting ALL 20 views...
    ✓ Front (view_id=0): shape (37, 800, 800)
    ✓ Back (view_id=1): shape (37, 800, 800)
    ✓ Left (view_id=2): shape (37, 800, 800)
    ✓ Right (view_id=3): shape (37, 800, 800)
    ✓ Top (view_id=4): shape (37, 800, 800)
    ✓ Bottom (view_id=5): shape (37, 800, 800)
    ✓ FrontLeft (view_id=6): shape (37, 800, 800)
    ✓ FrontRight (view_id=7): shape (37, 800, 800)
    ✓ BackLeft (view_id=8): shape (37, 800, 800)
    ✓ BackRight (view_id=9): shape (37, 800, 800)
    ✓ TopFront (view_id=10): shape (37, 800, 800)
    ✓ TopBack (view_id=11): shape (37, 800, 800)
    ✓ TopLeft (view_id=12): shape (37, 800, 800)
    ✓ TopRight (view_id=13): shape (37, 800, 800)
    ✓ BottomFront (view_id=14): shape (37, 800, 800)
    ✓ BottomBack (view_id=15): shape (37, 800, 800)
    ✓ BottomLeft (view_id=16): shape (37, 800, 800)
    ✓ BottomRight (view_id=17): shape (37, 800, 800)
    ✓ LeftTop (view_id=18): shape (37, 800, 800)
    ✓ RightTop (view_id=19): shape (37, 800, 800)
  ✓ Predictions from all 20 views aggregated
    P stats: min=0.0000, max=1.0000, mean=0.0254
    Non-zero vertices: 120103/128019
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 7916 1304 1278 3338    0 1948 1342 4158 5775]
  Ground Truth Stats:
    Labels shape: (128019,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-14/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.8090
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8597
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8599

  RESULTS:
  RAW:         median(top-10)=0.9264, mean(top-10)=0.9243, median(all)=0.8833, mean(all)=0.8090
  + SMOOTHING: median(top-10)=0.9370, mean(top-10)=0.9420, median(all)=0.8968, mean(all)=0.8597 [+0.0105]
  + MRF:       median(top-10)=0.9371, mean(top-10)=0.9420, median(all)=0.8966, mean(all)=0.8599 [+0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0106

================================================================================
Subject: OASIS-TRT-20-15
================================================================================
  Step 0: Generating predictions with V2 model...
  Mesh: 121081 vertices, 242158 faces
  Rendering and predicting ALL 20 views...
    ✓ Front (view_id=0): shape (37, 800, 800)
    ✓ Back (view_id=1): shape (37, 800, 800)
    ✓ Left (view_id=2): shape (37, 800, 800)
    ✓ Right (view_id=3): shape (37, 800, 800)
    ✓ Top (view_id=4): shape (37, 800, 800)
    ✓ Bottom (view_id=5): shape (37, 800, 800)
    ✓ FrontLeft (view_id=6): shape (37, 800, 800)
    ✓ FrontRight (view_id=7): shape (37, 800, 800)
    ✓ BackLeft (view_id=8): shape (37, 800, 800)
    ✓ BackRight (view_id=9): shape (37, 800, 800)
    ✓ TopFront (view_id=10): shape (37, 800, 800)
    ✓ TopBack (view_id=11): shape (37, 800, 800)
    ✓ TopLeft (view_id=12): shape (37, 800, 800)
    ✓ TopRight (view_id=13): shape (37, 800, 800)
    ✓ BottomFront (view_id=14): shape (37, 800, 800)
    ✓ BottomBack (view_id=15): shape (37, 800, 800)
    ✓ BottomLeft (view_id=16): shape (37, 800, 800)
    ✓ BottomRight (view_id=17): shape (37, 800, 800)
    ✓ LeftTop (view_id=18): shape (37, 800, 800)
    ✓ RightTop (view_id=19): shape (37, 800, 800)
  ✓ Predictions from all 20 views aggregated
    P stats: min=0.0000, max=1.0000, mean=0.0251
    Non-zero vertices: 112433/121081
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 8648 1185  974 2629    0 1354 1028 4157 4715]
  Ground Truth Stats:
    Labels shape: (121081,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-15/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7957
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8544
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8545

  RESULTS:
  RAW:         median(top-10)=0.9062, mean(top-10)=0.9088, median(all)=0.8464, mean(all)=0.7957
  + SMOOTHING: median(top-10)=0.9319, mean(top-10)=0.9351, median(all)=0.8968, mean(all)=0.8544 [+0.0257]
  + MRF:       median(top-10)=0.9321, mean(top-10)=0.9354, median(all)=0.8971, mean(all)=0.8545 [+0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0258

================================================================================
Subject: OASIS-TRT-20-16
================================================================================
  Step 0: Generating predictions with V2 model...
  Mesh: 137726 vertices, 275448 faces
  Rendering and predicting ALL 20 views...
    ✓ Front (view_id=0): shape (37, 800, 800)
    ✓ Back (view_id=1): shape (37, 800, 800)
    ✓ Left (view_id=2): shape (37, 800, 800)
    ✓ Right (view_id=3): shape (37, 800, 800)
    ✓ Top (view_id=4): shape (37, 800, 800)
    ✓ Bottom (view_id=5): shape (37, 800, 800)
    ✓ FrontLeft (view_id=6): shape (37, 800, 800)
    ✓ FrontRight (view_id=7): shape (37, 800, 800)
    ✓ BackLeft (view_id=8): shape (37, 800, 800)
    ✓ BackRight (view_id=9): shape (37, 800, 800)
    ✓ TopFront (view_id=10): shape (37, 800, 800)
    ✓ TopBack (view_id=11): shape (37, 800, 800)
    ✓ TopLeft (view_id=12): shape (37, 800, 800)
    ✓ TopRight (view_id=13): shape (37, 800, 800)
    ✓ BottomFront (view_id=14): shape (37, 800, 800)
    ✓ BottomBack (view_id=15): shape (37, 800, 800)
    ✓ BottomLeft (view_id=16): shape (37, 800, 800)
    ✓ BottomRight (view_id=17): shape (37, 800, 800)
    ✓ LeftTop (view_id=18): shape (37, 800, 800)
    ✓ RightTop (view_id=19): shape (37, 800, 800)
  ✓ Predictions from all 20 views aggregated
    P stats: min=0.0000, max=1.0000, mean=0.0251
    Non-zero vertices: 127912/137726
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 9814 1568  987 3668    0 1791 1167 5200 6988]
  Ground Truth Stats:
    Labels shape: (137726,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-16/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7939
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8533
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8534

  RESULTS:
  RAW:         median(top-10)=0.9094, mean(top-10)=0.9125, median(all)=0.8714, mean(all)=0.7939
  + SMOOTHING: median(top-10)=0.9451, mean(top-10)=0.9413, median(all)=0.8947, mean(all)=0.8533 [+0.0357]
  + MRF:       median(top-10)=0.9454, mean(top-10)=0.9415, median(all)=0.8947, mean(all)=0.8534 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0361

================================================================================
Subject: OASIS-TRT-20-17
================================================================================
  Step 0: Generating predictions with V2 model...
  Mesh: 148245 vertices, 296486 faces
  Rendering and predicting ALL 20 views...
    ✓ Front (view_id=0): shape (37, 800, 800)
    ✓ Back (view_id=1): shape (37, 800, 800)
    ✓ Left (view_id=2): shape (37, 800, 800)
    ✓ Right (view_id=3): shape (37, 800, 800)
    ✓ Top (view_id=4): shape (37, 800, 800)
    ✓ Bottom (view_id=5): shape (37, 800, 800)
    ✓ FrontLeft (view_id=6): shape (37, 800, 800)
    ✓ FrontRight (view_id=7): shape (37, 800, 800)
    ✓ BackLeft (view_id=8): shape (37, 800, 800)
    ✓ BackRight (view_id=9): shape (37, 800, 800)
    ✓ TopFront (view_id=10): shape (37, 800, 800)
    ✓ TopBack (view_id=11): shape (37, 800, 800)
    ✓ TopLeft (view_id=12): shape (37, 800, 800)
    ✓ TopRight (view_id=13): shape (37, 800, 800)
    ✓ BottomFront (view_id=14): shape (37, 800, 800)
    ✓ BottomBack (view_id=15): shape (37, 800, 800)
    ✓ BottomLeft (view_id=16): shape (37, 800, 800)
    ✓ BottomRight (view_id=17): shape (37, 800, 800)
    ✓ LeftTop (view_id=18): shape (37, 800, 800)
    ✓ RightTop (view_id=19): shape (37, 800, 800)
  ✓ Predictions from all 20 views aggregated
    P stats: min=0.0000, max=1.0000, mean=0.0250
    Non-zero vertices: 136866/148245
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 11379  1276  1112  4349     0  2038  1194  4892  6094]
  Ground Truth Stats:
    Labels shape: (148245,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-17/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7971
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8572
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8574

  RESULTS:
  RAW:         median(top-10)=0.9128, mean(top-10)=0.9104, median(all)=0.8477, mean(all)=0.7971
  + SMOOTHING: median(top-10)=0.9381, mean(top-10)=0.9405, median(all)=0.8920, mean(all)=0.8572 [+0.0253]
  + MRF:       median(top-10)=0.9385, mean(top-10)=0.9409, median(all)=0.8922, mean(all)=0.8574 [+0.0004]
  TOTAL IMPROVEMENT (median top-10): +0.0257

================================================================================
Subject: OASIS-TRT-20-18
================================================================================
  Step 0: Generating predictions with V2 model...
  Mesh: 140676 vertices, 281348 faces
  Rendering and predicting ALL 20 views...
    ✓ Front (view_id=0): shape (37, 800, 800)
    ✓ Back (view_id=1): shape (37, 800, 800)
    ✓ Left (view_id=2): shape (37, 800, 800)
    ✓ Right (view_id=3): shape (37, 800, 800)
    ✓ Top (view_id=4): shape (37, 800, 800)
    ✓ Bottom (view_id=5): shape (37, 800, 800)
    ✓ FrontLeft (view_id=6): shape (37, 800, 800)
    ✓ FrontRight (view_id=7): shape (37, 800, 800)
    ✓ BackLeft (view_id=8): shape (37, 800, 800)
    ✓ BackRight (view_id=9): shape (37, 800, 800)
    ✓ TopFront (view_id=10): shape (37, 800, 800)
    ✓ TopBack (view_id=11): shape (37, 800, 800)
    ✓ TopLeft (view_id=12): shape (37, 800, 800)
    ✓ TopRight (view_id=13): shape (37, 800, 800)
    ✓ BottomFront (view_id=14): shape (37, 800, 800)
    ✓ BottomBack (view_id=15): shape (37, 800, 800)
    ✓ BottomLeft (view_id=16): shape (37, 800, 800)
    ✓ BottomRight (view_id=17): shape (37, 800, 800)
    ✓ LeftTop (view_id=18): shape (37, 800, 800)
    ✓ RightTop (view_id=19): shape (37, 800, 800)
  ✓ Predictions from all 20 views aggregated
    P stats: min=0.0000, max=1.0000, mean=0.0251
    Non-zero vertices: 130409/140676
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 10267  1563  1250  3150     0  2199  1154  4595  6597]
  Ground Truth Stats:
    Labels shape: (140676,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-18/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.8000
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8568
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8568

  RESULTS:
  RAW:         median(top-10)=0.9100, mean(top-10)=0.9109, median(all)=0.8625, mean(all)=0.8000
  + SMOOTHING: median(top-10)=0.9386, mean(top-10)=0.9404, median(all)=0.8977, mean(all)=0.8568 [+0.0285]
  + MRF:       median(top-10)=0.9387, mean(top-10)=0.9405, median(all)=0.8979, mean(all)=0.8568 [+0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0287

================================================================================
Subject: OASIS-TRT-20-19
================================================================================
  Step 0: Generating predictions with V2 model...
  Mesh: 114731 vertices, 229458 faces
  Rendering and predicting ALL 20 views...
    ✓ Front (view_id=0): shape (37, 800, 800)
    ✓ Back (view_id=1): shape (37, 800, 800)
    ✓ Left (view_id=2): shape (37, 800, 800)
    ✓ Right (view_id=3): shape (37, 800, 800)
    ✓ Top (view_id=4): shape (37, 800, 800)
    ✓ Bottom (view_id=5): shape (37, 800, 800)
    ✓ FrontLeft (view_id=6): shape (37, 800, 800)
    ✓ FrontRight (view_id=7): shape (37, 800, 800)
    ✓ BackLeft (view_id=8): shape (37, 800, 800)
    ✓ BackRight (view_id=9): shape (37, 800, 800)
    ✓ TopFront (view_id=10): shape (37, 800, 800)
    ✓ TopBack (view_id=11): shape (37, 800, 800)
    ✓ TopLeft (view_id=12): shape (37, 800, 800)
    ✓ TopRight (view_id=13): shape (37, 800, 800)
    ✓ BottomFront (view_id=14): shape (37, 800, 800)
    ✓ BottomBack (view_id=15): shape (37, 800, 800)
    ✓ BottomLeft (view_id=16): shape (37, 800, 800)
    ✓ BottomRight (view_id=17): shape (37, 800, 800)
    ✓ LeftTop (view_id=18): shape (37, 800, 800)
    ✓ RightTop (view_id=19): shape (37, 800, 800)
  ✓ Predictions from all 20 views aggregated
    P stats: min=0.0000, max=1.0000, mean=0.0251
    Non-zero vertices: 106427/114731
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 8304 1327 1033 2552    0 1643 1059 3600 6719]
  Ground Truth Stats:
    Labels shape: (114731,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-19/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7815
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8422
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8422

  RESULTS:
  RAW:         median(top-10)=0.9195, mean(top-10)=0.9242, median(all)=0.8342, mean(all)=0.7815
  + SMOOTHING: median(top-10)=0.9472, mean(top-10)=0.9474, median(all)=0.8768, mean(all)=0.8422 [+0.0277]
  + MRF:       median(top-10)=0.9470, mean(top-10)=0.9475, median(all)=0.8768, mean(all)=0.8422 [-0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0275

================================================================================
Subject: OASIS-TRT-20-2
================================================================================
  Step 0: Generating predictions with V2 model...
  Mesh: 153483 vertices, 306962 faces
  Rendering and predicting ALL 20 views...
    ✓ Front (view_id=0): shape (37, 800, 800)
    ✓ Back (view_id=1): shape (37, 800, 800)
    ✓ Left (view_id=2): shape (37, 800, 800)
    ✓ Right (view_id=3): shape (37, 800, 800)
    ✓ Top (view_id=4): shape (37, 800, 800)
    ✓ Bottom (view_id=5): shape (37, 800, 800)
    ✓ FrontLeft (view_id=6): shape (37, 800, 800)
    ✓ FrontRight (view_id=7): shape (37, 800, 800)
    ✓ BackLeft (view_id=8): shape (37, 800, 800)
    ✓ BackRight (view_id=9): shape (37, 800, 800)
    ✓ TopFront (view_id=10): shape (37, 800, 800)
    ✓ TopBack (view_id=11): shape (37, 800, 800)
    ✓ TopLeft (view_id=12): shape (37, 800, 800)
    ✓ TopRight (view_id=13): shape (37, 800, 800)
    ✓ BottomFront (view_id=14): shape (37, 800, 800)
    ✓ BottomBack (view_id=15): shape (37, 800, 800)
    ✓ BottomLeft (view_id=16): shape (37, 800, 800)
    ✓ BottomRight (view_id=17): shape (37, 800, 800)
    ✓ LeftTop (view_id=18): shape (37, 800, 800)
    ✓ RightTop (view_id=19): shape (37, 800, 800)
  ✓ Predictions from all 20 views aggregated
    P stats: min=0.0000, max=1.0000, mean=0.0248
    Non-zero vertices: 140706/153483
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 12777  1471  1510  3739     0  2522  1139  5685  7265]
  Ground Truth Stats:
    Labels shape: (153483,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-2/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.8067
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8715
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8717

  RESULTS:
  RAW:         median(top-10)=0.9208, mean(top-10)=0.9264, median(all)=0.8794, mean(all)=0.8067
  + SMOOTHING: median(top-10)=0.9532, mean(top-10)=0.9524, median(all)=0.9140, mean(all)=0.8715 [+0.0324]
  + MRF:       median(top-10)=0.9533, mean(top-10)=0.9525, median(all)=0.9144, mean(all)=0.8717 [+0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0325

================================================================================
Subject: OASIS-TRT-20-20
================================================================================
  Step 0: Generating predictions with V2 model...
  Mesh: 124947 vertices, 249890 faces
  Rendering and predicting ALL 20 views...
    ✓ Front (view_id=0): shape (37, 800, 800)
    ✓ Back (view_id=1): shape (37, 800, 800)
    ✓ Left (view_id=2): shape (37, 800, 800)
    ✓ Right (view_id=3): shape (37, 800, 800)
    ✓ Top (view_id=4): shape (37, 800, 800)
    ✓ Bottom (view_id=5): shape (37, 800, 800)
    ✓ FrontLeft (view_id=6): shape (37, 800, 800)
    ✓ FrontRight (view_id=7): shape (37, 800, 800)
    ✓ BackLeft (view_id=8): shape (37, 800, 800)
    ✓ BackRight (view_id=9): shape (37, 800, 800)
    ✓ TopFront (view_id=10): shape (37, 800, 800)
    ✓ TopBack (view_id=11): shape (37, 800, 800)
    ✓ TopLeft (view_id=12): shape (37, 800, 800)
    ✓ TopRight (view_id=13): shape (37, 800, 800)
    ✓ BottomFront (view_id=14): shape (37, 800, 800)
    ✓ BottomBack (view_id=15): shape (37, 800, 800)
    ✓ BottomLeft (view_id=16): shape (37, 800, 800)
    ✓ BottomRight (view_id=17): shape (37, 800, 800)
    ✓ LeftTop (view_id=18): shape (37, 800, 800)
    ✓ RightTop (view_id=19): shape (37, 800, 800)
  ✓ Predictions from all 20 views aggregated
    P stats: min=0.0000, max=1.0000, mean=0.0250
    Non-zero vertices: 115560/124947
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 9387 1138  983 2606    0 1720 1097 4086 6140]
  Ground Truth Stats:
    Labels shape: (124947,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-20/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7962
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8583
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8586

  RESULTS:
  RAW:         median(top-10)=0.9158, mean(top-10)=0.9140, median(all)=0.8703, mean(all)=0.7962
  + SMOOTHING: median(top-10)=0.9428, mean(top-10)=0.9452, median(all)=0.9092, mean(all)=0.8583 [+0.0271]
  + MRF:       median(top-10)=0.9432, mean(top-10)=0.9453, median(all)=0.9093, mean(all)=0.8586 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0274

================================================================================
Subject: OASIS-TRT-20-3
================================================================================
  Step 0: Generating predictions with V2 model...
  Mesh: 134843 vertices, 269682 faces
  Rendering and predicting ALL 20 views...
    ✓ Front (view_id=0): shape (37, 800, 800)
    ✓ Back (view_id=1): shape (37, 800, 800)
    ✓ Left (view_id=2): shape (37, 800, 800)
    ✓ Right (view_id=3): shape (37, 800, 800)
    ✓ Top (view_id=4): shape (37, 800, 800)
    ✓ Bottom (view_id=5): shape (37, 800, 800)
    ✓ FrontLeft (view_id=6): shape (37, 800, 800)
    ✓ FrontRight (view_id=7): shape (37, 800, 800)
    ✓ BackLeft (view_id=8): shape (37, 800, 800)
    ✓ BackRight (view_id=9): shape (37, 800, 800)
    ✓ TopFront (view_id=10): shape (37, 800, 800)
    ✓ TopBack (view_id=11): shape (37, 800, 800)
    ✓ TopLeft (view_id=12): shape (37, 800, 800)
    ✓ TopRight (view_id=13): shape (37, 800, 800)
    ✓ BottomFront (view_id=14): shape (37, 800, 800)
    ✓ BottomBack (view_id=15): shape (37, 800, 800)
    ✓ BottomLeft (view_id=16): shape (37, 800, 800)
    ✓ BottomRight (view_id=17): shape (37, 800, 800)
    ✓ LeftTop (view_id=18): shape (37, 800, 800)
    ✓ RightTop (view_id=19): shape (37, 800, 800)
  ✓ Predictions from all 20 views aggregated
    P stats: min=0.0000, max=1.0000, mean=0.0252
    Non-zero vertices: 125878/134843
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 8965 1697 1022 3516    0 2177 1168 4574 6171]
  Ground Truth Stats:
    Labels shape: (134843,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-3/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.8027
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8613
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8613

  RESULTS:
  RAW:         median(top-10)=0.9229, mean(top-10)=0.9251, median(all)=0.8789, mean(all)=0.8027
  + SMOOTHING: median(top-10)=0.9426, mean(top-10)=0.9457, median(all)=0.9075, mean(all)=0.8613 [+0.0197]
  + MRF:       median(top-10)=0.9429, mean(top-10)=0.9459, median(all)=0.9085, mean(all)=0.8613 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0200

================================================================================
Subject: OASIS-TRT-20-4
================================================================================
  Step 0: Generating predictions with V2 model...
  Mesh: 138101 vertices, 276198 faces
  Rendering and predicting ALL 20 views...
    ✓ Front (view_id=0): shape (37, 800, 800)
    ✓ Back (view_id=1): shape (37, 800, 800)
    ✓ Left (view_id=2): shape (37, 800, 800)
    ✓ Right (view_id=3): shape (37, 800, 800)
    ✓ Top (view_id=4): shape (37, 800, 800)
    ✓ Bottom (view_id=5): shape (37, 800, 800)
    ✓ FrontLeft (view_id=6): shape (37, 800, 800)
    ✓ FrontRight (view_id=7): shape (37, 800, 800)
    ✓ BackLeft (view_id=8): shape (37, 800, 800)
    ✓ BackRight (view_id=9): shape (37, 800, 800)
    ✓ TopFront (view_id=10): shape (37, 800, 800)
    ✓ TopBack (view_id=11): shape (37, 800, 800)
    ✓ TopLeft (view_id=12): shape (37, 800, 800)
    ✓ TopRight (view_id=13): shape (37, 800, 800)
    ✓ BottomFront (view_id=14): shape (37, 800, 800)
    ✓ BottomBack (view_id=15): shape (37, 800, 800)
    ✓ BottomLeft (view_id=16): shape (37, 800, 800)
    ✓ BottomRight (view_id=17): shape (37, 800, 800)
    ✓ LeftTop (view_id=18): shape (37, 800, 800)
    ✓ RightTop (view_id=19): shape (37, 800, 800)
  ✓ Predictions from all 20 views aggregated
    P stats: min=0.0000, max=1.0000, mean=0.0249
    Non-zero vertices: 127160/138101
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 10941  1099   956  3212     0  1942  1189  4166  6862]
  Ground Truth Stats:
    Labels shape: (138101,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-4/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7956
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8599
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8599

  RESULTS:
  RAW:         median(top-10)=0.9232, mean(top-10)=0.9272, median(all)=0.8728, mean(all)=0.7956
  + SMOOTHING: median(top-10)=0.9516, mean(top-10)=0.9541, median(all)=0.9229, mean(all)=0.8599 [+0.0284]
  + MRF:       median(top-10)=0.9515, mean(top-10)=0.9542, median(all)=0.9234, mean(all)=0.8599 [-0.0000]
  TOTAL IMPROVEMENT (median top-10): +0.0284

================================================================================
Subject: OASIS-TRT-20-5
================================================================================
  Step 0: Generating predictions with V2 model...
  Mesh: 151342 vertices, 302680 faces
  Rendering and predicting ALL 20 views...
    ✓ Front (view_id=0): shape (37, 800, 800)
    ✓ Back (view_id=1): shape (37, 800, 800)
    ✓ Left (view_id=2): shape (37, 800, 800)
    ✓ Right (view_id=3): shape (37, 800, 800)
    ✓ Top (view_id=4): shape (37, 800, 800)
    ✓ Bottom (view_id=5): shape (37, 800, 800)
    ✓ FrontLeft (view_id=6): shape (37, 800, 800)
    ✓ FrontRight (view_id=7): shape (37, 800, 800)
    ✓ BackLeft (view_id=8): shape (37, 800, 800)
    ✓ BackRight (view_id=9): shape (37, 800, 800)
    ✓ TopFront (view_id=10): shape (37, 800, 800)
    ✓ TopBack (view_id=11): shape (37, 800, 800)
    ✓ TopLeft (view_id=12): shape (37, 800, 800)
    ✓ TopRight (view_id=13): shape (37, 800, 800)
    ✓ BottomFront (view_id=14): shape (37, 800, 800)
    ✓ BottomBack (view_id=15): shape (37, 800, 800)
    ✓ BottomLeft (view_id=16): shape (37, 800, 800)
    ✓ BottomRight (view_id=17): shape (37, 800, 800)
    ✓ LeftTop (view_id=18): shape (37, 800, 800)
    ✓ RightTop (view_id=19): shape (37, 800, 800)
  ✓ Predictions from all 20 views aggregated
    P stats: min=0.0000, max=1.0000, mean=0.0249
    Non-zero vertices: 139542/151342
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 11800  1256  1185  3345     0  2465  1184  6310  6565]
  Ground Truth Stats:
    Labels shape: (151342,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-5/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.8048
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8554
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8554

  RESULTS:
  RAW:         median(top-10)=0.9134, mean(top-10)=0.9133, median(all)=0.8798, mean(all)=0.8048
  + SMOOTHING: median(top-10)=0.9360, mean(top-10)=0.9383, median(all)=0.8945, mean(all)=0.8554 [+0.0226]
  + MRF:       median(top-10)=0.9360, mean(top-10)=0.9384, median(all)=0.8950, mean(all)=0.8554 [+0.0000]
  TOTAL IMPROVEMENT (median top-10): +0.0226

================================================================================
Subject: OASIS-TRT-20-6
================================================================================
  Step 0: Generating predictions with V2 model...
  Mesh: 152023 vertices, 304042 faces
  Rendering and predicting ALL 20 views...
    ✓ Front (view_id=0): shape (37, 800, 800)
    ✓ Back (view_id=1): shape (37, 800, 800)
    ✓ Left (view_id=2): shape (37, 800, 800)
    ✓ Right (view_id=3): shape (37, 800, 800)
    ✓ Top (view_id=4): shape (37, 800, 800)
    ✓ Bottom (view_id=5): shape (37, 800, 800)
    ✓ FrontLeft (view_id=6): shape (37, 800, 800)
    ✓ FrontRight (view_id=7): shape (37, 800, 800)
    ✓ BackLeft (view_id=8): shape (37, 800, 800)
    ✓ BackRight (view_id=9): shape (37, 800, 800)
    ✓ TopFront (view_id=10): shape (37, 800, 800)
    ✓ TopBack (view_id=11): shape (37, 800, 800)
    ✓ TopLeft (view_id=12): shape (37, 800, 800)
    ✓ TopRight (view_id=13): shape (37, 800, 800)
    ✓ BottomFront (view_id=14): shape (37, 800, 800)
    ✓ BottomBack (view_id=15): shape (37, 800, 800)
    ✓ BottomLeft (view_id=16): shape (37, 800, 800)
    ✓ BottomRight (view_id=17): shape (37, 800, 800)
    ✓ LeftTop (view_id=18): shape (37, 800, 800)
    ✓ RightTop (view_id=19): shape (37, 800, 800)
  ✓ Predictions from all 20 views aggregated
    P stats: min=0.0000, max=1.0000, mean=0.0251
    Non-zero vertices: 141192/152023
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 10831  1460  1530  4793     0  2163  1355  4934  6157]
  Ground Truth Stats:
    Labels shape: (152023,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-6/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.8117
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8709
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8711

  RESULTS:
  RAW:         median(top-10)=0.9217, mean(top-10)=0.9222, median(all)=0.8765, mean(all)=0.8117
  + SMOOTHING: median(top-10)=0.9458, mean(top-10)=0.9452, median(all)=0.9067, mean(all)=0.8709 [+0.0241]
  + MRF:       median(top-10)=0.9463, mean(top-10)=0.9455, median(all)=0.9073, mean(all)=0.8711 [+0.0005]
  TOTAL IMPROVEMENT (median top-10): +0.0246

================================================================================
Subject: OASIS-TRT-20-7
================================================================================
  Step 0: Generating predictions with V2 model...
  Mesh: 142612 vertices, 285220 faces
  Rendering and predicting ALL 20 views...
    ✓ Front (view_id=0): shape (37, 800, 800)
    ✓ Back (view_id=1): shape (37, 800, 800)
    ✓ Left (view_id=2): shape (37, 800, 800)
    ✓ Right (view_id=3): shape (37, 800, 800)
    ✓ Top (view_id=4): shape (37, 800, 800)
    ✓ Bottom (view_id=5): shape (37, 800, 800)
    ✓ FrontLeft (view_id=6): shape (37, 800, 800)
    ✓ FrontRight (view_id=7): shape (37, 800, 800)
    ✓ BackLeft (view_id=8): shape (37, 800, 800)
    ✓ BackRight (view_id=9): shape (37, 800, 800)
    ✓ TopFront (view_id=10): shape (37, 800, 800)
    ✓ TopBack (view_id=11): shape (37, 800, 800)
    ✓ TopLeft (view_id=12): shape (37, 800, 800)
    ✓ TopRight (view_id=13): shape (37, 800, 800)
    ✓ BottomFront (view_id=14): shape (37, 800, 800)
    ✓ BottomBack (view_id=15): shape (37, 800, 800)
    ✓ BottomLeft (view_id=16): shape (37, 800, 800)
    ✓ BottomRight (view_id=17): shape (37, 800, 800)
    ✓ LeftTop (view_id=18): shape (37, 800, 800)
    ✓ RightTop (view_id=19): shape (37, 800, 800)
  ✓ Predictions from all 20 views aggregated
    P stats: min=0.0000, max=1.0000, mean=0.0253
    Non-zero vertices: 133605/142612
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 9007 1260 1001 3476    0 2230 1264 5397 7345]
  Ground Truth Stats:
    Labels shape: (142612,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-7/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.8026
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8525
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8527

  RESULTS:
  RAW:         median(top-10)=0.9181, mean(top-10)=0.9235, median(all)=0.8777, mean(all)=0.8026
  + SMOOTHING: median(top-10)=0.9472, mean(top-10)=0.9495, median(all)=0.9142, mean(all)=0.8525 [+0.0291]
  + MRF:       median(top-10)=0.9475, mean(top-10)=0.9497, median(all)=0.9143, mean(all)=0.8527 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0294

================================================================================
Subject: OASIS-TRT-20-8
================================================================================
  Step 0: Generating predictions with V2 model...
  Mesh: 139571 vertices, 279138 faces
  Rendering and predicting ALL 20 views...
    ✓ Front (view_id=0): shape (37, 800, 800)
    ✓ Back (view_id=1): shape (37, 800, 800)
    ✓ Left (view_id=2): shape (37, 800, 800)
    ✓ Right (view_id=3): shape (37, 800, 800)
    ✓ Top (view_id=4): shape (37, 800, 800)
    ✓ Bottom (view_id=5): shape (37, 800, 800)
    ✓ FrontLeft (view_id=6): shape (37, 800, 800)
    ✓ FrontRight (view_id=7): shape (37, 800, 800)
    ✓ BackLeft (view_id=8): shape (37, 800, 800)
    ✓ BackRight (view_id=9): shape (37, 800, 800)
    ✓ TopFront (view_id=10): shape (37, 800, 800)
    ✓ TopBack (view_id=11): shape (37, 800, 800)
    ✓ TopLeft (view_id=12): shape (37, 800, 800)
    ✓ TopRight (view_id=13): shape (37, 800, 800)
    ✓ BottomFront (view_id=14): shape (37, 800, 800)
    ✓ BottomBack (view_id=15): shape (37, 800, 800)
    ✓ BottomLeft (view_id=16): shape (37, 800, 800)
    ✓ BottomRight (view_id=17): shape (37, 800, 800)
    ✓ LeftTop (view_id=18): shape (37, 800, 800)
    ✓ RightTop (view_id=19): shape (37, 800, 800)
  ✓ Predictions from all 20 views aggregated
    P stats: min=0.0000, max=1.0000, mean=0.0248
    Non-zero vertices: 127963/139571
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 11608  1108  1256  3595     0  1952   942  5573  6101]
  Ground Truth Stats:
    Labels shape: (139571,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-8/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7991
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8648
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8650

  RESULTS:
  RAW:         median(top-10)=0.9103, mean(top-10)=0.9169, median(all)=0.8579, mean(all)=0.7991
  + SMOOTHING: median(top-10)=0.9402, mean(top-10)=0.9437, median(all)=0.9180, mean(all)=0.8648 [+0.0299]
  + MRF:       median(top-10)=0.9405, mean(top-10)=0.9441, median(all)=0.9178, mean(all)=0.8650 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0302

================================================================================
Subject: OASIS-TRT-20-9
================================================================================
  Step 0: Generating predictions with V2 model...
  Mesh: 134960 vertices, 269916 faces
  Rendering and predicting ALL 20 views...
    ✓ Front (view_id=0): shape (37, 800, 800)
    ✓ Back (view_id=1): shape (37, 800, 800)
    ✓ Left (view_id=2): shape (37, 800, 800)
    ✓ Right (view_id=3): shape (37, 800, 800)
    ✓ Top (view_id=4): shape (37, 800, 800)
    ✓ Bottom (view_id=5): shape (37, 800, 800)
    ✓ FrontLeft (view_id=6): shape (37, 800, 800)
    ✓ FrontRight (view_id=7): shape (37, 800, 800)
    ✓ BackLeft (view_id=8): shape (37, 800, 800)
    ✓ BackRight (view_id=9): shape (37, 800, 800)
    ✓ TopFront (view_id=10): shape (37, 800, 800)
    ✓ TopBack (view_id=11): shape (37, 800, 800)
    ✓ TopLeft (view_id=12): shape (37, 800, 800)
    ✓ TopRight (view_id=13): shape (37, 800, 800)
    ✓ BottomFront (view_id=14): shape (37, 800, 800)
    ✓ BottomBack (view_id=15): shape (37, 800, 800)
    ✓ BottomLeft (view_id=16): shape (37, 800, 800)
    ✓ BottomRight (view_id=17): shape (37, 800, 800)
    ✓ LeftTop (view_id=18): shape (37, 800, 800)
    ✓ RightTop (view_id=19): shape (37, 800, 800)
  ✓ Predictions from all 20 views aggregated
    P stats: min=0.0000, max=1.0000, mean=0.0250
    Non-zero vertices: 124660/134960
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 10300  1032  1147  3167     0  1769  1154  4743  5196]
  Ground Truth Stats:
    Labels shape: (134960,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-9/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.8060
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8665
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8664

  RESULTS:
  RAW:         median(top-10)=0.9185, mean(top-10)=0.9232, median(all)=0.8802, mean(all)=0.8060
  + SMOOTHING: median(top-10)=0.9510, mean(top-10)=0.9496, median(all)=0.9103, mean(all)=0.8665 [+0.0325]
  + MRF:       median(top-10)=0.9510, mean(top-10)=0.9496, median(all)=0.9104, mean(all)=0.8664 [-0.0000]
  TOTAL IMPROVEMENT (median top-10): +0.0325

================================================================================
Subject: Twins-2-1
================================================================================
  Step 0: Generating predictions with V2 model...
  Mesh: 145069 vertices, 290134 faces
  Rendering and predicting ALL 20 views...
    ✓ Front (view_id=0): shape (37, 800, 800)
    ✓ Back (view_id=1): shape (37, 800, 800)
    ✓ Left (view_id=2): shape (37, 800, 800)
    ✓ Right (view_id=3): shape (37, 800, 800)
    ✓ Top (view_id=4): shape (37, 800, 800)
    ✓ Bottom (view_id=5): shape (37, 800, 800)
    ✓ FrontLeft (view_id=6): shape (37, 800, 800)
    ✓ FrontRight (view_id=7): shape (37, 800, 800)
    ✓ BackLeft (view_id=8): shape (37, 800, 800)
    ✓ BackRight (view_id=9): shape (37, 800, 800)
    ✓ TopFront (view_id=10): shape (37, 800, 800)
    ✓ TopBack (view_id=11): shape (37, 800, 800)
    ✓ TopLeft (view_id=12): shape (37, 800, 800)
    ✓ TopRight (view_id=13): shape (37, 800, 800)
    ✓ BottomFront (view_id=14): shape (37, 800, 800)
    ✓ BottomBack (view_id=15): shape (37, 800, 800)
    ✓ BottomLeft (view_id=16): shape (37, 800, 800)
    ✓ BottomRight (view_id=17): shape (37, 800, 800)
    ✓ LeftTop (view_id=18): shape (37, 800, 800)
    ✓ RightTop (view_id=19): shape (37, 800, 800)
  ✓ Predictions from all 20 views aggregated
    P stats: min=0.0000, max=1.0000, mean=0.0249
    Non-zero vertices: 133697/145069
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 11372  1209  1161  3871     0  2127  1064  5095  6045]
  Ground Truth Stats:
    Labels shape: (145069,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/Twins-2-1/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7977
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8558
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8560

  RESULTS:
  RAW:         median(top-10)=0.9194, mean(top-10)=0.9188, median(all)=0.8752, mean(all)=0.7977
  + SMOOTHING: median(top-10)=0.9415, mean(top-10)=0.9406, median(all)=0.8981, mean(all)=0.8558 [+0.0221]
  + MRF:       median(top-10)=0.9418, mean(top-10)=0.9407, median(all)=0.8982, mean(all)=0.8560 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0224

================================================================================
Subject: Twins-2-2
================================================================================
  Step 0: Generating predictions with V2 model...
  Mesh: 149751 vertices, 299498 faces
  Rendering and predicting ALL 20 views...
    ✓ Front (view_id=0): shape (37, 800, 800)
    ✓ Back (view_id=1): shape (37, 800, 800)
    ✓ Left (view_id=2): shape (37, 800, 800)
    ✓ Right (view_id=3): shape (37, 800, 800)
    ✓ Top (view_id=4): shape (37, 800, 800)
    ✓ Bottom (view_id=5): shape (37, 800, 800)
    ✓ FrontLeft (view_id=6): shape (37, 800, 800)
    ✓ FrontRight (view_id=7): shape (37, 800, 800)
    ✓ BackLeft (view_id=8): shape (37, 800, 800)
    ✓ BackRight (view_id=9): shape (37, 800, 800)
    ✓ TopFront (view_id=10): shape (37, 800, 800)
    ✓ TopBack (view_id=11): shape (37, 800, 800)
    ✓ TopLeft (view_id=12): shape (37, 800, 800)
    ✓ TopRight (view_id=13): shape (37, 800, 800)
    ✓ BottomFront (view_id=14): shape (37, 800, 800)
    ✓ BottomBack (view_id=15): shape (37, 800, 800)
    ✓ BottomLeft (view_id=16): shape (37, 800, 800)
    ✓ BottomRight (view_id=17): shape (37, 800, 800)
    ✓ LeftTop (view_id=18): shape (37, 800, 800)
    ✓ RightTop (view_id=19): shape (37, 800, 800)
  ✓ Predictions from all 20 views aggregated
    P stats: min=0.0000, max=0.9999, mean=0.0250
    Non-zero vertices: 138758/149751
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 10993  1168  1370  4052     0  2628   947  5221  6532]
  Ground Truth Stats:
    Labels shape: (149751,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/Twins-2-2/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7916
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8517
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8520

  RESULTS:
  RAW:         median(top-10)=0.9236, mean(top-10)=0.9302, median(all)=0.8434, mean(all)=0.7916
  + SMOOTHING: median(top-10)=0.9472, mean(top-10)=0.9510, median(all)=0.8950, mean(all)=0.8517 [+0.0236]
  + MRF:       median(top-10)=0.9473, mean(top-10)=0.9511, median(all)=0.8957, mean(all)=0.8520 [+0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0237

================================================================================
AGGREGATE RESULTS ACROSS ALL TEST SUBJECTS
================================================================================
Number of subjects: 101

RAW PREDICTIONS:
  Median(top-10):  0.9156 ± 0.0084  (min: 0.8872, max: 0.9334)
  Mean(top-10):    0.9184 ± 0.0076  (min: 0.8940, max: 0.9336)
  Median(all):     0.8603 ± 0.0147  (min: 0.8013, max: 0.8917)
  Mean(all):       0.7951 ± 0.0132  (min: 0.7067, max: 0.8164)

+ SMOOTHING (α=0.75, 20 iter):
  Median(top-10):  0.9446 ± 0.0067  (min: 0.9217, max: 0.9594)
  Mean(top-10):    0.9450 ± 0.0058  (min: 0.9253, max: 0.9581)
  Median(all):     0.9021 ± 0.0124  (min: 0.8474, max: 0.9329)
  Mean(all):       0.8576 ± 0.0129  (min: 0.7585, max: 0.8757)
  Improvement:     median(top-10) +0.0290, mean(all) +0.0625

+ MRF (β=0.1, 5 iter):
  Median(top-10):  0.9447 ± 0.0067  (min: 0.9219, max: 0.9595)
  Mean(top-10):    0.9452 ± 0.0058  (min: 0.9256, max: 0.9583)
  Median(all):     0.9024 ± 0.0124  (min: 0.8476, max: 0.9329)
  Mean(all):       0.8577 ± 0.0129  (min: 0.7586, max: 0.8758)
  Improvement:     median(top-10) +0.0001, mean(all) +0.0001

TOTAL IMPROVEMENT (RAW → MRF):
  Median(top-10):  +0.0291
  Mean(top-10):    +0.0268
  Median(all):     +0.0420
  Mean(all):       +0.0626
================================================================================

============================================================================
Testing completed at Wed Feb  4 05:43:09 AM EST 2026
============================================================================
