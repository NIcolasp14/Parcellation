nohup: ignoring input
[GPU] PyTorch3D loaded - GPU raycasting AVAILABLE (will be enabled via --raycasting arg)
Using explicitly provided checkpoint path: /autofs/space/ballarat_004/users/np341/PRIR_Code/Training/White/Models_WM_SLURM_7625119_worked_5_days
================================================================================
Testing NEW pytorch3d models with FULL post-processing pipeline
Checkpoints: /autofs/space/ballarat_004/users/np341/PRIR_Code/Training/White/Models_WM_SLURM_7625119_worked_5_days
Test data: /autofs/space/ballarat_004/users/np341/mindboggle2
1. Generate predictions using NEW models
2. Iterative smoothing (Œ±=0.75, 20 iter)
3. MRF with ICM (Œ≤=0.1)
================================================================================


================================================================================
Subject: Afterthought-1
================================================================================
  Step 0: Generating predictions with NEW models...
  Using PyTorch3D GPU raycasting (matching training pipeline)...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 130921 vertices, 261838 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (52544 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (102793 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (94972 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (67847 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (47950 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (72380 valid pixels)
  [PyTorch3D] Raycasting complete!
  ‚úì Got 6 output maps, shape: (6, 800, 800, 3)
  Loading trained models...
Loading models...
  Loading Front: Front-epoch=499-validation_loss=0.03.ckpt
  Loading Bottom: Bottom-epoch=499-validation_loss=0.04.ckpt
  Loading Top: Top-epoch=499-validation_loss=0.05.ckpt
  Loading Right: Right-epoch=499-validation_loss=0.04.ckpt
  Loading Back: Back-epoch=499-validation_loss=0.03.ckpt
  Loading Left: Left-epoch=499-validation_loss=0.03.ckpt
Models loaded!
  Running U-Net predictions on 6 views...
Predicting labels...
Labels predicted!
  ‚úì Got predictions from 6 views
  Aggregating predictions to vertices...
Agregating predicted labels...

üîç View 0: 2D predictions for 52544 MESH pixels (before aggregation):
   Class 12: 15618 pixels (29.7%)
   Class 30: 11938 pixels (22.7%)
   Class 9: 8781 pixels (16.7%)
   Class 10: 3325 pixels (6.3%)
   Class 32: 3224 pixels (6.1%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0010
   ‚Üí Pixels where class 0 prob > 0.5: 0 (0.0%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9991
   ‚Üí Weights for vertex 0: mean=0.3345, max=0.9969
   ‚Üí Weights for vertex 1: mean=0.3336, max=0.9991
   ‚Üí Weights for vertex 2: mean=0.3322, max=0.9949
   ‚Üí Weights sum to 1? 1.0003

üîç View 1: 2D predictions for 102793 MESH pixels (before aggregation):
   Class 0: 21813 pixels (21.2%)
   Class 29: 19003 pixels (18.5%)
   Class 26: 11574 pixels (11.3%)
   Class 15: 6933 pixels (6.7%)
   Class 18: 6541 pixels (6.4%)
   ‚Üí Background: 21.2% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.2118
   ‚Üí Pixels where class 0 prob > 0.5: 21745 (21.2%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=1.0014

üîç View 2: 2D predictions for 94972 MESH pixels (before aggregation):
   Class 28: 10991 pixels (11.6%)
   Class 31: 8758 pixels (9.2%)
   Class 32: 7873 pixels (8.3%)
   Class 23: 7136 pixels (7.5%)
   Class 16: 7080 pixels (7.5%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0001
   ‚Üí Pixels where class 0 prob > 0.5: 2 (0.0%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9978
DEBUG: Processed 11520000 total pixels, 1315458 valid pixels (11.4%)
DEBUG: Touched 96668.0 vertices out of 130921 (73.8%)
DEBUG: Vertices with zero probability sum: 34253 (26.2%)
DEBUG: Mean class 0 probability for touched vertices: 0.0870
\nDEBUG: Checking for views with high background predictions...
  Front: (see above for stats)
  Bottom: (see above for stats)
  Top: (see above for stats)
  Right: (see above for stats)
  Back: (see above for stats)
  Left: (see above for stats)
DEBUG: After normalization, P sums check: min=0.0000, max=1.0000
DEBUG: Predicted class distribution (before -1 shift):
  Class 0: 39930 vertices (30.5%)
  Class 29: 9168 vertices (7.0%)
  Class 28: 7552 vertices (5.8%)
  Class 12: 6330 vertices (4.8%)
  Class 30: 5885 vertices (4.5%)
  Class 25: 5457 vertices (4.2%)
  Class 23: 4726 vertices (3.6%)
  Class 9: 4571 vertices (3.5%)
  Class 26: 3678 vertices (2.8%)
  Class 10: 3529 vertices (2.7%)
DEBUG: Background predicted: 39930 (30.5%)
DEBUG: Foreground predicted: 90991 (69.5%)
Labels aggregated!
  ‚úì Aggregation complete
  ‚úì Prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/Afterthought-1/pred_7625119
  Loaded P matrix: (37, 130921), vertices: 130921
  Mesh: 130921 vertices, 261838 faces
  Step 1: Smoothing probabilities (20 iter, Œ±=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ‚úì Smoothing complete
  Step 2: MRF refinement (Œ≤=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ‚úì MRF refinement complete

  RESULTS:
  RAW:         median(top-10)=0.7918, mean(top-10)=0.8031, median(all)=0.7085, mean(all)=0.6274
  + SMOOTHING: median(top-10)=0.8930, mean(top-10)=0.8894, median(all)=0.8356, mean(all)=0.7455 [+0.1013]
  + MRF:       median(top-10)=0.8935, mean(top-10)=0.8899, median(all)=0.8360, mean(all)=0.7459 [+0.0004]
  TOTAL IMPROVEMENT (median top-10): +0.1017

================================================================================
Subject: Colin27-1
================================================================================
  Step 0: Generating predictions with NEW models...
  Using PyTorch3D GPU raycasting (matching training pipeline)...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 182414 vertices, 364824 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (43071 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (97725 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (89326 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (56504 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (42980 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (61050 valid pixels)
  [PyTorch3D] Raycasting complete!
  ‚úì Got 6 output maps, shape: (6, 800, 800, 3)
  Loading trained models...
Loading models...
  Loading Front: Front-epoch=499-validation_loss=0.03.ckpt
  Loading Bottom: Bottom-epoch=499-validation_loss=0.04.ckpt
  Loading Top: Top-epoch=499-validation_loss=0.05.ckpt
  Loading Right: Right-epoch=499-validation_loss=0.04.ckpt
  Loading Back: Back-epoch=499-validation_loss=0.03.ckpt
  Loading Left: Left-epoch=499-validation_loss=0.03.ckpt
Models loaded!
  Running U-Net predictions on 6 views...
Predicting labels...
Labels predicted!
  ‚úì Got predictions from 6 views
  Aggregating predictions to vertices...
Agregating predicted labels...

üîç View 0: 2D predictions for 43071 MESH pixels (before aggregation):
   Class 12: 13612 pixels (31.6%)
   Class 30: 9406 pixels (21.8%)
   Class 9: 6534 pixels (15.2%)
   Class 10: 3203 pixels (7.4%)
   Class 23: 1720 pixels (4.0%)
   ‚Üí Background: 0.2% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0028
   ‚Üí Pixels where class 0 prob > 0.5: 96 (0.2%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9974
   ‚Üí Weights for vertex 0: mean=0.3345, max=0.9951
   ‚Üí Weights for vertex 1: mean=0.3330, max=0.9974
   ‚Üí Weights for vertex 2: mean=0.3330, max=0.9949
   ‚Üí Weights sum to 1? 1.0004

üîç View 1: 2D predictions for 97725 MESH pixels (before aggregation):
   Class 29: 17124 pixels (17.5%)
   Class 0: 16274 pixels (16.7%)
   Class 26: 10541 pixels (10.8%)
   Class 15: 7142 pixels (7.3%)
   Class 18: 6459 pixels (6.6%)
   ‚Üí Background: 16.7% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.1646
   ‚Üí Pixels where class 0 prob > 0.5: 16136 (16.5%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9979

üîç View 2: 2D predictions for 89326 MESH pixels (before aggregation):
   Class 23: 9457 pixels (10.6%)
   Class 25: 7579 pixels (8.5%)
   Class 9: 7333 pixels (8.2%)
   Class 12: 6610 pixels (7.4%)
   Class 16: 6228 pixels (7.0%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0001
   ‚Üí Pixels where class 0 prob > 0.5: 2 (0.0%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9993
DEBUG: Processed 11520000 total pixels, 1171968 valid pixels (10.2%)
DEBUG: Touched 130641.0 vertices out of 182414 (71.6%)
DEBUG: Vertices with zero probability sum: 51773 (28.4%)
DEBUG: Mean class 0 probability for touched vertices: 0.0698
\nDEBUG: Checking for views with high background predictions...
  Front: (see above for stats)
  Bottom: (see above for stats)
  Top: (see above for stats)
  Right: (see above for stats)
  Back: (see above for stats)
  Left: (see above for stats)
DEBUG: After normalization, P sums check: min=0.0000, max=1.0000
DEBUG: Predicted class distribution (before -1 shift):
  Class 0: 58662 vertices (32.2%)
  Class 29: 13718 vertices (7.5%)
  Class 28: 8851 vertices (4.9%)
  Class 12: 8361 vertices (4.6%)
  Class 30: 7382 vertices (4.0%)
  Class 25: 6913 vertices (3.8%)
  Class 23: 6650 vertices (3.6%)
  Class 9: 6617 vertices (3.6%)
  Class 10: 6203 vertices (3.4%)
  Class 16: 5594 vertices (3.1%)
DEBUG: Background predicted: 58662 (32.2%)
DEBUG: Foreground predicted: 123752 (67.8%)
Labels aggregated!
  ‚úì Aggregation complete
  ‚úì Prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/Colin27-1/pred_7625119
  Loaded P matrix: (37, 182414), vertices: 182414
  Mesh: 182414 vertices, 364824 faces
  Step 1: Smoothing probabilities (20 iter, Œ±=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ‚úì Smoothing complete
  Step 2: MRF refinement (Œ≤=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ‚úì MRF refinement complete

  RESULTS:
  RAW:         median(top-10)=0.7591, mean(top-10)=0.7636, median(all)=0.6309, mean(all)=0.5713
  + SMOOTHING: median(top-10)=0.8051, mean(top-10)=0.8214, median(all)=0.7600, mean(all)=0.6804 [+0.0461]
  + MRF:       median(top-10)=0.8066, mean(top-10)=0.8224, median(all)=0.7600, mean(all)=0.6810 [+0.0015]
  TOTAL IMPROVEMENT (median top-10): +0.0475

================================================================================
Subject: HLN-12-1
================================================================================
  Step 0: Generating predictions with NEW models...
  Using PyTorch3D GPU raycasting (matching training pipeline)...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 138729 vertices, 277454 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (55392 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (110033 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (101081 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (71993 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (58637 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (75986 valid pixels)
  [PyTorch3D] Raycasting complete!
  ‚úì Got 6 output maps, shape: (6, 800, 800, 3)
  Loading trained models...
Loading models...
  Loading Front: Front-epoch=499-validation_loss=0.03.ckpt
  Loading Bottom: Bottom-epoch=499-validation_loss=0.04.ckpt
  Loading Top: Top-epoch=499-validation_loss=0.05.ckpt
  Loading Right: Right-epoch=499-validation_loss=0.04.ckpt
  Loading Back: Back-epoch=499-validation_loss=0.03.ckpt
  Loading Left: Left-epoch=499-validation_loss=0.03.ckpt
Models loaded!
  Running U-Net predictions on 6 views...
Predicting labels...
Labels predicted!
  ‚úì Got predictions from 6 views
  Aggregating predictions to vertices...
Agregating predicted labels...

üîç View 0: 2D predictions for 55392 MESH pixels (before aggregation):
   Class 12: 11946 pixels (21.6%)
   Class 30: 11411 pixels (20.6%)
   Class 9: 9567 pixels (17.3%)
   Class 0: 3658 pixels (6.6%)
   Class 26: 3229 pixels (5.8%)
   ‚Üí Background: 6.6% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0646
   ‚Üí Pixels where class 0 prob > 0.5: 3567 (6.4%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9984
   ‚Üí Weights for vertex 0: mean=0.3351, max=0.9982
   ‚Üí Weights for vertex 1: mean=0.3327, max=0.9984
   ‚Üí Weights for vertex 2: mean=0.3325, max=0.9947
   ‚Üí Weights sum to 1? 1.0003

üîç View 1: 2D predictions for 110033 MESH pixels (before aggregation):
   Class 29: 21461 pixels (19.5%)
   Class 0: 19338 pixels (17.6%)
   Class 26: 13326 pixels (12.1%)
   Class 15: 7958 pixels (7.2%)
   Class 14: 6505 pixels (5.9%)
   ‚Üí Background: 17.6% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.1742
   ‚Üí Pixels where class 0 prob > 0.5: 19194 (17.4%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9991

üîç View 2: 2D predictions for 101081 MESH pixels (before aggregation):
   Class 9: 9596 pixels (9.5%)
   Class 12: 8988 pixels (8.9%)
   Class 28: 8516 pixels (8.4%)
   Class 31: 8474 pixels (8.4%)
   Class 16: 8259 pixels (8.2%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0000
   ‚Üí Pixels where class 0 prob > 0.5: 1 (0.0%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9989
DEBUG: Processed 11520000 total pixels, 1419366 valid pixels (12.3%)
DEBUG: Touched 100890.0 vertices out of 138729 (72.7%)
DEBUG: Vertices with zero probability sum: 37839 (27.3%)
DEBUG: Mean class 0 probability for touched vertices: 0.1045
\nDEBUG: Checking for views with high background predictions...
  Front: (see above for stats)
  Bottom: (see above for stats)
  Top: (see above for stats)
  Right: (see above for stats)
  Back: (see above for stats)
  Left: (see above for stats)
DEBUG: After normalization, P sums check: min=0.0000, max=1.0000
DEBUG: Predicted class distribution (before -1 shift):
  Class 0: 44072 vertices (31.8%)
  Class 29: 9256 vertices (6.7%)
  Class 28: 7494 vertices (5.4%)
  Class 12: 6081 vertices (4.4%)
  Class 30: 5250 vertices (3.8%)
  Class 9: 5175 vertices (3.7%)
  Class 25: 4743 vertices (3.4%)
  Class 26: 4323 vertices (3.1%)
  Class 10: 4304 vertices (3.1%)
  Class 23: 4217 vertices (3.0%)
DEBUG: Background predicted: 44072 (31.8%)
DEBUG: Foreground predicted: 94657 (68.2%)
Labels aggregated!
  ‚úì Aggregation complete
  ‚úì Prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/HLN-12-1/pred_7625119
  Loaded P matrix: (37, 138729), vertices: 138729
  Mesh: 138729 vertices, 277454 faces
  Step 1: Smoothing probabilities (20 iter, Œ±=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ‚úì Smoothing complete
  Step 2: MRF refinement (Œ≤=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ‚úì MRF refinement complete

  RESULTS:
  RAW:         median(top-10)=0.7788, mean(top-10)=0.7723, median(all)=0.6620, mean(all)=0.5996
  + SMOOTHING: median(top-10)=0.8598, mean(top-10)=0.8626, median(all)=0.8025, mean(all)=0.7186 [+0.0810]
  + MRF:       median(top-10)=0.8606, mean(top-10)=0.8631, median(all)=0.8025, mean(all)=0.7189 [+0.0007]
  TOTAL IMPROVEMENT (median top-10): +0.0817

================================================================================
Subject: HLN-12-10
================================================================================
  Step 0: Generating predictions with NEW models...
  Using PyTorch3D GPU raycasting (matching training pipeline)...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 134639 vertices, 269274 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (49208 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (103318 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (96400 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (63448 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (48636 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (67763 valid pixels)
  [PyTorch3D] Raycasting complete!
  ‚úì Got 6 output maps, shape: (6, 800, 800, 3)
  Loading trained models...
Loading models...
  Loading Front: Front-epoch=499-validation_loss=0.03.ckpt
  Loading Bottom: Bottom-epoch=499-validation_loss=0.04.ckpt
  Loading Top: Top-epoch=499-validation_loss=0.05.ckpt
  Loading Right: Right-epoch=499-validation_loss=0.04.ckpt
  Loading Back: Back-epoch=499-validation_loss=0.03.ckpt
  Loading Left: Left-epoch=499-validation_loss=0.03.ckpt
Models loaded!
  Running U-Net predictions on 6 views...
Predicting labels...
Labels predicted!
  ‚úì Got predictions from 6 views
  Aggregating predictions to vertices...
Agregating predicted labels...

üîç View 0: 2D predictions for 49208 MESH pixels (before aggregation):
   Class 12: 13093 pixels (26.6%)
   Class 30: 7616 pixels (15.5%)
   Class 9: 7117 pixels (14.5%)
   Class 10: 3210 pixels (6.5%)
   Class 32: 3003 pixels (6.1%)
   ‚Üí Background: 0.1% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0011
   ‚Üí Pixels where class 0 prob > 0.5: 16 (0.0%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9994
   ‚Üí Weights for vertex 0: mean=0.3340, max=0.9938
   ‚Üí Weights for vertex 1: mean=0.3338, max=0.9994
   ‚Üí Weights for vertex 2: mean=0.3326, max=0.9969
   ‚Üí Weights sum to 1? 1.0003

üîç View 1: 2D predictions for 103318 MESH pixels (before aggregation):
   Class 0: 22363 pixels (21.6%)
   Class 29: 17967 pixels (17.4%)
   Class 26: 10586 pixels (10.2%)
   Class 18: 6067 pixels (5.9%)
   Class 6: 5729 pixels (5.5%)
   ‚Üí Background: 21.6% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.2147
   ‚Üí Pixels where class 0 prob > 0.5: 22234 (21.5%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9985

üîç View 2: 2D predictions for 96400 MESH pixels (before aggregation):
   Class 28: 9948 pixels (10.3%)
   Class 23: 8421 pixels (8.7%)
   Class 9: 7510 pixels (7.8%)
   Class 16: 7372 pixels (7.6%)
   Class 12: 7098 pixels (7.4%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0001
   ‚Üí Pixels where class 0 prob > 0.5: 1 (0.0%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9985
DEBUG: Processed 11520000 total pixels, 1286319 valid pixels (11.2%)
DEBUG: Touched 98072.0 vertices out of 134639 (72.8%)
DEBUG: Vertices with zero probability sum: 36567 (27.2%)
DEBUG: Mean class 0 probability for touched vertices: 0.0956
\nDEBUG: Checking for views with high background predictions...
  Front: (see above for stats)
  Bottom: (see above for stats)
  Top: (see above for stats)
  Right: (see above for stats)
  Back: (see above for stats)
  Left: (see above for stats)
DEBUG: After normalization, P sums check: min=0.0000, max=1.0000
DEBUG: Predicted class distribution (before -1 shift):
  Class 0: 43094 vertices (32.0%)
  Class 29: 8415 vertices (6.3%)
  Class 28: 6813 vertices (5.1%)
  Class 12: 6339 vertices (4.7%)
  Class 30: 5483 vertices (4.1%)
  Class 23: 4652 vertices (3.5%)
  Class 25: 4541 vertices (3.4%)
  Class 9: 4265 vertices (3.2%)
  Class 10: 4225 vertices (3.1%)
  Class 8: 3895 vertices (2.9%)
DEBUG: Background predicted: 43094 (32.0%)
DEBUG: Foreground predicted: 91545 (68.0%)
Labels aggregated!
  ‚úì Aggregation complete
  ‚úì Prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/HLN-12-10/pred_7625119
  Loaded P matrix: (37, 134639), vertices: 134639
  Mesh: 134639 vertices, 269274 faces
  Step 1: Smoothing probabilities (20 iter, Œ±=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ‚úì Smoothing complete
  Step 2: MRF refinement (Œ≤=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
    MRF iteration 5/5...
  ‚úì MRF refinement complete

  RESULTS:
  RAW:         median(top-10)=0.7679, mean(top-10)=0.7776, median(all)=0.6632, mean(all)=0.6084
  + SMOOTHING: median(top-10)=0.8786, mean(top-10)=0.8725, median(all)=0.7962, mean(all)=0.7282 [+0.1108]
  + MRF:       median(top-10)=0.8790, mean(top-10)=0.8727, median(all)=0.7969, mean(all)=0.7285 [+0.0004]
  TOTAL IMPROVEMENT (median top-10): +0.1112

================================================================================
Subject: HLN-12-11
================================================================================
  Step 0: Generating predictions with NEW models...
  Using PyTorch3D GPU raycasting (matching training pipeline)...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 130710 vertices, 261416 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (54132 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (108773 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (99782 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (70200 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (53644 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (73452 valid pixels)
  [PyTorch3D] Raycasting complete!
  ‚úì Got 6 output maps, shape: (6, 800, 800, 3)
  Loading trained models...
Loading models...
  Loading Front: Front-epoch=499-validation_loss=0.03.ckpt
  Loading Bottom: Bottom-epoch=499-validation_loss=0.04.ckpt
  Loading Top: Top-epoch=499-validation_loss=0.05.ckpt
  Loading Right: Right-epoch=499-validation_loss=0.04.ckpt
  Loading Back: Back-epoch=499-validation_loss=0.03.ckpt
  Loading Left: Left-epoch=499-validation_loss=0.03.ckpt
Models loaded!
  Running U-Net predictions on 6 views...
Predicting labels...
Labels predicted!
  ‚úì Got predictions from 6 views
  Aggregating predictions to vertices...
Agregating predicted labels...

üîç View 0: 2D predictions for 54132 MESH pixels (before aggregation):
   Class 30: 14495 pixels (26.8%)
   Class 12: 12554 pixels (23.2%)
   Class 9: 9007 pixels (16.6%)
   Class 32: 2909 pixels (5.4%)
   Class 6: 2858 pixels (5.3%)
   ‚Üí Background: 0.1% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0008
   ‚Üí Pixels where class 0 prob > 0.5: 28 (0.1%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9986
   ‚Üí Weights for vertex 0: mean=0.3360, max=0.9969
   ‚Üí Weights for vertex 1: mean=0.3323, max=0.9986
   ‚Üí Weights for vertex 2: mean=0.3320, max=0.9969
   ‚Üí Weights sum to 1? 1.0003

üîç View 1: 2D predictions for 108773 MESH pixels (before aggregation):
   Class 0: 24746 pixels (22.8%)
   Class 29: 18464 pixels (17.0%)
   Class 26: 11360 pixels (10.4%)
   Class 15: 7324 pixels (6.7%)
   Class 14: 6832 pixels (6.3%)
   ‚Üí Background: 22.8% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.2257
   ‚Üí Pixels where class 0 prob > 0.5: 24592 (22.6%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9998

üîç View 2: 2D predictions for 99782 MESH pixels (before aggregation):
   Class 16: 9350 pixels (9.4%)
   Class 32: 7968 pixels (8.0%)
   Class 9: 7934 pixels (8.0%)
   Class 23: 7863 pixels (7.9%)
   Class 10: 7703 pixels (7.7%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0000
   ‚Üí Pixels where class 0 prob > 0.5: 1 (0.0%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9994
DEBUG: Processed 11520000 total pixels, 1379949 valid pixels (12.0%)
DEBUG: Touched 96021.0 vertices out of 130710 (73.5%)
DEBUG: Vertices with zero probability sum: 34689 (26.5%)
DEBUG: Mean class 0 probability for touched vertices: 0.0907
\nDEBUG: Checking for views with high background predictions...
  Front: (see above for stats)
  Bottom: (see above for stats)
  Top: (see above for stats)
  Right: (see above for stats)
  Back: (see above for stats)
  Left: (see above for stats)
DEBUG: After normalization, P sums check: min=0.0000, max=1.0000
DEBUG: Predicted class distribution (before -1 shift):
  Class 0: 40928 vertices (31.3%)
  Class 29: 8147 vertices (6.2%)
  Class 30: 6232 vertices (4.8%)
  Class 28: 6065 vertices (4.6%)
  Class 12: 5927 vertices (4.5%)
  Class 25: 5595 vertices (4.3%)
  Class 23: 4724 vertices (3.6%)
  Class 9: 4494 vertices (3.4%)
  Class 10: 4155 vertices (3.2%)
  Class 16: 3742 vertices (2.9%)
DEBUG: Background predicted: 40928 (31.3%)
DEBUG: Foreground predicted: 89782 (68.7%)
Labels aggregated!
  ‚úì Aggregation complete
  ‚úì Prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/HLN-12-11/pred_7625119
  Loaded P matrix: (37, 130710), vertices: 130710
  Mesh: 130710 vertices, 261416 faces
  Step 1: Smoothing probabilities (20 iter, Œ±=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ‚úì Smoothing complete
  Step 2: MRF refinement (Œ≤=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ‚úì MRF refinement complete

  RESULTS:
  RAW:         median(top-10)=0.7615, mean(top-10)=0.7823, median(all)=0.6831, mean(all)=0.6036
  + SMOOTHING: median(top-10)=0.8855, mean(top-10)=0.8825, median(all)=0.8006, mean(all)=0.7175 [+0.1240]
  + MRF:       median(top-10)=0.8857, mean(top-10)=0.8826, median(all)=0.8010, mean(all)=0.7176 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.1243

================================================================================
Subject: HLN-12-12
================================================================================
  Step 0: Generating predictions with NEW models...
  Using PyTorch3D GPU raycasting (matching training pipeline)...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 148128 vertices, 296252 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (36488 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (87809 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (81986 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (54622 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (39079 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (58147 valid pixels)
  [PyTorch3D] Raycasting complete!
  ‚úì Got 6 output maps, shape: (6, 800, 800, 3)
  Loading trained models...
Loading models...
  Loading Front: Front-epoch=499-validation_loss=0.03.ckpt
  Loading Bottom: Bottom-epoch=499-validation_loss=0.04.ckpt
  Loading Top: Top-epoch=499-validation_loss=0.05.ckpt
  Loading Right: Right-epoch=499-validation_loss=0.04.ckpt
  Loading Back: Back-epoch=499-validation_loss=0.03.ckpt
  Loading Left: Left-epoch=499-validation_loss=0.03.ckpt
Models loaded!
  Running U-Net predictions on 6 views...
Predicting labels...
Labels predicted!
  ‚úì Got predictions from 6 views
  Aggregating predictions to vertices...
Agregating predicted labels...

üîç View 0: 2D predictions for 36488 MESH pixels (before aggregation):
   Class 12: 8741 pixels (24.0%)
   Class 30: 7353 pixels (20.2%)
   Class 9: 6356 pixels (17.4%)
   Class 10: 2296 pixels (6.3%)
   Class 32: 2249 pixels (6.2%)
   ‚Üí Background: 1.4% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0139
   ‚Üí Pixels where class 0 prob > 0.5: 484 (1.3%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9986
   ‚Üí Weights for vertex 0: mean=0.3342, max=0.9946
   ‚Üí Weights for vertex 1: mean=0.3327, max=0.9986
   ‚Üí Weights for vertex 2: mean=0.3335, max=0.9937
   ‚Üí Weights sum to 1? 1.0004

üîç View 1: 2D predictions for 87809 MESH pixels (before aggregation):
   Class 29: 17985 pixels (20.5%)
   Class 0: 15234 pixels (17.3%)
   Class 26: 8807 pixels (10.0%)
   Class 14: 6200 pixels (7.1%)
   Class 15: 6150 pixels (7.0%)
   ‚Üí Background: 17.3% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.1730
   ‚Üí Pixels where class 0 prob > 0.5: 15142 (17.2%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9992

üîç View 2: 2D predictions for 81986 MESH pixels (before aggregation):
   Class 9: 8642 pixels (10.5%)
   Class 28: 7036 pixels (8.6%)
   Class 25: 6728 pixels (8.2%)
   Class 31: 6596 pixels (8.0%)
   Class 16: 6566 pixels (8.0%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0001
   ‚Üí Pixels where class 0 prob > 0.5: 0 (0.0%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9973
DEBUG: Processed 11520000 total pixels, 1074393 valid pixels (9.3%)
DEBUG: Touched 104357.0 vertices out of 148128 (70.5%)
DEBUG: Vertices with zero probability sum: 43771 (29.5%)
DEBUG: Mean class 0 probability for touched vertices: 0.0794
\nDEBUG: Checking for views with high background predictions...
  Front: (see above for stats)
  Bottom: (see above for stats)
  Top: (see above for stats)
  Right: (see above for stats)
  Back: (see above for stats)
  Left: (see above for stats)
DEBUG: After normalization, P sums check: min=0.0000, max=1.0000
DEBUG: Predicted class distribution (before -1 shift):
  Class 0: 49674 vertices (33.5%)
  Class 29: 10540 vertices (7.1%)
  Class 28: 7340 vertices (5.0%)
  Class 12: 6352 vertices (4.3%)
  Class 25: 5708 vertices (3.9%)
  Class 30: 5685 vertices (3.8%)
  Class 9: 5489 vertices (3.7%)
  Class 8: 5030 vertices (3.4%)
  Class 10: 4409 vertices (3.0%)
  Class 23: 4396 vertices (3.0%)
DEBUG: Background predicted: 49674 (33.5%)
DEBUG: Foreground predicted: 98454 (66.5%)
Labels aggregated!
  ‚úì Aggregation complete
  ‚úì Prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/HLN-12-12/pred_7625119
  Loaded P matrix: (37, 148128), vertices: 148128
  Mesh: 148128 vertices, 296252 faces
  Step 1: Smoothing probabilities (20 iter, Œ±=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ‚úì Smoothing complete
  Step 2: MRF refinement (Œ≤=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ‚úì MRF refinement complete

  RESULTS:
  RAW:         median(top-10)=0.7517, mean(top-10)=0.7683, median(all)=0.6716, mean(all)=0.5825
  + SMOOTHING: median(top-10)=0.8705, mean(top-10)=0.8738, median(all)=0.7929, mean(all)=0.7062 [+0.1188]
  + MRF:       median(top-10)=0.8708, mean(top-10)=0.8738, median(all)=0.7937, mean(all)=0.7063 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.1191

================================================================================
Subject: HLN-12-2
================================================================================
  Step 0: Generating predictions with NEW models...
  Using PyTorch3D GPU raycasting (matching training pipeline)...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 146833 vertices, 293662 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (46607 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (103885 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (96694 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (62897 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (44360 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (66086 valid pixels)
  [PyTorch3D] Raycasting complete!
  ‚úì Got 6 output maps, shape: (6, 800, 800, 3)
  Loading trained models...
Loading models...
  Loading Front: Front-epoch=499-validation_loss=0.03.ckpt
  Loading Bottom: Bottom-epoch=499-validation_loss=0.04.ckpt
  Loading Top: Top-epoch=499-validation_loss=0.05.ckpt
  Loading Right: Right-epoch=499-validation_loss=0.04.ckpt
  Loading Back: Back-epoch=499-validation_loss=0.03.ckpt
  Loading Left: Left-epoch=499-validation_loss=0.03.ckpt
Models loaded!
  Running U-Net predictions on 6 views...
Predicting labels...
Labels predicted!
  ‚úì Got predictions from 6 views
  Aggregating predictions to vertices...
Agregating predicted labels...

üîç View 0: 2D predictions for 46607 MESH pixels (before aggregation):
   Class 12: 12294 pixels (26.4%)
   Class 30: 11853 pixels (25.4%)
   Class 9: 7951 pixels (17.1%)
   Class 23: 3509 pixels (7.5%)
   Class 32: 1975 pixels (4.2%)
   ‚Üí Background: 1.8% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0159
   ‚Üí Pixels where class 0 prob > 0.5: 761 (1.6%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9954
   ‚Üí Weights for vertex 0: mean=0.3357, max=0.9952
   ‚Üí Weights for vertex 1: mean=0.3320, max=0.9933
   ‚Üí Weights for vertex 2: mean=0.3327, max=0.9954
   ‚Üí Weights sum to 1? 1.0004

üîç View 1: 2D predictions for 103885 MESH pixels (before aggregation):
   Class 0: 20797 pixels (20.0%)
   Class 29: 20581 pixels (19.8%)
   Class 26: 10721 pixels (10.3%)
   Class 14: 7293 pixels (7.0%)
   Class 15: 6645 pixels (6.4%)
   ‚Üí Background: 20.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.1998
   ‚Üí Pixels where class 0 prob > 0.5: 20662 (19.9%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9985

üîç View 2: 2D predictions for 96694 MESH pixels (before aggregation):
   Class 16: 8550 pixels (8.8%)
   Class 9: 8197 pixels (8.5%)
   Class 31: 7578 pixels (7.8%)
   Class 12: 7042 pixels (7.3%)
   Class 25: 7035 pixels (7.3%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0001
   ‚Üí Pixels where class 0 prob > 0.5: 3 (0.0%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=1.0001
DEBUG: Processed 11520000 total pixels, 1261587 valid pixels (11.0%)
DEBUG: Touched 107451.0 vertices out of 146833 (73.2%)
DEBUG: Vertices with zero probability sum: 39382 (26.8%)
DEBUG: Mean class 0 probability for touched vertices: 0.1079
\nDEBUG: Checking for views with high background predictions...
  Front: (see above for stats)
  Bottom: (see above for stats)
  Top: (see above for stats)
  Right: (see above for stats)
  Back: (see above for stats)
  Left: (see above for stats)
DEBUG: After normalization, P sums check: min=0.0000, max=1.0000
DEBUG: Predicted class distribution (before -1 shift):
  Class 0: 46688 vertices (31.8%)
  Class 29: 10479 vertices (7.1%)
  Class 30: 7013 vertices (4.8%)
  Class 12: 6482 vertices (4.4%)
  Class 25: 5917 vertices (4.0%)
  Class 28: 5838 vertices (4.0%)
  Class 9: 5080 vertices (3.5%)
  Class 10: 5075 vertices (3.5%)
  Class 23: 4733 vertices (3.2%)
  Class 16: 4156 vertices (2.8%)
DEBUG: Background predicted: 46688 (31.8%)
DEBUG: Foreground predicted: 100145 (68.2%)
Labels aggregated!
  ‚úì Aggregation complete
  ‚úì Prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/HLN-12-2/pred_7625119
  Loaded P matrix: (37, 146833), vertices: 146833
  Mesh: 146833 vertices, 293662 faces
  Step 1: Smoothing probabilities (20 iter, Œ±=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ‚úì Smoothing complete
  Step 2: MRF refinement (Œ≤=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ‚úì MRF refinement complete

  RESULTS:
  RAW:         median(top-10)=0.7920, mean(top-10)=0.7948, median(all)=0.6572, mean(all)=0.5961
  + SMOOTHING: median(top-10)=0.8868, mean(top-10)=0.8806, median(all)=0.7993, mean(all)=0.7138 [+0.0948]
  + MRF:       median(top-10)=0.8869, mean(top-10)=0.8808, median(all)=0.7997, mean(all)=0.7141 [+0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0949

================================================================================
Subject: HLN-12-3
================================================================================
  Step 0: Generating predictions with NEW models...
  Using PyTorch3D GPU raycasting (matching training pipeline)...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 150991 vertices, 301978 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (50763 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (103869 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (95766 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (69662 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (47677 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (73690 valid pixels)
  [PyTorch3D] Raycasting complete!
  ‚úì Got 6 output maps, shape: (6, 800, 800, 3)
  Loading trained models...
Loading models...
  Loading Front: Front-epoch=499-validation_loss=0.03.ckpt
  Loading Bottom: Bottom-epoch=499-validation_loss=0.04.ckpt
  Loading Top: Top-epoch=499-validation_loss=0.05.ckpt
  Loading Right: Right-epoch=499-validation_loss=0.04.ckpt
  Loading Back: Back-epoch=499-validation_loss=0.03.ckpt
  Loading Left: Left-epoch=499-validation_loss=0.03.ckpt
Models loaded!
  Running U-Net predictions on 6 views...
Predicting labels...
Labels predicted!
  ‚úì Got predictions from 6 views
  Aggregating predictions to vertices...
Agregating predicted labels...

üîç View 0: 2D predictions for 50763 MESH pixels (before aggregation):
   Class 12: 12928 pixels (25.5%)
   Class 30: 12251 pixels (24.1%)
   Class 9: 10360 pixels (20.4%)
   Class 10: 2729 pixels (5.4%)
   Class 32: 2563 pixels (5.0%)
   ‚Üí Background: 0.2% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0017
   ‚Üí Pixels where class 0 prob > 0.5: 64 (0.1%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9992
   ‚Üí Weights for vertex 0: mean=0.3345, max=0.9968
   ‚Üí Weights for vertex 1: mean=0.3331, max=0.9991
   ‚Üí Weights for vertex 2: mean=0.3327, max=0.9992
   ‚Üí Weights sum to 1? 1.0003

üîç View 1: 2D predictions for 103869 MESH pixels (before aggregation):
   Class 0: 20549 pixels (19.8%)
   Class 29: 16680 pixels (16.1%)
   Class 26: 12161 pixels (11.7%)
   Class 15: 6754 pixels (6.5%)
   Class 14: 5962 pixels (5.7%)
   ‚Üí Background: 19.8% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.1971
   ‚Üí Pixels where class 0 prob > 0.5: 20404 (19.6%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9989

üîç View 2: 2D predictions for 95766 MESH pixels (before aggregation):
   Class 28: 10650 pixels (11.1%)
   Class 23: 8724 pixels (9.1%)
   Class 16: 7659 pixels (8.0%)
   Class 10: 7277 pixels (7.6%)
   Class 25: 7148 pixels (7.5%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0001
   ‚Üí Pixels where class 0 prob > 0.5: 3 (0.0%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=1.0000
DEBUG: Processed 11520000 total pixels, 1324281 valid pixels (11.5%)
DEBUG: Touched 104277.0 vertices out of 150991 (69.1%)
DEBUG: Vertices with zero probability sum: 46714 (30.9%)
DEBUG: Mean class 0 probability for touched vertices: 0.0926
\nDEBUG: Checking for views with high background predictions...
  Front: (see above for stats)
  Bottom: (see above for stats)
  Top: (see above for stats)
  Right: (see above for stats)
  Back: (see above for stats)
  Left: (see above for stats)
DEBUG: After normalization, P sums check: min=0.0000, max=1.0000
DEBUG: Predicted class distribution (before -1 shift):
  Class 0: 52976 vertices (35.1%)
  Class 29: 9264 vertices (6.1%)
  Class 28: 7684 vertices (5.1%)
  Class 30: 6762 vertices (4.5%)
  Class 12: 6043 vertices (4.0%)
  Class 25: 5390 vertices (3.6%)
  Class 9: 5271 vertices (3.5%)
  Class 23: 4980 vertices (3.3%)
  Class 10: 4549 vertices (3.0%)
  Class 26: 4437 vertices (2.9%)
DEBUG: Background predicted: 52976 (35.1%)
DEBUG: Foreground predicted: 98015 (64.9%)
Labels aggregated!
  ‚úì Aggregation complete
  ‚úì Prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/HLN-12-3/pred_7625119
  Loaded P matrix: (37, 150991), vertices: 150991
  Mesh: 150991 vertices, 301978 faces
  Step 1: Smoothing probabilities (20 iter, Œ±=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ‚úì Smoothing complete
  Step 2: MRF refinement (Œ≤=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
    MRF iteration 5/5...
  ‚úì MRF refinement complete

  RESULTS:
  RAW:         median(top-10)=0.7632, mean(top-10)=0.7695, median(all)=0.6632, mean(all)=0.5954
  + SMOOTHING: median(top-10)=0.8758, mean(top-10)=0.8820, median(all)=0.7967, mean(all)=0.7241 [+0.1126]
  + MRF:       median(top-10)=0.8763, mean(top-10)=0.8823, median(all)=0.7965, mean(all)=0.7244 [+0.0004]
  TOTAL IMPROVEMENT (median top-10): +0.1131

================================================================================
Subject: HLN-12-4
================================================================================
  Step 0: Generating predictions with NEW models...
  Using PyTorch3D GPU raycasting (matching training pipeline)...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 137751 vertices, 275498 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (45362 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (101448 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (93148 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (61368 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (40991 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (65568 valid pixels)
  [PyTorch3D] Raycasting complete!
  ‚úì Got 6 output maps, shape: (6, 800, 800, 3)
  Loading trained models...
Loading models...
  Loading Front: Front-epoch=499-validation_loss=0.03.ckpt
  Loading Bottom: Bottom-epoch=499-validation_loss=0.04.ckpt
  Loading Top: Top-epoch=499-validation_loss=0.05.ckpt
  Loading Right: Right-epoch=499-validation_loss=0.04.ckpt
  Loading Back: Back-epoch=499-validation_loss=0.03.ckpt
  Loading Left: Left-epoch=499-validation_loss=0.03.ckpt
Models loaded!
  Running U-Net predictions on 6 views...
Predicting labels...
Labels predicted!
  ‚úì Got predictions from 6 views
  Aggregating predictions to vertices...
Agregating predicted labels...

üîç View 0: 2D predictions for 45362 MESH pixels (before aggregation):
   Class 12: 14449 pixels (31.9%)
   Class 9: 9863 pixels (21.7%)
   Class 30: 8851 pixels (19.5%)
   Class 32: 2793 pixels (6.2%)
   Class 10: 2047 pixels (4.5%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0001
   ‚Üí Pixels where class 0 prob > 0.5: 1 (0.0%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9998
   ‚Üí Weights for vertex 0: mean=0.3347, max=0.9994
   ‚Üí Weights for vertex 1: mean=0.3333, max=0.9998
   ‚Üí Weights for vertex 2: mean=0.3324, max=0.9970
   ‚Üí Weights sum to 1? 1.0003

üîç View 1: 2D predictions for 101448 MESH pixels (before aggregation):
   Class 0: 21555 pixels (21.2%)
   Class 29: 18312 pixels (18.1%)
   Class 26: 11148 pixels (11.0%)
   Class 15: 7160 pixels (7.1%)
   Class 6: 6571 pixels (6.5%)
   ‚Üí Background: 21.2% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.2122
   ‚Üí Pixels where class 0 prob > 0.5: 21453 (21.1%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9991

üîç View 2: 2D predictions for 93148 MESH pixels (before aggregation):
   Class 28: 9238 pixels (9.9%)
   Class 31: 7744 pixels (8.3%)
   Class 25: 7555 pixels (8.1%)
   Class 9: 7536 pixels (8.1%)
   Class 12: 6976 pixels (7.5%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0001
   ‚Üí Pixels where class 0 prob > 0.5: 3 (0.0%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9987
DEBUG: Processed 11520000 total pixels, 1223655 valid pixels (10.6%)
DEBUG: Touched 99507.0 vertices out of 137751 (72.2%)
DEBUG: Vertices with zero probability sum: 38244 (27.8%)
DEBUG: Mean class 0 probability for touched vertices: 0.0882
\nDEBUG: Checking for views with high background predictions...
  Front: (see above for stats)
  Bottom: (see above for stats)
  Top: (see above for stats)
  Right: (see above for stats)
  Back: (see above for stats)
  Left: (see above for stats)
DEBUG: After normalization, P sums check: min=0.0000, max=1.0000
DEBUG: Predicted class distribution (before -1 shift):
  Class 0: 44403 vertices (32.2%)
  Class 29: 9404 vertices (6.8%)
  Class 12: 6956 vertices (5.0%)
  Class 28: 6931 vertices (5.0%)
  Class 9: 5491 vertices (4.0%)
  Class 30: 5393 vertices (3.9%)
  Class 25: 5153 vertices (3.7%)
  Class 10: 4145 vertices (3.0%)
  Class 23: 4129 vertices (3.0%)
  Class 26: 3564 vertices (2.6%)
DEBUG: Background predicted: 44403 (32.2%)
DEBUG: Foreground predicted: 93348 (67.8%)
Labels aggregated!
  ‚úì Aggregation complete
  ‚úì Prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/HLN-12-4/pred_7625119
  Loaded P matrix: (37, 137751), vertices: 137751
  Mesh: 137751 vertices, 275498 faces
  Step 1: Smoothing probabilities (20 iter, Œ±=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ‚úì Smoothing complete
  Step 2: MRF refinement (Œ≤=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ‚úì MRF refinement complete

  RESULTS:
  RAW:         median(top-10)=0.7833, mean(top-10)=0.7904, median(all)=0.6911, mean(all)=0.6066
  + SMOOTHING: median(top-10)=0.8792, mean(top-10)=0.8835, median(all)=0.8103, mean(all)=0.7309 [+0.0959]
  + MRF:       median(top-10)=0.8796, mean(top-10)=0.8837, median(all)=0.8105, mean(all)=0.7312 [+0.0005]
  TOTAL IMPROVEMENT (median top-10): +0.0963

================================================================================
Subject: HLN-12-5
================================================================================
  Step 0: Generating predictions with NEW models...
  Using PyTorch3D GPU raycasting (matching training pipeline)...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 167182 vertices, 334360 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (59201 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (119392 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (108361 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (76922 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (58160 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (81303 valid pixels)
  [PyTorch3D] Raycasting complete!
  ‚úì Got 6 output maps, shape: (6, 800, 800, 3)
  Loading trained models...
Loading models...
  Loading Front: Front-epoch=499-validation_loss=0.03.ckpt
  Loading Bottom: Bottom-epoch=499-validation_loss=0.04.ckpt
  Loading Top: Top-epoch=499-validation_loss=0.05.ckpt
  Loading Right: Right-epoch=499-validation_loss=0.04.ckpt
  Loading Back: Back-epoch=499-validation_loss=0.03.ckpt
  Loading Left: Left-epoch=499-validation_loss=0.03.ckpt
Models loaded!
  Running U-Net predictions on 6 views...
Predicting labels...
Labels predicted!
  ‚úì Got predictions from 6 views
  Aggregating predictions to vertices...
Agregating predicted labels...

üîç View 0: 2D predictions for 59201 MESH pixels (before aggregation):
   Class 30: 16273 pixels (27.5%)
   Class 12: 13877 pixels (23.4%)
   Class 9: 12146 pixels (20.5%)
   Class 23: 3729 pixels (6.3%)
   Class 32: 3048 pixels (5.1%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0005
   ‚Üí Pixels where class 0 prob > 0.5: 1 (0.0%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9972
   ‚Üí Weights for vertex 0: mean=0.3337, max=0.9946
   ‚Üí Weights for vertex 1: mean=0.3340, max=0.9972
   ‚Üí Weights for vertex 2: mean=0.3326, max=0.9968
   ‚Üí Weights sum to 1? 1.0003

üîç View 1: 2D predictions for 119392 MESH pixels (before aggregation):
   Class 29: 23907 pixels (20.0%)
   Class 0: 22917 pixels (19.2%)
   Class 26: 12673 pixels (10.6%)
   Class 15: 7689 pixels (6.4%)
   Class 18: 6711 pixels (5.6%)
   ‚Üí Background: 19.2% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.1922
   ‚Üí Pixels where class 0 prob > 0.5: 22739 (19.0%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9997

üîç View 2: 2D predictions for 108361 MESH pixels (before aggregation):
   Class 28: 11056 pixels (10.2%)
   Class 31: 10390 pixels (9.6%)
   Class 16: 9928 pixels (9.2%)
   Class 23: 9416 pixels (8.7%)
   Class 9: 9161 pixels (8.5%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0001
   ‚Üí Pixels where class 0 prob > 0.5: 2 (0.0%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9993
DEBUG: Processed 11520000 total pixels, 1510017 valid pixels (13.1%)
DEBUG: Touched 117006.0 vertices out of 167182 (70.0%)
DEBUG: Vertices with zero probability sum: 50176 (30.0%)
DEBUG: Mean class 0 probability for touched vertices: 0.0799
\nDEBUG: Checking for views with high background predictions...
  Front: (see above for stats)
  Bottom: (see above for stats)
  Top: (see above for stats)
  Right: (see above for stats)
  Back: (see above for stats)
  Left: (see above for stats)
DEBUG: After normalization, P sums check: min=0.0000, max=1.0000
DEBUG: Predicted class distribution (before -1 shift):
  Class 0: 56878 vertices (34.0%)
  Class 29: 10566 vertices (6.3%)
  Class 28: 8231 vertices (4.9%)
  Class 30: 7298 vertices (4.4%)
  Class 12: 6360 vertices (3.8%)
  Class 25: 6312 vertices (3.8%)
  Class 9: 6232 vertices (3.7%)
  Class 23: 6080 vertices (3.6%)
  Class 31: 5006 vertices (3.0%)
  Class 10: 4918 vertices (2.9%)
DEBUG: Background predicted: 56878 (34.0%)
DEBUG: Foreground predicted: 110304 (66.0%)
Labels aggregated!
  ‚úì Aggregation complete
  ‚úì Prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/HLN-12-5/pred_7625119
  Loaded P matrix: (37, 167182), vertices: 167182
  Mesh: 167182 vertices, 334360 faces
  Step 1: Smoothing probabilities (20 iter, Œ±=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ‚úì Smoothing complete
  Step 2: MRF refinement (Œ≤=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ‚úì MRF refinement complete

  RESULTS:
  RAW:         median(top-10)=0.7669, mean(top-10)=0.7631, median(all)=0.6693, mean(all)=0.5832
  + SMOOTHING: median(top-10)=0.8549, mean(top-10)=0.8603, median(all)=0.7971, mean(all)=0.7105 [+0.0880]
  + MRF:       median(top-10)=0.8547, mean(top-10)=0.8603, median(all)=0.7974, mean(all)=0.7105 [-0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0877

================================================================================
Subject: HLN-12-6
================================================================================
  Step 0: Generating predictions with NEW models...
  Using PyTorch3D GPU raycasting (matching training pipeline)...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 149409 vertices, 298814 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (48687 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (106170 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (98195 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (63466 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (48654 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (67125 valid pixels)
  [PyTorch3D] Raycasting complete!
  ‚úì Got 6 output maps, shape: (6, 800, 800, 3)
  Loading trained models...
Loading models...
  Loading Front: Front-epoch=499-validation_loss=0.03.ckpt
  Loading Bottom: Bottom-epoch=499-validation_loss=0.04.ckpt
  Loading Top: Top-epoch=499-validation_loss=0.05.ckpt
  Loading Right: Right-epoch=499-validation_loss=0.04.ckpt
  Loading Back: Back-epoch=499-validation_loss=0.03.ckpt
  Loading Left: Left-epoch=499-validation_loss=0.03.ckpt
Models loaded!
  Running U-Net predictions on 6 views...
Predicting labels...
Labels predicted!
  ‚úì Got predictions from 6 views
  Aggregating predictions to vertices...
Agregating predicted labels...

üîç View 0: 2D predictions for 48687 MESH pixels (before aggregation):
   Class 12: 13108 pixels (26.9%)
   Class 30: 9786 pixels (20.1%)
   Class 9: 8941 pixels (18.4%)
   Class 32: 2773 pixels (5.7%)
   Class 10: 2524 pixels (5.2%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0005
   ‚Üí Pixels where class 0 prob > 0.5: 4 (0.0%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9982
   ‚Üí Weights for vertex 0: mean=0.3336, max=0.9972
   ‚Üí Weights for vertex 1: mean=0.3335, max=0.9982
   ‚Üí Weights for vertex 2: mean=0.3332, max=0.9965
   ‚Üí Weights sum to 1? 1.0003

üîç View 1: 2D predictions for 106170 MESH pixels (before aggregation):
   Class 29: 19417 pixels (18.3%)
   Class 0: 19245 pixels (18.1%)
   Class 26: 10821 pixels (10.2%)
   Class 18: 8422 pixels (7.9%)
   Class 14: 7661 pixels (7.2%)
   ‚Üí Background: 18.1% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.1806
   ‚Üí Pixels where class 0 prob > 0.5: 19119 (18.0%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9978

üîç View 2: 2D predictions for 98195 MESH pixels (before aggregation):
   Class 16: 9556 pixels (9.7%)
   Class 31: 8112 pixels (8.3%)
   Class 32: 7943 pixels (8.1%)
   Class 28: 7916 pixels (8.1%)
   Class 9: 7881 pixels (8.0%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0001
   ‚Üí Pixels where class 0 prob > 0.5: 3 (0.0%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9986
DEBUG: Processed 11520000 total pixels, 1296891 valid pixels (11.3%)
DEBUG: Touched 102038.0 vertices out of 149409 (68.3%)
DEBUG: Vertices with zero probability sum: 47371 (31.7%)
DEBUG: Mean class 0 probability for touched vertices: 0.0745
\nDEBUG: Checking for views with high background predictions...
  Front: (see above for stats)
  Bottom: (see above for stats)
  Top: (see above for stats)
  Right: (see above for stats)
  Back: (see above for stats)
  Left: (see above for stats)
DEBUG: After normalization, P sums check: min=0.0000, max=1.0000
DEBUG: Predicted class distribution (before -1 shift):
  Class 0: 52674 vertices (35.3%)
  Class 29: 9349 vertices (6.3%)
  Class 28: 6677 vertices (4.5%)
  Class 12: 6018 vertices (4.0%)
  Class 30: 5548 vertices (3.7%)
  Class 9: 5124 vertices (3.4%)
  Class 25: 4767 vertices (3.2%)
  Class 8: 4702 vertices (3.1%)
  Class 23: 4537 vertices (3.0%)
  Class 16: 4484 vertices (3.0%)
DEBUG: Background predicted: 52674 (35.3%)
DEBUG: Foreground predicted: 96735 (64.7%)
Labels aggregated!
  ‚úì Aggregation complete
  ‚úì Prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/HLN-12-6/pred_7625119
  Loaded P matrix: (37, 149409), vertices: 149409
  Mesh: 149409 vertices, 298814 faces
  Step 1: Smoothing probabilities (20 iter, Œ±=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ‚úì Smoothing complete
  Step 2: MRF refinement (Œ≤=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ‚úì MRF refinement complete

  RESULTS:
  RAW:         median(top-10)=0.7301, mean(top-10)=0.7466, median(all)=0.6521, mean(all)=0.5738
  + SMOOTHING: median(top-10)=0.8607, mean(top-10)=0.8587, median(all)=0.7920, mean(all)=0.7138 [+0.1306]
  + MRF:       median(top-10)=0.8604, mean(top-10)=0.8589, median(all)=0.7924, mean(all)=0.7140 [-0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.1303

================================================================================
Subject: HLN-12-7
================================================================================
  Step 0: Generating predictions with NEW models...
  Using PyTorch3D GPU raycasting (matching training pipeline)...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 122042 vertices, 244080 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (48174 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (97942 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (90170 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (66958 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (46544 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (70897 valid pixels)
  [PyTorch3D] Raycasting complete!
  ‚úì Got 6 output maps, shape: (6, 800, 800, 3)
  Loading trained models...
Loading models...
  Loading Front: Front-epoch=499-validation_loss=0.03.ckpt
  Loading Bottom: Bottom-epoch=499-validation_loss=0.04.ckpt
  Loading Top: Top-epoch=499-validation_loss=0.05.ckpt
  Loading Right: Right-epoch=499-validation_loss=0.04.ckpt
  Loading Back: Back-epoch=499-validation_loss=0.03.ckpt
  Loading Left: Left-epoch=499-validation_loss=0.03.ckpt
Models loaded!
  Running U-Net predictions on 6 views...
Predicting labels...
Labels predicted!
  ‚úì Got predictions from 6 views
  Aggregating predictions to vertices...
Agregating predicted labels...

üîç View 0: 2D predictions for 48174 MESH pixels (before aggregation):
   Class 12: 14397 pixels (29.9%)
   Class 30: 12066 pixels (25.0%)
   Class 9: 7810 pixels (16.2%)
   Class 32: 2481 pixels (5.2%)
   Class 10: 1961 pixels (4.1%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0007
   ‚Üí Pixels where class 0 prob > 0.5: 13 (0.0%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9991
   ‚Üí Weights for vertex 0: mean=0.3340, max=0.9970
   ‚Üí Weights for vertex 1: mean=0.3339, max=0.9984
   ‚Üí Weights for vertex 2: mean=0.3324, max=0.9991
   ‚Üí Weights sum to 1? 1.0003

üîç View 1: 2D predictions for 97942 MESH pixels (before aggregation):
   Class 0: 20449 pixels (20.9%)
   Class 29: 16650 pixels (17.0%)
   Class 26: 8905 pixels (9.1%)
   Class 18: 6396 pixels (6.5%)
   Class 15: 6381 pixels (6.5%)
   ‚Üí Background: 20.9% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.2084
   ‚Üí Pixels where class 0 prob > 0.5: 20364 (20.8%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9978

üîç View 2: 2D predictions for 90170 MESH pixels (before aggregation):
   Class 28: 9229 pixels (10.2%)
   Class 12: 7827 pixels (8.7%)
   Class 31: 7664 pixels (8.5%)
   Class 25: 7316 pixels (8.1%)
   Class 32: 7010 pixels (7.8%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0001
   ‚Üí Pixels where class 0 prob > 0.5: 3 (0.0%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9988
DEBUG: Processed 11520000 total pixels, 1262055 valid pixels (11.0%)
DEBUG: Touched 89361.0 vertices out of 122042 (73.2%)
DEBUG: Vertices with zero probability sum: 32681 (26.8%)
DEBUG: Mean class 0 probability for touched vertices: 0.0883
\nDEBUG: Checking for views with high background predictions...
  Front: (see above for stats)
  Bottom: (see above for stats)
  Top: (see above for stats)
  Right: (see above for stats)
  Back: (see above for stats)
  Left: (see above for stats)
DEBUG: After normalization, P sums check: min=0.0000, max=1.0000
DEBUG: Predicted class distribution (before -1 shift):
  Class 0: 38004 vertices (31.1%)
  Class 29: 8088 vertices (6.6%)
  Class 28: 6377 vertices (5.2%)
  Class 12: 5984 vertices (4.9%)
  Class 30: 5495 vertices (4.5%)
  Class 25: 4582 vertices (3.8%)
  Class 31: 3996 vertices (3.3%)
  Class 9: 3826 vertices (3.1%)
  Class 10: 3705 vertices (3.0%)
  Class 8: 3550 vertices (2.9%)
DEBUG: Background predicted: 38004 (31.1%)
DEBUG: Foreground predicted: 84038 (68.9%)
Labels aggregated!
  ‚úì Aggregation complete
  ‚úì Prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/HLN-12-7/pred_7625119
  Loaded P matrix: (37, 122042), vertices: 122042
  Mesh: 122042 vertices, 244080 faces
  Step 1: Smoothing probabilities (20 iter, Œ±=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ‚úì Smoothing complete
  Step 2: MRF refinement (Œ≤=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ‚úì MRF refinement complete

  RESULTS:
  RAW:         median(top-10)=0.7658, mean(top-10)=0.7795, median(all)=0.7036, mean(all)=0.6110
  + SMOOTHING: median(top-10)=0.8701, mean(top-10)=0.8739, median(all)=0.8013, mean(all)=0.7230 [+0.1044]
  + MRF:       median(top-10)=0.8702, mean(top-10)=0.8741, median(all)=0.8017, mean(all)=0.7234 [+0.0000]
  TOTAL IMPROVEMENT (median top-10): +0.1044

================================================================================
Subject: HLN-12-8
================================================================================
  Step 0: Generating predictions with NEW models...
  Using PyTorch3D GPU raycasting (matching training pipeline)...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 163705 vertices, 327406 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (40393 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (100424 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (93719 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (62442 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (41836 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (64666 valid pixels)
  [PyTorch3D] Raycasting complete!
  ‚úì Got 6 output maps, shape: (6, 800, 800, 3)
  Loading trained models...
Loading models...
  Loading Front: Front-epoch=499-validation_loss=0.03.ckpt
  Loading Bottom: Bottom-epoch=499-validation_loss=0.04.ckpt
  Loading Top: Top-epoch=499-validation_loss=0.05.ckpt
  Loading Right: Right-epoch=499-validation_loss=0.04.ckpt
  Loading Back: Back-epoch=499-validation_loss=0.03.ckpt
  Loading Left: Left-epoch=499-validation_loss=0.03.ckpt
Models loaded!
  Running U-Net predictions on 6 views...
Predicting labels...
Labels predicted!
  ‚úì Got predictions from 6 views
  Aggregating predictions to vertices...
Agregating predicted labels...

üîç View 0: 2D predictions for 40393 MESH pixels (before aggregation):
   Class 12: 11417 pixels (28.3%)
   Class 30: 9435 pixels (23.4%)
   Class 9: 8374 pixels (20.7%)
   Class 6: 2106 pixels (5.2%)
   Class 32: 1935 pixels (4.8%)
   ‚Üí Background: 2.4% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0231
   ‚Üí Pixels where class 0 prob > 0.5: 938 (2.3%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9962
   ‚Üí Weights for vertex 0: mean=0.3362, max=0.9941
   ‚Üí Weights for vertex 1: mean=0.3335, max=0.9962
   ‚Üí Weights for vertex 2: mean=0.3307, max=0.9931
   ‚Üí Weights sum to 1? 1.0004

üîç View 1: 2D predictions for 100424 MESH pixels (before aggregation):
   Class 29: 19626 pixels (19.5%)
   Class 0: 19270 pixels (19.2%)
   Class 26: 10734 pixels (10.7%)
   Class 15: 6758 pixels (6.7%)
   Class 14: 5215 pixels (5.2%)
   ‚Üí Background: 19.2% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.1900
   ‚Üí Pixels where class 0 prob > 0.5: 19127 (19.0%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=1.0000

üîç View 2: 2D predictions for 93719 MESH pixels (before aggregation):
   Class 31: 9197 pixels (9.8%)
   Class 28: 8945 pixels (9.5%)
   Class 32: 7281 pixels (7.8%)
   Class 16: 7267 pixels (7.8%)
   Class 25: 7139 pixels (7.6%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0001
   ‚Üí Pixels where class 0 prob > 0.5: 1 (0.0%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=1.0009
DEBUG: Processed 11520000 total pixels, 1210440 valid pixels (10.5%)
DEBUG: Touched 115976.0 vertices out of 163705 (70.8%)
DEBUG: Vertices with zero probability sum: 47729 (29.2%)
DEBUG: Mean class 0 probability for touched vertices: 0.0932
\nDEBUG: Checking for views with high background predictions...
  Front: (see above for stats)
  Bottom: (see above for stats)
  Top: (see above for stats)
  Right: (see above for stats)
  Back: (see above for stats)
  Left: (see above for stats)
DEBUG: After normalization, P sums check: min=0.0000, max=1.0000
DEBUG: Predicted class distribution (before -1 shift):
  Class 0: 54782 vertices (33.5%)
  Class 29: 11217 vertices (6.9%)
  Class 28: 7991 vertices (4.9%)
  Class 12: 7206 vertices (4.4%)
  Class 30: 6409 vertices (3.9%)
  Class 25: 5714 vertices (3.5%)
  Class 9: 5705 vertices (3.5%)
  Class 23: 5098 vertices (3.1%)
  Class 31: 5070 vertices (3.1%)
  Class 10: 4829 vertices (2.9%)
DEBUG: Background predicted: 54782 (33.5%)
DEBUG: Foreground predicted: 108923 (66.5%)
Labels aggregated!
  ‚úì Aggregation complete
  ‚úì Prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/HLN-12-8/pred_7625119
  Loaded P matrix: (37, 163705), vertices: 163705
  Mesh: 163705 vertices, 327406 faces
  Step 1: Smoothing probabilities (20 iter, Œ±=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ‚úì Smoothing complete
  Step 2: MRF refinement (Œ≤=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ‚úì MRF refinement complete

  RESULTS:
  RAW:         median(top-10)=0.7744, mean(top-10)=0.7839, median(all)=0.6472, mean(all)=0.5884
  + SMOOTHING: median(top-10)=0.8865, mean(top-10)=0.8886, median(all)=0.8105, mean(all)=0.7172 [+0.1121]
  + MRF:       median(top-10)=0.8874, mean(top-10)=0.8889, median(all)=0.8103, mean(all)=0.7176 [+0.0009]
  TOTAL IMPROVEMENT (median top-10): +0.1130

================================================================================
Subject: HLN-12-9
================================================================================
  Step 0: Generating predictions with NEW models...
  Using PyTorch3D GPU raycasting (matching training pipeline)...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 137393 vertices, 274782 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (46497 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (104898 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (97052 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (68112 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (46952 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (70884 valid pixels)
  [PyTorch3D] Raycasting complete!
  ‚úì Got 6 output maps, shape: (6, 800, 800, 3)
  Loading trained models...
Loading models...
  Loading Front: Front-epoch=499-validation_loss=0.03.ckpt
  Loading Bottom: Bottom-epoch=499-validation_loss=0.04.ckpt
  Loading Top: Top-epoch=499-validation_loss=0.05.ckpt
  Loading Right: Right-epoch=499-validation_loss=0.04.ckpt
  Loading Back: Back-epoch=499-validation_loss=0.03.ckpt
  Loading Left: Left-epoch=499-validation_loss=0.03.ckpt
Models loaded!
  Running U-Net predictions on 6 views...
Predicting labels...
Labels predicted!
  ‚úì Got predictions from 6 views
  Aggregating predictions to vertices...
Agregating predicted labels...

üîç View 0: 2D predictions for 46497 MESH pixels (before aggregation):
   Class 12: 12654 pixels (27.2%)
   Class 30: 10106 pixels (21.7%)
   Class 9: 8640 pixels (18.6%)
   Class 23: 2307 pixels (5.0%)
   Class 32: 1948 pixels (4.2%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0011
   ‚Üí Pixels where class 0 prob > 0.5: 14 (0.0%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9978
   ‚Üí Weights for vertex 0: mean=0.3342, max=0.9956
   ‚Üí Weights for vertex 1: mean=0.3348, max=0.9978
   ‚Üí Weights for vertex 2: mean=0.3313, max=0.9930
   ‚Üí Weights sum to 1? 1.0003

üîç View 1: 2D predictions for 104898 MESH pixels (before aggregation):
   Class 0: 21321 pixels (20.3%)
   Class 29: 19965 pixels (19.0%)
   Class 26: 10491 pixels (10.0%)
   Class 18: 7174 pixels (6.8%)
   Class 14: 6830 pixels (6.5%)
   ‚Üí Background: 20.3% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.2011
   ‚Üí Pixels where class 0 prob > 0.5: 21201 (20.2%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9981

üîç View 2: 2D predictions for 97052 MESH pixels (before aggregation):
   Class 9: 8905 pixels (9.2%)
   Class 23: 8185 pixels (8.4%)
   Class 28: 8035 pixels (8.3%)
   Class 32: 7839 pixels (8.1%)
   Class 31: 7788 pixels (8.0%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0001
   ‚Üí Pixels where class 0 prob > 0.5: 1 (0.0%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9985
DEBUG: Processed 11520000 total pixels, 1303185 valid pixels (11.3%)
DEBUG: Touched 100691.0 vertices out of 137393 (73.3%)
DEBUG: Vertices with zero probability sum: 36702 (26.7%)
DEBUG: Mean class 0 probability for touched vertices: 0.0892
\nDEBUG: Checking for views with high background predictions...
  Front: (see above for stats)
  Bottom: (see above for stats)
  Top: (see above for stats)
  Right: (see above for stats)
  Back: (see above for stats)
  Left: (see above for stats)
DEBUG: After normalization, P sums check: min=0.0000, max=1.0000
DEBUG: Predicted class distribution (before -1 shift):
  Class 0: 42960 vertices (31.3%)
  Class 29: 9251 vertices (6.7%)
  Class 28: 6414 vertices (4.7%)
  Class 12: 5808 vertices (4.2%)
  Class 25: 5623 vertices (4.1%)
  Class 30: 5309 vertices (3.9%)
  Class 9: 4865 vertices (3.5%)
  Class 23: 4407 vertices (3.2%)
  Class 14: 4157 vertices (3.0%)
  Class 32: 3988 vertices (2.9%)
DEBUG: Background predicted: 42960 (31.3%)
DEBUG: Foreground predicted: 94433 (68.7%)
Labels aggregated!
  ‚úì Aggregation complete
  ‚úì Prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/HLN-12-9/pred_7625119
  Loaded P matrix: (37, 137393), vertices: 137393
  Mesh: 137393 vertices, 274782 faces
  Step 1: Smoothing probabilities (20 iter, Œ±=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ‚úì Smoothing complete
  Step 2: MRF refinement (Œ≤=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ‚úì MRF refinement complete

  RESULTS:
  RAW:         median(top-10)=0.7924, mean(top-10)=0.8012, median(all)=0.6593, mean(all)=0.6008
  + SMOOTHING: median(top-10)=0.8816, mean(top-10)=0.8881, median(all)=0.8066, mean(all)=0.7190 [+0.0892]
  + MRF:       median(top-10)=0.8815, mean(top-10)=0.8882, median(all)=0.8061, mean(all)=0.7193 [-0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0891

================================================================================
Subject: MMRR-21-1
================================================================================
  Step 0: Generating predictions with NEW models...
  Using PyTorch3D GPU raycasting (matching training pipeline)...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 130631 vertices, 261258 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (40722 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (99817 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (92769 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (57787 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (39358 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (61484 valid pixels)
  [PyTorch3D] Raycasting complete!
  ‚úì Got 6 output maps, shape: (6, 800, 800, 3)
  Loading trained models...
Loading models...
  Loading Front: Front-epoch=499-validation_loss=0.03.ckpt
  Loading Bottom: Bottom-epoch=499-validation_loss=0.04.ckpt
  Loading Top: Top-epoch=499-validation_loss=0.05.ckpt
  Loading Right: Right-epoch=499-validation_loss=0.04.ckpt
  Loading Back: Back-epoch=499-validation_loss=0.03.ckpt
  Loading Left: Left-epoch=499-validation_loss=0.03.ckpt
Models loaded!
  Running U-Net predictions on 6 views...
Predicting labels...
Labels predicted!
  ‚úì Got predictions from 6 views
  Aggregating predictions to vertices...
Agregating predicted labels...

üîç View 0: 2D predictions for 40722 MESH pixels (before aggregation):
   Class 12: 10751 pixels (26.4%)
   Class 30: 10229 pixels (25.1%)
   Class 9: 8135 pixels (20.0%)
   Class 32: 2184 pixels (5.4%)
   Class 10: 1615 pixels (4.0%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0004
   ‚Üí Pixels where class 0 prob > 0.5: 3 (0.0%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9994
   ‚Üí Weights for vertex 0: mean=0.3341, max=0.9994
   ‚Üí Weights for vertex 1: mean=0.3341, max=0.9912
   ‚Üí Weights for vertex 2: mean=0.3321, max=0.9929
   ‚Üí Weights sum to 1? 1.0003

üîç View 1: 2D predictions for 99817 MESH pixels (before aggregation):
   Class 0: 19333 pixels (19.4%)
   Class 29: 17586 pixels (17.6%)
   Class 26: 12035 pixels (12.1%)
   Class 14: 6632 pixels (6.6%)
   Class 15: 6459 pixels (6.5%)
   ‚Üí Background: 19.4% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.1921
   ‚Üí Pixels where class 0 prob > 0.5: 19207 (19.2%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9977

üîç View 2: 2D predictions for 92769 MESH pixels (before aggregation):
   Class 28: 9080 pixels (9.8%)
   Class 32: 8449 pixels (9.1%)
   Class 31: 7601 pixels (8.2%)
   Class 10: 7408 pixels (8.0%)
   Class 9: 6657 pixels (7.2%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0003
   ‚Üí Pixels where class 0 prob > 0.5: 7 (0.0%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9966
DEBUG: Processed 11520000 total pixels, 1175811 valid pixels (10.2%)
DEBUG: Touched 94316.0 vertices out of 130631 (72.2%)
DEBUG: Vertices with zero probability sum: 36315 (27.8%)
DEBUG: Mean class 0 probability for touched vertices: 0.0909
\nDEBUG: Checking for views with high background predictions...
  Front: (see above for stats)
  Bottom: (see above for stats)
  Top: (see above for stats)
  Right: (see above for stats)
  Back: (see above for stats)
  Left: (see above for stats)
DEBUG: After normalization, P sums check: min=0.0000, max=1.0000
DEBUG: Predicted class distribution (before -1 shift):
  Class 0: 42236 vertices (32.3%)
  Class 29: 8170 vertices (6.3%)
  Class 28: 5986 vertices (4.6%)
  Class 30: 5546 vertices (4.2%)
  Class 12: 5328 vertices (4.1%)
  Class 10: 4558 vertices (3.5%)
  Class 25: 4513 vertices (3.5%)
  Class 9: 4422 vertices (3.4%)
  Class 26: 4053 vertices (3.1%)
  Class 32: 4032 vertices (3.1%)
DEBUG: Background predicted: 42236 (32.3%)
DEBUG: Foreground predicted: 88395 (67.7%)
Labels aggregated!
  ‚úì Aggregation complete
  ‚úì Prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-1/pred_7625119
  Loaded P matrix: (37, 130631), vertices: 130631
  Mesh: 130631 vertices, 261258 faces
  Step 1: Smoothing probabilities (20 iter, Œ±=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ‚úì Smoothing complete
  Step 2: MRF refinement (Œ≤=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ‚úì MRF refinement complete

  RESULTS:
  RAW:         median(top-10)=0.7753, mean(top-10)=0.7773, median(all)=0.7107, mean(all)=0.6097
  + SMOOTHING: median(top-10)=0.8887, mean(top-10)=0.8929, median(all)=0.8242, mean(all)=0.7424 [+0.1134]
  + MRF:       median(top-10)=0.8891, mean(top-10)=0.8934, median(all)=0.8246, mean(all)=0.7429 [+0.0004]
  TOTAL IMPROVEMENT (median top-10): +0.1137

================================================================================
Subject: MMRR-21-10
================================================================================
  Step 0: Generating predictions with NEW models...
  Using PyTorch3D GPU raycasting (matching training pipeline)...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 148162 vertices, 296320 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (43482 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (98186 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (91751 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (60436 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (42061 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (64853 valid pixels)
  [PyTorch3D] Raycasting complete!
  ‚úì Got 6 output maps, shape: (6, 800, 800, 3)
  Loading trained models...
Loading models...
  Loading Front: Front-epoch=499-validation_loss=0.03.ckpt
  Loading Bottom: Bottom-epoch=499-validation_loss=0.04.ckpt
  Loading Top: Top-epoch=499-validation_loss=0.05.ckpt
  Loading Right: Right-epoch=499-validation_loss=0.04.ckpt
  Loading Back: Back-epoch=499-validation_loss=0.03.ckpt
  Loading Left: Left-epoch=499-validation_loss=0.03.ckpt
Models loaded!
  Running U-Net predictions on 6 views...
Predicting labels...
Labels predicted!
  ‚úì Got predictions from 6 views
  Aggregating predictions to vertices...
Agregating predicted labels...

üîç View 0: 2D predictions for 43482 MESH pixels (before aggregation):
   Class 12: 13504 pixels (31.1%)
   Class 30: 9423 pixels (21.7%)
   Class 9: 8351 pixels (19.2%)
   Class 32: 2146 pixels (4.9%)
   Class 10: 1616 pixels (3.7%)
   ‚Üí Background: 1.5% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0140
   ‚Üí Pixels where class 0 prob > 0.5: 592 (1.4%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9981
   ‚Üí Weights for vertex 0: mean=0.3350, max=0.9954
   ‚Üí Weights for vertex 1: mean=0.3335, max=0.9963
   ‚Üí Weights for vertex 2: mean=0.3319, max=0.9981
   ‚Üí Weights sum to 1? 1.0003

üîç View 1: 2D predictions for 98186 MESH pixels (before aggregation):
   Class 0: 19430 pixels (19.8%)
   Class 29: 17525 pixels (17.8%)
   Class 26: 11302 pixels (11.5%)
   Class 15: 6129 pixels (6.2%)
   Class 14: 5752 pixels (5.9%)
   ‚Üí Background: 19.8% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.1953
   ‚Üí Pixels where class 0 prob > 0.5: 19339 (19.7%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=1.0068

üîç View 2: 2D predictions for 91751 MESH pixels (before aggregation):
   Class 28: 8847 pixels (9.6%)
   Class 9: 8451 pixels (9.2%)
   Class 16: 7681 pixels (8.4%)
   Class 32: 7122 pixels (7.8%)
   Class 23: 6979 pixels (7.6%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0004
   ‚Üí Pixels where class 0 prob > 0.5: 2 (0.0%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9974
DEBUG: Processed 11520000 total pixels, 1202307 valid pixels (10.4%)
DEBUG: Touched 105240.0 vertices out of 148162 (71.0%)
DEBUG: Vertices with zero probability sum: 42922 (29.0%)
DEBUG: Mean class 0 probability for touched vertices: 0.0923
\nDEBUG: Checking for views with high background predictions...
  Front: (see above for stats)
  Bottom: (see above for stats)
  Top: (see above for stats)
  Right: (see above for stats)
  Back: (see above for stats)
  Left: (see above for stats)
DEBUG: After normalization, P sums check: min=0.0000, max=1.0000
DEBUG: Predicted class distribution (before -1 shift):
  Class 0: 49073 vertices (33.1%)
  Class 29: 9298 vertices (6.3%)
  Class 28: 7188 vertices (4.9%)
  Class 12: 6916 vertices (4.7%)
  Class 9: 6030 vertices (4.1%)
  Class 30: 5966 vertices (4.0%)
  Class 25: 4405 vertices (3.0%)
  Class 10: 4379 vertices (3.0%)
  Class 8: 4374 vertices (3.0%)
  Class 26: 4370 vertices (2.9%)
DEBUG: Background predicted: 49073 (33.1%)
DEBUG: Foreground predicted: 99089 (66.9%)
Labels aggregated!
  ‚úì Aggregation complete
  ‚úì Prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-10/pred_7625119
  Loaded P matrix: (37, 148162), vertices: 148162
  Mesh: 148162 vertices, 296320 faces
  Step 1: Smoothing probabilities (20 iter, Œ±=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ‚úì Smoothing complete
  Step 2: MRF refinement (Œ≤=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ‚úì MRF refinement complete

  RESULTS:
  RAW:         median(top-10)=0.7708, mean(top-10)=0.7806, median(all)=0.6646, mean(all)=0.5913
  + SMOOTHING: median(top-10)=0.8818, mean(top-10)=0.8796, median(all)=0.7967, mean(all)=0.7195 [+0.1110]
  + MRF:       median(top-10)=0.8819, mean(top-10)=0.8799, median(all)=0.7970, mean(all)=0.7197 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.1111

================================================================================
Subject: MMRR-21-11
================================================================================
  Step 0: Generating predictions with NEW models...
  Using PyTorch3D GPU raycasting (matching training pipeline)...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 136982 vertices, 273960 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (52146 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (110529 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (101692 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (69534 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (48724 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (73385 valid pixels)
  [PyTorch3D] Raycasting complete!
  ‚úì Got 6 output maps, shape: (6, 800, 800, 3)
  Loading trained models...
Loading models...
  Loading Front: Front-epoch=499-validation_loss=0.03.ckpt
  Loading Bottom: Bottom-epoch=499-validation_loss=0.04.ckpt
  Loading Top: Top-epoch=499-validation_loss=0.05.ckpt
  Loading Right: Right-epoch=499-validation_loss=0.04.ckpt
  Loading Back: Back-epoch=499-validation_loss=0.03.ckpt
  Loading Left: Left-epoch=499-validation_loss=0.03.ckpt
Models loaded!
  Running U-Net predictions on 6 views...
Predicting labels...
Labels predicted!
  ‚úì Got predictions from 6 views
  Aggregating predictions to vertices...
Agregating predicted labels...

üîç View 0: 2D predictions for 52146 MESH pixels (before aggregation):
   Class 30: 14807 pixels (28.4%)
   Class 12: 11296 pixels (21.7%)
   Class 9: 10995 pixels (21.1%)
   Class 32: 3021 pixels (5.8%)
   Class 6: 2085 pixels (4.0%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0003
   ‚Üí Pixels where class 0 prob > 0.5: 2 (0.0%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9984
   ‚Üí Weights for vertex 0: mean=0.3350, max=0.9967
   ‚Üí Weights for vertex 1: mean=0.3333, max=0.9974
   ‚Üí Weights for vertex 2: mean=0.3320, max=0.9984
   ‚Üí Weights sum to 1? 1.0003

üîç View 1: 2D predictions for 110529 MESH pixels (before aggregation):
   Class 0: 22407 pixels (20.3%)
   Class 29: 19824 pixels (17.9%)
   Class 26: 11188 pixels (10.1%)
   Class 15: 7692 pixels (7.0%)
   Class 14: 7571 pixels (6.8%)
   ‚Üí Background: 20.3% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.2021
   ‚Üí Pixels where class 0 prob > 0.5: 22357 (20.2%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9997

üîç View 2: 2D predictions for 101692 MESH pixels (before aggregation):
   Class 28: 9679 pixels (9.5%)
   Class 16: 9142 pixels (9.0%)
   Class 32: 8979 pixels (8.8%)
   Class 23: 8844 pixels (8.7%)
   Class 9: 8571 pixels (8.4%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0000
   ‚Üí Pixels where class 0 prob > 0.5: 1 (0.0%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=1.0004
DEBUG: Processed 11520000 total pixels, 1368030 valid pixels (11.9%)
DEBUG: Touched 99681.0 vertices out of 136982 (72.8%)
DEBUG: Vertices with zero probability sum: 37301 (27.2%)
DEBUG: Mean class 0 probability for touched vertices: 0.0907
\nDEBUG: Checking for views with high background predictions...
  Front: (see above for stats)
  Bottom: (see above for stats)
  Top: (see above for stats)
  Right: (see above for stats)
  Back: (see above for stats)
  Left: (see above for stats)
DEBUG: After normalization, P sums check: min=0.0000, max=1.0000
DEBUG: Predicted class distribution (before -1 shift):
  Class 0: 43489 vertices (31.7%)
  Class 29: 8859 vertices (6.5%)
  Class 30: 6319 vertices (4.6%)
  Class 28: 6043 vertices (4.4%)
  Class 12: 5702 vertices (4.2%)
  Class 9: 5337 vertices (3.9%)
  Class 23: 4894 vertices (3.6%)
  Class 25: 4772 vertices (3.5%)
  Class 32: 4428 vertices (3.2%)
  Class 31: 4267 vertices (3.1%)
DEBUG: Background predicted: 43489 (31.7%)
DEBUG: Foreground predicted: 93493 (68.3%)
Labels aggregated!
  ‚úì Aggregation complete
  ‚úì Prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-11/pred_7625119
  Loaded P matrix: (37, 136982), vertices: 136982
  Mesh: 136982 vertices, 273960 faces
  Step 1: Smoothing probabilities (20 iter, Œ±=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ‚úì Smoothing complete
  Step 2: MRF refinement (Œ≤=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ‚úì MRF refinement complete

  RESULTS:
  RAW:         median(top-10)=0.7696, mean(top-10)=0.7788, median(all)=0.6224, mean(all)=0.5346
  + SMOOTHING: median(top-10)=0.8630, mean(top-10)=0.8633, median(all)=0.7600, mean(all)=0.6318 [+0.0933]
  + MRF:       median(top-10)=0.8633, mean(top-10)=0.8638, median(all)=0.7605, mean(all)=0.6319 [+0.0004]
  TOTAL IMPROVEMENT (median top-10): +0.0937

================================================================================
Subject: MMRR-21-12
================================================================================
  Step 0: Generating predictions with NEW models...
  Using PyTorch3D GPU raycasting (matching training pipeline)...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 102602 vertices, 205200 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (47593 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (99656 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (92170 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (63142 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (48707 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (67036 valid pixels)
  [PyTorch3D] Raycasting complete!
  ‚úì Got 6 output maps, shape: (6, 800, 800, 3)
  Loading trained models...
Loading models...
  Loading Front: Front-epoch=499-validation_loss=0.03.ckpt
  Loading Bottom: Bottom-epoch=499-validation_loss=0.04.ckpt
  Loading Top: Top-epoch=499-validation_loss=0.05.ckpt
  Loading Right: Right-epoch=499-validation_loss=0.04.ckpt
  Loading Back: Back-epoch=499-validation_loss=0.03.ckpt
  Loading Left: Left-epoch=499-validation_loss=0.03.ckpt
Models loaded!
  Running U-Net predictions on 6 views...
Predicting labels...
Labels predicted!
  ‚úì Got predictions from 6 views
  Aggregating predictions to vertices...
Agregating predicted labels...

üîç View 0: 2D predictions for 47593 MESH pixels (before aggregation):
   Class 12: 13141 pixels (27.6%)
   Class 30: 10563 pixels (22.2%)
   Class 9: 6306 pixels (13.2%)
   Class 8: 2632 pixels (5.5%)
   Class 10: 2602 pixels (5.5%)
   ‚Üí Background: 1.3% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0126
   ‚Üí Pixels where class 0 prob > 0.5: 590 (1.2%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9996
   ‚Üí Weights for vertex 0: mean=0.3340, max=0.9996
   ‚Üí Weights for vertex 1: mean=0.3342, max=0.9938
   ‚Üí Weights for vertex 2: mean=0.3320, max=0.9970
   ‚Üí Weights sum to 1? 1.0002

üîç View 1: 2D predictions for 99656 MESH pixels (before aggregation):
   Class 0: 21339 pixels (21.4%)
   Class 29: 18671 pixels (18.7%)
   Class 26: 8025 pixels (8.1%)
   Class 15: 7054 pixels (7.1%)
   Class 14: 6963 pixels (7.0%)
   ‚Üí Background: 21.4% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.2109
   ‚Üí Pixels where class 0 prob > 0.5: 21247 (21.3%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9993

üîç View 2: 2D predictions for 92170 MESH pixels (before aggregation):
   Class 28: 10493 pixels (11.4%)
   Class 32: 7964 pixels (8.6%)
   Class 16: 7947 pixels (8.6%)
   Class 9: 7741 pixels (8.4%)
   Class 10: 7159 pixels (7.8%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0001
   ‚Üí Pixels where class 0 prob > 0.5: 4 (0.0%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9989
DEBUG: Processed 11520000 total pixels, 1254912 valid pixels (10.9%)
DEBUG: Touched 76274.0 vertices out of 102602 (74.3%)
DEBUG: Vertices with zero probability sum: 26328 (25.7%)
DEBUG: Mean class 0 probability for touched vertices: 0.0996
\nDEBUG: Checking for views with high background predictions...
  Front: (see above for stats)
  Bottom: (see above for stats)
  Top: (see above for stats)
  Right: (see above for stats)
  Back: (see above for stats)
  Left: (see above for stats)
DEBUG: After normalization, P sums check: min=0.0000, max=1.0000
DEBUG: Predicted class distribution (before -1 shift):
  Class 0: 31556 vertices (30.8%)
  Class 29: 6951 vertices (6.8%)
  Class 28: 5746 vertices (5.6%)
  Class 30: 4922 vertices (4.8%)
  Class 12: 4106 vertices (4.0%)
  Class 25: 3723 vertices (3.6%)
  Class 23: 3399 vertices (3.3%)
  Class 10: 3379 vertices (3.3%)
  Class 9: 3346 vertices (3.3%)
  Class 16: 3239 vertices (3.2%)
DEBUG: Background predicted: 31556 (30.8%)
DEBUG: Foreground predicted: 71046 (69.2%)
Labels aggregated!
  ‚úì Aggregation complete
  ‚úì Prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-12/pred_7625119
  Loaded P matrix: (37, 102602), vertices: 102602
  Mesh: 102602 vertices, 205200 faces
  Step 1: Smoothing probabilities (20 iter, Œ±=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ‚úì Smoothing complete
  Step 2: MRF refinement (Œ≤=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ‚úì MRF refinement complete

  RESULTS:
  RAW:         median(top-10)=0.8142, mean(top-10)=0.8035, median(all)=0.6896, mean(all)=0.6078
  + SMOOTHING: median(top-10)=0.8719, mean(top-10)=0.8749, median(all)=0.7977, mean(all)=0.7206 [+0.0577]
  + MRF:       median(top-10)=0.8722, mean(top-10)=0.8752, median(all)=0.7977, mean(all)=0.7210 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0580

================================================================================
Subject: MMRR-21-13
================================================================================
  Step 0: Generating predictions with NEW models...
  Using PyTorch3D GPU raycasting (matching training pipeline)...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 128887 vertices, 257770 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (66987 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (128645 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (116270 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (81198 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (61231 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (85980 valid pixels)
  [PyTorch3D] Raycasting complete!
  ‚úì Got 6 output maps, shape: (6, 800, 800, 3)
  Loading trained models...
Loading models...
  Loading Front: Front-epoch=499-validation_loss=0.03.ckpt
  Loading Bottom: Bottom-epoch=499-validation_loss=0.04.ckpt
  Loading Top: Top-epoch=499-validation_loss=0.05.ckpt
  Loading Right: Right-epoch=499-validation_loss=0.04.ckpt
  Loading Back: Back-epoch=499-validation_loss=0.03.ckpt
  Loading Left: Left-epoch=499-validation_loss=0.03.ckpt
Models loaded!
  Running U-Net predictions on 6 views...
Predicting labels...
Labels predicted!
  ‚úì Got predictions from 6 views
  Aggregating predictions to vertices...
Agregating predicted labels...

üîç View 0: 2D predictions for 66987 MESH pixels (before aggregation):
   Class 30: 19450 pixels (29.0%)
   Class 12: 14804 pixels (22.1%)
   Class 9: 12329 pixels (18.4%)
   Class 23: 6833 pixels (10.2%)
   Class 32: 3599 pixels (5.4%)
   ‚Üí Background: 0.5% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0046
   ‚Üí Pixels where class 0 prob > 0.5: 303 (0.5%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9992
   ‚Üí Weights for vertex 0: mean=0.3336, max=0.9983
   ‚Üí Weights for vertex 1: mean=0.3331, max=0.9948
   ‚Üí Weights for vertex 2: mean=0.3335, max=0.9992
   ‚Üí Weights sum to 1? 1.0002

üîç View 1: 2D predictions for 128645 MESH pixels (before aggregation):
   Class 0: 27373 pixels (21.3%)
   Class 29: 24047 pixels (18.7%)
   Class 26: 15153 pixels (11.8%)
   Class 15: 7774 pixels (6.0%)
   Class 14: 6566 pixels (5.1%)
   ‚Üí Background: 21.3% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.2125
   ‚Üí Pixels where class 0 prob > 0.5: 27246 (21.2%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9994

üîç View 2: 2D predictions for 116270 MESH pixels (before aggregation):
   Class 28: 12902 pixels (11.1%)
   Class 9: 10941 pixels (9.4%)
   Class 31: 9488 pixels (8.2%)
   Class 16: 9321 pixels (8.0%)
   Class 32: 9202 pixels (7.9%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0000
   ‚Üí Pixels where class 0 prob > 0.5: 0 (0.0%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9990
DEBUG: Processed 11520000 total pixels, 1620933 valid pixels (14.1%)
DEBUG: Touched 94344.0 vertices out of 128887 (73.2%)
DEBUG: Vertices with zero probability sum: 34543 (26.8%)
DEBUG: Mean class 0 probability for touched vertices: 0.1066
\nDEBUG: Checking for views with high background predictions...
  Front: (see above for stats)
  Bottom: (see above for stats)
  Top: (see above for stats)
  Right: (see above for stats)
  Back: (see above for stats)
  Left: (see above for stats)
DEBUG: After normalization, P sums check: min=0.0000, max=1.0000
DEBUG: Predicted class distribution (before -1 shift):
  Class 0: 41101 vertices (31.9%)
  Class 29: 8142 vertices (6.3%)
  Class 30: 6816 vertices (5.3%)
  Class 28: 6535 vertices (5.1%)
  Class 12: 5508 vertices (4.3%)
  Class 25: 5236 vertices (4.1%)
  Class 9: 4585 vertices (3.6%)
  Class 26: 4180 vertices (3.2%)
  Class 23: 4095 vertices (3.2%)
  Class 31: 3765 vertices (2.9%)
DEBUG: Background predicted: 41101 (31.9%)
DEBUG: Foreground predicted: 87786 (68.1%)
Labels aggregated!
  ‚úì Aggregation complete
  ‚úì Prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-13/pred_7625119
  Loaded P matrix: (37, 128887), vertices: 128887
  Mesh: 128887 vertices, 257770 faces
  Step 1: Smoothing probabilities (20 iter, Œ±=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ‚úì Smoothing complete
  Step 2: MRF refinement (Œ≤=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ‚úì MRF refinement complete

  RESULTS:
  RAW:         median(top-10)=0.7832, mean(top-10)=0.7775, median(all)=0.6814, mean(all)=0.6085
  + SMOOTHING: median(top-10)=0.8546, mean(top-10)=0.8676, median(all)=0.8060, mean(all)=0.7232 [+0.0714]
  + MRF:       median(top-10)=0.8544, mean(top-10)=0.8678, median(all)=0.8056, mean(all)=0.7234 [-0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0712

================================================================================
Subject: MMRR-21-14
================================================================================
  Step 0: Generating predictions with NEW models...
  Using PyTorch3D GPU raycasting (matching training pipeline)...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 127387 vertices, 254770 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (43715 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (101762 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (93528 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (63818 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (42955 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (68349 valid pixels)
  [PyTorch3D] Raycasting complete!
  ‚úì Got 6 output maps, shape: (6, 800, 800, 3)
  Loading trained models...
Loading models...
  Loading Front: Front-epoch=499-validation_loss=0.03.ckpt
  Loading Bottom: Bottom-epoch=499-validation_loss=0.04.ckpt
  Loading Top: Top-epoch=499-validation_loss=0.05.ckpt
  Loading Right: Right-epoch=499-validation_loss=0.04.ckpt
  Loading Back: Back-epoch=499-validation_loss=0.03.ckpt
  Loading Left: Left-epoch=499-validation_loss=0.03.ckpt
Models loaded!
  Running U-Net predictions on 6 views...
Predicting labels...
Labels predicted!
  ‚úì Got predictions from 6 views
  Aggregating predictions to vertices...
Agregating predicted labels...

üîç View 0: 2D predictions for 43715 MESH pixels (before aggregation):
   Class 30: 11037 pixels (25.2%)
   Class 12: 10384 pixels (23.8%)
   Class 9: 9100 pixels (20.8%)
   Class 32: 3131 pixels (7.2%)
   Class 23: 2500 pixels (5.7%)
   ‚Üí Background: 0.2% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0019
   ‚Üí Pixels where class 0 prob > 0.5: 69 (0.2%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9959
   ‚Üí Weights for vertex 0: mean=0.3363, max=0.9917
   ‚Üí Weights for vertex 1: mean=0.3313, max=0.9959
   ‚Üí Weights for vertex 2: mean=0.3327, max=0.9949
   ‚Üí Weights sum to 1? 1.0003

üîç View 1: 2D predictions for 101762 MESH pixels (before aggregation):
   Class 0: 21877 pixels (21.5%)
   Class 29: 21111 pixels (20.7%)
   Class 26: 10792 pixels (10.6%)
   Class 15: 7161 pixels (7.0%)
   Class 18: 6596 pixels (6.5%)
   ‚Üí Background: 21.5% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.2113
   ‚Üí Pixels where class 0 prob > 0.5: 21742 (21.4%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9984

üîç View 2: 2D predictions for 93528 MESH pixels (before aggregation):
   Class 31: 9504 pixels (10.2%)
   Class 28: 9448 pixels (10.1%)
   Class 16: 7706 pixels (8.2%)
   Class 25: 7652 pixels (8.2%)
   Class 32: 7425 pixels (7.9%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0000
   ‚Üí Pixels where class 0 prob > 0.5: 0 (0.0%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9985
DEBUG: Processed 11520000 total pixels, 1242381 valid pixels (10.8%)
DEBUG: Touched 94509.0 vertices out of 127387 (74.2%)
DEBUG: Vertices with zero probability sum: 32878 (25.8%)
DEBUG: Mean class 0 probability for touched vertices: 0.0936
\nDEBUG: Checking for views with high background predictions...
  Front: (see above for stats)
  Bottom: (see above for stats)
  Top: (see above for stats)
  Right: (see above for stats)
  Back: (see above for stats)
  Left: (see above for stats)
DEBUG: After normalization, P sums check: min=0.0000, max=1.0000
DEBUG: Predicted class distribution (before -1 shift):
  Class 0: 39165 vertices (30.7%)
  Class 29: 9208 vertices (7.2%)
  Class 28: 6437 vertices (5.1%)
  Class 30: 5508 vertices (4.3%)
  Class 25: 5232 vertices (4.1%)
  Class 12: 5060 vertices (4.0%)
  Class 31: 4577 vertices (3.6%)
  Class 9: 4403 vertices (3.5%)
  Class 23: 4326 vertices (3.4%)
  Class 10: 3850 vertices (3.0%)
DEBUG: Background predicted: 39165 (30.7%)
DEBUG: Foreground predicted: 88222 (69.3%)
Labels aggregated!
  ‚úì Aggregation complete
  ‚úì Prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-14/pred_7625119
  Loaded P matrix: (37, 127387), vertices: 127387
  Mesh: 127387 vertices, 254770 faces
  Step 1: Smoothing probabilities (20 iter, Œ±=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ‚úì Smoothing complete
  Step 2: MRF refinement (Œ≤=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ‚úì MRF refinement complete

  RESULTS:
  RAW:         median(top-10)=0.7900, mean(top-10)=0.7919, median(all)=0.6807, mean(all)=0.5965
  + SMOOTHING: median(top-10)=0.8669, mean(top-10)=0.8703, median(all)=0.7996, mean(all)=0.7083 [+0.0769]
  + MRF:       median(top-10)=0.8669, mean(top-10)=0.8708, median(all)=0.7997, mean(all)=0.7085 [-0.0000]
  TOTAL IMPROVEMENT (median top-10): +0.0769

================================================================================
Subject: MMRR-21-15
================================================================================
  Step 0: Generating predictions with NEW models...
  Using PyTorch3D GPU raycasting (matching training pipeline)...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 137028 vertices, 274052 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (36305 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (90305 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (83430 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (57339 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (37026 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (60830 valid pixels)
  [PyTorch3D] Raycasting complete!
  ‚úì Got 6 output maps, shape: (6, 800, 800, 3)
  Loading trained models...
Loading models...
  Loading Front: Front-epoch=499-validation_loss=0.03.ckpt
  Loading Bottom: Bottom-epoch=499-validation_loss=0.04.ckpt
  Loading Top: Top-epoch=499-validation_loss=0.05.ckpt
  Loading Right: Right-epoch=499-validation_loss=0.04.ckpt
  Loading Back: Back-epoch=499-validation_loss=0.03.ckpt
  Loading Left: Left-epoch=499-validation_loss=0.03.ckpt
Models loaded!
  Running U-Net predictions on 6 views...
Predicting labels...
Labels predicted!
  ‚úì Got predictions from 6 views
  Aggregating predictions to vertices...
Agregating predicted labels...

üîç View 0: 2D predictions for 36305 MESH pixels (before aggregation):
   Class 12: 12122 pixels (33.4%)
   Class 30: 8079 pixels (22.3%)
   Class 9: 5732 pixels (15.8%)
   Class 10: 1853 pixels (5.1%)
   Class 16: 1388 pixels (3.8%)
   ‚Üí Background: 0.1% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0013
   ‚Üí Pixels where class 0 prob > 0.5: 20 (0.1%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9990
   ‚Üí Weights for vertex 0: mean=0.3341, max=0.9969
   ‚Üí Weights for vertex 1: mean=0.3338, max=0.9990
   ‚Üí Weights for vertex 2: mean=0.3324, max=0.9953
   ‚Üí Weights sum to 1? 1.0003

üîç View 1: 2D predictions for 90305 MESH pixels (before aggregation):
   Class 0: 18385 pixels (20.4%)
   Class 29: 16736 pixels (18.5%)
   Class 26: 10642 pixels (11.8%)
   Class 14: 6831 pixels (7.6%)
   Class 15: 4911 pixels (5.4%)
   ‚Üí Background: 20.4% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.2006
   ‚Üí Pixels where class 0 prob > 0.5: 18257 (20.2%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9992

üîç View 2: 2D predictions for 83430 MESH pixels (before aggregation):
   Class 28: 8549 pixels (10.2%)
   Class 9: 7780 pixels (9.3%)
   Class 12: 6925 pixels (8.3%)
   Class 31: 6858 pixels (8.2%)
   Class 16: 6006 pixels (7.2%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0001
   ‚Üí Pixels where class 0 prob > 0.5: 1 (0.0%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9966
DEBUG: Processed 11520000 total pixels, 1095705 valid pixels (9.5%)
DEBUG: Touched 96753.0 vertices out of 137028 (70.6%)
DEBUG: Vertices with zero probability sum: 40275 (29.4%)
DEBUG: Mean class 0 probability for touched vertices: 0.0783
\nDEBUG: Checking for views with high background predictions...
  Front: (see above for stats)
  Bottom: (see above for stats)
  Top: (see above for stats)
  Right: (see above for stats)
  Back: (see above for stats)
  Left: (see above for stats)
DEBUG: After normalization, P sums check: min=0.0000, max=1.0000
DEBUG: Predicted class distribution (before -1 shift):
  Class 0: 45700 vertices (33.4%)
  Class 29: 9826 vertices (7.2%)
  Class 12: 6673 vertices (4.9%)
  Class 28: 6527 vertices (4.8%)
  Class 30: 5716 vertices (4.2%)
  Class 9: 4932 vertices (3.6%)
  Class 14: 4325 vertices (3.2%)
  Class 25: 4303 vertices (3.1%)
  Class 26: 3927 vertices (2.9%)
  Class 23: 3640 vertices (2.7%)
DEBUG: Background predicted: 45700 (33.4%)
DEBUG: Foreground predicted: 91328 (66.6%)
Labels aggregated!
  ‚úì Aggregation complete
  ‚úì Prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-15/pred_7625119
  Loaded P matrix: (37, 137028), vertices: 137028
  Mesh: 137028 vertices, 274052 faces
  Step 1: Smoothing probabilities (20 iter, Œ±=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ‚úì Smoothing complete
  Step 2: MRF refinement (Œ≤=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
    MRF iteration 5/5...
  ‚úì MRF refinement complete

  RESULTS:
  RAW:         median(top-10)=0.7646, mean(top-10)=0.7791, median(all)=0.6898, mean(all)=0.6079
  + SMOOTHING: median(top-10)=0.8911, mean(top-10)=0.8910, median(all)=0.8166, mean(all)=0.7386 [+0.1265]
  + MRF:       median(top-10)=0.8916, mean(top-10)=0.8916, median(all)=0.8169, mean(all)=0.7388 [+0.0005]
  TOTAL IMPROVEMENT (median top-10): +0.1270

================================================================================
Subject: MMRR-21-16
================================================================================
  Step 0: Generating predictions with NEW models...
  Using PyTorch3D GPU raycasting (matching training pipeline)...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 147500 vertices, 294996 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (40557 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (93518 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (86953 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (58863 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (38920 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (62272 valid pixels)
  [PyTorch3D] Raycasting complete!
  ‚úì Got 6 output maps, shape: (6, 800, 800, 3)
  Loading trained models...
Loading models...
  Loading Front: Front-epoch=499-validation_loss=0.03.ckpt
  Loading Bottom: Bottom-epoch=499-validation_loss=0.04.ckpt
  Loading Top: Top-epoch=499-validation_loss=0.05.ckpt
  Loading Right: Right-epoch=499-validation_loss=0.04.ckpt
  Loading Back: Back-epoch=499-validation_loss=0.03.ckpt
  Loading Left: Left-epoch=499-validation_loss=0.03.ckpt
Models loaded!
  Running U-Net predictions on 6 views...
Predicting labels...
Labels predicted!
  ‚úì Got predictions from 6 views
  Aggregating predictions to vertices...
Agregating predicted labels...

üîç View 0: 2D predictions for 40557 MESH pixels (before aggregation):
   Class 12: 11910 pixels (29.4%)
   Class 9: 8409 pixels (20.7%)
   Class 30: 7539 pixels (18.6%)
   Class 10: 2460 pixels (6.1%)
   Class 32: 1940 pixels (4.8%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0003
   ‚Üí Pixels where class 0 prob > 0.5: 0 (0.0%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9959
   ‚Üí Weights for vertex 0: mean=0.3333, max=0.9953
   ‚Üí Weights for vertex 1: mean=0.3324, max=0.9908
   ‚Üí Weights for vertex 2: mean=0.3347, max=0.9959
   ‚Üí Weights sum to 1? 1.0003

üîç View 1: 2D predictions for 93518 MESH pixels (before aggregation):
   Class 0: 19954 pixels (21.3%)
   Class 29: 18230 pixels (19.5%)
   Class 26: 9402 pixels (10.1%)
   Class 15: 7112 pixels (7.6%)
   Class 14: 5751 pixels (6.1%)
   ‚Üí Background: 21.3% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.2131
   ‚Üí Pixels where class 0 prob > 0.5: 19865 (21.2%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9989

üîç View 2: 2D predictions for 86953 MESH pixels (before aggregation):
   Class 28: 10539 pixels (12.1%)
   Class 9: 7984 pixels (9.2%)
   Class 12: 7127 pixels (8.2%)
   Class 16: 6529 pixels (7.5%)
   Class 25: 5768 pixels (6.6%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0000
   ‚Üí Pixels where class 0 prob > 0.5: 1 (0.0%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9977
DEBUG: Processed 11520000 total pixels, 1143249 valid pixels (9.9%)
DEBUG: Touched 104726.0 vertices out of 147500 (71.0%)
DEBUG: Vertices with zero probability sum: 42774 (29.0%)
DEBUG: Mean class 0 probability for touched vertices: 0.0877
\nDEBUG: Checking for views with high background predictions...
  Front: (see above for stats)
  Bottom: (see above for stats)
  Top: (see above for stats)
  Right: (see above for stats)
  Back: (see above for stats)
  Left: (see above for stats)
DEBUG: After normalization, P sums check: min=0.0000, max=1.0000
DEBUG: Predicted class distribution (before -1 shift):
  Class 0: 49269 vertices (33.4%)
  Class 29: 10613 vertices (7.2%)
  Class 28: 8501 vertices (5.8%)
  Class 12: 6564 vertices (4.5%)
  Class 9: 5823 vertices (3.9%)
  Class 30: 5215 vertices (3.5%)
  Class 25: 4860 vertices (3.3%)
  Class 23: 4087 vertices (2.8%)
  Class 10: 4070 vertices (2.8%)
  Class 14: 3908 vertices (2.6%)
DEBUG: Background predicted: 49269 (33.4%)
DEBUG: Foreground predicted: 98231 (66.6%)
Labels aggregated!
  ‚úì Aggregation complete
  ‚úì Prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-16/pred_7625119
  Loaded P matrix: (37, 147500), vertices: 147500
  Mesh: 147500 vertices, 294996 faces
  Step 1: Smoothing probabilities (20 iter, Œ±=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ‚úì Smoothing complete
  Step 2: MRF refinement (Œ≤=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ‚úì MRF refinement complete

  RESULTS:
  RAW:         median(top-10)=0.7843, mean(top-10)=0.7738, median(all)=0.6839, mean(all)=0.5991
  + SMOOTHING: median(top-10)=0.8872, mean(top-10)=0.8856, median(all)=0.7900, mean(all)=0.7256 [+0.1029]
  + MRF:       median(top-10)=0.8874, mean(top-10)=0.8857, median(all)=0.7901, mean(all)=0.7258 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.1031

================================================================================
Subject: MMRR-21-17
================================================================================
  Step 0: Generating predictions with NEW models...
  Using PyTorch3D GPU raycasting (matching training pipeline)...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 126138 vertices, 252272 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (45826 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (102759 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (94668 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (62077 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (44356 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (67469 valid pixels)
  [PyTorch3D] Raycasting complete!
  ‚úì Got 6 output maps, shape: (6, 800, 800, 3)
  Loading trained models...
Loading models...
  Loading Front: Front-epoch=499-validation_loss=0.03.ckpt
  Loading Bottom: Bottom-epoch=499-validation_loss=0.04.ckpt
  Loading Top: Top-epoch=499-validation_loss=0.05.ckpt
  Loading Right: Right-epoch=499-validation_loss=0.04.ckpt
  Loading Back: Back-epoch=499-validation_loss=0.03.ckpt
  Loading Left: Left-epoch=499-validation_loss=0.03.ckpt
Models loaded!
  Running U-Net predictions on 6 views...
Predicting labels...
Labels predicted!
  ‚úì Got predictions from 6 views
  Aggregating predictions to vertices...
Agregating predicted labels...

üîç View 0: 2D predictions for 45826 MESH pixels (before aggregation):
   Class 12: 13067 pixels (28.5%)
   Class 30: 11970 pixels (26.1%)
   Class 9: 6438 pixels (14.0%)
   Class 23: 3158 pixels (6.9%)
   Class 32: 2967 pixels (6.5%)
   ‚Üí Background: 0.8% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0081
   ‚Üí Pixels where class 0 prob > 0.5: 331 (0.7%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9989
   ‚Üí Weights for vertex 0: mean=0.3327, max=0.9975
   ‚Üí Weights for vertex 1: mean=0.3340, max=0.9989
   ‚Üí Weights for vertex 2: mean=0.3336, max=0.9977
   ‚Üí Weights sum to 1? 1.0003

üîç View 1: 2D predictions for 102759 MESH pixels (before aggregation):
   Class 0: 22065 pixels (21.5%)
   Class 29: 18841 pixels (18.3%)
   Class 26: 11505 pixels (11.2%)
   Class 15: 5853 pixels (5.7%)
   Class 18: 5531 pixels (5.4%)
   ‚Üí Background: 21.5% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.2138
   ‚Üí Pixels where class 0 prob > 0.5: 21950 (21.4%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=1.0000

üîç View 2: 2D predictions for 94668 MESH pixels (before aggregation):
   Class 28: 10470 pixels (11.1%)
   Class 31: 9536 pixels (10.1%)
   Class 32: 7289 pixels (7.7%)
   Class 16: 7239 pixels (7.6%)
   Class 12: 6988 pixels (7.4%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0000
   ‚Üí Pixels where class 0 prob > 0.5: 0 (0.0%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9987
DEBUG: Processed 11520000 total pixels, 1251465 valid pixels (10.9%)
DEBUG: Touched 96328.0 vertices out of 126138 (76.4%)
DEBUG: Vertices with zero probability sum: 29810 (23.6%)
DEBUG: Mean class 0 probability for touched vertices: 0.1057
\nDEBUG: Checking for views with high background predictions...
  Front: (see above for stats)
  Bottom: (see above for stats)
  Top: (see above for stats)
  Right: (see above for stats)
  Back: (see above for stats)
  Left: (see above for stats)
DEBUG: After normalization, P sums check: min=0.0000, max=1.0000
DEBUG: Predicted class distribution (before -1 shift):
  Class 0: 36767 vertices (29.1%)
  Class 29: 9029 vertices (7.2%)
  Class 28: 7395 vertices (5.9%)
  Class 12: 6194 vertices (4.9%)
  Class 30: 5912 vertices (4.7%)
  Class 31: 4296 vertices (3.4%)
  Class 32: 4050 vertices (3.2%)
  Class 9: 3855 vertices (3.1%)
  Class 25: 3804 vertices (3.0%)
  Class 8: 3701 vertices (2.9%)
DEBUG: Background predicted: 36767 (29.1%)
DEBUG: Foreground predicted: 89371 (70.9%)
Labels aggregated!
  ‚úì Aggregation complete
  ‚úì Prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-17/pred_7625119
  Loaded P matrix: (37, 126138), vertices: 126138
  Mesh: 126138 vertices, 252272 faces
  Step 1: Smoothing probabilities (20 iter, Œ±=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ‚úì Smoothing complete
  Step 2: MRF refinement (Œ≤=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ‚úì MRF refinement complete

  RESULTS:
  RAW:         median(top-10)=0.7904, mean(top-10)=0.7993, median(all)=0.7233, mean(all)=0.6246
  + SMOOTHING: median(top-10)=0.8874, mean(top-10)=0.8894, median(all)=0.8180, mean(all)=0.7380 [+0.0970]
  + MRF:       median(top-10)=0.8875, mean(top-10)=0.8896, median(all)=0.8183, mean(all)=0.7382 [+0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0971

================================================================================
Subject: MMRR-21-18
================================================================================
  Step 0: Generating predictions with NEW models...
  Using PyTorch3D GPU raycasting (matching training pipeline)...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 131379 vertices, 262754 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (42260 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (92118 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (84982 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (62715 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (41126 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (66753 valid pixels)
  [PyTorch3D] Raycasting complete!
  ‚úì Got 6 output maps, shape: (6, 800, 800, 3)
  Loading trained models...
Loading models...
  Loading Front: Front-epoch=499-validation_loss=0.03.ckpt
  Loading Bottom: Bottom-epoch=499-validation_loss=0.04.ckpt
  Loading Top: Top-epoch=499-validation_loss=0.05.ckpt
  Loading Right: Right-epoch=499-validation_loss=0.04.ckpt
  Loading Back: Back-epoch=499-validation_loss=0.03.ckpt
  Loading Left: Left-epoch=499-validation_loss=0.03.ckpt
Models loaded!
  Running U-Net predictions on 6 views...
Predicting labels...
Labels predicted!
  ‚úì Got predictions from 6 views
  Aggregating predictions to vertices...
Agregating predicted labels...

üîç View 0: 2D predictions for 42260 MESH pixels (before aggregation):
   Class 30: 11059 pixels (26.2%)
   Class 12: 10232 pixels (24.2%)
   Class 9: 7013 pixels (16.6%)
   Class 23: 2272 pixels (5.4%)
   Class 10: 2264 pixels (5.4%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0003
   ‚Üí Pixels where class 0 prob > 0.5: 2 (0.0%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9974
   ‚Üí Weights for vertex 0: mean=0.3344, max=0.9974
   ‚Üí Weights for vertex 1: mean=0.3329, max=0.9971
   ‚Üí Weights for vertex 2: mean=0.3330, max=0.9960
   ‚Üí Weights sum to 1? 1.0003

üîç View 1: 2D predictions for 92118 MESH pixels (before aggregation):
   Class 0: 21375 pixels (23.2%)
   Class 29: 15187 pixels (16.5%)
   Class 26: 8725 pixels (9.5%)
   Class 14: 6914 pixels (7.5%)
   Class 15: 5991 pixels (6.5%)
   ‚Üí Background: 23.2% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.2304
   ‚Üí Pixels where class 0 prob > 0.5: 21233 (23.0%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9993

üîç View 2: 2D predictions for 84982 MESH pixels (before aggregation):
   Class 28: 10843 pixels (12.8%)
   Class 16: 7856 pixels (9.2%)
   Class 23: 7162 pixels (8.4%)
   Class 9: 7016 pixels (8.3%)
   Class 32: 5856 pixels (6.9%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0001
   ‚Üí Pixels where class 0 prob > 0.5: 3 (0.0%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9996
DEBUG: Processed 11520000 total pixels, 1169862 valid pixels (10.2%)
DEBUG: Touched 94664.0 vertices out of 131379 (72.1%)
DEBUG: Vertices with zero probability sum: 36715 (27.9%)
DEBUG: Mean class 0 probability for touched vertices: 0.0878
\nDEBUG: Checking for views with high background predictions...
  Front: (see above for stats)
  Bottom: (see above for stats)
  Top: (see above for stats)
  Right: (see above for stats)
  Back: (see above for stats)
  Left: (see above for stats)
DEBUG: After normalization, P sums check: min=0.0000, max=1.0000
DEBUG: Predicted class distribution (before -1 shift):
  Class 0: 42651 vertices (32.5%)
  Class 29: 8730 vertices (6.6%)
  Class 28: 7900 vertices (6.0%)
  Class 30: 5784 vertices (4.4%)
  Class 12: 5210 vertices (4.0%)
  Class 23: 4559 vertices (3.5%)
  Class 9: 4545 vertices (3.5%)
  Class 25: 4514 vertices (3.4%)
  Class 10: 4001 vertices (3.0%)
  Class 16: 3808 vertices (2.9%)
DEBUG: Background predicted: 42651 (32.5%)
DEBUG: Foreground predicted: 88728 (67.5%)
Labels aggregated!
  ‚úì Aggregation complete
  ‚úì Prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-18/pred_7625119
  Loaded P matrix: (37, 131379), vertices: 131379
  Mesh: 131379 vertices, 262754 faces
  Step 1: Smoothing probabilities (20 iter, Œ±=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ‚úì Smoothing complete
  Step 2: MRF refinement (Œ≤=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
    MRF iteration 5/5...
  ‚úì MRF refinement complete

  RESULTS:
  RAW:         median(top-10)=0.7900, mean(top-10)=0.7958, median(all)=0.6738, mean(all)=0.6023
  + SMOOTHING: median(top-10)=0.8791, mean(top-10)=0.8804, median(all)=0.8105, mean(all)=0.7272 [+0.0891]
  + MRF:       median(top-10)=0.8792, mean(top-10)=0.8808, median(all)=0.8104, mean(all)=0.7276 [+0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0892

================================================================================
Subject: MMRR-21-19
================================================================================
  Step 0: Generating predictions with NEW models...
  Using PyTorch3D GPU raycasting (matching training pipeline)...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 145253 vertices, 290502 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (51928 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (105292 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (97397 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (68573 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (47572 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (71543 valid pixels)
  [PyTorch3D] Raycasting complete!
  ‚úì Got 6 output maps, shape: (6, 800, 800, 3)
  Loading trained models...
Loading models...
  Loading Front: Front-epoch=499-validation_loss=0.03.ckpt
  Loading Bottom: Bottom-epoch=499-validation_loss=0.04.ckpt
  Loading Top: Top-epoch=499-validation_loss=0.05.ckpt
  Loading Right: Right-epoch=499-validation_loss=0.04.ckpt
  Loading Back: Back-epoch=499-validation_loss=0.03.ckpt
  Loading Left: Left-epoch=499-validation_loss=0.03.ckpt
Models loaded!
  Running U-Net predictions on 6 views...
Predicting labels...
Labels predicted!
  ‚úì Got predictions from 6 views
  Aggregating predictions to vertices...
Agregating predicted labels...

üîç View 0: 2D predictions for 51928 MESH pixels (before aggregation):
   Class 30: 13968 pixels (26.9%)
   Class 9: 12627 pixels (24.3%)
   Class 12: 10344 pixels (19.9%)
   Class 23: 2911 pixels (5.6%)
   Class 26: 2755 pixels (5.3%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0006
   ‚Üí Pixels where class 0 prob > 0.5: 4 (0.0%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9992
   ‚Üí Weights for vertex 0: mean=0.3340, max=0.9929
   ‚Üí Weights for vertex 1: mean=0.3335, max=0.9992
   ‚Üí Weights for vertex 2: mean=0.3329, max=0.9981
   ‚Üí Weights sum to 1? 1.0004

üîç View 1: 2D predictions for 105292 MESH pixels (before aggregation):
   Class 29: 22248 pixels (21.1%)
   Class 0: 20224 pixels (19.2%)
   Class 26: 11995 pixels (11.4%)
   Class 14: 6947 pixels (6.6%)
   Class 18: 5455 pixels (5.2%)
   ‚Üí Background: 19.2% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.1888
   ‚Üí Pixels where class 0 prob > 0.5: 19924 (18.9%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9993

üîç View 2: 2D predictions for 97397 MESH pixels (before aggregation):
   Class 9: 10279 pixels (10.6%)
   Class 28: 10132 pixels (10.4%)
   Class 31: 9250 pixels (9.5%)
   Class 12: 6722 pixels (6.9%)
   Class 32: 6633 pixels (6.8%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0000
   ‚Üí Pixels where class 0 prob > 0.5: 1 (0.0%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=1.0005
DEBUG: Processed 11520000 total pixels, 1326915 valid pixels (11.5%)
DEBUG: Touched 106032.0 vertices out of 145253 (73.0%)
DEBUG: Vertices with zero probability sum: 39221 (27.0%)
DEBUG: Mean class 0 probability for touched vertices: 0.0961
\nDEBUG: Checking for views with high background predictions...
  Front: (see above for stats)
  Bottom: (see above for stats)
  Top: (see above for stats)
  Right: (see above for stats)
  Back: (see above for stats)
  Left: (see above for stats)
DEBUG: After normalization, P sums check: min=0.0000, max=1.0000
DEBUG: Predicted class distribution (before -1 shift):
  Class 0: 46105 vertices (31.7%)
  Class 29: 11800 vertices (8.1%)
  Class 9: 6897 vertices (4.7%)
  Class 28: 6846 vertices (4.7%)
  Class 30: 6361 vertices (4.4%)
  Class 12: 5737 vertices (3.9%)
  Class 10: 4787 vertices (3.3%)
  Class 8: 4641 vertices (3.2%)
  Class 25: 4623 vertices (3.2%)
  Class 31: 4380 vertices (3.0%)
DEBUG: Background predicted: 46105 (31.7%)
DEBUG: Foreground predicted: 99148 (68.3%)
Labels aggregated!
  ‚úì Aggregation complete
  ‚úì Prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-19/pred_7625119
  Loaded P matrix: (37, 145253), vertices: 145253
  Mesh: 145253 vertices, 290502 faces
  Step 1: Smoothing probabilities (20 iter, Œ±=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ‚úì Smoothing complete
  Step 2: MRF refinement (Œ≤=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ‚úì MRF refinement complete

  RESULTS:
  RAW:         median(top-10)=0.7813, mean(top-10)=0.7871, median(all)=0.6645, mean(all)=0.6052
  + SMOOTHING: median(top-10)=0.8643, mean(top-10)=0.8702, median(all)=0.8003, mean(all)=0.7226 [+0.0830]
  + MRF:       median(top-10)=0.8644, mean(top-10)=0.8703, median(all)=0.8012, mean(all)=0.7232 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0831

================================================================================
Subject: MMRR-21-2
================================================================================
  Step 0: Generating predictions with NEW models...
  Using PyTorch3D GPU raycasting (matching training pipeline)...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 148593 vertices, 297182 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (42385 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (102060 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (95048 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (62600 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (42580 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (66044 valid pixels)
  [PyTorch3D] Raycasting complete!
  ‚úì Got 6 output maps, shape: (6, 800, 800, 3)
  Loading trained models...
Loading models...
  Loading Front: Front-epoch=499-validation_loss=0.03.ckpt
  Loading Bottom: Bottom-epoch=499-validation_loss=0.04.ckpt
  Loading Top: Top-epoch=499-validation_loss=0.05.ckpt
  Loading Right: Right-epoch=499-validation_loss=0.04.ckpt
  Loading Back: Back-epoch=499-validation_loss=0.03.ckpt
  Loading Left: Left-epoch=499-validation_loss=0.03.ckpt
Models loaded!
  Running U-Net predictions on 6 views...
Predicting labels...
Labels predicted!
  ‚úì Got predictions from 6 views
  Aggregating predictions to vertices...
Agregating predicted labels...

üîç View 0: 2D predictions for 42385 MESH pixels (before aggregation):
   Class 12: 12209 pixels (28.8%)
   Class 30: 10834 pixels (25.6%)
   Class 9: 6961 pixels (16.4%)
   Class 10: 2148 pixels (5.1%)
   Class 32: 1886 pixels (4.4%)
   ‚Üí Background: 0.8% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0077
   ‚Üí Pixels where class 0 prob > 0.5: 343 (0.8%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9967
   ‚Üí Weights for vertex 0: mean=0.3345, max=0.9967
   ‚Üí Weights for vertex 1: mean=0.3330, max=0.9956
   ‚Üí Weights for vertex 2: mean=0.3328, max=0.9926
   ‚Üí Weights sum to 1? 1.0003

üîç View 1: 2D predictions for 102060 MESH pixels (before aggregation):
   Class 0: 21603 pixels (21.2%)
   Class 29: 18610 pixels (18.2%)
   Class 26: 10280 pixels (10.1%)
   Class 14: 7691 pixels (7.5%)
   Class 15: 6001 pixels (5.9%)
   ‚Üí Background: 21.2% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.2091
   ‚Üí Pixels where class 0 prob > 0.5: 21485 (21.1%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9991

üîç View 2: 2D predictions for 95048 MESH pixels (before aggregation):
   Class 28: 9633 pixels (10.1%)
   Class 25: 8394 pixels (8.8%)
   Class 31: 7279 pixels (7.7%)
   Class 16: 7270 pixels (7.6%)
   Class 9: 6835 pixels (7.2%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0001
   ‚Üí Pixels where class 0 prob > 0.5: 1 (0.0%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9999
DEBUG: Processed 11520000 total pixels, 1232151 valid pixels (10.7%)
DEBUG: Touched 103496.0 vertices out of 148593 (69.7%)
DEBUG: Vertices with zero probability sum: 45097 (30.3%)
DEBUG: Mean class 0 probability for touched vertices: 0.0928
\nDEBUG: Checking for views with high background predictions...
  Front: (see above for stats)
  Bottom: (see above for stats)
  Top: (see above for stats)
  Right: (see above for stats)
  Back: (see above for stats)
  Left: (see above for stats)
DEBUG: After normalization, P sums check: min=0.0000, max=1.0000
DEBUG: Predicted class distribution (before -1 shift):
  Class 0: 51516 vertices (34.7%)
  Class 29: 9808 vertices (6.6%)
  Class 28: 7287 vertices (4.9%)
  Class 30: 6939 vertices (4.7%)
  Class 12: 6039 vertices (4.1%)
  Class 25: 5817 vertices (3.9%)
  Class 10: 4847 vertices (3.3%)
  Class 9: 4529 vertices (3.0%)
  Class 23: 4308 vertices (2.9%)
  Class 14: 4078 vertices (2.7%)
DEBUG: Background predicted: 51516 (34.7%)
DEBUG: Foreground predicted: 97077 (65.3%)
Labels aggregated!
  ‚úì Aggregation complete
  ‚úì Prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-2/pred_7625119
  Loaded P matrix: (37, 148593), vertices: 148593
  Mesh: 148593 vertices, 297182 faces
  Step 1: Smoothing probabilities (20 iter, Œ±=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ‚úì Smoothing complete
  Step 2: MRF refinement (Œ≤=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ‚úì MRF refinement complete

  RESULTS:
  RAW:         median(top-10)=0.7699, mean(top-10)=0.7736, median(all)=0.6687, mean(all)=0.5998
  + SMOOTHING: median(top-10)=0.8793, mean(top-10)=0.8795, median(all)=0.8253, mean(all)=0.7415 [+0.1094]
  + MRF:       median(top-10)=0.8795, mean(top-10)=0.8800, median(all)=0.8255, mean(all)=0.7418 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.1097

================================================================================
Subject: MMRR-21-20
================================================================================
  Step 0: Generating predictions with NEW models...
  Using PyTorch3D GPU raycasting (matching training pipeline)...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 149927 vertices, 299850 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (36611 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (95169 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (88213 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (53954 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (38415 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (58097 valid pixels)
  [PyTorch3D] Raycasting complete!
  ‚úì Got 6 output maps, shape: (6, 800, 800, 3)
  Loading trained models...
Loading models...
  Loading Front: Front-epoch=499-validation_loss=0.03.ckpt
  Loading Bottom: Bottom-epoch=499-validation_loss=0.04.ckpt
  Loading Top: Top-epoch=499-validation_loss=0.05.ckpt
  Loading Right: Right-epoch=499-validation_loss=0.04.ckpt
  Loading Back: Back-epoch=499-validation_loss=0.03.ckpt
  Loading Left: Left-epoch=499-validation_loss=0.03.ckpt
Models loaded!
  Running U-Net predictions on 6 views...
Predicting labels...
Labels predicted!
  ‚úì Got predictions from 6 views
  Aggregating predictions to vertices...
Agregating predicted labels...

üîç View 0: 2D predictions for 36611 MESH pixels (before aggregation):
   Class 12: 11346 pixels (31.0%)
   Class 30: 6044 pixels (16.5%)
   Class 9: 5570 pixels (15.2%)
   Class 10: 2124 pixels (5.8%)
   Class 16: 1628 pixels (4.4%)
   ‚Üí Background: 1.4% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0132
   ‚Üí Pixels where class 0 prob > 0.5: 478 (1.3%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9978
   ‚Üí Weights for vertex 0: mean=0.3347, max=0.9939
   ‚Üí Weights for vertex 1: mean=0.3328, max=0.9954
   ‚Üí Weights for vertex 2: mean=0.3328, max=0.9978
   ‚Üí Weights sum to 1? 1.0003

üîç View 1: 2D predictions for 95169 MESH pixels (before aggregation):
   Class 29: 18993 pixels (20.0%)
   Class 0: 18336 pixels (19.3%)
   Class 26: 9968 pixels (10.5%)
   Class 15: 6921 pixels (7.3%)
   Class 14: 6215 pixels (6.5%)
   ‚Üí Background: 19.3% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.1893
   ‚Üí Pixels where class 0 prob > 0.5: 18231 (19.2%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9975

üîç View 2: 2D predictions for 88213 MESH pixels (before aggregation):
   Class 28: 11091 pixels (12.6%)
   Class 9: 7696 pixels (8.7%)
   Class 12: 7109 pixels (8.1%)
   Class 31: 6832 pixels (7.7%)
   Class 32: 6705 pixels (7.6%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0001
   ‚Üí Pixels where class 0 prob > 0.5: 1 (0.0%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=1.0003
DEBUG: Processed 11520000 total pixels, 1111377 valid pixels (9.6%)
DEBUG: Touched 105025.0 vertices out of 149927 (70.1%)
DEBUG: Vertices with zero probability sum: 44902 (29.9%)
DEBUG: Mean class 0 probability for touched vertices: 0.0838
\nDEBUG: Checking for views with high background predictions...
  Front: (see above for stats)
  Bottom: (see above for stats)
  Top: (see above for stats)
  Right: (see above for stats)
  Back: (see above for stats)
  Left: (see above for stats)
DEBUG: After normalization, P sums check: min=0.0000, max=1.0000
DEBUG: Predicted class distribution (before -1 shift):
  Class 0: 50938 vertices (34.0%)
  Class 29: 10355 vertices (6.9%)
  Class 28: 8484 vertices (5.7%)
  Class 12: 6747 vertices (4.5%)
  Class 30: 5818 vertices (3.9%)
  Class 25: 4884 vertices (3.3%)
  Class 9: 4874 vertices (3.3%)
  Class 10: 4377 vertices (2.9%)
  Class 26: 4274 vertices (2.9%)
  Class 8: 4195 vertices (2.8%)
DEBUG: Background predicted: 50938 (34.0%)
DEBUG: Foreground predicted: 98989 (66.0%)
Labels aggregated!
  ‚úì Aggregation complete
  ‚úì Prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-20/pred_7625119
  Loaded P matrix: (37, 149927), vertices: 149927
  Mesh: 149927 vertices, 299850 faces
  Step 1: Smoothing probabilities (20 iter, Œ±=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ‚úì Smoothing complete
  Step 2: MRF refinement (Œ≤=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ‚úì MRF refinement complete

  RESULTS:
  RAW:         median(top-10)=0.7740, mean(top-10)=0.7843, median(all)=0.6745, mean(all)=0.5968
  + SMOOTHING: median(top-10)=0.8788, mean(top-10)=0.8823, median(all)=0.8081, mean(all)=0.7306 [+0.1048]
  + MRF:       median(top-10)=0.8794, mean(top-10)=0.8825, median(all)=0.8081, mean(all)=0.7309 [+0.0006]
  TOTAL IMPROVEMENT (median top-10): +0.1054

================================================================================
Subject: MMRR-21-21
================================================================================
  Step 0: Generating predictions with NEW models...
  Using PyTorch3D GPU raycasting (matching training pipeline)...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 137496 vertices, 274988 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (47031 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (98307 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (90811 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (62835 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (46473 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (65724 valid pixels)
  [PyTorch3D] Raycasting complete!
  ‚úì Got 6 output maps, shape: (6, 800, 800, 3)
  Loading trained models...
Loading models...
  Loading Front: Front-epoch=499-validation_loss=0.03.ckpt
  Loading Bottom: Bottom-epoch=499-validation_loss=0.04.ckpt
  Loading Top: Top-epoch=499-validation_loss=0.05.ckpt
  Loading Right: Right-epoch=499-validation_loss=0.04.ckpt
  Loading Back: Back-epoch=499-validation_loss=0.03.ckpt
  Loading Left: Left-epoch=499-validation_loss=0.03.ckpt
Models loaded!
  Running U-Net predictions on 6 views...
Predicting labels...
Labels predicted!
  ‚úì Got predictions from 6 views
  Aggregating predictions to vertices...
Agregating predicted labels...

üîç View 0: 2D predictions for 47031 MESH pixels (before aggregation):
   Class 30: 11174 pixels (23.8%)
   Class 9: 10474 pixels (22.3%)
   Class 12: 9589 pixels (20.4%)
   Class 10: 2886 pixels (6.1%)
   Class 23: 2628 pixels (5.6%)
   ‚Üí Background: 0.1% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0008
   ‚Üí Pixels where class 0 prob > 0.5: 22 (0.0%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9979
   ‚Üí Weights for vertex 0: mean=0.3344, max=0.9979
   ‚Üí Weights for vertex 1: mean=0.3325, max=0.9945
   ‚Üí Weights for vertex 2: mean=0.3334, max=0.9954
   ‚Üí Weights sum to 1? 1.0003

üîç View 1: 2D predictions for 98307 MESH pixels (before aggregation):
   Class 29: 18988 pixels (19.3%)
   Class 0: 17725 pixels (18.0%)
   Class 26: 10578 pixels (10.8%)
   Class 15: 6535 pixels (6.6%)
   Class 18: 6478 pixels (6.6%)
   ‚Üí Background: 18.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.1766
   ‚Üí Pixels where class 0 prob > 0.5: 17556 (17.9%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9990

üîç View 2: 2D predictions for 90811 MESH pixels (before aggregation):
   Class 28: 11007 pixels (12.1%)
   Class 9: 9563 pixels (10.5%)
   Class 31: 8313 pixels (9.2%)
   Class 10: 6951 pixels (7.7%)
   Class 16: 6860 pixels (7.6%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0001
   ‚Üí Pixels where class 0 prob > 0.5: 0 (0.0%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9991
DEBUG: Processed 11520000 total pixels, 1233543 valid pixels (10.7%)
DEBUG: Touched 99223.0 vertices out of 137496 (72.2%)
DEBUG: Vertices with zero probability sum: 38273 (27.8%)
DEBUG: Mean class 0 probability for touched vertices: 0.0824
\nDEBUG: Checking for views with high background predictions...
  Front: (see above for stats)
  Bottom: (see above for stats)
  Top: (see above for stats)
  Right: (see above for stats)
  Back: (see above for stats)
  Left: (see above for stats)
DEBUG: After normalization, P sums check: min=0.0000, max=1.0000
DEBUG: Predicted class distribution (before -1 shift):
  Class 0: 43979 vertices (32.0%)
  Class 29: 9973 vertices (7.3%)
  Class 28: 7873 vertices (5.7%)
  Class 9: 5959 vertices (4.3%)
  Class 30: 5870 vertices (4.3%)
  Class 12: 5307 vertices (3.9%)
  Class 25: 4767 vertices (3.5%)
  Class 10: 4471 vertices (3.3%)
  Class 8: 4192 vertices (3.0%)
  Class 23: 4055 vertices (2.9%)
DEBUG: Background predicted: 43979 (32.0%)
DEBUG: Foreground predicted: 93517 (68.0%)
Labels aggregated!
  ‚úì Aggregation complete
  ‚úì Prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-21/pred_7625119
  Loaded P matrix: (37, 137496), vertices: 137496
  Mesh: 137496 vertices, 274988 faces
  Step 1: Smoothing probabilities (20 iter, Œ±=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ‚úì Smoothing complete
  Step 2: MRF refinement (Œ≤=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
    MRF iteration 5/5...
  ‚úì MRF refinement complete

  RESULTS:
  RAW:         median(top-10)=0.7458, mean(top-10)=0.7492, median(all)=0.6604, mean(all)=0.5758
  + SMOOTHING: median(top-10)=0.8614, mean(top-10)=0.8620, median(all)=0.7790, mean(all)=0.6879 [+0.1156]
  + MRF:       median(top-10)=0.8614, mean(top-10)=0.8626, median(all)=0.7796, mean(all)=0.6882 [+0.0000]
  TOTAL IMPROVEMENT (median top-10): +0.1156

================================================================================
Subject: MMRR-21-3
================================================================================
  Step 0: Generating predictions with NEW models...
  Using PyTorch3D GPU raycasting (matching training pipeline)...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 144159 vertices, 288314 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (41049 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (95902 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (88656 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (58779 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (41207 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (64155 valid pixels)
  [PyTorch3D] Raycasting complete!
  ‚úì Got 6 output maps, shape: (6, 800, 800, 3)
  Loading trained models...
Loading models...
  Loading Front: Front-epoch=499-validation_loss=0.03.ckpt
  Loading Bottom: Bottom-epoch=499-validation_loss=0.04.ckpt
  Loading Top: Top-epoch=499-validation_loss=0.05.ckpt
  Loading Right: Right-epoch=499-validation_loss=0.04.ckpt
  Loading Back: Back-epoch=499-validation_loss=0.03.ckpt
  Loading Left: Left-epoch=499-validation_loss=0.03.ckpt
Models loaded!
  Running U-Net predictions on 6 views...
Predicting labels...
Labels predicted!
  ‚úì Got predictions from 6 views
  Aggregating predictions to vertices...
Agregating predicted labels...

üîç View 0: 2D predictions for 41049 MESH pixels (before aggregation):
   Class 30: 10584 pixels (25.8%)
   Class 12: 9855 pixels (24.0%)
   Class 9: 7111 pixels (17.3%)
   Class 32: 2401 pixels (5.8%)
   Class 23: 2039 pixels (5.0%)
   ‚Üí Background: 1.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0097
   ‚Üí Pixels where class 0 prob > 0.5: 374 (0.9%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9984
   ‚Üí Weights for vertex 0: mean=0.3346, max=0.9943
   ‚Üí Weights for vertex 1: mean=0.3334, max=0.9984
   ‚Üí Weights for vertex 2: mean=0.3324, max=0.9981
   ‚Üí Weights sum to 1? 1.0004

üîç View 1: 2D predictions for 95902 MESH pixels (before aggregation):
   Class 29: 19734 pixels (20.6%)
   Class 0: 18915 pixels (19.7%)
   Class 26: 9877 pixels (10.3%)
   Class 14: 6764 pixels (7.1%)
   Class 15: 5259 pixels (5.5%)
   ‚Üí Background: 19.7% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.1941
   ‚Üí Pixels where class 0 prob > 0.5: 18813 (19.6%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9969

üîç View 2: 2D predictions for 88656 MESH pixels (before aggregation):
   Class 28: 9820 pixels (11.1%)
   Class 9: 8042 pixels (9.1%)
   Class 12: 7452 pixels (8.4%)
   Class 16: 6846 pixels (7.7%)
   Class 31: 6683 pixels (7.5%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0000
   ‚Üí Pixels where class 0 prob > 0.5: 0 (0.0%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9973
DEBUG: Processed 11520000 total pixels, 1169244 valid pixels (10.1%)
DEBUG: Touched 104731.0 vertices out of 144159 (72.6%)
DEBUG: Vertices with zero probability sum: 39428 (27.4%)
DEBUG: Mean class 0 probability for touched vertices: 0.0931
\nDEBUG: Checking for views with high background predictions...
  Front: (see above for stats)
  Bottom: (see above for stats)
  Top: (see above for stats)
  Right: (see above for stats)
  Back: (see above for stats)
  Left: (see above for stats)
DEBUG: After normalization, P sums check: min=0.0000, max=1.0000
DEBUG: Predicted class distribution (before -1 shift):
  Class 0: 46281 vertices (32.1%)
  Class 29: 10793 vertices (7.5%)
  Class 28: 8434 vertices (5.9%)
  Class 12: 6307 vertices (4.4%)
  Class 30: 5827 vertices (4.0%)
  Class 10: 4870 vertices (3.4%)
  Class 9: 4786 vertices (3.3%)
  Class 25: 4633 vertices (3.2%)
  Class 23: 4294 vertices (3.0%)
  Class 31: 4153 vertices (2.9%)
DEBUG: Background predicted: 46281 (32.1%)
DEBUG: Foreground predicted: 97878 (67.9%)
Labels aggregated!
  ‚úì Aggregation complete
  ‚úì Prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-3/pred_7625119
  Loaded P matrix: (37, 144159), vertices: 144159
  Mesh: 144159 vertices, 288314 faces
  Step 1: Smoothing probabilities (20 iter, Œ±=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ‚úì Smoothing complete
  Step 2: MRF refinement (Œ≤=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ‚úì MRF refinement complete

  RESULTS:
  RAW:         median(top-10)=0.7628, mean(top-10)=0.7701, median(all)=0.6972, mean(all)=0.6038
  + SMOOTHING: median(top-10)=0.8995, mean(top-10)=0.8908, median(all)=0.8176, mean(all)=0.7265 [+0.1367]
  + MRF:       median(top-10)=0.8999, mean(top-10)=0.8910, median(all)=0.8179, mean(all)=0.7266 [+0.0004]
  TOTAL IMPROVEMENT (median top-10): +0.1371

================================================================================
Subject: MMRR-21-4
================================================================================
  Step 0: Generating predictions with NEW models...
  Using PyTorch3D GPU raycasting (matching training pipeline)...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 118034 vertices, 236064 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (43440 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (97256 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (90207 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (60094 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (39125 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (63499 valid pixels)
  [PyTorch3D] Raycasting complete!
  ‚úì Got 6 output maps, shape: (6, 800, 800, 3)
  Loading trained models...
Loading models...
  Loading Front: Front-epoch=499-validation_loss=0.03.ckpt
  Loading Bottom: Bottom-epoch=499-validation_loss=0.04.ckpt
  Loading Top: Top-epoch=499-validation_loss=0.05.ckpt
  Loading Right: Right-epoch=499-validation_loss=0.04.ckpt
  Loading Back: Back-epoch=499-validation_loss=0.03.ckpt
  Loading Left: Left-epoch=499-validation_loss=0.03.ckpt
Models loaded!
  Running U-Net predictions on 6 views...
Predicting labels...
Labels predicted!
  ‚úì Got predictions from 6 views
  Aggregating predictions to vertices...
Agregating predicted labels...

üîç View 0: 2D predictions for 43440 MESH pixels (before aggregation):
   Class 12: 13609 pixels (31.3%)
   Class 30: 11312 pixels (26.0%)
   Class 9: 5809 pixels (13.4%)
   Class 23: 3117 pixels (7.2%)
   Class 32: 1948 pixels (4.5%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0008
   ‚Üí Pixels where class 0 prob > 0.5: 10 (0.0%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9982
   ‚Üí Weights for vertex 0: mean=0.3347, max=0.9959
   ‚Üí Weights for vertex 1: mean=0.3319, max=0.9982
   ‚Üí Weights for vertex 2: mean=0.3338, max=0.9936
   ‚Üí Weights sum to 1? 1.0003

üîç View 1: 2D predictions for 97256 MESH pixels (before aggregation):
   Class 0: 21392 pixels (22.0%)
   Class 29: 18682 pixels (19.2%)
   Class 26: 8430 pixels (8.7%)
   Class 14: 7652 pixels (7.9%)
   Class 18: 5723 pixels (5.9%)
   ‚Üí Background: 22.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.2187
   ‚Üí Pixels where class 0 prob > 0.5: 21314 (21.9%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9972

üîç View 2: 2D predictions for 90207 MESH pixels (before aggregation):
   Class 28: 9579 pixels (10.6%)
   Class 31: 7432 pixels (8.2%)
   Class 12: 6935 pixels (7.7%)
   Class 32: 6759 pixels (7.5%)
   Class 16: 6246 pixels (6.9%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0001
   ‚Üí Pixels where class 0 prob > 0.5: 3 (0.0%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9975
DEBUG: Processed 11520000 total pixels, 1180863 valid pixels (10.3%)
DEBUG: Touched 88733.0 vertices out of 118034 (75.2%)
DEBUG: Vertices with zero probability sum: 29301 (24.8%)
DEBUG: Mean class 0 probability for touched vertices: 0.1093
\nDEBUG: Checking for views with high background predictions...
  Front: (see above for stats)
  Bottom: (see above for stats)
  Top: (see above for stats)
  Right: (see above for stats)
  Back: (see above for stats)
  Left: (see above for stats)
DEBUG: After normalization, P sums check: min=0.0000, max=1.0000
DEBUG: Predicted class distribution (before -1 shift):
  Class 0: 35601 vertices (30.2%)
  Class 29: 8939 vertices (7.6%)
  Class 12: 6288 vertices (5.3%)
  Class 28: 6014 vertices (5.1%)
  Class 30: 5046 vertices (4.3%)
  Class 25: 4235 vertices (3.6%)
  Class 23: 4027 vertices (3.4%)
  Class 31: 3493 vertices (3.0%)
  Class 10: 3489 vertices (3.0%)
  Class 9: 3329 vertices (2.8%)
DEBUG: Background predicted: 35601 (30.2%)
DEBUG: Foreground predicted: 82433 (69.8%)
Labels aggregated!
  ‚úì Aggregation complete
  ‚úì Prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-4/pred_7625119
  Loaded P matrix: (37, 118034), vertices: 118034
  Mesh: 118034 vertices, 236064 faces
  Step 1: Smoothing probabilities (20 iter, Œ±=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ‚úì Smoothing complete
  Step 2: MRF refinement (Œ≤=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ‚úì MRF refinement complete

  RESULTS:
  RAW:         median(top-10)=0.8095, mean(top-10)=0.8066, median(all)=0.6965, mean(all)=0.6197
  + SMOOTHING: median(top-10)=0.8874, mean(top-10)=0.8843, median(all)=0.8073, mean(all)=0.7318 [+0.0778]
  + MRF:       median(top-10)=0.8878, mean(top-10)=0.8848, median(all)=0.8072, mean(all)=0.7319 [+0.0004]
  TOTAL IMPROVEMENT (median top-10): +0.0783

================================================================================
Subject: MMRR-21-5
================================================================================
  Step 0: Generating predictions with NEW models...
  Using PyTorch3D GPU raycasting (matching training pipeline)...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 145215 vertices, 290426 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (48001 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (106845 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (98217 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (66489 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (45026 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (70402 valid pixels)
  [PyTorch3D] Raycasting complete!
  ‚úì Got 6 output maps, shape: (6, 800, 800, 3)
  Loading trained models...
Loading models...
  Loading Front: Front-epoch=499-validation_loss=0.03.ckpt
  Loading Bottom: Bottom-epoch=499-validation_loss=0.04.ckpt
  Loading Top: Top-epoch=499-validation_loss=0.05.ckpt
  Loading Right: Right-epoch=499-validation_loss=0.04.ckpt
  Loading Back: Back-epoch=499-validation_loss=0.03.ckpt
  Loading Left: Left-epoch=499-validation_loss=0.03.ckpt
Models loaded!
  Running U-Net predictions on 6 views...
Predicting labels...
Labels predicted!
  ‚úì Got predictions from 6 views
  Aggregating predictions to vertices...
Agregating predicted labels...

üîç View 0: 2D predictions for 48001 MESH pixels (before aggregation):
   Class 30: 13355 pixels (27.8%)
   Class 12: 12307 pixels (25.6%)
   Class 9: 8891 pixels (18.5%)
   Class 32: 3157 pixels (6.6%)
   Class 23: 1924 pixels (4.0%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0003
   ‚Üí Pixels where class 0 prob > 0.5: 0 (0.0%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9970
   ‚Üí Weights for vertex 0: mean=0.3354, max=0.9970
   ‚Üí Weights for vertex 1: mean=0.3331, max=0.9970
   ‚Üí Weights for vertex 2: mean=0.3318, max=0.9941
   ‚Üí Weights sum to 1? 1.0003

üîç View 1: 2D predictions for 106845 MESH pixels (before aggregation):
   Class 0: 22370 pixels (20.9%)
   Class 29: 21765 pixels (20.4%)
   Class 26: 9579 pixels (9.0%)
   Class 15: 6806 pixels (6.4%)
   Class 18: 5477 pixels (5.1%)
   ‚Üí Background: 20.9% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.2090
   ‚Üí Pixels where class 0 prob > 0.5: 22267 (20.8%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9989

üîç View 2: 2D predictions for 98217 MESH pixels (before aggregation):
   Class 28: 10398 pixels (10.6%)
   Class 16: 8560 pixels (8.7%)
   Class 25: 8330 pixels (8.5%)
   Class 32: 7193 pixels (7.3%)
   Class 31: 7186 pixels (7.3%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0000
   ‚Üí Pixels where class 0 prob > 0.5: 1 (0.0%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9984
DEBUG: Processed 11520000 total pixels, 1304940 valid pixels (11.3%)
DEBUG: Touched 104953.0 vertices out of 145215 (72.3%)
DEBUG: Vertices with zero probability sum: 40262 (27.7%)
DEBUG: Mean class 0 probability for touched vertices: 0.0940
\nDEBUG: Checking for views with high background predictions...
  Front: (see above for stats)
  Bottom: (see above for stats)
  Top: (see above for stats)
  Right: (see above for stats)
  Back: (see above for stats)
  Left: (see above for stats)
DEBUG: After normalization, P sums check: min=0.0000, max=1.0000
DEBUG: Predicted class distribution (before -1 shift):
  Class 0: 47058 vertices (32.4%)
  Class 29: 10886 vertices (7.5%)
  Class 28: 6983 vertices (4.8%)
  Class 30: 6676 vertices (4.6%)
  Class 25: 5817 vertices (4.0%)
  Class 12: 5602 vertices (3.9%)
  Class 31: 4595 vertices (3.2%)
  Class 23: 4463 vertices (3.1%)
  Class 10: 4207 vertices (2.9%)
  Class 4: 4125 vertices (2.8%)
DEBUG: Background predicted: 47058 (32.4%)
DEBUG: Foreground predicted: 98157 (67.6%)
Labels aggregated!
  ‚úì Aggregation complete
  ‚úì Prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-5/pred_7625119
  Loaded P matrix: (37, 145215), vertices: 145215
  Mesh: 145215 vertices, 290426 faces
  Step 1: Smoothing probabilities (20 iter, Œ±=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ‚úì Smoothing complete
  Step 2: MRF refinement (Œ≤=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ‚úì MRF refinement complete

  RESULTS:
  RAW:         median(top-10)=0.7672, mean(top-10)=0.7877, median(all)=0.6830, mean(all)=0.6052
  + SMOOTHING: median(top-10)=0.8772, mean(top-10)=0.8824, median(all)=0.8068, mean(all)=0.7268 [+0.1099]
  + MRF:       median(top-10)=0.8776, mean(top-10)=0.8824, median(all)=0.8069, mean(all)=0.7270 [+0.0004]
  TOTAL IMPROVEMENT (median top-10): +0.1103

================================================================================
Subject: MMRR-21-6
================================================================================
  Step 0: Generating predictions with NEW models...
  Using PyTorch3D GPU raycasting (matching training pipeline)...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 128994 vertices, 257984 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (43829 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (101514 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (94216 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (61404 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (46186 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (65533 valid pixels)
  [PyTorch3D] Raycasting complete!
  ‚úì Got 6 output maps, shape: (6, 800, 800, 3)
  Loading trained models...
Loading models...
  Loading Front: Front-epoch=499-validation_loss=0.03.ckpt
  Loading Bottom: Bottom-epoch=499-validation_loss=0.04.ckpt
  Loading Top: Top-epoch=499-validation_loss=0.05.ckpt
  Loading Right: Right-epoch=499-validation_loss=0.04.ckpt
  Loading Back: Back-epoch=499-validation_loss=0.03.ckpt
  Loading Left: Left-epoch=499-validation_loss=0.03.ckpt
Models loaded!
  Running U-Net predictions on 6 views...
Predicting labels...
Labels predicted!
  ‚úì Got predictions from 6 views
  Aggregating predictions to vertices...
Agregating predicted labels...

üîç View 0: 2D predictions for 43829 MESH pixels (before aggregation):
   Class 12: 13136 pixels (30.0%)
   Class 30: 8120 pixels (18.5%)
   Class 9: 6008 pixels (13.7%)
   Class 10: 3339 pixels (7.6%)
   Class 32: 2579 pixels (5.9%)
   ‚Üí Background: 1.7% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0155
   ‚Üí Pixels where class 0 prob > 0.5: 704 (1.6%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9973
   ‚Üí Weights for vertex 0: mean=0.3343, max=0.9972
   ‚Üí Weights for vertex 1: mean=0.3329, max=0.9973
   ‚Üí Weights for vertex 2: mean=0.3331, max=0.9962
   ‚Üí Weights sum to 1? 1.0003

üîç View 1: 2D predictions for 101514 MESH pixels (before aggregation):
   Class 0: 21515 pixels (21.2%)
   Class 29: 20295 pixels (20.0%)
   Class 26: 9740 pixels (9.6%)
   Class 18: 6170 pixels (6.1%)
   Class 14: 6075 pixels (6.0%)
   ‚Üí Background: 21.2% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.2072
   ‚Üí Pixels where class 0 prob > 0.5: 21427 (21.1%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9995

üîç View 2: 2D predictions for 94216 MESH pixels (before aggregation):
   Class 28: 11527 pixels (12.2%)
   Class 32: 7763 pixels (8.2%)
   Class 25: 7735 pixels (8.2%)
   Class 16: 7568 pixels (8.0%)
   Class 23: 7155 pixels (7.6%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0001
   ‚Üí Pixels where class 0 prob > 0.5: 1 (0.0%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9989
DEBUG: Processed 11520000 total pixels, 1238046 valid pixels (10.7%)
DEBUG: Touched 93242.0 vertices out of 128994 (72.3%)
DEBUG: Vertices with zero probability sum: 35752 (27.7%)
DEBUG: Mean class 0 probability for touched vertices: 0.0974
\nDEBUG: Checking for views with high background predictions...
  Front: (see above for stats)
  Bottom: (see above for stats)
  Top: (see above for stats)
  Right: (see above for stats)
  Back: (see above for stats)
  Left: (see above for stats)
DEBUG: After normalization, P sums check: min=0.0000, max=1.0000
DEBUG: Predicted class distribution (before -1 shift):
  Class 0: 41802 vertices (32.4%)
  Class 29: 8975 vertices (7.0%)
  Class 28: 7666 vertices (5.9%)
  Class 12: 5498 vertices (4.3%)
  Class 25: 4704 vertices (3.6%)
  Class 30: 4568 vertices (3.5%)
  Class 23: 4167 vertices (3.2%)
  Class 32: 4124 vertices (3.2%)
  Class 9: 3984 vertices (3.1%)
  Class 8: 3935 vertices (3.1%)
DEBUG: Background predicted: 41802 (32.4%)
DEBUG: Foreground predicted: 87192 (67.6%)
Labels aggregated!
  ‚úì Aggregation complete
  ‚úì Prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-6/pred_7625119
  Loaded P matrix: (37, 128994), vertices: 128994
  Mesh: 128994 vertices, 257984 faces
  Step 1: Smoothing probabilities (20 iter, Œ±=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ‚úì Smoothing complete
  Step 2: MRF refinement (Œ≤=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ‚úì MRF refinement complete

  RESULTS:
  RAW:         median(top-10)=0.7800, mean(top-10)=0.7861, median(all)=0.6789, mean(all)=0.6049
  + SMOOTHING: median(top-10)=0.8576, mean(top-10)=0.8643, median(all)=0.8006, mean(all)=0.7175 [+0.0775]
  + MRF:       median(top-10)=0.8582, mean(top-10)=0.8650, median(all)=0.8013, mean(all)=0.7180 [+0.0006]
  TOTAL IMPROVEMENT (median top-10): +0.0781

================================================================================
Subject: MMRR-21-7
================================================================================
  Step 0: Generating predictions with NEW models...
  Using PyTorch3D GPU raycasting (matching training pipeline)...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 148998 vertices, 297992 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (38894 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (91708 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (84613 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (54443 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (38235 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (58012 valid pixels)
  [PyTorch3D] Raycasting complete!
  ‚úì Got 6 output maps, shape: (6, 800, 800, 3)
  Loading trained models...
Loading models...
  Loading Front: Front-epoch=499-validation_loss=0.03.ckpt
  Loading Bottom: Bottom-epoch=499-validation_loss=0.04.ckpt
  Loading Top: Top-epoch=499-validation_loss=0.05.ckpt
  Loading Right: Right-epoch=499-validation_loss=0.04.ckpt
  Loading Back: Back-epoch=499-validation_loss=0.03.ckpt
  Loading Left: Left-epoch=499-validation_loss=0.03.ckpt
Models loaded!
  Running U-Net predictions on 6 views...
Predicting labels...
Labels predicted!
  ‚úì Got predictions from 6 views
  Aggregating predictions to vertices...
Agregating predicted labels...

üîç View 0: 2D predictions for 38894 MESH pixels (before aggregation):
   Class 12: 12695 pixels (32.6%)
   Class 30: 9501 pixels (24.4%)
   Class 9: 5934 pixels (15.3%)
   Class 10: 2253 pixels (5.8%)
   Class 32: 2009 pixels (5.2%)
   ‚Üí Background: 0.2% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0018
   ‚Üí Pixels where class 0 prob > 0.5: 67 (0.2%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9995
   ‚Üí Weights for vertex 0: mean=0.3341, max=0.9965
   ‚Üí Weights for vertex 1: mean=0.3326, max=0.9965
   ‚Üí Weights for vertex 2: mean=0.3336, max=0.9995
   ‚Üí Weights sum to 1? 1.0003

üîç View 1: 2D predictions for 91708 MESH pixels (before aggregation):
   Class 0: 21385 pixels (23.3%)
   Class 29: 16119 pixels (17.6%)
   Class 26: 10214 pixels (11.1%)
   Class 15: 5685 pixels (6.2%)
   Class 14: 5618 pixels (6.1%)
   ‚Üí Background: 23.3% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.2306
   ‚Üí Pixels where class 0 prob > 0.5: 21213 (23.1%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9998

üîç View 2: 2D predictions for 84613 MESH pixels (before aggregation):
   Class 28: 8346 pixels (9.9%)
   Class 31: 7412 pixels (8.8%)
   Class 9: 6937 pixels (8.2%)
   Class 12: 6592 pixels (7.8%)
   Class 32: 6413 pixels (7.6%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0001
   ‚Üí Pixels where class 0 prob > 0.5: 1 (0.0%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9991
DEBUG: Processed 11520000 total pixels, 1097715 valid pixels (9.5%)
DEBUG: Touched 106389.0 vertices out of 148998 (71.4%)
DEBUG: Vertices with zero probability sum: 42609 (28.6%)
DEBUG: Mean class 0 probability for touched vertices: 0.0935
\nDEBUG: Checking for views with high background predictions...
  Front: (see above for stats)
  Bottom: (see above for stats)
  Top: (see above for stats)
  Right: (see above for stats)
  Back: (see above for stats)
  Left: (see above for stats)
DEBUG: After normalization, P sums check: min=0.0000, max=1.0000
DEBUG: Predicted class distribution (before -1 shift):
  Class 0: 49744 vertices (33.4%)
  Class 29: 9796 vertices (6.6%)
  Class 12: 7732 vertices (5.2%)
  Class 28: 7161 vertices (4.8%)
  Class 30: 5655 vertices (3.8%)
  Class 25: 5564 vertices (3.7%)
  Class 10: 4957 vertices (3.3%)
  Class 9: 4670 vertices (3.1%)
  Class 23: 4409 vertices (3.0%)
  Class 31: 4366 vertices (2.9%)
DEBUG: Background predicted: 49744 (33.4%)
DEBUG: Foreground predicted: 99254 (66.6%)
Labels aggregated!
  ‚úì Aggregation complete
  ‚úì Prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-7/pred_7625119
  Loaded P matrix: (37, 148998), vertices: 148998
  Mesh: 148998 vertices, 297992 faces
  Step 1: Smoothing probabilities (20 iter, Œ±=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ‚úì Smoothing complete
  Step 2: MRF refinement (Œ≤=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ‚úì MRF refinement complete

  RESULTS:
  RAW:         median(top-10)=0.7902, mean(top-10)=0.7929, median(all)=0.6584, mean(all)=0.6065
  + SMOOTHING: median(top-10)=0.8701, mean(top-10)=0.8764, median(all)=0.8164, mean(all)=0.7265 [+0.0799]
  + MRF:       median(top-10)=0.8702, mean(top-10)=0.8765, median(all)=0.8166, mean(all)=0.7265 [+0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0800

================================================================================
Subject: MMRR-21-8
================================================================================
  Step 0: Generating predictions with NEW models...
  Using PyTorch3D GPU raycasting (matching training pipeline)...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 124399 vertices, 248794 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (42512 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (101126 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (92934 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (57556 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (41363 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (61873 valid pixels)
  [PyTorch3D] Raycasting complete!
  ‚úì Got 6 output maps, shape: (6, 800, 800, 3)
  Loading trained models...
Loading models...
  Loading Front: Front-epoch=499-validation_loss=0.03.ckpt
  Loading Bottom: Bottom-epoch=499-validation_loss=0.04.ckpt
  Loading Top: Top-epoch=499-validation_loss=0.05.ckpt
  Loading Right: Right-epoch=499-validation_loss=0.04.ckpt
  Loading Back: Back-epoch=499-validation_loss=0.03.ckpt
  Loading Left: Left-epoch=499-validation_loss=0.03.ckpt
Models loaded!
  Running U-Net predictions on 6 views...
Predicting labels...
Labels predicted!
  ‚úì Got predictions from 6 views
  Aggregating predictions to vertices...
Agregating predicted labels...

üîç View 0: 2D predictions for 42512 MESH pixels (before aggregation):
   Class 12: 12397 pixels (29.2%)
   Class 9: 9148 pixels (21.5%)
   Class 30: 9143 pixels (21.5%)
   Class 32: 2974 pixels (7.0%)
   Class 23: 1730 pixels (4.1%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0006
   ‚Üí Pixels where class 0 prob > 0.5: 9 (0.0%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9971
   ‚Üí Weights for vertex 0: mean=0.3343, max=0.9971
   ‚Üí Weights for vertex 1: mean=0.3337, max=0.9936
   ‚Üí Weights for vertex 2: mean=0.3323, max=0.9949
   ‚Üí Weights sum to 1? 1.0003

üîç View 1: 2D predictions for 101126 MESH pixels (before aggregation):
   Class 0: 21540 pixels (21.3%)
   Class 29: 20301 pixels (20.1%)
   Class 26: 10027 pixels (9.9%)
   Class 15: 6357 pixels (6.3%)
   Class 14: 5502 pixels (5.4%)
   ‚Üí Background: 21.3% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.2110
   ‚Üí Pixels where class 0 prob > 0.5: 21479 (21.2%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9992

üîç View 2: 2D predictions for 92934 MESH pixels (before aggregation):
   Class 28: 10923 pixels (11.8%)
   Class 9: 8607 pixels (9.3%)
   Class 31: 7850 pixels (8.4%)
   Class 32: 6959 pixels (7.5%)
   Class 10: 6847 pixels (7.4%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0001
   ‚Üí Pixels where class 0 prob > 0.5: 3 (0.0%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9995
DEBUG: Processed 11520000 total pixels, 1192092 valid pixels (10.3%)
DEBUG: Touched 89926.0 vertices out of 124399 (72.3%)
DEBUG: Vertices with zero probability sum: 34473 (27.7%)
DEBUG: Mean class 0 probability for touched vertices: 0.0869
\nDEBUG: Checking for views with high background predictions...
  Front: (see above for stats)
  Bottom: (see above for stats)
  Top: (see above for stats)
  Right: (see above for stats)
  Back: (see above for stats)
  Left: (see above for stats)
DEBUG: After normalization, P sums check: min=0.0000, max=1.0000
DEBUG: Predicted class distribution (before -1 shift):
  Class 0: 40100 vertices (32.2%)
  Class 29: 9126 vertices (7.3%)
  Class 28: 6827 vertices (5.5%)
  Class 12: 5387 vertices (4.3%)
  Class 30: 5121 vertices (4.1%)
  Class 9: 4891 vertices (3.9%)
  Class 10: 4220 vertices (3.4%)
  Class 23: 3871 vertices (3.1%)
  Class 25: 3867 vertices (3.1%)
  Class 31: 3800 vertices (3.1%)
DEBUG: Background predicted: 40100 (32.2%)
DEBUG: Foreground predicted: 84299 (67.8%)
Labels aggregated!
  ‚úì Aggregation complete
  ‚úì Prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-8/pred_7625119
  Loaded P matrix: (37, 124399), vertices: 124399
  Mesh: 124399 vertices, 248794 faces
  Step 1: Smoothing probabilities (20 iter, Œ±=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ‚úì Smoothing complete
  Step 2: MRF refinement (Œ≤=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ‚úì MRF refinement complete

  RESULTS:
  RAW:         median(top-10)=0.8104, mean(top-10)=0.8065, median(all)=0.6797, mean(all)=0.6097
  + SMOOTHING: median(top-10)=0.8667, mean(top-10)=0.8718, median(all)=0.8163, mean(all)=0.7260 [+0.0563]
  + MRF:       median(top-10)=0.8674, mean(top-10)=0.8725, median(all)=0.8171, mean(all)=0.7264 [+0.0007]
  TOTAL IMPROVEMENT (median top-10): +0.0569

================================================================================
Subject: MMRR-21-9
================================================================================
  Step 0: Generating predictions with NEW models...
  Using PyTorch3D GPU raycasting (matching training pipeline)...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 131827 vertices, 263650 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (46196 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (102595 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (94766 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (63258 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (44518 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (66524 valid pixels)
  [PyTorch3D] Raycasting complete!
  ‚úì Got 6 output maps, shape: (6, 800, 800, 3)
  Loading trained models...
Loading models...
  Loading Front: Front-epoch=499-validation_loss=0.03.ckpt
  Loading Bottom: Bottom-epoch=499-validation_loss=0.04.ckpt
  Loading Top: Top-epoch=499-validation_loss=0.05.ckpt
  Loading Right: Right-epoch=499-validation_loss=0.04.ckpt
  Loading Back: Back-epoch=499-validation_loss=0.03.ckpt
  Loading Left: Left-epoch=499-validation_loss=0.03.ckpt
Models loaded!
  Running U-Net predictions on 6 views...
Predicting labels...
Labels predicted!
  ‚úì Got predictions from 6 views
  Aggregating predictions to vertices...
Agregating predicted labels...

üîç View 0: 2D predictions for 46196 MESH pixels (before aggregation):
   Class 12: 12834 pixels (27.8%)
   Class 30: 10610 pixels (23.0%)
   Class 9: 8453 pixels (18.3%)
   Class 23: 2582 pixels (5.6%)
   Class 32: 2439 pixels (5.3%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0002
   ‚Üí Pixels where class 0 prob > 0.5: 2 (0.0%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9962
   ‚Üí Weights for vertex 0: mean=0.3335, max=0.9962
   ‚Üí Weights for vertex 1: mean=0.3330, max=0.9957
   ‚Üí Weights for vertex 2: mean=0.3337, max=0.9942
   ‚Üí Weights sum to 1? 1.0003

üîç View 1: 2D predictions for 102595 MESH pixels (before aggregation):
   Class 0: 20599 pixels (20.1%)
   Class 29: 20522 pixels (20.0%)
   Class 26: 9595 pixels (9.4%)
   Class 15: 7158 pixels (7.0%)
   Class 14: 6455 pixels (6.3%)
   ‚Üí Background: 20.1% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.1984
   ‚Üí Pixels where class 0 prob > 0.5: 20489 (20.0%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9997

üîç View 2: 2D predictions for 94766 MESH pixels (before aggregation):
   Class 28: 9861 pixels (10.4%)
   Class 25: 9434 pixels (10.0%)
   Class 9: 7873 pixels (8.3%)
   Class 31: 7528 pixels (7.9%)
   Class 23: 6688 pixels (7.1%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0001
   ‚Üí Pixels where class 0 prob > 0.5: 1 (0.0%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9974
DEBUG: Processed 11520000 total pixels, 1253571 valid pixels (10.9%)
DEBUG: Touched 94585.0 vertices out of 131827 (71.7%)
DEBUG: Vertices with zero probability sum: 37242 (28.3%)
DEBUG: Mean class 0 probability for touched vertices: 0.0814
\nDEBUG: Checking for views with high background predictions...
  Front: (see above for stats)
  Bottom: (see above for stats)
  Top: (see above for stats)
  Right: (see above for stats)
  Back: (see above for stats)
  Left: (see above for stats)
DEBUG: After normalization, P sums check: min=0.0000, max=1.0000
DEBUG: Predicted class distribution (before -1 shift):
  Class 0: 43176 vertices (32.8%)
  Class 29: 9506 vertices (7.2%)
  Class 28: 6676 vertices (5.1%)
  Class 25: 5552 vertices (4.2%)
  Class 30: 5416 vertices (4.1%)
  Class 12: 5310 vertices (4.0%)
  Class 23: 4435 vertices (3.4%)
  Class 9: 4411 vertices (3.3%)
  Class 10: 4072 vertices (3.1%)
  Class 8: 3649 vertices (2.8%)
DEBUG: Background predicted: 43176 (32.8%)
DEBUG: Foreground predicted: 88651 (67.2%)
Labels aggregated!
  ‚úì Aggregation complete
  ‚úì Prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-9/pred_7625119
  Loaded P matrix: (37, 131827), vertices: 131827
  Mesh: 131827 vertices, 263650 faces
  Step 1: Smoothing probabilities (20 iter, Œ±=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ‚úì Smoothing complete
  Step 2: MRF refinement (Œ≤=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ‚úì MRF refinement complete

  RESULTS:
  RAW:         median(top-10)=0.7812, mean(top-10)=0.7807, median(all)=0.6771, mean(all)=0.6031
  + SMOOTHING: median(top-10)=0.8738, mean(top-10)=0.8755, median(all)=0.8173, mean(all)=0.7330 [+0.0926]
  + MRF:       median(top-10)=0.8737, mean(top-10)=0.8758, median(all)=0.8171, mean(all)=0.7331 [-0.0000]
  TOTAL IMPROVEMENT (median top-10): +0.0926

================================================================================
Subject: MMRR-3T7T-2-1
================================================================================
  Step 0: Generating predictions with NEW models...
  Using PyTorch3D GPU raycasting (matching training pipeline)...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 150156 vertices, 300308 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (50095 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (113043 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (103661 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (66639 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (47856 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (69905 valid pixels)
  [PyTorch3D] Raycasting complete!
  ‚úì Got 6 output maps, shape: (6, 800, 800, 3)
  Loading trained models...
Loading models...
  Loading Front: Front-epoch=499-validation_loss=0.03.ckpt
  Loading Bottom: Bottom-epoch=499-validation_loss=0.04.ckpt
  Loading Top: Top-epoch=499-validation_loss=0.05.ckpt
  Loading Right: Right-epoch=499-validation_loss=0.04.ckpt
  Loading Back: Back-epoch=499-validation_loss=0.03.ckpt
  Loading Left: Left-epoch=499-validation_loss=0.03.ckpt
Models loaded!
  Running U-Net predictions on 6 views...
Predicting labels...
Labels predicted!
  ‚úì Got predictions from 6 views
  Aggregating predictions to vertices...
Agregating predicted labels...

üîç View 0: 2D predictions for 50095 MESH pixels (before aggregation):
   Class 12: 14412 pixels (28.8%)
   Class 30: 12189 pixels (24.3%)
   Class 9: 9445 pixels (18.9%)
   Class 23: 3134 pixels (6.3%)
   Class 32: 3095 pixels (6.2%)
   ‚Üí Background: 0.1% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0009
   ‚Üí Pixels where class 0 prob > 0.5: 27 (0.1%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9986
   ‚Üí Weights for vertex 0: mean=0.3343, max=0.9960
   ‚Üí Weights for vertex 1: mean=0.3319, max=0.9986
   ‚Üí Weights for vertex 2: mean=0.3341, max=0.9937
   ‚Üí Weights sum to 1? 1.0004

üîç View 1: 2D predictions for 113043 MESH pixels (before aggregation):
   Class 29: 22810 pixels (20.2%)
   Class 0: 22561 pixels (20.0%)
   Class 26: 12263 pixels (10.8%)
   Class 15: 7715 pixels (6.8%)
   Class 14: 7472 pixels (6.6%)
   ‚Üí Background: 20.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.1996
   ‚Üí Pixels where class 0 prob > 0.5: 22397 (19.8%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9994

üîç View 2: 2D predictions for 103661 MESH pixels (before aggregation):
   Class 28: 10001 pixels (9.6%)
   Class 16: 9998 pixels (9.6%)
   Class 32: 8523 pixels (8.2%)
   Class 9: 8380 pixels (8.1%)
   Class 31: 8267 pixels (8.0%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0000
   ‚Üí Pixels where class 0 prob > 0.5: 1 (0.0%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9988
DEBUG: Processed 11520000 total pixels, 1353597 valid pixels (11.7%)
DEBUG: Touched 108101.0 vertices out of 150156 (72.0%)
DEBUG: Vertices with zero probability sum: 42055 (28.0%)
DEBUG: Mean class 0 probability for touched vertices: 0.0914
\nDEBUG: Checking for views with high background predictions...
  Front: (see above for stats)
  Bottom: (see above for stats)
  Top: (see above for stats)
  Right: (see above for stats)
  Back: (see above for stats)
  Left: (see above for stats)
DEBUG: After normalization, P sums check: min=0.0000, max=1.0000
DEBUG: Predicted class distribution (before -1 shift):
  Class 0: 48981 vertices (32.6%)
  Class 29: 10773 vertices (7.2%)
  Class 28: 7604 vertices (5.1%)
  Class 12: 6394 vertices (4.3%)
  Class 30: 5899 vertices (3.9%)
  Class 25: 5252 vertices (3.5%)
  Class 9: 5152 vertices (3.4%)
  Class 16: 4850 vertices (3.2%)
  Class 10: 4482 vertices (3.0%)
  Class 23: 4427 vertices (2.9%)
DEBUG: Background predicted: 48981 (32.6%)
DEBUG: Foreground predicted: 101175 (67.4%)
Labels aggregated!
  ‚úì Aggregation complete
  ‚úì Prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-3T7T-2-1/pred_7625119
  Loaded P matrix: (37, 150156), vertices: 150156
  Mesh: 150156 vertices, 300308 faces
  Step 1: Smoothing probabilities (20 iter, Œ±=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ‚úì Smoothing complete
  Step 2: MRF refinement (Œ≤=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ‚úì MRF refinement complete

  RESULTS:
  RAW:         median(top-10)=0.6894, mean(top-10)=0.6786, median(all)=0.5162, mean(all)=0.4708
  + SMOOTHING: median(top-10)=0.7559, mean(top-10)=0.7586, median(all)=0.6384, mean(all)=0.5568 [+0.0665]
  + MRF:       median(top-10)=0.7562, mean(top-10)=0.7590, median(all)=0.6393, mean(all)=0.5572 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0668

================================================================================
Subject: MMRR-3T7T-2-2
================================================================================
  Step 0: Generating predictions with NEW models...
  Using PyTorch3D GPU raycasting (matching training pipeline)...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 135252 vertices, 270500 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (50737 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (99471 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (91732 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (62641 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (47436 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (65567 valid pixels)
  [PyTorch3D] Raycasting complete!
  ‚úì Got 6 output maps, shape: (6, 800, 800, 3)
  Loading trained models...
Loading models...
  Loading Front: Front-epoch=499-validation_loss=0.03.ckpt
  Loading Bottom: Bottom-epoch=499-validation_loss=0.04.ckpt
  Loading Top: Top-epoch=499-validation_loss=0.05.ckpt
  Loading Right: Right-epoch=499-validation_loss=0.04.ckpt
  Loading Back: Back-epoch=499-validation_loss=0.03.ckpt
  Loading Left: Left-epoch=499-validation_loss=0.03.ckpt
Models loaded!
  Running U-Net predictions on 6 views...
Predicting labels...
Labels predicted!
  ‚úì Got predictions from 6 views
  Aggregating predictions to vertices...
Agregating predicted labels...

üîç View 0: 2D predictions for 50737 MESH pixels (before aggregation):
   Class 12: 13788 pixels (27.2%)
   Class 30: 12011 pixels (23.7%)
   Class 9: 7896 pixels (15.6%)
   Class 10: 3292 pixels (6.5%)
   Class 32: 3163 pixels (6.2%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0003
   ‚Üí Pixels where class 0 prob > 0.5: 2 (0.0%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9993
   ‚Üí Weights for vertex 0: mean=0.3355, max=0.9993
   ‚Üí Weights for vertex 1: mean=0.3339, max=0.9954
   ‚Üí Weights for vertex 2: mean=0.3309, max=0.9952
   ‚Üí Weights sum to 1? 1.0003

üîç View 1: 2D predictions for 99471 MESH pixels (before aggregation):
   Class 0: 20005 pixels (20.1%)
   Class 29: 17155 pixels (17.2%)
   Class 26: 11254 pixels (11.3%)
   Class 14: 7076 pixels (7.1%)
   Class 15: 6641 pixels (6.7%)
   ‚Üí Background: 20.1% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.2005
   ‚Üí Pixels where class 0 prob > 0.5: 19935 (20.0%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9985

üîç View 2: 2D predictions for 91732 MESH pixels (before aggregation):
   Class 28: 8582 pixels (9.4%)
   Class 9: 7749 pixels (8.4%)
   Class 12: 7690 pixels (8.4%)
   Class 32: 7689 pixels (8.4%)
   Class 23: 7584 pixels (8.3%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0000
   ‚Üí Pixels where class 0 prob > 0.5: 0 (0.0%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9981
DEBUG: Processed 11520000 total pixels, 1252752 valid pixels (10.9%)
DEBUG: Touched 96978.0 vertices out of 135252 (71.7%)
DEBUG: Vertices with zero probability sum: 38274 (28.3%)
DEBUG: Mean class 0 probability for touched vertices: 0.0980
\nDEBUG: Checking for views with high background predictions...
  Front: (see above for stats)
  Bottom: (see above for stats)
  Top: (see above for stats)
  Right: (see above for stats)
  Back: (see above for stats)
  Left: (see above for stats)
DEBUG: After normalization, P sums check: min=0.0000, max=1.0000
DEBUG: Predicted class distribution (before -1 shift):
  Class 0: 44345 vertices (32.8%)
  Class 29: 8585 vertices (6.3%)
  Class 28: 7136 vertices (5.3%)
  Class 12: 6602 vertices (4.9%)
  Class 30: 6287 vertices (4.6%)
  Class 23: 4824 vertices (3.6%)
  Class 9: 4812 vertices (3.6%)
  Class 25: 4334 vertices (3.2%)
  Class 10: 3969 vertices (2.9%)
  Class 16: 3931 vertices (2.9%)
DEBUG: Background predicted: 44345 (32.8%)
DEBUG: Foreground predicted: 90907 (67.2%)
Labels aggregated!
  ‚úì Aggregation complete
  ‚úì Prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-3T7T-2-2/pred_7625119
  Loaded P matrix: (37, 135252), vertices: 135252
  Mesh: 135252 vertices, 270500 faces
  Step 1: Smoothing probabilities (20 iter, Œ±=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ‚úì Smoothing complete
  Step 2: MRF refinement (Œ≤=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ‚úì MRF refinement complete

  RESULTS:
  RAW:         median(top-10)=0.6670, mean(top-10)=0.6686, median(all)=0.4772, mean(all)=0.4567
  + SMOOTHING: median(top-10)=0.7562, mean(top-10)=0.7470, median(all)=0.6075, mean(all)=0.5450 [+0.0892]
  + MRF:       median(top-10)=0.7563, mean(top-10)=0.7469, median(all)=0.6075, mean(all)=0.5450 [+0.0000]
  TOTAL IMPROVEMENT (median top-10): +0.0893

================================================================================
Subject: NKI-RS-22-1
================================================================================
  Step 0: Generating predictions with NEW models...
  Using PyTorch3D GPU raycasting (matching training pipeline)...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 137338 vertices, 274672 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (45287 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (103328 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (95368 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (62148 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (44184 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (67015 valid pixels)
  [PyTorch3D] Raycasting complete!
  ‚úì Got 6 output maps, shape: (6, 800, 800, 3)
  Loading trained models...
Loading models...
  Loading Front: Front-epoch=499-validation_loss=0.03.ckpt
  Loading Bottom: Bottom-epoch=499-validation_loss=0.04.ckpt
  Loading Top: Top-epoch=499-validation_loss=0.05.ckpt
  Loading Right: Right-epoch=499-validation_loss=0.04.ckpt
  Loading Back: Back-epoch=499-validation_loss=0.03.ckpt
  Loading Left: Left-epoch=499-validation_loss=0.03.ckpt
Models loaded!
  Running U-Net predictions on 6 views...
Predicting labels...
Labels predicted!
  ‚úì Got predictions from 6 views
  Aggregating predictions to vertices...
Agregating predicted labels...

üîç View 0: 2D predictions for 45287 MESH pixels (before aggregation):
   Class 12: 12093 pixels (26.7%)
   Class 30: 10827 pixels (23.9%)
   Class 9: 8140 pixels (18.0%)
   Class 23: 3545 pixels (7.8%)
   Class 32: 3254 pixels (7.2%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0005
   ‚Üí Pixels where class 0 prob > 0.5: 4 (0.0%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9984
   ‚Üí Weights for vertex 0: mean=0.3334, max=0.9980
   ‚Üí Weights for vertex 1: mean=0.3338, max=0.9983
   ‚Üí Weights for vertex 2: mean=0.3332, max=0.9984
   ‚Üí Weights sum to 1? 1.0003

üîç View 1: 2D predictions for 103328 MESH pixels (before aggregation):
   Class 29: 22483 pixels (21.8%)
   Class 0: 21869 pixels (21.2%)
   Class 26: 12537 pixels (12.1%)
   Class 15: 5722 pixels (5.5%)
   Class 18: 5444 pixels (5.3%)
   ‚Üí Background: 21.2% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.2108
   ‚Üí Pixels where class 0 prob > 0.5: 21776 (21.1%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9996

üîç View 2: 2D predictions for 95368 MESH pixels (before aggregation):
   Class 28: 8556 pixels (9.0%)
   Class 31: 8054 pixels (8.4%)
   Class 32: 7816 pixels (8.2%)
   Class 16: 7619 pixels (8.0%)
   Class 23: 7595 pixels (8.0%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0000
   ‚Üí Pixels where class 0 prob > 0.5: 0 (0.0%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9996
DEBUG: Processed 11520000 total pixels, 1251990 valid pixels (10.9%)
DEBUG: Touched 100446.0 vertices out of 137338 (73.1%)
DEBUG: Vertices with zero probability sum: 36892 (26.9%)
DEBUG: Mean class 0 probability for touched vertices: 0.0867
\nDEBUG: Checking for views with high background predictions...
  Front: (see above for stats)
  Bottom: (see above for stats)
  Top: (see above for stats)
  Right: (see above for stats)
  Back: (see above for stats)
  Left: (see above for stats)
DEBUG: After normalization, P sums check: min=0.0000, max=1.0000
DEBUG: Predicted class distribution (before -1 shift):
  Class 0: 42958 vertices (31.3%)
  Class 29: 9722 vertices (7.1%)
  Class 28: 6854 vertices (5.0%)
  Class 12: 5694 vertices (4.1%)
  Class 30: 5448 vertices (4.0%)
  Class 23: 5226 vertices (3.8%)
  Class 25: 5212 vertices (3.8%)
  Class 10: 4371 vertices (3.2%)
  Class 9: 4174 vertices (3.0%)
  Class 31: 4172 vertices (3.0%)
DEBUG: Background predicted: 42958 (31.3%)
DEBUG: Foreground predicted: 94380 (68.7%)
Labels aggregated!
  ‚úì Aggregation complete
  ‚úì Prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-1/pred_7625119
  Loaded P matrix: (37, 137338), vertices: 137338
  Mesh: 137338 vertices, 274672 faces
  Step 1: Smoothing probabilities (20 iter, Œ±=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ‚úì Smoothing complete
  Step 2: MRF refinement (Œ≤=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ‚úì MRF refinement complete

  RESULTS:
  RAW:         median(top-10)=0.7749, mean(top-10)=0.7778, median(all)=0.7029, mean(all)=0.6153
  + SMOOTHING: median(top-10)=0.8910, mean(top-10)=0.8876, median(all)=0.8112, mean(all)=0.7285 [+0.1161]
  + MRF:       median(top-10)=0.8914, mean(top-10)=0.8880, median(all)=0.8115, mean(all)=0.7287 [+0.0005]
  TOTAL IMPROVEMENT (median top-10): +0.1165

================================================================================
Subject: NKI-RS-22-10
================================================================================
  Step 0: Generating predictions with NEW models...
  Using PyTorch3D GPU raycasting (matching training pipeline)...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 130448 vertices, 260892 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (49141 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (109988 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (102168 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (65401 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (47715 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (70340 valid pixels)
  [PyTorch3D] Raycasting complete!
  ‚úì Got 6 output maps, shape: (6, 800, 800, 3)
  Loading trained models...
Loading models...
  Loading Front: Front-epoch=499-validation_loss=0.03.ckpt
  Loading Bottom: Bottom-epoch=499-validation_loss=0.04.ckpt
  Loading Top: Top-epoch=499-validation_loss=0.05.ckpt
  Loading Right: Right-epoch=499-validation_loss=0.04.ckpt
  Loading Back: Back-epoch=499-validation_loss=0.03.ckpt
  Loading Left: Left-epoch=499-validation_loss=0.03.ckpt
Models loaded!
  Running U-Net predictions on 6 views...
Predicting labels...
Labels predicted!
  ‚úì Got predictions from 6 views
  Aggregating predictions to vertices...
Agregating predicted labels...

üîç View 0: 2D predictions for 49141 MESH pixels (before aggregation):
   Class 12: 12554 pixels (25.5%)
   Class 30: 10692 pixels (21.8%)
   Class 9: 10560 pixels (21.5%)
   Class 26: 2971 pixels (6.0%)
   Class 23: 2725 pixels (5.5%)
   ‚Üí Background: 0.9% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0076
   ‚Üí Pixels where class 0 prob > 0.5: 353 (0.7%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9984
   ‚Üí Weights for vertex 0: mean=0.3337, max=0.9940
   ‚Üí Weights for vertex 1: mean=0.3349, max=0.9966
   ‚Üí Weights for vertex 2: mean=0.3317, max=0.9984
   ‚Üí Weights sum to 1? 1.0003

üîç View 1: 2D predictions for 109988 MESH pixels (before aggregation):
   Class 0: 23227 pixels (21.1%)
   Class 29: 20386 pixels (18.5%)
   Class 26: 10974 pixels (10.0%)
   Class 15: 8142 pixels (7.4%)
   Class 18: 6600 pixels (6.0%)
   ‚Üí Background: 21.1% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.2113
   ‚Üí Pixels where class 0 prob > 0.5: 23058 (21.0%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9995

üîç View 2: 2D predictions for 102168 MESH pixels (before aggregation):
   Class 28: 10510 pixels (10.3%)
   Class 31: 9031 pixels (8.8%)
   Class 32: 8810 pixels (8.6%)
   Class 16: 8707 pixels (8.5%)
   Class 9: 8209 pixels (8.0%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0001
   ‚Üí Pixels where class 0 prob > 0.5: 4 (0.0%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9993
DEBUG: Processed 11520000 total pixels, 1334259 valid pixels (11.6%)
DEBUG: Touched 96387.0 vertices out of 130448 (73.9%)
DEBUG: Vertices with zero probability sum: 34061 (26.1%)
DEBUG: Mean class 0 probability for touched vertices: 0.0983
\nDEBUG: Checking for views with high background predictions...
  Front: (see above for stats)
  Bottom: (see above for stats)
  Top: (see above for stats)
  Right: (see above for stats)
  Back: (see above for stats)
  Left: (see above for stats)
DEBUG: After normalization, P sums check: min=0.0000, max=1.0000
DEBUG: Predicted class distribution (before -1 shift):
  Class 0: 40451 vertices (31.0%)
  Class 29: 9050 vertices (6.9%)
  Class 28: 6864 vertices (5.3%)
  Class 12: 6156 vertices (4.7%)
  Class 9: 5134 vertices (3.9%)
  Class 30: 4695 vertices (3.6%)
  Class 25: 4677 vertices (3.6%)
  Class 23: 4526 vertices (3.5%)
  Class 16: 4421 vertices (3.4%)
  Class 31: 4210 vertices (3.2%)
DEBUG: Background predicted: 40451 (31.0%)
DEBUG: Foreground predicted: 89997 (69.0%)
Labels aggregated!
  ‚úì Aggregation complete
  ‚úì Prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-10/pred_7625119
  Loaded P matrix: (37, 130448), vertices: 130448
  Mesh: 130448 vertices, 260892 faces
  Step 1: Smoothing probabilities (20 iter, Œ±=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ‚úì Smoothing complete
  Step 2: MRF refinement (Œ≤=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ‚úì MRF refinement complete

  RESULTS:
  RAW:         median(top-10)=0.7778, mean(top-10)=0.7764, median(all)=0.6729, mean(all)=0.6074
  + SMOOTHING: median(top-10)=0.8574, mean(top-10)=0.8660, median(all)=0.8100, mean(all)=0.7234 [+0.0796]
  + MRF:       median(top-10)=0.8579, mean(top-10)=0.8663, median(all)=0.8102, mean(all)=0.7239 [+0.0005]
  TOTAL IMPROVEMENT (median top-10): +0.0801

================================================================================
Subject: NKI-RS-22-11
================================================================================
  Step 0: Generating predictions with NEW models...
  Using PyTorch3D GPU raycasting (matching training pipeline)...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 138161 vertices, 276318 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (41198 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (100125 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (92740 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (59370 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (42813 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (64767 valid pixels)
  [PyTorch3D] Raycasting complete!
  ‚úì Got 6 output maps, shape: (6, 800, 800, 3)
  Loading trained models...
Loading models...
  Loading Front: Front-epoch=499-validation_loss=0.03.ckpt
  Loading Bottom: Bottom-epoch=499-validation_loss=0.04.ckpt
  Loading Top: Top-epoch=499-validation_loss=0.05.ckpt
  Loading Right: Right-epoch=499-validation_loss=0.04.ckpt
  Loading Back: Back-epoch=499-validation_loss=0.03.ckpt
  Loading Left: Left-epoch=499-validation_loss=0.03.ckpt
Models loaded!
  Running U-Net predictions on 6 views...
Predicting labels...
Labels predicted!
  ‚úì Got predictions from 6 views
  Aggregating predictions to vertices...
Agregating predicted labels...

üîç View 0: 2D predictions for 41198 MESH pixels (before aggregation):
   Class 12: 11463 pixels (27.8%)
   Class 9: 8415 pixels (20.4%)
   Class 30: 7684 pixels (18.7%)
   Class 10: 2423 pixels (5.9%)
   Class 32: 2117 pixels (5.1%)
   ‚Üí Background: 0.1% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0023
   ‚Üí Pixels where class 0 prob > 0.5: 30 (0.1%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9978
   ‚Üí Weights for vertex 0: mean=0.3348, max=0.9957
   ‚Üí Weights for vertex 1: mean=0.3327, max=0.9978
   ‚Üí Weights for vertex 2: mean=0.3328, max=0.9923
   ‚Üí Weights sum to 1? 1.0003

üîç View 1: 2D predictions for 100125 MESH pixels (before aggregation):
   Class 0: 21248 pixels (21.2%)
   Class 29: 20795 pixels (20.8%)
   Class 26: 9637 pixels (9.6%)
   Class 18: 6530 pixels (6.5%)
   Class 15: 6445 pixels (6.4%)
   ‚Üí Background: 21.2% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.2105
   ‚Üí Pixels where class 0 prob > 0.5: 21157 (21.1%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9995

üîç View 2: 2D predictions for 92740 MESH pixels (before aggregation):
   Class 28: 10089 pixels (10.9%)
   Class 23: 7937 pixels (8.6%)
   Class 32: 7648 pixels (8.2%)
   Class 16: 7378 pixels (8.0%)
   Class 31: 7052 pixels (7.6%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0001
   ‚Üí Pixels where class 0 prob > 0.5: 5 (0.0%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9994
DEBUG: Processed 11520000 total pixels, 1203039 valid pixels (10.4%)
DEBUG: Touched 99048.0 vertices out of 138161 (71.7%)
DEBUG: Vertices with zero probability sum: 39113 (28.3%)
DEBUG: Mean class 0 probability for touched vertices: 0.0844
\nDEBUG: Checking for views with high background predictions...
  Front: (see above for stats)
  Bottom: (see above for stats)
  Top: (see above for stats)
  Right: (see above for stats)
  Back: (see above for stats)
  Left: (see above for stats)
DEBUG: After normalization, P sums check: min=0.0000, max=1.0000
DEBUG: Predicted class distribution (before -1 shift):
  Class 0: 45011 vertices (32.6%)
  Class 29: 10139 vertices (7.3%)
  Class 28: 6911 vertices (5.0%)
  Class 12: 5903 vertices (4.3%)
  Class 25: 5309 vertices (3.8%)
  Class 23: 5224 vertices (3.8%)
  Class 30: 5215 vertices (3.8%)
  Class 9: 4684 vertices (3.4%)
  Class 14: 3925 vertices (2.8%)
  Class 10: 3834 vertices (2.8%)
DEBUG: Background predicted: 45011 (32.6%)
DEBUG: Foreground predicted: 93150 (67.4%)
Labels aggregated!
  ‚úì Aggregation complete
  ‚úì Prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-11/pred_7625119
  Loaded P matrix: (37, 138161), vertices: 138161
  Mesh: 138161 vertices, 276318 faces
  Step 1: Smoothing probabilities (20 iter, Œ±=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ‚úì Smoothing complete
  Step 2: MRF refinement (Œ≤=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ‚úì MRF refinement complete

  RESULTS:
  RAW:         median(top-10)=0.7890, mean(top-10)=0.7897, median(all)=0.6896, mean(all)=0.6121
  + SMOOTHING: median(top-10)=0.8788, mean(top-10)=0.8825, median(all)=0.8306, mean(all)=0.7381 [+0.0898]
  + MRF:       median(top-10)=0.8787, mean(top-10)=0.8827, median(all)=0.8307, mean(all)=0.7383 [-0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0897

================================================================================
Subject: NKI-RS-22-12
================================================================================
  Step 0: Generating predictions with NEW models...
  Using PyTorch3D GPU raycasting (matching training pipeline)...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 144832 vertices, 289660 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (41471 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (92137 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (85395 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (62927 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (41614 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (65719 valid pixels)
  [PyTorch3D] Raycasting complete!
  ‚úì Got 6 output maps, shape: (6, 800, 800, 3)
  Loading trained models...
Loading models...
  Loading Front: Front-epoch=499-validation_loss=0.03.ckpt
  Loading Bottom: Bottom-epoch=499-validation_loss=0.04.ckpt
  Loading Top: Top-epoch=499-validation_loss=0.05.ckpt
  Loading Right: Right-epoch=499-validation_loss=0.04.ckpt
  Loading Back: Back-epoch=499-validation_loss=0.03.ckpt
  Loading Left: Left-epoch=499-validation_loss=0.03.ckpt
Models loaded!
  Running U-Net predictions on 6 views...
Predicting labels...
Labels predicted!
  ‚úì Got predictions from 6 views
  Aggregating predictions to vertices...
Agregating predicted labels...

üîç View 0: 2D predictions for 41471 MESH pixels (before aggregation):
   Class 12: 10608 pixels (25.6%)
   Class 30: 9534 pixels (23.0%)
   Class 9: 7865 pixels (19.0%)
   Class 10: 2962 pixels (7.1%)
   Class 32: 1837 pixels (4.4%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0006
   ‚Üí Pixels where class 0 prob > 0.5: 12 (0.0%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9990
   ‚Üí Weights for vertex 0: mean=0.3333, max=0.9990
   ‚Üí Weights for vertex 1: mean=0.3340, max=0.9951
   ‚Üí Weights for vertex 2: mean=0.3331, max=0.9970
   ‚Üí Weights sum to 1? 1.0004

üîç View 1: 2D predictions for 92137 MESH pixels (before aggregation):
   Class 29: 19792 pixels (21.5%)
   Class 0: 18476 pixels (20.1%)
   Class 26: 8153 pixels (8.8%)
   Class 15: 6432 pixels (7.0%)
   Class 14: 5152 pixels (5.6%)
   ‚Üí Background: 20.1% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.2008
   ‚Üí Pixels where class 0 prob > 0.5: 18397 (20.0%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9981

üîç View 2: 2D predictions for 85395 MESH pixels (before aggregation):
   Class 32: 7883 pixels (9.2%)
   Class 28: 7239 pixels (8.5%)
   Class 16: 7200 pixels (8.4%)
   Class 31: 7152 pixels (8.4%)
   Class 9: 6820 pixels (8.0%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0001
   ‚Üí Pixels where class 0 prob > 0.5: 1 (0.0%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9988
DEBUG: Processed 11520000 total pixels, 1167789 valid pixels (10.1%)
DEBUG: Touched 104604.0 vertices out of 144832 (72.2%)
DEBUG: Vertices with zero probability sum: 40228 (27.8%)
DEBUG: Mean class 0 probability for touched vertices: 0.0798
\nDEBUG: Checking for views with high background predictions...
  Front: (see above for stats)
  Bottom: (see above for stats)
  Top: (see above for stats)
  Right: (see above for stats)
  Back: (see above for stats)
  Left: (see above for stats)
DEBUG: After normalization, P sums check: min=0.0000, max=1.0000
DEBUG: Predicted class distribution (before -1 shift):
  Class 0: 46203 vertices (31.9%)
  Class 29: 11407 vertices (7.9%)
  Class 28: 6334 vertices (4.4%)
  Class 12: 6326 vertices (4.4%)
  Class 30: 5699 vertices (3.9%)
  Class 25: 5416 vertices (3.7%)
  Class 23: 5051 vertices (3.5%)
  Class 9: 4971 vertices (3.4%)
  Class 10: 4563 vertices (3.2%)
  Class 16: 4375 vertices (3.0%)
DEBUG: Background predicted: 46203 (31.9%)
DEBUG: Foreground predicted: 98629 (68.1%)
Labels aggregated!
  ‚úì Aggregation complete
  ‚úì Prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-12/pred_7625119
  Loaded P matrix: (37, 144832), vertices: 144832
  Mesh: 144832 vertices, 289660 faces
  Step 1: Smoothing probabilities (20 iter, Œ±=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ‚úì Smoothing complete
  Step 2: MRF refinement (Œ≤=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ‚úì MRF refinement complete

  RESULTS:
  RAW:         median(top-10)=0.7870, mean(top-10)=0.7825, median(all)=0.6953, mean(all)=0.6147
  + SMOOTHING: median(top-10)=0.8746, mean(top-10)=0.8759, median(all)=0.8045, mean(all)=0.7298 [+0.0875]
  + MRF:       median(top-10)=0.8750, mean(top-10)=0.8761, median(all)=0.8044, mean(all)=0.7301 [+0.0004]
  TOTAL IMPROVEMENT (median top-10): +0.0880

================================================================================
Subject: NKI-RS-22-13
================================================================================
  Step 0: Generating predictions with NEW models...
  Using PyTorch3D GPU raycasting (matching training pipeline)...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 121451 vertices, 242898 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (36598 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (92195 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (86311 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (55101 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (36296 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (59009 valid pixels)
  [PyTorch3D] Raycasting complete!
  ‚úì Got 6 output maps, shape: (6, 800, 800, 3)
  Loading trained models...
Loading models...
  Loading Front: Front-epoch=499-validation_loss=0.03.ckpt
  Loading Bottom: Bottom-epoch=499-validation_loss=0.04.ckpt
  Loading Top: Top-epoch=499-validation_loss=0.05.ckpt
  Loading Right: Right-epoch=499-validation_loss=0.04.ckpt
  Loading Back: Back-epoch=499-validation_loss=0.03.ckpt
  Loading Left: Left-epoch=499-validation_loss=0.03.ckpt
Models loaded!
  Running U-Net predictions on 6 views...
Predicting labels...
Labels predicted!
  ‚úì Got predictions from 6 views
  Aggregating predictions to vertices...
Agregating predicted labels...

üîç View 0: 2D predictions for 36598 MESH pixels (before aggregation):
   Class 12: 8489 pixels (23.2%)
   Class 30: 8166 pixels (22.3%)
   Class 9: 7276 pixels (19.9%)
   Class 32: 2559 pixels (7.0%)
   Class 10: 2037 pixels (5.6%)
   ‚Üí Background: 0.1% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0013
   ‚Üí Pixels where class 0 prob > 0.5: 31 (0.1%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9976
   ‚Üí Weights for vertex 0: mean=0.3337, max=0.9976
   ‚Üí Weights for vertex 1: mean=0.3353, max=0.9932
   ‚Üí Weights for vertex 2: mean=0.3313, max=0.9963
   ‚Üí Weights sum to 1? 1.0003

üîç View 1: 2D predictions for 92195 MESH pixels (before aggregation):
   Class 0: 20227 pixels (21.9%)
   Class 29: 16678 pixels (18.1%)
   Class 26: 9614 pixels (10.4%)
   Class 15: 6348 pixels (6.9%)
   Class 18: 5037 pixels (5.5%)
   ‚Üí Background: 21.9% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.2185
   ‚Üí Pixels where class 0 prob > 0.5: 20142 (21.8%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9986

üîç View 2: 2D predictions for 86311 MESH pixels (before aggregation):
   Class 28: 8469 pixels (9.8%)
   Class 25: 7455 pixels (8.6%)
   Class 10: 6903 pixels (8.0%)
   Class 32: 6411 pixels (7.4%)
   Class 16: 6211 pixels (7.2%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0000
   ‚Üí Pixels where class 0 prob > 0.5: 0 (0.0%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9991
DEBUG: Processed 11520000 total pixels, 1096530 valid pixels (9.5%)
DEBUG: Touched 90306.0 vertices out of 121451 (74.4%)
DEBUG: Vertices with zero probability sum: 31145 (25.6%)
DEBUG: Mean class 0 probability for touched vertices: 0.0973
\nDEBUG: Checking for views with high background predictions...
  Front: (see above for stats)
  Bottom: (see above for stats)
  Top: (see above for stats)
  Right: (see above for stats)
  Back: (see above for stats)
  Left: (see above for stats)
DEBUG: After normalization, P sums check: min=0.0000, max=1.0000
DEBUG: Predicted class distribution (before -1 shift):
  Class 0: 37167 vertices (30.6%)
  Class 29: 8747 vertices (7.2%)
  Class 28: 6736 vertices (5.5%)
  Class 25: 5386 vertices (4.4%)
  Class 12: 5102 vertices (4.2%)
  Class 30: 4800 vertices (4.0%)
  Class 9: 4482 vertices (3.7%)
  Class 10: 4254 vertices (3.5%)
  Class 23: 3913 vertices (3.2%)
  Class 14: 3315 vertices (2.7%)
DEBUG: Background predicted: 37167 (30.6%)
DEBUG: Foreground predicted: 84284 (69.4%)
Labels aggregated!
  ‚úì Aggregation complete
  ‚úì Prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-13/pred_7625119
  Loaded P matrix: (37, 121451), vertices: 121451
  Mesh: 121451 vertices, 242898 faces
  Step 1: Smoothing probabilities (20 iter, Œ±=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ‚úì Smoothing complete
  Step 2: MRF refinement (Œ≤=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ‚úì MRF refinement complete

  RESULTS:
  RAW:         median(top-10)=0.8004, mean(top-10)=0.8062, median(all)=0.6970, mean(all)=0.6273
  + SMOOTHING: median(top-10)=0.8800, mean(top-10)=0.8829, median(all)=0.8112, mean(all)=0.7350 [+0.0795]
  + MRF:       median(top-10)=0.8802, mean(top-10)=0.8831, median(all)=0.8114, mean(all)=0.7351 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0798

================================================================================
Subject: NKI-RS-22-14
================================================================================
  Step 0: Generating predictions with NEW models...
  Using PyTorch3D GPU raycasting (matching training pipeline)...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 142823 vertices, 285642 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (38420 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (89373 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (82739 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (57667 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (38739 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (61574 valid pixels)
  [PyTorch3D] Raycasting complete!
  ‚úì Got 6 output maps, shape: (6, 800, 800, 3)
  Loading trained models...
Loading models...
  Loading Front: Front-epoch=499-validation_loss=0.03.ckpt
  Loading Bottom: Bottom-epoch=499-validation_loss=0.04.ckpt
  Loading Top: Top-epoch=499-validation_loss=0.05.ckpt
  Loading Right: Right-epoch=499-validation_loss=0.04.ckpt
  Loading Back: Back-epoch=499-validation_loss=0.03.ckpt
  Loading Left: Left-epoch=499-validation_loss=0.03.ckpt
Models loaded!
  Running U-Net predictions on 6 views...
Predicting labels...
Labels predicted!
  ‚úì Got predictions from 6 views
  Aggregating predictions to vertices...
Agregating predicted labels...

üîç View 0: 2D predictions for 38420 MESH pixels (before aggregation):
   Class 12: 9861 pixels (25.7%)
   Class 30: 8056 pixels (21.0%)
   Class 9: 6263 pixels (16.3%)
   Class 10: 3293 pixels (8.6%)
   Class 8: 2232 pixels (5.8%)
   ‚Üí Background: 1.4% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0149
   ‚Üí Pixels where class 0 prob > 0.5: 518 (1.3%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9943
   ‚Üí Weights for vertex 0: mean=0.3359, max=0.9924
   ‚Üí Weights for vertex 1: mean=0.3320, max=0.9943
   ‚Üí Weights for vertex 2: mean=0.3325, max=0.9937
   ‚Üí Weights sum to 1? 1.0004

üîç View 1: 2D predictions for 89373 MESH pixels (before aggregation):
   Class 29: 17335 pixels (19.4%)
   Class 0: 16627 pixels (18.6%)
   Class 26: 10169 pixels (11.4%)
   Class 14: 6659 pixels (7.5%)
   Class 15: 5908 pixels (6.6%)
   ‚Üí Background: 18.6% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.1830
   ‚Üí Pixels where class 0 prob > 0.5: 16493 (18.5%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9984

üîç View 2: 2D predictions for 82739 MESH pixels (before aggregation):
   Class 9: 8321 pixels (10.1%)
   Class 28: 8070 pixels (9.8%)
   Class 31: 6563 pixels (7.9%)
   Class 23: 6229 pixels (7.5%)
   Class 32: 6137 pixels (7.4%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0001
   ‚Üí Pixels where class 0 prob > 0.5: 2 (0.0%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9992
DEBUG: Processed 11520000 total pixels, 1105536 valid pixels (9.6%)
DEBUG: Touched 102926.0 vertices out of 142823 (72.1%)
DEBUG: Vertices with zero probability sum: 39897 (27.9%)
DEBUG: Mean class 0 probability for touched vertices: 0.0866
\nDEBUG: Checking for views with high background predictions...
  Front: (see above for stats)
  Bottom: (see above for stats)
  Top: (see above for stats)
  Right: (see above for stats)
  Back: (see above for stats)
  Left: (see above for stats)
DEBUG: After normalization, P sums check: min=0.0000, max=1.0000
DEBUG: Predicted class distribution (before -1 shift):
  Class 0: 45881 vertices (32.1%)
  Class 29: 9572 vertices (6.7%)
  Class 28: 6690 vertices (4.7%)
  Class 30: 6298 vertices (4.4%)
  Class 12: 5800 vertices (4.1%)
  Class 9: 5520 vertices (3.9%)
  Class 23: 5174 vertices (3.6%)
  Class 25: 4966 vertices (3.5%)
  Class 14: 4533 vertices (3.2%)
  Class 10: 4257 vertices (3.0%)
DEBUG: Background predicted: 45881 (32.1%)
DEBUG: Foreground predicted: 96942 (67.9%)
Labels aggregated!
  ‚úì Aggregation complete
  ‚úì Prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-14/pred_7625119
  Loaded P matrix: (37, 142823), vertices: 142823
  Mesh: 142823 vertices, 285642 faces
  Step 1: Smoothing probabilities (20 iter, Œ±=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ‚úì Smoothing complete
  Step 2: MRF refinement (Œ≤=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ‚úì MRF refinement complete

  RESULTS:
  RAW:         median(top-10)=0.7893, mean(top-10)=0.7979, median(all)=0.6996, mean(all)=0.6196
  + SMOOTHING: median(top-10)=0.8933, mean(top-10)=0.8859, median(all)=0.8111, mean(all)=0.7326 [+0.1040]
  + MRF:       median(top-10)=0.8943, mean(top-10)=0.8862, median(all)=0.8110, mean(all)=0.7329 [+0.0010]
  TOTAL IMPROVEMENT (median top-10): +0.1050

================================================================================
Subject: NKI-RS-22-15
================================================================================
  Step 0: Generating predictions with NEW models...
  Using PyTorch3D GPU raycasting (matching training pipeline)...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 158740 vertices, 317476 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (52622 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (107581 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (99208 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (68580 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (48994 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (73061 valid pixels)
  [PyTorch3D] Raycasting complete!
  ‚úì Got 6 output maps, shape: (6, 800, 800, 3)
  Loading trained models...
Loading models...
  Loading Front: Front-epoch=499-validation_loss=0.03.ckpt
  Loading Bottom: Bottom-epoch=499-validation_loss=0.04.ckpt
  Loading Top: Top-epoch=499-validation_loss=0.05.ckpt
  Loading Right: Right-epoch=499-validation_loss=0.04.ckpt
  Loading Back: Back-epoch=499-validation_loss=0.03.ckpt
  Loading Left: Left-epoch=499-validation_loss=0.03.ckpt
Models loaded!
  Running U-Net predictions on 6 views...
Predicting labels...
Labels predicted!
  ‚úì Got predictions from 6 views
  Aggregating predictions to vertices...
Agregating predicted labels...

üîç View 0: 2D predictions for 52622 MESH pixels (before aggregation):
   Class 30: 13607 pixels (25.9%)
   Class 12: 11424 pixels (21.7%)
   Class 9: 9022 pixels (17.1%)
   Class 23: 4970 pixels (9.4%)
   Class 32: 3488 pixels (6.6%)
   ‚Üí Background: 0.2% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0018
   ‚Üí Pixels where class 0 prob > 0.5: 74 (0.1%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9984
   ‚Üí Weights for vertex 0: mean=0.3336, max=0.9953
   ‚Üí Weights for vertex 1: mean=0.3328, max=0.9972
   ‚Üí Weights for vertex 2: mean=0.3340, max=0.9984
   ‚Üí Weights sum to 1? 1.0003

üîç View 1: 2D predictions for 107581 MESH pixels (before aggregation):
   Class 29: 21751 pixels (20.2%)
   Class 0: 20425 pixels (19.0%)
   Class 26: 10586 pixels (9.8%)
   Class 15: 7759 pixels (7.2%)
   Class 14: 7204 pixels (6.7%)
   ‚Üí Background: 19.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.1881
   ‚Üí Pixels where class 0 prob > 0.5: 20278 (18.8%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9979

üîç View 2: 2D predictions for 99208 MESH pixels (before aggregation):
   Class 28: 9966 pixels (10.0%)
   Class 16: 9220 pixels (9.3%)
   Class 31: 8732 pixels (8.8%)
   Class 32: 8037 pixels (8.1%)
   Class 9: 7913 pixels (8.0%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0001
   ‚Üí Pixels where class 0 prob > 0.5: 2 (0.0%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9984
DEBUG: Processed 11520000 total pixels, 1350138 valid pixels (11.7%)
DEBUG: Touched 115385.0 vertices out of 158740 (72.7%)
DEBUG: Vertices with zero probability sum: 43355 (27.3%)
DEBUG: Mean class 0 probability for touched vertices: 0.0885
\nDEBUG: Checking for views with high background predictions...
  Front: (see above for stats)
  Bottom: (see above for stats)
  Top: (see above for stats)
  Right: (see above for stats)
  Back: (see above for stats)
  Left: (see above for stats)
DEBUG: After normalization, P sums check: min=0.0000, max=1.0000
DEBUG: Predicted class distribution (before -1 shift):
  Class 0: 50532 vertices (31.8%)
  Class 29: 12246 vertices (7.7%)
  Class 12: 7060 vertices (4.4%)
  Class 28: 6742 vertices (4.2%)
  Class 30: 6275 vertices (4.0%)
  Class 9: 5685 vertices (3.6%)
  Class 23: 5480 vertices (3.5%)
  Class 25: 5318 vertices (3.4%)
  Class 32: 4783 vertices (3.0%)
  Class 10: 4641 vertices (2.9%)
DEBUG: Background predicted: 50532 (31.8%)
DEBUG: Foreground predicted: 108208 (68.2%)
Labels aggregated!
  ‚úì Aggregation complete
  ‚úì Prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-15/pred_7625119
  Loaded P matrix: (37, 158740), vertices: 158740
  Mesh: 158740 vertices, 317476 faces
  Step 1: Smoothing probabilities (20 iter, Œ±=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ‚úì Smoothing complete
  Step 2: MRF refinement (Œ≤=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ‚úì MRF refinement complete

  RESULTS:
  RAW:         median(top-10)=0.7882, mean(top-10)=0.7916, median(all)=0.6678, mean(all)=0.6021
  + SMOOTHING: median(top-10)=0.8692, mean(top-10)=0.8720, median(all)=0.8096, mean(all)=0.7205 [+0.0810]
  + MRF:       median(top-10)=0.8691, mean(top-10)=0.8717, median(all)=0.8100, mean(all)=0.7206 [-0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0809
Skipping NKI-RS-22-16              - missing files

================================================================================
Subject: NKI-RS-22-17
================================================================================
  Step 0: Generating predictions with NEW models...
  Using PyTorch3D GPU raycasting (matching training pipeline)...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 161773 vertices, 323542 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (48573 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (105047 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (96598 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (63636 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (46204 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (68115 valid pixels)
  [PyTorch3D] Raycasting complete!
  ‚úì Got 6 output maps, shape: (6, 800, 800, 3)
  Loading trained models...
Loading models...
  Loading Front: Front-epoch=499-validation_loss=0.03.ckpt
  Loading Bottom: Bottom-epoch=499-validation_loss=0.04.ckpt
  Loading Top: Top-epoch=499-validation_loss=0.05.ckpt
  Loading Right: Right-epoch=499-validation_loss=0.04.ckpt
  Loading Back: Back-epoch=499-validation_loss=0.03.ckpt
  Loading Left: Left-epoch=499-validation_loss=0.03.ckpt
Models loaded!
  Running U-Net predictions on 6 views...
Predicting labels...
Labels predicted!
  ‚úì Got predictions from 6 views
  Aggregating predictions to vertices...
Agregating predicted labels...

üîç View 0: 2D predictions for 48573 MESH pixels (before aggregation):
   Class 30: 13477 pixels (27.7%)
   Class 12: 13034 pixels (26.8%)
   Class 9: 9299 pixels (19.1%)
   Class 32: 2671 pixels (5.5%)
   Class 10: 2625 pixels (5.4%)
   ‚Üí Background: 0.1% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0013
   ‚Üí Pixels where class 0 prob > 0.5: 9 (0.0%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=1.0034
   ‚Üí Weights for vertex 0: mean=0.3337, max=1.0034
   ‚Üí Weights for vertex 1: mean=0.3327, max=0.9994
   ‚Üí Weights for vertex 2: mean=0.3339, max=0.9911
   ‚Üí Weights sum to 1? 1.0003

üîç View 1: 2D predictions for 105047 MESH pixels (before aggregation):
   Class 29: 20872 pixels (19.9%)
   Class 0: 19634 pixels (18.7%)
   Class 26: 12089 pixels (11.5%)
   Class 14: 7050 pixels (6.7%)
   Class 15: 6818 pixels (6.5%)
   ‚Üí Background: 18.7% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.1860
   ‚Üí Pixels where class 0 prob > 0.5: 19559 (18.6%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9988

üîç View 2: 2D predictions for 96598 MESH pixels (before aggregation):
   Class 28: 9066 pixels (9.4%)
   Class 9: 9034 pixels (9.4%)
   Class 16: 8589 pixels (8.9%)
   Class 23: 8003 pixels (8.3%)
   Class 32: 7730 pixels (8.0%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0001
   ‚Üí Pixels where class 0 prob > 0.5: 3 (0.0%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9989
DEBUG: Processed 11520000 total pixels, 1284519 valid pixels (11.2%)
DEBUG: Touched 115472.0 vertices out of 161773 (71.4%)
DEBUG: Vertices with zero probability sum: 46301 (28.6%)
DEBUG: Mean class 0 probability for touched vertices: 0.0729
\nDEBUG: Checking for views with high background predictions...
  Front: (see above for stats)
  Bottom: (see above for stats)
  Top: (see above for stats)
  Right: (see above for stats)
  Back: (see above for stats)
  Left: (see above for stats)
DEBUG: After normalization, P sums check: min=0.0000, max=1.0000
DEBUG: Predicted class distribution (before -1 shift):
  Class 0: 52599 vertices (32.5%)
  Class 29: 10579 vertices (6.5%)
  Class 30: 8130 vertices (5.0%)
  Class 28: 7771 vertices (4.8%)
  Class 12: 6633 vertices (4.1%)
  Class 9: 6226 vertices (3.8%)
  Class 23: 6074 vertices (3.8%)
  Class 25: 5794 vertices (3.6%)
  Class 10: 4752 vertices (2.9%)
  Class 26: 4584 vertices (2.8%)
DEBUG: Background predicted: 52599 (32.5%)
DEBUG: Foreground predicted: 109174 (67.5%)
Labels aggregated!
  ‚úì Aggregation complete
  ‚úì Prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-17/pred_7625119
  Loaded P matrix: (37, 161773), vertices: 161773
  Mesh: 161773 vertices, 323542 faces
  Step 1: Smoothing probabilities (20 iter, Œ±=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ‚úì Smoothing complete
  Step 2: MRF refinement (Œ≤=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ‚úì MRF refinement complete

  RESULTS:
  RAW:         median(top-10)=0.7794, mean(top-10)=0.7845, median(all)=0.6888, mean(all)=0.6025
  + SMOOTHING: median(top-10)=0.8827, mean(top-10)=0.8831, median(all)=0.8168, mean(all)=0.7331 [+0.1033]
  + MRF:       median(top-10)=0.8829, mean(top-10)=0.8834, median(all)=0.8173, mean(all)=0.7333 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.1035

================================================================================
Subject: NKI-RS-22-18
================================================================================
  Step 0: Generating predictions with NEW models...
  Using PyTorch3D GPU raycasting (matching training pipeline)...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 147633 vertices, 295262 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (40958 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (99199 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (93062 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (57401 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (40878 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (60794 valid pixels)
  [PyTorch3D] Raycasting complete!
  ‚úì Got 6 output maps, shape: (6, 800, 800, 3)
  Loading trained models...
Loading models...
  Loading Front: Front-epoch=499-validation_loss=0.03.ckpt
  Loading Bottom: Bottom-epoch=499-validation_loss=0.04.ckpt
  Loading Top: Top-epoch=499-validation_loss=0.05.ckpt
  Loading Right: Right-epoch=499-validation_loss=0.04.ckpt
  Loading Back: Back-epoch=499-validation_loss=0.03.ckpt
  Loading Left: Left-epoch=499-validation_loss=0.03.ckpt
Models loaded!
  Running U-Net predictions on 6 views...
Predicting labels...
Labels predicted!
  ‚úì Got predictions from 6 views
  Aggregating predictions to vertices...
Agregating predicted labels...

üîç View 0: 2D predictions for 40958 MESH pixels (before aggregation):
   Class 12: 10751 pixels (26.2%)
   Class 9: 8852 pixels (21.6%)
   Class 30: 7881 pixels (19.2%)
   Class 10: 2462 pixels (6.0%)
   Class 32: 2026 pixels (4.9%)
   ‚Üí Background: 0.9% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0087
   ‚Üí Pixels where class 0 prob > 0.5: 342 (0.8%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9969
   ‚Üí Weights for vertex 0: mean=0.3333, max=0.9946
   ‚Üí Weights for vertex 1: mean=0.3331, max=0.9968
   ‚Üí Weights for vertex 2: mean=0.3339, max=0.9969
   ‚Üí Weights sum to 1? 1.0004

üîç View 1: 2D predictions for 99199 MESH pixels (before aggregation):
   Class 29: 20294 pixels (20.5%)
   Class 0: 18513 pixels (18.7%)
   Class 26: 12311 pixels (12.4%)
   Class 15: 6496 pixels (6.5%)
   Class 14: 6236 pixels (6.3%)
   ‚Üí Background: 18.7% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.1862
   ‚Üí Pixels where class 0 prob > 0.5: 18422 (18.6%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9988

üîç View 2: 2D predictions for 93062 MESH pixels (before aggregation):
   Class 9: 9149 pixels (9.8%)
   Class 25: 8493 pixels (9.1%)
   Class 16: 8119 pixels (8.7%)
   Class 31: 7865 pixels (8.5%)
   Class 23: 7504 pixels (8.1%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0001
   ‚Üí Pixels where class 0 prob > 0.5: 4 (0.0%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9983
DEBUG: Processed 11520000 total pixels, 1176876 valid pixels (10.2%)
DEBUG: Touched 107126.0 vertices out of 147633 (72.6%)
DEBUG: Vertices with zero probability sum: 40507 (27.4%)
DEBUG: Mean class 0 probability for touched vertices: 0.0881
\nDEBUG: Checking for views with high background predictions...
  Front: (see above for stats)
  Bottom: (see above for stats)
  Top: (see above for stats)
  Right: (see above for stats)
  Back: (see above for stats)
  Left: (see above for stats)
DEBUG: After normalization, P sums check: min=0.0000, max=1.0000
DEBUG: Predicted class distribution (before -1 shift):
  Class 0: 46977 vertices (31.8%)
  Class 29: 10807 vertices (7.3%)
  Class 12: 6774 vertices (4.6%)
  Class 28: 6695 vertices (4.5%)
  Class 25: 6383 vertices (4.3%)
  Class 9: 5961 vertices (4.0%)
  Class 23: 5041 vertices (3.4%)
  Class 30: 4767 vertices (3.2%)
  Class 10: 4688 vertices (3.2%)
  Class 26: 4425 vertices (3.0%)
DEBUG: Background predicted: 46977 (31.8%)
DEBUG: Foreground predicted: 100656 (68.2%)
Labels aggregated!
  ‚úì Aggregation complete
  ‚úì Prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-18/pred_7625119
  Loaded P matrix: (37, 147633), vertices: 147633
  Mesh: 147633 vertices, 295262 faces
  Step 1: Smoothing probabilities (20 iter, Œ±=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ‚úì Smoothing complete
  Step 2: MRF refinement (Œ≤=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
    MRF iteration 5/5...
  ‚úì MRF refinement complete

  RESULTS:
  RAW:         median(top-10)=0.7991, mean(top-10)=0.7908, median(all)=0.6629, mean(all)=0.5874
  + SMOOTHING: median(top-10)=0.8732, mean(top-10)=0.8773, median(all)=0.7909, mean(all)=0.7084 [+0.0742]
  + MRF:       median(top-10)=0.8735, mean(top-10)=0.8774, median(all)=0.7912, mean(all)=0.7088 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0745

================================================================================
Subject: NKI-RS-22-19
================================================================================
  Step 0: Generating predictions with NEW models...
  Using PyTorch3D GPU raycasting (matching training pipeline)...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 141397 vertices, 282790 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (39596 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (90573 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (84472 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (55290 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (40823 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (58701 valid pixels)
  [PyTorch3D] Raycasting complete!
  ‚úì Got 6 output maps, shape: (6, 800, 800, 3)
  Loading trained models...
Loading models...
  Loading Front: Front-epoch=499-validation_loss=0.03.ckpt
  Loading Bottom: Bottom-epoch=499-validation_loss=0.04.ckpt
  Loading Top: Top-epoch=499-validation_loss=0.05.ckpt
  Loading Right: Right-epoch=499-validation_loss=0.04.ckpt
  Loading Back: Back-epoch=499-validation_loss=0.03.ckpt
  Loading Left: Left-epoch=499-validation_loss=0.03.ckpt
Models loaded!
  Running U-Net predictions on 6 views...
Predicting labels...
Labels predicted!
  ‚úì Got predictions from 6 views
  Aggregating predictions to vertices...
Agregating predicted labels...

üîç View 0: 2D predictions for 39596 MESH pixels (before aggregation):
   Class 12: 10329 pixels (26.1%)
   Class 30: 6954 pixels (17.6%)
   Class 9: 5620 pixels (14.2%)
   Class 10: 4029 pixels (10.2%)
   Class 8: 2200 pixels (5.6%)
   ‚Üí Background: 2.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0207
   ‚Üí Pixels where class 0 prob > 0.5: 779 (2.0%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9982
   ‚Üí Weights for vertex 0: mean=0.3338, max=0.9949
   ‚Üí Weights for vertex 1: mean=0.3327, max=0.9982
   ‚Üí Weights for vertex 2: mean=0.3339, max=0.9949
   ‚Üí Weights sum to 1? 1.0003

üîç View 1: 2D predictions for 90573 MESH pixels (before aggregation):
   Class 0: 19328 pixels (21.3%)
   Class 29: 19293 pixels (21.3%)
   Class 26: 8015 pixels (8.8%)
   Class 15: 6077 pixels (6.7%)
   Class 14: 5474 pixels (6.0%)
   ‚Üí Background: 21.3% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.2109
   ‚Üí Pixels where class 0 prob > 0.5: 19217 (21.2%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9989

üîç View 2: 2D predictions for 84472 MESH pixels (before aggregation):
   Class 28: 9460 pixels (11.2%)
   Class 31: 8190 pixels (9.7%)
   Class 9: 7381 pixels (8.7%)
   Class 16: 6076 pixels (7.2%)
   Class 25: 6061 pixels (7.2%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0001
   ‚Üí Pixels where class 0 prob > 0.5: 1 (0.0%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9994
DEBUG: Processed 11520000 total pixels, 1108365 valid pixels (9.6%)
DEBUG: Touched 100736.0 vertices out of 141397 (71.2%)
DEBUG: Vertices with zero probability sum: 40661 (28.8%)
DEBUG: Mean class 0 probability for touched vertices: 0.0857
\nDEBUG: Checking for views with high background predictions...
  Front: (see above for stats)
  Bottom: (see above for stats)
  Top: (see above for stats)
  Right: (see above for stats)
  Back: (see above for stats)
  Left: (see above for stats)
DEBUG: After normalization, P sums check: min=0.0000, max=1.0000
DEBUG: Predicted class distribution (before -1 shift):
  Class 0: 46464 vertices (32.9%)
  Class 29: 9988 vertices (7.1%)
  Class 28: 7692 vertices (5.4%)
  Class 12: 6252 vertices (4.4%)
  Class 30: 5454 vertices (3.9%)
  Class 25: 5122 vertices (3.6%)
  Class 23: 4942 vertices (3.5%)
  Class 10: 4544 vertices (3.2%)
  Class 9: 4502 vertices (3.2%)
  Class 31: 4218 vertices (3.0%)
DEBUG: Background predicted: 46464 (32.9%)
DEBUG: Foreground predicted: 94933 (67.1%)
Labels aggregated!
  ‚úì Aggregation complete
  ‚úì Prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-19/pred_7625119
  Loaded P matrix: (37, 141397), vertices: 141397
  Mesh: 141397 vertices, 282790 faces
  Step 1: Smoothing probabilities (20 iter, Œ±=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ‚úì Smoothing complete
  Step 2: MRF refinement (Œ≤=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ‚úì MRF refinement complete

  RESULTS:
  RAW:         median(top-10)=0.7882, mean(top-10)=0.7869, median(all)=0.6653, mean(all)=0.5938
  + SMOOTHING: median(top-10)=0.8753, mean(top-10)=0.8786, median(all)=0.8117, mean(all)=0.7277 [+0.0871]
  + MRF:       median(top-10)=0.8759, mean(top-10)=0.8787, median(all)=0.8125, mean(all)=0.7280 [+0.0006]
  TOTAL IMPROVEMENT (median top-10): +0.0877

================================================================================
Subject: NKI-RS-22-2
================================================================================
  Step 0: Generating predictions with NEW models...
  Using PyTorch3D GPU raycasting (matching training pipeline)...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 137791 vertices, 275578 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (41713 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (98370 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (91177 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (59941 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (42811 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (64305 valid pixels)
  [PyTorch3D] Raycasting complete!
  ‚úì Got 6 output maps, shape: (6, 800, 800, 3)
  Loading trained models...
Loading models...
  Loading Front: Front-epoch=499-validation_loss=0.03.ckpt
  Loading Bottom: Bottom-epoch=499-validation_loss=0.04.ckpt
  Loading Top: Top-epoch=499-validation_loss=0.05.ckpt
  Loading Right: Right-epoch=499-validation_loss=0.04.ckpt
  Loading Back: Back-epoch=499-validation_loss=0.03.ckpt
  Loading Left: Left-epoch=499-validation_loss=0.03.ckpt
Models loaded!
  Running U-Net predictions on 6 views...
Predicting labels...
Labels predicted!
  ‚úì Got predictions from 6 views
  Aggregating predictions to vertices...
Agregating predicted labels...

üîç View 0: 2D predictions for 41713 MESH pixels (before aggregation):
   Class 12: 11636 pixels (27.9%)
   Class 30: 10798 pixels (25.9%)
   Class 9: 7223 pixels (17.3%)
   Class 10: 2965 pixels (7.1%)
   Class 32: 1741 pixels (4.2%)
   ‚Üí Background: 0.5% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0043
   ‚Üí Pixels where class 0 prob > 0.5: 190 (0.5%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9947
   ‚Üí Weights for vertex 0: mean=0.3356, max=0.9947
   ‚Üí Weights for vertex 1: mean=0.3332, max=0.9942
   ‚Üí Weights for vertex 2: mean=0.3315, max=0.9923
   ‚Üí Weights sum to 1? 1.0003

üîç View 1: 2D predictions for 98370 MESH pixels (before aggregation):
   Class 0: 19988 pixels (20.3%)
   Class 29: 19278 pixels (19.6%)
   Class 26: 11781 pixels (12.0%)
   Class 14: 6565 pixels (6.7%)
   Class 15: 6181 pixels (6.3%)
   ‚Üí Background: 20.3% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.2020
   ‚Üí Pixels where class 0 prob > 0.5: 19891 (20.2%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9993

üîç View 2: 2D predictions for 91177 MESH pixels (before aggregation):
   Class 28: 9705 pixels (10.6%)
   Class 32: 8314 pixels (9.1%)
   Class 9: 8134 pixels (8.9%)
   Class 23: 7639 pixels (8.4%)
   Class 16: 7390 pixels (8.1%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0001
   ‚Üí Pixels where class 0 prob > 0.5: 1 (0.0%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9994
DEBUG: Processed 11520000 total pixels, 1194951 valid pixels (10.4%)
DEBUG: Touched 98822.0 vertices out of 137791 (71.7%)
DEBUG: Vertices with zero probability sum: 38969 (28.3%)
DEBUG: Mean class 0 probability for touched vertices: 0.0834
\nDEBUG: Checking for views with high background predictions...
  Front: (see above for stats)
  Bottom: (see above for stats)
  Top: (see above for stats)
  Right: (see above for stats)
  Back: (see above for stats)
  Left: (see above for stats)
DEBUG: After normalization, P sums check: min=0.0000, max=1.0000
DEBUG: Predicted class distribution (before -1 shift):
  Class 0: 44733 vertices (32.5%)
  Class 29: 9154 vertices (6.6%)
  Class 28: 7601 vertices (5.5%)
  Class 12: 6103 vertices (4.4%)
  Class 30: 6007 vertices (4.4%)
  Class 25: 5308 vertices (3.9%)
  Class 9: 4990 vertices (3.6%)
  Class 23: 4838 vertices (3.5%)
  Class 32: 4134 vertices (3.0%)
  Class 10: 3820 vertices (2.8%)
DEBUG: Background predicted: 44733 (32.5%)
DEBUG: Foreground predicted: 93058 (67.5%)
Labels aggregated!
  ‚úì Aggregation complete
  ‚úì Prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-2/pred_7625119
  Loaded P matrix: (37, 137791), vertices: 137791
  Mesh: 137791 vertices, 275578 faces
  Step 1: Smoothing probabilities (20 iter, Œ±=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ‚úì Smoothing complete
  Step 2: MRF refinement (Œ≤=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ‚úì MRF refinement complete

  RESULTS:
  RAW:         median(top-10)=0.8165, mean(top-10)=0.8114, median(all)=0.6885, mean(all)=0.6086
  + SMOOTHING: median(top-10)=0.8783, mean(top-10)=0.8772, median(all)=0.8056, mean(all)=0.7237 [+0.0617]
  + MRF:       median(top-10)=0.8785, mean(top-10)=0.8774, median(all)=0.8051, mean(all)=0.7238 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0619

================================================================================
Subject: NKI-RS-22-20
================================================================================
  Step 0: Generating predictions with NEW models...
  Using PyTorch3D GPU raycasting (matching training pipeline)...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 140825 vertices, 281646 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (46994 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (98993 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (91927 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (64277 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (44569 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (69436 valid pixels)
  [PyTorch3D] Raycasting complete!
  ‚úì Got 6 output maps, shape: (6, 800, 800, 3)
  Loading trained models...
Loading models...
  Loading Front: Front-epoch=499-validation_loss=0.03.ckpt
  Loading Bottom: Bottom-epoch=499-validation_loss=0.04.ckpt
  Loading Top: Top-epoch=499-validation_loss=0.05.ckpt
  Loading Right: Right-epoch=499-validation_loss=0.04.ckpt
  Loading Back: Back-epoch=499-validation_loss=0.03.ckpt
  Loading Left: Left-epoch=499-validation_loss=0.03.ckpt
Models loaded!
  Running U-Net predictions on 6 views...
Predicting labels...
Labels predicted!
  ‚úì Got predictions from 6 views
  Aggregating predictions to vertices...
Agregating predicted labels...

üîç View 0: 2D predictions for 46994 MESH pixels (before aggregation):
   Class 12: 11599 pixels (24.7%)
   Class 30: 11111 pixels (23.6%)
   Class 9: 8986 pixels (19.1%)
   Class 32: 2820 pixels (6.0%)
   Class 16: 2375 pixels (5.1%)
   ‚Üí Background: 0.1% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0016
   ‚Üí Pixels where class 0 prob > 0.5: 15 (0.0%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9988
   ‚Üí Weights for vertex 0: mean=0.3349, max=0.9907
   ‚Üí Weights for vertex 1: mean=0.3330, max=0.9931
   ‚Üí Weights for vertex 2: mean=0.3324, max=0.9988
   ‚Üí Weights sum to 1? 1.0003

üîç View 1: 2D predictions for 98993 MESH pixels (before aggregation):
   Class 0: 21515 pixels (21.7%)
   Class 29: 17427 pixels (17.6%)
   Class 26: 11327 pixels (11.4%)
   Class 15: 7064 pixels (7.1%)
   Class 18: 6983 pixels (7.1%)
   ‚Üí Background: 21.7% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.2163
   ‚Üí Pixels where class 0 prob > 0.5: 21417 (21.6%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9978

üîç View 2: 2D predictions for 91927 MESH pixels (before aggregation):
   Class 28: 10244 pixels (11.1%)
   Class 16: 9061 pixels (9.9%)
   Class 9: 8466 pixels (9.2%)
   Class 23: 6618 pixels (7.2%)
   Class 31: 6554 pixels (7.1%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0001
   ‚Üí Pixels where class 0 prob > 0.5: 0 (0.0%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9980
DEBUG: Processed 11520000 total pixels, 1248588 valid pixels (10.8%)
DEBUG: Touched 102843.0 vertices out of 140825 (73.0%)
DEBUG: Vertices with zero probability sum: 37982 (27.0%)
DEBUG: Mean class 0 probability for touched vertices: 0.0897
\nDEBUG: Checking for views with high background predictions...
  Front: (see above for stats)
  Bottom: (see above for stats)
  Top: (see above for stats)
  Right: (see above for stats)
  Back: (see above for stats)
  Left: (see above for stats)
DEBUG: After normalization, P sums check: min=0.0000, max=1.0000
DEBUG: Predicted class distribution (before -1 shift):
  Class 0: 44331 vertices (31.5%)
  Class 29: 8333 vertices (5.9%)
  Class 28: 6903 vertices (4.9%)
  Class 30: 6569 vertices (4.7%)
  Class 12: 5941 vertices (4.2%)
  Class 9: 5704 vertices (4.1%)
  Class 25: 5050 vertices (3.6%)
  Class 23: 4930 vertices (3.5%)
  Class 10: 4515 vertices (3.2%)
  Class 16: 4325 vertices (3.1%)
DEBUG: Background predicted: 44331 (31.5%)
DEBUG: Foreground predicted: 96494 (68.5%)
Labels aggregated!
  ‚úì Aggregation complete
  ‚úì Prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-20/pred_7625119
  Loaded P matrix: (37, 140825), vertices: 140825
  Mesh: 140825 vertices, 281646 faces
  Step 1: Smoothing probabilities (20 iter, Œ±=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ‚úì Smoothing complete
  Step 2: MRF refinement (Œ≤=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
    MRF iteration 5/5...
  ‚úì MRF refinement complete

  RESULTS:
  RAW:         median(top-10)=0.7598, mean(top-10)=0.7633, median(all)=0.6684, mean(all)=0.5979
  + SMOOTHING: median(top-10)=0.8747, mean(top-10)=0.8704, median(all)=0.7833, mean(all)=0.7212 [+0.1149]
  + MRF:       median(top-10)=0.8753, mean(top-10)=0.8709, median(all)=0.7842, mean(all)=0.7218 [+0.0006]
  TOTAL IMPROVEMENT (median top-10): +0.1155

================================================================================
Subject: NKI-RS-22-21
================================================================================
  Step 0: Generating predictions with NEW models...
  Using PyTorch3D GPU raycasting (matching training pipeline)...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 138920 vertices, 277836 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (37030 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (91149 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (84535 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (57596 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (38904 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (61445 valid pixels)
  [PyTorch3D] Raycasting complete!
  ‚úì Got 6 output maps, shape: (6, 800, 800, 3)
  Loading trained models...
Loading models...
  Loading Front: Front-epoch=499-validation_loss=0.03.ckpt
  Loading Bottom: Bottom-epoch=499-validation_loss=0.04.ckpt
  Loading Top: Top-epoch=499-validation_loss=0.05.ckpt
  Loading Right: Right-epoch=499-validation_loss=0.04.ckpt
  Loading Back: Back-epoch=499-validation_loss=0.03.ckpt
  Loading Left: Left-epoch=499-validation_loss=0.03.ckpt
Models loaded!
  Running U-Net predictions on 6 views...
Predicting labels...
Labels predicted!
  ‚úì Got predictions from 6 views
  Aggregating predictions to vertices...
Agregating predicted labels...

üîç View 0: 2D predictions for 37030 MESH pixels (before aggregation):
   Class 12: 10082 pixels (27.2%)
   Class 9: 7316 pixels (19.8%)
   Class 30: 6891 pixels (18.6%)
   Class 10: 2838 pixels (7.7%)
   Class 32: 1971 pixels (5.3%)
   ‚Üí Background: 0.1% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0013
   ‚Üí Pixels where class 0 prob > 0.5: 23 (0.1%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9991
   ‚Üí Weights for vertex 0: mean=0.3336, max=0.9963
   ‚Üí Weights for vertex 1: mean=0.3325, max=0.9991
   ‚Üí Weights for vertex 2: mean=0.3343, max=0.9935
   ‚Üí Weights sum to 1? 1.0004

üîç View 1: 2D predictions for 91149 MESH pixels (before aggregation):
   Class 0: 17924 pixels (19.7%)
   Class 29: 16886 pixels (18.5%)
   Class 26: 8522 pixels (9.3%)
   Class 15: 6385 pixels (7.0%)
   Class 18: 5927 pixels (6.5%)
   ‚Üí Background: 19.7% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.1949
   ‚Üí Pixels where class 0 prob > 0.5: 17805 (19.5%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=1.0000

üîç View 2: 2D predictions for 84535 MESH pixels (before aggregation):
   Class 28: 8406 pixels (9.9%)
   Class 31: 7700 pixels (9.1%)
   Class 25: 7342 pixels (8.7%)
   Class 32: 6791 pixels (8.0%)
   Class 9: 6654 pixels (7.9%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0001
   ‚Üí Pixels where class 0 prob > 0.5: 1 (0.0%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9982
DEBUG: Processed 11520000 total pixels, 1111977 valid pixels (9.7%)
DEBUG: Touched 100277.0 vertices out of 138920 (72.2%)
DEBUG: Vertices with zero probability sum: 38643 (27.8%)
DEBUG: Mean class 0 probability for touched vertices: 0.0768
\nDEBUG: Checking for views with high background predictions...
  Front: (see above for stats)
  Bottom: (see above for stats)
  Top: (see above for stats)
  Right: (see above for stats)
  Back: (see above for stats)
  Left: (see above for stats)
DEBUG: After normalization, P sums check: min=0.0000, max=1.0000
DEBUG: Predicted class distribution (before -1 shift):
  Class 0: 44320 vertices (31.9%)
  Class 29: 9867 vertices (7.1%)
  Class 28: 6306 vertices (4.5%)
  Class 12: 5778 vertices (4.2%)
  Class 25: 5730 vertices (4.1%)
  Class 30: 4761 vertices (3.4%)
  Class 10: 4588 vertices (3.3%)
  Class 23: 4446 vertices (3.2%)
  Class 32: 4363 vertices (3.1%)
  Class 9: 4328 vertices (3.1%)
DEBUG: Background predicted: 44320 (31.9%)
DEBUG: Foreground predicted: 94600 (68.1%)
Labels aggregated!
  ‚úì Aggregation complete
  ‚úì Prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-21/pred_7625119
  Loaded P matrix: (37, 138920), vertices: 138920
  Mesh: 138920 vertices, 277836 faces
  Step 1: Smoothing probabilities (20 iter, Œ±=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ‚úì Smoothing complete
  Step 2: MRF refinement (Œ≤=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ‚úì MRF refinement complete

  RESULTS:
  RAW:         median(top-10)=0.8148, mean(top-10)=0.8146, median(all)=0.6750, mean(all)=0.6211
  + SMOOTHING: median(top-10)=0.8810, mean(top-10)=0.8819, median(all)=0.8101, mean(all)=0.7363 [+0.0662]
  + MRF:       median(top-10)=0.8815, mean(top-10)=0.8825, median(all)=0.8108, mean(all)=0.7368 [+0.0005]
  TOTAL IMPROVEMENT (median top-10): +0.0667

================================================================================
Subject: NKI-RS-22-22
================================================================================
  Step 0: Generating predictions with NEW models...
  Using PyTorch3D GPU raycasting (matching training pipeline)...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 129976 vertices, 259948 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (40622 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (89596 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (82409 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (60325 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (40560 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (63598 valid pixels)
  [PyTorch3D] Raycasting complete!
  ‚úì Got 6 output maps, shape: (6, 800, 800, 3)
  Loading trained models...
Loading models...
  Loading Front: Front-epoch=499-validation_loss=0.03.ckpt
  Loading Bottom: Bottom-epoch=499-validation_loss=0.04.ckpt
  Loading Top: Top-epoch=499-validation_loss=0.05.ckpt
  Loading Right: Right-epoch=499-validation_loss=0.04.ckpt
  Loading Back: Back-epoch=499-validation_loss=0.03.ckpt
  Loading Left: Left-epoch=499-validation_loss=0.03.ckpt
Models loaded!
  Running U-Net predictions on 6 views...
Predicting labels...
Labels predicted!
  ‚úì Got predictions from 6 views
  Aggregating predictions to vertices...
Agregating predicted labels...

üîç View 0: 2D predictions for 40622 MESH pixels (before aggregation):
   Class 12: 11561 pixels (28.5%)
   Class 30: 8973 pixels (22.1%)
   Class 9: 6076 pixels (15.0%)
   Class 10: 3461 pixels (8.5%)
   Class 32: 2337 pixels (5.8%)
   ‚Üí Background: 0.1% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0010
   ‚Üí Pixels where class 0 prob > 0.5: 12 (0.0%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9979
   ‚Üí Weights for vertex 0: mean=0.3349, max=0.9923
   ‚Üí Weights for vertex 1: mean=0.3337, max=0.9979
   ‚Üí Weights for vertex 2: mean=0.3317, max=0.9931
   ‚Üí Weights sum to 1? 1.0003

üîç View 1: 2D predictions for 89596 MESH pixels (before aggregation):
   Class 29: 18073 pixels (20.2%)
   Class 0: 17976 pixels (20.1%)
   Class 26: 9635 pixels (10.8%)
   Class 15: 6138 pixels (6.9%)
   Class 18: 5665 pixels (6.3%)
   ‚Üí Background: 20.1% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.1977
   ‚Üí Pixels where class 0 prob > 0.5: 17886 (20.0%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9987

üîç View 2: 2D predictions for 82409 MESH pixels (before aggregation):
   Class 28: 10101 pixels (12.3%)
   Class 16: 6985 pixels (8.5%)
   Class 25: 6751 pixels (8.2%)
   Class 32: 6586 pixels (8.0%)
   Class 9: 6368 pixels (7.7%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0001
   ‚Üí Pixels where class 0 prob > 0.5: 1 (0.0%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9986
DEBUG: Processed 11520000 total pixels, 1131330 valid pixels (9.8%)
DEBUG: Touched 94232.0 vertices out of 129976 (72.5%)
DEBUG: Vertices with zero probability sum: 35744 (27.5%)
DEBUG: Mean class 0 probability for touched vertices: 0.0772
\nDEBUG: Checking for views with high background predictions...
  Front: (see above for stats)
  Bottom: (see above for stats)
  Top: (see above for stats)
  Right: (see above for stats)
  Back: (see above for stats)
  Left: (see above for stats)
DEBUG: After normalization, P sums check: min=0.0000, max=1.0000
DEBUG: Predicted class distribution (before -1 shift):
  Class 0: 41015 vertices (31.6%)
  Class 29: 9255 vertices (7.1%)
  Class 28: 7749 vertices (6.0%)
  Class 12: 5857 vertices (4.5%)
  Class 30: 5124 vertices (3.9%)
  Class 25: 4994 vertices (3.8%)
  Class 10: 4292 vertices (3.3%)
  Class 9: 4032 vertices (3.1%)
  Class 23: 3919 vertices (3.0%)
  Class 32: 3870 vertices (3.0%)
DEBUG: Background predicted: 41015 (31.6%)
DEBUG: Foreground predicted: 88961 (68.4%)
Labels aggregated!
  ‚úì Aggregation complete
  ‚úì Prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-22/pred_7625119
  Loaded P matrix: (37, 129976), vertices: 129976
  Mesh: 129976 vertices, 259948 faces
  Step 1: Smoothing probabilities (20 iter, Œ±=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ‚úì Smoothing complete
  Step 2: MRF refinement (Œ≤=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
    MRF iteration 5/5...
  ‚úì MRF refinement complete

  RESULTS:
  RAW:         median(top-10)=0.8028, mean(top-10)=0.7994, median(all)=0.6852, mean(all)=0.6025
  + SMOOTHING: median(top-10)=0.8837, mean(top-10)=0.8824, median(all)=0.8042, mean(all)=0.7091 [+0.0809]
  + MRF:       median(top-10)=0.8839, mean(top-10)=0.8827, median(all)=0.8048, mean(all)=0.7093 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0811

================================================================================
Subject: NKI-RS-22-3
================================================================================
  Step 0: Generating predictions with NEW models...
  Using PyTorch3D GPU raycasting (matching training pipeline)...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 136714 vertices, 273424 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (45893 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (104259 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (96665 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (65161 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (46438 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (69652 valid pixels)
  [PyTorch3D] Raycasting complete!
  ‚úì Got 6 output maps, shape: (6, 800, 800, 3)
  Loading trained models...
Loading models...
  Loading Front: Front-epoch=499-validation_loss=0.03.ckpt
  Loading Bottom: Bottom-epoch=499-validation_loss=0.04.ckpt
  Loading Top: Top-epoch=499-validation_loss=0.05.ckpt
  Loading Right: Right-epoch=499-validation_loss=0.04.ckpt
  Loading Back: Back-epoch=499-validation_loss=0.03.ckpt
  Loading Left: Left-epoch=499-validation_loss=0.03.ckpt
Models loaded!
  Running U-Net predictions on 6 views...
Predicting labels...
Labels predicted!
  ‚úì Got predictions from 6 views
  Aggregating predictions to vertices...
Agregating predicted labels...

üîç View 0: 2D predictions for 45893 MESH pixels (before aggregation):
   Class 12: 16331 pixels (35.6%)
   Class 9: 9198 pixels (20.0%)
   Class 30: 5319 pixels (11.6%)
   Class 16: 2576 pixels (5.6%)
   Class 10: 2374 pixels (5.2%)
   ‚Üí Background: 0.4% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0041
   ‚Üí Pixels where class 0 prob > 0.5: 136 (0.3%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9995
   ‚Üí Weights for vertex 0: mean=0.3347, max=0.9982
   ‚Üí Weights for vertex 1: mean=0.3316, max=0.9995
   ‚Üí Weights for vertex 2: mean=0.3340, max=0.9960
   ‚Üí Weights sum to 1? 1.0003

üîç View 1: 2D predictions for 104259 MESH pixels (before aggregation):
   Class 0: 18966 pixels (18.2%)
   Class 29: 17166 pixels (16.5%)
   Class 26: 10960 pixels (10.5%)
   Class 15: 8359 pixels (8.0%)
   Class 14: 6443 pixels (6.2%)
   ‚Üí Background: 18.2% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.1805
   ‚Üí Pixels where class 0 prob > 0.5: 18844 (18.1%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9990

üîç View 2: 2D predictions for 96665 MESH pixels (before aggregation):
   Class 9: 11362 pixels (11.8%)
   Class 23: 8249 pixels (8.5%)
   Class 28: 7541 pixels (7.8%)
   Class 32: 7470 pixels (7.7%)
   Class 16: 7272 pixels (7.5%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0001
   ‚Üí Pixels where class 0 prob > 0.5: 2 (0.0%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9999
DEBUG: Processed 11520000 total pixels, 1284204 valid pixels (11.1%)
DEBUG: Touched 97168.0 vertices out of 136714 (71.1%)
DEBUG: Vertices with zero probability sum: 39546 (28.9%)
DEBUG: Mean class 0 probability for touched vertices: 0.0775
\nDEBUG: Checking for views with high background predictions...
  Front: (see above for stats)
  Bottom: (see above for stats)
  Top: (see above for stats)
  Right: (see above for stats)
  Back: (see above for stats)
  Left: (see above for stats)
DEBUG: After normalization, P sums check: min=0.0000, max=1.0000
DEBUG: Predicted class distribution (before -1 shift):
  Class 0: 44761 vertices (32.7%)
  Class 29: 8505 vertices (6.2%)
  Class 12: 6940 vertices (5.1%)
  Class 9: 6438 vertices (4.7%)
  Class 28: 6242 vertices (4.6%)
  Class 23: 4373 vertices (3.2%)
  Class 30: 4280 vertices (3.1%)
  Class 25: 4232 vertices (3.1%)
  Class 10: 3854 vertices (2.8%)
  Class 14: 3773 vertices (2.8%)
DEBUG: Background predicted: 44761 (32.7%)
DEBUG: Foreground predicted: 91953 (67.3%)
Labels aggregated!
  ‚úì Aggregation complete
  ‚úì Prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-3/pred_7625119
  Loaded P matrix: (37, 136714), vertices: 136714
  Mesh: 136714 vertices, 273424 faces
  Step 1: Smoothing probabilities (20 iter, Œ±=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ‚úì Smoothing complete
  Step 2: MRF refinement (Œ≤=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ‚úì MRF refinement complete

  RESULTS:
  RAW:         median(top-10)=0.7770, mean(top-10)=0.7839, median(all)=0.6488, mean(all)=0.5968
  + SMOOTHING: median(top-10)=0.8582, mean(top-10)=0.8669, median(all)=0.7895, mean(all)=0.7145 [+0.0813]
  + MRF:       median(top-10)=0.8582, mean(top-10)=0.8671, median(all)=0.7890, mean(all)=0.7147 [+0.0000]
  TOTAL IMPROVEMENT (median top-10): +0.0813

================================================================================
Subject: NKI-RS-22-4
================================================================================
  Step 0: Generating predictions with NEW models...
  Using PyTorch3D GPU raycasting (matching training pipeline)...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 169171 vertices, 338338 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (42245 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (96402 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (89504 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (58527 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (43508 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (61307 valid pixels)
  [PyTorch3D] Raycasting complete!
  ‚úì Got 6 output maps, shape: (6, 800, 800, 3)
  Loading trained models...
Loading models...
  Loading Front: Front-epoch=499-validation_loss=0.03.ckpt
  Loading Bottom: Bottom-epoch=499-validation_loss=0.04.ckpt
  Loading Top: Top-epoch=499-validation_loss=0.05.ckpt
  Loading Right: Right-epoch=499-validation_loss=0.04.ckpt
  Loading Back: Back-epoch=499-validation_loss=0.03.ckpt
  Loading Left: Left-epoch=499-validation_loss=0.03.ckpt
Models loaded!
  Running U-Net predictions on 6 views...
Predicting labels...
Labels predicted!
  ‚úì Got predictions from 6 views
  Aggregating predictions to vertices...
Agregating predicted labels...

üîç View 0: 2D predictions for 42245 MESH pixels (before aggregation):
   Class 12: 11348 pixels (26.9%)
   Class 30: 7625 pixels (18.0%)
   Class 9: 5353 pixels (12.7%)
   Class 10: 4201 pixels (9.9%)
   Class 8: 2943 pixels (7.0%)
   ‚Üí Background: 2.9% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0287
   ‚Üí Pixels where class 0 prob > 0.5: 1176 (2.8%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9973
   ‚Üí Weights for vertex 0: mean=0.3337, max=0.9973
   ‚Üí Weights for vertex 1: mean=0.3343, max=0.9972
   ‚Üí Weights for vertex 2: mean=0.3324, max=0.9963
   ‚Üí Weights sum to 1? 1.0004

üîç View 1: 2D predictions for 96402 MESH pixels (before aggregation):
   Class 0: 22490 pixels (23.3%)
   Class 29: 18613 pixels (19.3%)
   Class 26: 10563 pixels (11.0%)
   Class 15: 7332 pixels (7.6%)
   Class 18: 4811 pixels (5.0%)
   ‚Üí Background: 23.3% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.2285
   ‚Üí Pixels where class 0 prob > 0.5: 22304 (23.1%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9974

üîç View 2: 2D predictions for 89504 MESH pixels (before aggregation):
   Class 28: 8524 pixels (9.5%)
   Class 31: 7826 pixels (8.7%)
   Class 25: 6856 pixels (7.7%)
   Class 32: 6837 pixels (7.6%)
   Class 16: 6782 pixels (7.6%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0001
   ‚Üí Pixels where class 0 prob > 0.5: 4 (0.0%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9991
DEBUG: Processed 11520000 total pixels, 1174479 valid pixels (10.2%)
DEBUG: Touched 120918.0 vertices out of 169171 (71.5%)
DEBUG: Vertices with zero probability sum: 48253 (28.5%)
DEBUG: Mean class 0 probability for touched vertices: 0.0931
\nDEBUG: Checking for views with high background predictions...
  Front: (see above for stats)
  Bottom: (see above for stats)
  Top: (see above for stats)
  Right: (see above for stats)
  Back: (see above for stats)
  Left: (see above for stats)
DEBUG: After normalization, P sums check: min=0.0000, max=1.0000
DEBUG: Predicted class distribution (before -1 shift):
  Class 0: 56159 vertices (33.2%)
  Class 29: 11743 vertices (6.9%)
  Class 28: 9336 vertices (5.5%)
  Class 30: 7363 vertices (4.4%)
  Class 25: 7217 vertices (4.3%)
  Class 12: 6877 vertices (4.1%)
  Class 10: 5537 vertices (3.3%)
  Class 9: 5393 vertices (3.2%)
  Class 23: 5214 vertices (3.1%)
  Class 26: 4589 vertices (2.7%)
DEBUG: Background predicted: 56159 (33.2%)
DEBUG: Foreground predicted: 113012 (66.8%)
Labels aggregated!
  ‚úì Aggregation complete
  ‚úì Prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-4/pred_7625119
  Loaded P matrix: (37, 169171), vertices: 169171
  Mesh: 169171 vertices, 338338 faces
  Step 1: Smoothing probabilities (20 iter, Œ±=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ‚úì Smoothing complete
  Step 2: MRF refinement (Œ≤=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ‚úì MRF refinement complete

  RESULTS:
  RAW:         median(top-10)=0.7304, mean(top-10)=0.7381, median(all)=0.6225, mean(all)=0.5600
  + SMOOTHING: median(top-10)=0.8197, mean(top-10)=0.8258, median(all)=0.7702, mean(all)=0.6782 [+0.0893]
  + MRF:       median(top-10)=0.8205, mean(top-10)=0.8265, median(all)=0.7696, mean(all)=0.6786 [+0.0008]
  TOTAL IMPROVEMENT (median top-10): +0.0901

================================================================================
Subject: NKI-RS-22-5
================================================================================
  Step 0: Generating predictions with NEW models...
  Using PyTorch3D GPU raycasting (matching training pipeline)...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 138967 vertices, 277930 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (38796 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (94455 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (87120 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (61512 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (43181 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (64778 valid pixels)
  [PyTorch3D] Raycasting complete!
  ‚úì Got 6 output maps, shape: (6, 800, 800, 3)
  Loading trained models...
Loading models...
  Loading Front: Front-epoch=499-validation_loss=0.03.ckpt
  Loading Bottom: Bottom-epoch=499-validation_loss=0.04.ckpt
  Loading Top: Top-epoch=499-validation_loss=0.05.ckpt
  Loading Right: Right-epoch=499-validation_loss=0.04.ckpt
  Loading Back: Back-epoch=499-validation_loss=0.03.ckpt
  Loading Left: Left-epoch=499-validation_loss=0.03.ckpt
Models loaded!
  Running U-Net predictions on 6 views...
Predicting labels...
Labels predicted!
  ‚úì Got predictions from 6 views
  Aggregating predictions to vertices...
Agregating predicted labels...

üîç View 0: 2D predictions for 38796 MESH pixels (before aggregation):
   Class 12: 10734 pixels (27.7%)
   Class 30: 8655 pixels (22.3%)
   Class 9: 5220 pixels (13.5%)
   Class 10: 2384 pixels (6.1%)
   Class 8: 1434 pixels (3.7%)
   ‚Üí Background: 3.6% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0339
   ‚Üí Pixels where class 0 prob > 0.5: 1348 (3.5%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9979
   ‚Üí Weights for vertex 0: mean=0.3332, max=0.9972
   ‚Üí Weights for vertex 1: mean=0.3339, max=0.9979
   ‚Üí Weights for vertex 2: mean=0.3333, max=0.9964
   ‚Üí Weights sum to 1? 1.0004

üîç View 1: 2D predictions for 94455 MESH pixels (before aggregation):
   Class 29: 20443 pixels (21.6%)
   Class 0: 19772 pixels (20.9%)
   Class 26: 8812 pixels (9.3%)
   Class 15: 7239 pixels (7.7%)
   Class 14: 6558 pixels (6.9%)
   ‚Üí Background: 20.9% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.2079
   ‚Üí Pixels where class 0 prob > 0.5: 19670 (20.8%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=1.0000

üîç View 2: 2D predictions for 87120 MESH pixels (before aggregation):
   Class 31: 7493 pixels (8.6%)
   Class 28: 7413 pixels (8.5%)
   Class 23: 7039 pixels (8.1%)
   Class 25: 6787 pixels (7.8%)
   Class 32: 6685 pixels (7.7%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0000
   ‚Üí Pixels where class 0 prob > 0.5: 0 (0.0%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9995
DEBUG: Processed 11520000 total pixels, 1169526 valid pixels (10.2%)
DEBUG: Touched 101203.0 vertices out of 138967 (72.8%)
DEBUG: Vertices with zero probability sum: 37764 (27.2%)
DEBUG: Mean class 0 probability for touched vertices: 0.0846
\nDEBUG: Checking for views with high background predictions...
  Front: (see above for stats)
  Bottom: (see above for stats)
  Top: (see above for stats)
  Right: (see above for stats)
  Back: (see above for stats)
  Left: (see above for stats)
DEBUG: After normalization, P sums check: min=0.0000, max=1.0000
DEBUG: Predicted class distribution (before -1 shift):
  Class 0: 43549 vertices (31.3%)
  Class 29: 10316 vertices (7.4%)
  Class 12: 6900 vertices (5.0%)
  Class 30: 6793 vertices (4.9%)
  Class 28: 6315 vertices (4.5%)
  Class 25: 5729 vertices (4.1%)
  Class 23: 4824 vertices (3.5%)
  Class 14: 4158 vertices (3.0%)
  Class 10: 4105 vertices (3.0%)
  Class 31: 4027 vertices (2.9%)
DEBUG: Background predicted: 43549 (31.3%)
DEBUG: Foreground predicted: 95418 (68.7%)
Labels aggregated!
  ‚úì Aggregation complete
  ‚úì Prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-5/pred_7625119
  Loaded P matrix: (37, 138967), vertices: 138967
  Mesh: 138967 vertices, 277930 faces
  Step 1: Smoothing probabilities (20 iter, Œ±=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ‚úì Smoothing complete
  Step 2: MRF refinement (Œ≤=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ‚úì MRF refinement complete

  RESULTS:
  RAW:         median(top-10)=0.8113, mean(top-10)=0.8013, median(all)=0.6844, mean(all)=0.5978
  + SMOOTHING: median(top-10)=0.8802, mean(top-10)=0.8813, median(all)=0.8121, mean(all)=0.7141 [+0.0690]
  + MRF:       median(top-10)=0.8804, mean(top-10)=0.8817, median(all)=0.8125, mean(all)=0.7144 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0692

================================================================================
Subject: NKI-RS-22-6
================================================================================
  Step 0: Generating predictions with NEW models...
  Using PyTorch3D GPU raycasting (matching training pipeline)...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 185380 vertices, 370756 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (37975 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (94997 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (87741 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (58267 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (37683 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (61644 valid pixels)
  [PyTorch3D] Raycasting complete!
  ‚úì Got 6 output maps, shape: (6, 800, 800, 3)
  Loading trained models...
Loading models...
  Loading Front: Front-epoch=499-validation_loss=0.03.ckpt
  Loading Bottom: Bottom-epoch=499-validation_loss=0.04.ckpt
  Loading Top: Top-epoch=499-validation_loss=0.05.ckpt
  Loading Right: Right-epoch=499-validation_loss=0.04.ckpt
  Loading Back: Back-epoch=499-validation_loss=0.03.ckpt
  Loading Left: Left-epoch=499-validation_loss=0.03.ckpt
Models loaded!
  Running U-Net predictions on 6 views...
Predicting labels...
Labels predicted!
  ‚úì Got predictions from 6 views
  Aggregating predictions to vertices...
Agregating predicted labels...

üîç View 0: 2D predictions for 37975 MESH pixels (before aggregation):
   Class 9: 9737 pixels (25.6%)
   Class 12: 9715 pixels (25.6%)
   Class 30: 7573 pixels (19.9%)
   Class 6: 2001 pixels (5.3%)
   Class 10: 1866 pixels (4.9%)
   ‚Üí Background: 0.8% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0073
   ‚Üí Pixels where class 0 prob > 0.5: 261 (0.7%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9994
   ‚Üí Weights for vertex 0: mean=0.3333, max=0.9994
   ‚Üí Weights for vertex 1: mean=0.3351, max=0.9921
   ‚Üí Weights for vertex 2: mean=0.3320, max=0.9971
   ‚Üí Weights sum to 1? 1.0004

üîç View 1: 2D predictions for 94997 MESH pixels (before aggregation):
   Class 0: 17858 pixels (18.8%)
   Class 29: 16910 pixels (17.8%)
   Class 26: 11007 pixels (11.6%)
   Class 14: 5940 pixels (6.3%)
   Class 18: 5538 pixels (5.8%)
   ‚Üí Background: 18.8% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.1828
   ‚Üí Pixels where class 0 prob > 0.5: 17637 (18.6%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9997

üîç View 2: 2D predictions for 87741 MESH pixels (before aggregation):
   Class 28: 8771 pixels (10.0%)
   Class 31: 8366 pixels (9.5%)
   Class 32: 7468 pixels (8.5%)
   Class 9: 7368 pixels (8.4%)
   Class 12: 6913 pixels (7.9%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0001
   ‚Üí Pixels where class 0 prob > 0.5: 0 (0.0%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=1.0018
DEBUG: Processed 11520000 total pixels, 1134921 valid pixels (9.9%)
DEBUG: Touched 126450.0 vertices out of 185380 (68.2%)
DEBUG: Vertices with zero probability sum: 58930 (31.8%)
DEBUG: Mean class 0 probability for touched vertices: 0.0708
\nDEBUG: Checking for views with high background predictions...
  Front: (see above for stats)
  Bottom: (see above for stats)
  Top: (see above for stats)
  Right: (see above for stats)
  Back: (see above for stats)
  Left: (see above for stats)
DEBUG: After normalization, P sums check: min=0.0000, max=1.0000
DEBUG: Predicted class distribution (before -1 shift):
  Class 0: 65552 vertices (35.4%)
  Class 29: 11557 vertices (6.2%)
  Class 12: 8448 vertices (4.6%)
  Class 28: 8404 vertices (4.5%)
  Class 9: 7495 vertices (4.0%)
  Class 30: 6500 vertices (3.5%)
  Class 25: 6224 vertices (3.4%)
  Class 23: 5899 vertices (3.2%)
  Class 10: 5449 vertices (2.9%)
  Class 31: 5038 vertices (2.7%)
DEBUG: Background predicted: 65552 (35.4%)
DEBUG: Foreground predicted: 119828 (64.6%)
Labels aggregated!
  ‚úì Aggregation complete
  ‚úì Prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-6/pred_7625119
  Loaded P matrix: (37, 185380), vertices: 185380
  Mesh: 185380 vertices, 370756 faces
  Step 1: Smoothing probabilities (20 iter, Œ±=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ‚úì Smoothing complete
  Step 2: MRF refinement (Œ≤=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ‚úì MRF refinement complete

  RESULTS:
  RAW:         median(top-10)=0.7810, mean(top-10)=0.7652, median(all)=0.6424, mean(all)=0.5775
  + SMOOTHING: median(top-10)=0.8838, mean(top-10)=0.8749, median(all)=0.8072, mean(all)=0.7122 [+0.1028]
  + MRF:       median(top-10)=0.8841, mean(top-10)=0.8752, median(all)=0.8078, mean(all)=0.7125 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.1031

================================================================================
Subject: NKI-RS-22-7
================================================================================
  Step 0: Generating predictions with NEW models...
  Using PyTorch3D GPU raycasting (matching training pipeline)...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 153181 vertices, 306358 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (45703 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (113298 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (105058 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (65545 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (45870 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (68386 valid pixels)
  [PyTorch3D] Raycasting complete!
  ‚úì Got 6 output maps, shape: (6, 800, 800, 3)
  Loading trained models...
Loading models...
  Loading Front: Front-epoch=499-validation_loss=0.03.ckpt
  Loading Bottom: Bottom-epoch=499-validation_loss=0.04.ckpt
  Loading Top: Top-epoch=499-validation_loss=0.05.ckpt
  Loading Right: Right-epoch=499-validation_loss=0.04.ckpt
  Loading Back: Back-epoch=499-validation_loss=0.03.ckpt
  Loading Left: Left-epoch=499-validation_loss=0.03.ckpt
Models loaded!
  Running U-Net predictions on 6 views...
Predicting labels...
Labels predicted!
  ‚úì Got predictions from 6 views
  Aggregating predictions to vertices...
Agregating predicted labels...

üîç View 0: 2D predictions for 45703 MESH pixels (before aggregation):
   Class 30: 11616 pixels (25.4%)
   Class 12: 10832 pixels (23.7%)
   Class 9: 7640 pixels (16.7%)
   Class 32: 2833 pixels (6.2%)
   Class 26: 2245 pixels (4.9%)
   ‚Üí Background: 1.2% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0109
   ‚Üí Pixels where class 0 prob > 0.5: 482 (1.1%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9996
   ‚Üí Weights for vertex 0: mean=0.3348, max=0.9996
   ‚Üí Weights for vertex 1: mean=0.3323, max=0.9979
   ‚Üí Weights for vertex 2: mean=0.3332, max=0.9982
   ‚Üí Weights sum to 1? 1.0003

üîç View 1: 2D predictions for 113298 MESH pixels (before aggregation):
   Class 29: 23538 pixels (20.8%)
   Class 0: 20793 pixels (18.4%)
   Class 26: 11206 pixels (9.9%)
   Class 18: 7439 pixels (6.6%)
   Class 14: 6897 pixels (6.1%)
   ‚Üí Background: 18.4% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.1817
   ‚Üí Pixels where class 0 prob > 0.5: 20642 (18.2%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9982

üîç View 2: 2D predictions for 105058 MESH pixels (before aggregation):
   Class 28: 11217 pixels (10.7%)
   Class 31: 8798 pixels (8.4%)
   Class 9: 8589 pixels (8.2%)
   Class 16: 7520 pixels (7.2%)
   Class 23: 7457 pixels (7.1%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0001
   ‚Üí Pixels where class 0 prob > 0.5: 3 (0.0%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9976
DEBUG: Processed 11520000 total pixels, 1331580 valid pixels (11.6%)
DEBUG: Touched 109791.0 vertices out of 153181 (71.7%)
DEBUG: Vertices with zero probability sum: 43390 (28.3%)
DEBUG: Mean class 0 probability for touched vertices: 0.0851
\nDEBUG: Checking for views with high background predictions...
  Front: (see above for stats)
  Bottom: (see above for stats)
  Top: (see above for stats)
  Right: (see above for stats)
  Back: (see above for stats)
  Left: (see above for stats)
DEBUG: After normalization, P sums check: min=0.0000, max=1.0000
DEBUG: Predicted class distribution (before -1 shift):
  Class 0: 49661 vertices (32.4%)
  Class 29: 11681 vertices (7.6%)
  Class 28: 7062 vertices (4.6%)
  Class 30: 5948 vertices (3.9%)
  Class 12: 5861 vertices (3.8%)
  Class 25: 5194 vertices (3.4%)
  Class 23: 5171 vertices (3.4%)
  Class 9: 4764 vertices (3.1%)
  Class 26: 4581 vertices (3.0%)
  Class 31: 4521 vertices (3.0%)
DEBUG: Background predicted: 49661 (32.4%)
DEBUG: Foreground predicted: 103520 (67.6%)
Labels aggregated!
  ‚úì Aggregation complete
  ‚úì Prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-7/pred_7625119
  Loaded P matrix: (37, 153181), vertices: 153181
  Mesh: 153181 vertices, 306358 faces
  Step 1: Smoothing probabilities (20 iter, Œ±=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ‚úì Smoothing complete
  Step 2: MRF refinement (Œ≤=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ‚úì MRF refinement complete

  RESULTS:
  RAW:         median(top-10)=0.7839, mean(top-10)=0.7903, median(all)=0.6436, mean(all)=0.5915
  + SMOOTHING: median(top-10)=0.8628, mean(top-10)=0.8712, median(all)=0.7970, mean(all)=0.7109 [+0.0789]
  + MRF:       median(top-10)=0.8633, mean(top-10)=0.8715, median(all)=0.7976, mean(all)=0.7112 [+0.0005]
  TOTAL IMPROVEMENT (median top-10): +0.0794

================================================================================
Subject: NKI-RS-22-8
================================================================================
  Step 0: Generating predictions with NEW models...
  Using PyTorch3D GPU raycasting (matching training pipeline)...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 158049 vertices, 316094 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (45236 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (103105 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (95107 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (59871 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (41772 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (63833 valid pixels)
  [PyTorch3D] Raycasting complete!
  ‚úì Got 6 output maps, shape: (6, 800, 800, 3)
  Loading trained models...
Loading models...
  Loading Front: Front-epoch=499-validation_loss=0.03.ckpt
  Loading Bottom: Bottom-epoch=499-validation_loss=0.04.ckpt
  Loading Top: Top-epoch=499-validation_loss=0.05.ckpt
  Loading Right: Right-epoch=499-validation_loss=0.04.ckpt
  Loading Back: Back-epoch=499-validation_loss=0.03.ckpt
  Loading Left: Left-epoch=499-validation_loss=0.03.ckpt
Models loaded!
  Running U-Net predictions on 6 views...
Predicting labels...
Labels predicted!
  ‚úì Got predictions from 6 views
  Aggregating predictions to vertices...
Agregating predicted labels...

üîç View 0: 2D predictions for 45236 MESH pixels (before aggregation):
   Class 12: 15325 pixels (33.9%)
   Class 30: 11795 pixels (26.1%)
   Class 9: 6789 pixels (15.0%)
   Class 32: 1930 pixels (4.3%)
   Class 23: 1919 pixels (4.2%)
   ‚Üí Background: 0.1% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0012
   ‚Üí Pixels where class 0 prob > 0.5: 11 (0.0%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9977
   ‚Üí Weights for vertex 0: mean=0.3337, max=0.9975
   ‚Üí Weights for vertex 1: mean=0.3339, max=0.9959
   ‚Üí Weights for vertex 2: mean=0.3328, max=0.9977
   ‚Üí Weights sum to 1? 1.0004

üîç View 1: 2D predictions for 103105 MESH pixels (before aggregation):
   Class 0: 22503 pixels (21.8%)
   Class 29: 17725 pixels (17.2%)
   Class 26: 10566 pixels (10.2%)
   Class 14: 7037 pixels (6.8%)
   Class 15: 6489 pixels (6.3%)
   ‚Üí Background: 21.8% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.2162
   ‚Üí Pixels where class 0 prob > 0.5: 22379 (21.7%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=1.0003

üîç View 2: 2D predictions for 95107 MESH pixels (before aggregation):
   Class 28: 10504 pixels (11.0%)
   Class 12: 8765 pixels (9.2%)
   Class 16: 7864 pixels (8.3%)
   Class 25: 7248 pixels (7.6%)
   Class 31: 7179 pixels (7.5%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0001
   ‚Üí Pixels where class 0 prob > 0.5: 3 (0.0%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9971
DEBUG: Processed 11520000 total pixels, 1226772 valid pixels (10.6%)
DEBUG: Touched 114321.0 vertices out of 158049 (72.3%)
DEBUG: Vertices with zero probability sum: 43728 (27.7%)
DEBUG: Mean class 0 probability for touched vertices: 0.0850
\nDEBUG: Checking for views with high background predictions...
  Front: (see above for stats)
  Bottom: (see above for stats)
  Top: (see above for stats)
  Right: (see above for stats)
  Back: (see above for stats)
  Left: (see above for stats)
DEBUG: After normalization, P sums check: min=0.0000, max=1.0000
DEBUG: Predicted class distribution (before -1 shift):
  Class 0: 50635 vertices (32.0%)
  Class 29: 11112 vertices (7.0%)
  Class 12: 10110 vertices (6.4%)
  Class 28: 7827 vertices (5.0%)
  Class 30: 7387 vertices (4.7%)
  Class 25: 6096 vertices (3.9%)
  Class 14: 5288 vertices (3.3%)
  Class 23: 4728 vertices (3.0%)
  Class 9: 4623 vertices (2.9%)
  Class 16: 4617 vertices (2.9%)
DEBUG: Background predicted: 50635 (32.0%)
DEBUG: Foreground predicted: 107414 (68.0%)
Labels aggregated!
  ‚úì Aggregation complete
  ‚úì Prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-8/pred_7625119
  Loaded P matrix: (37, 158049), vertices: 158049
  Mesh: 158049 vertices, 316094 faces
  Step 1: Smoothing probabilities (20 iter, Œ±=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ‚úì Smoothing complete
  Step 2: MRF refinement (Œ≤=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ‚úì MRF refinement complete

  RESULTS:
  RAW:         median(top-10)=0.7655, mean(top-10)=0.7756, median(all)=0.6797, mean(all)=0.6056
  + SMOOTHING: median(top-10)=0.8745, mean(top-10)=0.8729, median(all)=0.8073, mean(all)=0.7262 [+0.1090]
  + MRF:       median(top-10)=0.8748, mean(top-10)=0.8732, median(all)=0.8080, mean(all)=0.7266 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.1093

================================================================================
Subject: NKI-RS-22-9
================================================================================
  Step 0: Generating predictions with NEW models...
  Using PyTorch3D GPU raycasting (matching training pipeline)...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 129746 vertices, 259488 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (37843 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (95155 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (88008 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (57170 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (39294 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (60501 valid pixels)
  [PyTorch3D] Raycasting complete!
  ‚úì Got 6 output maps, shape: (6, 800, 800, 3)
  Loading trained models...
Loading models...
  Loading Front: Front-epoch=499-validation_loss=0.03.ckpt
  Loading Bottom: Bottom-epoch=499-validation_loss=0.04.ckpt
  Loading Top: Top-epoch=499-validation_loss=0.05.ckpt
  Loading Right: Right-epoch=499-validation_loss=0.04.ckpt
  Loading Back: Back-epoch=499-validation_loss=0.03.ckpt
  Loading Left: Left-epoch=499-validation_loss=0.03.ckpt
Models loaded!
  Running U-Net predictions on 6 views...
Predicting labels...
Labels predicted!
  ‚úì Got predictions from 6 views
  Aggregating predictions to vertices...
Agregating predicted labels...

üîç View 0: 2D predictions for 37843 MESH pixels (before aggregation):
   Class 12: 11894 pixels (31.4%)
   Class 30: 9585 pixels (25.3%)
   Class 9: 6567 pixels (17.4%)
   Class 10: 2142 pixels (5.7%)
   Class 32: 1668 pixels (4.4%)
   ‚Üí Background: 0.7% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0058
   ‚Üí Pixels where class 0 prob > 0.5: 229 (0.6%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9960
   ‚Üí Weights for vertex 0: mean=0.3332, max=0.9918
   ‚Üí Weights for vertex 1: mean=0.3341, max=0.9946
   ‚Üí Weights for vertex 2: mean=0.3330, max=0.9960
   ‚Üí Weights sum to 1? 1.0003

üîç View 1: 2D predictions for 95155 MESH pixels (before aggregation):
   Class 0: 20231 pixels (21.3%)
   Class 29: 19384 pixels (20.4%)
   Class 26: 9198 pixels (9.7%)
   Class 14: 6355 pixels (6.7%)
   Class 15: 5800 pixels (6.1%)
   ‚Üí Background: 21.3% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.2111
   ‚Üí Pixels where class 0 prob > 0.5: 20126 (21.2%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9978

üîç View 2: 2D predictions for 88008 MESH pixels (before aggregation):
   Class 28: 8874 pixels (10.1%)
   Class 31: 7835 pixels (8.9%)
   Class 9: 7741 pixels (8.8%)
   Class 16: 7240 pixels (8.2%)
   Class 23: 7035 pixels (8.0%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0000
   ‚Üí Pixels where class 0 prob > 0.5: 1 (0.0%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9982
DEBUG: Processed 11520000 total pixels, 1133913 valid pixels (9.8%)
DEBUG: Touched 94822.0 vertices out of 129746 (73.1%)
DEBUG: Vertices with zero probability sum: 34924 (26.9%)
DEBUG: Mean class 0 probability for touched vertices: 0.0847
\nDEBUG: Checking for views with high background predictions...
  Front: (see above for stats)
  Bottom: (see above for stats)
  Top: (see above for stats)
  Right: (see above for stats)
  Back: (see above for stats)
  Left: (see above for stats)
DEBUG: After normalization, P sums check: min=0.0000, max=1.0000
DEBUG: Predicted class distribution (before -1 shift):
  Class 0: 40638 vertices (31.3%)
  Class 29: 9184 vertices (7.1%)
  Class 28: 7237 vertices (5.6%)
  Class 12: 6228 vertices (4.8%)
  Class 30: 5407 vertices (4.2%)
  Class 25: 4954 vertices (3.8%)
  Class 9: 4935 vertices (3.8%)
  Class 23: 4516 vertices (3.5%)
  Class 31: 3722 vertices (2.9%)
  Class 10: 3573 vertices (2.8%)
DEBUG: Background predicted: 40638 (31.3%)
DEBUG: Foreground predicted: 89108 (68.7%)
Labels aggregated!
  ‚úì Aggregation complete
  ‚úì Prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-9/pred_7625119
  Loaded P matrix: (37, 129746), vertices: 129746
  Mesh: 129746 vertices, 259488 faces
  Step 1: Smoothing probabilities (20 iter, Œ±=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ‚úì Smoothing complete
  Step 2: MRF refinement (Œ≤=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ‚úì MRF refinement complete

  RESULTS:
  RAW:         median(top-10)=0.8190, mean(top-10)=0.8127, median(all)=0.6969, mean(all)=0.6128
  + SMOOTHING: median(top-10)=0.8936, mean(top-10)=0.8898, median(all)=0.8143, mean(all)=0.7180 [+0.0746]
  + MRF:       median(top-10)=0.8940, mean(top-10)=0.8902, median(all)=0.8151, mean(all)=0.7178 [+0.0004]
  TOTAL IMPROVEMENT (median top-10): +0.0750

================================================================================
Subject: NKI-TRT-20-1
================================================================================
  Step 0: Generating predictions with NEW models...
  Using PyTorch3D GPU raycasting (matching training pipeline)...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 143932 vertices, 287860 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (67888 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (137970 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (126140 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (80166 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (63930 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (83159 valid pixels)
  [PyTorch3D] Raycasting complete!
  ‚úì Got 6 output maps, shape: (6, 800, 800, 3)
  Loading trained models...
Loading models...
  Loading Front: Front-epoch=499-validation_loss=0.03.ckpt
  Loading Bottom: Bottom-epoch=499-validation_loss=0.04.ckpt
  Loading Top: Top-epoch=499-validation_loss=0.05.ckpt
  Loading Right: Right-epoch=499-validation_loss=0.04.ckpt
  Loading Back: Back-epoch=499-validation_loss=0.03.ckpt
  Loading Left: Left-epoch=499-validation_loss=0.03.ckpt
Models loaded!
  Running U-Net predictions on 6 views...
Predicting labels...
Labels predicted!
  ‚úì Got predictions from 6 views
  Aggregating predictions to vertices...
Agregating predicted labels...

üîç View 0: 2D predictions for 67888 MESH pixels (before aggregation):
   Class 30: 16692 pixels (24.6%)
   Class 9: 13595 pixels (20.0%)
   Class 12: 13337 pixels (19.6%)
   Class 23: 4613 pixels (6.8%)
   Class 16: 3229 pixels (4.8%)
   ‚Üí Background: 0.1% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0012
   ‚Üí Pixels where class 0 prob > 0.5: 37 (0.1%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9994
   ‚Üí Weights for vertex 0: mean=0.3354, max=0.9948
   ‚Üí Weights for vertex 1: mean=0.3323, max=0.9992
   ‚Üí Weights for vertex 2: mean=0.3326, max=0.9994
   ‚Üí Weights sum to 1? 1.0003

üîç View 1: 2D predictions for 137970 MESH pixels (before aggregation):
   Class 0: 27929 pixels (20.2%)
   Class 29: 25154 pixels (18.2%)
   Class 26: 13957 pixels (10.1%)
   Class 18: 9730 pixels (7.1%)
   Class 14: 9727 pixels (7.1%)
   ‚Üí Background: 20.2% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.2028
   ‚Üí Pixels where class 0 prob > 0.5: 27802 (20.2%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9991

üîç View 2: 2D predictions for 126140 MESH pixels (before aggregation):
   Class 28: 11364 pixels (9.0%)
   Class 31: 10751 pixels (8.5%)
   Class 9: 9930 pixels (7.9%)
   Class 23: 9758 pixels (7.7%)
   Class 16: 9449 pixels (7.5%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0001
   ‚Üí Pixels where class 0 prob > 0.5: 2 (0.0%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9988
DEBUG: Processed 11520000 total pixels, 1677759 valid pixels (14.6%)
DEBUG: Touched 104887.0 vertices out of 143932 (72.9%)
DEBUG: Vertices with zero probability sum: 39045 (27.1%)
DEBUG: Mean class 0 probability for touched vertices: 0.0951
\nDEBUG: Checking for views with high background predictions...
  Front: (see above for stats)
  Bottom: (see above for stats)
  Top: (see above for stats)
  Right: (see above for stats)
  Back: (see above for stats)
  Left: (see above for stats)
DEBUG: After normalization, P sums check: min=0.0000, max=1.0000
DEBUG: Predicted class distribution (before -1 shift):
  Class 0: 45566 vertices (31.7%)
  Class 29: 9920 vertices (6.9%)
  Class 28: 6951 vertices (4.8%)
  Class 30: 6198 vertices (4.3%)
  Class 12: 5721 vertices (4.0%)
  Class 25: 5695 vertices (4.0%)
  Class 9: 5478 vertices (3.8%)
  Class 23: 5253 vertices (3.6%)
  Class 10: 4227 vertices (2.9%)
  Class 16: 4110 vertices (2.9%)
DEBUG: Background predicted: 45566 (31.7%)
DEBUG: Foreground predicted: 98366 (68.3%)
Labels aggregated!
  ‚úì Aggregation complete
  ‚úì Prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-1/pred_7625119
  Loaded P matrix: (37, 143932), vertices: 143932
  Mesh: 143932 vertices, 287860 faces
  Step 1: Smoothing probabilities (20 iter, Œ±=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ‚úì Smoothing complete
  Step 2: MRF refinement (Œ≤=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ‚úì MRF refinement complete

  RESULTS:
  RAW:         median(top-10)=0.7695, mean(top-10)=0.7698, median(all)=0.6556, mean(all)=0.5935
  + SMOOTHING: median(top-10)=0.8615, mean(top-10)=0.8572, median(all)=0.7857, mean(all)=0.7046 [+0.0920]
  + MRF:       median(top-10)=0.8627, mean(top-10)=0.8578, median(all)=0.7861, mean(all)=0.7051 [+0.0011]
  TOTAL IMPROVEMENT (median top-10): +0.0931

================================================================================
Subject: NKI-TRT-20-10
================================================================================
  Step 0: Generating predictions with NEW models...
  Using PyTorch3D GPU raycasting (matching training pipeline)...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 122978 vertices, 245952 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (34190 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (85586 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (80586 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (53598 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (34834 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (56948 valid pixels)
  [PyTorch3D] Raycasting complete!
  ‚úì Got 6 output maps, shape: (6, 800, 800, 3)
  Loading trained models...
Loading models...
  Loading Front: Front-epoch=499-validation_loss=0.03.ckpt
  Loading Bottom: Bottom-epoch=499-validation_loss=0.04.ckpt
  Loading Top: Top-epoch=499-validation_loss=0.05.ckpt
  Loading Right: Right-epoch=499-validation_loss=0.04.ckpt
  Loading Back: Back-epoch=499-validation_loss=0.03.ckpt
  Loading Left: Left-epoch=499-validation_loss=0.03.ckpt
Models loaded!
  Running U-Net predictions on 6 views...
Predicting labels...
Labels predicted!
  ‚úì Got predictions from 6 views
  Aggregating predictions to vertices...
Agregating predicted labels...

üîç View 0: 2D predictions for 34190 MESH pixels (before aggregation):
   Class 12: 10814 pixels (31.6%)
   Class 30: 6510 pixels (19.0%)
   Class 9: 5625 pixels (16.5%)
   Class 10: 2426 pixels (7.1%)
   Class 6: 1610 pixels (4.7%)
   ‚Üí Background: 0.7% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0073
   ‚Üí Pixels where class 0 prob > 0.5: 247 (0.7%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9985
   ‚Üí Weights for vertex 0: mean=0.3323, max=0.9927
   ‚Üí Weights for vertex 1: mean=0.3340, max=0.9962
   ‚Üí Weights for vertex 2: mean=0.3340, max=0.9985
   ‚Üí Weights sum to 1? 1.0004

üîç View 1: 2D predictions for 85586 MESH pixels (before aggregation):
   Class 0: 17531 pixels (20.5%)
   Class 29: 15486 pixels (18.1%)
   Class 26: 8350 pixels (9.8%)
   Class 14: 6180 pixels (7.2%)
   Class 15: 5815 pixels (6.8%)
   ‚Üí Background: 20.5% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.2036
   ‚Üí Pixels where class 0 prob > 0.5: 17461 (20.4%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9992

üîç View 2: 2D predictions for 80586 MESH pixels (before aggregation):
   Class 12: 7316 pixels (9.1%)
   Class 9: 6646 pixels (8.2%)
   Class 28: 6531 pixels (8.1%)
   Class 23: 6399 pixels (7.9%)
   Class 31: 6365 pixels (7.9%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0001
   ‚Üí Pixels where class 0 prob > 0.5: 4 (0.0%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9979
DEBUG: Processed 11520000 total pixels, 1037226 valid pixels (9.0%)
DEBUG: Touched 91659.0 vertices out of 122978 (74.5%)
DEBUG: Vertices with zero probability sum: 31319 (25.5%)
DEBUG: Mean class 0 probability for touched vertices: 0.0950
\nDEBUG: Checking for views with high background predictions...
  Front: (see above for stats)
  Bottom: (see above for stats)
  Top: (see above for stats)
  Right: (see above for stats)
  Back: (see above for stats)
  Left: (see above for stats)
DEBUG: After normalization, P sums check: min=0.0000, max=1.0000
DEBUG: Predicted class distribution (before -1 shift):
  Class 0: 37091 vertices (30.2%)
  Class 29: 8232 vertices (6.7%)
  Class 12: 6765 vertices (5.5%)
  Class 28: 5407 vertices (4.4%)
  Class 25: 5028 vertices (4.1%)
  Class 30: 4779 vertices (3.9%)
  Class 23: 4622 vertices (3.8%)
  Class 9: 4286 vertices (3.5%)
  Class 14: 3834 vertices (3.1%)
  Class 31: 3746 vertices (3.0%)
DEBUG: Background predicted: 37091 (30.2%)
DEBUG: Foreground predicted: 85887 (69.8%)
Labels aggregated!
  ‚úì Aggregation complete
  ‚úì Prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-10/pred_7625119
  Loaded P matrix: (37, 122978), vertices: 122978
  Mesh: 122978 vertices, 245952 faces
  Step 1: Smoothing probabilities (20 iter, Œ±=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ‚úì Smoothing complete
  Step 2: MRF refinement (Œ≤=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ‚úì MRF refinement complete

  RESULTS:
  RAW:         median(top-10)=0.7911, mean(top-10)=0.7967, median(all)=0.7013, mean(all)=0.6168
  + SMOOTHING: median(top-10)=0.8652, mean(top-10)=0.8719, median(all)=0.8135, mean(all)=0.7255 [+0.0741]
  + MRF:       median(top-10)=0.8661, mean(top-10)=0.8724, median(all)=0.8134, mean(all)=0.7258 [+0.0009]
  TOTAL IMPROVEMENT (median top-10): +0.0750

================================================================================
Subject: NKI-TRT-20-11
================================================================================
  Step 0: Generating predictions with NEW models...
  Using PyTorch3D GPU raycasting (matching training pipeline)...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 146103 vertices, 292202 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (56077 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (114253 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (105159 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (72184 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (52179 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (76746 valid pixels)
  [PyTorch3D] Raycasting complete!
  ‚úì Got 6 output maps, shape: (6, 800, 800, 3)
  Loading trained models...
Loading models...
  Loading Front: Front-epoch=499-validation_loss=0.03.ckpt
  Loading Bottom: Bottom-epoch=499-validation_loss=0.04.ckpt
  Loading Top: Top-epoch=499-validation_loss=0.05.ckpt
  Loading Right: Right-epoch=499-validation_loss=0.04.ckpt
  Loading Back: Back-epoch=499-validation_loss=0.03.ckpt
  Loading Left: Left-epoch=499-validation_loss=0.03.ckpt
Models loaded!
  Running U-Net predictions on 6 views...
Predicting labels...
Labels predicted!
  ‚úì Got predictions from 6 views
  Aggregating predictions to vertices...
Agregating predicted labels...

üîç View 0: 2D predictions for 56077 MESH pixels (before aggregation):
   Class 30: 13025 pixels (23.2%)
   Class 12: 12894 pixels (23.0%)
   Class 9: 7734 pixels (13.8%)
   Class 23: 5017 pixels (8.9%)
   Class 32: 4355 pixels (7.8%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0004
   ‚Üí Pixels where class 0 prob > 0.5: 5 (0.0%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9976
   ‚Üí Weights for vertex 0: mean=0.3341, max=0.9976
   ‚Üí Weights for vertex 1: mean=0.3342, max=0.9923
   ‚Üí Weights for vertex 2: mean=0.3320, max=0.9969
   ‚Üí Weights sum to 1? 1.0003

üîç View 1: 2D predictions for 114253 MESH pixels (before aggregation):
   Class 0: 23581 pixels (20.6%)
   Class 29: 21870 pixels (19.1%)
   Class 26: 11505 pixels (10.1%)
   Class 15: 7827 pixels (6.9%)
   Class 18: 7158 pixels (6.3%)
   ‚Üí Background: 20.6% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.2056
   ‚Üí Pixels where class 0 prob > 0.5: 23467 (20.5%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9986

üîç View 2: 2D predictions for 105159 MESH pixels (before aggregation):
   Class 28: 11185 pixels (10.6%)
   Class 32: 9831 pixels (9.3%)
   Class 25: 8810 pixels (8.4%)
   Class 16: 8211 pixels (7.8%)
   Class 12: 7281 pixels (6.9%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0002
   ‚Üí Pixels where class 0 prob > 0.5: 14 (0.0%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=1.0005
DEBUG: Processed 11520000 total pixels, 1429794 valid pixels (12.4%)
DEBUG: Touched 108571.0 vertices out of 146103 (74.3%)
DEBUG: Vertices with zero probability sum: 37532 (25.7%)
DEBUG: Mean class 0 probability for touched vertices: 0.1055
\nDEBUG: Checking for views with high background predictions...
  Front: (see above for stats)
  Bottom: (see above for stats)
  Top: (see above for stats)
  Right: (see above for stats)
  Back: (see above for stats)
  Left: (see above for stats)
DEBUG: After normalization, P sums check: min=0.0000, max=1.0000
DEBUG: Predicted class distribution (before -1 shift):
  Class 0: 44823 vertices (30.7%)
  Class 29: 10289 vertices (7.0%)
  Class 30: 7130 vertices (4.9%)
  Class 28: 6873 vertices (4.7%)
  Class 12: 6720 vertices (4.6%)
  Class 25: 6229 vertices (4.3%)
  Class 23: 4910 vertices (3.4%)
  Class 10: 4796 vertices (3.3%)
  Class 32: 4763 vertices (3.3%)
  Class 26: 4401 vertices (3.0%)
DEBUG: Background predicted: 44823 (30.7%)
DEBUG: Foreground predicted: 101280 (69.3%)
Labels aggregated!
  ‚úì Aggregation complete
  ‚úì Prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-11/pred_7625119
  Loaded P matrix: (37, 146103), vertices: 146103
  Mesh: 146103 vertices, 292202 faces
  Step 1: Smoothing probabilities (20 iter, Œ±=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ‚úì Smoothing complete
  Step 2: MRF refinement (Œ≤=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ‚úì MRF refinement complete

  RESULTS:
  RAW:         median(top-10)=0.7674, mean(top-10)=0.7800, median(all)=0.6676, mean(all)=0.5980
  + SMOOTHING: median(top-10)=0.8452, mean(top-10)=0.8569, median(all)=0.7850, mean(all)=0.7123 [+0.0778]
  + MRF:       median(top-10)=0.8463, mean(top-10)=0.8572, median(all)=0.7857, mean(all)=0.7126 [+0.0011]
  TOTAL IMPROVEMENT (median top-10): +0.0789

================================================================================
Subject: NKI-TRT-20-12
================================================================================
  Step 0: Generating predictions with NEW models...
  Using PyTorch3D GPU raycasting (matching training pipeline)...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 117868 vertices, 235732 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (52947 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (109775 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (101459 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (68499 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (50808 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (71967 valid pixels)
  [PyTorch3D] Raycasting complete!
  ‚úì Got 6 output maps, shape: (6, 800, 800, 3)
  Loading trained models...
Loading models...
  Loading Front: Front-epoch=499-validation_loss=0.03.ckpt
  Loading Bottom: Bottom-epoch=499-validation_loss=0.04.ckpt
  Loading Top: Top-epoch=499-validation_loss=0.05.ckpt
  Loading Right: Right-epoch=499-validation_loss=0.04.ckpt
  Loading Back: Back-epoch=499-validation_loss=0.03.ckpt
  Loading Left: Left-epoch=499-validation_loss=0.03.ckpt
Models loaded!
  Running U-Net predictions on 6 views...
Predicting labels...
Labels predicted!
  ‚úì Got predictions from 6 views
  Aggregating predictions to vertices...
Agregating predicted labels...

üîç View 0: 2D predictions for 52947 MESH pixels (before aggregation):
   Class 12: 16176 pixels (30.6%)
   Class 30: 9392 pixels (17.7%)
   Class 9: 9333 pixels (17.6%)
   Class 32: 3183 pixels (6.0%)
   Class 23: 2483 pixels (4.7%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0005
   ‚Üí Pixels where class 0 prob > 0.5: 5 (0.0%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=1.0000
   ‚Üí Weights for vertex 0: mean=0.3336, max=0.9944
   ‚Üí Weights for vertex 1: mean=0.3340, max=1.0000
   ‚Üí Weights for vertex 2: mean=0.3327, max=0.9965
   ‚Üí Weights sum to 1? 1.0003

üîç View 1: 2D predictions for 109775 MESH pixels (before aggregation):
   Class 0: 24145 pixels (22.0%)
   Class 29: 20670 pixels (18.8%)
   Class 26: 9721 pixels (8.9%)
   Class 18: 7530 pixels (6.9%)
   Class 15: 7257 pixels (6.6%)
   ‚Üí Background: 22.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.2187
   ‚Üí Pixels where class 0 prob > 0.5: 24056 (21.9%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=1.0005

üîç View 2: 2D predictions for 101459 MESH pixels (before aggregation):
   Class 16: 9673 pixels (9.5%)
   Class 28: 9033 pixels (8.9%)
   Class 9: 8756 pixels (8.6%)
   Class 32: 7938 pixels (7.8%)
   Class 31: 7395 pixels (7.3%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0000
   ‚Üí Pixels where class 0 prob > 0.5: 2 (0.0%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9985
DEBUG: Processed 11520000 total pixels, 1366365 valid pixels (11.9%)
DEBUG: Touched 89437.0 vertices out of 117868 (75.9%)
DEBUG: Vertices with zero probability sum: 28431 (24.1%)
DEBUG: Mean class 0 probability for touched vertices: 0.0922
\nDEBUG: Checking for views with high background predictions...
  Front: (see above for stats)
  Bottom: (see above for stats)
  Top: (see above for stats)
  Right: (see above for stats)
  Back: (see above for stats)
  Left: (see above for stats)
DEBUG: After normalization, P sums check: min=0.0000, max=1.0000
DEBUG: Predicted class distribution (before -1 shift):
  Class 0: 34322 vertices (29.1%)
  Class 29: 7850 vertices (6.7%)
  Class 28: 6216 vertices (5.3%)
  Class 12: 5922 vertices (5.0%)
  Class 30: 4849 vertices (4.1%)
  Class 25: 4531 vertices (3.8%)
  Class 23: 4378 vertices (3.7%)
  Class 9: 4296 vertices (3.6%)
  Class 32: 3499 vertices (3.0%)
  Class 16: 3281 vertices (2.8%)
DEBUG: Background predicted: 34322 (29.1%)
DEBUG: Foreground predicted: 83546 (70.9%)
Labels aggregated!
  ‚úì Aggregation complete
  ‚úì Prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-12/pred_7625119
  Loaded P matrix: (37, 117868), vertices: 117868
  Mesh: 117868 vertices, 235732 faces
  Step 1: Smoothing probabilities (20 iter, Œ±=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ‚úì Smoothing complete
  Step 2: MRF refinement (Œ≤=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ‚úì MRF refinement complete

  RESULTS:
  RAW:         median(top-10)=0.7851, mean(top-10)=0.7929, median(all)=0.6798, mean(all)=0.6094
  + SMOOTHING: median(top-10)=0.8667, mean(top-10)=0.8701, median(all)=0.7842, mean(all)=0.7154 [+0.0815]
  + MRF:       median(top-10)=0.8669, mean(top-10)=0.8704, median(all)=0.7838, mean(all)=0.7157 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0818

================================================================================
Subject: NKI-TRT-20-13
================================================================================
  Step 0: Generating predictions with NEW models...
  Using PyTorch3D GPU raycasting (matching training pipeline)...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 168760 vertices, 337516 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (44960 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (106173 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (97807 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (61870 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (40673 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (67331 valid pixels)
  [PyTorch3D] Raycasting complete!
  ‚úì Got 6 output maps, shape: (6, 800, 800, 3)
  Loading trained models...
Loading models...
  Loading Front: Front-epoch=499-validation_loss=0.03.ckpt
  Loading Bottom: Bottom-epoch=499-validation_loss=0.04.ckpt
  Loading Top: Top-epoch=499-validation_loss=0.05.ckpt
  Loading Right: Right-epoch=499-validation_loss=0.04.ckpt
  Loading Back: Back-epoch=499-validation_loss=0.03.ckpt
  Loading Left: Left-epoch=499-validation_loss=0.03.ckpt
Models loaded!
  Running U-Net predictions on 6 views...
Predicting labels...
Labels predicted!
  ‚úì Got predictions from 6 views
  Aggregating predictions to vertices...
Agregating predicted labels...

üîç View 0: 2D predictions for 44960 MESH pixels (before aggregation):
   Class 12: 12722 pixels (28.3%)
   Class 9: 10581 pixels (23.5%)
   Class 30: 9409 pixels (20.9%)
   Class 32: 2571 pixels (5.7%)
   Class 10: 2118 pixels (4.7%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0003
   ‚Üí Pixels where class 0 prob > 0.5: 1 (0.0%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9980
   ‚Üí Weights for vertex 0: mean=0.3344, max=0.9980
   ‚Üí Weights for vertex 1: mean=0.3331, max=0.9955
   ‚Üí Weights for vertex 2: mean=0.3329, max=0.9952
   ‚Üí Weights sum to 1? 1.0004

üîç View 1: 2D predictions for 106173 MESH pixels (before aggregation):
   Class 0: 20124 pixels (19.0%)
   Class 29: 19527 pixels (18.4%)
   Class 26: 13207 pixels (12.4%)
   Class 15: 7343 pixels (6.9%)
   Class 18: 6551 pixels (6.2%)
   ‚Üí Background: 19.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.1864
   ‚Üí Pixels where class 0 prob > 0.5: 19983 (18.8%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9992

üîç View 2: 2D predictions for 97807 MESH pixels (before aggregation):
   Class 28: 11347 pixels (11.6%)
   Class 9: 8625 pixels (8.8%)
   Class 32: 7318 pixels (7.5%)
   Class 31: 7184 pixels (7.3%)
   Class 23: 7079 pixels (7.2%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0001
   ‚Üí Pixels where class 0 prob > 0.5: 2 (0.0%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9977
DEBUG: Processed 11520000 total pixels, 1256442 valid pixels (10.9%)
DEBUG: Touched 118673.0 vertices out of 168760 (70.3%)
DEBUG: Vertices with zero probability sum: 50087 (29.7%)
DEBUG: Mean class 0 probability for touched vertices: 0.0811
\nDEBUG: Checking for views with high background predictions...
  Front: (see above for stats)
  Bottom: (see above for stats)
  Top: (see above for stats)
  Right: (see above for stats)
  Back: (see above for stats)
  Left: (see above for stats)
DEBUG: After normalization, P sums check: min=0.0000, max=1.0000
DEBUG: Predicted class distribution (before -1 shift):
  Class 0: 56599 vertices (33.5%)
  Class 29: 10582 vertices (6.3%)
  Class 28: 8473 vertices (5.0%)
  Class 12: 7828 vertices (4.6%)
  Class 25: 6556 vertices (3.9%)
  Class 9: 6291 vertices (3.7%)
  Class 30: 6036 vertices (3.6%)
  Class 23: 5477 vertices (3.2%)
  Class 10: 5148 vertices (3.1%)
  Class 26: 5117 vertices (3.0%)
DEBUG: Background predicted: 56599 (33.5%)
DEBUG: Foreground predicted: 112161 (66.5%)
Labels aggregated!
  ‚úì Aggregation complete
  ‚úì Prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-13/pred_7625119
  Loaded P matrix: (37, 168760), vertices: 168760
  Mesh: 168760 vertices, 337516 faces
  Step 1: Smoothing probabilities (20 iter, Œ±=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ‚úì Smoothing complete
  Step 2: MRF refinement (Œ≤=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ‚úì MRF refinement complete

  RESULTS:
  RAW:         median(top-10)=0.7706, mean(top-10)=0.7839, median(all)=0.6515, mean(all)=0.5970
  + SMOOTHING: median(top-10)=0.8770, mean(top-10)=0.8702, median(all)=0.8086, mean(all)=0.7306 [+0.1064]
  + MRF:       median(top-10)=0.8770, mean(top-10)=0.8704, median(all)=0.8091, mean(all)=0.7308 [-0.0000]
  TOTAL IMPROVEMENT (median top-10): +0.1064

================================================================================
Subject: NKI-TRT-20-14
================================================================================
  Step 0: Generating predictions with NEW models...
  Using PyTorch3D GPU raycasting (matching training pipeline)...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 142909 vertices, 285814 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (38361 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (89283 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (82643 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (57466 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (38597 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (61279 valid pixels)
  [PyTorch3D] Raycasting complete!
  ‚úì Got 6 output maps, shape: (6, 800, 800, 3)
  Loading trained models...
Loading models...
  Loading Front: Front-epoch=499-validation_loss=0.03.ckpt
  Loading Bottom: Bottom-epoch=499-validation_loss=0.04.ckpt
  Loading Top: Top-epoch=499-validation_loss=0.05.ckpt
  Loading Right: Right-epoch=499-validation_loss=0.04.ckpt
  Loading Back: Back-epoch=499-validation_loss=0.03.ckpt
  Loading Left: Left-epoch=499-validation_loss=0.03.ckpt
Models loaded!
  Running U-Net predictions on 6 views...
Predicting labels...
Labels predicted!
  ‚úì Got predictions from 6 views
  Aggregating predictions to vertices...
Agregating predicted labels...

üîç View 0: 2D predictions for 38361 MESH pixels (before aggregation):
   Class 12: 9613 pixels (25.1%)
   Class 30: 8552 pixels (22.3%)
   Class 9: 6306 pixels (16.4%)
   Class 10: 3368 pixels (8.8%)
   Class 8: 2328 pixels (6.1%)
   ‚Üí Background: 1.4% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0138
   ‚Üí Pixels where class 0 prob > 0.5: 497 (1.3%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9966
   ‚Üí Weights for vertex 0: mean=0.3357, max=0.9904
   ‚Üí Weights for vertex 1: mean=0.3317, max=0.9964
   ‚Üí Weights for vertex 2: mean=0.3330, max=0.9966
   ‚Üí Weights sum to 1? 1.0004

üîç View 1: 2D predictions for 89283 MESH pixels (before aggregation):
   Class 29: 16855 pixels (18.9%)
   Class 0: 16455 pixels (18.4%)
   Class 26: 9894 pixels (11.1%)
   Class 14: 6554 pixels (7.3%)
   Class 15: 5930 pixels (6.6%)
   ‚Üí Background: 18.4% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.1805
   ‚Üí Pixels where class 0 prob > 0.5: 16277 (18.2%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9980

üîç View 2: 2D predictions for 82643 MESH pixels (before aggregation):
   Class 9: 8445 pixels (10.2%)
   Class 28: 8155 pixels (9.9%)
   Class 31: 6427 pixels (7.8%)
   Class 32: 6233 pixels (7.5%)
   Class 23: 6177 pixels (7.5%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0001
   ‚Üí Pixels where class 0 prob > 0.5: 5 (0.0%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9984
DEBUG: Processed 11520000 total pixels, 1102887 valid pixels (9.6%)
DEBUG: Touched 102852.0 vertices out of 142909 (72.0%)
DEBUG: Vertices with zero probability sum: 40057 (28.0%)
DEBUG: Mean class 0 probability for touched vertices: 0.0826
\nDEBUG: Checking for views with high background predictions...
  Front: (see above for stats)
  Bottom: (see above for stats)
  Top: (see above for stats)
  Right: (see above for stats)
  Back: (see above for stats)
  Left: (see above for stats)
DEBUG: After normalization, P sums check: min=0.0000, max=1.0000
DEBUG: Predicted class distribution (before -1 shift):
  Class 0: 45856 vertices (32.1%)
  Class 29: 9505 vertices (6.7%)
  Class 28: 6794 vertices (4.8%)
  Class 30: 6469 vertices (4.5%)
  Class 12: 5709 vertices (4.0%)
  Class 9: 5582 vertices (3.9%)
  Class 23: 5174 vertices (3.6%)
  Class 25: 4910 vertices (3.4%)
  Class 14: 4523 vertices (3.2%)
  Class 10: 4339 vertices (3.0%)
DEBUG: Background predicted: 45856 (32.1%)
DEBUG: Foreground predicted: 97053 (67.9%)
Labels aggregated!
  ‚úì Aggregation complete
  ‚úì Prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-14/pred_7625119
  Loaded P matrix: (37, 142909), vertices: 142909
  Mesh: 142909 vertices, 285814 faces
  Step 1: Smoothing probabilities (20 iter, Œ±=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ‚úì Smoothing complete
  Step 2: MRF refinement (Œ≤=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
    MRF iteration 5/5...
  ‚úì MRF refinement complete

  RESULTS:
  RAW:         median(top-10)=0.7833, mean(top-10)=0.7922, median(all)=0.7008, mean(all)=0.6187
  + SMOOTHING: median(top-10)=0.8817, mean(top-10)=0.8828, median(all)=0.8077, mean(all)=0.7367 [+0.0984]
  + MRF:       median(top-10)=0.8825, mean(top-10)=0.8832, median(all)=0.8078, mean(all)=0.7371 [+0.0007]
  TOTAL IMPROVEMENT (median top-10): +0.0991

================================================================================
Subject: NKI-TRT-20-15
================================================================================
  Step 0: Generating predictions with NEW models...
  Using PyTorch3D GPU raycasting (matching training pipeline)...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 133351 vertices, 266698 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (52553 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (117608 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (108238 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (67884 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (48951 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (72211 valid pixels)
  [PyTorch3D] Raycasting complete!
  ‚úì Got 6 output maps, shape: (6, 800, 800, 3)
  Loading trained models...
Loading models...
  Loading Front: Front-epoch=499-validation_loss=0.03.ckpt
  Loading Bottom: Bottom-epoch=499-validation_loss=0.04.ckpt
  Loading Top: Top-epoch=499-validation_loss=0.05.ckpt
  Loading Right: Right-epoch=499-validation_loss=0.04.ckpt
  Loading Back: Back-epoch=499-validation_loss=0.03.ckpt
  Loading Left: Left-epoch=499-validation_loss=0.03.ckpt
Models loaded!
  Running U-Net predictions on 6 views...
Predicting labels...
Labels predicted!
  ‚úì Got predictions from 6 views
  Aggregating predictions to vertices...
Agregating predicted labels...

üîç View 0: 2D predictions for 52553 MESH pixels (before aggregation):
   Class 12: 15782 pixels (30.0%)
   Class 30: 10576 pixels (20.1%)
   Class 9: 9728 pixels (18.5%)
   Class 32: 3775 pixels (7.2%)
   Class 23: 2811 pixels (5.3%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0003
   ‚Üí Pixels where class 0 prob > 0.5: 3 (0.0%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9960
   ‚Üí Weights for vertex 0: mean=0.3337, max=0.9960
   ‚Üí Weights for vertex 1: mean=0.3333, max=0.9947
   ‚Üí Weights for vertex 2: mean=0.3333, max=0.9956
   ‚Üí Weights sum to 1? 1.0003

üîç View 1: 2D predictions for 117608 MESH pixels (before aggregation):
   Class 0: 22547 pixels (19.2%)
   Class 29: 20959 pixels (17.8%)
   Class 26: 13572 pixels (11.5%)
   Class 14: 7924 pixels (6.7%)
   Class 18: 7402 pixels (6.3%)
   ‚Üí Background: 19.2% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.1901
   ‚Üí Pixels where class 0 prob > 0.5: 22415 (19.1%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9998

üîç View 2: 2D predictions for 108238 MESH pixels (before aggregation):
   Class 32: 10501 pixels (9.7%)
   Class 28: 10240 pixels (9.5%)
   Class 31: 9569 pixels (8.8%)
   Class 25: 8138 pixels (7.5%)
   Class 16: 8056 pixels (7.4%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0001
   ‚Üí Pixels where class 0 prob > 0.5: 3 (0.0%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9983
DEBUG: Processed 11520000 total pixels, 1402335 valid pixels (12.2%)
DEBUG: Touched 98005.0 vertices out of 133351 (73.5%)
DEBUG: Vertices with zero probability sum: 35346 (26.5%)
DEBUG: Mean class 0 probability for touched vertices: 0.0886
\nDEBUG: Checking for views with high background predictions...
  Front: (see above for stats)
  Bottom: (see above for stats)
  Top: (see above for stats)
  Right: (see above for stats)
  Back: (see above for stats)
  Left: (see above for stats)
DEBUG: After normalization, P sums check: min=0.0000, max=1.0000
DEBUG: Predicted class distribution (before -1 shift):
  Class 0: 41245 vertices (30.9%)
  Class 29: 8976 vertices (6.7%)
  Class 12: 6813 vertices (5.1%)
  Class 28: 6042 vertices (4.5%)
  Class 25: 5344 vertices (4.0%)
  Class 30: 5033 vertices (3.8%)
  Class 23: 4526 vertices (3.4%)
  Class 9: 4423 vertices (3.3%)
  Class 32: 4255 vertices (3.2%)
  Class 31: 3935 vertices (3.0%)
DEBUG: Background predicted: 41245 (30.9%)
DEBUG: Foreground predicted: 92106 (69.1%)
Labels aggregated!
  ‚úì Aggregation complete
  ‚úì Prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-15/pred_7625119
  Loaded P matrix: (37, 133351), vertices: 133351
  Mesh: 133351 vertices, 266698 faces
  Step 1: Smoothing probabilities (20 iter, Œ±=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ‚úì Smoothing complete
  Step 2: MRF refinement (Œ≤=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ‚úì MRF refinement complete

  RESULTS:
  RAW:         median(top-10)=0.7986, mean(top-10)=0.7927, median(all)=0.6689, mean(all)=0.6153
  + SMOOTHING: median(top-10)=0.8934, mean(top-10)=0.8931, median(all)=0.7906, mean(all)=0.7306 [+0.0948]
  + MRF:       median(top-10)=0.8941, mean(top-10)=0.8937, median(all)=0.7906, mean(all)=0.7310 [+0.0008]
  TOTAL IMPROVEMENT (median top-10): +0.0955

================================================================================
Subject: NKI-TRT-20-16
================================================================================
  Step 0: Generating predictions with NEW models...
  Using PyTorch3D GPU raycasting (matching training pipeline)...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 157852 vertices, 315700 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (46602 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (102366 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (94297 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (62479 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (43111 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (65928 valid pixels)
  [PyTorch3D] Raycasting complete!
  ‚úì Got 6 output maps, shape: (6, 800, 800, 3)
  Loading trained models...
Loading models...
  Loading Front: Front-epoch=499-validation_loss=0.03.ckpt
  Loading Bottom: Bottom-epoch=499-validation_loss=0.04.ckpt
  Loading Top: Top-epoch=499-validation_loss=0.05.ckpt
  Loading Right: Right-epoch=499-validation_loss=0.04.ckpt
  Loading Back: Back-epoch=499-validation_loss=0.03.ckpt
  Loading Left: Left-epoch=499-validation_loss=0.03.ckpt
Models loaded!
  Running U-Net predictions on 6 views...
Predicting labels...
Labels predicted!
  ‚úì Got predictions from 6 views
  Aggregating predictions to vertices...
Agregating predicted labels...

üîç View 0: 2D predictions for 46602 MESH pixels (before aggregation):
   Class 30: 12920 pixels (27.7%)
   Class 12: 11934 pixels (25.6%)
   Class 9: 8229 pixels (17.7%)
   Class 32: 2424 pixels (5.2%)
   Class 23: 2385 pixels (5.1%)
   ‚Üí Background: 0.7% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0061
   ‚Üí Pixels where class 0 prob > 0.5: 298 (0.6%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9985
   ‚Üí Weights for vertex 0: mean=0.3331, max=0.9978
   ‚Üí Weights for vertex 1: mean=0.3340, max=0.9959
   ‚Üí Weights for vertex 2: mean=0.3333, max=0.9985
   ‚Üí Weights sum to 1? 1.0004

üîç View 1: 2D predictions for 102366 MESH pixels (before aggregation):
   Class 0: 19773 pixels (19.3%)
   Class 29: 19029 pixels (18.6%)
   Class 26: 11699 pixels (11.4%)
   Class 15: 7489 pixels (7.3%)
   Class 18: 5482 pixels (5.4%)
   ‚Üí Background: 19.3% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.1928
   ‚Üí Pixels where class 0 prob > 0.5: 19668 (19.2%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9978

üîç View 2: 2D predictions for 94297 MESH pixels (before aggregation):
   Class 31: 9258 pixels (9.8%)
   Class 25: 7570 pixels (8.0%)
   Class 28: 7510 pixels (8.0%)
   Class 16: 7474 pixels (7.9%)
   Class 23: 7316 pixels (7.8%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0001
   ‚Üí Pixels where class 0 prob > 0.5: 5 (0.0%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9984
DEBUG: Processed 11520000 total pixels, 1244349 valid pixels (10.8%)
DEBUG: Touched 115920.0 vertices out of 157852 (73.4%)
DEBUG: Vertices with zero probability sum: 41932 (26.6%)
DEBUG: Mean class 0 probability for touched vertices: 0.0817
\nDEBUG: Checking for views with high background predictions...
  Front: (see above for stats)
  Bottom: (see above for stats)
  Top: (see above for stats)
  Right: (see above for stats)
  Back: (see above for stats)
  Left: (see above for stats)
DEBUG: After normalization, P sums check: min=0.0000, max=1.0000
DEBUG: Predicted class distribution (before -1 shift):
  Class 0: 48546 vertices (30.8%)
  Class 29: 10870 vertices (6.9%)
  Class 12: 7751 vertices (4.9%)
  Class 30: 7648 vertices (4.8%)
  Class 25: 7198 vertices (4.6%)
  Class 28: 6942 vertices (4.4%)
  Class 23: 5545 vertices (3.5%)
  Class 31: 5142 vertices (3.3%)
  Class 9: 4906 vertices (3.1%)
  Class 26: 4688 vertices (3.0%)
DEBUG: Background predicted: 48546 (30.8%)
DEBUG: Foreground predicted: 109306 (69.2%)
Labels aggregated!
  ‚úì Aggregation complete
  ‚úì Prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-16/pred_7625119
  Loaded P matrix: (37, 157852), vertices: 157852
  Mesh: 157852 vertices, 315700 faces
  Step 1: Smoothing probabilities (20 iter, Œ±=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ‚úì Smoothing complete
  Step 2: MRF refinement (Œ≤=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ‚úì MRF refinement complete

  RESULTS:
  RAW:         median(top-10)=0.7912, mean(top-10)=0.7958, median(all)=0.6970, mean(all)=0.6093
  + SMOOTHING: median(top-10)=0.8696, mean(top-10)=0.8728, median(all)=0.8201, mean(all)=0.7300 [+0.0784]
  + MRF:       median(top-10)=0.8697, mean(top-10)=0.8733, median(all)=0.8203, mean(all)=0.7304 [+0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0785

================================================================================
Subject: NKI-TRT-20-17
================================================================================
  Step 0: Generating predictions with NEW models...
  Using PyTorch3D GPU raycasting (matching training pipeline)...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 135896 vertices, 271788 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (39906 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (91766 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (85085 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (62551 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (41247 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (65301 valid pixels)
  [PyTorch3D] Raycasting complete!
  ‚úì Got 6 output maps, shape: (6, 800, 800, 3)
  Loading trained models...
Loading models...
  Loading Front: Front-epoch=499-validation_loss=0.03.ckpt
  Loading Bottom: Bottom-epoch=499-validation_loss=0.04.ckpt
  Loading Top: Top-epoch=499-validation_loss=0.05.ckpt
  Loading Right: Right-epoch=499-validation_loss=0.04.ckpt
  Loading Back: Back-epoch=499-validation_loss=0.03.ckpt
  Loading Left: Left-epoch=499-validation_loss=0.03.ckpt
Models loaded!
  Running U-Net predictions on 6 views...
Predicting labels...
Labels predicted!
  ‚úì Got predictions from 6 views
  Aggregating predictions to vertices...
Agregating predicted labels...

üîç View 0: 2D predictions for 39906 MESH pixels (before aggregation):
   Class 12: 9248 pixels (23.2%)
   Class 30: 8357 pixels (20.9%)
   Class 9: 7529 pixels (18.9%)
   Class 10: 2880 pixels (7.2%)
   Class 32: 1767 pixels (4.4%)
   ‚Üí Background: 0.9% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0093
   ‚Üí Pixels where class 0 prob > 0.5: 356 (0.9%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9989
   ‚Üí Weights for vertex 0: mean=0.3351, max=0.9989
   ‚Üí Weights for vertex 1: mean=0.3323, max=0.9924
   ‚Üí Weights for vertex 2: mean=0.3329, max=0.9980
   ‚Üí Weights sum to 1? 1.0003

üîç View 1: 2D predictions for 91766 MESH pixels (before aggregation):
   Class 29: 18149 pixels (19.8%)
   Class 0: 17951 pixels (19.6%)
   Class 26: 10716 pixels (11.7%)
   Class 15: 6977 pixels (7.6%)
   Class 18: 5282 pixels (5.8%)
   ‚Üí Background: 19.6% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.1928
   ‚Üí Pixels where class 0 prob > 0.5: 17837 (19.4%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9964

üîç View 2: 2D predictions for 85085 MESH pixels (before aggregation):
   Class 28: 9068 pixels (10.7%)
   Class 9: 8602 pixels (10.1%)
   Class 31: 6858 pixels (8.1%)
   Class 32: 6529 pixels (7.7%)
   Class 16: 6476 pixels (7.6%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0000
   ‚Üí Pixels where class 0 prob > 0.5: 1 (0.0%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9983
DEBUG: Processed 11520000 total pixels, 1157568 valid pixels (10.0%)
DEBUG: Touched 97942.0 vertices out of 135896 (72.1%)
DEBUG: Vertices with zero probability sum: 37954 (27.9%)
DEBUG: Mean class 0 probability for touched vertices: 0.0818
\nDEBUG: Checking for views with high background predictions...
  Front: (see above for stats)
  Bottom: (see above for stats)
  Top: (see above for stats)
  Right: (see above for stats)
  Back: (see above for stats)
  Left: (see above for stats)
DEBUG: After normalization, P sums check: min=0.0000, max=1.0000
DEBUG: Predicted class distribution (before -1 shift):
  Class 0: 43709 vertices (32.2%)
  Class 29: 8884 vertices (6.5%)
  Class 28: 7051 vertices (5.2%)
  Class 30: 6392 vertices (4.7%)
  Class 25: 5347 vertices (3.9%)
  Class 9: 5084 vertices (3.7%)
  Class 12: 4891 vertices (3.6%)
  Class 23: 4817 vertices (3.5%)
  Class 10: 4263 vertices (3.1%)
  Class 26: 3882 vertices (2.9%)
DEBUG: Background predicted: 43709 (32.2%)
DEBUG: Foreground predicted: 92187 (67.8%)
Labels aggregated!
  ‚úì Aggregation complete
  ‚úì Prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-17/pred_7625119
  Loaded P matrix: (37, 135896), vertices: 135896
  Mesh: 135896 vertices, 271788 faces
  Step 1: Smoothing probabilities (20 iter, Œ±=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ‚úì Smoothing complete
  Step 2: MRF refinement (Œ≤=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ‚úì MRF refinement complete

  RESULTS:
  RAW:         median(top-10)=0.7705, mean(top-10)=0.7758, median(all)=0.6932, mean(all)=0.5964
  + SMOOTHING: median(top-10)=0.8739, mean(top-10)=0.8722, median(all)=0.7854, mean(all)=0.7205 [+0.1034]
  + MRF:       median(top-10)=0.8744, mean(top-10)=0.8726, median(all)=0.7855, mean(all)=0.7210 [+0.0005]
  TOTAL IMPROVEMENT (median top-10): +0.1040

================================================================================
Subject: NKI-TRT-20-18
================================================================================
  Step 0: Generating predictions with NEW models...
  Using PyTorch3D GPU raycasting (matching training pipeline)...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 132036 vertices, 264068 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (46068 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (105884 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (98544 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (64160 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (44177 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (69284 valid pixels)
  [PyTorch3D] Raycasting complete!
  ‚úì Got 6 output maps, shape: (6, 800, 800, 3)
  Loading trained models...
Loading models...
  Loading Front: Front-epoch=499-validation_loss=0.03.ckpt
  Loading Bottom: Bottom-epoch=499-validation_loss=0.04.ckpt
  Loading Top: Top-epoch=499-validation_loss=0.05.ckpt
  Loading Right: Right-epoch=499-validation_loss=0.04.ckpt
  Loading Back: Back-epoch=499-validation_loss=0.03.ckpt
  Loading Left: Left-epoch=499-validation_loss=0.03.ckpt
Models loaded!
  Running U-Net predictions on 6 views...
Predicting labels...
Labels predicted!
  ‚úì Got predictions from 6 views
  Aggregating predictions to vertices...
Agregating predicted labels...

üîç View 0: 2D predictions for 46068 MESH pixels (before aggregation):
   Class 12: 12764 pixels (27.7%)
   Class 30: 11457 pixels (24.9%)
   Class 9: 8497 pixels (18.4%)
   Class 32: 2629 pixels (5.7%)
   Class 16: 2090 pixels (4.5%)
   ‚Üí Background: 0.1% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0009
   ‚Üí Pixels where class 0 prob > 0.5: 15 (0.0%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9963
   ‚Üí Weights for vertex 0: mean=0.3334, max=0.9963
   ‚Üí Weights for vertex 1: mean=0.3336, max=0.9960
   ‚Üí Weights for vertex 2: mean=0.3333, max=0.9953
   ‚Üí Weights sum to 1? 1.0003

üîç View 1: 2D predictions for 105884 MESH pixels (before aggregation):
   Class 0: 21285 pixels (20.1%)
   Class 29: 16361 pixels (15.5%)
   Class 26: 11348 pixels (10.7%)
   Class 18: 8721 pixels (8.2%)
   Class 14: 6853 pixels (6.5%)
   ‚Üí Background: 20.1% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.1997
   ‚Üí Pixels where class 0 prob > 0.5: 21204 (20.0%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9994

üîç View 2: 2D predictions for 98544 MESH pixels (before aggregation):
   Class 23: 9434 pixels (9.6%)
   Class 9: 8885 pixels (9.0%)
   Class 25: 8661 pixels (8.8%)
   Class 16: 8124 pixels (8.2%)
   Class 28: 7498 pixels (7.6%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0001
   ‚Üí Pixels where class 0 prob > 0.5: 2 (0.0%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=1.0001
DEBUG: Processed 11520000 total pixels, 1284351 valid pixels (11.1%)
DEBUG: Touched 98943.0 vertices out of 132036 (74.9%)
DEBUG: Vertices with zero probability sum: 33093 (25.1%)
DEBUG: Mean class 0 probability for touched vertices: 0.0923
\nDEBUG: Checking for views with high background predictions...
  Front: (see above for stats)
  Bottom: (see above for stats)
  Top: (see above for stats)
  Right: (see above for stats)
  Back: (see above for stats)
  Left: (see above for stats)
DEBUG: After normalization, P sums check: min=0.0000, max=1.0000
DEBUG: Predicted class distribution (before -1 shift):
  Class 0: 39266 vertices (29.7%)
  Class 29: 7880 vertices (6.0%)
  Class 12: 6195 vertices (4.7%)
  Class 25: 5879 vertices (4.5%)
  Class 30: 5701 vertices (4.3%)
  Class 28: 5609 vertices (4.2%)
  Class 23: 5315 vertices (4.0%)
  Class 9: 4959 vertices (3.8%)
  Class 10: 4330 vertices (3.3%)
  Class 26: 3794 vertices (2.9%)
DEBUG: Background predicted: 39266 (29.7%)
DEBUG: Foreground predicted: 92770 (70.3%)
Labels aggregated!
  ‚úì Aggregation complete
  ‚úì Prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-18/pred_7625119
  Loaded P matrix: (37, 132036), vertices: 132036
  Mesh: 132036 vertices, 264068 faces
  Step 1: Smoothing probabilities (20 iter, Œ±=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ‚úì Smoothing complete
  Step 2: MRF refinement (Œ≤=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ‚úì MRF refinement complete

  RESULTS:
  RAW:         median(top-10)=0.7775, mean(top-10)=0.7881, median(all)=0.7118, mean(all)=0.6130
  + SMOOTHING: median(top-10)=0.8877, mean(top-10)=0.8920, median(all)=0.8052, mean(all)=0.7247 [+0.1102]
  + MRF:       median(top-10)=0.8883, mean(top-10)=0.8922, median(all)=0.8056, mean(all)=0.7248 [+0.0006]
  TOTAL IMPROVEMENT (median top-10): +0.1108

================================================================================
Subject: NKI-TRT-20-19
================================================================================
  Step 0: Generating predictions with NEW models...
  Using PyTorch3D GPU raycasting (matching training pipeline)...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 131542 vertices, 263080 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (37626 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (86904 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (80874 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (58563 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (36440 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (61386 valid pixels)
  [PyTorch3D] Raycasting complete!
  ‚úì Got 6 output maps, shape: (6, 800, 800, 3)
  Loading trained models...
Loading models...
  Loading Front: Front-epoch=499-validation_loss=0.03.ckpt
  Loading Bottom: Bottom-epoch=499-validation_loss=0.04.ckpt
  Loading Top: Top-epoch=499-validation_loss=0.05.ckpt
  Loading Right: Right-epoch=499-validation_loss=0.04.ckpt
  Loading Back: Back-epoch=499-validation_loss=0.03.ckpt
  Loading Left: Left-epoch=499-validation_loss=0.03.ckpt
Models loaded!
  Running U-Net predictions on 6 views...
Predicting labels...
Labels predicted!
  ‚úì Got predictions from 6 views
  Aggregating predictions to vertices...
Agregating predicted labels...

üîç View 0: 2D predictions for 37626 MESH pixels (before aggregation):
   Class 12: 10635 pixels (28.3%)
   Class 30: 8408 pixels (22.3%)
   Class 9: 7110 pixels (18.9%)
   Class 10: 3104 pixels (8.2%)
   Class 16: 1933 pixels (5.1%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0004
   ‚Üí Pixels where class 0 prob > 0.5: 2 (0.0%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9989
   ‚Üí Weights for vertex 0: mean=0.3352, max=0.9953
   ‚Üí Weights for vertex 1: mean=0.3320, max=0.9989
   ‚Üí Weights for vertex 2: mean=0.3331, max=0.9912
   ‚Üí Weights sum to 1? 1.0003

üîç View 1: 2D predictions for 86904 MESH pixels (before aggregation):
   Class 0: 16851 pixels (19.4%)
   Class 29: 16818 pixels (19.4%)
   Class 26: 8617 pixels (9.9%)
   Class 15: 5843 pixels (6.7%)
   Class 18: 5485 pixels (6.3%)
   ‚Üí Background: 19.4% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.1919
   ‚Üí Pixels where class 0 prob > 0.5: 16777 (19.3%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9976

üîç View 2: 2D predictions for 80874 MESH pixels (before aggregation):
   Class 28: 8576 pixels (10.6%)
   Class 31: 8052 pixels (10.0%)
   Class 9: 6873 pixels (8.5%)
   Class 16: 6452 pixels (8.0%)
   Class 25: 5560 pixels (6.9%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0000
   ‚Üí Pixels where class 0 prob > 0.5: 0 (0.0%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9982
DEBUG: Processed 11520000 total pixels, 1085379 valid pixels (9.4%)
DEBUG: Touched 95946.0 vertices out of 131542 (72.9%)
DEBUG: Vertices with zero probability sum: 35596 (27.1%)
DEBUG: Mean class 0 probability for touched vertices: 0.0853
\nDEBUG: Checking for views with high background predictions...
  Front: (see above for stats)
  Bottom: (see above for stats)
  Top: (see above for stats)
  Right: (see above for stats)
  Back: (see above for stats)
  Left: (see above for stats)
DEBUG: After normalization, P sums check: min=0.0000, max=1.0000
DEBUG: Predicted class distribution (before -1 shift):
  Class 0: 41158 vertices (31.3%)
  Class 29: 9528 vertices (7.2%)
  Class 28: 7246 vertices (5.5%)
  Class 12: 5918 vertices (4.5%)
  Class 25: 5608 vertices (4.3%)
  Class 9: 4858 vertices (3.7%)
  Class 30: 4849 vertices (3.7%)
  Class 23: 4031 vertices (3.1%)
  Class 10: 3956 vertices (3.0%)
  Class 31: 3907 vertices (3.0%)
DEBUG: Background predicted: 41158 (31.3%)
DEBUG: Foreground predicted: 90384 (68.7%)
Labels aggregated!
  ‚úì Aggregation complete
  ‚úì Prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-19/pred_7625119
  Loaded P matrix: (37, 131542), vertices: 131542
  Mesh: 131542 vertices, 263080 faces
  Step 1: Smoothing probabilities (20 iter, Œ±=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ‚úì Smoothing complete
  Step 2: MRF refinement (Œ≤=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ‚úì MRF refinement complete

  RESULTS:
  RAW:         median(top-10)=0.8028, mean(top-10)=0.8063, median(all)=0.7137, mean(all)=0.6214
  + SMOOTHING: median(top-10)=0.8955, mean(top-10)=0.8979, median(all)=0.8305, mean(all)=0.7481 [+0.0927]
  + MRF:       median(top-10)=0.8961, mean(top-10)=0.8981, median(all)=0.8311, mean(all)=0.7483 [+0.0006]
  TOTAL IMPROVEMENT (median top-10): +0.0932

================================================================================
Subject: NKI-TRT-20-2
================================================================================
  Step 0: Generating predictions with NEW models...
  Using PyTorch3D GPU raycasting (matching training pipeline)...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 174172 vertices, 348340 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (39346 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (91664 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (85308 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (57480 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (40244 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (61084 valid pixels)
  [PyTorch3D] Raycasting complete!
  ‚úì Got 6 output maps, shape: (6, 800, 800, 3)
  Loading trained models...
Loading models...
  Loading Front: Front-epoch=499-validation_loss=0.03.ckpt
  Loading Bottom: Bottom-epoch=499-validation_loss=0.04.ckpt
  Loading Top: Top-epoch=499-validation_loss=0.05.ckpt
  Loading Right: Right-epoch=499-validation_loss=0.04.ckpt
  Loading Back: Back-epoch=499-validation_loss=0.03.ckpt
  Loading Left: Left-epoch=499-validation_loss=0.03.ckpt
Models loaded!
  Running U-Net predictions on 6 views...
Predicting labels...
Labels predicted!
  ‚úì Got predictions from 6 views
  Aggregating predictions to vertices...
Agregating predicted labels...

üîç View 0: 2D predictions for 39346 MESH pixels (before aggregation):
   Class 12: 9356 pixels (23.8%)
   Class 9: 8901 pixels (22.6%)
   Class 30: 7850 pixels (20.0%)
   Class 10: 2699 pixels (6.9%)
   Class 16: 1999 pixels (5.1%)
   ‚Üí Background: 0.8% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0081
   ‚Üí Pixels where class 0 prob > 0.5: 289 (0.7%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=1.0011
   ‚Üí Weights for vertex 0: mean=0.3328, max=1.0001
   ‚Üí Weights for vertex 1: mean=0.3343, max=1.0011
   ‚Üí Weights for vertex 2: mean=0.3333, max=1.0000
   ‚Üí Weights sum to 1? 1.0004

üîç View 1: 2D predictions for 91664 MESH pixels (before aggregation):
   Class 0: 16522 pixels (18.0%)
   Class 29: 15341 pixels (16.7%)
   Class 26: 10103 pixels (11.0%)
   Class 18: 7074 pixels (7.7%)
   Class 14: 5719 pixels (6.2%)
   ‚Üí Background: 18.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.1780
   ‚Üí Pixels where class 0 prob > 0.5: 16417 (17.9%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9994

üîç View 2: 2D predictions for 85308 MESH pixels (before aggregation):
   Class 9: 8754 pixels (10.3%)
   Class 16: 7227 pixels (8.5%)
   Class 25: 7151 pixels (8.4%)
   Class 28: 6995 pixels (8.2%)
   Class 31: 6557 pixels (7.7%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0001
   ‚Üí Pixels where class 0 prob > 0.5: 2 (0.0%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9993
DEBUG: Processed 11520000 total pixels, 1125378 valid pixels (9.8%)
DEBUG: Touched 119269.0 vertices out of 174172 (68.5%)
DEBUG: Vertices with zero probability sum: 54903 (31.5%)
DEBUG: Mean class 0 probability for touched vertices: 0.0725
\nDEBUG: Checking for views with high background predictions...
  Front: (see above for stats)
  Bottom: (see above for stats)
  Top: (see above for stats)
  Right: (see above for stats)
  Back: (see above for stats)
  Left: (see above for stats)
DEBUG: After normalization, P sums check: min=0.0000, max=1.0000
DEBUG: Predicted class distribution (before -1 shift):
  Class 0: 61003 vertices (35.0%)
  Class 29: 10887 vertices (6.3%)
  Class 28: 7691 vertices (4.4%)
  Class 9: 7614 vertices (4.4%)
  Class 25: 6777 vertices (3.9%)
  Class 12: 6599 vertices (3.8%)
  Class 30: 6028 vertices (3.5%)
  Class 23: 5681 vertices (3.3%)
  Class 10: 5452 vertices (3.1%)
  Class 26: 4864 vertices (2.8%)
DEBUG: Background predicted: 61003 (35.0%)
DEBUG: Foreground predicted: 113169 (65.0%)
Labels aggregated!
  ‚úì Aggregation complete
  ‚úì Prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-2/pred_7625119
  Loaded P matrix: (37, 174172), vertices: 174172
  Mesh: 174172 vertices, 348340 faces
  Step 1: Smoothing probabilities (20 iter, Œ±=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ‚úì Smoothing complete
  Step 2: MRF refinement (Œ≤=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ‚úì MRF refinement complete

  RESULTS:
  RAW:         median(top-10)=0.7597, mean(top-10)=0.7706, median(all)=0.6218, mean(all)=0.5742
  + SMOOTHING: median(top-10)=0.8447, mean(top-10)=0.8474, median(all)=0.7747, mean(all)=0.7044 [+0.0850]
  + MRF:       median(top-10)=0.8450, mean(top-10)=0.8477, median(all)=0.7751, mean(all)=0.7047 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0853

================================================================================
Subject: NKI-TRT-20-20
================================================================================
  Step 0: Generating predictions with NEW models...
  Using PyTorch3D GPU raycasting (matching training pipeline)...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 147840 vertices, 295676 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (57883 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (120896 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (110660 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (74517 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (51800 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (79035 valid pixels)
  [PyTorch3D] Raycasting complete!
  ‚úì Got 6 output maps, shape: (6, 800, 800, 3)
  Loading trained models...
Loading models...
  Loading Front: Front-epoch=499-validation_loss=0.03.ckpt
  Loading Bottom: Bottom-epoch=499-validation_loss=0.04.ckpt
  Loading Top: Top-epoch=499-validation_loss=0.05.ckpt
  Loading Right: Right-epoch=499-validation_loss=0.04.ckpt
  Loading Back: Back-epoch=499-validation_loss=0.03.ckpt
  Loading Left: Left-epoch=499-validation_loss=0.03.ckpt
Models loaded!
  Running U-Net predictions on 6 views...
Predicting labels...
Labels predicted!
  ‚úì Got predictions from 6 views
  Aggregating predictions to vertices...
Agregating predicted labels...

üîç View 0: 2D predictions for 57883 MESH pixels (before aggregation):
   Class 30: 15570 pixels (26.9%)
   Class 12: 15215 pixels (26.3%)
   Class 9: 9876 pixels (17.1%)
   Class 23: 4188 pixels (7.2%)
   Class 32: 3591 pixels (6.2%)
   ‚Üí Background: 0.2% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0016
   ‚Üí Pixels where class 0 prob > 0.5: 80 (0.1%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9984
   ‚Üí Weights for vertex 0: mean=0.3353, max=0.9984
   ‚Üí Weights for vertex 1: mean=0.3326, max=0.9913
   ‚Üí Weights for vertex 2: mean=0.3324, max=0.9940
   ‚Üí Weights sum to 1? 1.0003

üîç View 1: 2D predictions for 120896 MESH pixels (before aggregation):
   Class 0: 24180 pixels (20.0%)
   Class 29: 19905 pixels (16.5%)
   Class 26: 14599 pixels (12.1%)
   Class 18: 10360 pixels (8.6%)
   Class 15: 8067 pixels (6.7%)
   ‚Üí Background: 20.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.2000
   ‚Üí Pixels where class 0 prob > 0.5: 24076 (19.9%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9989

üîç View 2: 2D predictions for 110660 MESH pixels (before aggregation):
   Class 28: 14819 pixels (13.4%)
   Class 25: 10074 pixels (9.1%)
   Class 31: 9538 pixels (8.6%)
   Class 32: 9086 pixels (8.2%)
   Class 16: 8512 pixels (7.7%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0001
   ‚Üí Pixels where class 0 prob > 0.5: 3 (0.0%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9975
DEBUG: Processed 11520000 total pixels, 1484373 valid pixels (12.9%)
DEBUG: Touched 107451.0 vertices out of 147840 (72.7%)
DEBUG: Vertices with zero probability sum: 40389 (27.3%)
DEBUG: Mean class 0 probability for touched vertices: 0.0818
\nDEBUG: Checking for views with high background predictions...
  Front: (see above for stats)
  Bottom: (see above for stats)
  Top: (see above for stats)
  Right: (see above for stats)
  Back: (see above for stats)
  Left: (see above for stats)
DEBUG: After normalization, P sums check: min=0.0000, max=1.0000
DEBUG: Predicted class distribution (before -1 shift):
  Class 0: 46401 vertices (31.4%)
  Class 29: 9857 vertices (6.7%)
  Class 28: 8239 vertices (5.6%)
  Class 12: 7013 vertices (4.7%)
  Class 30: 6756 vertices (4.6%)
  Class 25: 6446 vertices (4.4%)
  Class 26: 4890 vertices (3.3%)
  Class 23: 4498 vertices (3.0%)
  Class 9: 4326 vertices (2.9%)
  Class 31: 4011 vertices (2.7%)
DEBUG: Background predicted: 46401 (31.4%)
DEBUG: Foreground predicted: 101439 (68.6%)
Labels aggregated!
  ‚úì Aggregation complete
  ‚úì Prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-20/pred_7625119
  Loaded P matrix: (37, 147840), vertices: 147840
  Mesh: 147840 vertices, 295676 faces
  Step 1: Smoothing probabilities (20 iter, Œ±=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ‚úì Smoothing complete
  Step 2: MRF refinement (Œ≤=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ‚úì MRF refinement complete

  RESULTS:
  RAW:         median(top-10)=0.7847, mean(top-10)=0.7981, median(all)=0.6805, mean(all)=0.6133
  + SMOOTHING: median(top-10)=0.8799, mean(top-10)=0.8853, median(all)=0.7946, mean(all)=0.7285 [+0.0951]
  + MRF:       median(top-10)=0.8805, mean(top-10)=0.8855, median(all)=0.7942, mean(all)=0.7288 [+0.0007]
  TOTAL IMPROVEMENT (median top-10): +0.0958

================================================================================
Subject: NKI-TRT-20-3
================================================================================
  Step 0: Generating predictions with NEW models...
  Using PyTorch3D GPU raycasting (matching training pipeline)...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 123781 vertices, 247558 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (57423 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (119159 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (109764 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (73742 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (55403 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (77075 valid pixels)
  [PyTorch3D] Raycasting complete!
  ‚úì Got 6 output maps, shape: (6, 800, 800, 3)
  Loading trained models...
Loading models...
  Loading Front: Front-epoch=499-validation_loss=0.03.ckpt
  Loading Bottom: Bottom-epoch=499-validation_loss=0.04.ckpt
  Loading Top: Top-epoch=499-validation_loss=0.05.ckpt
  Loading Right: Right-epoch=499-validation_loss=0.04.ckpt
  Loading Back: Back-epoch=499-validation_loss=0.03.ckpt
  Loading Left: Left-epoch=499-validation_loss=0.03.ckpt
Models loaded!
  Running U-Net predictions on 6 views...
Predicting labels...
Labels predicted!
  ‚úì Got predictions from 6 views
  Aggregating predictions to vertices...
Agregating predicted labels...

üîç View 0: 2D predictions for 57423 MESH pixels (before aggregation):
   Class 12: 14406 pixels (25.1%)
   Class 30: 13771 pixels (24.0%)
   Class 9: 9427 pixels (16.4%)
   Class 23: 4696 pixels (8.2%)
   Class 25: 3098 pixels (5.4%)
   ‚Üí Background: 0.2% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0022
   ‚Üí Pixels where class 0 prob > 0.5: 70 (0.1%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9990
   ‚Üí Weights for vertex 0: mean=0.3348, max=0.9951
   ‚Üí Weights for vertex 1: mean=0.3329, max=0.9989
   ‚Üí Weights for vertex 2: mean=0.3325, max=0.9990
   ‚Üí Weights sum to 1? 1.0003

üîç View 1: 2D predictions for 119159 MESH pixels (before aggregation):
   Class 29: 25053 pixels (21.0%)
   Class 0: 24796 pixels (20.8%)
   Class 26: 10916 pixels (9.2%)
   Class 15: 7541 pixels (6.3%)
   Class 18: 7519 pixels (6.3%)
   ‚Üí Background: 20.8% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.2072
   ‚Üí Pixels where class 0 prob > 0.5: 24688 (20.7%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9982

üîç View 2: 2D predictions for 109764 MESH pixels (before aggregation):
   Class 25: 10695 pixels (9.7%)
   Class 28: 9682 pixels (8.8%)
   Class 31: 9460 pixels (8.6%)
   Class 16: 8248 pixels (7.5%)
   Class 32: 8178 pixels (7.5%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0001
   ‚Üí Pixels where class 0 prob > 0.5: 2 (0.0%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9998
DEBUG: Processed 11520000 total pixels, 1477698 valid pixels (12.8%)
DEBUG: Touched 90946.0 vertices out of 123781 (73.5%)
DEBUG: Vertices with zero probability sum: 32835 (26.5%)
DEBUG: Mean class 0 probability for touched vertices: 0.0953
\nDEBUG: Checking for views with high background predictions...
  Front: (see above for stats)
  Bottom: (see above for stats)
  Top: (see above for stats)
  Right: (see above for stats)
  Back: (see above for stats)
  Left: (see above for stats)
DEBUG: After normalization, P sums check: min=0.0000, max=1.0000
DEBUG: Predicted class distribution (before -1 shift):
  Class 0: 38496 vertices (31.1%)
  Class 29: 9385 vertices (7.6%)
  Class 28: 6183 vertices (5.0%)
  Class 25: 5947 vertices (4.8%)
  Class 12: 5383 vertices (4.3%)
  Class 30: 5046 vertices (4.1%)
  Class 9: 3939 vertices (3.2%)
  Class 23: 3852 vertices (3.1%)
  Class 10: 3607 vertices (2.9%)
  Class 31: 3433 vertices (2.8%)
DEBUG: Background predicted: 38496 (31.1%)
DEBUG: Foreground predicted: 85285 (68.9%)
Labels aggregated!
  ‚úì Aggregation complete
  ‚úì Prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-3/pred_7625119
  Loaded P matrix: (37, 123781), vertices: 123781
  Mesh: 123781 vertices, 247558 faces
  Step 1: Smoothing probabilities (20 iter, Œ±=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ‚úì Smoothing complete
  Step 2: MRF refinement (Œ≤=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ‚úì MRF refinement complete

  RESULTS:
  RAW:         median(top-10)=0.7811, mean(top-10)=0.7930, median(all)=0.6615, mean(all)=0.6166
  + SMOOTHING: median(top-10)=0.8581, mean(top-10)=0.8693, median(all)=0.8169, mean(all)=0.7291 [+0.0770]
  + MRF:       median(top-10)=0.8579, mean(top-10)=0.8696, median(all)=0.8176, mean(all)=0.7295 [-0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0768

================================================================================
Subject: NKI-TRT-20-4
================================================================================
  Step 0: Generating predictions with NEW models...
  Using PyTorch3D GPU raycasting (matching training pipeline)...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 158207 vertices, 316410 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (56591 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (115124 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (104032 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (73926 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (53553 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (76147 valid pixels)
  [PyTorch3D] Raycasting complete!
  ‚úì Got 6 output maps, shape: (6, 800, 800, 3)
  Loading trained models...
Loading models...
  Loading Front: Front-epoch=499-validation_loss=0.03.ckpt
  Loading Bottom: Bottom-epoch=499-validation_loss=0.04.ckpt
  Loading Top: Top-epoch=499-validation_loss=0.05.ckpt
  Loading Right: Right-epoch=499-validation_loss=0.04.ckpt
  Loading Back: Back-epoch=499-validation_loss=0.03.ckpt
  Loading Left: Left-epoch=499-validation_loss=0.03.ckpt
Models loaded!
  Running U-Net predictions on 6 views...
Predicting labels...
Labels predicted!
  ‚úì Got predictions from 6 views
  Aggregating predictions to vertices...
Agregating predicted labels...

üîç View 0: 2D predictions for 56591 MESH pixels (before aggregation):
   Class 12: 17483 pixels (30.9%)
   Class 30: 13524 pixels (23.9%)
   Class 9: 9733 pixels (17.2%)
   Class 32: 2817 pixels (5.0%)
   Class 23: 2725 pixels (4.8%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0005
   ‚Üí Pixels where class 0 prob > 0.5: 12 (0.0%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9965
   ‚Üí Weights for vertex 0: mean=0.3333, max=0.9965
   ‚Üí Weights for vertex 1: mean=0.3327, max=0.9961
   ‚Üí Weights for vertex 2: mean=0.3343, max=0.9959
   ‚Üí Weights sum to 1? 1.0003

üîç View 1: 2D predictions for 115124 MESH pixels (before aggregation):
   Class 29: 22151 pixels (19.2%)
   Class 0: 20964 pixels (18.2%)
   Class 26: 12640 pixels (11.0%)
   Class 15: 7289 pixels (6.3%)
   Class 6: 6967 pixels (6.1%)
   ‚Üí Background: 18.2% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.1819
   ‚Üí Pixels where class 0 prob > 0.5: 20882 (18.1%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=1.0000

üîç View 2: 2D predictions for 104032 MESH pixels (before aggregation):
   Class 28: 9969 pixels (9.6%)
   Class 16: 9248 pixels (8.9%)
   Class 23: 9171 pixels (8.8%)
   Class 31: 9145 pixels (8.8%)
   Class 32: 8474 pixels (8.1%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0001
   ‚Üí Pixels where class 0 prob > 0.5: 2 (0.0%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9982
DEBUG: Processed 11520000 total pixels, 1438119 valid pixels (12.5%)
DEBUG: Touched 110945.0 vertices out of 158207 (70.1%)
DEBUG: Vertices with zero probability sum: 47262 (29.9%)
DEBUG: Mean class 0 probability for touched vertices: 0.0794
\nDEBUG: Checking for views with high background predictions...
  Front: (see above for stats)
  Bottom: (see above for stats)
  Top: (see above for stats)
  Right: (see above for stats)
  Back: (see above for stats)
  Left: (see above for stats)
DEBUG: After normalization, P sums check: min=0.0000, max=1.0000
DEBUG: Predicted class distribution (before -1 shift):
  Class 0: 53515 vertices (33.8%)
  Class 29: 10422 vertices (6.6%)
  Class 12: 7501 vertices (4.7%)
  Class 28: 7378 vertices (4.7%)
  Class 30: 6741 vertices (4.3%)
  Class 23: 5466 vertices (3.5%)
  Class 25: 5268 vertices (3.3%)
  Class 9: 5008 vertices (3.2%)
  Class 10: 4758 vertices (3.0%)
  Class 16: 4443 vertices (2.8%)
DEBUG: Background predicted: 53515 (33.8%)
DEBUG: Foreground predicted: 104692 (66.2%)
Labels aggregated!
  ‚úì Aggregation complete
  ‚úì Prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-4/pred_7625119
  Loaded P matrix: (37, 158207), vertices: 158207
  Mesh: 158207 vertices, 316410 faces
  Step 1: Smoothing probabilities (20 iter, Œ±=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ‚úì Smoothing complete
  Step 2: MRF refinement (Œ≤=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ‚úì MRF refinement complete

  RESULTS:
  RAW:         median(top-10)=0.7643, mean(top-10)=0.7700, median(all)=0.6809, mean(all)=0.5933
  + SMOOTHING: median(top-10)=0.8704, mean(top-10)=0.8695, median(all)=0.8139, mean(all)=0.7193 [+0.1061]
  + MRF:       median(top-10)=0.8704, mean(top-10)=0.8699, median(all)=0.8143, mean(all)=0.7198 [+0.0000]
  TOTAL IMPROVEMENT (median top-10): +0.1061

================================================================================
Subject: NKI-TRT-20-5
================================================================================
  Step 0: Generating predictions with NEW models...
  Using PyTorch3D GPU raycasting (matching training pipeline)...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 137753 vertices, 275502 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (45787 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (103903 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (96260 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (64915 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (46216 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (69483 valid pixels)
  [PyTorch3D] Raycasting complete!
  ‚úì Got 6 output maps, shape: (6, 800, 800, 3)
  Loading trained models...
Loading models...
  Loading Front: Front-epoch=499-validation_loss=0.03.ckpt
  Loading Bottom: Bottom-epoch=499-validation_loss=0.04.ckpt
  Loading Top: Top-epoch=499-validation_loss=0.05.ckpt
  Loading Right: Right-epoch=499-validation_loss=0.04.ckpt
  Loading Back: Back-epoch=499-validation_loss=0.03.ckpt
  Loading Left: Left-epoch=499-validation_loss=0.03.ckpt
Models loaded!
  Running U-Net predictions on 6 views...
Predicting labels...
Labels predicted!
  ‚úì Got predictions from 6 views
  Aggregating predictions to vertices...
Agregating predicted labels...

üîç View 0: 2D predictions for 45787 MESH pixels (before aggregation):
   Class 12: 15792 pixels (34.5%)
   Class 9: 9564 pixels (20.9%)
   Class 30: 5422 pixels (11.8%)
   Class 16: 2452 pixels (5.4%)
   Class 10: 2271 pixels (5.0%)
   ‚Üí Background: 0.2% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0032
   ‚Üí Pixels where class 0 prob > 0.5: 83 (0.2%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9975
   ‚Üí Weights for vertex 0: mean=0.3342, max=0.9929
   ‚Üí Weights for vertex 1: mean=0.3335, max=0.9959
   ‚Üí Weights for vertex 2: mean=0.3326, max=0.9975
   ‚Üí Weights sum to 1? 1.0003

üîç View 1: 2D predictions for 103903 MESH pixels (before aggregation):
   Class 0: 18930 pixels (18.2%)
   Class 29: 16374 pixels (15.8%)
   Class 26: 11070 pixels (10.7%)
   Class 15: 8269 pixels (8.0%)
   Class 18: 7023 pixels (6.8%)
   ‚Üí Background: 18.2% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.1806
   ‚Üí Pixels where class 0 prob > 0.5: 18827 (18.1%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9979

üîç View 2: 2D predictions for 96260 MESH pixels (before aggregation):
   Class 9: 11114 pixels (11.5%)
   Class 23: 7943 pixels (8.3%)
   Class 25: 7810 pixels (8.1%)
   Class 32: 7552 pixels (7.8%)
   Class 16: 7486 pixels (7.8%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0000
   ‚Üí Pixels where class 0 prob > 0.5: 0 (0.0%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9988
DEBUG: Processed 11520000 total pixels, 1279692 valid pixels (11.1%)
DEBUG: Touched 97575.0 vertices out of 137753 (70.8%)
DEBUG: Vertices with zero probability sum: 40178 (29.2%)
DEBUG: Mean class 0 probability for touched vertices: 0.0757
\nDEBUG: Checking for views with high background predictions...
  Front: (see above for stats)
  Bottom: (see above for stats)
  Top: (see above for stats)
  Right: (see above for stats)
  Back: (see above for stats)
  Left: (see above for stats)
DEBUG: After normalization, P sums check: min=0.0000, max=1.0000
DEBUG: Predicted class distribution (before -1 shift):
  Class 0: 45430 vertices (33.0%)
  Class 29: 8227 vertices (6.0%)
  Class 12: 7019 vertices (5.1%)
  Class 9: 6414 vertices (4.7%)
  Class 28: 6221 vertices (4.5%)
  Class 23: 4440 vertices (3.2%)
  Class 25: 4356 vertices (3.2%)
  Class 30: 4267 vertices (3.1%)
  Class 14: 3909 vertices (2.8%)
  Class 10: 3717 vertices (2.7%)
DEBUG: Background predicted: 45430 (33.0%)
DEBUG: Foreground predicted: 92323 (67.0%)
Labels aggregated!
  ‚úì Aggregation complete
  ‚úì Prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-5/pred_7625119
  Loaded P matrix: (37, 137753), vertices: 137753
  Mesh: 137753 vertices, 275502 faces
  Step 1: Smoothing probabilities (20 iter, Œ±=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ‚úì Smoothing complete
  Step 2: MRF refinement (Œ≤=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ‚úì MRF refinement complete

  RESULTS:
  RAW:         median(top-10)=0.7835, mean(top-10)=0.7883, median(all)=0.6624, mean(all)=0.5952
  + SMOOTHING: median(top-10)=0.8686, mean(top-10)=0.8707, median(all)=0.7924, mean(all)=0.7105 [+0.0851]
  + MRF:       median(top-10)=0.8688, mean(top-10)=0.8710, median(all)=0.7933, mean(all)=0.7107 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0853

================================================================================
Subject: NKI-TRT-20-6
================================================================================
  Step 0: Generating predictions with NEW models...
  Using PyTorch3D GPU raycasting (matching training pipeline)...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 158025 vertices, 316046 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (48945 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (109618 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (101944 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (64143 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (46253 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (68278 valid pixels)
  [PyTorch3D] Raycasting complete!
  ‚úì Got 6 output maps, shape: (6, 800, 800, 3)
  Loading trained models...
Loading models...
  Loading Front: Front-epoch=499-validation_loss=0.03.ckpt
  Loading Bottom: Bottom-epoch=499-validation_loss=0.04.ckpt
  Loading Top: Top-epoch=499-validation_loss=0.05.ckpt
  Loading Right: Right-epoch=499-validation_loss=0.04.ckpt
  Loading Back: Back-epoch=499-validation_loss=0.03.ckpt
  Loading Left: Left-epoch=499-validation_loss=0.03.ckpt
Models loaded!
  Running U-Net predictions on 6 views...
Predicting labels...
Labels predicted!
  ‚úì Got predictions from 6 views
  Aggregating predictions to vertices...
Agregating predicted labels...

üîç View 0: 2D predictions for 48945 MESH pixels (before aggregation):
   Class 30: 13108 pixels (26.8%)
   Class 12: 11055 pixels (22.6%)
   Class 9: 9847 pixels (20.1%)
   Class 32: 3556 pixels (7.3%)
   Class 23: 2733 pixels (5.6%)
   ‚Üí Background: 0.3% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0032
   ‚Üí Pixels where class 0 prob > 0.5: 130 (0.3%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9990
   ‚Üí Weights for vertex 0: mean=0.3349, max=0.9953
   ‚Üí Weights for vertex 1: mean=0.3322, max=0.9936
   ‚Üí Weights for vertex 2: mean=0.3332, max=0.9990
   ‚Üí Weights sum to 1? 1.0003

üîç View 1: 2D predictions for 109618 MESH pixels (before aggregation):
   Class 0: 21347 pixels (19.5%)
   Class 29: 21076 pixels (19.2%)
   Class 26: 14490 pixels (13.2%)
   Class 14: 6633 pixels (6.1%)
   Class 15: 6405 pixels (5.8%)
   ‚Üí Background: 19.5% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.1948
   ‚Üí Pixels where class 0 prob > 0.5: 21200 (19.3%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9991

üîç View 2: 2D predictions for 101944 MESH pixels (before aggregation):
   Class 28: 9832 pixels (9.6%)
   Class 9: 9005 pixels (8.8%)
   Class 16: 8811 pixels (8.6%)
   Class 25: 8426 pixels (8.3%)
   Class 32: 8422 pixels (8.3%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0001
   ‚Üí Pixels where class 0 prob > 0.5: 2 (0.0%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9990
DEBUG: Processed 11520000 total pixels, 1317543 valid pixels (11.4%)
DEBUG: Touched 114991.0 vertices out of 158025 (72.8%)
DEBUG: Vertices with zero probability sum: 43034 (27.2%)
DEBUG: Mean class 0 probability for touched vertices: 0.0903
\nDEBUG: Checking for views with high background predictions...
  Front: (see above for stats)
  Bottom: (see above for stats)
  Top: (see above for stats)
  Right: (see above for stats)
  Back: (see above for stats)
  Left: (see above for stats)
DEBUG: After normalization, P sums check: min=0.0000, max=1.0000
DEBUG: Predicted class distribution (before -1 shift):
  Class 0: 50106 vertices (31.7%)
  Class 29: 10827 vertices (6.9%)
  Class 28: 7618 vertices (4.8%)
  Class 12: 6990 vertices (4.4%)
  Class 30: 6888 vertices (4.4%)
  Class 9: 6622 vertices (4.2%)
  Class 25: 6430 vertices (4.1%)
  Class 23: 5274 vertices (3.3%)
  Class 26: 5108 vertices (3.2%)
  Class 8: 4897 vertices (3.1%)
DEBUG: Background predicted: 50106 (31.7%)
DEBUG: Foreground predicted: 107919 (68.3%)
Labels aggregated!
  ‚úì Aggregation complete
  ‚úì Prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-6/pred_7625119
  Loaded P matrix: (37, 158025), vertices: 158025
  Mesh: 158025 vertices, 316046 faces
  Step 1: Smoothing probabilities (20 iter, Œ±=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ‚úì Smoothing complete
  Step 2: MRF refinement (Œ≤=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
    MRF iteration 5/5...
  ‚úì MRF refinement complete

  RESULTS:
  RAW:         median(top-10)=0.7681, mean(top-10)=0.7833, median(all)=0.6858, mean(all)=0.6063
  + SMOOTHING: median(top-10)=0.8853, mean(top-10)=0.8835, median(all)=0.8006, mean(all)=0.7268 [+0.1171]
  + MRF:       median(top-10)=0.8855, mean(top-10)=0.8841, median(all)=0.8002, mean(all)=0.7271 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.1174

================================================================================
Subject: NKI-TRT-20-7
================================================================================
  Step 0: Generating predictions with NEW models...
  Using PyTorch3D GPU raycasting (matching training pipeline)...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 145017 vertices, 290030 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (46206 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (100869 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (93314 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (65317 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (45944 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (69009 valid pixels)
  [PyTorch3D] Raycasting complete!
  ‚úì Got 6 output maps, shape: (6, 800, 800, 3)
  Loading trained models...
Loading models...
  Loading Front: Front-epoch=499-validation_loss=0.03.ckpt
  Loading Bottom: Bottom-epoch=499-validation_loss=0.04.ckpt
  Loading Top: Top-epoch=499-validation_loss=0.05.ckpt
  Loading Right: Right-epoch=499-validation_loss=0.04.ckpt
  Loading Back: Back-epoch=499-validation_loss=0.03.ckpt
  Loading Left: Left-epoch=499-validation_loss=0.03.ckpt
Models loaded!
  Running U-Net predictions on 6 views...
Predicting labels...
Labels predicted!
  ‚úì Got predictions from 6 views
  Aggregating predictions to vertices...
Agregating predicted labels...

üîç View 0: 2D predictions for 46206 MESH pixels (before aggregation):
   Class 12: 12695 pixels (27.5%)
   Class 30: 11081 pixels (24.0%)
   Class 9: 7855 pixels (17.0%)
   Class 23: 2780 pixels (6.0%)
   Class 32: 2358 pixels (5.1%)
   ‚Üí Background: 0.7% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0061
   ‚Üí Pixels where class 0 prob > 0.5: 257 (0.6%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9951
   ‚Üí Weights for vertex 0: mean=0.3343, max=0.9881
   ‚Üí Weights for vertex 1: mean=0.3322, max=0.9929
   ‚Üí Weights for vertex 2: mean=0.3338, max=0.9951
   ‚Üí Weights sum to 1? 1.0003

üîç View 1: 2D predictions for 100869 MESH pixels (before aggregation):
   Class 0: 21395 pixels (21.2%)
   Class 29: 19648 pixels (19.5%)
   Class 26: 10534 pixels (10.4%)
   Class 15: 6647 pixels (6.6%)
   Class 14: 6203 pixels (6.1%)
   ‚Üí Background: 21.2% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.2108
   ‚Üí Pixels where class 0 prob > 0.5: 21277 (21.1%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9972

üîç View 2: 2D predictions for 93314 MESH pixels (before aggregation):
   Class 28: 9341 pixels (10.0%)
   Class 32: 7988 pixels (8.6%)
   Class 31: 7829 pixels (8.4%)
   Class 12: 7243 pixels (7.8%)
   Class 16: 6928 pixels (7.4%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0001
   ‚Üí Pixels where class 0 prob > 0.5: 4 (0.0%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9984
DEBUG: Processed 11520000 total pixels, 1261977 valid pixels (11.0%)
DEBUG: Touched 100151.0 vertices out of 145017 (69.1%)
DEBUG: Vertices with zero probability sum: 44866 (30.9%)
DEBUG: Mean class 0 probability for touched vertices: 0.0909
\nDEBUG: Checking for views with high background predictions...
  Front: (see above for stats)
  Bottom: (see above for stats)
  Top: (see above for stats)
  Right: (see above for stats)
  Back: (see above for stats)
  Left: (see above for stats)
DEBUG: After normalization, P sums check: min=0.0000, max=1.0000
DEBUG: Predicted class distribution (before -1 shift):
  Class 0: 50816 vertices (35.0%)
  Class 29: 9543 vertices (6.6%)
  Class 28: 7128 vertices (4.9%)
  Class 12: 6263 vertices (4.3%)
  Class 30: 5521 vertices (3.8%)
  Class 25: 5233 vertices (3.6%)
  Class 9: 4655 vertices (3.2%)
  Class 23: 4116 vertices (2.8%)
  Class 10: 4055 vertices (2.8%)
  Class 8: 3988 vertices (2.8%)
DEBUG: Background predicted: 50816 (35.0%)
DEBUG: Foreground predicted: 94201 (65.0%)
Labels aggregated!
  ‚úì Aggregation complete
  ‚úì Prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-7/pred_7625119
  Loaded P matrix: (37, 145017), vertices: 145017
  Mesh: 145017 vertices, 290030 faces
  Step 1: Smoothing probabilities (20 iter, Œ±=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ‚úì Smoothing complete
  Step 2: MRF refinement (Œ≤=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ‚úì MRF refinement complete

  RESULTS:
  RAW:         median(top-10)=0.7548, mean(top-10)=0.7571, median(all)=0.6515, mean(all)=0.5794
  + SMOOTHING: median(top-10)=0.8568, mean(top-10)=0.8630, median(all)=0.8226, mean(all)=0.7293 [+0.1020]
  + MRF:       median(top-10)=0.8572, mean(top-10)=0.8630, median(all)=0.8228, mean(all)=0.7296 [+0.0004]
  TOTAL IMPROVEMENT (median top-10): +0.1024

================================================================================
Subject: NKI-TRT-20-8
================================================================================
  Step 0: Generating predictions with NEW models...
  Using PyTorch3D GPU raycasting (matching training pipeline)...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 147404 vertices, 294804 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (45232 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (95531 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (89220 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (60469 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (45913 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (65474 valid pixels)
  [PyTorch3D] Raycasting complete!
  ‚úì Got 6 output maps, shape: (6, 800, 800, 3)
  Loading trained models...
Loading models...
  Loading Front: Front-epoch=499-validation_loss=0.03.ckpt
  Loading Bottom: Bottom-epoch=499-validation_loss=0.04.ckpt
  Loading Top: Top-epoch=499-validation_loss=0.05.ckpt
  Loading Right: Right-epoch=499-validation_loss=0.04.ckpt
  Loading Back: Back-epoch=499-validation_loss=0.03.ckpt
  Loading Left: Left-epoch=499-validation_loss=0.03.ckpt
Models loaded!
  Running U-Net predictions on 6 views...
Predicting labels...
Labels predicted!
  ‚úì Got predictions from 6 views
  Aggregating predictions to vertices...
Agregating predicted labels...

üîç View 0: 2D predictions for 45232 MESH pixels (before aggregation):
   Class 30: 10054 pixels (22.2%)
   Class 12: 9623 pixels (21.3%)
   Class 9: 7860 pixels (17.4%)
   Class 10: 2862 pixels (6.3%)
   Class 32: 2501 pixels (5.5%)
   ‚Üí Background: 1.4% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0146
   ‚Üí Pixels where class 0 prob > 0.5: 620 (1.4%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9983
   ‚Üí Weights for vertex 0: mean=0.3344, max=0.9961
   ‚Üí Weights for vertex 1: mean=0.3338, max=0.9971
   ‚Üí Weights for vertex 2: mean=0.3321, max=0.9983
   ‚Üí Weights sum to 1? 1.0003

üîç View 1: 2D predictions for 95531 MESH pixels (before aggregation):
   Class 0: 18932 pixels (19.8%)
   Class 29: 18143 pixels (19.0%)
   Class 26: 11189 pixels (11.7%)
   Class 15: 6494 pixels (6.8%)
   Class 6: 5535 pixels (5.8%)
   ‚Üí Background: 19.8% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.1948
   ‚Üí Pixels where class 0 prob > 0.5: 18734 (19.6%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9992

üîç View 2: 2D predictions for 89220 MESH pixels (before aggregation):
   Class 32: 8339 pixels (9.3%)
   Class 9: 7822 pixels (8.8%)
   Class 16: 7310 pixels (8.2%)
   Class 31: 7099 pixels (8.0%)
   Class 12: 6228 pixels (7.0%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0002
   ‚Üí Pixels where class 0 prob > 0.5: 3 (0.0%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9977
DEBUG: Processed 11520000 total pixels, 1205517 valid pixels (10.5%)
DEBUG: Touched 105164.0 vertices out of 147404 (71.3%)
DEBUG: Vertices with zero probability sum: 42240 (28.7%)
DEBUG: Mean class 0 probability for touched vertices: 0.0858
\nDEBUG: Checking for views with high background predictions...
  Front: (see above for stats)
  Bottom: (see above for stats)
  Top: (see above for stats)
  Right: (see above for stats)
  Back: (see above for stats)
  Left: (see above for stats)
DEBUG: After normalization, P sums check: min=0.0000, max=1.0000
DEBUG: Predicted class distribution (before -1 shift):
  Class 0: 48893 vertices (33.2%)
  Class 29: 8299 vertices (5.6%)
  Class 30: 6309 vertices (4.3%)
  Class 25: 5829 vertices (4.0%)
  Class 28: 5750 vertices (3.9%)
  Class 12: 5481 vertices (3.7%)
  Class 23: 5320 vertices (3.6%)
  Class 9: 5148 vertices (3.5%)
  Class 32: 4869 vertices (3.3%)
  Class 26: 4440 vertices (3.0%)
DEBUG: Background predicted: 48893 (33.2%)
DEBUG: Foreground predicted: 98511 (66.8%)
Labels aggregated!
  ‚úì Aggregation complete
  ‚úì Prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-8/pred_7625119
  Loaded P matrix: (37, 147404), vertices: 147404
  Mesh: 147404 vertices, 294804 faces
  Step 1: Smoothing probabilities (20 iter, Œ±=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ‚úì Smoothing complete
  Step 2: MRF refinement (Œ≤=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ‚úì MRF refinement complete

  RESULTS:
  RAW:         median(top-10)=0.7471, mean(top-10)=0.7570, median(all)=0.6556, mean(all)=0.5779
  + SMOOTHING: median(top-10)=0.8390, mean(top-10)=0.8447, median(all)=0.7821, mean(all)=0.6968 [+0.0919]
  + MRF:       median(top-10)=0.8398, mean(top-10)=0.8450, median(all)=0.7823, mean(all)=0.6973 [+0.0008]
  TOTAL IMPROVEMENT (median top-10): +0.0927

================================================================================
Subject: NKI-TRT-20-9
================================================================================
  Step 0: Generating predictions with NEW models...
  Using PyTorch3D GPU raycasting (matching training pipeline)...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 141802 vertices, 283600 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (43920 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (107762 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (100632 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (59095 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (42677 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (64692 valid pixels)
  [PyTorch3D] Raycasting complete!
  ‚úì Got 6 output maps, shape: (6, 800, 800, 3)
  Loading trained models...
Loading models...
  Loading Front: Front-epoch=499-validation_loss=0.03.ckpt
  Loading Bottom: Bottom-epoch=499-validation_loss=0.04.ckpt
  Loading Top: Top-epoch=499-validation_loss=0.05.ckpt
  Loading Right: Right-epoch=499-validation_loss=0.04.ckpt
  Loading Back: Back-epoch=499-validation_loss=0.03.ckpt
  Loading Left: Left-epoch=499-validation_loss=0.03.ckpt
Models loaded!
  Running U-Net predictions on 6 views...
Predicting labels...
Labels predicted!
  ‚úì Got predictions from 6 views
  Aggregating predictions to vertices...
Agregating predicted labels...

üîç View 0: 2D predictions for 43920 MESH pixels (before aggregation):
   Class 12: 11688 pixels (26.6%)
   Class 9: 10615 pixels (24.2%)
   Class 30: 7816 pixels (17.8%)
   Class 16: 2927 pixels (6.7%)
   Class 32: 2732 pixels (6.2%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0008
   ‚Üí Pixels where class 0 prob > 0.5: 8 (0.0%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9983
   ‚Üí Weights for vertex 0: mean=0.3342, max=0.9965
   ‚Üí Weights for vertex 1: mean=0.3325, max=0.9964
   ‚Üí Weights for vertex 2: mean=0.3336, max=0.9983
   ‚Üí Weights sum to 1? 1.0003

üîç View 1: 2D predictions for 107762 MESH pixels (before aggregation):
   Class 0: 21898 pixels (20.3%)
   Class 29: 20834 pixels (19.3%)
   Class 26: 12853 pixels (11.9%)
   Class 15: 6872 pixels (6.4%)
   Class 18: 6785 pixels (6.3%)
   ‚Üí Background: 20.3% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.2028
   ‚Üí Pixels where class 0 prob > 0.5: 21807 (20.2%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9992

üîç View 2: 2D predictions for 100632 MESH pixels (before aggregation):
   Class 28: 11623 pixels (11.6%)
   Class 31: 8921 pixels (8.9%)
   Class 16: 8358 pixels (8.3%)
   Class 32: 7614 pixels (7.6%)
   Class 9: 7511 pixels (7.5%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0001
   ‚Üí Pixels where class 0 prob > 0.5: 3 (0.0%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9996
DEBUG: Processed 11520000 total pixels, 1256334 valid pixels (10.9%)
DEBUG: Touched 103233.0 vertices out of 141802 (72.8%)
DEBUG: Vertices with zero probability sum: 38569 (27.2%)
DEBUG: Mean class 0 probability for touched vertices: 0.0918
\nDEBUG: Checking for views with high background predictions...
  Front: (see above for stats)
  Bottom: (see above for stats)
  Top: (see above for stats)
  Right: (see above for stats)
  Back: (see above for stats)
  Left: (see above for stats)
DEBUG: After normalization, P sums check: min=0.0000, max=1.0000
DEBUG: Predicted class distribution (before -1 shift):
  Class 0: 45045 vertices (31.8%)
  Class 29: 10143 vertices (7.2%)
  Class 28: 7207 vertices (5.1%)
  Class 12: 5740 vertices (4.0%)
  Class 9: 5453 vertices (3.8%)
  Class 30: 5308 vertices (3.7%)
  Class 23: 4952 vertices (3.5%)
  Class 25: 4854 vertices (3.4%)
  Class 16: 4309 vertices (3.0%)
  Class 8: 4226 vertices (3.0%)
DEBUG: Background predicted: 45045 (31.8%)
DEBUG: Foreground predicted: 96757 (68.2%)
Labels aggregated!
  ‚úì Aggregation complete
  ‚úì Prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-9/pred_7625119
  Loaded P matrix: (37, 141802), vertices: 141802
  Mesh: 141802 vertices, 283600 faces
  Step 1: Smoothing probabilities (20 iter, Œ±=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ‚úì Smoothing complete
  Step 2: MRF refinement (Œ≤=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ‚úì MRF refinement complete

  RESULTS:
  RAW:         median(top-10)=0.7868, mean(top-10)=0.7820, median(all)=0.6682, mean(all)=0.6140
  + SMOOTHING: median(top-10)=0.8853, mean(top-10)=0.8853, median(all)=0.8186, mean(all)=0.7405 [+0.0985]
  + MRF:       median(top-10)=0.8862, mean(top-10)=0.8855, median(all)=0.8189, mean(all)=0.7407 [+0.0008]
  TOTAL IMPROVEMENT (median top-10): +0.0994

================================================================================
Subject: OASIS-TRT-20-1
================================================================================
  Step 0: Generating predictions with NEW models...
  Using PyTorch3D GPU raycasting (matching training pipeline)...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 149052 vertices, 298100 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (34898 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (83452 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (78012 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (55866 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (36923 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (58059 valid pixels)
  [PyTorch3D] Raycasting complete!
  ‚úì Got 6 output maps, shape: (6, 800, 800, 3)
  Loading trained models...
Loading models...
  Loading Front: Front-epoch=499-validation_loss=0.03.ckpt
  Loading Bottom: Bottom-epoch=499-validation_loss=0.04.ckpt
  Loading Top: Top-epoch=499-validation_loss=0.05.ckpt
  Loading Right: Right-epoch=499-validation_loss=0.04.ckpt
  Loading Back: Back-epoch=499-validation_loss=0.03.ckpt
  Loading Left: Left-epoch=499-validation_loss=0.03.ckpt
Models loaded!
  Running U-Net predictions on 6 views...
Predicting labels...
Labels predicted!
  ‚úì Got predictions from 6 views
  Aggregating predictions to vertices...
Agregating predicted labels...

üîç View 0: 2D predictions for 34898 MESH pixels (before aggregation):
   Class 12: 9029 pixels (25.9%)
   Class 30: 8029 pixels (23.0%)
   Class 9: 5508 pixels (15.8%)
   Class 10: 2632 pixels (7.5%)
   Class 16: 1790 pixels (5.1%)
   ‚Üí Background: 1.2% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0121
   ‚Üí Pixels where class 0 prob > 0.5: 402 (1.2%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9978
   ‚Üí Weights for vertex 0: mean=0.3338, max=0.9978
   ‚Üí Weights for vertex 1: mean=0.3335, max=0.9926
   ‚Üí Weights for vertex 2: mean=0.3331, max=0.9955
   ‚Üí Weights sum to 1? 1.0004

üîç View 1: 2D predictions for 83452 MESH pixels (before aggregation):
   Class 29: 18487 pixels (22.2%)
   Class 0: 14684 pixels (17.6%)
   Class 26: 8492 pixels (10.2%)
   Class 15: 6838 pixels (8.2%)
   Class 18: 4839 pixels (5.8%)
   ‚Üí Background: 17.6% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.1707
   ‚Üí Pixels where class 0 prob > 0.5: 14522 (17.4%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=1.0010

üîç View 2: 2D predictions for 78012 MESH pixels (before aggregation):
   Class 28: 8806 pixels (11.3%)
   Class 16: 7208 pixels (9.2%)
   Class 32: 6099 pixels (7.8%)
   Class 10: 5992 pixels (7.7%)
   Class 25: 5672 pixels (7.3%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0001
   ‚Üí Pixels where class 0 prob > 0.5: 2 (0.0%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9987
DEBUG: Processed 11520000 total pixels, 1041630 valid pixels (9.0%)
DEBUG: Touched 109143.0 vertices out of 149052 (73.2%)
DEBUG: Vertices with zero probability sum: 39909 (26.8%)
DEBUG: Mean class 0 probability for touched vertices: 0.0814
\nDEBUG: Checking for views with high background predictions...
  Front: (see above for stats)
  Bottom: (see above for stats)
  Top: (see above for stats)
  Right: (see above for stats)
  Back: (see above for stats)
  Left: (see above for stats)
DEBUG: After normalization, P sums check: min=0.0000, max=1.0000
DEBUG: Predicted class distribution (before -1 shift):
  Class 0: 46208 vertices (31.0%)
  Class 29: 10591 vertices (7.1%)
  Class 28: 7598 vertices (5.1%)
  Class 30: 6966 vertices (4.7%)
  Class 12: 6209 vertices (4.2%)
  Class 25: 5758 vertices (3.9%)
  Class 10: 5383 vertices (3.6%)
  Class 9: 5037 vertices (3.4%)
  Class 16: 4516 vertices (3.0%)
  Class 23: 4425 vertices (3.0%)
DEBUG: Background predicted: 46208 (31.0%)
DEBUG: Foreground predicted: 102844 (69.0%)
Labels aggregated!
  ‚úì Aggregation complete
  ‚úì Prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-1/pred_7625119
  Loaded P matrix: (37, 149052), vertices: 149052
  Mesh: 149052 vertices, 298100 faces
  Step 1: Smoothing probabilities (20 iter, Œ±=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ‚úì Smoothing complete
  Step 2: MRF refinement (Œ≤=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
    MRF iteration 5/5...
  ‚úì MRF refinement complete

  RESULTS:
  RAW:         median(top-10)=0.8014, mean(top-10)=0.8018, median(all)=0.6880, mean(all)=0.6130
  + SMOOTHING: median(top-10)=0.8788, mean(top-10)=0.8857, median(all)=0.8270, mean(all)=0.7254 [+0.0774]
  + MRF:       median(top-10)=0.8790, mean(top-10)=0.8858, median(all)=0.8274, mean(all)=0.7257 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0776

================================================================================
Subject: OASIS-TRT-20-10
================================================================================
  Step 0: Generating predictions with NEW models...
  Using PyTorch3D GPU raycasting (matching training pipeline)...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 129540 vertices, 259076 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (39211 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (87219 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (80591 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (56268 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (41624 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (60533 valid pixels)
  [PyTorch3D] Raycasting complete!
  ‚úì Got 6 output maps, shape: (6, 800, 800, 3)
  Loading trained models...
Loading models...
  Loading Front: Front-epoch=499-validation_loss=0.03.ckpt
  Loading Bottom: Bottom-epoch=499-validation_loss=0.04.ckpt
  Loading Top: Top-epoch=499-validation_loss=0.05.ckpt
  Loading Right: Right-epoch=499-validation_loss=0.04.ckpt
  Loading Back: Back-epoch=499-validation_loss=0.03.ckpt
  Loading Left: Left-epoch=499-validation_loss=0.03.ckpt
Models loaded!
  Running U-Net predictions on 6 views...
Predicting labels...
Labels predicted!
  ‚úì Got predictions from 6 views
  Aggregating predictions to vertices...
Agregating predicted labels...

üîç View 0: 2D predictions for 39211 MESH pixels (before aggregation):
   Class 12: 11089 pixels (28.3%)
   Class 9: 6180 pixels (15.8%)
   Class 30: 5294 pixels (13.5%)
   Class 10: 3231 pixels (8.2%)
   Class 32: 2251 pixels (5.7%)
   ‚Üí Background: 0.1% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0028
   ‚Üí Pixels where class 0 prob > 0.5: 37 (0.1%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9963
   ‚Üí Weights for vertex 0: mean=0.3338, max=0.9941
   ‚Üí Weights for vertex 1: mean=0.3325, max=0.9963
   ‚Üí Weights for vertex 2: mean=0.3341, max=0.9901
   ‚Üí Weights sum to 1? 1.0004

üîç View 1: 2D predictions for 87219 MESH pixels (before aggregation):
   Class 29: 17463 pixels (20.0%)
   Class 0: 16485 pixels (18.9%)
   Class 26: 9641 pixels (11.1%)
   Class 14: 5828 pixels (6.7%)
   Class 18: 5498 pixels (6.3%)
   ‚Üí Background: 18.9% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.1850
   ‚Üí Pixels where class 0 prob > 0.5: 16358 (18.8%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9976

üîç View 2: 2D predictions for 80591 MESH pixels (before aggregation):
   Class 28: 7953 pixels (9.9%)
   Class 9: 7418 pixels (9.2%)
   Class 31: 6820 pixels (8.5%)
   Class 32: 6475 pixels (8.0%)
   Class 16: 6397 pixels (7.9%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0001
   ‚Üí Pixels where class 0 prob > 0.5: 1 (0.0%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9988
DEBUG: Processed 11520000 total pixels, 1096338 valid pixels (9.5%)
DEBUG: Touched 94975.0 vertices out of 129540 (73.3%)
DEBUG: Vertices with zero probability sum: 34565 (26.7%)
DEBUG: Mean class 0 probability for touched vertices: 0.0849
\nDEBUG: Checking for views with high background predictions...
  Front: (see above for stats)
  Bottom: (see above for stats)
  Top: (see above for stats)
  Right: (see above for stats)
  Back: (see above for stats)
  Left: (see above for stats)
DEBUG: After normalization, P sums check: min=0.0000, max=1.0000
DEBUG: Predicted class distribution (before -1 shift):
  Class 0: 40342 vertices (31.1%)
  Class 29: 9130 vertices (7.0%)
  Class 28: 6864 vertices (5.3%)
  Class 12: 6194 vertices (4.8%)
  Class 25: 4572 vertices (3.5%)
  Class 30: 4422 vertices (3.4%)
  Class 9: 4342 vertices (3.4%)
  Class 23: 4172 vertices (3.2%)
  Class 32: 4167 vertices (3.2%)
  Class 10: 3934 vertices (3.0%)
DEBUG: Background predicted: 40342 (31.1%)
DEBUG: Foreground predicted: 89198 (68.9%)
Labels aggregated!
  ‚úì Aggregation complete
  ‚úì Prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-10/pred_7625119
  Loaded P matrix: (37, 129540), vertices: 129540
  Mesh: 129540 vertices, 259076 faces
  Step 1: Smoothing probabilities (20 iter, Œ±=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ‚úì Smoothing complete
  Step 2: MRF refinement (Œ≤=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
    MRF iteration 5/5...
  ‚úì MRF refinement complete

  RESULTS:
  RAW:         median(top-10)=0.7764, mean(top-10)=0.8008, median(all)=0.6934, mean(all)=0.6172
  + SMOOTHING: median(top-10)=0.8784, mean(top-10)=0.8837, median(all)=0.8191, mean(all)=0.7306 [+0.1020]
  + MRF:       median(top-10)=0.8795, mean(top-10)=0.8843, median(all)=0.8199, mean(all)=0.7310 [+0.0012]
  TOTAL IMPROVEMENT (median top-10): +0.1032

================================================================================
Subject: OASIS-TRT-20-11
================================================================================
  Step 0: Generating predictions with NEW models...
  Using PyTorch3D GPU raycasting (matching training pipeline)...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 146531 vertices, 293058 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (41981 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (98450 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (90253 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (58376 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (42979 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (62441 valid pixels)
  [PyTorch3D] Raycasting complete!
  ‚úì Got 6 output maps, shape: (6, 800, 800, 3)
  Loading trained models...
Loading models...
  Loading Front: Front-epoch=499-validation_loss=0.03.ckpt
  Loading Bottom: Bottom-epoch=499-validation_loss=0.04.ckpt
  Loading Top: Top-epoch=499-validation_loss=0.05.ckpt
  Loading Right: Right-epoch=499-validation_loss=0.04.ckpt
  Loading Back: Back-epoch=499-validation_loss=0.03.ckpt
  Loading Left: Left-epoch=499-validation_loss=0.03.ckpt
Models loaded!
  Running U-Net predictions on 6 views...
Predicting labels...
Labels predicted!
  ‚úì Got predictions from 6 views
  Aggregating predictions to vertices...
Agregating predicted labels...

üîç View 0: 2D predictions for 41981 MESH pixels (before aggregation):
   Class 12: 13901 pixels (33.1%)
   Class 9: 8648 pixels (20.6%)
   Class 30: 7316 pixels (17.4%)
   Class 10: 2189 pixels (5.2%)
   Class 16: 1899 pixels (4.5%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0002
   ‚Üí Pixels where class 0 prob > 0.5: 1 (0.0%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9955
   ‚Üí Weights for vertex 0: mean=0.3352, max=0.9939
   ‚Üí Weights for vertex 1: mean=0.3321, max=0.9928
   ‚Üí Weights for vertex 2: mean=0.3330, max=0.9955
   ‚Üí Weights sum to 1? 1.0004

üîç View 1: 2D predictions for 98450 MESH pixels (before aggregation):
   Class 0: 20214 pixels (20.5%)
   Class 29: 17097 pixels (17.4%)
   Class 26: 10533 pixels (10.7%)
   Class 15: 6914 pixels (7.0%)
   Class 14: 6117 pixels (6.2%)
   ‚Üí Background: 20.5% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.2045
   ‚Üí Pixels where class 0 prob > 0.5: 20092 (20.4%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9974

üîç View 2: 2D predictions for 90253 MESH pixels (before aggregation):
   Class 31: 9351 pixels (10.4%)
   Class 28: 9238 pixels (10.2%)
   Class 9: 6911 pixels (7.7%)
   Class 16: 6670 pixels (7.4%)
   Class 12: 6580 pixels (7.3%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0000
   ‚Üí Pixels where class 0 prob > 0.5: 0 (0.0%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9998
DEBUG: Processed 11520000 total pixels, 1183440 valid pixels (10.3%)
DEBUG: Touched 103089.0 vertices out of 146531 (70.4%)
DEBUG: Vertices with zero probability sum: 43442 (29.6%)
DEBUG: Mean class 0 probability for touched vertices: 0.0735
\nDEBUG: Checking for views with high background predictions...
  Front: (see above for stats)
  Bottom: (see above for stats)
  Top: (see above for stats)
  Right: (see above for stats)
  Back: (see above for stats)
  Left: (see above for stats)
DEBUG: After normalization, P sums check: min=0.0000, max=1.0000
DEBUG: Predicted class distribution (before -1 shift):
  Class 0: 49527 vertices (33.8%)
  Class 29: 9961 vertices (6.8%)
  Class 28: 7596 vertices (5.2%)
  Class 12: 6768 vertices (4.6%)
  Class 30: 5425 vertices (3.7%)
  Class 9: 5235 vertices (3.6%)
  Class 25: 5197 vertices (3.5%)
  Class 31: 4259 vertices (2.9%)
  Class 23: 4215 vertices (2.9%)
  Class 26: 4010 vertices (2.7%)
DEBUG: Background predicted: 49527 (33.8%)
DEBUG: Foreground predicted: 97004 (66.2%)
Labels aggregated!
  ‚úì Aggregation complete
  ‚úì Prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-11/pred_7625119
  Loaded P matrix: (37, 146531), vertices: 146531
  Mesh: 146531 vertices, 293058 faces
  Step 1: Smoothing probabilities (20 iter, Œ±=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ‚úì Smoothing complete
  Step 2: MRF refinement (Œ≤=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ‚úì MRF refinement complete

  RESULTS:
  RAW:         median(top-10)=0.8029, mean(top-10)=0.8064, median(all)=0.6909, mean(all)=0.6144
  + SMOOTHING: median(top-10)=0.9045, mean(top-10)=0.8994, median(all)=0.8380, mean(all)=0.7449 [+0.1015]
  + MRF:       median(top-10)=0.9048, mean(top-10)=0.8995, median(all)=0.8383, mean(all)=0.7452 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.1018

================================================================================
Subject: OASIS-TRT-20-12
================================================================================
  Step 0: Generating predictions with NEW models...
  Using PyTorch3D GPU raycasting (matching training pipeline)...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 144559 vertices, 289114 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (36042 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (88037 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (82442 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (54615 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (37958 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (57015 valid pixels)
  [PyTorch3D] Raycasting complete!
  ‚úì Got 6 output maps, shape: (6, 800, 800, 3)
  Loading trained models...
Loading models...
  Loading Front: Front-epoch=499-validation_loss=0.03.ckpt
  Loading Bottom: Bottom-epoch=499-validation_loss=0.04.ckpt
  Loading Top: Top-epoch=499-validation_loss=0.05.ckpt
  Loading Right: Right-epoch=499-validation_loss=0.04.ckpt
  Loading Back: Back-epoch=499-validation_loss=0.03.ckpt
  Loading Left: Left-epoch=499-validation_loss=0.03.ckpt
Models loaded!
  Running U-Net predictions on 6 views...
Predicting labels...
Labels predicted!
  ‚úì Got predictions from 6 views
  Aggregating predictions to vertices...
Agregating predicted labels...

üîç View 0: 2D predictions for 36042 MESH pixels (before aggregation):
   Class 12: 10845 pixels (30.1%)
   Class 30: 4932 pixels (13.7%)
   Class 10: 3900 pixels (10.8%)
   Class 8: 2993 pixels (8.3%)
   Class 9: 2198 pixels (6.1%)
   ‚Üí Background: 4.1% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0414
   ‚Üí Pixels where class 0 prob > 0.5: 1462 (4.1%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9997
   ‚Üí Weights for vertex 0: mean=0.3338, max=0.9997
   ‚Üí Weights for vertex 1: mean=0.3317, max=0.9944
   ‚Üí Weights for vertex 2: mean=0.3349, max=0.9918
   ‚Üí Weights sum to 1? 1.0004

üîç View 1: 2D predictions for 88037 MESH pixels (before aggregation):
   Class 29: 16732 pixels (19.0%)
   Class 0: 16402 pixels (18.6%)
   Class 26: 9177 pixels (10.4%)
   Class 15: 7109 pixels (8.1%)
   Class 14: 5950 pixels (6.8%)
   ‚Üí Background: 18.6% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.1846
   ‚Üí Pixels where class 0 prob > 0.5: 16311 (18.5%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9985

üîç View 2: 2D predictions for 82442 MESH pixels (before aggregation):
   Class 28: 8654 pixels (10.5%)
   Class 10: 6575 pixels (8.0%)
   Class 23: 6294 pixels (7.6%)
   Class 32: 6274 pixels (7.6%)
   Class 16: 6240 pixels (7.6%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0001
   ‚Üí Pixels where class 0 prob > 0.5: 4 (0.0%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9987
DEBUG: Processed 11520000 total pixels, 1068327 valid pixels (9.3%)
DEBUG: Touched 103539.0 vertices out of 144559 (71.6%)
DEBUG: Vertices with zero probability sum: 41020 (28.4%)
DEBUG: Mean class 0 probability for touched vertices: 0.0828
\nDEBUG: Checking for views with high background predictions...
  Front: (see above for stats)
  Bottom: (see above for stats)
  Top: (see above for stats)
  Right: (see above for stats)
  Back: (see above for stats)
  Left: (see above for stats)
DEBUG: After normalization, P sums check: min=0.0000, max=1.0000
DEBUG: Predicted class distribution (before -1 shift):
  Class 0: 46741 vertices (32.3%)
  Class 29: 10622 vertices (7.3%)
  Class 28: 7729 vertices (5.3%)
  Class 12: 6242 vertices (4.3%)
  Class 30: 5919 vertices (4.1%)
  Class 25: 4836 vertices (3.3%)
  Class 23: 4747 vertices (3.3%)
  Class 10: 4610 vertices (3.2%)
  Class 32: 4609 vertices (3.2%)
  Class 8: 4277 vertices (3.0%)
DEBUG: Background predicted: 46741 (32.3%)
DEBUG: Foreground predicted: 97818 (67.7%)
Labels aggregated!
  ‚úì Aggregation complete
  ‚úì Prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-12/pred_7625119
  Loaded P matrix: (37, 144559), vertices: 144559
  Mesh: 144559 vertices, 289114 faces
  Step 1: Smoothing probabilities (20 iter, Œ±=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ‚úì Smoothing complete
  Step 2: MRF refinement (Œ≤=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ‚úì MRF refinement complete

  RESULTS:
  RAW:         median(top-10)=0.7654, mean(top-10)=0.7789, median(all)=0.6580, mean(all)=0.5973
  + SMOOTHING: median(top-10)=0.8589, mean(top-10)=0.8640, median(all)=0.8014, mean(all)=0.7249 [+0.0936]
  + MRF:       median(top-10)=0.8594, mean(top-10)=0.8642, median(all)=0.8015, mean(all)=0.7254 [+0.0004]
  TOTAL IMPROVEMENT (median top-10): +0.0940

================================================================================
Subject: OASIS-TRT-20-13
================================================================================
  Step 0: Generating predictions with NEW models...
  Using PyTorch3D GPU raycasting (matching training pipeline)...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 122339 vertices, 244674 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (45391 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (95734 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (89843 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (58036 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (42510 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (62395 valid pixels)
  [PyTorch3D] Raycasting complete!
  ‚úì Got 6 output maps, shape: (6, 800, 800, 3)
  Loading trained models...
Loading models...
  Loading Front: Front-epoch=499-validation_loss=0.03.ckpt
  Loading Bottom: Bottom-epoch=499-validation_loss=0.04.ckpt
  Loading Top: Top-epoch=499-validation_loss=0.05.ckpt
  Loading Right: Right-epoch=499-validation_loss=0.04.ckpt
  Loading Back: Back-epoch=499-validation_loss=0.03.ckpt
  Loading Left: Left-epoch=499-validation_loss=0.03.ckpt
Models loaded!
  Running U-Net predictions on 6 views...
Predicting labels...
Labels predicted!
  ‚úì Got predictions from 6 views
  Aggregating predictions to vertices...
Agregating predicted labels...

üîç View 0: 2D predictions for 45391 MESH pixels (before aggregation):
   Class 12: 10769 pixels (23.7%)
   Class 30: 9293 pixels (20.5%)
   Class 9: 7612 pixels (16.8%)
   Class 10: 4247 pixels (9.4%)
   Class 16: 2188 pixels (4.8%)
   ‚Üí Background: 0.3% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0036
   ‚Üí Pixels where class 0 prob > 0.5: 140 (0.3%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9985
   ‚Üí Weights for vertex 0: mean=0.3342, max=0.9985
   ‚Üí Weights for vertex 1: mean=0.3329, max=0.9977
   ‚Üí Weights for vertex 2: mean=0.3332, max=0.9967
   ‚Üí Weights sum to 1? 1.0003

üîç View 1: 2D predictions for 95734 MESH pixels (before aggregation):
   Class 0: 17675 pixels (18.5%)
   Class 29: 16408 pixels (17.1%)
   Class 26: 8632 pixels (9.0%)
   Class 15: 8032 pixels (8.4%)
   Class 18: 5675 pixels (5.9%)
   ‚Üí Background: 18.5% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.1826
   ‚Üí Pixels where class 0 prob > 0.5: 17559 (18.3%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9986

üîç View 2: 2D predictions for 89843 MESH pixels (before aggregation):
   Class 28: 11626 pixels (12.9%)
   Class 9: 7990 pixels (8.9%)
   Class 23: 6711 pixels (7.5%)
   Class 32: 6393 pixels (7.1%)
   Class 25: 6287 pixels (7.0%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0001
   ‚Üí Pixels where class 0 prob > 0.5: 5 (0.0%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9982
DEBUG: Processed 11520000 total pixels, 1181727 valid pixels (10.3%)
DEBUG: Touched 89756.0 vertices out of 122339 (73.4%)
DEBUG: Vertices with zero probability sum: 32583 (26.6%)
DEBUG: Mean class 0 probability for touched vertices: 0.1058
\nDEBUG: Checking for views with high background predictions...
  Front: (see above for stats)
  Bottom: (see above for stats)
  Top: (see above for stats)
  Right: (see above for stats)
  Back: (see above for stats)
  Left: (see above for stats)
DEBUG: After normalization, P sums check: min=0.0000, max=1.0000
DEBUG: Predicted class distribution (before -1 shift):
  Class 0: 38097 vertices (31.1%)
  Class 29: 8033 vertices (6.6%)
  Class 28: 6751 vertices (5.5%)
  Class 30: 5843 vertices (4.8%)
  Class 12: 4866 vertices (4.0%)
  Class 25: 4627 vertices (3.8%)
  Class 9: 4529 vertices (3.7%)
  Class 10: 4079 vertices (3.3%)
  Class 23: 3846 vertices (3.1%)
  Class 8: 3485 vertices (2.8%)
DEBUG: Background predicted: 38097 (31.1%)
DEBUG: Foreground predicted: 84242 (68.9%)
Labels aggregated!
  ‚úì Aggregation complete
  ‚úì Prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-13/pred_7625119
  Loaded P matrix: (37, 122339), vertices: 122339
  Mesh: 122339 vertices, 244674 faces
  Step 1: Smoothing probabilities (20 iter, Œ±=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ‚úì Smoothing complete
  Step 2: MRF refinement (Œ≤=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ‚úì MRF refinement complete

  RESULTS:
  RAW:         median(top-10)=0.8070, mean(top-10)=0.7980, median(all)=0.6799, mean(all)=0.6179
  + SMOOTHING: median(top-10)=0.8854, mean(top-10)=0.8920, median(all)=0.8043, mean(all)=0.7406 [+0.0784]
  + MRF:       median(top-10)=0.8855, mean(top-10)=0.8922, median(all)=0.8044, mean(all)=0.7407 [+0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0786

================================================================================
Subject: OASIS-TRT-20-14
================================================================================
  Step 0: Generating predictions with NEW models...
  Using PyTorch3D GPU raycasting (matching training pipeline)...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 128019 vertices, 256034 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (39254 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (90095 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (83820 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (57551 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (36944 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (59959 valid pixels)
  [PyTorch3D] Raycasting complete!
  ‚úì Got 6 output maps, shape: (6, 800, 800, 3)
  Loading trained models...
Loading models...
  Loading Front: Front-epoch=499-validation_loss=0.03.ckpt
  Loading Bottom: Bottom-epoch=499-validation_loss=0.04.ckpt
  Loading Top: Top-epoch=499-validation_loss=0.05.ckpt
  Loading Right: Right-epoch=499-validation_loss=0.04.ckpt
  Loading Back: Back-epoch=499-validation_loss=0.03.ckpt
  Loading Left: Left-epoch=499-validation_loss=0.03.ckpt
Models loaded!
  Running U-Net predictions on 6 views...
Predicting labels...
Labels predicted!
  ‚úì Got predictions from 6 views
  Aggregating predictions to vertices...
Agregating predicted labels...

üîç View 0: 2D predictions for 39254 MESH pixels (before aggregation):
   Class 12: 12091 pixels (30.8%)
   Class 30: 7510 pixels (19.1%)
   Class 9: 5971 pixels (15.2%)
   Class 10: 3513 pixels (8.9%)
   Class 8: 1895 pixels (4.8%)
   ‚Üí Background: 0.2% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0024
   ‚Üí Pixels where class 0 prob > 0.5: 66 (0.2%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9992
   ‚Üí Weights for vertex 0: mean=0.3342, max=0.9992
   ‚Üí Weights for vertex 1: mean=0.3353, max=0.9923
   ‚Üí Weights for vertex 2: mean=0.3308, max=0.9902
   ‚Üí Weights sum to 1? 1.0004

üîç View 1: 2D predictions for 90095 MESH pixels (before aggregation):
   Class 0: 18460 pixels (20.5%)
   Class 29: 15588 pixels (17.3%)
   Class 26: 9227 pixels (10.2%)
   Class 15: 7124 pixels (7.9%)
   Class 14: 5305 pixels (5.9%)
   ‚Üí Background: 20.5% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.2043
   ‚Üí Pixels where class 0 prob > 0.5: 18367 (20.4%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9963

üîç View 2: 2D predictions for 83820 MESH pixels (before aggregation):
   Class 28: 9417 pixels (11.2%)
   Class 31: 7570 pixels (9.0%)
   Class 9: 6537 pixels (7.8%)
   Class 25: 6398 pixels (7.6%)
   Class 32: 5796 pixels (6.9%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0001
   ‚Üí Pixels where class 0 prob > 0.5: 2 (0.0%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9992
DEBUG: Processed 11520000 total pixels, 1102869 valid pixels (9.6%)
DEBUG: Touched 96015.0 vertices out of 128019 (75.0%)
DEBUG: Vertices with zero probability sum: 32004 (25.0%)
DEBUG: Mean class 0 probability for touched vertices: 0.0965
\nDEBUG: Checking for views with high background predictions...
  Front: (see above for stats)
  Bottom: (see above for stats)
  Top: (see above for stats)
  Right: (see above for stats)
  Back: (see above for stats)
  Left: (see above for stats)
DEBUG: After normalization, P sums check: min=0.0000, max=1.0000
DEBUG: Predicted class distribution (before -1 shift):
  Class 0: 38234 vertices (29.9%)
  Class 29: 8824 vertices (6.9%)
  Class 28: 6732 vertices (5.3%)
  Class 12: 6022 vertices (4.7%)
  Class 30: 5937 vertices (4.6%)
  Class 25: 5014 vertices (3.9%)
  Class 9: 4908 vertices (3.8%)
  Class 10: 4465 vertices (3.5%)
  Class 23: 4012 vertices (3.1%)
  Class 14: 3548 vertices (2.8%)
DEBUG: Background predicted: 38234 (29.9%)
DEBUG: Foreground predicted: 89785 (70.1%)
Labels aggregated!
  ‚úì Aggregation complete
  ‚úì Prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-14/pred_7625119
  Loaded P matrix: (37, 128019), vertices: 128019
  Mesh: 128019 vertices, 256034 faces
  Step 1: Smoothing probabilities (20 iter, Œ±=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ‚úì Smoothing complete
  Step 2: MRF refinement (Œ≤=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ‚úì MRF refinement complete

  RESULTS:
  RAW:         median(top-10)=0.8106, mean(top-10)=0.8154, median(all)=0.6941, mean(all)=0.6405
  + SMOOTHING: median(top-10)=0.8814, mean(top-10)=0.8845, median(all)=0.8141, mean(all)=0.7414 [+0.0709]
  + MRF:       median(top-10)=0.8818, mean(top-10)=0.8851, median(all)=0.8150, mean(all)=0.7418 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0712

================================================================================
Subject: OASIS-TRT-20-15
================================================================================
  Step 0: Generating predictions with NEW models...
  Using PyTorch3D GPU raycasting (matching training pipeline)...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 121081 vertices, 242158 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (37244 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (84927 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (78839 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (49967 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (35868 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (53730 valid pixels)
  [PyTorch3D] Raycasting complete!
  ‚úì Got 6 output maps, shape: (6, 800, 800, 3)
  Loading trained models...
Loading models...
  Loading Front: Front-epoch=499-validation_loss=0.03.ckpt
  Loading Bottom: Bottom-epoch=499-validation_loss=0.04.ckpt
  Loading Top: Top-epoch=499-validation_loss=0.05.ckpt
  Loading Right: Right-epoch=499-validation_loss=0.04.ckpt
  Loading Back: Back-epoch=499-validation_loss=0.03.ckpt
  Loading Left: Left-epoch=499-validation_loss=0.03.ckpt
Models loaded!
  Running U-Net predictions on 6 views...
Predicting labels...
Labels predicted!
  ‚úì Got predictions from 6 views
  Aggregating predictions to vertices...
Agregating predicted labels...

üîç View 0: 2D predictions for 37244 MESH pixels (before aggregation):
   Class 12: 13577 pixels (36.5%)
   Class 30: 5440 pixels (14.6%)
   Class 9: 4274 pixels (11.5%)
   Class 10: 3441 pixels (9.2%)
   Class 8: 2170 pixels (5.8%)
   ‚Üí Background: 0.4% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0046
   ‚Üí Pixels where class 0 prob > 0.5: 132 (0.4%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=1.0000
   ‚Üí Weights for vertex 0: mean=0.3345, max=0.9916
   ‚Üí Weights for vertex 1: mean=0.3332, max=1.0000
   ‚Üí Weights for vertex 2: mean=0.3327, max=0.9926
   ‚Üí Weights sum to 1? 1.0004

üîç View 1: 2D predictions for 84927 MESH pixels (before aggregation):
   Class 0: 16387 pixels (19.3%)
   Class 29: 14175 pixels (16.7%)
   Class 26: 8983 pixels (10.6%)
   Class 14: 6637 pixels (7.8%)
   Class 15: 6250 pixels (7.4%)
   ‚Üí Background: 19.3% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.1908
   ‚Üí Pixels where class 0 prob > 0.5: 16317 (19.2%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9987

üîç View 2: 2D predictions for 78839 MESH pixels (before aggregation):
   Class 28: 8453 pixels (10.7%)
   Class 23: 6629 pixels (8.4%)
   Class 12: 6455 pixels (8.2%)
   Class 31: 6414 pixels (8.1%)
   Class 9: 6047 pixels (7.7%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0001
   ‚Üí Pixels where class 0 prob > 0.5: 1 (0.0%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9996
DEBUG: Processed 11520000 total pixels, 1021725 valid pixels (8.9%)
DEBUG: Touched 90120.0 vertices out of 121081 (74.4%)
DEBUG: Vertices with zero probability sum: 30961 (25.6%)
DEBUG: Mean class 0 probability for touched vertices: 0.0797
\nDEBUG: Checking for views with high background predictions...
  Front: (see above for stats)
  Bottom: (see above for stats)
  Top: (see above for stats)
  Right: (see above for stats)
  Back: (see above for stats)
  Left: (see above for stats)
DEBUG: After normalization, P sums check: min=0.0000, max=1.0000
DEBUG: Predicted class distribution (before -1 shift):
  Class 0: 35920 vertices (29.7%)
  Class 29: 8593 vertices (7.1%)
  Class 12: 6938 vertices (5.7%)
  Class 28: 6327 vertices (5.2%)
  Class 30: 4948 vertices (4.1%)
  Class 23: 4440 vertices (3.7%)
  Class 25: 4408 vertices (3.6%)
  Class 9: 3953 vertices (3.3%)
  Class 14: 3911 vertices (3.2%)
  Class 26: 3533 vertices (2.9%)
DEBUG: Background predicted: 35920 (29.7%)
DEBUG: Foreground predicted: 85161 (70.3%)
Labels aggregated!
  ‚úì Aggregation complete
  ‚úì Prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-15/pred_7625119
  Loaded P matrix: (37, 121081), vertices: 121081
  Mesh: 121081 vertices, 242158 faces
  Step 1: Smoothing probabilities (20 iter, Œ±=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ‚úì Smoothing complete
  Step 2: MRF refinement (Œ≤=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ‚úì MRF refinement complete

  RESULTS:
  RAW:         median(top-10)=0.7916, mean(top-10)=0.7987, median(all)=0.6956, mean(all)=0.6151
  + SMOOTHING: median(top-10)=0.8985, mean(top-10)=0.8900, median(all)=0.8076, mean(all)=0.7260 [+0.1070]
  + MRF:       median(top-10)=0.8980, mean(top-10)=0.8900, median(all)=0.8078, mean(all)=0.7258 [-0.0005]
  TOTAL IMPROVEMENT (median top-10): +0.1065

================================================================================
Subject: OASIS-TRT-20-16
================================================================================
  Step 0: Generating predictions with NEW models...
  Using PyTorch3D GPU raycasting (matching training pipeline)...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 137726 vertices, 275448 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (49473 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (114953 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (106146 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (70914 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (49269 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (70829 valid pixels)
  [PyTorch3D] Raycasting complete!
  ‚úì Got 6 output maps, shape: (6, 800, 800, 3)
  Loading trained models...
Loading models...
  Loading Front: Front-epoch=499-validation_loss=0.03.ckpt
  Loading Bottom: Bottom-epoch=499-validation_loss=0.04.ckpt
  Loading Top: Top-epoch=499-validation_loss=0.05.ckpt
  Loading Right: Right-epoch=499-validation_loss=0.04.ckpt
  Loading Back: Back-epoch=499-validation_loss=0.03.ckpt
  Loading Left: Left-epoch=499-validation_loss=0.03.ckpt
Models loaded!
  Running U-Net predictions on 6 views...
Predicting labels...
Labels predicted!
  ‚úì Got predictions from 6 views
  Aggregating predictions to vertices...
Agregating predicted labels...

üîç View 0: 2D predictions for 49473 MESH pixels (before aggregation):
   Class 30: 13602 pixels (27.5%)
   Class 12: 12907 pixels (26.1%)
   Class 9: 10211 pixels (20.6%)
   Class 32: 2868 pixels (5.8%)
   Class 23: 2127 pixels (4.3%)
   ‚Üí Background: 1.6% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0153
   ‚Üí Pixels where class 0 prob > 0.5: 781 (1.6%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9969
   ‚Üí Weights for vertex 0: mean=0.3339, max=0.9964
   ‚Üí Weights for vertex 1: mean=0.3338, max=0.9955
   ‚Üí Weights for vertex 2: mean=0.3326, max=0.9969
   ‚Üí Weights sum to 1? 1.0003

üîç View 1: 2D predictions for 114953 MESH pixels (before aggregation):
   Class 29: 25782 pixels (22.4%)
   Class 0: 20432 pixels (17.8%)
   Class 26: 14033 pixels (12.2%)
   Class 15: 9092 pixels (7.9%)
   Class 18: 6757 pixels (5.9%)
   ‚Üí Background: 17.8% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.1783
   ‚Üí Pixels where class 0 prob > 0.5: 20343 (17.7%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9980

üîç View 2: 2D predictions for 106146 MESH pixels (before aggregation):
   Class 9: 10777 pixels (10.2%)
   Class 31: 9109 pixels (8.6%)
   Class 12: 8695 pixels (8.2%)
   Class 25: 8218 pixels (7.7%)
   Class 28: 7838 pixels (7.4%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0001
   ‚Üí Pixels where class 0 prob > 0.5: 2 (0.0%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9985
DEBUG: Processed 11520000 total pixels, 1384752 valid pixels (12.0%)
DEBUG: Touched 100584.0 vertices out of 137726 (73.0%)
DEBUG: Vertices with zero probability sum: 37142 (27.0%)
DEBUG: Mean class 0 probability for touched vertices: 0.0947
\nDEBUG: Checking for views with high background predictions...
  Front: (see above for stats)
  Bottom: (see above for stats)
  Top: (see above for stats)
  Right: (see above for stats)
  Back: (see above for stats)
  Left: (see above for stats)
DEBUG: After normalization, P sums check: min=0.0000, max=1.0000
DEBUG: Predicted class distribution (before -1 shift):
  Class 0: 43372 vertices (31.5%)
  Class 29: 10492 vertices (7.6%)
  Class 12: 6501 vertices (4.7%)
  Class 30: 5933 vertices (4.3%)
  Class 28: 5930 vertices (4.3%)
  Class 9: 5839 vertices (4.2%)
  Class 25: 5337 vertices (3.9%)
  Class 8: 4243 vertices (3.1%)
  Class 26: 4160 vertices (3.0%)
  Class 23: 4117 vertices (3.0%)
DEBUG: Background predicted: 43372 (31.5%)
DEBUG: Foreground predicted: 94354 (68.5%)
Labels aggregated!
  ‚úì Aggregation complete
  ‚úì Prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-16/pred_7625119
  Loaded P matrix: (37, 137726), vertices: 137726
  Mesh: 137726 vertices, 275448 faces
  Step 1: Smoothing probabilities (20 iter, Œ±=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ‚úì Smoothing complete
  Step 2: MRF refinement (Œ≤=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ‚úì MRF refinement complete

  RESULTS:
  RAW:         median(top-10)=0.7823, mean(top-10)=0.7844, median(all)=0.6555, mean(all)=0.6086
  + SMOOTHING: median(top-10)=0.8624, mean(top-10)=0.8668, median(all)=0.7932, mean(all)=0.7162 [+0.0801]
  + MRF:       median(top-10)=0.8625, mean(top-10)=0.8669, median(all)=0.7933, mean(all)=0.7165 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0802

================================================================================
Subject: OASIS-TRT-20-17
================================================================================
  Step 0: Generating predictions with NEW models...
  Using PyTorch3D GPU raycasting (matching training pipeline)...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 148245 vertices, 296486 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (51715 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (115408 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (107645 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (68068 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (50659 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (70910 valid pixels)
  [PyTorch3D] Raycasting complete!
  ‚úì Got 6 output maps, shape: (6, 800, 800, 3)
  Loading trained models...
Loading models...
  Loading Front: Front-epoch=499-validation_loss=0.03.ckpt
  Loading Bottom: Bottom-epoch=499-validation_loss=0.04.ckpt
  Loading Top: Top-epoch=499-validation_loss=0.05.ckpt
  Loading Right: Right-epoch=499-validation_loss=0.04.ckpt
  Loading Back: Back-epoch=499-validation_loss=0.03.ckpt
  Loading Left: Left-epoch=499-validation_loss=0.03.ckpt
Models loaded!
  Running U-Net predictions on 6 views...
Predicting labels...
Labels predicted!
  ‚úì Got predictions from 6 views
  Aggregating predictions to vertices...
Agregating predicted labels...

üîç View 0: 2D predictions for 51715 MESH pixels (before aggregation):
   Class 30: 12879 pixels (24.9%)
   Class 12: 11444 pixels (22.1%)
   Class 9: 8211 pixels (15.9%)
   Class 23: 4146 pixels (8.0%)
   Class 26: 3213 pixels (6.2%)
   ‚Üí Background: 0.7% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0066
   ‚Üí Pixels where class 0 prob > 0.5: 304 (0.6%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9990
   ‚Üí Weights for vertex 0: mean=0.3349, max=0.9972
   ‚Üí Weights for vertex 1: mean=0.3327, max=0.9990
   ‚Üí Weights for vertex 2: mean=0.3327, max=0.9989
   ‚Üí Weights sum to 1? 1.0003

üîç View 1: 2D predictions for 115408 MESH pixels (before aggregation):
   Class 0: 23469 pixels (20.3%)
   Class 29: 22980 pixels (19.9%)
   Class 26: 10274 pixels (8.9%)
   Class 15: 9023 pixels (7.8%)
   Class 18: 6540 pixels (5.7%)
   ‚Üí Background: 20.3% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.2015
   ‚Üí Pixels where class 0 prob > 0.5: 23244 (20.1%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9985

üîç View 2: 2D predictions for 107645 MESH pixels (before aggregation):
   Class 28: 11680 pixels (10.9%)
   Class 32: 10673 pixels (9.9%)
   Class 9: 9562 pixels (8.9%)
   Class 31: 9047 pixels (8.4%)
   Class 16: 8498 pixels (7.9%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0001
   ‚Üí Pixels where class 0 prob > 0.5: 3 (0.0%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=1.0008
DEBUG: Processed 11520000 total pixels, 1393215 valid pixels (12.1%)
DEBUG: Touched 107816.0 vertices out of 148245 (72.7%)
DEBUG: Vertices with zero probability sum: 40429 (27.3%)
DEBUG: Mean class 0 probability for touched vertices: 0.1032
\nDEBUG: Checking for views with high background predictions...
  Front: (see above for stats)
  Bottom: (see above for stats)
  Top: (see above for stats)
  Right: (see above for stats)
  Back: (see above for stats)
  Left: (see above for stats)
DEBUG: After normalization, P sums check: min=0.0000, max=1.0000
DEBUG: Predicted class distribution (before -1 shift):
  Class 0: 48095 vertices (32.4%)
  Class 29: 10638 vertices (7.2%)
  Class 28: 6866 vertices (4.6%)
  Class 30: 6786 vertices (4.6%)
  Class 12: 6547 vertices (4.4%)
  Class 10: 5591 vertices (3.8%)
  Class 9: 4983 vertices (3.4%)
  Class 16: 4522 vertices (3.1%)
  Class 32: 4334 vertices (2.9%)
  Class 31: 4069 vertices (2.7%)
DEBUG: Background predicted: 48095 (32.4%)
DEBUG: Foreground predicted: 100150 (67.6%)
Labels aggregated!
  ‚úì Aggregation complete
  ‚úì Prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-17/pred_7625119
  Loaded P matrix: (37, 148245), vertices: 148245
  Mesh: 148245 vertices, 296486 faces
  Step 1: Smoothing probabilities (20 iter, Œ±=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ‚úì Smoothing complete
  Step 2: MRF refinement (Œ≤=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ‚úì MRF refinement complete

  RESULTS:
  RAW:         median(top-10)=0.7797, mean(top-10)=0.7713, median(all)=0.6394, mean(all)=0.5750
  + SMOOTHING: median(top-10)=0.8381, mean(top-10)=0.8536, median(all)=0.7629, mean(all)=0.6795 [+0.0584]
  + MRF:       median(top-10)=0.8383, mean(top-10)=0.8539, median(all)=0.7635, mean(all)=0.6798 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0586

================================================================================
Subject: OASIS-TRT-20-18
================================================================================
  Step 0: Generating predictions with NEW models...
  Using PyTorch3D GPU raycasting (matching training pipeline)...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 140676 vertices, 281348 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (40662 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (87949 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (81536 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (63250 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (38590 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (65363 valid pixels)
  [PyTorch3D] Raycasting complete!
  ‚úì Got 6 output maps, shape: (6, 800, 800, 3)
  Loading trained models...
Loading models...
  Loading Front: Front-epoch=499-validation_loss=0.03.ckpt
  Loading Bottom: Bottom-epoch=499-validation_loss=0.04.ckpt
  Loading Top: Top-epoch=499-validation_loss=0.05.ckpt
  Loading Right: Right-epoch=499-validation_loss=0.04.ckpt
  Loading Back: Back-epoch=499-validation_loss=0.03.ckpt
  Loading Left: Left-epoch=499-validation_loss=0.03.ckpt
Models loaded!
  Running U-Net predictions on 6 views...
Predicting labels...
Labels predicted!
  ‚úì Got predictions from 6 views
  Aggregating predictions to vertices...
Agregating predicted labels...

üîç View 0: 2D predictions for 40662 MESH pixels (before aggregation):
   Class 12: 9981 pixels (24.5%)
   Class 30: 8746 pixels (21.5%)
   Class 9: 7710 pixels (19.0%)
   Class 10: 3236 pixels (8.0%)
   Class 32: 2733 pixels (6.7%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0022
   ‚Üí Pixels where class 0 prob > 0.5: 8 (0.0%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9988
   ‚Üí Weights for vertex 0: mean=0.3356, max=0.9918
   ‚Üí Weights for vertex 1: mean=0.3313, max=0.9986
   ‚Üí Weights for vertex 2: mean=0.3334, max=0.9988
   ‚Üí Weights sum to 1? 1.0003

üîç View 1: 2D predictions for 87949 MESH pixels (before aggregation):
   Class 29: 19044 pixels (21.7%)
   Class 0: 14580 pixels (16.6%)
   Class 26: 11478 pixels (13.1%)
   Class 15: 7574 pixels (8.6%)
   Class 18: 4928 pixels (5.6%)
   ‚Üí Background: 16.6% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.1639
   ‚Üí Pixels where class 0 prob > 0.5: 14506 (16.5%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9990

üîç View 2: 2D predictions for 81536 MESH pixels (before aggregation):
   Class 28: 8634 pixels (10.6%)
   Class 16: 7270 pixels (8.9%)
   Class 32: 6785 pixels (8.3%)
   Class 31: 6590 pixels (8.1%)
   Class 9: 6331 pixels (7.8%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0001
   ‚Üí Pixels where class 0 prob > 0.5: 4 (0.0%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9979
DEBUG: Processed 11520000 total pixels, 1132050 valid pixels (9.8%)
DEBUG: Touched 102765.0 vertices out of 140676 (73.1%)
DEBUG: Vertices with zero probability sum: 37911 (26.9%)
DEBUG: Mean class 0 probability for touched vertices: 0.0803
\nDEBUG: Checking for views with high background predictions...
  Front: (see above for stats)
  Bottom: (see above for stats)
  Top: (see above for stats)
  Right: (see above for stats)
  Back: (see above for stats)
  Left: (see above for stats)
DEBUG: After normalization, P sums check: min=0.0000, max=1.0000
DEBUG: Predicted class distribution (before -1 shift):
  Class 0: 43638 vertices (31.0%)
  Class 29: 10385 vertices (7.4%)
  Class 28: 7187 vertices (5.1%)
  Class 30: 6055 vertices (4.3%)
  Class 25: 5415 vertices (3.8%)
  Class 9: 5408 vertices (3.8%)
  Class 12: 5349 vertices (3.8%)
  Class 10: 4586 vertices (3.3%)
  Class 32: 4530 vertices (3.2%)
  Class 26: 4427 vertices (3.1%)
DEBUG: Background predicted: 43638 (31.0%)
DEBUG: Foreground predicted: 97038 (69.0%)
Labels aggregated!
  ‚úì Aggregation complete
  ‚úì Prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-18/pred_7625119
  Loaded P matrix: (37, 140676), vertices: 140676
  Mesh: 140676 vertices, 281348 faces
  Step 1: Smoothing probabilities (20 iter, Œ±=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ‚úì Smoothing complete
  Step 2: MRF refinement (Œ≤=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ‚úì MRF refinement complete

  RESULTS:
  RAW:         median(top-10)=0.7736, mean(top-10)=0.7785, median(all)=0.6623, mean(all)=0.5952
  + SMOOTHING: median(top-10)=0.8724, mean(top-10)=0.8671, median(all)=0.7903, mean(all)=0.7156 [+0.0988]
  + MRF:       median(top-10)=0.8731, mean(top-10)=0.8678, median(all)=0.7906, mean(all)=0.7158 [+0.0007]
  TOTAL IMPROVEMENT (median top-10): +0.0995

================================================================================
Subject: OASIS-TRT-20-19
================================================================================
  Step 0: Generating predictions with NEW models...
  Using PyTorch3D GPU raycasting (matching training pipeline)...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 114731 vertices, 229458 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (49919 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (108156 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (99940 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (68793 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (45569 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (70695 valid pixels)
  [PyTorch3D] Raycasting complete!
  ‚úì Got 6 output maps, shape: (6, 800, 800, 3)
  Loading trained models...
Loading models...
  Loading Front: Front-epoch=499-validation_loss=0.03.ckpt
  Loading Bottom: Bottom-epoch=499-validation_loss=0.04.ckpt
  Loading Top: Top-epoch=499-validation_loss=0.05.ckpt
  Loading Right: Right-epoch=499-validation_loss=0.04.ckpt
  Loading Back: Back-epoch=499-validation_loss=0.03.ckpt
  Loading Left: Left-epoch=499-validation_loss=0.03.ckpt
Models loaded!
  Running U-Net predictions on 6 views...
Predicting labels...
Labels predicted!
  ‚úì Got predictions from 6 views
  Aggregating predictions to vertices...
Agregating predicted labels...

üîç View 0: 2D predictions for 49919 MESH pixels (before aggregation):
   Class 9: 12545 pixels (25.1%)
   Class 30: 12526 pixels (25.1%)
   Class 12: 10438 pixels (20.9%)
   Class 32: 3506 pixels (7.0%)
   Class 23: 2407 pixels (4.8%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0001
   ‚Üí Pixels where class 0 prob > 0.5: 0 (0.0%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9951
   ‚Üí Weights for vertex 0: mean=0.3352, max=0.9951
   ‚Üí Weights for vertex 1: mean=0.3322, max=0.9934
   ‚Üí Weights for vertex 2: mean=0.3329, max=0.9949
   ‚Üí Weights sum to 1? 1.0003

üîç View 1: 2D predictions for 108156 MESH pixels (before aggregation):
   Class 29: 20950 pixels (19.4%)
   Class 0: 20807 pixels (19.2%)
   Class 26: 11755 pixels (10.9%)
   Class 15: 7869 pixels (7.3%)
   Class 18: 6984 pixels (6.5%)
   ‚Üí Background: 19.2% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.1920
   ‚Üí Pixels where class 0 prob > 0.5: 20656 (19.1%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9993

üîç View 2: 2D predictions for 99940 MESH pixels (before aggregation):
   Class 16: 9760 pixels (9.8%)
   Class 28: 9110 pixels (9.1%)
   Class 31: 8920 pixels (8.9%)
   Class 32: 8037 pixels (8.0%)
   Class 9: 7780 pixels (7.8%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0003
   ‚Üí Pixels where class 0 prob > 0.5: 3 (0.0%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=1.0007
DEBUG: Processed 11520000 total pixels, 1329216 valid pixels (11.5%)
DEBUG: Touched 85514.0 vertices out of 114731 (74.5%)
DEBUG: Vertices with zero probability sum: 29217 (25.5%)
DEBUG: Mean class 0 probability for touched vertices: 0.1014
\nDEBUG: Checking for views with high background predictions...
  Front: (see above for stats)
  Bottom: (see above for stats)
  Top: (see above for stats)
  Right: (see above for stats)
  Back: (see above for stats)
  Left: (see above for stats)
DEBUG: After normalization, P sums check: min=0.0000, max=1.0000
DEBUG: Predicted class distribution (before -1 shift):
  Class 0: 34620 vertices (30.2%)
  Class 29: 8595 vertices (7.5%)
  Class 28: 5830 vertices (5.1%)
  Class 9: 5006 vertices (4.4%)
  Class 30: 4728 vertices (4.1%)
  Class 25: 4558 vertices (4.0%)
  Class 12: 4269 vertices (3.7%)
  Class 23: 3926 vertices (3.4%)
  Class 31: 3876 vertices (3.4%)
  Class 32: 3472 vertices (3.0%)
DEBUG: Background predicted: 34620 (30.2%)
DEBUG: Foreground predicted: 80111 (69.8%)
Labels aggregated!
  ‚úì Aggregation complete
  ‚úì Prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-19/pred_7625119
  Loaded P matrix: (37, 114731), vertices: 114731
  Mesh: 114731 vertices, 229458 faces
  Step 1: Smoothing probabilities (20 iter, Œ±=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ‚úì Smoothing complete
  Step 2: MRF refinement (Œ≤=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ‚úì MRF refinement complete

  RESULTS:
  RAW:         median(top-10)=0.7935, mean(top-10)=0.8012, median(all)=0.7079, mean(all)=0.6080
  + SMOOTHING: median(top-10)=0.8649, mean(top-10)=0.8764, median(all)=0.8006, mean(all)=0.7191 [+0.0714]
  + MRF:       median(top-10)=0.8652, mean(top-10)=0.8768, median(all)=0.8014, mean(all)=0.7192 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0717

================================================================================
Subject: OASIS-TRT-20-2
================================================================================
  Step 0: Generating predictions with NEW models...
  Using PyTorch3D GPU raycasting (matching training pipeline)...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 153483 vertices, 306962 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (39581 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (99182 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (92163 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (61992 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (39869 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (64109 valid pixels)
  [PyTorch3D] Raycasting complete!
  ‚úì Got 6 output maps, shape: (6, 800, 800, 3)
  Loading trained models...
Loading models...
  Loading Front: Front-epoch=499-validation_loss=0.03.ckpt
  Loading Bottom: Bottom-epoch=499-validation_loss=0.04.ckpt
  Loading Top: Top-epoch=499-validation_loss=0.05.ckpt
  Loading Right: Right-epoch=499-validation_loss=0.04.ckpt
  Loading Back: Back-epoch=499-validation_loss=0.03.ckpt
  Loading Left: Left-epoch=499-validation_loss=0.03.ckpt
Models loaded!
  Running U-Net predictions on 6 views...
Predicting labels...
Labels predicted!
  ‚úì Got predictions from 6 views
  Aggregating predictions to vertices...
Agregating predicted labels...

üîç View 0: 2D predictions for 39581 MESH pixels (before aggregation):
   Class 30: 11174 pixels (28.2%)
   Class 12: 10795 pixels (27.3%)
   Class 9: 7476 pixels (18.9%)
   Class 32: 2081 pixels (5.3%)
   Class 16: 1554 pixels (3.9%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0008
   ‚Üí Pixels where class 0 prob > 0.5: 9 (0.0%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9970
   ‚Üí Weights for vertex 0: mean=0.3339, max=0.9970
   ‚Üí Weights for vertex 1: mean=0.3331, max=0.9934
   ‚Üí Weights for vertex 2: mean=0.3333, max=0.9889
   ‚Üí Weights sum to 1? 1.0003

üîç View 1: 2D predictions for 99182 MESH pixels (before aggregation):
   Class 0: 18164 pixels (18.3%)
   Class 29: 17272 pixels (17.4%)
   Class 26: 11057 pixels (11.1%)
   Class 15: 7588 pixels (7.7%)
   Class 14: 6065 pixels (6.1%)
   ‚Üí Background: 18.3% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.1819
   ‚Üí Pixels where class 0 prob > 0.5: 18079 (18.2%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9983

üîç View 2: 2D predictions for 92163 MESH pixels (before aggregation):
   Class 28: 10160 pixels (11.0%)
   Class 9: 8425 pixels (9.1%)
   Class 31: 8244 pixels (8.9%)
   Class 16: 7614 pixels (8.3%)
   Class 32: 6919 pixels (7.5%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0001
   ‚Üí Pixels where class 0 prob > 0.5: 3 (0.0%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9980
DEBUG: Processed 11520000 total pixels, 1190688 valid pixels (10.3%)
DEBUG: Touched 109328.0 vertices out of 153483 (71.2%)
DEBUG: Vertices with zero probability sum: 44155 (28.8%)
DEBUG: Mean class 0 probability for touched vertices: 0.0802
\nDEBUG: Checking for views with high background predictions...
  Front: (see above for stats)
  Bottom: (see above for stats)
  Top: (see above for stats)
  Right: (see above for stats)
  Back: (see above for stats)
  Left: (see above for stats)
DEBUG: After normalization, P sums check: min=0.0000, max=1.0000
DEBUG: Predicted class distribution (before -1 shift):
  Class 0: 50329 vertices (32.8%)
  Class 29: 11150 vertices (7.3%)
  Class 28: 7883 vertices (5.1%)
  Class 30: 7643 vertices (5.0%)
  Class 12: 6347 vertices (4.1%)
  Class 9: 5446 vertices (3.5%)
  Class 10: 5022 vertices (3.3%)
  Class 25: 5014 vertices (3.3%)
  Class 26: 4499 vertices (2.9%)
  Class 23: 4375 vertices (2.9%)
DEBUG: Background predicted: 50329 (32.8%)
DEBUG: Foreground predicted: 103154 (67.2%)
Labels aggregated!
  ‚úì Aggregation complete
  ‚úì Prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-2/pred_7625119
  Loaded P matrix: (37, 153483), vertices: 153483
  Mesh: 153483 vertices, 306962 faces
  Step 1: Smoothing probabilities (20 iter, Œ±=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ‚úì Smoothing complete
  Step 2: MRF refinement (Œ≤=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ‚úì MRF refinement complete

  RESULTS:
  RAW:         median(top-10)=0.7996, mean(top-10)=0.8035, median(all)=0.7011, mean(all)=0.6196
  + SMOOTHING: median(top-10)=0.8908, mean(top-10)=0.8922, median(all)=0.8298, mean(all)=0.7463 [+0.0912]
  + MRF:       median(top-10)=0.8909, mean(top-10)=0.8925, median(all)=0.8296, mean(all)=0.7465 [+0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0913

================================================================================
Subject: OASIS-TRT-20-20
================================================================================
  Step 0: Generating predictions with NEW models...
  Using PyTorch3D GPU raycasting (matching training pipeline)...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 124947 vertices, 249890 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (46936 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (103220 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (96293 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (73038 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (49086 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (74947 valid pixels)
  [PyTorch3D] Raycasting complete!
  ‚úì Got 6 output maps, shape: (6, 800, 800, 3)
  Loading trained models...
Loading models...
  Loading Front: Front-epoch=499-validation_loss=0.03.ckpt
  Loading Bottom: Bottom-epoch=499-validation_loss=0.04.ckpt
  Loading Top: Top-epoch=499-validation_loss=0.05.ckpt
  Loading Right: Right-epoch=499-validation_loss=0.04.ckpt
  Loading Back: Back-epoch=499-validation_loss=0.03.ckpt
  Loading Left: Left-epoch=499-validation_loss=0.03.ckpt
Models loaded!
  Running U-Net predictions on 6 views...
Predicting labels...
Labels predicted!
  ‚úì Got predictions from 6 views
  Aggregating predictions to vertices...
Agregating predicted labels...

üîç View 0: 2D predictions for 46936 MESH pixels (before aggregation):
   Class 30: 12642 pixels (26.9%)
   Class 12: 9454 pixels (20.1%)
   Class 9: 8309 pixels (17.7%)
   Class 23: 2284 pixels (4.9%)
   Class 0: 2134 pixels (4.5%)
   ‚Üí Background: 4.5% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0451
   ‚Üí Pixels where class 0 prob > 0.5: 2100 (4.5%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9969
   ‚Üí Weights for vertex 0: mean=0.3347, max=0.9969
   ‚Üí Weights for vertex 1: mean=0.3334, max=0.9967
   ‚Üí Weights for vertex 2: mean=0.3323, max=0.9964
   ‚Üí Weights sum to 1? 1.0003

üîç View 1: 2D predictions for 103220 MESH pixels (before aggregation):
   Class 29: 22432 pixels (21.7%)
   Class 0: 18432 pixels (17.9%)
   Class 26: 10333 pixels (10.0%)
   Class 18: 7790 pixels (7.5%)
   Class 15: 7782 pixels (7.5%)
   ‚Üí Background: 17.9% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.1785
   ‚Üí Pixels where class 0 prob > 0.5: 18351 (17.8%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=1.0006

üîç View 2: 2D predictions for 96293 MESH pixels (before aggregation):
   Class 9: 9227 pixels (9.6%)
   Class 31: 8740 pixels (9.1%)
   Class 23: 8143 pixels (8.5%)
   Class 32: 7872 pixels (8.2%)
   Class 16: 7630 pixels (7.9%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0001
   ‚Üí Pixels where class 0 prob > 0.5: 1 (0.0%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9987
DEBUG: Processed 11520000 total pixels, 1330560 valid pixels (11.6%)
DEBUG: Touched 92038.0 vertices out of 124947 (73.7%)
DEBUG: Vertices with zero probability sum: 32909 (26.3%)
DEBUG: Mean class 0 probability for touched vertices: 0.1043
\nDEBUG: Checking for views with high background predictions...
  Front: (see above for stats)
  Bottom: (see above for stats)
  Top: (see above for stats)
  Right: (see above for stats)
  Back: (see above for stats)
  Left: (see above for stats)
DEBUG: After normalization, P sums check: min=0.0000, max=1.0000
DEBUG: Predicted class distribution (before -1 shift):
  Class 0: 38716 vertices (31.0%)
  Class 29: 9484 vertices (7.6%)
  Class 30: 5801 vertices (4.6%)
  Class 28: 5469 vertices (4.4%)
  Class 23: 4694 vertices (3.8%)
  Class 9: 4690 vertices (3.8%)
  Class 25: 4581 vertices (3.7%)
  Class 12: 4538 vertices (3.6%)
  Class 31: 4244 vertices (3.4%)
  Class 10: 3698 vertices (3.0%)
DEBUG: Background predicted: 38716 (31.0%)
DEBUG: Foreground predicted: 86231 (69.0%)
Labels aggregated!
  ‚úì Aggregation complete
  ‚úì Prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-20/pred_7625119
  Loaded P matrix: (37, 124947), vertices: 124947
  Mesh: 124947 vertices, 249890 faces
  Step 1: Smoothing probabilities (20 iter, Œ±=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ‚úì Smoothing complete
  Step 2: MRF refinement (Œ≤=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ‚úì MRF refinement complete

  RESULTS:
  RAW:         median(top-10)=0.7933, mean(top-10)=0.7993, median(all)=0.6726, mean(all)=0.5969
  + SMOOTHING: median(top-10)=0.8883, mean(top-10)=0.8805, median(all)=0.8041, mean(all)=0.7178 [+0.0951]
  + MRF:       median(top-10)=0.8879, mean(top-10)=0.8806, median(all)=0.8045, mean(all)=0.7178 [-0.0004]
  TOTAL IMPROVEMENT (median top-10): +0.0946

================================================================================
Subject: OASIS-TRT-20-3
================================================================================
  Step 0: Generating predictions with NEW models...
  Using PyTorch3D GPU raycasting (matching training pipeline)...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 134843 vertices, 269682 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (39504 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (90470 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (84416 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (56195 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (36289 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (59553 valid pixels)
  [PyTorch3D] Raycasting complete!
  ‚úì Got 6 output maps, shape: (6, 800, 800, 3)
  Loading trained models...
Loading models...
  Loading Front: Front-epoch=499-validation_loss=0.03.ckpt
  Loading Bottom: Bottom-epoch=499-validation_loss=0.04.ckpt
  Loading Top: Top-epoch=499-validation_loss=0.05.ckpt
  Loading Right: Right-epoch=499-validation_loss=0.04.ckpt
  Loading Back: Back-epoch=499-validation_loss=0.03.ckpt
  Loading Left: Left-epoch=499-validation_loss=0.03.ckpt
Models loaded!
  Running U-Net predictions on 6 views...
Predicting labels...
Labels predicted!
  ‚úì Got predictions from 6 views
  Aggregating predictions to vertices...
Agregating predicted labels...

üîç View 0: 2D predictions for 39504 MESH pixels (before aggregation):
   Class 12: 10152 pixels (25.7%)
   Class 30: 8575 pixels (21.7%)
   Class 9: 8251 pixels (20.9%)
   Class 10: 2402 pixels (6.1%)
   Class 16: 1921 pixels (4.9%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0002
   ‚Üí Pixels where class 0 prob > 0.5: 0 (0.0%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9989
   ‚Üí Weights for vertex 0: mean=0.3369, max=0.9981
   ‚Üí Weights for vertex 1: mean=0.3324, max=0.9989
   ‚Üí Weights for vertex 2: mean=0.3311, max=0.9910
   ‚Üí Weights sum to 1? 1.0003

üîç View 1: 2D predictions for 90470 MESH pixels (before aggregation):
   Class 29: 18179 pixels (20.1%)
   Class 0: 16511 pixels (18.3%)
   Class 26: 9712 pixels (10.7%)
   Class 15: 7405 pixels (8.2%)
   Class 18: 6413 pixels (7.1%)
   ‚Üí Background: 18.3% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.1834
   ‚Üí Pixels where class 0 prob > 0.5: 16403 (18.1%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9980

üîç View 2: 2D predictions for 84416 MESH pixels (before aggregation):
   Class 28: 9474 pixels (11.2%)
   Class 9: 6523 pixels (7.7%)
   Class 31: 6370 pixels (7.5%)
   Class 16: 6234 pixels (7.4%)
   Class 23: 6034 pixels (7.1%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0001
   ‚Üí Pixels where class 0 prob > 0.5: 4 (0.0%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9994
DEBUG: Processed 11520000 total pixels, 1099281 valid pixels (9.5%)
DEBUG: Touched 100508.0 vertices out of 134843 (74.5%)
DEBUG: Vertices with zero probability sum: 34335 (25.5%)
DEBUG: Mean class 0 probability for touched vertices: 0.0876
\nDEBUG: Checking for views with high background predictions...
  Front: (see above for stats)
  Bottom: (see above for stats)
  Top: (see above for stats)
  Right: (see above for stats)
  Back: (see above for stats)
  Left: (see above for stats)
DEBUG: After normalization, P sums check: min=0.0000, max=1.0000
DEBUG: Predicted class distribution (before -1 shift):
  Class 0: 40179 vertices (29.8%)
  Class 29: 10242 vertices (7.6%)
  Class 28: 6691 vertices (5.0%)
  Class 12: 5881 vertices (4.4%)
  Class 9: 5811 vertices (4.3%)
  Class 30: 5378 vertices (4.0%)
  Class 25: 5027 vertices (3.7%)
  Class 23: 4415 vertices (3.3%)
  Class 10: 3978 vertices (3.0%)
  Class 26: 3869 vertices (2.9%)
DEBUG: Background predicted: 40179 (29.8%)
DEBUG: Foreground predicted: 94664 (70.2%)
Labels aggregated!
  ‚úì Aggregation complete
  ‚úì Prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-3/pred_7625119
  Loaded P matrix: (37, 134843), vertices: 134843
  Mesh: 134843 vertices, 269682 faces
  Step 1: Smoothing probabilities (20 iter, Œ±=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ‚úì Smoothing complete
  Step 2: MRF refinement (Œ≤=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ‚úì MRF refinement complete

  RESULTS:
  RAW:         median(top-10)=0.8004, mean(top-10)=0.8013, median(all)=0.7203, mean(all)=0.6188
  + SMOOTHING: median(top-10)=0.8826, mean(top-10)=0.8858, median(all)=0.8233, mean(all)=0.7333 [+0.0822]
  + MRF:       median(top-10)=0.8828, mean(top-10)=0.8856, median(all)=0.8233, mean(all)=0.7334 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0824

================================================================================
Subject: OASIS-TRT-20-4
================================================================================
  Step 0: Generating predictions with NEW models...
  Using PyTorch3D GPU raycasting (matching training pipeline)...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 138101 vertices, 276198 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (44423 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (105060 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (96489 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (62926 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (42565 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (64568 valid pixels)
  [PyTorch3D] Raycasting complete!
  ‚úì Got 6 output maps, shape: (6, 800, 800, 3)
  Loading trained models...
Loading models...
  Loading Front: Front-epoch=499-validation_loss=0.03.ckpt
  Loading Bottom: Bottom-epoch=499-validation_loss=0.04.ckpt
  Loading Top: Top-epoch=499-validation_loss=0.05.ckpt
  Loading Right: Right-epoch=499-validation_loss=0.04.ckpt
  Loading Back: Back-epoch=499-validation_loss=0.03.ckpt
  Loading Left: Left-epoch=499-validation_loss=0.03.ckpt
Models loaded!
  Running U-Net predictions on 6 views...
Predicting labels...
Labels predicted!
  ‚úì Got predictions from 6 views
  Aggregating predictions to vertices...
Agregating predicted labels...

üîç View 0: 2D predictions for 44423 MESH pixels (before aggregation):
   Class 30: 12963 pixels (29.2%)
   Class 12: 9521 pixels (21.4%)
   Class 9: 8786 pixels (19.8%)
   Class 23: 2581 pixels (5.8%)
   Class 32: 1917 pixels (4.3%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0002
   ‚Üí Pixels where class 0 prob > 0.5: 1 (0.0%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9969
   ‚Üí Weights for vertex 0: mean=0.3361, max=0.9969
   ‚Üí Weights for vertex 1: mean=0.3326, max=0.9909
   ‚Üí Weights for vertex 2: mean=0.3316, max=0.9936
   ‚Üí Weights sum to 1? 1.0003

üîç View 1: 2D predictions for 105060 MESH pixels (before aggregation):
   Class 29: 23295 pixels (22.2%)
   Class 0: 18459 pixels (17.6%)
   Class 26: 11762 pixels (11.2%)
   Class 15: 7757 pixels (7.4%)
   Class 14: 7033 pixels (6.7%)
   ‚Üí Background: 17.6% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.1745
   ‚Üí Pixels where class 0 prob > 0.5: 18374 (17.5%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9990

üîç View 2: 2D predictions for 96489 MESH pixels (before aggregation):
   Class 31: 10296 pixels (10.7%)
   Class 28: 8495 pixels (8.8%)
   Class 9: 8304 pixels (8.6%)
   Class 23: 7223 pixels (7.5%)
   Class 25: 6998 pixels (7.3%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0001
   ‚Üí Pixels where class 0 prob > 0.5: 1 (0.0%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=1.0001
DEBUG: Processed 11520000 total pixels, 1248093 valid pixels (10.8%)
DEBUG: Touched 100044.0 vertices out of 138101 (72.4%)
DEBUG: Vertices with zero probability sum: 38057 (27.6%)
DEBUG: Mean class 0 probability for touched vertices: 0.0835
\nDEBUG: Checking for views with high background predictions...
  Front: (see above for stats)
  Bottom: (see above for stats)
  Top: (see above for stats)
  Right: (see above for stats)
  Back: (see above for stats)
  Left: (see above for stats)
DEBUG: After normalization, P sums check: min=0.0000, max=1.0000
DEBUG: Predicted class distribution (before -1 shift):
  Class 0: 44067 vertices (31.9%)
  Class 29: 10795 vertices (7.8%)
  Class 28: 6269 vertices (4.5%)
  Class 30: 6135 vertices (4.4%)
  Class 12: 5109 vertices (3.7%)
  Class 25: 5032 vertices (3.6%)
  Class 23: 5010 vertices (3.6%)
  Class 9: 4969 vertices (3.6%)
  Class 31: 4590 vertices (3.3%)
  Class 10: 4302 vertices (3.1%)
DEBUG: Background predicted: 44067 (31.9%)
DEBUG: Foreground predicted: 94034 (68.1%)
Labels aggregated!
  ‚úì Aggregation complete
  ‚úì Prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-4/pred_7625119
  Loaded P matrix: (37, 138101), vertices: 138101
  Mesh: 138101 vertices, 276198 faces
  Step 1: Smoothing probabilities (20 iter, Œ±=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ‚úì Smoothing complete
  Step 2: MRF refinement (Œ≤=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ‚úì MRF refinement complete

  RESULTS:
  RAW:         median(top-10)=0.7798, mean(top-10)=0.7911, median(all)=0.7003, mean(all)=0.6107
  + SMOOTHING: median(top-10)=0.8737, mean(top-10)=0.8813, median(all)=0.8275, mean(all)=0.7271 [+0.0939]
  + MRF:       median(top-10)=0.8734, mean(top-10)=0.8816, median(all)=0.8282, mean(all)=0.7272 [-0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0936

================================================================================
Subject: OASIS-TRT-20-5
================================================================================
  Step 0: Generating predictions with NEW models...
  Using PyTorch3D GPU raycasting (matching training pipeline)...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 151342 vertices, 302680 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (47526 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (107952 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (99043 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (66833 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (48800 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (69896 valid pixels)
  [PyTorch3D] Raycasting complete!
  ‚úì Got 6 output maps, shape: (6, 800, 800, 3)
  Loading trained models...
Loading models...
  Loading Front: Front-epoch=499-validation_loss=0.03.ckpt
  Loading Bottom: Bottom-epoch=499-validation_loss=0.04.ckpt
  Loading Top: Top-epoch=499-validation_loss=0.05.ckpt
  Loading Right: Right-epoch=499-validation_loss=0.04.ckpt
  Loading Back: Back-epoch=499-validation_loss=0.03.ckpt
  Loading Left: Left-epoch=499-validation_loss=0.03.ckpt
Models loaded!
  Running U-Net predictions on 6 views...
Predicting labels...
Labels predicted!
  ‚úì Got predictions from 6 views
  Aggregating predictions to vertices...
Agregating predicted labels...

üîç View 0: 2D predictions for 47526 MESH pixels (before aggregation):
   Class 30: 13222 pixels (27.8%)
   Class 12: 12665 pixels (26.6%)
   Class 9: 8713 pixels (18.3%)
   Class 32: 3136 pixels (6.6%)
   Class 23: 1990 pixels (4.2%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0009
   ‚Üí Pixels where class 0 prob > 0.5: 4 (0.0%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9989
   ‚Üí Weights for vertex 0: mean=0.3338, max=0.9959
   ‚Üí Weights for vertex 1: mean=0.3334, max=0.9978
   ‚Üí Weights for vertex 2: mean=0.3332, max=0.9989
   ‚Üí Weights sum to 1? 1.0003

üîç View 1: 2D predictions for 107952 MESH pixels (before aggregation):
   Class 29: 20153 pixels (18.7%)
   Class 0: 18882 pixels (17.5%)
   Class 26: 11385 pixels (10.5%)
   Class 15: 8286 pixels (7.7%)
   Class 14: 6783 pixels (6.3%)
   ‚Üí Background: 17.5% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.1744
   ‚Üí Pixels where class 0 prob > 0.5: 18748 (17.4%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9988

üîç View 2: 2D predictions for 99043 MESH pixels (before aggregation):
   Class 32: 9533 pixels (9.6%)
   Class 9: 9340 pixels (9.4%)
   Class 31: 9049 pixels (9.1%)
   Class 28: 8551 pixels (8.6%)
   Class 16: 8215 pixels (8.3%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0001
   ‚Üí Pixels where class 0 prob > 0.5: 1 (0.0%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=1.0003
DEBUG: Processed 11520000 total pixels, 1320150 valid pixels (11.5%)
DEBUG: Touched 109267.0 vertices out of 151342 (72.2%)
DEBUG: Vertices with zero probability sum: 42075 (27.8%)
DEBUG: Mean class 0 probability for touched vertices: 0.0827
\nDEBUG: Checking for views with high background predictions...
  Front: (see above for stats)
  Bottom: (see above for stats)
  Top: (see above for stats)
  Right: (see above for stats)
  Back: (see above for stats)
  Left: (see above for stats)
DEBUG: After normalization, P sums check: min=0.0000, max=1.0000
DEBUG: Predicted class distribution (before -1 shift):
  Class 0: 48080 vertices (31.8%)
  Class 29: 9988 vertices (6.6%)
  Class 30: 6785 vertices (4.5%)
  Class 12: 6485 vertices (4.3%)
  Class 28: 6413 vertices (4.2%)
  Class 25: 5796 vertices (3.8%)
  Class 9: 5428 vertices (3.6%)
  Class 32: 5042 vertices (3.3%)
  Class 10: 4907 vertices (3.2%)
  Class 23: 4866 vertices (3.2%)
DEBUG: Background predicted: 48080 (31.8%)
DEBUG: Foreground predicted: 103262 (68.2%)
Labels aggregated!
  ‚úì Aggregation complete
  ‚úì Prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-5/pred_7625119
  Loaded P matrix: (37, 151342), vertices: 151342
  Mesh: 151342 vertices, 302680 faces
  Step 1: Smoothing probabilities (20 iter, Œ±=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ‚úì Smoothing complete
  Step 2: MRF refinement (Œ≤=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
    MRF iteration 5/5...
  ‚úì MRF refinement complete

  RESULTS:
  RAW:         median(top-10)=0.7749, mean(top-10)=0.7857, median(all)=0.6951, mean(all)=0.6040
  + SMOOTHING: median(top-10)=0.8845, mean(top-10)=0.8806, median(all)=0.7865, mean(all)=0.7114 [+0.1096]
  + MRF:       median(top-10)=0.8849, mean(top-10)=0.8809, median(all)=0.7870, mean(all)=0.7118 [+0.0004]
  TOTAL IMPROVEMENT (median top-10): +0.1100

================================================================================
Subject: OASIS-TRT-20-6
================================================================================
  Step 0: Generating predictions with NEW models...
  Using PyTorch3D GPU raycasting (matching training pipeline)...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 152023 vertices, 304042 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (40314 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (94482 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (87724 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (60176 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (38682 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (64030 valid pixels)
  [PyTorch3D] Raycasting complete!
  ‚úì Got 6 output maps, shape: (6, 800, 800, 3)
  Loading trained models...
Loading models...
  Loading Front: Front-epoch=499-validation_loss=0.03.ckpt
  Loading Bottom: Bottom-epoch=499-validation_loss=0.04.ckpt
  Loading Top: Top-epoch=499-validation_loss=0.05.ckpt
  Loading Right: Right-epoch=499-validation_loss=0.04.ckpt
  Loading Back: Back-epoch=499-validation_loss=0.03.ckpt
  Loading Left: Left-epoch=499-validation_loss=0.03.ckpt
Models loaded!
  Running U-Net predictions on 6 views...
Predicting labels...
Labels predicted!
  ‚úì Got predictions from 6 views
  Aggregating predictions to vertices...
Agregating predicted labels...

üîç View 0: 2D predictions for 40314 MESH pixels (before aggregation):
   Class 12: 11753 pixels (29.2%)
   Class 30: 9647 pixels (23.9%)
   Class 9: 6877 pixels (17.1%)
   Class 32: 2133 pixels (5.3%)
   Class 10: 1932 pixels (4.8%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0007
   ‚Üí Pixels where class 0 prob > 0.5: 1 (0.0%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=1.0006
   ‚Üí Weights for vertex 0: mean=0.3349, max=1.0006
   ‚Üí Weights for vertex 1: mean=0.3334, max=0.9931
   ‚Üí Weights for vertex 2: mean=0.3320, max=0.9970
   ‚Üí Weights sum to 1? 1.0004

üîç View 1: 2D predictions for 94482 MESH pixels (before aggregation):
   Class 0: 20242 pixels (21.4%)
   Class 29: 15467 pixels (16.4%)
   Class 26: 9961 pixels (10.5%)
   Class 15: 7792 pixels (8.2%)
   Class 14: 6425 pixels (6.8%)
   ‚Üí Background: 21.4% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.2128
   ‚Üí Pixels where class 0 prob > 0.5: 20164 (21.3%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9995

üîç View 2: 2D predictions for 87724 MESH pixels (before aggregation):
   Class 28: 10051 pixels (11.5%)
   Class 32: 7665 pixels (8.7%)
   Class 16: 7587 pixels (8.6%)
   Class 12: 6776 pixels (7.7%)
   Class 31: 6678 pixels (7.6%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0001
   ‚Üí Pixels where class 0 prob > 0.5: 1 (0.0%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9998
DEBUG: Processed 11520000 total pixels, 1156224 valid pixels (10.0%)
DEBUG: Touched 108825.0 vertices out of 152023 (71.6%)
DEBUG: Vertices with zero probability sum: 43198 (28.4%)
DEBUG: Mean class 0 probability for touched vertices: 0.0961
\nDEBUG: Checking for views with high background predictions...
  Front: (see above for stats)
  Bottom: (see above for stats)
  Top: (see above for stats)
  Right: (see above for stats)
  Back: (see above for stats)
  Left: (see above for stats)
DEBUG: After normalization, P sums check: min=0.0000, max=1.0000
DEBUG: Predicted class distribution (before -1 shift):
  Class 0: 50244 vertices (33.1%)
  Class 29: 9514 vertices (6.3%)
  Class 28: 7716 vertices (5.1%)
  Class 12: 6963 vertices (4.6%)
  Class 30: 6872 vertices (4.5%)
  Class 25: 5778 vertices (3.8%)
  Class 10: 5376 vertices (3.5%)
  Class 23: 4589 vertices (3.0%)
  Class 32: 4253 vertices (2.8%)
  Class 16: 4250 vertices (2.8%)
DEBUG: Background predicted: 50244 (33.1%)
DEBUG: Foreground predicted: 101779 (66.9%)
Labels aggregated!
  ‚úì Aggregation complete
  ‚úì Prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-6/pred_7625119
  Loaded P matrix: (37, 152023), vertices: 152023
  Mesh: 152023 vertices, 304042 faces
  Step 1: Smoothing probabilities (20 iter, Œ±=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ‚úì Smoothing complete
  Step 2: MRF refinement (Œ≤=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ‚úì MRF refinement complete

  RESULTS:
  RAW:         median(top-10)=0.7732, mean(top-10)=0.7861, median(all)=0.6777, mean(all)=0.6089
  + SMOOTHING: median(top-10)=0.8827, mean(top-10)=0.8837, median(all)=0.8228, mean(all)=0.7434 [+0.1095]
  + MRF:       median(top-10)=0.8831, mean(top-10)=0.8842, median(all)=0.8235, mean(all)=0.7438 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.1099

================================================================================
Subject: OASIS-TRT-20-7
================================================================================
  Step 0: Generating predictions with NEW models...
  Using PyTorch3D GPU raycasting (matching training pipeline)...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 142612 vertices, 285220 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (49637 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (109534 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (101356 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (68179 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (44776 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (70082 valid pixels)
  [PyTorch3D] Raycasting complete!
  ‚úì Got 6 output maps, shape: (6, 800, 800, 3)
  Loading trained models...
Loading models...
  Loading Front: Front-epoch=499-validation_loss=0.03.ckpt
  Loading Bottom: Bottom-epoch=499-validation_loss=0.04.ckpt
  Loading Top: Top-epoch=499-validation_loss=0.05.ckpt
  Loading Right: Right-epoch=499-validation_loss=0.04.ckpt
  Loading Back: Back-epoch=499-validation_loss=0.03.ckpt
  Loading Left: Left-epoch=499-validation_loss=0.03.ckpt
Models loaded!
  Running U-Net predictions on 6 views...
Predicting labels...
Labels predicted!
  ‚úì Got predictions from 6 views
  Aggregating predictions to vertices...
Agregating predicted labels...

üîç View 0: 2D predictions for 49637 MESH pixels (before aggregation):
   Class 12: 14485 pixels (29.2%)
   Class 30: 12205 pixels (24.6%)
   Class 9: 9028 pixels (18.2%)
   Class 23: 2411 pixels (4.9%)
   Class 32: 2156 pixels (4.3%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0001
   ‚Üí Pixels where class 0 prob > 0.5: 0 (0.0%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9988
   ‚Üí Weights for vertex 0: mean=0.3347, max=0.9988
   ‚Üí Weights for vertex 1: mean=0.3323, max=0.9971
   ‚Üí Weights for vertex 2: mean=0.3333, max=0.9963
   ‚Üí Weights sum to 1? 1.0003

üîç View 1: 2D predictions for 109534 MESH pixels (before aggregation):
   Class 0: 22130 pixels (20.2%)
   Class 29: 21241 pixels (19.4%)
   Class 26: 11180 pixels (10.2%)
   Class 15: 8390 pixels (7.7%)
   Class 14: 7778 pixels (7.1%)
   ‚Üí Background: 20.2% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.2020
   ‚Üí Pixels where class 0 prob > 0.5: 22031 (20.1%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9992

üîç View 2: 2D predictions for 101356 MESH pixels (before aggregation):
   Class 28: 10658 pixels (10.5%)
   Class 16: 9107 pixels (9.0%)
   Class 31: 9067 pixels (8.9%)
   Class 9: 8615 pixels (8.5%)
   Class 12: 7295 pixels (7.2%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0000
   ‚Üí Pixels where class 0 prob > 0.5: 1 (0.0%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9997
DEBUG: Processed 11520000 total pixels, 1330692 valid pixels (11.6%)
DEBUG: Touched 106137.0 vertices out of 142612 (74.4%)
DEBUG: Vertices with zero probability sum: 36475 (25.6%)
DEBUG: Mean class 0 probability for touched vertices: 0.0962
\nDEBUG: Checking for views with high background predictions...
  Front: (see above for stats)
  Bottom: (see above for stats)
  Top: (see above for stats)
  Right: (see above for stats)
  Back: (see above for stats)
  Left: (see above for stats)
DEBUG: After normalization, P sums check: min=0.0000, max=1.0000
DEBUG: Predicted class distribution (before -1 shift):
  Class 0: 43466 vertices (30.5%)
  Class 29: 10660 vertices (7.5%)
  Class 12: 7266 vertices (5.1%)
  Class 28: 6883 vertices (4.8%)
  Class 30: 5914 vertices (4.1%)
  Class 9: 5415 vertices (3.8%)
  Class 25: 5254 vertices (3.7%)
  Class 14: 4478 vertices (3.1%)
  Class 31: 4344 vertices (3.0%)
  Class 16: 4122 vertices (2.9%)
DEBUG: Background predicted: 43466 (30.5%)
DEBUG: Foreground predicted: 99146 (69.5%)
Labels aggregated!
  ‚úì Aggregation complete
  ‚úì Prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-7/pred_7625119
  Loaded P matrix: (37, 142612), vertices: 142612
  Mesh: 142612 vertices, 285220 faces
  Step 1: Smoothing probabilities (20 iter, Œ±=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ‚úì Smoothing complete
  Step 2: MRF refinement (Œ≤=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ‚úì MRF refinement complete

  RESULTS:
  RAW:         median(top-10)=0.7882, mean(top-10)=0.7931, median(all)=0.6966, mean(all)=0.6273
  + SMOOTHING: median(top-10)=0.8700, mean(top-10)=0.8797, median(all)=0.8225, mean(all)=0.7311 [+0.0818]
  + MRF:       median(top-10)=0.8707, mean(top-10)=0.8799, median(all)=0.8226, mean(all)=0.7311 [+0.0007]
  TOTAL IMPROVEMENT (median top-10): +0.0825

================================================================================
Subject: OASIS-TRT-20-8
================================================================================
  Step 0: Generating predictions with NEW models...
  Using PyTorch3D GPU raycasting (matching training pipeline)...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 139571 vertices, 279138 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (53574 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (119555 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (109685 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (67837 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (53622 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (73282 valid pixels)
  [PyTorch3D] Raycasting complete!
  ‚úì Got 6 output maps, shape: (6, 800, 800, 3)
  Loading trained models...
Loading models...
  Loading Front: Front-epoch=499-validation_loss=0.03.ckpt
  Loading Bottom: Bottom-epoch=499-validation_loss=0.04.ckpt
  Loading Top: Top-epoch=499-validation_loss=0.05.ckpt
  Loading Right: Right-epoch=499-validation_loss=0.04.ckpt
  Loading Back: Back-epoch=499-validation_loss=0.03.ckpt
  Loading Left: Left-epoch=499-validation_loss=0.03.ckpt
Models loaded!
  Running U-Net predictions on 6 views...
Predicting labels...
Labels predicted!
  ‚úì Got predictions from 6 views
  Aggregating predictions to vertices...
Agregating predicted labels...

üîç View 0: 2D predictions for 53574 MESH pixels (before aggregation):
   Class 30: 14741 pixels (27.5%)
   Class 12: 12282 pixels (22.9%)
   Class 9: 9507 pixels (17.7%)
   Class 23: 3367 pixels (6.3%)
   Class 32: 2620 pixels (4.9%)
   ‚Üí Background: 3.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0283
   ‚Üí Pixels where class 0 prob > 0.5: 1545 (2.9%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9995
   ‚Üí Weights for vertex 0: mean=0.3357, max=0.9975
   ‚Üí Weights for vertex 1: mean=0.3321, max=0.9995
   ‚Üí Weights for vertex 2: mean=0.3325, max=0.9961
   ‚Üí Weights sum to 1? 1.0003

üîç View 1: 2D predictions for 119555 MESH pixels (before aggregation):
   Class 29: 26177 pixels (21.9%)
   Class 0: 23650 pixels (19.8%)
   Class 15: 10297 pixels (8.6%)
   Class 26: 9009 pixels (7.5%)
   Class 18: 6931 pixels (5.8%)
   ‚Üí Background: 19.8% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.1961
   ‚Üí Pixels where class 0 prob > 0.5: 23529 (19.7%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9996

üîç View 2: 2D predictions for 109685 MESH pixels (before aggregation):
   Class 28: 12073 pixels (11.0%)
   Class 31: 8919 pixels (8.1%)
   Class 32: 8773 pixels (8.0%)
   Class 16: 7845 pixels (7.2%)
   Class 23: 7808 pixels (7.1%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0001
   ‚Üí Pixels where class 0 prob > 0.5: 1 (0.0%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9988
DEBUG: Processed 11520000 total pixels, 1432665 valid pixels (12.4%)
DEBUG: Touched 100910.0 vertices out of 139571 (72.3%)
DEBUG: Vertices with zero probability sum: 38661 (27.7%)
DEBUG: Mean class 0 probability for touched vertices: 0.1021
\nDEBUG: Checking for views with high background predictions...
  Front: (see above for stats)
  Bottom: (see above for stats)
  Top: (see above for stats)
  Right: (see above for stats)
  Back: (see above for stats)
  Left: (see above for stats)
DEBUG: After normalization, P sums check: min=0.0000, max=1.0000
DEBUG: Predicted class distribution (before -1 shift):
  Class 0: 45031 vertices (32.3%)
  Class 29: 10585 vertices (7.6%)
  Class 28: 6683 vertices (4.8%)
  Class 30: 6013 vertices (4.3%)
  Class 12: 5737 vertices (4.1%)
  Class 25: 4817 vertices (3.5%)
  Class 23: 4620 vertices (3.3%)
  Class 9: 4518 vertices (3.2%)
  Class 8: 4387 vertices (3.1%)
  Class 32: 4184 vertices (3.0%)
DEBUG: Background predicted: 45031 (32.3%)
DEBUG: Foreground predicted: 94540 (67.7%)
Labels aggregated!
  ‚úì Aggregation complete
  ‚úì Prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-8/pred_7625119
  Loaded P matrix: (37, 139571), vertices: 139571
  Mesh: 139571 vertices, 279138 faces
  Step 1: Smoothing probabilities (20 iter, Œ±=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ‚úì Smoothing complete
  Step 2: MRF refinement (Œ≤=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ‚úì MRF refinement complete

  RESULTS:
  RAW:         median(top-10)=0.7771, mean(top-10)=0.7878, median(all)=0.6597, mean(all)=0.6028
  + SMOOTHING: median(top-10)=0.8761, mean(top-10)=0.8802, median(all)=0.8064, mean(all)=0.7217 [+0.0990]
  + MRF:       median(top-10)=0.8769, mean(top-10)=0.8808, median(all)=0.8070, mean(all)=0.7219 [+0.0008]
  TOTAL IMPROVEMENT (median top-10): +0.0998

================================================================================
Subject: OASIS-TRT-20-9
================================================================================
  Step 0: Generating predictions with NEW models...
  Using PyTorch3D GPU raycasting (matching training pipeline)...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 134960 vertices, 269916 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (39896 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (92848 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (86201 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (60492 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (41512 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (63225 valid pixels)
  [PyTorch3D] Raycasting complete!
  ‚úì Got 6 output maps, shape: (6, 800, 800, 3)
  Loading trained models...
Loading models...
  Loading Front: Front-epoch=499-validation_loss=0.03.ckpt
  Loading Bottom: Bottom-epoch=499-validation_loss=0.04.ckpt
  Loading Top: Top-epoch=499-validation_loss=0.05.ckpt
  Loading Right: Right-epoch=499-validation_loss=0.04.ckpt
  Loading Back: Back-epoch=499-validation_loss=0.03.ckpt
  Loading Left: Left-epoch=499-validation_loss=0.03.ckpt
Models loaded!
  Running U-Net predictions on 6 views...
Predicting labels...
Labels predicted!
  ‚úì Got predictions from 6 views
  Aggregating predictions to vertices...
Agregating predicted labels...

üîç View 0: 2D predictions for 39896 MESH pixels (before aggregation):
   Class 12: 10346 pixels (25.9%)
   Class 30: 9299 pixels (23.3%)
   Class 9: 6092 pixels (15.3%)
   Class 10: 2586 pixels (6.5%)
   Class 32: 2000 pixels (5.0%)
   ‚Üí Background: 1.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0101
   ‚Üí Pixels where class 0 prob > 0.5: 387 (1.0%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9975
   ‚Üí Weights for vertex 0: mean=0.3339, max=0.9969
   ‚Üí Weights for vertex 1: mean=0.3327, max=0.9975
   ‚Üí Weights for vertex 2: mean=0.3337, max=0.9941
   ‚Üí Weights sum to 1? 1.0003

üîç View 1: 2D predictions for 92848 MESH pixels (before aggregation):
   Class 29: 18447 pixels (19.9%)
   Class 0: 17737 pixels (19.1%)
   Class 26: 8544 pixels (9.2%)
   Class 15: 8007 pixels (8.6%)
   Class 18: 7058 pixels (7.6%)
   ‚Üí Background: 19.1% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.1897
   ‚Üí Pixels where class 0 prob > 0.5: 17652 (19.0%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9987

üîç View 2: 2D predictions for 86201 MESH pixels (before aggregation):
   Class 28: 8401 pixels (9.7%)
   Class 32: 6897 pixels (8.0%)
   Class 9: 6613 pixels (7.7%)
   Class 31: 6573 pixels (7.6%)
   Class 25: 6434 pixels (7.5%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0001
   ‚Üí Pixels where class 0 prob > 0.5: 2 (0.0%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9988
DEBUG: Processed 11520000 total pixels, 1152522 valid pixels (10.0%)
DEBUG: Touched 98173.0 vertices out of 134960 (72.7%)
DEBUG: Vertices with zero probability sum: 36787 (27.3%)
DEBUG: Mean class 0 probability for touched vertices: 0.0870
\nDEBUG: Checking for views with high background predictions...
  Front: (see above for stats)
  Bottom: (see above for stats)
  Top: (see above for stats)
  Right: (see above for stats)
  Back: (see above for stats)
  Left: (see above for stats)
DEBUG: After normalization, P sums check: min=0.0000, max=1.0000
DEBUG: Predicted class distribution (before -1 shift):
  Class 0: 42765 vertices (31.7%)
  Class 29: 9505 vertices (7.0%)
  Class 28: 6908 vertices (5.1%)
  Class 30: 5809 vertices (4.3%)
  Class 25: 5677 vertices (4.2%)
  Class 12: 5087 vertices (3.8%)
  Class 23: 4593 vertices (3.4%)
  Class 9: 4341 vertices (3.2%)
  Class 10: 4302 vertices (3.2%)
  Class 8: 3902 vertices (2.9%)
DEBUG: Background predicted: 42765 (31.7%)
DEBUG: Foreground predicted: 92195 (68.3%)
Labels aggregated!
  ‚úì Aggregation complete
  ‚úì Prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-9/pred_7625119
  Loaded P matrix: (37, 134960), vertices: 134960
  Mesh: 134960 vertices, 269916 faces
  Step 1: Smoothing probabilities (20 iter, Œ±=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ‚úì Smoothing complete
  Step 2: MRF refinement (Œ≤=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ‚úì MRF refinement complete

  RESULTS:
  RAW:         median(top-10)=0.7720, mean(top-10)=0.7968, median(all)=0.7004, mean(all)=0.6198
  + SMOOTHING: median(top-10)=0.8927, mean(top-10)=0.8926, median(all)=0.8244, mean(all)=0.7457 [+0.1207]
  + MRF:       median(top-10)=0.8927, mean(top-10)=0.8929, median(all)=0.8250, mean(all)=0.7460 [-0.0000]
  TOTAL IMPROVEMENT (median top-10): +0.1207

================================================================================
Subject: Twins-2-1
================================================================================
  Step 0: Generating predictions with NEW models...
  Using PyTorch3D GPU raycasting (matching training pipeline)...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 145069 vertices, 290134 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (58252 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (123953 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (113508 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (71956 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (55547 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (75840 valid pixels)
  [PyTorch3D] Raycasting complete!
  ‚úì Got 6 output maps, shape: (6, 800, 800, 3)
  Loading trained models...
Loading models...
  Loading Front: Front-epoch=499-validation_loss=0.03.ckpt
  Loading Bottom: Bottom-epoch=499-validation_loss=0.04.ckpt
  Loading Top: Top-epoch=499-validation_loss=0.05.ckpt
  Loading Right: Right-epoch=499-validation_loss=0.04.ckpt
  Loading Back: Back-epoch=499-validation_loss=0.03.ckpt
  Loading Left: Left-epoch=499-validation_loss=0.03.ckpt
Models loaded!
  Running U-Net predictions on 6 views...
Predicting labels...
Labels predicted!
  ‚úì Got predictions from 6 views
  Aggregating predictions to vertices...
Agregating predicted labels...

üîç View 0: 2D predictions for 58252 MESH pixels (before aggregation):
   Class 30: 17625 pixels (30.3%)
   Class 12: 12187 pixels (20.9%)
   Class 9: 8182 pixels (14.0%)
   Class 23: 4704 pixels (8.1%)
   Class 32: 3459 pixels (5.9%)
   ‚Üí Background: 2.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0190
   ‚Üí Pixels where class 0 prob > 0.5: 1060 (1.8%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9975
   ‚Üí Weights for vertex 0: mean=0.3341, max=0.9945
   ‚Üí Weights for vertex 1: mean=0.3331, max=0.9968
   ‚Üí Weights for vertex 2: mean=0.3332, max=0.9975
   ‚Üí Weights sum to 1? 1.0003

üîç View 1: 2D predictions for 123953 MESH pixels (before aggregation):
   Class 0: 26144 pixels (21.1%)
   Class 29: 22105 pixels (17.8%)
   Class 26: 12443 pixels (10.0%)
   Class 18: 9488 pixels (7.7%)
   Class 15: 9063 pixels (7.3%)
   ‚Üí Background: 21.1% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.2088
   ‚Üí Pixels where class 0 prob > 0.5: 25917 (20.9%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=1.0003

üîç View 2: 2D predictions for 113508 MESH pixels (before aggregation):
   Class 28: 10358 pixels (9.1%)
   Class 31: 9740 pixels (8.6%)
   Class 32: 9555 pixels (8.4%)
   Class 23: 9390 pixels (8.3%)
   Class 25: 9077 pixels (8.0%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0000
   ‚Üí Pixels where class 0 prob > 0.5: 2 (0.0%)
   ‚Üí Barycentric weights: mean=0.3335, min=0.0000, max=0.9977
DEBUG: Processed 11520000 total pixels, 1497168 valid pixels (13.0%)
DEBUG: Touched 106760.0 vertices out of 145069 (73.6%)
DEBUG: Vertices with zero probability sum: 38309 (26.4%)
DEBUG: Mean class 0 probability for touched vertices: 0.0965
\nDEBUG: Checking for views with high background predictions...
  Front: (see above for stats)
  Bottom: (see above for stats)
  Top: (see above for stats)
  Right: (see above for stats)
  Back: (see above for stats)
  Left: (see above for stats)
DEBUG: After normalization, P sums check: min=0.0000, max=1.0000
DEBUG: Predicted class distribution (before -1 shift):
  Class 0: 45062 vertices (31.1%)
  Class 29: 9062 vertices (6.2%)
  Class 30: 6804 vertices (4.7%)
  Class 25: 6502 vertices (4.5%)
  Class 28: 6444 vertices (4.4%)
  Class 12: 6247 vertices (4.3%)
  Class 23: 5341 vertices (3.7%)
  Class 9: 4484 vertices (3.1%)
  Class 10: 4476 vertices (3.1%)
  Class 32: 4303 vertices (3.0%)
DEBUG: Background predicted: 45062 (31.1%)
DEBUG: Foreground predicted: 100007 (68.9%)
Labels aggregated!
  ‚úì Aggregation complete
  ‚úì Prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/Twins-2-1/pred_7625119
  Loaded P matrix: (37, 145069), vertices: 145069
  Mesh: 145069 vertices, 290134 faces
  Step 1: Smoothing probabilities (20 iter, Œ±=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ‚úì Smoothing complete
  Step 2: MRF refinement (Œ≤=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ‚úì MRF refinement complete

  RESULTS:
  RAW:         median(top-10)=0.7815, mean(top-10)=0.7920, median(all)=0.6664, mean(all)=0.5972
  + SMOOTHING: median(top-10)=0.8667, mean(top-10)=0.8661, median(all)=0.8061, mean(all)=0.7143 [+0.0852]
  + MRF:       median(top-10)=0.8673, mean(top-10)=0.8667, median(all)=0.8068, mean(all)=0.7148 [+0.0005]
  TOTAL IMPROVEMENT (median top-10): +0.0858

================================================================================
Subject: Twins-2-2
================================================================================
  Step 0: Generating predictions with NEW models...
  Using PyTorch3D GPU raycasting (matching training pipeline)...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 149751 vertices, 299498 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (72774 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (140891 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (128357 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (80531 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (66855 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (82607 valid pixels)
  [PyTorch3D] Raycasting complete!
  ‚úì Got 6 output maps, shape: (6, 800, 800, 3)
  Loading trained models...
Loading models...
  Loading Front: Front-epoch=499-validation_loss=0.03.ckpt
  Loading Bottom: Bottom-epoch=499-validation_loss=0.04.ckpt
  Loading Top: Top-epoch=499-validation_loss=0.05.ckpt
  Loading Right: Right-epoch=499-validation_loss=0.04.ckpt
  Loading Back: Back-epoch=499-validation_loss=0.03.ckpt
  Loading Left: Left-epoch=499-validation_loss=0.03.ckpt
Models loaded!
  Running U-Net predictions on 6 views...
Predicting labels...
Labels predicted!
  ‚úì Got predictions from 6 views
  Aggregating predictions to vertices...
Agregating predicted labels...

üîç View 0: 2D predictions for 72774 MESH pixels (before aggregation):
   Class 30: 22044 pixels (30.3%)
   Class 12: 12849 pixels (17.7%)
   Class 9: 12770 pixels (17.5%)
   Class 23: 5603 pixels (7.7%)
   Class 32: 3875 pixels (5.3%)
   ‚Üí Background: 0.1% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0015
   ‚Üí Pixels where class 0 prob > 0.5: 26 (0.0%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9978
   ‚Üí Weights for vertex 0: mean=0.3339, max=0.9978
   ‚Üí Weights for vertex 1: mean=0.3335, max=0.9976
   ‚Üí Weights for vertex 2: mean=0.3329, max=0.9949
   ‚Üí Weights sum to 1? 1.0003

üîç View 1: 2D predictions for 140891 MESH pixels (before aggregation):
   Class 0: 30385 pixels (21.6%)
   Class 29: 23714 pixels (16.8%)
   Class 26: 14588 pixels (10.4%)
   Class 15: 9760 pixels (6.9%)
   Class 18: 9145 pixels (6.5%)
   ‚Üí Background: 21.6% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.2174
   ‚Üí Pixels where class 0 prob > 0.5: 30086 (21.4%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9997

üîç View 2: 2D predictions for 128357 MESH pixels (before aggregation):
   Class 23: 11430 pixels (8.9%)
   Class 28: 11247 pixels (8.8%)
   Class 32: 10816 pixels (8.4%)
   Class 31: 10725 pixels (8.4%)
   Class 9: 10007 pixels (7.8%)
   ‚Üí Background: 0.0% of mesh pixels
   ‚Üí Mean class 0 prob for mesh pixels: 0.0001
   ‚Üí Pixels where class 0 prob > 0.5: 0 (0.0%)
   ‚Üí Barycentric weights: mean=0.3334, min=0.0000, max=0.9980
DEBUG: Processed 11520000 total pixels, 1716045 valid pixels (14.9%)
DEBUG: Touched 109275.0 vertices out of 149751 (73.0%)
DEBUG: Vertices with zero probability sum: 40476 (27.0%)
DEBUG: Mean class 0 probability for touched vertices: 0.0946
\nDEBUG: Checking for views with high background predictions...
  Front: (see above for stats)
  Bottom: (see above for stats)
  Top: (see above for stats)
  Right: (see above for stats)
  Back: (see above for stats)
  Left: (see above for stats)
DEBUG: After normalization, P sums check: min=0.0000, max=1.0000
DEBUG: Predicted class distribution (before -1 shift):
  Class 0: 47125 vertices (31.5%)
  Class 29: 9745 vertices (6.5%)
  Class 12: 7128 vertices (4.8%)
  Class 30: 7007 vertices (4.7%)
  Class 28: 6381 vertices (4.3%)
  Class 25: 6054 vertices (4.0%)
  Class 9: 5499 vertices (3.7%)
  Class 23: 5421 vertices (3.6%)
  Class 10: 4373 vertices (2.9%)
  Class 32: 4244 vertices (2.8%)
DEBUG: Background predicted: 47125 (31.5%)
DEBUG: Foreground predicted: 102626 (68.5%)
Labels aggregated!
  ‚úì Aggregation complete
  ‚úì Prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/Twins-2-2/pred_7625119
  Loaded P matrix: (37, 149751), vertices: 149751
  Mesh: 149751 vertices, 299498 faces
  Step 1: Smoothing probabilities (20 iter, Œ±=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ‚úì Smoothing complete
  Step 2: MRF refinement (Œ≤=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ‚úì MRF refinement complete

  RESULTS:
  RAW:         median(top-10)=0.7819, mean(top-10)=0.7817, median(all)=0.6715, mean(all)=0.5784
  + SMOOTHING: median(top-10)=0.8426, mean(top-10)=0.8494, median(all)=0.7788, mean(all)=0.6891 [+0.0607]
  + MRF:       median(top-10)=0.8432, mean(top-10)=0.8500, median(all)=0.7790, mean(all)=0.6895 [+0.0006]
  TOTAL IMPROVEMENT (median top-10): +0.0613

================================================================================
AGGREGATE RESULTS ACROSS ALL TEST SUBJECTS
================================================================================
Number of subjects: 100

RAW PREDICTIONS:
  Median(top-10):  0.7792 ¬± 0.0224  (min: 0.6670, max: 0.8190)
  Mean(top-10):    0.7839 ¬± 0.0216  (min: 0.6686, max: 0.8154)
  Median(all):     0.6733 ¬± 0.0330  (min: 0.4772, max: 0.7233)
  Mean(all):       0.5999 ¬± 0.0249  (min: 0.4567, max: 0.6405)

+ SMOOTHING (Œ±=0.75, 20 iter):
  Median(top-10):  0.8713 ¬± 0.0229  (min: 0.7559, max: 0.9045)
  Mean(top-10):    0.8734 ¬± 0.0217  (min: 0.7470, max: 0.8994)
  Median(all):     0.8009 ¬± 0.0299  (min: 0.6075, max: 0.8380)
  Mean(all):       0.7185 ¬± 0.0291  (min: 0.5450, max: 0.7481)
  Improvement:     median(top-10) +0.0921, mean(all) +0.1186

+ MRF (Œ≤=0.1, 5 iter):
  Median(top-10):  0.8717 ¬± 0.0229  (min: 0.7562, max: 0.9048)
  Mean(top-10):    0.8737 ¬± 0.0217  (min: 0.7469, max: 0.8995)
  Median(all):     0.8012 ¬± 0.0299  (min: 0.6075, max: 0.8383)
  Mean(all):       0.7187 ¬± 0.0291  (min: 0.5450, max: 0.7483)
  Improvement:     median(top-10) +0.0003, mean(all) +0.0003

TOTAL IMPROVEMENT (RAW ‚Üí MRF):
  Median(top-10):  +0.0925
  Mean(top-10):    +0.0897
  Median(all):     +0.1279
  Mean(all):       +0.1189

================================================================================
*** PAPER TARGET: ~0.90 (median across 10 largest parcels) ***
*** FULL PIPELINE: NEW pytorch3d models + Smoothing + MRF ***
*** Predictions saved in: pred_7625119/ directories ***
================================================================================
