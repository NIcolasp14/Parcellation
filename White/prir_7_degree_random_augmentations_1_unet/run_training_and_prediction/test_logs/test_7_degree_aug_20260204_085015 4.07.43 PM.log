nohup: ignoring input
========================================================================
Testing Arbitrary-View Conditioned Model
========================================================================
Model directory: /autofs/space/ballarat_004/users/np341/PRIR_Code/Training/White/prir_x_y_z_conditional_1_unet/models/xyz_conditioned_v2_1view_7785764
Test data:       /autofs/space/ballarat_004/users/np341/mindboggle2
Device:          cuda:0

Found checkpoint: last.ckpt

Starting test...
========================================================================

[GPU] PyTorch3D loaded - GPU raycasting AVAILABLE (FAST MODE: bin_size=None)
[GPU] PyTorch3D loaded - GPU raycasting AVAILABLE (will be enabled via --raycasting arg)
Auto-detected latest checkpoint: last.ckpt

Loading model from: /autofs/space/ballarat_004/users/np341/PRIR_Code/Training/White/prir_x_y_z_conditional_1_unet/models/xyz_conditioned_v2_1view_7785764/last.ckpt
✓ Model loaded (using TRAIN mode due to corrupted BN running stats)

================================================================================
Testing VIEW-CONDITIONED model V2 (Arbitrary Views) with PyTorch3D pipeline
Checkpoint: /autofs/space/ballarat_004/users/np341/PRIR_Code/Training/White/prir_x_y_z_conditional_1_unet/models/xyz_conditioned_v2_1view_7785764/last.ckpt
Test data: /autofs/space/ballarat_004/users/np341/mindboggle2
Using all default views: ['Front', 'Back', 'Left', 'Right', 'Top', 'Bottom']
1. Generate predictions using V2 model (continuous camera pose)
2. Iterative smoothing (α=0.75, 20 iter)
3. MRF with ICM (β=0.1)
================================================================================

Found 101 test subjects

================================================================================
Subject: Afterthought-1
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 130921 vertices, 261838 faces
  Rendering 6 views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 130921 vertices, 261838 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (52544 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (102793 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (94972 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (67847 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (47950 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (72380 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 52544/640000 (8.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=261300, num_faces=261838
      Valid probs shape: (37, 52544)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 102793/640000 (16.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=261837, num_faces=261838
      Valid probs shape: (37, 102793)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 94972/640000 (14.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=11, max=261835, num_faces=261838
      Valid probs shape: (37, 94972)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 67847/640000 (10.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=11, max=261746, num_faces=261838
      Valid probs shape: (37, 67847)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 47950/640000 (7.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3568, max=261837, num_faces=261838
      Valid probs shape: (37, 47950)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 72380/640000 (11.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=34, max=261836, num_faces=261838
      Valid probs shape: (37, 72380)
    P stats: min=0.0000, max=1.0000, mean=0.0200
    Non-zero vertices: 96668/130921
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 34253   746   760  3149     0  1555   914  3129  4995]
  Ground Truth Stats:
    Labels shape: (130921,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/Afterthought-1/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7073
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8481
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8480

  RESULTS:
  RAW:         median(top-10)=0.8463, mean(top-10)=0.8519, median(all)=0.7492, mean(all)=0.7073
  + SMOOTHING: median(top-10)=0.9265, mean(top-10)=0.9294, median(all)=0.8948, mean(all)=0.8481 [+0.0802]
  + MRF:       median(top-10)=0.9264, mean(top-10)=0.9295, median(all)=0.8946, mean(all)=0.8480 [-0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0800

================================================================================
Subject: Colin27-1
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 182414 vertices, 364824 faces
  Rendering 6 views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 182414 vertices, 364824 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (43071 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (97725 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (89326 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (56504 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (42980 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (61050 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 43071/640000 (6.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=364539, num_faces=364824
      Valid probs shape: (37, 43071)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 97725/640000 (15.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=96, max=364820, num_faces=364824
      Valid probs shape: (37, 97725)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 89326/640000 (14.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8, max=364541, num_faces=364824
      Valid probs shape: (37, 89326)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 56504/640000 (8.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=364669, num_faces=364824
      Valid probs shape: (37, 56504)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 42980/640000 (6.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=119742, max=364669, num_faces=364824
      Valid probs shape: (37, 42980)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 61050/640000 (9.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=136, max=364823, num_faces=364824
      Valid probs shape: (37, 61050)
    P stats: min=0.0000, max=1.0000, mean=0.0194
    Non-zero vertices: 130641/182414
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 51773  1370  1412  3782     0  2031   954  5028  6966]
  Ground Truth Stats:
    Labels shape: (182414,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/Colin27-1/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6844
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8228
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8231

  RESULTS:
  RAW:         median(top-10)=0.8267, mean(top-10)=0.8320, median(all)=0.7166, mean(all)=0.6844
  + SMOOTHING: median(top-10)=0.9115, mean(top-10)=0.9137, median(all)=0.8594, mean(all)=0.8228 [+0.0848]
  + MRF:       median(top-10)=0.9118, mean(top-10)=0.9142, median(all)=0.8594, mean(all)=0.8231 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0851

================================================================================
Subject: HLN-12-1
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 138729 vertices, 277454 faces
  Rendering 6 views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 138729 vertices, 277454 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (55392 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (110033 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (101081 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (71993 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (58637 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (75986 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 55392/640000 (8.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=277356, num_faces=277454
      Valid probs shape: (37, 55392)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 110033/640000 (17.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=277453, num_faces=277454
      Valid probs shape: (37, 110033)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 101081/640000 (15.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=9, max=277285, num_faces=277454
      Valid probs shape: (37, 101081)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 71993/640000 (11.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=277337, num_faces=277454
      Valid probs shape: (37, 71993)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 58637/640000 (9.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=14742, max=277439, num_faces=277454
      Valid probs shape: (37, 58637)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 75986/640000 (11.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=277453, num_faces=277454
      Valid probs shape: (37, 75986)
    P stats: min=0.0000, max=1.0000, mean=0.0197
    Non-zero vertices: 100890/138729
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 37839   676   845  2731     0  1773   778  3826  5011]
  Ground Truth Stats:
    Labels shape: (138729,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/HLN-12-1/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6983
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8414
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8417

  RESULTS:
  RAW:         median(top-10)=0.7995, mean(top-10)=0.8215, median(all)=0.7267, mean(all)=0.6983
  + SMOOTHING: median(top-10)=0.9230, mean(top-10)=0.9247, median(all)=0.8901, mean(all)=0.8414 [+0.1235]
  + MRF:       median(top-10)=0.9236, mean(top-10)=0.9249, median(all)=0.8911, mean(all)=0.8417 [+0.0006]
  TOTAL IMPROVEMENT (median top-10): +0.1241

================================================================================
Subject: HLN-12-10
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 134639 vertices, 269274 faces
  Rendering 6 views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 134639 vertices, 269274 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (49208 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (103318 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (96400 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (63448 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (48636 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (67763 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 49208/640000 (7.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=268227, num_faces=269274
      Valid probs shape: (37, 49208)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 103318/640000 (16.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=33, max=269273, num_faces=269274
      Valid probs shape: (37, 103318)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 96400/640000 (15.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=269228, num_faces=269274
      Valid probs shape: (37, 96400)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 63448/640000 (9.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=269272, num_faces=269274
      Valid probs shape: (37, 63448)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 48636/640000 (7.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=90443, max=269273, num_faces=269274
      Valid probs shape: (37, 48636)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 67763/640000 (10.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=18, max=269267, num_faces=269274
      Valid probs shape: (37, 67763)
    P stats: min=0.0000, max=1.0000, mean=0.0197
    Non-zero vertices: 98072/134639
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 36567   777   781  2479     0  1980   983  4100  3933]
  Ground Truth Stats:
    Labels shape: (134639,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/HLN-12-10/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6874
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8334
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8335

  RESULTS:
  RAW:         median(top-10)=0.8197, mean(top-10)=0.8350, median(all)=0.7234, mean(all)=0.6874
  + SMOOTHING: median(top-10)=0.9174, mean(top-10)=0.9185, median(all)=0.8695, mean(all)=0.8334 [+0.0977]
  + MRF:       median(top-10)=0.9175, mean(top-10)=0.9186, median(all)=0.8696, mean(all)=0.8335 [+0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0978

================================================================================
Subject: HLN-12-11
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 130710 vertices, 261416 faces
  Rendering 6 views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 130710 vertices, 261416 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (54132 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (108773 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (99782 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (70200 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (53644 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (73452 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 54132/640000 (8.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=260363, num_faces=261416
      Valid probs shape: (37, 54132)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 108773/640000 (17.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=9, max=261270, num_faces=261416
      Valid probs shape: (37, 108773)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 99782/640000 (15.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=261118, num_faces=261416
      Valid probs shape: (37, 99782)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 70200/640000 (11.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=17, max=260417, num_faces=261416
      Valid probs shape: (37, 70200)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 53644/640000 (8.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=8184, max=261302, num_faces=261416
      Valid probs shape: (37, 53644)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 73452/640000 (11.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=174, max=261415, num_faces=261416
      Valid probs shape: (37, 73452)
    P stats: min=0.0000, max=1.0000, mean=0.0199
    Non-zero vertices: 96021/130710
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 34689   793   686  2329     0  1571   977  3390  4434]
  Ground Truth Stats:
    Labels shape: (130710,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/HLN-12-11/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6873
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8191
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8193

  RESULTS:
  RAW:         median(top-10)=0.8240, mean(top-10)=0.8265, median(all)=0.7570, mean(all)=0.6873
  + SMOOTHING: median(top-10)=0.9240, mean(top-10)=0.9247, median(all)=0.8585, mean(all)=0.8191 [+0.1000]
  + MRF:       median(top-10)=0.9243, mean(top-10)=0.9249, median(all)=0.8586, mean(all)=0.8193 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.1003

================================================================================
Subject: HLN-12-12
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 148128 vertices, 296252 faces
  Rendering 6 views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 148128 vertices, 296252 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (36488 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (87809 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (81986 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (54622 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (39079 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (58147 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 36488/640000 (5.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=295661, num_faces=296252
      Valid probs shape: (37, 36488)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 87809/640000 (13.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=296202, num_faces=296252
      Valid probs shape: (37, 87809)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 81986/640000 (12.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=296228, num_faces=296252
      Valid probs shape: (37, 81986)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 54622/640000 (8.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=28, max=295788, num_faces=296252
      Valid probs shape: (37, 54622)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 39079/640000 (6.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=19163, max=296251, num_faces=296252
      Valid probs shape: (37, 39079)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 58147/640000 (9.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=63, max=296199, num_faces=296252
      Valid probs shape: (37, 58147)
    P stats: min=0.0000, max=1.0000, mean=0.0190
    Non-zero vertices: 104357/148128
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 43771   713   574  2901     0  1953   904  5130  5785]
  Ground Truth Stats:
    Labels shape: (148128,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/HLN-12-12/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6744
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8266
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8269

  RESULTS:
  RAW:         median(top-10)=0.8036, mean(top-10)=0.8162, median(all)=0.7446, mean(all)=0.6744
  + SMOOTHING: median(top-10)=0.9149, mean(top-10)=0.9192, median(all)=0.8657, mean(all)=0.8266 [+0.1112]
  + MRF:       median(top-10)=0.9148, mean(top-10)=0.9193, median(all)=0.8660, mean(all)=0.8269 [-0.0000]
  TOTAL IMPROVEMENT (median top-10): +0.1112

================================================================================
Subject: HLN-12-2
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 146833 vertices, 293662 faces
  Rendering 6 views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 146833 vertices, 293662 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (46607 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (103885 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (96694 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (62897 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (44360 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (66086 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 46607/640000 (7.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=291413, num_faces=293662
      Valid probs shape: (37, 46607)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 103885/640000 (16.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=293617, num_faces=293662
      Valid probs shape: (37, 103885)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 96694/640000 (15.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=293660, num_faces=293662
      Valid probs shape: (37, 96694)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 62897/640000 (9.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=293652, num_faces=293662
      Valid probs shape: (37, 62897)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 44360/640000 (6.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=702, max=293660, num_faces=293662
      Valid probs shape: (37, 44360)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 66086/640000 (10.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=293660, num_faces=293662
      Valid probs shape: (37, 66086)
    P stats: min=0.0000, max=1.0000, mean=0.0198
    Non-zero vertices: 107451/146833
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 39382   630   654  3132     0  1619   902  3865  4964]
  Ground Truth Stats:
    Labels shape: (146833,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/HLN-12-2/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6816
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8280
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8282

  RESULTS:
  RAW:         median(top-10)=0.8294, mean(top-10)=0.8298, median(all)=0.7164, mean(all)=0.6816
  + SMOOTHING: median(top-10)=0.9235, mean(top-10)=0.9258, median(all)=0.8634, mean(all)=0.8280 [+0.0942]
  + MRF:       median(top-10)=0.9235, mean(top-10)=0.9259, median(all)=0.8639, mean(all)=0.8282 [+0.0000]
  TOTAL IMPROVEMENT (median top-10): +0.0942

================================================================================
Subject: HLN-12-3
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 150991 vertices, 301978 faces
  Rendering 6 views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 150991 vertices, 301978 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (50763 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (103869 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (95766 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (69662 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (47677 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (73690 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 50763/640000 (7.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=300913, num_faces=301978
      Valid probs shape: (37, 50763)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 103869/640000 (16.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=301969, num_faces=301978
      Valid probs shape: (37, 103869)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 95766/640000 (15.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=301976, num_faces=301978
      Valid probs shape: (37, 95766)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 69662/640000 (10.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=301909, num_faces=301978
      Valid probs shape: (37, 69662)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 47677/640000 (7.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=12685, max=301976, num_faces=301978
      Valid probs shape: (37, 47677)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 73690/640000 (11.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=301977, num_faces=301978
      Valid probs shape: (37, 73690)
    P stats: min=0.0000, max=1.0000, mean=0.0187
    Non-zero vertices: 104277/150991
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 46714   730  1165  2903     0  1683   957  3182  5745]
  Ground Truth Stats:
    Labels shape: (150991,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/HLN-12-3/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6722
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8253
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8256

  RESULTS:
  RAW:         median(top-10)=0.8118, mean(top-10)=0.8163, median(all)=0.7270, mean(all)=0.6722
  + SMOOTHING: median(top-10)=0.9216, mean(top-10)=0.9247, median(all)=0.8753, mean(all)=0.8253 [+0.1098]
  + MRF:       median(top-10)=0.9219, mean(top-10)=0.9249, median(all)=0.8752, mean(all)=0.8256 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.1101

================================================================================
Subject: HLN-12-4
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 137751 vertices, 275498 faces
  Rendering 6 views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 137751 vertices, 275498 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (45362 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (101448 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (93148 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (61368 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (40991 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (65568 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 45362/640000 (7.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=274427, num_faces=275498
      Valid probs shape: (37, 45362)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 101448/640000 (15.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=10, max=275493, num_faces=275498
      Valid probs shape: (37, 101448)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 93148/640000 (14.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=11, max=275447, num_faces=275498
      Valid probs shape: (37, 93148)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 61368/640000 (9.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=275424, num_faces=275498
      Valid probs shape: (37, 61368)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 40991/640000 (6.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=15917, max=275497, num_faces=275498
      Valid probs shape: (37, 40991)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 65568/640000 (10.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=15, max=275497, num_faces=275498
      Valid probs shape: (37, 65568)
    P stats: min=0.0000, max=1.0000, mean=0.0195
    Non-zero vertices: 99507/137751
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 38244   683   863  3083     0  1998   829  3359  5205]
  Ground Truth Stats:
    Labels shape: (137751,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/HLN-12-4/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
    MRF iteration 5/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6801
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8240
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8243

  RESULTS:
  RAW:         median(top-10)=0.8074, mean(top-10)=0.8213, median(all)=0.7549, mean(all)=0.6801
  + SMOOTHING: median(top-10)=0.9243, mean(top-10)=0.9246, median(all)=0.8746, mean(all)=0.8240 [+0.1169]
  + MRF:       median(top-10)=0.9244, mean(top-10)=0.9247, median(all)=0.8752, mean(all)=0.8243 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.1171

================================================================================
Subject: HLN-12-5
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 167182 vertices, 334360 faces
  Rendering 6 views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 167182 vertices, 334360 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (59201 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (119392 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (108361 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (76922 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (58160 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (81303 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 59201/640000 (9.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=333773, num_faces=334360
      Valid probs shape: (37, 59201)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 119392/640000 (18.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=6, max=334330, num_faces=334360
      Valid probs shape: (37, 119392)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 108361/640000 (16.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=334359, num_faces=334360
      Valid probs shape: (37, 108361)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 76922/640000 (12.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=333104, num_faces=334360
      Valid probs shape: (37, 76922)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 58160/640000 (9.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=11446, max=334358, num_faces=334360
      Valid probs shape: (37, 58160)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 81303/640000 (12.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=97, max=334358, num_faces=334360
      Valid probs shape: (37, 81303)
    P stats: min=0.0000, max=1.0000, mean=0.0189
    Non-zero vertices: 117006/167182
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 50176   721  1397  2909     0  1567  1046  4434  6089]
  Ground Truth Stats:
    Labels shape: (167182,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/HLN-12-5/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6706
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8292
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8293

  RESULTS:
  RAW:         median(top-10)=0.8069, mean(top-10)=0.8086, median(all)=0.7177, mean(all)=0.6706
  + SMOOTHING: median(top-10)=0.9056, mean(top-10)=0.9096, median(all)=0.8583, mean(all)=0.8292 [+0.0986]
  + MRF:       median(top-10)=0.9055, mean(top-10)=0.9095, median(all)=0.8588, mean(all)=0.8293 [-0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0985

================================================================================
Subject: HLN-12-6
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 149409 vertices, 298814 faces
  Rendering 6 views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 149409 vertices, 298814 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (48687 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (106170 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (98195 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (63466 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (48654 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (67125 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 48687/640000 (7.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=298186, num_faces=298814
      Valid probs shape: (37, 48687)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 106170/640000 (16.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=298813, num_faces=298814
      Valid probs shape: (37, 106170)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 98195/640000 (15.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=298813, num_faces=298814
      Valid probs shape: (37, 98195)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 63466/640000 (9.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=298813, num_faces=298814
      Valid probs shape: (37, 63466)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 48654/640000 (7.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=113698, max=298813, num_faces=298814
      Valid probs shape: (37, 48654)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 67125/640000 (10.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=180, max=298810, num_faces=298814
      Valid probs shape: (37, 67125)
    P stats: min=0.0000, max=1.0000, mean=0.0185
    Non-zero vertices: 102038/149409
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 47371   755   818  2877     0  1673   798  4888  4705]
  Ground Truth Stats:
    Labels shape: (149409,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/HLN-12-6/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6641
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8233
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8236

  RESULTS:
  RAW:         median(top-10)=0.8175, mean(top-10)=0.8200, median(all)=0.7098, mean(all)=0.6641
  + SMOOTHING: median(top-10)=0.9297, mean(top-10)=0.9287, median(all)=0.8599, mean(all)=0.8233 [+0.1123]
  + MRF:       median(top-10)=0.9304, mean(top-10)=0.9289, median(all)=0.8604, mean(all)=0.8236 [+0.0007]
  TOTAL IMPROVEMENT (median top-10): +0.1130

================================================================================
Subject: HLN-12-7
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 122042 vertices, 244080 faces
  Rendering 6 views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 122042 vertices, 244080 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (48174 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (97942 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (90170 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (66958 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (46544 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (70897 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 48174/640000 (7.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=243668, num_faces=244080
      Valid probs shape: (37, 48174)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 97942/640000 (15.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7, max=243977, num_faces=244080
      Valid probs shape: (37, 97942)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 90170/640000 (14.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=12, max=244078, num_faces=244080
      Valid probs shape: (37, 90170)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 66958/640000 (10.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=244060, num_faces=244080
      Valid probs shape: (37, 66958)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 46544/640000 (7.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5059, max=244079, num_faces=244080
      Valid probs shape: (37, 46544)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 70897/640000 (11.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=32, max=244078, num_faces=244080
      Valid probs shape: (37, 70897)
    P stats: min=0.0000, max=1.0000, mean=0.0198
    Non-zero vertices: 89361/122042
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 32681   562   934  2302     0  1757   788  3838  3783]
  Ground Truth Stats:
    Labels shape: (122042,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/HLN-12-7/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7008
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8384
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8386

  RESULTS:
  RAW:         median(top-10)=0.8284, mean(top-10)=0.8355, median(all)=0.7549, mean(all)=0.7008
  + SMOOTHING: median(top-10)=0.9184, mean(top-10)=0.9243, median(all)=0.8930, mean(all)=0.8384 [+0.0900]
  + MRF:       median(top-10)=0.9188, mean(top-10)=0.9245, median(all)=0.8926, mean(all)=0.8386 [+0.0004]
  TOTAL IMPROVEMENT (median top-10): +0.0904

================================================================================
Subject: HLN-12-8
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 163705 vertices, 327406 faces
  Rendering 6 views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 163705 vertices, 327406 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (40393 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (100424 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (93719 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (62442 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (41836 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (64666 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 40393/640000 (6.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=326193, num_faces=327406
      Valid probs shape: (37, 40393)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 100424/640000 (15.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=327264, num_faces=327406
      Valid probs shape: (37, 100424)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 93719/640000 (14.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=327402, num_faces=327406
      Valid probs shape: (37, 93719)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 62442/640000 (9.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=327404, num_faces=327406
      Valid probs shape: (37, 62442)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 41836/640000 (6.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6877, max=327405, num_faces=327406
      Valid probs shape: (37, 41836)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 64666/640000 (10.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=8, max=327269, num_faces=327406
      Valid probs shape: (37, 64666)
    P stats: min=0.0000, max=1.0000, mean=0.0191
    Non-zero vertices: 115976/163705
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 47729   663  1215  3064     0  1871  1075  4316  5096]
  Ground Truth Stats:
    Labels shape: (163705,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/HLN-12-8/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6730
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8218
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8218

  RESULTS:
  RAW:         median(top-10)=0.8051, mean(top-10)=0.8172, median(all)=0.7347, mean(all)=0.6730
  + SMOOTHING: median(top-10)=0.9194, mean(top-10)=0.9170, median(all)=0.8569, mean(all)=0.8218 [+0.1143]
  + MRF:       median(top-10)=0.9197, mean(top-10)=0.9171, median(all)=0.8573, mean(all)=0.8218 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.1146

================================================================================
Subject: HLN-12-9
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 137393 vertices, 274782 faces
  Rendering 6 views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 137393 vertices, 274782 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (46497 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (104898 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (97052 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (68112 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (46952 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (70884 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 46497/640000 (7.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=274139, num_faces=274782
      Valid probs shape: (37, 46497)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 104898/640000 (16.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=3, max=274781, num_faces=274782
      Valid probs shape: (37, 104898)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 97052/640000 (15.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=274775, num_faces=274782
      Valid probs shape: (37, 97052)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 68112/640000 (10.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=274759, num_faces=274782
      Valid probs shape: (37, 68112)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 46952/640000 (7.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=13241, max=274780, num_faces=274782
      Valid probs shape: (37, 46952)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 70884/640000 (11.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=11, max=274778, num_faces=274782
      Valid probs shape: (37, 70884)
    P stats: min=0.0000, max=1.0000, mean=0.0198
    Non-zero vertices: 100691/137393
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 36702   683   928  2604     0  1842   813  3832  4981]
  Ground Truth Stats:
    Labels shape: (137393,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/HLN-12-9/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6986
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8417
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8417

  RESULTS:
  RAW:         median(top-10)=0.8495, mean(top-10)=0.8475, median(all)=0.7477, mean(all)=0.6986
  + SMOOTHING: median(top-10)=0.9348, mean(top-10)=0.9367, median(all)=0.8767, mean(all)=0.8417 [+0.0853]
  + MRF:       median(top-10)=0.9351, mean(top-10)=0.9369, median(all)=0.8770, mean(all)=0.8417 [+0.0004]
  TOTAL IMPROVEMENT (median top-10): +0.0857

================================================================================
Subject: MMRR-21-1
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 130631 vertices, 261258 faces
  Rendering 6 views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 130631 vertices, 261258 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (40722 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (99817 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (92769 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (57787 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (39358 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (61484 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 40722/640000 (6.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=259583, num_faces=261258
      Valid probs shape: (37, 40722)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 99817/640000 (15.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=261192, num_faces=261258
      Valid probs shape: (37, 99817)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 92769/640000 (14.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=261257, num_faces=261258
      Valid probs shape: (37, 92769)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 57787/640000 (9.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=261254, num_faces=261258
      Valid probs shape: (37, 57787)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 39358/640000 (6.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7127, max=261255, num_faces=261258
      Valid probs shape: (37, 39358)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 61484/640000 (9.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=81, max=261129, num_faces=261258
      Valid probs shape: (37, 61484)
    P stats: min=0.0000, max=1.0000, mean=0.0195
    Non-zero vertices: 94316/130631
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 36315   690   743  2512     0  1158   697  3716  4150]
  Ground Truth Stats:
    Labels shape: (130631,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-1/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6902
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8447
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8449

  RESULTS:
  RAW:         median(top-10)=0.8209, mean(top-10)=0.8345, median(all)=0.7495, mean(all)=0.6902
  + SMOOTHING: median(top-10)=0.9188, mean(top-10)=0.9215, median(all)=0.8894, mean(all)=0.8447 [+0.0979]
  + MRF:       median(top-10)=0.9192, mean(top-10)=0.9217, median(all)=0.8899, mean(all)=0.8449 [+0.0004]
  TOTAL IMPROVEMENT (median top-10): +0.0983

================================================================================
Subject: MMRR-21-10
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 148162 vertices, 296320 faces
  Rendering 6 views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 148162 vertices, 296320 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (43482 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (98186 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (91751 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (60436 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (42061 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (64853 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 43482/640000 (6.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=293646, num_faces=296320
      Valid probs shape: (37, 43482)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 98186/640000 (15.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=296319, num_faces=296320
      Valid probs shape: (37, 98186)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 91751/640000 (14.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=296313, num_faces=296320
      Valid probs shape: (37, 91751)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 60436/640000 (9.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=296313, num_faces=296320
      Valid probs shape: (37, 60436)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 42061/640000 (6.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=8175, max=296319, num_faces=296320
      Valid probs shape: (37, 42061)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 64853/640000 (10.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=11, max=296097, num_faces=296320
      Valid probs shape: (37, 64853)
    P stats: min=0.0000, max=1.0000, mean=0.0192
    Non-zero vertices: 105240/148162
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 42922   660   698  2832     0  1886   897  3905  5749]
  Ground Truth Stats:
    Labels shape: (148162,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-10/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6828
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8372
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8374

  RESULTS:
  RAW:         median(top-10)=0.8265, mean(top-10)=0.8278, median(all)=0.7268, mean(all)=0.6828
  + SMOOTHING: median(top-10)=0.9118, mean(top-10)=0.9189, median(all)=0.8735, mean(all)=0.8372 [+0.0853]
  + MRF:       median(top-10)=0.9119, mean(top-10)=0.9192, median(all)=0.8733, mean(all)=0.8374 [+0.0000]
  TOTAL IMPROVEMENT (median top-10): +0.0853

================================================================================
Subject: MMRR-21-11
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 136982 vertices, 273960 faces
  Rendering 6 views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 136982 vertices, 273960 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (52146 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (110529 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (101692 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (69534 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (48724 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (73385 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 52146/640000 (8.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=272575, num_faces=273960
      Valid probs shape: (37, 52146)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 110529/640000 (17.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=9, max=273959, num_faces=273960
      Valid probs shape: (37, 110529)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 101692/640000 (15.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=273957, num_faces=273960
      Valid probs shape: (37, 101692)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 69534/640000 (10.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=16, max=273953, num_faces=273960
      Valid probs shape: (37, 69534)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 48724/640000 (7.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=14048, max=273957, num_faces=273960
      Valid probs shape: (37, 48724)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 73385/640000 (11.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=273951, num_faces=273960
      Valid probs shape: (37, 73385)
    P stats: min=0.0000, max=1.0000, mean=0.0197
    Non-zero vertices: 99681/136982
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 37301  1225   652  2039     0  1465   889  3629  4766]
  Ground Truth Stats:
    Labels shape: (136982,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-11/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6213
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7363
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7363

  RESULTS:
  RAW:         median(top-10)=0.8043, mean(top-10)=0.8138, median(all)=0.7118, mean(all)=0.6213
  + SMOOTHING: median(top-10)=0.8979, mean(top-10)=0.8965, median(all)=0.8210, mean(all)=0.7363 [+0.0935]
  + MRF:       median(top-10)=0.8979, mean(top-10)=0.8966, median(all)=0.8206, mean(all)=0.7363 [+0.0000]
  TOTAL IMPROVEMENT (median top-10): +0.0936

================================================================================
Subject: MMRR-21-12
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 102602 vertices, 205200 faces
  Rendering 6 views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 102602 vertices, 205200 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (47593 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (99656 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (92170 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (63142 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (48707 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (67036 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 47593/640000 (7.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=204378, num_faces=205200
      Valid probs shape: (37, 47593)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 99656/640000 (15.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=205196, num_faces=205200
      Valid probs shape: (37, 99656)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 92170/640000 (14.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=205115, num_faces=205200
      Valid probs shape: (37, 92170)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 63142/640000 (9.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=205183, num_faces=205200
      Valid probs shape: (37, 63142)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 48707/640000 (7.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=61823, max=205199, num_faces=205200
      Valid probs shape: (37, 48707)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 67036/640000 (10.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=8, max=205182, num_faces=205200
      Valid probs shape: (37, 67036)
    P stats: min=0.0000, max=1.0000, mean=0.0201
    Non-zero vertices: 76274/102602
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 26328   713   768  1408     0  1042   787  2657  3297]
  Ground Truth Stats:
    Labels shape: (102602,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-12/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6912
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8246
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8247

  RESULTS:
  RAW:         median(top-10)=0.8371, mean(top-10)=0.8501, median(all)=0.7578, mean(all)=0.6912
  + SMOOTHING: median(top-10)=0.9164, mean(top-10)=0.9217, median(all)=0.8739, mean(all)=0.8246 [+0.0793]
  + MRF:       median(top-10)=0.9169, mean(top-10)=0.9216, median(all)=0.8744, mean(all)=0.8247 [+0.0005]
  TOTAL IMPROVEMENT (median top-10): +0.0798

================================================================================
Subject: MMRR-21-13
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 128887 vertices, 257770 faces
  Rendering 6 views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 128887 vertices, 257770 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (66987 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (128645 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (116270 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (81198 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (61231 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (85980 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 66987/640000 (10.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=255193, num_faces=257770
      Valid probs shape: (37, 66987)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 128645/640000 (20.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=0, max=257769, num_faces=257770
      Valid probs shape: (37, 128645)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 116270/640000 (18.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=257765, num_faces=257770
      Valid probs shape: (37, 116270)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 81198/640000 (12.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=257709, num_faces=257770
      Valid probs shape: (37, 81198)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 61231/640000 (9.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2134, max=257767, num_faces=257770
      Valid probs shape: (37, 61231)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 85980/640000 (13.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=38, max=257765, num_faces=257770
      Valid probs shape: (37, 85980)
    P stats: min=0.0000, max=1.0000, mean=0.0198
    Non-zero vertices: 94344/128887
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 34543   686   919  2441     0  1241   672  3734  4299]
  Ground Truth Stats:
    Labels shape: (128887,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-13/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6826
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8212
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8212

  RESULTS:
  RAW:         median(top-10)=0.8225, mean(top-10)=0.8328, median(all)=0.7357, mean(all)=0.6826
  + SMOOTHING: median(top-10)=0.9064, mean(top-10)=0.9129, median(all)=0.8733, mean(all)=0.8212 [+0.0839]
  + MRF:       median(top-10)=0.9063, mean(top-10)=0.9129, median(all)=0.8734, mean(all)=0.8212 [-0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0838

================================================================================
Subject: MMRR-21-14
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 127387 vertices, 254770 faces
  Rendering 6 views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 127387 vertices, 254770 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (43715 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (101762 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (93528 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (63818 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (42955 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (68349 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 43715/640000 (6.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=252386, num_faces=254770
      Valid probs shape: (37, 43715)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 101762/640000 (15.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=254767, num_faces=254770
      Valid probs shape: (37, 101762)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 93528/640000 (14.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=254769, num_faces=254770
      Valid probs shape: (37, 93528)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 63818/640000 (10.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=252424, num_faces=254770
      Valid probs shape: (37, 63818)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 42955/640000 (6.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3019, max=254769, num_faces=254770
      Valid probs shape: (37, 42955)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 68349/640000 (10.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=8, max=254768, num_faces=254770
      Valid probs shape: (37, 68349)
    P stats: min=0.0000, max=1.0000, mean=0.0201
    Non-zero vertices: 94509/127387
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 32878  1091   911  2543     0  1549   899  3280  3774]
  Ground Truth Stats:
    Labels shape: (127387,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-14/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6921
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8240
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8242

  RESULTS:
  RAW:         median(top-10)=0.8406, mean(top-10)=0.8445, median(all)=0.7426, mean(all)=0.6921
  + SMOOTHING: median(top-10)=0.9281, mean(top-10)=0.9292, median(all)=0.8649, mean(all)=0.8240 [+0.0875]
  + MRF:       median(top-10)=0.9283, mean(top-10)=0.9293, median(all)=0.8657, mean(all)=0.8242 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0877

================================================================================
Subject: MMRR-21-15
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 137028 vertices, 274052 faces
  Rendering 6 views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 137028 vertices, 274052 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (36305 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (90305 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (83430 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (57339 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (37026 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (60830 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 36305/640000 (5.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=273817, num_faces=274052
      Valid probs shape: (37, 36305)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 90305/640000 (14.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=273971, num_faces=274052
      Valid probs shape: (37, 90305)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 83430/640000 (13.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=16, max=274045, num_faces=274052
      Valid probs shape: (37, 83430)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 57339/640000 (9.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=274047, num_faces=274052
      Valid probs shape: (37, 57339)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 37026/640000 (5.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=22460, max=274051, num_faces=274052
      Valid probs shape: (37, 37026)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 60830/640000 (9.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6, max=274040, num_faces=274052
      Valid probs shape: (37, 60830)
    P stats: min=0.0000, max=1.0000, mean=0.0191
    Non-zero vertices: 96753/137028
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 40275   812   919  3037     0  1824   781  3315  4977]
  Ground Truth Stats:
    Labels shape: (137028,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-15/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6906
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8404
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8407

  RESULTS:
  RAW:         median(top-10)=0.8095, mean(top-10)=0.8215, median(all)=0.7521, mean(all)=0.6906
  + SMOOTHING: median(top-10)=0.9296, mean(top-10)=0.9282, median(all)=0.8827, mean(all)=0.8404 [+0.1201]
  + MRF:       median(top-10)=0.9296, mean(top-10)=0.9284, median(all)=0.8827, mean(all)=0.8407 [-0.0000]
  TOTAL IMPROVEMENT (median top-10): +0.1201

================================================================================
Subject: MMRR-21-16
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 147500 vertices, 294996 faces
  Rendering 6 views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 147500 vertices, 294996 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (40557 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (93518 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (86953 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (58863 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (38920 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (62272 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 40557/640000 (6.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=294196, num_faces=294996
      Valid probs shape: (37, 40557)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 93518/640000 (14.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=294925, num_faces=294996
      Valid probs shape: (37, 93518)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 86953/640000 (13.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8, max=294991, num_faces=294996
      Valid probs shape: (37, 86953)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 58863/640000 (9.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=294995, num_faces=294996
      Valid probs shape: (37, 58863)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 38920/640000 (6.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6867, max=294995, num_faces=294996
      Valid probs shape: (37, 38920)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 62272/640000 (9.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=59, max=294924, num_faces=294996
      Valid probs shape: (37, 62272)
    P stats: min=0.0000, max=1.0000, mean=0.0192
    Non-zero vertices: 104726/147500
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 42774   810  1001  2819     0  1899   913  3963  4810]
  Ground Truth Stats:
    Labels shape: (147500,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-16/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6915
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8387
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8386

  RESULTS:
  RAW:         median(top-10)=0.8219, mean(top-10)=0.8344, median(all)=0.7481, mean(all)=0.6915
  + SMOOTHING: median(top-10)=0.9241, mean(top-10)=0.9289, median(all)=0.8852, mean(all)=0.8387 [+0.1022]
  + MRF:       median(top-10)=0.9243, mean(top-10)=0.9290, median(all)=0.8854, mean(all)=0.8386 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.1024

================================================================================
Subject: MMRR-21-17
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 126138 vertices, 252272 faces
  Rendering 6 views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 126138 vertices, 252272 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (45826 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (102759 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (94668 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (62077 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (44356 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (67469 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 45826/640000 (7.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=251586, num_faces=252272
      Valid probs shape: (37, 45826)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 102759/640000 (16.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=252204, num_faces=252272
      Valid probs shape: (37, 102759)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 94668/640000 (14.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=252271, num_faces=252272
      Valid probs shape: (37, 94668)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 62077/640000 (9.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=252270, num_faces=252272
      Valid probs shape: (37, 62077)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 44356/640000 (6.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6043, max=252264, num_faces=252272
      Valid probs shape: (37, 44356)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 67469/640000 (10.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=13, max=252204, num_faces=252272
      Valid probs shape: (37, 67469)
    P stats: min=0.0000, max=1.0000, mean=0.0206
    Non-zero vertices: 96328/126138
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 29810  1044  1112  2202     0  2201   816  3951  4169]
  Ground Truth Stats:
    Labels shape: (126138,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-17/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7056
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8246
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8248

  RESULTS:
  RAW:         median(top-10)=0.8448, mean(top-10)=0.8500, median(all)=0.7634, mean(all)=0.7056
  + SMOOTHING: median(top-10)=0.9243, mean(top-10)=0.9275, median(all)=0.8856, mean(all)=0.8246 [+0.0795]
  + MRF:       median(top-10)=0.9246, mean(top-10)=0.9277, median(all)=0.8856, mean(all)=0.8248 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0799

================================================================================
Subject: MMRR-21-18
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 131379 vertices, 262754 faces
  Rendering 6 views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 131379 vertices, 262754 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (42260 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (92118 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (84982 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (62715 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (41126 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (66753 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 42260/640000 (6.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=262449, num_faces=262754
      Valid probs shape: (37, 42260)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 92118/640000 (14.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=262753, num_faces=262754
      Valid probs shape: (37, 92118)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 84982/640000 (13.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8, max=262751, num_faces=262754
      Valid probs shape: (37, 84982)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 62715/640000 (9.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=262751, num_faces=262754
      Valid probs shape: (37, 62715)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 41126/640000 (6.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6780, max=262753, num_faces=262754
      Valid probs shape: (37, 41126)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 66753/640000 (10.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=214, max=262643, num_faces=262754
      Valid probs shape: (37, 66753)
    P stats: min=0.0000, max=1.0000, mean=0.0195
    Non-zero vertices: 94664/131379
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 36715   658  1117  2034     0  1250   894  3587  4683]
  Ground Truth Stats:
    Labels shape: (131379,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-18/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6922
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8402
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8403

  RESULTS:
  RAW:         median(top-10)=0.8245, mean(top-10)=0.8358, median(all)=0.7493, mean(all)=0.6922
  + SMOOTHING: median(top-10)=0.9351, mean(top-10)=0.9328, median(all)=0.8634, mean(all)=0.8402 [+0.1106]
  + MRF:       median(top-10)=0.9354, mean(top-10)=0.9332, median(all)=0.8628, mean(all)=0.8403 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.1109

================================================================================
Subject: MMRR-21-19
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 145253 vertices, 290502 faces
  Rendering 6 views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 145253 vertices, 290502 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (51928 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (105292 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (97397 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (68573 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (47572 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (71543 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 51928/640000 (8.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=288277, num_faces=290502
      Valid probs shape: (37, 51928)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 105292/640000 (16.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=290500, num_faces=290502
      Valid probs shape: (37, 105292)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 97397/640000 (15.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=290499, num_faces=290502
      Valid probs shape: (37, 97397)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 68573/640000 (10.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=288242, num_faces=290502
      Valid probs shape: (37, 68573)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 47572/640000 (7.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7741, max=290501, num_faces=290502
      Valid probs shape: (37, 47572)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 71543/640000 (11.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=39, max=290501, num_faces=290502
      Valid probs shape: (37, 71543)
    P stats: min=0.0000, max=1.0000, mean=0.0197
    Non-zero vertices: 106032/145253
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 39221   940   767  2636     0  1060   837  4331  6451]
  Ground Truth Stats:
    Labels shape: (145253,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-19/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6706
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8055
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8058

  RESULTS:
  RAW:         median(top-10)=0.8173, mean(top-10)=0.8314, median(all)=0.7120, mean(all)=0.6706
  + SMOOTHING: median(top-10)=0.9122, mean(top-10)=0.9158, median(all)=0.8672, mean(all)=0.8055 [+0.0949]
  + MRF:       median(top-10)=0.9121, mean(top-10)=0.9159, median(all)=0.8673, mean(all)=0.8058 [-0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0948

================================================================================
Subject: MMRR-21-2
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 148593 vertices, 297182 faces
  Rendering 6 views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 148593 vertices, 297182 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (42385 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (102060 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (95048 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (62600 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (42580 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (66044 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 42385/640000 (6.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=296841, num_faces=297182
      Valid probs shape: (37, 42385)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 102060/640000 (15.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=297154, num_faces=297182
      Valid probs shape: (37, 102060)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 95048/640000 (14.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=22, max=297179, num_faces=297182
      Valid probs shape: (37, 95048)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 62600/640000 (9.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=26, max=297130, num_faces=297182
      Valid probs shape: (37, 62600)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 42580/640000 (6.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=98388, max=297178, num_faces=297182
      Valid probs shape: (37, 42580)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 66044/640000 (10.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=9, max=297181, num_faces=297182
      Valid probs shape: (37, 66044)
    P stats: min=0.0000, max=1.0000, mean=0.0188
    Non-zero vertices: 103496/148593
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 45097   743  1007  3225     0  1886   865  3791  4464]
  Ground Truth Stats:
    Labels shape: (148593,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-2/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6790
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8354
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8357

  RESULTS:
  RAW:         median(top-10)=0.8234, mean(top-10)=0.8201, median(all)=0.7177, mean(all)=0.6790
  + SMOOTHING: median(top-10)=0.9235, mean(top-10)=0.9262, median(all)=0.8715, mean(all)=0.8354 [+0.1001]
  + MRF:       median(top-10)=0.9240, mean(top-10)=0.9264, median(all)=0.8722, mean(all)=0.8357 [+0.0005]
  TOTAL IMPROVEMENT (median top-10): +0.1006

================================================================================
Subject: MMRR-21-20
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 149927 vertices, 299850 faces
  Rendering 6 views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 149927 vertices, 299850 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (36611 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (95169 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (88213 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (53954 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (38415 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (58097 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 36611/640000 (5.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=299499, num_faces=299850
      Valid probs shape: (37, 36611)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 95169/640000 (14.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=10, max=299848, num_faces=299850
      Valid probs shape: (37, 95169)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 88213/640000 (13.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6, max=299844, num_faces=299850
      Valid probs shape: (37, 88213)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 53954/640000 (8.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=14, max=299435, num_faces=299850
      Valid probs shape: (37, 53954)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 38415/640000 (6.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=108468, max=299830, num_faces=299850
      Valid probs shape: (37, 38415)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 58097/640000 (9.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=30, max=299849, num_faces=299850
      Valid probs shape: (37, 58097)
    P stats: min=0.0000, max=1.0000, mean=0.0189
    Non-zero vertices: 105025/149927
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 44902   728   847  2805     0  1872   893  4595  4459]
  Ground Truth Stats:
    Labels shape: (149927,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-20/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6819
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8348
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8350

  RESULTS:
  RAW:         median(top-10)=0.8205, mean(top-10)=0.8270, median(all)=0.7153, mean(all)=0.6819
  + SMOOTHING: median(top-10)=0.9205, mean(top-10)=0.9245, median(all)=0.8651, mean(all)=0.8348 [+0.0999]
  + MRF:       median(top-10)=0.9207, mean(top-10)=0.9247, median(all)=0.8655, mean(all)=0.8350 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.1001

================================================================================
Subject: MMRR-21-21
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 137496 vertices, 274988 faces
  Rendering 6 views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 137496 vertices, 274988 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (47031 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (98307 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (90811 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (62835 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (46473 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (65724 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 47031/640000 (7.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=274023, num_faces=274988
      Valid probs shape: (37, 47031)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 98307/640000 (15.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6, max=274987, num_faces=274988
      Valid probs shape: (37, 98307)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 90811/640000 (14.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=274983, num_faces=274988
      Valid probs shape: (37, 90811)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 62835/640000 (9.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=273341, num_faces=274988
      Valid probs shape: (37, 62835)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 46473/640000 (7.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=9681, max=274987, num_faces=274988
      Valid probs shape: (37, 46473)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 65724/640000 (10.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=274985, num_faces=274988
      Valid probs shape: (37, 65724)
    P stats: min=0.0000, max=1.0000, mean=0.0195
    Non-zero vertices: 99223/137496
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 38273   887   735  2882     0  1323   928  4245  5315]
  Ground Truth Stats:
    Labels shape: (137496,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-21/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6780
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8229
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8231

  RESULTS:
  RAW:         median(top-10)=0.8215, mean(top-10)=0.8318, median(all)=0.7228, mean(all)=0.6780
  + SMOOTHING: median(top-10)=0.9220, mean(top-10)=0.9226, median(all)=0.8833, mean(all)=0.8229 [+0.1005]
  + MRF:       median(top-10)=0.9220, mean(top-10)=0.9230, median(all)=0.8839, mean(all)=0.8231 [+0.0000]
  TOTAL IMPROVEMENT (median top-10): +0.1005

================================================================================
Subject: MMRR-21-3
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 144159 vertices, 288314 faces
  Rendering 6 views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 144159 vertices, 288314 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (41049 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (95902 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (88656 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (58779 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (41207 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (64155 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 41049/640000 (6.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=287561, num_faces=288314
      Valid probs shape: (37, 41049)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 95902/640000 (15.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=288313, num_faces=288314
      Valid probs shape: (37, 95902)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 88656/640000 (13.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=29, max=288307, num_faces=288314
      Valid probs shape: (37, 88656)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 58779/640000 (9.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=8, max=287559, num_faces=288314
      Valid probs shape: (37, 58779)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 41207/640000 (6.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3218, max=288306, num_faces=288314
      Valid probs shape: (37, 41207)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 64155/640000 (10.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=77, max=288310, num_faces=288314
      Valid probs shape: (37, 64155)
    P stats: min=0.0000, max=1.0000, mean=0.0196
    Non-zero vertices: 104731/144159
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 39428   748   766  3133     0  1869  1140  4112  4822]
  Ground Truth Stats:
    Labels shape: (144159,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-3/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6939
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8405
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8406

  RESULTS:
  RAW:         median(top-10)=0.8345, mean(top-10)=0.8383, median(all)=0.7374, mean(all)=0.6939
  + SMOOTHING: median(top-10)=0.9244, mean(top-10)=0.9304, median(all)=0.8786, mean(all)=0.8405 [+0.0899]
  + MRF:       median(top-10)=0.9244, mean(top-10)=0.9305, median(all)=0.8795, mean(all)=0.8406 [-0.0000]
  TOTAL IMPROVEMENT (median top-10): +0.0899

================================================================================
Subject: MMRR-21-4
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 118034 vertices, 236064 faces
  Rendering 6 views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 118034 vertices, 236064 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (43440 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (97256 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (90207 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (60094 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (39125 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (63499 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 43440/640000 (6.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=234903, num_faces=236064
      Valid probs shape: (37, 43440)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 97256/640000 (15.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=236016, num_faces=236064
      Valid probs shape: (37, 97256)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 90207/640000 (14.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=111, max=236061, num_faces=236064
      Valid probs shape: (37, 90207)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 60094/640000 (9.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=236063, num_faces=236064
      Valid probs shape: (37, 60094)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 39125/640000 (6.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5985, max=236062, num_faces=236064
      Valid probs shape: (37, 39125)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 63499/640000 (9.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=12, max=236010, num_faces=236064
      Valid probs shape: (37, 63499)
    P stats: min=0.0000, max=1.0000, mean=0.0203
    Non-zero vertices: 88733/118034
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 29301   969   669  2568     0  1357   980  3177  3309]
  Ground Truth Stats:
    Labels shape: (118034,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-4/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7015
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8308
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8310

  RESULTS:
  RAW:         median(top-10)=0.8502, mean(top-10)=0.8536, median(all)=0.7407, mean(all)=0.7015
  + SMOOTHING: median(top-10)=0.9354, mean(top-10)=0.9346, median(all)=0.8687, mean(all)=0.8308 [+0.0852]
  + MRF:       median(top-10)=0.9360, mean(top-10)=0.9349, median(all)=0.8689, mean(all)=0.8310 [+0.0006]
  TOTAL IMPROVEMENT (median top-10): +0.0858

================================================================================
Subject: MMRR-21-5
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 145215 vertices, 290426 faces
  Rendering 6 views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 145215 vertices, 290426 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (48001 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (106845 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (98217 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (66489 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (45026 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (70402 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 48001/640000 (7.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=288562, num_faces=290426
      Valid probs shape: (37, 48001)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 106845/640000 (16.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=290425, num_faces=290426
      Valid probs shape: (37, 106845)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 98217/640000 (15.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=290284, num_faces=290426
      Valid probs shape: (37, 98217)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 66489/640000 (10.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=290404, num_faces=290426
      Valid probs shape: (37, 66489)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 45026/640000 (7.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4365, max=290418, num_faces=290426
      Valid probs shape: (37, 45026)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 70402/640000 (11.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=114, max=290425, num_faces=290426
      Valid probs shape: (37, 70402)
    P stats: min=0.0000, max=1.0000, mean=0.0195
    Non-zero vertices: 104953/145215
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 40262   871   954  3695     0  1790   869  3632  4384]
  Ground Truth Stats:
    Labels shape: (145215,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-5/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6890
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8346
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8347

  RESULTS:
  RAW:         median(top-10)=0.8297, mean(top-10)=0.8337, median(all)=0.7617, mean(all)=0.6890
  + SMOOTHING: median(top-10)=0.9207, mean(top-10)=0.9269, median(all)=0.8656, mean(all)=0.8346 [+0.0909]
  + MRF:       median(top-10)=0.9205, mean(top-10)=0.9270, median(all)=0.8652, mean(all)=0.8347 [-0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0908

================================================================================
Subject: MMRR-21-6
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 128994 vertices, 257984 faces
  Rendering 6 views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 128994 vertices, 257984 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (43829 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (101514 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (94216 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (61404 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (46186 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (65533 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 43829/640000 (6.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=256952, num_faces=257984
      Valid probs shape: (37, 43829)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 101514/640000 (15.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=257975, num_faces=257984
      Valid probs shape: (37, 101514)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 94216/640000 (14.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=26, max=257943, num_faces=257984
      Valid probs shape: (37, 94216)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 61404/640000 (9.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=257522, num_faces=257984
      Valid probs shape: (37, 61404)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 46186/640000 (7.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=92692, max=257980, num_faces=257984
      Valid probs shape: (37, 46186)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 65533/640000 (10.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=257982, num_faces=257984
      Valid probs shape: (37, 65533)
    P stats: min=0.0000, max=1.0000, mean=0.0195
    Non-zero vertices: 93242/128994
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 35752   950   970  3030     0  1480   756  4034  3644]
  Ground Truth Stats:
    Labels shape: (128994,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-6/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6845
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8274
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8274

  RESULTS:
  RAW:         median(top-10)=0.8057, mean(top-10)=0.8241, median(all)=0.7468, mean(all)=0.6845
  + SMOOTHING: median(top-10)=0.9128, mean(top-10)=0.9173, median(all)=0.8616, mean(all)=0.8274 [+0.1071]
  + MRF:       median(top-10)=0.9127, mean(top-10)=0.9173, median(all)=0.8619, mean(all)=0.8274 [-0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.1070

================================================================================
Subject: MMRR-21-7
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 148998 vertices, 297992 faces
  Rendering 6 views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 148998 vertices, 297992 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (38894 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (91708 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (84613 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (54443 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (38235 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (58012 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 38894/640000 (6.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=245177, num_faces=297992
      Valid probs shape: (37, 38894)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 91708/640000 (14.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=297815, num_faces=297992
      Valid probs shape: (37, 91708)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 84613/640000 (13.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=13, max=297991, num_faces=297992
      Valid probs shape: (37, 84613)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 54443/640000 (8.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=297878, num_faces=297992
      Valid probs shape: (37, 54443)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 38235/640000 (6.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=8599, max=297986, num_faces=297992
      Valid probs shape: (37, 38235)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 58012/640000 (9.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=297956, num_faces=297992
      Valid probs shape: (37, 58012)
    P stats: min=0.0000, max=1.0000, mean=0.0193
    Non-zero vertices: 106389/148998
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 42609   784  1174  2803     0  1646   845  4766  5041]
  Ground Truth Stats:
    Labels shape: (148998,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-7/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6854
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8336
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8338

  RESULTS:
  RAW:         median(top-10)=0.8173, mean(top-10)=0.8252, median(all)=0.7357, mean(all)=0.6854
  + SMOOTHING: median(top-10)=0.9316, mean(top-10)=0.9289, median(all)=0.8795, mean(all)=0.8336 [+0.1143]
  + MRF:       median(top-10)=0.9317, mean(top-10)=0.9290, median(all)=0.8801, mean(all)=0.8338 [+0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.1144

================================================================================
Subject: MMRR-21-8
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 124399 vertices, 248794 faces
  Rendering 6 views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 124399 vertices, 248794 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (42512 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (101126 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (92934 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (57556 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (41363 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (61873 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 42512/640000 (6.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=247416, num_faces=248794
      Valid probs shape: (37, 42512)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 101126/640000 (15.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=248793, num_faces=248794
      Valid probs shape: (37, 101126)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 92934/640000 (14.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=248788, num_faces=248794
      Valid probs shape: (37, 92934)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 57556/640000 (9.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=248520, num_faces=248794
      Valid probs shape: (37, 57556)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 41363/640000 (6.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4180, max=248779, num_faces=248794
      Valid probs shape: (37, 41363)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 61873/640000 (9.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=108, max=248793, num_faces=248794
      Valid probs shape: (37, 61873)
    P stats: min=0.0000, max=1.0000, mean=0.0195
    Non-zero vertices: 89926/124399
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 34473   637   796  2882     0  1615   932  3049  4590]
  Ground Truth Stats:
    Labels shape: (124399,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-8/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6921
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8306
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8308

  RESULTS:
  RAW:         median(top-10)=0.8429, mean(top-10)=0.8468, median(all)=0.7390, mean(all)=0.6921
  + SMOOTHING: median(top-10)=0.9251, mean(top-10)=0.9260, median(all)=0.8839, mean(all)=0.8306 [+0.0822]
  + MRF:       median(top-10)=0.9251, mean(top-10)=0.9262, median(all)=0.8838, mean(all)=0.8308 [+0.0000]
  TOTAL IMPROVEMENT (median top-10): +0.0822

================================================================================
Subject: MMRR-21-9
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 131827 vertices, 263650 faces
  Rendering 6 views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 131827 vertices, 263650 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (46196 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (102595 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (94766 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (63258 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (44518 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (66524 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 46196/640000 (7.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=263279, num_faces=263650
      Valid probs shape: (37, 46196)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 102595/640000 (16.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=25, max=263645, num_faces=263650
      Valid probs shape: (37, 102595)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 94766/640000 (14.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=51, max=263649, num_faces=263650
      Valid probs shape: (37, 94766)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 63258/640000 (9.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=263649, num_faces=263650
      Valid probs shape: (37, 63258)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 44518/640000 (7.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5442, max=263649, num_faces=263650
      Valid probs shape: (37, 44518)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 66524/640000 (10.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=263643, num_faces=263650
      Valid probs shape: (37, 66524)
    P stats: min=0.0000, max=1.0000, mean=0.0194
    Non-zero vertices: 94585/131827
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 37242   569   889  2762     0  1278   792  3752  4635]
  Ground Truth Stats:
    Labels shape: (131827,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-9/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6892
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8369
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8372

  RESULTS:
  RAW:         median(top-10)=0.8224, mean(top-10)=0.8283, median(all)=0.7329, mean(all)=0.6892
  + SMOOTHING: median(top-10)=0.9210, mean(top-10)=0.9220, median(all)=0.8732, mean(all)=0.8369 [+0.0986]
  + MRF:       median(top-10)=0.9211, mean(top-10)=0.9224, median(all)=0.8738, mean(all)=0.8372 [+0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0987

================================================================================
Subject: MMRR-3T7T-2-1
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 150156 vertices, 300308 faces
  Rendering 6 views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 150156 vertices, 300308 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (50095 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (113043 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (103661 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (66639 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (47856 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (69905 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 50095/640000 (7.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=299529, num_faces=300308
      Valid probs shape: (37, 50095)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 113043/640000 (17.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=7, max=300307, num_faces=300308
      Valid probs shape: (37, 113043)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 103661/640000 (16.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=300279, num_faces=300308
      Valid probs shape: (37, 103661)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 66639/640000 (10.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=300301, num_faces=300308
      Valid probs shape: (37, 66639)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 47856/640000 (7.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3871, max=300280, num_faces=300308
      Valid probs shape: (37, 47856)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 69905/640000 (10.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=35, max=300100, num_faces=300308
      Valid probs shape: (37, 69905)
    P stats: min=0.0000, max=1.0000, mean=0.0195
    Non-zero vertices: 108101/150156
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 42055  1000   832  2988     0  1165   984  4212  5452]
  Ground Truth Stats:
    Labels shape: (150156,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-3T7T-2-1/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
    MRF iteration 5/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6897
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8391
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8393

  RESULTS:
  RAW:         median(top-10)=0.8082, mean(top-10)=0.8184, median(all)=0.7427, mean(all)=0.6897
  + SMOOTHING: median(top-10)=0.9249, mean(top-10)=0.9275, median(all)=0.8799, mean(all)=0.8391 [+0.1168]
  + MRF:       median(top-10)=0.9251, mean(top-10)=0.9276, median(all)=0.8811, mean(all)=0.8393 [+0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.1169

================================================================================
Subject: MMRR-3T7T-2-2
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 135252 vertices, 270500 faces
  Rendering 6 views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 135252 vertices, 270500 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (50737 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (99471 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (91732 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (62641 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (47436 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (65567 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 50737/640000 (7.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=270240, num_faces=270500
      Valid probs shape: (37, 50737)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 99471/640000 (15.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=270411, num_faces=270500
      Valid probs shape: (37, 99471)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 91732/640000 (14.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=26, max=270499, num_faces=270500
      Valid probs shape: (37, 91732)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 62641/640000 (9.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=10, max=270497, num_faces=270500
      Valid probs shape: (37, 62641)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 47436/640000 (7.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5387, max=270499, num_faces=270500
      Valid probs shape: (37, 47436)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 65567/640000 (10.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=270491, num_faces=270500
      Valid probs shape: (37, 65567)
    P stats: min=0.0000, max=1.0000, mean=0.0194
    Non-zero vertices: 96978/135252
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 38274   901   771  2041     0  1224   988  3373  4794]
  Ground Truth Stats:
    Labels shape: (135252,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-3T7T-2-2/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6874
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8338
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8339

  RESULTS:
  RAW:         median(top-10)=0.8151, mean(top-10)=0.8292, median(all)=0.7274, mean(all)=0.6874
  + SMOOTHING: median(top-10)=0.9266, mean(top-10)=0.9262, median(all)=0.8772, mean(all)=0.8338 [+0.1115]
  + MRF:       median(top-10)=0.9266, mean(top-10)=0.9264, median(all)=0.8768, mean(all)=0.8339 [-0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.1115

================================================================================
Subject: NKI-RS-22-1
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 137338 vertices, 274672 faces
  Rendering 6 views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 137338 vertices, 274672 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (45287 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (103328 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (95368 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (62148 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (44184 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (67015 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 45287/640000 (7.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=273342, num_faces=274672
      Valid probs shape: (37, 45287)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 103328/640000 (16.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=274664, num_faces=274672
      Valid probs shape: (37, 103328)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 95368/640000 (14.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=93, max=274645, num_faces=274672
      Valid probs shape: (37, 95368)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 62148/640000 (9.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=273780, num_faces=274672
      Valid probs shape: (37, 62148)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 44184/640000 (6.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4630, max=274671, num_faces=274672
      Valid probs shape: (37, 44184)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 67015/640000 (10.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=127, max=274669, num_faces=274672
      Valid probs shape: (37, 67015)
    P stats: min=0.0000, max=1.0000, mean=0.0198
    Non-zero vertices: 100446/137338
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 36892   823   647  2635     0  1997   887  3757  4213]
  Ground Truth Stats:
    Labels shape: (137338,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-1/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6994
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8311
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8313

  RESULTS:
  RAW:         median(top-10)=0.8328, mean(top-10)=0.8429, median(all)=0.7520, mean(all)=0.6994
  + SMOOTHING: median(top-10)=0.9286, mean(top-10)=0.9277, median(all)=0.8666, mean(all)=0.8311 [+0.0958]
  + MRF:       median(top-10)=0.9289, mean(top-10)=0.9277, median(all)=0.8674, mean(all)=0.8313 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0961

================================================================================
Subject: NKI-RS-22-10
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 130448 vertices, 260892 faces
  Rendering 6 views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 130448 vertices, 260892 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (49141 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (109988 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (102168 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (65401 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (47715 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (70340 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 49141/640000 (7.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=259346, num_faces=260892
      Valid probs shape: (37, 49141)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 109988/640000 (17.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=260885, num_faces=260892
      Valid probs shape: (37, 109988)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 102168/640000 (16.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=260804, num_faces=260892
      Valid probs shape: (37, 102168)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 65401/640000 (10.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=9, max=260733, num_faces=260892
      Valid probs shape: (37, 65401)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 47715/640000 (7.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5879, max=260883, num_faces=260892
      Valid probs shape: (37, 47715)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 70340/640000 (11.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=52, max=260891, num_faces=260892
      Valid probs shape: (37, 70340)
    P stats: min=0.0000, max=1.0000, mean=0.0200
    Non-zero vertices: 96387/130448
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 34061   767   691  2148     0  1304  1025  3467  4805]
  Ground Truth Stats:
    Labels shape: (130448,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-10/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6933
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8368
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8372

  RESULTS:
  RAW:         median(top-10)=0.8223, mean(top-10)=0.8377, median(all)=0.7400, mean(all)=0.6933
  + SMOOTHING: median(top-10)=0.9156, mean(top-10)=0.9211, median(all)=0.8910, mean(all)=0.8368 [+0.0933]
  + MRF:       median(top-10)=0.9158, mean(top-10)=0.9214, median(all)=0.8918, mean(all)=0.8372 [+0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0934

================================================================================
Subject: NKI-RS-22-11
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 138161 vertices, 276318 faces
  Rendering 6 views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 138161 vertices, 276318 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (41198 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (100125 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (92740 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (59370 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (42813 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (64767 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 41198/640000 (6.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=275546, num_faces=276318
      Valid probs shape: (37, 41198)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 100125/640000 (15.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=40, max=276235, num_faces=276318
      Valid probs shape: (37, 100125)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 92740/640000 (14.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=12, max=276315, num_faces=276318
      Valid probs shape: (37, 92740)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 59370/640000 (9.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=42, max=273260, num_faces=276318
      Valid probs shape: (37, 59370)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 42813/640000 (6.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=15873, max=276313, num_faces=276318
      Valid probs shape: (37, 42813)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 64767/640000 (10.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=276313, num_faces=276318
      Valid probs shape: (37, 64767)
    P stats: min=0.0000, max=1.0000, mean=0.0194
    Non-zero vertices: 99048/138161
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 39113   912  1050  2832     0  1504   962  3565  4469]
  Ground Truth Stats:
    Labels shape: (138161,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-11/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6893
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8447
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8450

  RESULTS:
  RAW:         median(top-10)=0.8337, mean(top-10)=0.8354, median(all)=0.7446, mean(all)=0.6893
  + SMOOTHING: median(top-10)=0.9392, mean(top-10)=0.9377, median(all)=0.8848, mean(all)=0.8447 [+0.1055]
  + MRF:       median(top-10)=0.9396, mean(top-10)=0.9380, median(all)=0.8850, mean(all)=0.8450 [+0.0004]
  TOTAL IMPROVEMENT (median top-10): +0.1059

================================================================================
Subject: NKI-RS-22-12
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 144832 vertices, 289660 faces
  Rendering 6 views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 144832 vertices, 289660 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (41471 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (92137 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (85395 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (62927 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (41614 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (65719 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 41471/640000 (6.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=287505, num_faces=289660
      Valid probs shape: (37, 41471)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 92137/640000 (14.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=34, max=289648, num_faces=289660
      Valid probs shape: (37, 92137)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 85395/640000 (13.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=15, max=289637, num_faces=289660
      Valid probs shape: (37, 85395)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 62927/640000 (9.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=9, max=289650, num_faces=289660
      Valid probs shape: (37, 62927)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 41614/640000 (6.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=9909, max=289650, num_faces=289660
      Valid probs shape: (37, 41614)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 65719/640000 (10.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=57, max=289658, num_faces=289660
      Valid probs shape: (37, 65719)
    P stats: min=0.0000, max=1.0000, mean=0.0195
    Non-zero vertices: 104604/144832
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 40228   870   901  2394     0  2066   884  3958  4526]
  Ground Truth Stats:
    Labels shape: (144832,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-12/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6932
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8389
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8390

  RESULTS:
  RAW:         median(top-10)=0.8213, mean(top-10)=0.8288, median(all)=0.7408, mean(all)=0.6932
  + SMOOTHING: median(top-10)=0.9285, mean(top-10)=0.9301, median(all)=0.8719, mean(all)=0.8389 [+0.1072]
  + MRF:       median(top-10)=0.9285, mean(top-10)=0.9302, median(all)=0.8729, mean(all)=0.8390 [-0.0000]
  TOTAL IMPROVEMENT (median top-10): +0.1072

================================================================================
Subject: NKI-RS-22-13
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 121451 vertices, 242898 faces
  Rendering 6 views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 121451 vertices, 242898 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (36598 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (92195 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (86311 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (55101 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (36296 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (59009 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 36598/640000 (5.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=241624, num_faces=242898
      Valid probs shape: (37, 36598)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 92195/640000 (14.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=242887, num_faces=242898
      Valid probs shape: (37, 92195)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 86311/640000 (13.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=44, max=242896, num_faces=242898
      Valid probs shape: (37, 86311)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 55101/640000 (8.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=241719, num_faces=242898
      Valid probs shape: (37, 55101)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 36296/640000 (5.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6217, max=242895, num_faces=242898
      Valid probs shape: (37, 36296)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 59009/640000 (9.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=31, max=242895, num_faces=242898
      Valid probs shape: (37, 59009)
    P stats: min=0.0000, max=1.0000, mean=0.0201
    Non-zero vertices: 90306/121451
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 31145   581   697  2810     0  1564   771  3430  3842]
  Ground Truth Stats:
    Labels shape: (121451,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-13/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7045
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8297
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8300

  RESULTS:
  RAW:         median(top-10)=0.8357, mean(top-10)=0.8405, median(all)=0.7527, mean(all)=0.7045
  + SMOOTHING: median(top-10)=0.9255, mean(top-10)=0.9265, median(all)=0.8649, mean(all)=0.8297 [+0.0899]
  + MRF:       median(top-10)=0.9258, mean(top-10)=0.9268, median(all)=0.8653, mean(all)=0.8300 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0902

================================================================================
Subject: NKI-RS-22-14
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 142823 vertices, 285642 faces
  Rendering 6 views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 142823 vertices, 285642 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (38420 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (89373 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (82739 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (57667 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (38739 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (61574 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 38420/640000 (6.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=285011, num_faces=285642
      Valid probs shape: (37, 38420)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 89373/640000 (14.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=285638, num_faces=285642
      Valid probs shape: (37, 89373)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 82739/640000 (12.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=15, max=285641, num_faces=285642
      Valid probs shape: (37, 82739)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 57667/640000 (9.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=284369, num_faces=285642
      Valid probs shape: (37, 57667)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 38739/640000 (6.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=34614, max=285634, num_faces=285642
      Valid probs shape: (37, 38739)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 61574/640000 (9.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=38, max=285641, num_faces=285642
      Valid probs shape: (37, 61574)
    P stats: min=0.0000, max=1.0000, mean=0.0195
    Non-zero vertices: 102926/142823
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 39897   775   984  2565     0  1810  1084  3669  5507]
  Ground Truth Stats:
    Labels shape: (142823,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-14/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6930
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8383
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8385

  RESULTS:
  RAW:         median(top-10)=0.8395, mean(top-10)=0.8421, median(all)=0.7470, mean(all)=0.6930
  + SMOOTHING: median(top-10)=0.9281, mean(top-10)=0.9298, median(all)=0.8770, mean(all)=0.8383 [+0.0885]
  + MRF:       median(top-10)=0.9282, mean(top-10)=0.9299, median(all)=0.8767, mean(all)=0.8385 [+0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0887

================================================================================
Subject: NKI-RS-22-15
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 158740 vertices, 317476 faces
  Rendering 6 views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 158740 vertices, 317476 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (52622 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (107581 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (99208 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (68580 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (48994 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (73061 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 52622/640000 (8.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=316278, num_faces=317476
      Valid probs shape: (37, 52622)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 107581/640000 (16.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=81, max=317474, num_faces=317476
      Valid probs shape: (37, 107581)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 99208/640000 (15.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=12, max=317475, num_faces=317476
      Valid probs shape: (37, 99208)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 68580/640000 (10.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=25, max=316189, num_faces=317476
      Valid probs shape: (37, 68580)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 48994/640000 (7.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=12753, max=317401, num_faces=317476
      Valid probs shape: (37, 48994)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 73061/640000 (11.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=317474, num_faces=317476
      Valid probs shape: (37, 73061)
    P stats: min=0.0000, max=1.0000, mean=0.0196
    Non-zero vertices: 115385/158740
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 43355   805   977  3371     0  1397   949  4196  5812]
  Ground Truth Stats:
    Labels shape: (158740,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-15/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6888
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8342
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8346

  RESULTS:
  RAW:         median(top-10)=0.8184, mean(top-10)=0.8276, median(all)=0.7366, mean(all)=0.6888
  + SMOOTHING: median(top-10)=0.9185, mean(top-10)=0.9215, median(all)=0.8729, mean(all)=0.8342 [+0.1001]
  + MRF:       median(top-10)=0.9187, mean(top-10)=0.9217, median(all)=0.8733, mean(all)=0.8346 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.1003

================================================================================
Subject: NKI-RS-22-16
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 137370 vertices, 274736 faces
  Rendering 6 views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 137370 vertices, 274736 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (60878 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (121155 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (111643 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (73936 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (56493 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (77034 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 60878/640000 (9.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=273269, num_faces=274736
      Valid probs shape: (37, 60878)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 121155/640000 (18.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=274733, num_faces=274736
      Valid probs shape: (37, 121155)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 111643/640000 (17.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=274663, num_faces=274736
      Valid probs shape: (37, 111643)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 73936/640000 (11.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=10, max=274625, num_faces=274736
      Valid probs shape: (37, 73936)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 56493/640000 (8.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=10110, max=274735, num_faces=274736
      Valid probs shape: (37, 56493)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 77034/640000 (12.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=19, max=274733, num_faces=274736
      Valid probs shape: (37, 77034)
    P stats: min=0.0000, max=1.0000, mean=0.0194
    Non-zero vertices: 98822/137370
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 38548   768   973  2809     0  1715   691  4203  4301]
  Ground Truth Stats:
    Labels shape: (137370,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-16/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6851
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8305
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8306

  RESULTS:
  RAW:         median(top-10)=0.8143, mean(top-10)=0.8161, median(all)=0.7517, mean(all)=0.6851
  + SMOOTHING: median(top-10)=0.9207, mean(top-10)=0.9250, median(all)=0.8577, mean(all)=0.8305 [+0.1064]
  + MRF:       median(top-10)=0.9211, mean(top-10)=0.9252, median(all)=0.8579, mean(all)=0.8306 [+0.0004]
  TOTAL IMPROVEMENT (median top-10): +0.1068

================================================================================
Subject: NKI-RS-22-17
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 161773 vertices, 323542 faces
  Rendering 6 views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 161773 vertices, 323542 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (48573 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (105047 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (96598 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (63636 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (46204 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (68115 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 48573/640000 (7.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=323100, num_faces=323542
      Valid probs shape: (37, 48573)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 105047/640000 (16.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=323478, num_faces=323542
      Valid probs shape: (37, 105047)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 96598/640000 (15.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6, max=323503, num_faces=323542
      Valid probs shape: (37, 96598)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 63636/640000 (9.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=321667, num_faces=323542
      Valid probs shape: (37, 63636)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 46204/640000 (7.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=21528, max=323535, num_faces=323542
      Valid probs shape: (37, 46204)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 68115/640000 (10.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=323541, num_faces=323542
      Valid probs shape: (37, 68115)
    P stats: min=0.0000, max=1.0000, mean=0.0193
    Non-zero vertices: 115472/161773
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 46301   609   776  3366     0  1959  1113  4798  6550]
  Ground Truth Stats:
    Labels shape: (161773,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-17/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6839
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8396
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8398

  RESULTS:
  RAW:         median(top-10)=0.8240, mean(top-10)=0.8300, median(all)=0.7537, mean(all)=0.6839
  + SMOOTHING: median(top-10)=0.9249, mean(top-10)=0.9266, median(all)=0.8835, mean(all)=0.8396 [+0.1010]
  + MRF:       median(top-10)=0.9249, mean(top-10)=0.9266, median(all)=0.8840, mean(all)=0.8398 [+0.0000]
  TOTAL IMPROVEMENT (median top-10): +0.1010

================================================================================
Subject: NKI-RS-22-18
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 147633 vertices, 295262 faces
  Rendering 6 views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 147633 vertices, 295262 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (40958 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (99199 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (93062 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (57401 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (40878 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (60794 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 40958/640000 (6.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=294742, num_faces=295262
      Valid probs shape: (37, 40958)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 99199/640000 (15.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=10, max=295261, num_faces=295262
      Valid probs shape: (37, 99199)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 93062/640000 (14.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=295219, num_faces=295262
      Valid probs shape: (37, 93062)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 57401/640000 (9.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6, max=294979, num_faces=295262
      Valid probs shape: (37, 57401)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 40878/640000 (6.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=8084, max=295260, num_faces=295262
      Valid probs shape: (37, 40878)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 60794/640000 (9.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=67, max=295261, num_faces=295262
      Valid probs shape: (37, 60794)
    P stats: min=0.0000, max=1.0000, mean=0.0196
    Non-zero vertices: 107126/147633
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 40507   843   742  3109     0  1715   926  4031  5963]
  Ground Truth Stats:
    Labels shape: (147633,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-18/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6756
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=33
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8040
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=33
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8038

  RESULTS:
  RAW:         median(top-10)=0.8429, mean(top-10)=0.8471, median(all)=0.7222, mean(all)=0.6756
  + SMOOTHING: median(top-10)=0.9123, mean(top-10)=0.9188, median(all)=0.8561, mean(all)=0.8040 [+0.0694]
  + MRF:       median(top-10)=0.9126, mean(top-10)=0.9189, median(all)=0.8560, mean(all)=0.8038 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0697

================================================================================
Subject: NKI-RS-22-19
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 141397 vertices, 282790 faces
  Rendering 6 views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 141397 vertices, 282790 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (39596 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (90573 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (84472 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (55290 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (40823 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (58701 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 39596/640000 (6.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=282348, num_faces=282790
      Valid probs shape: (37, 39596)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 90573/640000 (14.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=282781, num_faces=282790
      Valid probs shape: (37, 90573)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 84472/640000 (13.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=18, max=282789, num_faces=282790
      Valid probs shape: (37, 84472)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 55290/640000 (8.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7, max=282724, num_faces=282790
      Valid probs shape: (37, 55290)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 40823/640000 (6.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=79382, max=282789, num_faces=282790
      Valid probs shape: (37, 40823)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 58701/640000 (9.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=145, max=282787, num_faces=282790
      Valid probs shape: (37, 58701)
    P stats: min=0.0000, max=1.0000, mean=0.0193
    Non-zero vertices: 100736/141397
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 40661   785   917  2607     0  1387   904  3883  4584]
  Ground Truth Stats:
    Labels shape: (141397,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-19/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6791
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8382
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8383

  RESULTS:
  RAW:         median(top-10)=0.8304, mean(top-10)=0.8325, median(all)=0.7271, mean(all)=0.6791
  + SMOOTHING: median(top-10)=0.9260, mean(top-10)=0.9280, median(all)=0.8782, mean(all)=0.8382 [+0.0956]
  + MRF:       median(top-10)=0.9264, mean(top-10)=0.9281, median(all)=0.8778, mean(all)=0.8383 [+0.0004]
  TOTAL IMPROVEMENT (median top-10): +0.0960

================================================================================
Subject: NKI-RS-22-2
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 137791 vertices, 275578 faces
  Rendering 6 views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 137791 vertices, 275578 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (41713 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (98370 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (91177 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (59941 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (42811 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (64305 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 41713/640000 (6.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=275020, num_faces=275578
      Valid probs shape: (37, 41713)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 98370/640000 (15.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8, max=275479, num_faces=275578
      Valid probs shape: (37, 98370)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 91177/640000 (14.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=10, max=275577, num_faces=275578
      Valid probs shape: (37, 91177)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 59941/640000 (9.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=17, max=275574, num_faces=275578
      Valid probs shape: (37, 59941)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 42811/640000 (6.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=84363, max=275571, num_faces=275578
      Valid probs shape: (37, 42811)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 64305/640000 (10.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=220, max=275496, num_faces=275578
      Valid probs shape: (37, 64305)
    P stats: min=0.0000, max=1.0000, mean=0.0194
    Non-zero vertices: 98822/137791
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 38969   724   682  2994     0  1384   940  3836  4906]
  Ground Truth Stats:
    Labels shape: (137791,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-2/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6824
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8234
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8234

  RESULTS:
  RAW:         median(top-10)=0.8011, mean(top-10)=0.8107, median(all)=0.7500, mean(all)=0.6824
  + SMOOTHING: median(top-10)=0.9166, mean(top-10)=0.9180, median(all)=0.8650, mean(all)=0.8234 [+0.1155]
  + MRF:       median(top-10)=0.9171, mean(top-10)=0.9182, median(all)=0.8650, mean(all)=0.8234 [+0.0004]
  TOTAL IMPROVEMENT (median top-10): +0.1159

================================================================================
Subject: NKI-RS-22-20
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 140825 vertices, 281646 faces
  Rendering 6 views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 140825 vertices, 281646 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (46994 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (98993 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (91927 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (64277 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (44569 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (69436 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 46994/640000 (7.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=280536, num_faces=281646
      Valid probs shape: (37, 46994)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 98993/640000 (15.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=281593, num_faces=281646
      Valid probs shape: (37, 98993)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 91927/640000 (14.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=15, max=281543, num_faces=281646
      Valid probs shape: (37, 91927)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 64277/640000 (10.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=281478, num_faces=281646
      Valid probs shape: (37, 64277)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 44569/640000 (7.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=12187, max=281645, num_faces=281646
      Valid probs shape: (37, 44569)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 69436/640000 (10.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=12, max=281644, num_faces=281646
      Valid probs shape: (37, 69436)
    P stats: min=0.0000, max=1.0000, mean=0.0197
    Non-zero vertices: 102843/140825
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 37982   772   749  2921     0  1839   955  3783  5201]
  Ground Truth Stats:
    Labels shape: (140825,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-20/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6816
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8231
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8234

  RESULTS:
  RAW:         median(top-10)=0.8048, mean(top-10)=0.8175, median(all)=0.7358, mean(all)=0.6816
  + SMOOTHING: median(top-10)=0.9176, mean(top-10)=0.9181, median(all)=0.8596, mean(all)=0.8231 [+0.1128]
  + MRF:       median(top-10)=0.9178, mean(top-10)=0.9182, median(all)=0.8592, mean(all)=0.8234 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.1130

================================================================================
Subject: NKI-RS-22-21
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 138920 vertices, 277836 faces
  Rendering 6 views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 138920 vertices, 277836 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (37030 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (91149 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (84535 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (57596 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (38904 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (61445 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 37030/640000 (5.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=277575, num_faces=277836
      Valid probs shape: (37, 37030)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 91149/640000 (14.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=31, max=277833, num_faces=277836
      Valid probs shape: (37, 91149)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 84535/640000 (13.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=50, max=277834, num_faces=277836
      Valid probs shape: (37, 84535)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 57596/640000 (9.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=277102, num_faces=277836
      Valid probs shape: (37, 57596)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 38904/640000 (6.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=88692, max=277835, num_faces=277836
      Valid probs shape: (37, 38904)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 61445/640000 (9.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=151, max=277834, num_faces=277836
      Valid probs shape: (37, 61445)
    P stats: min=0.0000, max=1.0000, mean=0.0195
    Non-zero vertices: 100277/138920
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 38643   841  1186  2941     0  1604   907  4064  4593]
  Ground Truth Stats:
    Labels shape: (138920,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-21/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7023
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8373
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8376

  RESULTS:
  RAW:         median(top-10)=0.8359, mean(top-10)=0.8440, median(all)=0.7439, mean(all)=0.7023
  + SMOOTHING: median(top-10)=0.9147, mean(top-10)=0.9226, median(all)=0.8830, mean(all)=0.8373 [+0.0788]
  + MRF:       median(top-10)=0.9153, mean(top-10)=0.9227, median(all)=0.8834, mean(all)=0.8376 [+0.0005]
  TOTAL IMPROVEMENT (median top-10): +0.0794

================================================================================
Subject: NKI-RS-22-22
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 129976 vertices, 259948 faces
  Rendering 6 views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 129976 vertices, 259948 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (40622 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (89596 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (82409 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (60325 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (40560 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (63598 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 40622/640000 (6.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=259591, num_faces=259948
      Valid probs shape: (37, 40622)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 89596/640000 (14.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=17, max=259946, num_faces=259948
      Valid probs shape: (37, 89596)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 82409/640000 (12.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=259938, num_faces=259948
      Valid probs shape: (37, 82409)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 60325/640000 (9.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=19, max=258566, num_faces=259948
      Valid probs shape: (37, 60325)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 40560/640000 (6.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=9361, max=259946, num_faces=259948
      Valid probs shape: (37, 40560)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 63598/640000 (9.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=259946, num_faces=259948
      Valid probs shape: (37, 63598)
    P stats: min=0.0000, max=1.0000, mean=0.0196
    Non-zero vertices: 94232/129976
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 35744   708   674  2942     0  1527   941  3841  3933]
  Ground Truth Stats:
    Labels shape: (129976,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-22/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6935
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8430
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8431

  RESULTS:
  RAW:         median(top-10)=0.8341, mean(top-10)=0.8469, median(all)=0.7643, mean(all)=0.6935
  + SMOOTHING: median(top-10)=0.9368, mean(top-10)=0.9375, median(all)=0.8858, mean(all)=0.8430 [+0.1027]
  + MRF:       median(top-10)=0.9370, mean(top-10)=0.9378, median(all)=0.8860, mean(all)=0.8431 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.1029

================================================================================
Subject: NKI-RS-22-3
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 136714 vertices, 273424 faces
  Rendering 6 views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 136714 vertices, 273424 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (45893 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (104259 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (96665 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (65161 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (46438 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (69652 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 45893/640000 (7.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=273165, num_faces=273424
      Valid probs shape: (37, 45893)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 104259/640000 (16.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=273422, num_faces=273424
      Valid probs shape: (37, 104259)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 96665/640000 (15.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=273373, num_faces=273424
      Valid probs shape: (37, 96665)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 65161/640000 (10.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=11, max=272215, num_faces=273424
      Valid probs shape: (37, 65161)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 46438/640000 (7.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=80834, max=273421, num_faces=273424
      Valid probs shape: (37, 46438)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 69652/640000 (10.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=72, max=273373, num_faces=273424
      Valid probs shape: (37, 69652)
    P stats: min=0.0000, max=1.0000, mean=0.0192
    Non-zero vertices: 97168/136714
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 39546   741  1001  2895     0  2016   871  3693  5699]
  Ground Truth Stats:
    Labels shape: (136714,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-3/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6937
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8371
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8373

  RESULTS:
  RAW:         median(top-10)=0.8232, mean(top-10)=0.8277, median(all)=0.7428, mean(all)=0.6937
  + SMOOTHING: median(top-10)=0.9135, mean(top-10)=0.9164, median(all)=0.8750, mean(all)=0.8371 [+0.0902]
  + MRF:       median(top-10)=0.9134, mean(top-10)=0.9166, median(all)=0.8746, mean(all)=0.8373 [-0.0000]
  TOTAL IMPROVEMENT (median top-10): +0.0902

================================================================================
Subject: NKI-RS-22-4
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 169171 vertices, 338338 faces
  Rendering 6 views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 169171 vertices, 338338 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (42245 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (96402 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (89504 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (58527 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (43508 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (61307 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 42245/640000 (6.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=338014, num_faces=338338
      Valid probs shape: (37, 42245)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 96402/640000 (15.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=13, max=338337, num_faces=338338
      Valid probs shape: (37, 96402)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 89504/640000 (14.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=23, max=338334, num_faces=338338
      Valid probs shape: (37, 89504)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 58527/640000 (9.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=338292, num_faces=338338
      Valid probs shape: (37, 58527)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 43508/640000 (6.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=58771, max=338337, num_faces=338338
      Valid probs shape: (37, 43508)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 61307/640000 (9.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=26, max=338337, num_faces=338338
      Valid probs shape: (37, 61307)
    P stats: min=0.0000, max=1.0000, mean=0.0193
    Non-zero vertices: 120918/169171
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 48253   558   859  3382     0  2367   945  4128  5549]
  Ground Truth Stats:
    Labels shape: (169171,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-4/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6657
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8085
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8087

  RESULTS:
  RAW:         median(top-10)=0.7998, mean(top-10)=0.8100, median(all)=0.7336, mean(all)=0.6657
  + SMOOTHING: median(top-10)=0.9108, mean(top-10)=0.9164, median(all)=0.8602, mean(all)=0.8085 [+0.1111]
  + MRF:       median(top-10)=0.9109, mean(top-10)=0.9167, median(all)=0.8602, mean(all)=0.8087 [+0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.1111

================================================================================
Subject: NKI-RS-22-5
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 138967 vertices, 277930 faces
  Rendering 6 views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 138967 vertices, 277930 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (38796 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (94455 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (87120 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (61512 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (43181 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (64778 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 38796/640000 (6.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=277611, num_faces=277930
      Valid probs shape: (37, 38796)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 94455/640000 (14.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=277917, num_faces=277930
      Valid probs shape: (37, 94455)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 87120/640000 (13.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=46, max=277927, num_faces=277930
      Valid probs shape: (37, 87120)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 61512/640000 (9.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=12, max=277686, num_faces=277930
      Valid probs shape: (37, 61512)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 43181/640000 (6.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=78802, max=277861, num_faces=277930
      Valid probs shape: (37, 43181)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 64778/640000 (10.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=35, max=277926, num_faces=277930
      Valid probs shape: (37, 64778)
    P stats: min=0.0000, max=1.0000, mean=0.0197
    Non-zero vertices: 101203/138967
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 37764  1014   739  3006     0  1545  1029  3880  3780]
  Ground Truth Stats:
    Labels shape: (138967,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-5/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6760
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8055
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8056

  RESULTS:
  RAW:         median(top-10)=0.8318, mean(top-10)=0.8325, median(all)=0.7336, mean(all)=0.6760
  + SMOOTHING: median(top-10)=0.9120, mean(top-10)=0.9148, median(all)=0.8503, mean(all)=0.8055 [+0.0802]
  + MRF:       median(top-10)=0.9122, mean(top-10)=0.9150, median(all)=0.8512, mean(all)=0.8056 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0804

================================================================================
Subject: NKI-RS-22-6
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 185380 vertices, 370756 faces
  Rendering 6 views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 185380 vertices, 370756 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (37975 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (94997 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (87741 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (58267 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (37683 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (61644 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 37975/640000 (5.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=368665, num_faces=370756
      Valid probs shape: (37, 37975)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 94997/640000 (14.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=370715, num_faces=370756
      Valid probs shape: (37, 94997)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 87741/640000 (13.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=15, max=370751, num_faces=370756
      Valid probs shape: (37, 87741)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 58267/640000 (9.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=10, max=370749, num_faces=370756
      Valid probs shape: (37, 58267)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 37683/640000 (5.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=11526, max=370755, num_faces=370756
      Valid probs shape: (37, 37683)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 61644/640000 (9.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=159, max=370715, num_faces=370756
      Valid probs shape: (37, 61644)
    P stats: min=0.0000, max=1.0000, mean=0.0184
    Non-zero vertices: 126450/185380
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 58930   900  1327  3434     0  2211  1015  5567  6328]
  Ground Truth Stats:
    Labels shape: (185380,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-6/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6584
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8174
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8177

  RESULTS:
  RAW:         median(top-10)=0.8225, mean(top-10)=0.8210, median(all)=0.7136, mean(all)=0.6584
  + SMOOTHING: median(top-10)=0.9233, mean(top-10)=0.9244, median(all)=0.8719, mean(all)=0.8174 [+0.1008]
  + MRF:       median(top-10)=0.9233, mean(top-10)=0.9245, median(all)=0.8734, mean(all)=0.8177 [+0.0000]
  TOTAL IMPROVEMENT (median top-10): +0.1008

================================================================================
Subject: NKI-RS-22-7
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 153181 vertices, 306358 faces
  Rendering 6 views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 153181 vertices, 306358 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (45703 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (113298 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (105058 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (65545 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (45870 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (68386 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 45703/640000 (7.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=303782, num_faces=306358
      Valid probs shape: (37, 45703)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 113298/640000 (17.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=306250, num_faces=306358
      Valid probs shape: (37, 113298)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 105058/640000 (16.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=15, max=306353, num_faces=306358
      Valid probs shape: (37, 105058)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 65545/640000 (10.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=12, max=306357, num_faces=306358
      Valid probs shape: (37, 65545)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 45870/640000 (7.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=23996, max=306357, num_faces=306358
      Valid probs shape: (37, 45870)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 68386/640000 (10.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=679, max=306159, num_faces=306358
      Valid probs shape: (37, 68386)
    P stats: min=0.0000, max=1.0000, mean=0.0194
    Non-zero vertices: 109791/153181
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 43390   840   883  3788     0  2024   853  4014  4074]
  Ground Truth Stats:
    Labels shape: (153181,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-7/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6826
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8199
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8199

  RESULTS:
  RAW:         median(top-10)=0.8103, mean(top-10)=0.8204, median(all)=0.7411, mean(all)=0.6826
  + SMOOTHING: median(top-10)=0.9177, mean(top-10)=0.9179, median(all)=0.8741, mean(all)=0.8199 [+0.1074]
  + MRF:       median(top-10)=0.9179, mean(top-10)=0.9180, median(all)=0.8737, mean(all)=0.8199 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.1076

================================================================================
Subject: NKI-RS-22-8
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 158049 vertices, 316094 faces
  Rendering 6 views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 158049 vertices, 316094 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (45236 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (103105 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (95107 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (59871 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (41772 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (63833 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 45236/640000 (7.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=314971, num_faces=316094
      Valid probs shape: (37, 45236)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 103105/640000 (16.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=10, max=315966, num_faces=316094
      Valid probs shape: (37, 103105)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 95107/640000 (14.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=316092, num_faces=316094
      Valid probs shape: (37, 95107)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 59871/640000 (9.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7, max=315774, num_faces=316094
      Valid probs shape: (37, 59871)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 41772/640000 (6.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=9468, max=316093, num_faces=316094
      Valid probs shape: (37, 41772)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 63833/640000 (10.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=47, max=316093, num_faces=316094
      Valid probs shape: (37, 63833)
    P stats: min=0.0000, max=1.0000, mean=0.0195
    Non-zero vertices: 114321/158049
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 43728   693   831  3312     0  2410  1106  3694  5144]
  Ground Truth Stats:
    Labels shape: (158049,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-8/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6841
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8318
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8320

  RESULTS:
  RAW:         median(top-10)=0.8149, mean(top-10)=0.8225, median(all)=0.7478, mean(all)=0.6841
  + SMOOTHING: median(top-10)=0.9239, mean(top-10)=0.9268, median(all)=0.8553, mean(all)=0.8318 [+0.1090]
  + MRF:       median(top-10)=0.9246, mean(top-10)=0.9272, median(all)=0.8554, mean(all)=0.8320 [+0.0007]
  TOTAL IMPROVEMENT (median top-10): +0.1097

================================================================================
Subject: NKI-RS-22-9
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 129746 vertices, 259488 faces
  Rendering 6 views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 129746 vertices, 259488 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (37843 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (95155 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (88008 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (57170 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (39294 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (60501 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 37843/640000 (5.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=258930, num_faces=259488
      Valid probs shape: (37, 37843)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 95155/640000 (14.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=22, max=259427, num_faces=259488
      Valid probs shape: (37, 95155)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 88008/640000 (13.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=9, max=259485, num_faces=259488
      Valid probs shape: (37, 88008)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 57170/640000 (8.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=259482, num_faces=259488
      Valid probs shape: (37, 57170)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 39294/640000 (6.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=12570, max=259486, num_faces=259488
      Valid probs shape: (37, 39294)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 60501/640000 (9.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=54, max=259438, num_faces=259488
      Valid probs shape: (37, 60501)
    P stats: min=0.0000, max=1.0000, mean=0.0198
    Non-zero vertices: 94822/129746
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 34924   720   651  2499     0  1715   999  3480  4630]
  Ground Truth Stats:
    Labels shape: (129746,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-9/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6877
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8285
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8287

  RESULTS:
  RAW:         median(top-10)=0.8171, mean(top-10)=0.8274, median(all)=0.7623, mean(all)=0.6877
  + SMOOTHING: median(top-10)=0.9165, mean(top-10)=0.9195, median(all)=0.8498, mean(all)=0.8285 [+0.0994]
  + MRF:       median(top-10)=0.9163, mean(top-10)=0.9197, median(all)=0.8507, mean(all)=0.8287 [-0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0992

================================================================================
Subject: NKI-TRT-20-1
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 143932 vertices, 287860 faces
  Rendering 6 views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 143932 vertices, 287860 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (67888 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (137970 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (126140 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (80166 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (63930 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (83159 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 67888/640000 (10.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=286822, num_faces=287860
      Valid probs shape: (37, 67888)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 137970/640000 (21.6%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=1, max=287850, num_faces=287860
      Valid probs shape: (37, 137970)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 126140/640000 (19.7%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=2, max=287856, num_faces=287860
      Valid probs shape: (37, 126140)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 80166/640000 (12.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=11, max=287857, num_faces=287860
      Valid probs shape: (37, 80166)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 63930/640000 (10.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5447, max=287859, num_faces=287860
      Valid probs shape: (37, 63930)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 83159/640000 (13.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=231, max=287858, num_faces=287860
      Valid probs shape: (37, 83159)
    P stats: min=0.0000, max=1.0000, mean=0.0197
    Non-zero vertices: 104887/143932
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 39045   668   872  2843     0  1399   845  3353  5255]
  Ground Truth Stats:
    Labels shape: (143932,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-1/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6881
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8370
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8374

  RESULTS:
  RAW:         median(top-10)=0.8243, mean(top-10)=0.8256, median(all)=0.7215, mean(all)=0.6881
  + SMOOTHING: median(top-10)=0.9179, mean(top-10)=0.9247, median(all)=0.8632, mean(all)=0.8370 [+0.0936]
  + MRF:       median(top-10)=0.9183, mean(top-10)=0.9250, median(all)=0.8631, mean(all)=0.8374 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0940

================================================================================
Subject: NKI-TRT-20-10
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 122978 vertices, 245952 faces
  Rendering 6 views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 122978 vertices, 245952 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (34190 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (85586 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (80586 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (53598 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (34834 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (56948 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 34190/640000 (5.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=245557, num_faces=245952
      Valid probs shape: (37, 34190)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 85586/640000 (13.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=245944, num_faces=245952
      Valid probs shape: (37, 85586)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 80586/640000 (12.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=69, max=245872, num_faces=245952
      Valid probs shape: (37, 80586)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 53598/640000 (8.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7, max=245950, num_faces=245952
      Valid probs shape: (37, 53598)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 34834/640000 (5.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5627, max=245951, num_faces=245952
      Valid probs shape: (37, 34834)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 56948/640000 (8.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=76, max=245951, num_faces=245952
      Valid probs shape: (37, 56948)
    P stats: min=0.0000, max=1.0000, mean=0.0201
    Non-zero vertices: 91659/122978
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 31319   732   562  2384     0  1742   761  3480  4636]
  Ground Truth Stats:
    Labels shape: (122978,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-10/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6955
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8256
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8257

  RESULTS:
  RAW:         median(top-10)=0.8509, mean(top-10)=0.8447, median(all)=0.7459, mean(all)=0.6955
  + SMOOTHING: median(top-10)=0.9180, mean(top-10)=0.9170, median(all)=0.8614, mean(all)=0.8256 [+0.0671]
  + MRF:       median(top-10)=0.9182, mean(top-10)=0.9172, median(all)=0.8614, mean(all)=0.8257 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0673

================================================================================
Subject: NKI-TRT-20-11
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 146103 vertices, 292202 faces
  Rendering 6 views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 146103 vertices, 292202 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (56077 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (114253 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (105159 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (72184 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (52179 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (76746 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 56077/640000 (8.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=290542, num_faces=292202
      Valid probs shape: (37, 56077)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 114253/640000 (17.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=67, max=292199, num_faces=292202
      Valid probs shape: (37, 114253)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 105159/640000 (16.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=31, max=292198, num_faces=292202
      Valid probs shape: (37, 105159)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 72184/640000 (11.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=18, max=292001, num_faces=292202
      Valid probs shape: (37, 72184)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 52179/640000 (8.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=13569, max=292200, num_faces=292202
      Valid probs shape: (37, 52179)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 76746/640000 (12.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=133, max=292138, num_faces=292202
      Valid probs shape: (37, 76746)
    P stats: min=0.0000, max=1.0000, mean=0.0201
    Non-zero vertices: 108571/146103
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 37532   453   833  3359     0  1915  1016  3666  3740]
  Ground Truth Stats:
    Labels shape: (146103,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-11/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6764
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8130
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8131

  RESULTS:
  RAW:         median(top-10)=0.8218, mean(top-10)=0.8279, median(all)=0.7024, mean(all)=0.6764
  + SMOOTHING: median(top-10)=0.9106, mean(top-10)=0.9087, median(all)=0.8518, mean(all)=0.8130 [+0.0888]
  + MRF:       median(top-10)=0.9107, mean(top-10)=0.9088, median(all)=0.8523, mean(all)=0.8131 [+0.0000]
  TOTAL IMPROVEMENT (median top-10): +0.0889

================================================================================
Subject: NKI-TRT-20-12
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 117868 vertices, 235732 faces
  Rendering 6 views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 117868 vertices, 235732 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (52947 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (109775 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (101459 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (68499 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (50808 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (71967 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 52947/640000 (8.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=235274, num_faces=235732
      Valid probs shape: (37, 52947)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 109775/640000 (17.2%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=14, max=235538, num_faces=235732
      Valid probs shape: (37, 109775)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 101459/640000 (15.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=8, max=235731, num_faces=235732
      Valid probs shape: (37, 101459)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 68499/640000 (10.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=56, max=235591, num_faces=235732
      Valid probs shape: (37, 68499)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 50808/640000 (7.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5282, max=235731, num_faces=235732
      Valid probs shape: (37, 50808)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 71967/640000 (11.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=14, max=235731, num_faces=235732
      Valid probs shape: (37, 71967)
    P stats: min=0.0000, max=1.0000, mean=0.0205
    Non-zero vertices: 89437/117868
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 28431   457   645  2665     0  2044   856  3114  4231]
  Ground Truth Stats:
    Labels shape: (117868,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-12/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6933
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8196
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8197

  RESULTS:
  RAW:         median(top-10)=0.8483, mean(top-10)=0.8526, median(all)=0.7591, mean(all)=0.6933
  + SMOOTHING: median(top-10)=0.9059, mean(top-10)=0.9168, median(all)=0.8721, mean(all)=0.8196 [+0.0577]
  + MRF:       median(top-10)=0.9063, mean(top-10)=0.9170, median(all)=0.8727, mean(all)=0.8197 [+0.0004]
  TOTAL IMPROVEMENT (median top-10): +0.0580

================================================================================
Subject: NKI-TRT-20-13
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 168760 vertices, 337516 faces
  Rendering 6 views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 168760 vertices, 337516 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (44960 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (106173 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (97807 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (61870 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (40673 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (67331 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 44960/640000 (7.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=335666, num_faces=337516
      Valid probs shape: (37, 44960)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 106173/640000 (16.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=337515, num_faces=337516
      Valid probs shape: (37, 106173)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 97807/640000 (15.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=337504, num_faces=337516
      Valid probs shape: (37, 97807)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 61870/640000 (9.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=19, max=337513, num_faces=337516
      Valid probs shape: (37, 61870)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 40673/640000 (6.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3422, max=337515, num_faces=337516
      Valid probs shape: (37, 40673)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 67331/640000 (10.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=337514, num_faces=337516
      Valid probs shape: (37, 67331)
    P stats: min=0.0000, max=1.0000, mean=0.0190
    Non-zero vertices: 118673/168760
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 50087  1123  1474  3699     0  2012   961  3876  5768]
  Ground Truth Stats:
    Labels shape: (168760,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-13/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6746
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8286
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8286

  RESULTS:
  RAW:         median(top-10)=0.8334, mean(top-10)=0.8269, median(all)=0.7342, mean(all)=0.6746
  + SMOOTHING: median(top-10)=0.9298, mean(top-10)=0.9283, median(all)=0.8791, mean(all)=0.8286 [+0.0964]
  + MRF:       median(top-10)=0.9298, mean(top-10)=0.9285, median(all)=0.8790, mean(all)=0.8286 [+0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0965

================================================================================
Subject: NKI-TRT-20-14
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 142909 vertices, 285814 faces
  Rendering 6 views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 142909 vertices, 285814 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (38361 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (89283 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (82643 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (57466 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (38597 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (61279 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 38361/640000 (6.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=285292, num_faces=285814
      Valid probs shape: (37, 38361)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 89283/640000 (14.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=285812, num_faces=285814
      Valid probs shape: (37, 89283)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 82643/640000 (12.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7, max=285807, num_faces=285814
      Valid probs shape: (37, 82643)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 57466/640000 (9.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6, max=284740, num_faces=285814
      Valid probs shape: (37, 57466)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 38597/640000 (6.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=33050, max=285813, num_faces=285814
      Valid probs shape: (37, 38597)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 61279/640000 (9.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=11, max=285813, num_faces=285814
      Valid probs shape: (37, 61279)
    P stats: min=0.0000, max=1.0000, mean=0.0195
    Non-zero vertices: 102852/142909
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 40057   739   904  2582     0  1867  1012  3720  5502]
  Ground Truth Stats:
    Labels shape: (142909,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-14/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6887
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8364
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8367

  RESULTS:
  RAW:         median(top-10)=0.8398, mean(top-10)=0.8426, median(all)=0.7423, mean(all)=0.6887
  + SMOOTHING: median(top-10)=0.9425, mean(top-10)=0.9376, median(all)=0.8876, mean(all)=0.8364 [+0.1028]
  + MRF:       median(top-10)=0.9425, mean(top-10)=0.9378, median(all)=0.8879, mean(all)=0.8367 [+0.0000]
  TOTAL IMPROVEMENT (median top-10): +0.1028

================================================================================
Subject: NKI-TRT-20-15
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 133351 vertices, 266698 faces
  Rendering 6 views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 133351 vertices, 266698 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (52553 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (117608 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (108238 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (67884 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (48951 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (72211 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 52553/640000 (8.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=264940, num_faces=266698
      Valid probs shape: (37, 52553)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 117608/640000 (18.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=40, max=266697, num_faces=266698
      Valid probs shape: (37, 117608)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 108238/640000 (16.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=266694, num_faces=266698
      Valid probs shape: (37, 108238)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 67884/640000 (10.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=36, max=266694, num_faces=266698
      Valid probs shape: (37, 67884)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 48951/640000 (7.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5986, max=266697, num_faces=266698
      Valid probs shape: (37, 48951)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 72211/640000 (11.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=15, max=266663, num_faces=266698
      Valid probs shape: (37, 72211)
    P stats: min=0.0000, max=1.0000, mean=0.0199
    Non-zero vertices: 98005/133351
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 35346   604   856  2953     0  1260   745  4080  4174]
  Ground Truth Stats:
    Labels shape: (133351,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-15/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
    MRF iteration 5/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6918
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8312
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8314

  RESULTS:
  RAW:         median(top-10)=0.8214, mean(top-10)=0.8305, median(all)=0.7369, mean(all)=0.6918
  + SMOOTHING: median(top-10)=0.9405, mean(top-10)=0.9351, median(all)=0.8674, mean(all)=0.8312 [+0.1190]
  + MRF:       median(top-10)=0.9403, mean(top-10)=0.9352, median(all)=0.8680, mean(all)=0.8314 [-0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.1189

================================================================================
Subject: NKI-TRT-20-16
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 157852 vertices, 315700 faces
  Rendering 6 views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 157852 vertices, 315700 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (46602 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (102366 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (94297 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (62479 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (43111 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (65928 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 46602/640000 (7.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=17, max=313592, num_faces=315700
      Valid probs shape: (37, 46602)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 102366/640000 (16.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=315625, num_faces=315700
      Valid probs shape: (37, 102366)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 94297/640000 (14.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=120, max=315698, num_faces=315700
      Valid probs shape: (37, 94297)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 62479/640000 (9.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=23, max=315554, num_faces=315700
      Valid probs shape: (37, 62479)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 43111/640000 (6.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=11363, max=315698, num_faces=315700
      Valid probs shape: (37, 43111)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 65928/640000 (10.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=18, max=315699, num_faces=315700
      Valid probs shape: (37, 65928)
    P stats: min=0.0000, max=1.0000, mean=0.0198
    Non-zero vertices: 115920/157852
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 41932   836   907  3601     0  1649   874  4380  5056]
  Ground Truth Stats:
    Labels shape: (157852,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-16/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6916
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8311
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8313

  RESULTS:
  RAW:         median(top-10)=0.8227, mean(top-10)=0.8307, median(all)=0.7759, mean(all)=0.6916
  + SMOOTHING: median(top-10)=0.9184, mean(top-10)=0.9195, median(all)=0.8871, mean(all)=0.8311 [+0.0957]
  + MRF:       median(top-10)=0.9185, mean(top-10)=0.9196, median(all)=0.8870, mean(all)=0.8313 [+0.0000]
  TOTAL IMPROVEMENT (median top-10): +0.0958

================================================================================
Subject: NKI-TRT-20-17
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 135896 vertices, 271788 faces
  Rendering 6 views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 135896 vertices, 271788 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (39906 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (91766 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (85085 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (62551 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (41247 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (65301 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 39906/640000 (6.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=271433, num_faces=271788
      Valid probs shape: (37, 39906)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 91766/640000 (14.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=271787, num_faces=271788
      Valid probs shape: (37, 91766)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 85085/640000 (13.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=271719, num_faces=271788
      Valid probs shape: (37, 85085)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 62551/640000 (9.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=271717, num_faces=271788
      Valid probs shape: (37, 62551)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 41247/640000 (6.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=69015, max=271785, num_faces=271788
      Valid probs shape: (37, 41247)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 65301/640000 (10.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=91, max=271787, num_faces=271788
      Valid probs shape: (37, 65301)
    P stats: min=0.0000, max=1.0000, mean=0.0195
    Non-zero vertices: 97942/135896
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 37954   564  1080  2375     0  1570   875  3920  4335]
  Ground Truth Stats:
    Labels shape: (135896,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-17/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6755
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8075
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8076

  RESULTS:
  RAW:         median(top-10)=0.8505, mean(top-10)=0.8417, median(all)=0.7421, mean(all)=0.6755
  + SMOOTHING: median(top-10)=0.9331, mean(top-10)=0.9331, median(all)=0.8743, mean(all)=0.8075 [+0.0826]
  + MRF:       median(top-10)=0.9333, mean(top-10)=0.9334, median(all)=0.8746, mean(all)=0.8076 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0828

================================================================================
Subject: NKI-TRT-20-18
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 132036 vertices, 264068 faces
  Rendering 6 views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 132036 vertices, 264068 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (46068 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (105884 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (98544 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (64160 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (44177 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (69284 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 46068/640000 (7.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=262706, num_faces=264068
      Valid probs shape: (37, 46068)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 105884/640000 (16.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=11, max=264062, num_faces=264068
      Valid probs shape: (37, 105884)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 98544/640000 (15.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=110, max=264066, num_faces=264068
      Valid probs shape: (37, 98544)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 64160/640000 (10.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=31, max=263811, num_faces=264068
      Valid probs shape: (37, 64160)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 44177/640000 (6.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5409, max=264064, num_faces=264068
      Valid probs shape: (37, 44177)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 69284/640000 (10.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=26, max=264065, num_faces=264068
      Valid probs shape: (37, 69284)
    P stats: min=0.0000, max=1.0000, mean=0.0203
    Non-zero vertices: 98943/132036
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 33093   812   826  2977     0  1546   906  3615  4718]
  Ground Truth Stats:
    Labels shape: (132036,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-18/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7006
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8344
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8347

  RESULTS:
  RAW:         median(top-10)=0.8246, mean(top-10)=0.8281, median(all)=0.7555, mean(all)=0.7006
  + SMOOTHING: median(top-10)=0.9262, mean(top-10)=0.9237, median(all)=0.8680, mean(all)=0.8344 [+0.1016]
  + MRF:       median(top-10)=0.9267, mean(top-10)=0.9240, median(all)=0.8680, mean(all)=0.8347 [+0.0005]
  TOTAL IMPROVEMENT (median top-10): +0.1021

================================================================================
Subject: NKI-TRT-20-19
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 131542 vertices, 263080 faces
  Rendering 6 views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 131542 vertices, 263080 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (37626 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (86904 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (80874 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (58563 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (36440 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (61386 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 37626/640000 (5.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=11, max=262783, num_faces=263080
      Valid probs shape: (37, 37626)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 86904/640000 (13.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7, max=263016, num_faces=263080
      Valid probs shape: (37, 86904)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 80874/640000 (12.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=263070, num_faces=263080
      Valid probs shape: (37, 80874)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 58563/640000 (9.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=15, max=262998, num_faces=263080
      Valid probs shape: (37, 58563)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 36440/640000 (5.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=75068, max=263079, num_faces=263080
      Valid probs shape: (37, 36440)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 61386/640000 (9.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=120, max=263078, num_faces=263080
      Valid probs shape: (37, 61386)
    P stats: min=0.0000, max=1.0000, mean=0.0197
    Non-zero vertices: 95946/131542
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 35596   759   817  2352     0  1381   907  3664  4473]
  Ground Truth Stats:
    Labels shape: (131542,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-19/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6899
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8330
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8329

  RESULTS:
  RAW:         median(top-10)=0.8285, mean(top-10)=0.8315, median(all)=0.7374, mean(all)=0.6899
  + SMOOTHING: median(top-10)=0.9282, mean(top-10)=0.9313, median(all)=0.8724, mean(all)=0.8330 [+0.0998]
  + MRF:       median(top-10)=0.9284, mean(top-10)=0.9314, median(all)=0.8728, mean(all)=0.8329 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0999

================================================================================
Subject: NKI-TRT-20-2
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 174172 vertices, 348340 faces
  Rendering 6 views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 174172 vertices, 348340 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (39346 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (91664 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (85308 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (57480 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (40244 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (61084 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 39346/640000 (6.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=347747, num_faces=348340
      Valid probs shape: (37, 39346)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 91664/640000 (14.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=13, max=348273, num_faces=348340
      Valid probs shape: (37, 91664)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 85308/640000 (13.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=10, max=348339, num_faces=348340
      Valid probs shape: (37, 85308)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 57480/640000 (9.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=13, max=347576, num_faces=348340
      Valid probs shape: (37, 57480)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 40244/640000 (6.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7161, max=348339, num_faces=348340
      Valid probs shape: (37, 40244)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 61084/640000 (9.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=37, max=348339, num_faces=348340
      Valid probs shape: (37, 61084)
    P stats: min=0.0000, max=1.0000, mean=0.0185
    Non-zero vertices: 119269/174172
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 54903  1129  1091  3814     0  1856  1034  4637  6662]
  Ground Truth Stats:
    Labels shape: (174172,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-2/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6607
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8247
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8249

  RESULTS:
  RAW:         median(top-10)=0.7882, mean(top-10)=0.7989, median(all)=0.7298, mean(all)=0.6607
  + SMOOTHING: median(top-10)=0.9140, mean(top-10)=0.9159, median(all)=0.8738, mean(all)=0.8247 [+0.1258]
  + MRF:       median(top-10)=0.9161, mean(top-10)=0.9164, median(all)=0.8740, mean(all)=0.8249 [+0.0021]
  TOTAL IMPROVEMENT (median top-10): +0.1279

================================================================================
Subject: NKI-TRT-20-20
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 147840 vertices, 295676 faces
  Rendering 6 views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 147840 vertices, 295676 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (57883 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (120896 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (110660 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (74517 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (51800 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (79035 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 57883/640000 (9.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=292902, num_faces=295676
      Valid probs shape: (37, 57883)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 120896/640000 (18.9%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=34, max=295668, num_faces=295676
      Valid probs shape: (37, 120896)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 110660/640000 (17.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=20, max=295675, num_faces=295676
      Valid probs shape: (37, 110660)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 74517/640000 (11.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=97, max=295650, num_faces=295676
      Valid probs shape: (37, 74517)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 51800/640000 (8.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=10504, max=295675, num_faces=295676
      Valid probs shape: (37, 51800)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 79035/640000 (12.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=31, max=295675, num_faces=295676
      Valid probs shape: (37, 79035)
    P stats: min=0.0000, max=1.0000, mean=0.0196
    Non-zero vertices: 107451/147840
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 40389  1057   907  3368     0  1532   805  3811  3629]
  Ground Truth Stats:
    Labels shape: (147840,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-20/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7037
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8442
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8444

  RESULTS:
  RAW:         median(top-10)=0.8234, mean(top-10)=0.8356, median(all)=0.7605, mean(all)=0.7037
  + SMOOTHING: median(top-10)=0.9305, mean(top-10)=0.9330, median(all)=0.8842, mean(all)=0.8442 [+0.1072]
  + MRF:       median(top-10)=0.9307, mean(top-10)=0.9331, median(all)=0.8844, mean(all)=0.8444 [+0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.1073

================================================================================
Subject: NKI-TRT-20-3
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 123781 vertices, 247558 faces
  Rendering 6 views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 123781 vertices, 247558 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (57423 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (119159 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (109764 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (73742 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (55403 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (77075 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 57423/640000 (9.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=245403, num_faces=247558
      Valid probs shape: (37, 57423)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 119159/640000 (18.6%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=39, max=247553, num_faces=247558
      Valid probs shape: (37, 119159)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 109764/640000 (17.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=13, max=247557, num_faces=247558
      Valid probs shape: (37, 109764)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 73742/640000 (11.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=40, max=245384, num_faces=247558
      Valid probs shape: (37, 73742)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 55403/640000 (8.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=12715, max=247557, num_faces=247558
      Valid probs shape: (37, 55403)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 77075/640000 (12.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=32, max=247557, num_faces=247558
      Valid probs shape: (37, 77075)
    P stats: min=0.0000, max=1.0000, mean=0.0199
    Non-zero vertices: 90946/123781
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 32835   666   759  2766     0  1517   707  3610  3969]
  Ground Truth Stats:
    Labels shape: (123781,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-3/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6956
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8293
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8297

  RESULTS:
  RAW:         median(top-10)=0.8197, mean(top-10)=0.8211, median(all)=0.7322, mean(all)=0.6956
  + SMOOTHING: median(top-10)=0.9231, mean(top-10)=0.9225, median(all)=0.8828, mean(all)=0.8293 [+0.1034]
  + MRF:       median(top-10)=0.9238, mean(top-10)=0.9228, median(all)=0.8832, mean(all)=0.8297 [+0.0006]
  TOTAL IMPROVEMENT (median top-10): +0.1040

================================================================================
Subject: NKI-TRT-20-4
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 158207 vertices, 316410 faces
  Rendering 6 views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 158207 vertices, 316410 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (56591 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (115124 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (104032 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (73926 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (53553 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (76147 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 56591/640000 (8.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=313958, num_faces=316410
      Valid probs shape: (37, 56591)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 115124/640000 (18.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=10, max=316409, num_faces=316410
      Valid probs shape: (37, 115124)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 104032/640000 (16.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=21, max=316396, num_faces=316410
      Valid probs shape: (37, 104032)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 73926/640000 (11.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=17, max=316407, num_faces=316410
      Valid probs shape: (37, 73926)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 53553/640000 (8.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5376, max=316408, num_faces=316410
      Valid probs shape: (37, 53553)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 76147/640000 (11.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=30, max=316396, num_faces=316410
      Valid probs shape: (37, 76147)
    P stats: min=0.0000, max=1.0000, mean=0.0190
    Non-zero vertices: 110945/158207
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 47262   767   882  3006     0  2135   923  4360  4791]
  Ground Truth Stats:
    Labels shape: (158207,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-4/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6639
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8150
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8152

  RESULTS:
  RAW:         median(top-10)=0.8107, mean(top-10)=0.8142, median(all)=0.7163, mean(all)=0.6639
  + SMOOTHING: median(top-10)=0.9123, mean(top-10)=0.9106, median(all)=0.8623, mean(all)=0.8150 [+0.1016]
  + MRF:       median(top-10)=0.9126, mean(top-10)=0.9107, median(all)=0.8633, mean(all)=0.8152 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.1018

================================================================================
Subject: NKI-TRT-20-5
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 137753 vertices, 275502 faces
  Rendering 6 views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 137753 vertices, 275502 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (45787 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (103903 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (96260 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (64915 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (46216 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (69483 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 45787/640000 (7.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=275331, num_faces=275502
      Valid probs shape: (37, 45787)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 103903/640000 (16.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=275501, num_faces=275502
      Valid probs shape: (37, 103903)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 96260/640000 (15.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=275454, num_faces=275502
      Valid probs shape: (37, 96260)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 64915/640000 (10.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=233, max=273940, num_faces=275502
      Valid probs shape: (37, 64915)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 46216/640000 (7.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=81515, max=275498, num_faces=275502
      Valid probs shape: (37, 46216)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 69483/640000 (10.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=89, max=275462, num_faces=275502
      Valid probs shape: (37, 69483)
    P stats: min=0.0000, max=1.0000, mean=0.0191
    Non-zero vertices: 97575/137753
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 40178   762  1043  2852     0  1961   845  3619  5697]
  Ground Truth Stats:
    Labels shape: (137753,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-5/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
    MRF iteration 5/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6983
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8435
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8439

  RESULTS:
  RAW:         median(top-10)=0.8228, mean(top-10)=0.8313, median(all)=0.7379, mean(all)=0.6983
  + SMOOTHING: median(top-10)=0.9185, mean(top-10)=0.9219, median(all)=0.8773, mean(all)=0.8435 [+0.0957]
  + MRF:       median(top-10)=0.9188, mean(top-10)=0.9221, median(all)=0.8775, mean(all)=0.8439 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0960

================================================================================
Subject: NKI-TRT-20-6
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 158025 vertices, 316046 faces
  Rendering 6 views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 158025 vertices, 316046 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (48945 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (109618 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (101944 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (64143 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (46253 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (68278 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 48945/640000 (7.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=313445, num_faces=316046
      Valid probs shape: (37, 48945)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 109618/640000 (17.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=11, max=316043, num_faces=316046
      Valid probs shape: (37, 109618)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 101944/640000 (15.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=316041, num_faces=316046
      Valid probs shape: (37, 101944)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 64143/640000 (10.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=23, max=314903, num_faces=316046
      Valid probs shape: (37, 64143)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 46253/640000 (7.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=9581, max=316045, num_faces=316046
      Valid probs shape: (37, 46253)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 68278/640000 (10.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=14, max=316045, num_faces=316046
      Valid probs shape: (37, 68278)
    P stats: min=0.0000, max=1.0000, mean=0.0197
    Non-zero vertices: 114991/158025
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 43034   934   810  3067     0  1577   916  5113  5935]
  Ground Truth Stats:
    Labels shape: (158025,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-6/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7011
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8520
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8523

  RESULTS:
  RAW:         median(top-10)=0.8274, mean(top-10)=0.8330, median(all)=0.7351, mean(all)=0.7011
  + SMOOTHING: median(top-10)=0.9330, mean(top-10)=0.9289, median(all)=0.8744, mean(all)=0.8520 [+0.1056]
  + MRF:       median(top-10)=0.9328, mean(top-10)=0.9290, median(all)=0.8747, mean(all)=0.8523 [-0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.1054

================================================================================
Subject: NKI-TRT-20-7
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 145017 vertices, 290030 faces
  Rendering 6 views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 145017 vertices, 290030 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (46206 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (100869 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (93314 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (65317 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (45944 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (69009 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 46206/640000 (7.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=287933, num_faces=290030
      Valid probs shape: (37, 46206)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 100869/640000 (15.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=289950, num_faces=290030
      Valid probs shape: (37, 100869)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 93314/640000 (14.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=290029, num_faces=290030
      Valid probs shape: (37, 93314)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 65317/640000 (10.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=288169, num_faces=290030
      Valid probs shape: (37, 65317)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 45944/640000 (7.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=12788, max=290029, num_faces=290030
      Valid probs shape: (37, 45944)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 69009/640000 (10.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=15, max=290021, num_faces=290030
      Valid probs shape: (37, 69009)
    P stats: min=0.0000, max=1.0000, mean=0.0187
    Non-zero vertices: 100151/145017
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 44866   819   790  3340     0  1802   901  3909  4213]
  Ground Truth Stats:
    Labels shape: (145017,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-7/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6636
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8305
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8307

  RESULTS:
  RAW:         median(top-10)=0.8057, mean(top-10)=0.8193, median(all)=0.7088, mean(all)=0.6636
  + SMOOTHING: median(top-10)=0.9180, mean(top-10)=0.9187, median(all)=0.8872, mean(all)=0.8305 [+0.1123]
  + MRF:       median(top-10)=0.9180, mean(top-10)=0.9188, median(all)=0.8872, mean(all)=0.8307 [-0.0000]
  TOTAL IMPROVEMENT (median top-10): +0.1122

================================================================================
Subject: NKI-TRT-20-8
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 147404 vertices, 294804 faces
  Rendering 6 views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 147404 vertices, 294804 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (45232 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (95531 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (89220 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (60469 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (45913 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (65474 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 45232/640000 (7.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=294004, num_faces=294804
      Valid probs shape: (37, 45232)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 95531/640000 (14.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=17, max=294762, num_faces=294804
      Valid probs shape: (37, 95531)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 89220/640000 (13.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=294572, num_faces=294804
      Valid probs shape: (37, 89220)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 60469/640000 (9.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=293206, num_faces=294804
      Valid probs shape: (37, 60469)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 45913/640000 (7.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=9296, max=294773, num_faces=294804
      Valid probs shape: (37, 45913)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 65474/640000 (10.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=10, max=294801, num_faces=294804
      Valid probs shape: (37, 65474)
    P stats: min=0.0000, max=1.0000, mean=0.0193
    Non-zero vertices: 105164/147404
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 42240   900   637  2788     0  1925  1360  4073  5473]
  Ground Truth Stats:
    Labels shape: (147404,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-8/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6585
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7956
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7959

  RESULTS:
  RAW:         median(top-10)=0.7780, mean(top-10)=0.7981, median(all)=0.7278, mean(all)=0.6585
  + SMOOTHING: median(top-10)=0.8989, mean(top-10)=0.9011, median(all)=0.8260, mean(all)=0.7956 [+0.1209]
  + MRF:       median(top-10)=0.8990, mean(top-10)=0.9013, median(all)=0.8266, mean(all)=0.7959 [+0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.1210

================================================================================
Subject: NKI-TRT-20-9
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 141802 vertices, 283600 faces
  Rendering 6 views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 141802 vertices, 283600 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (43920 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (107762 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (100632 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (59095 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (42677 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (64692 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 43920/640000 (6.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=282393, num_faces=283600
      Valid probs shape: (37, 43920)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 107762/640000 (16.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=89, max=283508, num_faces=283600
      Valid probs shape: (37, 107762)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 100632/640000 (15.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=12, max=283593, num_faces=283600
      Valid probs shape: (37, 100632)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 59095/640000 (9.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=31, max=283581, num_faces=283600
      Valid probs shape: (37, 59095)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 42677/640000 (6.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=92555, max=283589, num_faces=283600
      Valid probs shape: (37, 42677)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 64692/640000 (10.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=84, max=283592, num_faces=283600
      Valid probs shape: (37, 64692)
    P stats: min=0.0000, max=1.0000, mean=0.0197
    Non-zero vertices: 103233/141802
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 38569   812   788  2703     0  1778   967  4072  5485]
  Ground Truth Stats:
    Labels shape: (141802,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-9/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6884
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8286
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8290

  RESULTS:
  RAW:         median(top-10)=0.8191, mean(top-10)=0.8330, median(all)=0.7491, mean(all)=0.6884
  + SMOOTHING: median(top-10)=0.9118, mean(top-10)=0.9186, median(all)=0.8748, mean(all)=0.8286 [+0.0926]
  + MRF:       median(top-10)=0.9120, mean(top-10)=0.9190, median(all)=0.8746, mean(all)=0.8290 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0929

================================================================================
Subject: OASIS-TRT-20-1
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 149052 vertices, 298100 faces
  Rendering 6 views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 149052 vertices, 298100 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (34898 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (83452 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (78012 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (55866 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (36923 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (58059 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 34898/640000 (5.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=297991, num_faces=298100
      Valid probs shape: (37, 34898)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 83452/640000 (13.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=298099, num_faces=298100
      Valid probs shape: (37, 83452)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 78012/640000 (12.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=19, max=298098, num_faces=298100
      Valid probs shape: (37, 78012)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 55866/640000 (8.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=298098, num_faces=298100
      Valid probs shape: (37, 55866)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 36923/640000 (5.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=106573, max=298095, num_faces=298100
      Valid probs shape: (37, 36923)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 58059/640000 (9.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6, max=297997, num_faces=298100
      Valid probs shape: (37, 58059)
    P stats: min=0.0000, max=1.0000, mean=0.0198
    Non-zero vertices: 109143/149052
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 39909   744  1014  3487     0  1737   984  4076  5143]
  Ground Truth Stats:
    Labels shape: (149052,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-1/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6927
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8366
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8368

  RESULTS:
  RAW:         median(top-10)=0.8416, mean(top-10)=0.8465, median(all)=0.7488, mean(all)=0.6927
  + SMOOTHING: median(top-10)=0.9267, mean(top-10)=0.9301, median(all)=0.8874, mean(all)=0.8366 [+0.0851]
  + MRF:       median(top-10)=0.9266, mean(top-10)=0.9302, median(all)=0.8873, mean(all)=0.8368 [-0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0850

================================================================================
Subject: OASIS-TRT-20-10
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 129540 vertices, 259076 faces
  Rendering 6 views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 129540 vertices, 259076 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (39211 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (87219 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (80591 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (56268 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (41624 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (60533 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 39211/640000 (6.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=258993, num_faces=259076
      Valid probs shape: (37, 39211)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 87219/640000 (13.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=259070, num_faces=259076
      Valid probs shape: (37, 87219)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 80591/640000 (12.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7, max=259075, num_faces=259076
      Valid probs shape: (37, 80591)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 56268/640000 (8.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=258889, num_faces=259076
      Valid probs shape: (37, 56268)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 41624/640000 (6.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=71807, max=259072, num_faces=259076
      Valid probs shape: (37, 41624)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 60533/640000 (9.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=49, max=258999, num_faces=259076
      Valid probs shape: (37, 60533)
    P stats: min=0.0000, max=1.0000, mean=0.0198
    Non-zero vertices: 94975/129540
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 34565   752   789  3289     0  1918   892  3614  3948]
  Ground Truth Stats:
    Labels shape: (129540,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-10/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6927
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8247
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8250

  RESULTS:
  RAW:         median(top-10)=0.8486, mean(top-10)=0.8517, median(all)=0.7289, mean(all)=0.6927
  + SMOOTHING: median(top-10)=0.9314, mean(top-10)=0.9309, median(all)=0.8672, mean(all)=0.8247 [+0.0828]
  + MRF:       median(top-10)=0.9316, mean(top-10)=0.9310, median(all)=0.8675, mean(all)=0.8250 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0830

================================================================================
Subject: OASIS-TRT-20-11
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 146531 vertices, 293058 faces
  Rendering 6 views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 146531 vertices, 293058 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (41981 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (98450 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (90253 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (58376 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (42979 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (62441 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 41981/640000 (6.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=292530, num_faces=293058
      Valid probs shape: (37, 41981)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 98450/640000 (15.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=293055, num_faces=293058
      Valid probs shape: (37, 98450)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 90253/640000 (14.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=293057, num_faces=293058
      Valid probs shape: (37, 90253)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 58376/640000 (9.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=11, max=291165, num_faces=293058
      Valid probs shape: (37, 58376)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 42979/640000 (6.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=93611, max=293057, num_faces=293058
      Valid probs shape: (37, 42979)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 62441/640000 (9.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=95, max=293057, num_faces=293058
      Valid probs shape: (37, 62441)
    P stats: min=0.0000, max=1.0000, mean=0.0190
    Non-zero vertices: 103089/146531
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 43442   790   791  3273     0  1718   881  3749  5362]
  Ground Truth Stats:
    Labels shape: (146531,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-11/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6830
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8398
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8400

  RESULTS:
  RAW:         median(top-10)=0.8380, mean(top-10)=0.8467, median(all)=0.7355, mean(all)=0.6830
  + SMOOTHING: median(top-10)=0.9339, mean(top-10)=0.9315, median(all)=0.8825, mean(all)=0.8398 [+0.0959]
  + MRF:       median(top-10)=0.9344, mean(top-10)=0.9318, median(all)=0.8829, mean(all)=0.8400 [+0.0005]
  TOTAL IMPROVEMENT (median top-10): +0.0964

================================================================================
Subject: OASIS-TRT-20-12
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 144559 vertices, 289114 faces
  Rendering 6 views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 144559 vertices, 289114 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (36042 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (88037 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (82442 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (54615 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (37958 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (57015 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 36042/640000 (5.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=288909, num_faces=289114
      Valid probs shape: (37, 36042)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 88037/640000 (13.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=10, max=288987, num_faces=289114
      Valid probs shape: (37, 88037)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 82442/640000 (12.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=13, max=289113, num_faces=289114
      Valid probs shape: (37, 82442)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 54615/640000 (8.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=289067, num_faces=289114
      Valid probs shape: (37, 54615)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 37958/640000 (5.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=90761, max=289112, num_faces=289114
      Valid probs shape: (37, 37958)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 57015/640000 (8.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=108, max=289113, num_faces=289114
      Valid probs shape: (37, 57015)
    P stats: min=0.0000, max=1.0000, mean=0.0194
    Non-zero vertices: 103539/144559
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 41020   890   816  2842     0  1155   918  4752  4725]
  Ground Truth Stats:
    Labels shape: (144559,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-12/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6897
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8377
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8377

  RESULTS:
  RAW:         median(top-10)=0.8343, mean(top-10)=0.8413, median(all)=0.7188, mean(all)=0.6897
  + SMOOTHING: median(top-10)=0.9195, mean(top-10)=0.9214, median(all)=0.8853, mean(all)=0.8377 [+0.0852]
  + MRF:       median(top-10)=0.9198, mean(top-10)=0.9214, median(all)=0.8854, mean(all)=0.8377 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0855

================================================================================
Subject: OASIS-TRT-20-13
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 122339 vertices, 244674 faces
  Rendering 6 views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 122339 vertices, 244674 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (45391 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (95734 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (89843 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (58036 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (42510 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (62395 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 45391/640000 (7.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=244285, num_faces=244674
      Valid probs shape: (37, 45391)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 95734/640000 (15.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=29, max=244603, num_faces=244674
      Valid probs shape: (37, 95734)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 89843/640000 (14.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=244671, num_faces=244674
      Valid probs shape: (37, 89843)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 58036/640000 (9.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=18, max=244598, num_faces=244674
      Valid probs shape: (37, 58036)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 42510/640000 (6.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1697, max=244670, num_faces=244674
      Valid probs shape: (37, 42510)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 62395/640000 (9.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=32, max=244673, num_faces=244674
      Valid probs shape: (37, 62395)
    P stats: min=0.0000, max=1.0000, mean=0.0198
    Non-zero vertices: 89756/122339
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 32583   560  1006  2731     0  1288   958  3758  4593]
  Ground Truth Stats:
    Labels shape: (122339,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-13/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7012
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8520
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8522

  RESULTS:
  RAW:         median(top-10)=0.8319, mean(top-10)=0.8417, median(all)=0.7421, mean(all)=0.7012
  + SMOOTHING: median(top-10)=0.9238, mean(top-10)=0.9276, median(all)=0.8826, mean(all)=0.8520 [+0.0919]
  + MRF:       median(top-10)=0.9241, mean(top-10)=0.9276, median(all)=0.8828, mean(all)=0.8522 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0922

================================================================================
Subject: OASIS-TRT-20-14
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 128019 vertices, 256034 faces
  Rendering 6 views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 128019 vertices, 256034 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (39254 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (90095 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (83820 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (57551 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (36944 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (59959 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 39254/640000 (6.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=255840, num_faces=256034
      Valid probs shape: (37, 39254)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 90095/640000 (14.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=17, max=255933, num_faces=256034
      Valid probs shape: (37, 90095)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 83820/640000 (13.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=256030, num_faces=256034
      Valid probs shape: (37, 83820)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 57551/640000 (9.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=34, max=255980, num_faces=256034
      Valid probs shape: (37, 57551)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 36944/640000 (5.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3602, max=256033, num_faces=256034
      Valid probs shape: (37, 36944)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 59959/640000 (9.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=39, max=256030, num_faces=256034
      Valid probs shape: (37, 59959)
    P stats: min=0.0000, max=1.0000, mean=0.0203
    Non-zero vertices: 96015/128019
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 32004   653  1152  2964     0  1380   849  3356  4706]
  Ground Truth Stats:
    Labels shape: (128019,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-14/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7137
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8361
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8362

  RESULTS:
  RAW:         median(top-10)=0.8601, mean(top-10)=0.8583, median(all)=0.7550, mean(all)=0.7137
  + SMOOTHING: median(top-10)=0.9238, mean(top-10)=0.9232, median(all)=0.8729, mean(all)=0.8361 [+0.0638]
  + MRF:       median(top-10)=0.9241, mean(top-10)=0.9232, median(all)=0.8734, mean(all)=0.8362 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0640

================================================================================
Subject: OASIS-TRT-20-15
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 121081 vertices, 242158 faces
  Rendering 6 views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 121081 vertices, 242158 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (37244 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (84927 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (78839 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (49967 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (35868 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (53730 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 37244/640000 (5.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=241986, num_faces=242158
      Valid probs shape: (37, 37244)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 84927/640000 (13.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=8, max=242157, num_faces=242158
      Valid probs shape: (37, 84927)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 78839/640000 (12.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=8, max=242146, num_faces=242158
      Valid probs shape: (37, 78839)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 49967/640000 (7.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=15, max=242153, num_faces=242158
      Valid probs shape: (37, 49967)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 35868/640000 (5.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1858, max=242087, num_faces=242158
      Valid probs shape: (37, 35868)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 53730/640000 (8.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=18, max=242156, num_faces=242158
      Valid probs shape: (37, 53730)
    P stats: min=0.0000, max=1.0000, mean=0.0201
    Non-zero vertices: 90120/121081
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 30961   673   691  2141     0  1310   870  3648  4251]
  Ground Truth Stats:
    Labels shape: (121081,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-15/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6894
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8282
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8283

  RESULTS:
  RAW:         median(top-10)=0.8198, mean(top-10)=0.8299, median(all)=0.7593, mean(all)=0.6894
  + SMOOTHING: median(top-10)=0.9245, mean(top-10)=0.9250, median(all)=0.8505, mean(all)=0.8282 [+0.1047]
  + MRF:       median(top-10)=0.9244, mean(top-10)=0.9250, median(all)=0.8503, mean(all)=0.8283 [-0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.1046

================================================================================
Subject: OASIS-TRT-20-16
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 137726 vertices, 275448 faces
  Rendering 6 views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 137726 vertices, 275448 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (49473 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (114953 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (106146 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (70914 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (49269 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (70829 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 49473/640000 (7.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=273640, num_faces=275448
      Valid probs shape: (37, 49473)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 114953/640000 (18.0%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=2, max=275447, num_faces=275448
      Valid probs shape: (37, 114953)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 106146/640000 (16.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=275443, num_faces=275448
      Valid probs shape: (37, 106146)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 70914/640000 (11.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=275447, num_faces=275448
      Valid probs shape: (37, 70914)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 49269/640000 (7.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=13131, max=275447, num_faces=275448
      Valid probs shape: (37, 49269)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 70829/640000 (11.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=75, max=275343, num_faces=275448
      Valid probs shape: (37, 70829)
    P stats: min=0.0000, max=1.0000, mean=0.0197
    Non-zero vertices: 100584/137726
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 37142   965   748  2721     0  1509   758  4164  5741]
  Ground Truth Stats:
    Labels shape: (137726,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-16/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6892
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8228
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8229

  RESULTS:
  RAW:         median(top-10)=0.8077, mean(top-10)=0.8272, median(all)=0.7499, mean(all)=0.6892
  + SMOOTHING: median(top-10)=0.9181, mean(top-10)=0.9178, median(all)=0.8523, mean(all)=0.8228 [+0.1104]
  + MRF:       median(top-10)=0.9181, mean(top-10)=0.9180, median(all)=0.8515, mean(all)=0.8229 [+0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.1105

================================================================================
Subject: OASIS-TRT-20-17
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 148245 vertices, 296486 faces
  Rendering 6 views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 148245 vertices, 296486 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (51715 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (115408 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (107645 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (68068 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (50659 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (70910 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 51715/640000 (8.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=294676, num_faces=296486
      Valid probs shape: (37, 51715)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 115408/640000 (18.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=10, max=296477, num_faces=296486
      Valid probs shape: (37, 115408)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 107645/640000 (16.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=2, max=296396, num_faces=296486
      Valid probs shape: (37, 107645)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 68068/640000 (10.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=12, max=296430, num_faces=296486
      Valid probs shape: (37, 68068)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 50659/640000 (7.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=8075, max=296485, num_faces=296486
      Valid probs shape: (37, 50659)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 70910/640000 (11.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=50, max=296485, num_faces=296486
      Valid probs shape: (37, 70910)
    P stats: min=0.0000, max=1.0000, mean=0.0197
    Non-zero vertices: 107816/148245
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 40429   850   955  3325     0  1606   922  3546  4485]
  Ground Truth Stats:
    Labels shape: (148245,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-17/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6814
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8224
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8225

  RESULTS:
  RAW:         median(top-10)=0.8162, mean(top-10)=0.8146, median(all)=0.6943, mean(all)=0.6814
  + SMOOTHING: median(top-10)=0.9078, mean(top-10)=0.9050, median(all)=0.8526, mean(all)=0.8224 [+0.0916]
  + MRF:       median(top-10)=0.9080, mean(top-10)=0.9052, median(all)=0.8529, mean(all)=0.8225 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0918

================================================================================
Subject: OASIS-TRT-20-18
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 140676 vertices, 281348 faces
  Rendering 6 views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 140676 vertices, 281348 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (40662 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (87949 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (81536 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (63250 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (38590 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (65363 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 40662/640000 (6.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=280399, num_faces=281348
      Valid probs shape: (37, 40662)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 87949/640000 (13.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=281344, num_faces=281348
      Valid probs shape: (37, 87949)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 81536/640000 (12.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=9, max=281300, num_faces=281348
      Valid probs shape: (37, 81536)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 63250/640000 (9.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=281304, num_faces=281348
      Valid probs shape: (37, 63250)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 38590/640000 (6.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=17190, max=281304, num_faces=281348
      Valid probs shape: (37, 38590)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 65363/640000 (10.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=16, max=281320, num_faces=281348
      Valid probs shape: (37, 65363)
    P stats: min=0.0000, max=1.0000, mean=0.0197
    Non-zero vertices: 102765/140676
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 37911   968   890  2469     0  1650   901  4016  5104]
  Ground Truth Stats:
    Labels shape: (140676,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-18/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6861
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8285
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8287

  RESULTS:
  RAW:         median(top-10)=0.8119, mean(top-10)=0.8264, median(all)=0.7458, mean(all)=0.6861
  + SMOOTHING: median(top-10)=0.9151, mean(top-10)=0.9184, median(all)=0.8561, mean(all)=0.8285 [+0.1032]
  + MRF:       median(top-10)=0.9154, mean(top-10)=0.9185, median(all)=0.8564, mean(all)=0.8287 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.1036

================================================================================
Subject: OASIS-TRT-20-19
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 114731 vertices, 229458 faces
  Rendering 6 views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 114731 vertices, 229458 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (49919 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (108156 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (99940 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (68793 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (45569 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (70695 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 49919/640000 (7.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=196461, num_faces=229458
      Valid probs shape: (37, 49919)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 108156/640000 (16.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=10, max=229407, num_faces=229458
      Valid probs shape: (37, 108156)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 99940/640000 (15.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=229453, num_faces=229458
      Valid probs shape: (37, 99940)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 68793/640000 (10.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=12, max=229450, num_faces=229458
      Valid probs shape: (37, 68793)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 45569/640000 (7.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3859, max=229457, num_faces=229458
      Valid probs shape: (37, 45569)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 70695/640000 (11.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=8, max=229407, num_faces=229458
      Valid probs shape: (37, 70695)
    P stats: min=0.0000, max=1.0000, mean=0.0201
    Non-zero vertices: 85514/114731
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 29217   726   780  2123     0  1446   759  3280  4612]
  Ground Truth Stats:
    Labels shape: (114731,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-19/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6861
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8125
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8129

  RESULTS:
  RAW:         median(top-10)=0.8463, mean(top-10)=0.8505, median(all)=0.7552, mean(all)=0.6861
  + SMOOTHING: median(top-10)=0.9203, mean(top-10)=0.9289, median(all)=0.8518, mean(all)=0.8125 [+0.0741]
  + MRF:       median(top-10)=0.9206, mean(top-10)=0.9292, median(all)=0.8521, mean(all)=0.8129 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0743

================================================================================
Subject: OASIS-TRT-20-2
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 153483 vertices, 306962 faces
  Rendering 6 views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 153483 vertices, 306962 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (39581 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (99182 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (92163 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (61992 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (39869 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (64109 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 39581/640000 (6.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=305651, num_faces=306962
      Valid probs shape: (37, 39581)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 99182/640000 (15.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8, max=306958, num_faces=306962
      Valid probs shape: (37, 99182)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 92163/640000 (14.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7, max=306960, num_faces=306962
      Valid probs shape: (37, 92163)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 61992/640000 (9.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=9, max=305551, num_faces=306962
      Valid probs shape: (37, 61992)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 39869/640000 (6.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4290, max=306960, num_faces=306962
      Valid probs shape: (37, 39869)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 64109/640000 (10.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=80, max=306957, num_faces=306962
      Valid probs shape: (37, 64109)
    P stats: min=0.0000, max=1.0000, mean=0.0193
    Non-zero vertices: 109328/153483
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 44155   779  1093  2888     0  1709   943  4011  5451]
  Ground Truth Stats:
    Labels shape: (153483,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-2/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6975
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8464
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8466

  RESULTS:
  RAW:         median(top-10)=0.8469, mean(top-10)=0.8507, median(all)=0.7280, mean(all)=0.6975
  + SMOOTHING: median(top-10)=0.9396, mean(top-10)=0.9406, median(all)=0.8756, mean(all)=0.8464 [+0.0926]
  + MRF:       median(top-10)=0.9397, mean(top-10)=0.9407, median(all)=0.8762, mean(all)=0.8466 [+0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0928

================================================================================
Subject: OASIS-TRT-20-20
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 124947 vertices, 249890 faces
  Rendering 6 views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 124947 vertices, 249890 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (46936 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (103220 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (96293 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (73038 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (49086 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (74947 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 46936/640000 (7.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=248676, num_faces=249890
      Valid probs shape: (37, 46936)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 103220/640000 (16.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=22, max=249875, num_faces=249890
      Valid probs shape: (37, 103220)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 96293/640000 (15.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=19, max=249889, num_faces=249890
      Valid probs shape: (37, 96293)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 73038/640000 (11.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=350, max=249719, num_faces=249890
      Valid probs shape: (37, 73038)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 49086/640000 (7.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=13792, max=249889, num_faces=249890
      Valid probs shape: (37, 49086)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 74947/640000 (11.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=14, max=249888, num_faces=249890
      Valid probs shape: (37, 74947)
    P stats: min=0.0000, max=1.0000, mean=0.0199
    Non-zero vertices: 92038/124947
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 32909   653   869  2060     0  1433   747  3574  4737]
  Ground Truth Stats:
    Labels shape: (124947,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-20/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7007
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8348
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8347

  RESULTS:
  RAW:         median(top-10)=0.8386, mean(top-10)=0.8408, median(all)=0.7561, mean(all)=0.7007
  + SMOOTHING: median(top-10)=0.9117, mean(top-10)=0.9152, median(all)=0.8832, mean(all)=0.8348 [+0.0731]
  + MRF:       median(top-10)=0.9119, mean(top-10)=0.9151, median(all)=0.8832, mean(all)=0.8347 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0733

================================================================================
Subject: OASIS-TRT-20-3
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 134843 vertices, 269682 faces
  Rendering 6 views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 134843 vertices, 269682 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (39504 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (90470 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (84416 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (56195 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (36289 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (59553 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 39504/640000 (6.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=268605, num_faces=269682
      Valid probs shape: (37, 39504)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 90470/640000 (14.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=43, max=269639, num_faces=269682
      Valid probs shape: (37, 90470)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 84416/640000 (13.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=41, max=269677, num_faces=269682
      Valid probs shape: (37, 84416)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 56195/640000 (8.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=269680, num_faces=269682
      Valid probs shape: (37, 56195)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 36289/640000 (5.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1702, max=269676, num_faces=269682
      Valid probs shape: (37, 36289)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 59553/640000 (9.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=28, max=269639, num_faces=269682
      Valid probs shape: (37, 59553)
    P stats: min=0.0000, max=1.0000, mean=0.0201
    Non-zero vertices: 100508/134843
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 34335   980   805  2915     0  1881   818  3640  4861]
  Ground Truth Stats:
    Labels shape: (134843,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-3/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7106
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8422
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8423

  RESULTS:
  RAW:         median(top-10)=0.8454, mean(top-10)=0.8521, median(all)=0.7720, mean(all)=0.7106
  + SMOOTHING: median(top-10)=0.9265, mean(top-10)=0.9299, median(all)=0.8850, mean(all)=0.8422 [+0.0811]
  + MRF:       median(top-10)=0.9265, mean(top-10)=0.9301, median(all)=0.8856, mean(all)=0.8423 [+0.0000]
  TOTAL IMPROVEMENT (median top-10): +0.0811

================================================================================
Subject: OASIS-TRT-20-4
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 138101 vertices, 276198 faces
  Rendering 6 views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 138101 vertices, 276198 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (44423 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (105060 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (96489 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (62926 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (42565 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (64568 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 44423/640000 (6.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=275053, num_faces=276198
      Valid probs shape: (37, 44423)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 105060/640000 (16.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=276197, num_faces=276198
      Valid probs shape: (37, 105060)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 96489/640000 (15.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=276196, num_faces=276198
      Valid probs shape: (37, 96489)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 62926/640000 (9.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=12, max=276085, num_faces=276198
      Valid probs shape: (37, 62926)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 42565/640000 (6.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=14853, max=276197, num_faces=276198
      Valid probs shape: (37, 42565)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 64568/640000 (10.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=55, max=276197, num_faces=276198
      Valid probs shape: (37, 64568)
    P stats: min=0.0000, max=1.0000, mean=0.0196
    Non-zero vertices: 100044/138101
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 38057   627   762  2470     0  1347   892  3083  5120]
  Ground Truth Stats:
    Labels shape: (138101,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-4/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6934
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8349
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8352

  RESULTS:
  RAW:         median(top-10)=0.8400, mean(top-10)=0.8426, median(all)=0.7561, mean(all)=0.6934
  + SMOOTHING: median(top-10)=0.9332, mean(top-10)=0.9354, median(all)=0.8987, mean(all)=0.8349 [+0.0932]
  + MRF:       median(top-10)=0.9335, mean(top-10)=0.9358, median(all)=0.8990, mean(all)=0.8352 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0935

================================================================================
Subject: OASIS-TRT-20-5
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 151342 vertices, 302680 faces
  Rendering 6 views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 151342 vertices, 302680 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (47526 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (107952 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (99043 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (66833 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (48800 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (69896 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 47526/640000 (7.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=300478, num_faces=302680
      Valid probs shape: (37, 47526)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 107952/640000 (16.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=302626, num_faces=302680
      Valid probs shape: (37, 107952)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 99043/640000 (15.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=302679, num_faces=302680
      Valid probs shape: (37, 99043)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 66833/640000 (10.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=302524, num_faces=302680
      Valid probs shape: (37, 66833)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 48800/640000 (7.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=8895, max=302677, num_faces=302680
      Valid probs shape: (37, 48800)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 69896/640000 (10.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=302676, num_faces=302680
      Valid probs shape: (37, 69896)
    P stats: min=0.0000, max=1.0000, mean=0.0195
    Non-zero vertices: 109267/151342
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 42075  1148   819  2724     0  1585   734  4682  5093]
  Ground Truth Stats:
    Labels shape: (151342,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-5/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6956
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8330
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8333

  RESULTS:
  RAW:         median(top-10)=0.8213, mean(top-10)=0.8294, median(all)=0.7347, mean(all)=0.6956
  + SMOOTHING: median(top-10)=0.9225, mean(top-10)=0.9237, median(all)=0.8604, mean(all)=0.8330 [+0.1012]
  + MRF:       median(top-10)=0.9225, mean(top-10)=0.9239, median(all)=0.8609, mean(all)=0.8333 [-0.0000]
  TOTAL IMPROVEMENT (median top-10): +0.1012

================================================================================
Subject: OASIS-TRT-20-6
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 152023 vertices, 304042 faces
  Rendering 6 views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 152023 vertices, 304042 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (40314 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (94482 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (87724 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (60176 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (38682 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (64030 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 40314/640000 (6.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=303158, num_faces=304042
      Valid probs shape: (37, 40314)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 94482/640000 (14.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=304039, num_faces=304042
      Valid probs shape: (37, 94482)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 87724/640000 (13.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=21, max=304041, num_faces=304042
      Valid probs shape: (37, 87724)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 60176/640000 (9.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=303982, num_faces=304042
      Valid probs shape: (37, 60176)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 38682/640000 (6.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=11916, max=304041, num_faces=304042
      Valid probs shape: (37, 38682)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 64030/640000 (10.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=363, max=303949, num_faces=304042
      Valid probs shape: (37, 64030)
    P stats: min=0.0000, max=1.0000, mean=0.0193
    Non-zero vertices: 108825/152023
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 43198   944  1065  3667     0  1386   950  4115  4618]
  Ground Truth Stats:
    Labels shape: (152023,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-6/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6938
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8424
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8425

  RESULTS:
  RAW:         median(top-10)=0.8152, mean(top-10)=0.8303, median(all)=0.7490, mean(all)=0.6938
  + SMOOTHING: median(top-10)=0.9208, mean(top-10)=0.9199, median(all)=0.8833, mean(all)=0.8424 [+0.1056]
  + MRF:       median(top-10)=0.9210, mean(top-10)=0.9202, median(all)=0.8828, mean(all)=0.8425 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.1057

================================================================================
Subject: OASIS-TRT-20-7
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 142612 vertices, 285220 faces
  Rendering 6 views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 142612 vertices, 285220 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (49637 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (109534 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (101356 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (68179 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (44776 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (70082 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 49637/640000 (7.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=283734, num_faces=285220
      Valid probs shape: (37, 49637)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 109534/640000 (17.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=284967, num_faces=285220
      Valid probs shape: (37, 109534)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 101356/640000 (15.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=285212, num_faces=285220
      Valid probs shape: (37, 101356)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 68179/640000 (10.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=111, max=285217, num_faces=285220
      Valid probs shape: (37, 68179)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 44776/640000 (7.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6557, max=285219, num_faces=285220
      Valid probs shape: (37, 44776)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 70082/640000 (11.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=75, max=285162, num_faces=285220
      Valid probs shape: (37, 70082)
    P stats: min=0.0000, max=1.0000, mean=0.0201
    Non-zero vertices: 106137/142612
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 36475   811   755  2800     0  1477   841  4183  5366]
  Ground Truth Stats:
    Labels shape: (142612,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-7/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6976
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8320
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8322

  RESULTS:
  RAW:         median(top-10)=0.8255, mean(top-10)=0.8316, median(all)=0.7367, mean(all)=0.6976
  + SMOOTHING: median(top-10)=0.9267, mean(top-10)=0.9267, median(all)=0.8715, mean(all)=0.8320 [+0.1011]
  + MRF:       median(top-10)=0.9269, mean(top-10)=0.9268, median(all)=0.8716, mean(all)=0.8322 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.1014

================================================================================
Subject: OASIS-TRT-20-8
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 139571 vertices, 279138 faces
  Rendering 6 views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 139571 vertices, 279138 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (53574 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (119555 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (109685 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (67837 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (53622 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (73282 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 53574/640000 (8.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=276754, num_faces=279138
      Valid probs shape: (37, 53574)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 119555/640000 (18.7%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=3, max=279070, num_faces=279138
      Valid probs shape: (37, 119555)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 109685/640000 (17.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=279137, num_faces=279138
      Valid probs shape: (37, 109685)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 67837/640000 (10.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=279132, num_faces=279138
      Valid probs shape: (37, 67837)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 53622/640000 (8.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7805, max=279137, num_faces=279138
      Valid probs shape: (37, 53622)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 73282/640000 (11.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=260, max=279072, num_faces=279138
      Valid probs shape: (37, 73282)
    P stats: min=0.0000, max=1.0000, mean=0.0195
    Non-zero vertices: 100910/139571
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 38661   864   889  3048     0  1596   769  4609  4616]
  Ground Truth Stats:
    Labels shape: (139571,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-8/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6928
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8279
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8283

  RESULTS:
  RAW:         median(top-10)=0.8402, mean(top-10)=0.8441, median(all)=0.7417, mean(all)=0.6928
  + SMOOTHING: median(top-10)=0.9230, mean(top-10)=0.9300, median(all)=0.8724, mean(all)=0.8279 [+0.0827]
  + MRF:       median(top-10)=0.9232, mean(top-10)=0.9302, median(all)=0.8736, mean(all)=0.8283 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0830

================================================================================
Subject: OASIS-TRT-20-9
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 134960 vertices, 269916 faces
  Rendering 6 views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 134960 vertices, 269916 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (39896 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (92848 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (86201 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (60492 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (41512 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (63225 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 39896/640000 (6.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=269455, num_faces=269916
      Valid probs shape: (37, 39896)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 92848/640000 (14.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8, max=269805, num_faces=269916
      Valid probs shape: (37, 92848)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 86201/640000 (13.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=269910, num_faces=269916
      Valid probs shape: (37, 86201)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 60492/640000 (9.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=14, max=269678, num_faces=269916
      Valid probs shape: (37, 60492)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 41512/640000 (6.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=99479, max=269911, num_faces=269916
      Valid probs shape: (37, 41512)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 63225/640000 (9.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=17, max=269914, num_faces=269916
      Valid probs shape: (37, 63225)
    P stats: min=0.0000, max=1.0000, mean=0.0197
    Non-zero vertices: 98173/134960
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 36787   669   789  2349     0  1506   972  3927  4195]
  Ground Truth Stats:
    Labels shape: (134960,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-9/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6952
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8427
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8428

  RESULTS:
  RAW:         median(top-10)=0.8265, mean(top-10)=0.8282, median(all)=0.7591, mean(all)=0.6952
  + SMOOTHING: median(top-10)=0.9250, mean(top-10)=0.9278, median(all)=0.8795, mean(all)=0.8427 [+0.0985]
  + MRF:       median(top-10)=0.9250, mean(top-10)=0.9279, median(all)=0.8795, mean(all)=0.8428 [-0.0000]
  TOTAL IMPROVEMENT (median top-10): +0.0985

================================================================================
Subject: Twins-2-1
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 145069 vertices, 290134 faces
  Rendering 6 views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 145069 vertices, 290134 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (58252 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (123953 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (113508 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (71956 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (55547 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (75840 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 58252/640000 (9.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=288530, num_faces=290134
      Valid probs shape: (37, 58252)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 123953/640000 (19.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=7, max=290133, num_faces=290134
      Valid probs shape: (37, 123953)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 113508/640000 (17.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=290132, num_faces=290134
      Valid probs shape: (37, 113508)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 71956/640000 (11.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=287839, num_faces=290134
      Valid probs shape: (37, 71956)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 55547/640000 (8.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=12072, max=290132, num_faces=290134
      Valid probs shape: (37, 55547)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 75840/640000 (11.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=416, max=290133, num_faces=290134
      Valid probs shape: (37, 75840)
    P stats: min=0.0000, max=1.0000, mean=0.0199
    Non-zero vertices: 106760/145069
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 38309   807   863  3460     0  1764   992  4359  4387]
  Ground Truth Stats:
    Labels shape: (145069,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/Twins-2-1/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6922
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8344
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8346

  RESULTS:
  RAW:         median(top-10)=0.8363, mean(top-10)=0.8430, median(all)=0.7397, mean(all)=0.6922
  + SMOOTHING: median(top-10)=0.9306, mean(top-10)=0.9261, median(all)=0.8735, mean(all)=0.8344 [+0.0943]
  + MRF:       median(top-10)=0.9306, mean(top-10)=0.9260, median(all)=0.8739, mean(all)=0.8346 [+0.0000]
  TOTAL IMPROVEMENT (median top-10): +0.0943

================================================================================
Subject: Twins-2-2
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 149751 vertices, 299498 faces
  Rendering 6 views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 149751 vertices, 299498 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (72774 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (140891 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (128357 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (80531 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (66855 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (82607 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 72774/640000 (11.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=298357, num_faces=299498
      Valid probs shape: (37, 72774)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 140891/640000 (22.0%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=5, max=299497, num_faces=299498
      Valid probs shape: (37, 140891)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 128357/640000 (20.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=299256, num_faces=299498
      Valid probs shape: (37, 128357)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 80531/640000 (12.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=298358, num_faces=299498
      Valid probs shape: (37, 80531)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 66855/640000 (10.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=11300, max=299460, num_faces=299498
      Valid probs shape: (37, 66855)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 82607/640000 (12.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=202, max=299497, num_faces=299498
      Valid probs shape: (37, 82607)
    P stats: min=0.0000, max=1.0000, mean=0.0197
    Non-zero vertices: 109275/149751
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 40476   776  1010  3256     0  1791   806  4129  5163]
  Ground Truth Stats:
    Labels shape: (149751,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/Twins-2-2/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6764
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8151
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8152

  RESULTS:
  RAW:         median(top-10)=0.8252, mean(top-10)=0.8262, median(all)=0.7042, mean(all)=0.6764
  + SMOOTHING: median(top-10)=0.9184, mean(top-10)=0.9230, median(all)=0.8607, mean(all)=0.8151 [+0.0931]
  + MRF:       median(top-10)=0.9187, mean(top-10)=0.9233, median(all)=0.8610, mean(all)=0.8152 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0935

================================================================================
AGGREGATE RESULTS ACROSS ALL TEST SUBJECTS
================================================================================
Number of subjects: 101

RAW PREDICTIONS:
  Median(top-10):  0.8250 ± 0.0147  (min: 0.7780, max: 0.8601)
  Mean(top-10):    0.8318 ± 0.0122  (min: 0.7981, max: 0.8583)
  Median(all):     0.7391 ± 0.0160  (min: 0.6943, max: 0.7759)
  Mean(all):       0.6870 ± 0.0129  (min: 0.6213, max: 0.7137)

+ SMOOTHING (α=0.75, 20 iter):
  Median(top-10):  0.9219 ± 0.0086  (min: 0.8979, max: 0.9425)
  Mean(top-10):    0.9237 ± 0.0076  (min: 0.8965, max: 0.9406)
  Median(all):     0.8714 ± 0.0132  (min: 0.8210, max: 0.8987)
  Mean(all):       0.8296 ± 0.0141  (min: 0.7363, max: 0.8520)
  Improvement:     median(top-10) +0.0969, mean(all) +0.1426

+ MRF (β=0.1, 5 iter):
  Median(top-10):  0.9221 ± 0.0086  (min: 0.8979, max: 0.9425)
  Mean(top-10):    0.9239 ± 0.0076  (min: 0.8966, max: 0.9407)
  Median(all):     0.8716 ± 0.0132  (min: 0.8206, max: 0.8990)
  Mean(all):       0.8298 ± 0.0141  (min: 0.7363, max: 0.8523)
  Improvement:     median(top-10) +0.0002, mean(all) +0.0002

TOTAL IMPROVEMENT (RAW → MRF):
  Median(top-10):  +0.0971
  Mean(top-10):    +0.0921
  Median(all):     +0.1326
  Mean(all):       +0.1428
================================================================================

========================================================================
Test completed with exit code: 0
========================================================================
