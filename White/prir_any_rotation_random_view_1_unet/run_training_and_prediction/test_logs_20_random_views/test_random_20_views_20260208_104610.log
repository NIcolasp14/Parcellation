[GPU] PyTorch3D loaded - GPU raycasting AVAILABLE (FAST MODE: bin_size=None)
[GPU] PyTorch3D loaded - GPU raycasting AVAILABLE (will be enabled via --raycasting arg)
Using 20 random views for testing
Auto-detected latest checkpoint: last.ckpt

Loading model from: /autofs/space/ballarat_004/users/np341/PRIR_Code/Training/White/prir_x_y_z_conditional_1_unet/models/xyz_random_views_7794326/last.ckpt
✓ Model loaded (using TRAIN mode due to corrupted BN running stats)

================================================================================
Testing VIEW-CONDITIONED model V2 (Arbitrary Views) with PyTorch3D pipeline
Checkpoint: /autofs/space/ballarat_004/users/np341/PRIR_Code/Training/White/prir_x_y_z_conditional_1_unet/models/xyz_random_views_7794326/last.ckpt
Test data: /autofs/space/ballarat_004/users/np341/mindboggle2
Using 20 random views per subject
1. Generate predictions using V2 model (continuous camera pose)
2. Iterative smoothing (α=0.75, 20 iter)
3. MRF with ICM (β=0.1)
================================================================================

Found 101 test subjects

================================================================================
Subject: Afterthought-1
================================================================================
  Step 0: Generating predictions with V2 model (20 random views)...
  Mesh: 130921 vertices, 261838 faces
  Generating 20 random views...
  Generating predictions for 20 views (continuous camera pose)...
    ✓ Random_0 (pose=(-2.3098815678628286, -0.20618883261966126, -2.463949385786891)): shape (37, 800, 800)
      Valid pixels: 77632/640000 (12.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=541, max=261837, num_faces=261838
      Valid probs shape: (37, 77632)
    ✓ Random_1 (pose=(-2.6590395570822407, -0.631752088386099, -1.1107885440022485)): shape (37, 800, 800)
      Valid pixels: 64435/640000 (10.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=966, max=261837, num_faces=261838
      Valid probs shape: (37, 64435)
    ✓ Random_2 (pose=(-3.091642245958489, -0.018542072706013712, 1.732504810304392)): shape (37, 800, 800)
      Valid pixels: 48006/640000 (7.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3569, max=261837, num_faces=261838
      Valid probs shape: (37, 48006)
    ✓ Random_3 (pose=(1.292456514296167, 1.8573968985189238, -0.09614574148592503)): shape (37, 800, 800)
      Valid pixels: 97827/640000 (15.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=261837, num_faces=261838
      Valid probs shape: (37, 97827)
    ✓ Random_4 (pose=(-2.319096874854018, 2.2498380245910905, -1.50527259347461)): shape (37, 800, 800)
      Valid pixels: 92726/640000 (14.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=261702, num_faces=261838
      Valid probs shape: (37, 92726)
    ✓ Random_5 (pose=(0.06526414354615806, 0.4459397341111546, -0.3314146163430478)): shape (37, 800, 800)
      Valid pixels: 57474/640000 (9.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=261515, num_faces=261838
      Valid probs shape: (37, 57474)
    ✓ Random_6 (pose=(1.147870535470073, 1.8677796214496505, 1.4734690985458574)): shape (37, 800, 800)
      Valid pixels: 83700/640000 (13.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=36, max=261819, num_faces=261838
      Valid probs shape: (37, 83700)
    ✓ Random_7 (pose=(0.3020780142425057, -1.3617083294323125, -2.4667706203106547)): shape (37, 800, 800)
      Valid pixels: 101532/640000 (15.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=2, max=261703, num_faces=261838
      Valid probs shape: (37, 101532)
    ✓ Random_8 (pose=(-2.46729252725671, 2.678515767203014, 2.7649815808827984)): shape (37, 800, 800)
      Valid pixels: 78427/640000 (12.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=261836, num_faces=261838
      Valid probs shape: (37, 78427)
    ✓ Random_9 (pose=(-2.7568624783017426, 0.6450253661127943, -2.9360461555098896)): shape (37, 800, 800)
      Valid pixels: 63530/640000 (9.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=947, max=261837, num_faces=261838
      Valid probs shape: (37, 63530)
    ✓ Random_10 (pose=(1.910083506923118, 1.6052567623616651, -1.3321868696163066)): shape (37, 800, 800)
      Valid pixels: 71490/640000 (11.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=29, max=261837, num_faces=261838
      Valid probs shape: (37, 71490)
    ✓ Random_11 (pose=(-1.1306850789032845, -2.8724155061821652, 0.7146436791026742)): shape (37, 800, 800)
      Valid pixels: 75792/640000 (11.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=2003, max=261836, num_faces=261838
      Valid probs shape: (37, 75792)
    ✓ Random_12 (pose=(-2.9121823522530264, -1.50416994722365, 1.1547575754172916)): shape (37, 800, 800)
      Valid pixels: 99560/640000 (15.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=10, max=261832, num_faces=261838
      Valid probs shape: (37, 99560)
    ✓ Random_13 (pose=(2.1917728936843, -2.4769299924245547, 1.826899132628574)): shape (37, 800, 800)
      Valid pixels: 91562/640000 (14.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=261699, num_faces=261838
      Valid probs shape: (37, 91562)
    ✓ Random_14 (pose=(-3.0791545898349626, 2.3241560220437725, 1.6296432278254027)): shape (37, 800, 800)
      Valid pixels: 80912/640000 (12.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=261836, num_faces=261838
      Valid probs shape: (37, 80912)
    ✓ Random_15 (pose=(-0.69477754806277, 2.2408717525504436, -0.03764870277251697)): shape (37, 800, 800)
      Valid pixels: 94334/640000 (14.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=7259, max=261835, num_faces=261838
      Valid probs shape: (37, 94334)
    ✓ Random_16 (pose=(2.4533338930904387, -1.1283306806989937, 1.5643273895821803)): shape (37, 800, 800)
      Valid pixels: 97872/640000 (15.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=81, max=261832, num_faces=261838
      Valid probs shape: (37, 97872)
    ✓ Random_17 (pose=(-1.380785272847291, 1.7846750033325867, -1.9273357673529847)): shape (37, 800, 800)
      Valid pixels: 74309/640000 (11.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=14, max=261837, num_faces=261838
      Valid probs shape: (37, 74309)
    ✓ Random_18 (pose=(0.6489719788726167, 2.44478807722835, 0.7188676434768295)): shape (37, 800, 800)
      Valid pixels: 62786/640000 (9.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=946, max=261837, num_faces=261838
      Valid probs shape: (37, 62786)
    ✓ Random_19 (pose=(-0.23567371402652482, 2.5144152305790044, 0.23907430627265747)): shape (37, 800, 800)
      Valid pixels: 76855/640000 (12.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=25155, max=261834, num_faces=261838
      Valid probs shape: (37, 76855)
    P stats: min=0.0000, max=0.9999, mean=0.0236
    Non-zero vertices: 114532/130921
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 16389   934   947  3637     0  1982  1030  3122  5544]
  Ground Truth Stats:
    Labels shape: (130921,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/Afterthought-1/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7439
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8217
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8221

  RESULTS:
  RAW:         median(top-10)=0.8856, mean(top-10)=0.8891, median(all)=0.8166, mean(all)=0.7439
  + SMOOTHING: median(top-10)=0.9257, mean(top-10)=0.9247, median(all)=0.8662, mean(all)=0.8217 [+0.0400]
  + MRF:       median(top-10)=0.9257, mean(top-10)=0.9249, median(all)=0.8657, mean(all)=0.8221 [-0.0000]
  TOTAL IMPROVEMENT (median top-10): +0.0400

================================================================================
Subject: Colin27-1
================================================================================
  Step 0: Generating predictions with V2 model (20 random views)...
  Mesh: 182414 vertices, 364824 faces
  Generating 20 random views...
  Generating predictions for 20 views (continuous camera pose)...
    ✓ Random_0 (pose=(-2.6051087923795198, -2.9605556359034293, -0.14032337704156728)): shape (37, 800, 800)
      Valid pixels: 64379/640000 (10.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=0, max=364536, num_faces=364824
      Valid probs shape: (37, 64379)
    ✓ Random_1 (pose=(-1.9840893403959259, 0.551789080434006, -2.977176015489149)): shape (37, 800, 800)
      Valid pixels: 81475/640000 (12.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=174, max=364820, num_faces=364824
      Valid probs shape: (37, 81475)
    ✓ Random_2 (pose=(0.20100085024966052, -0.20732821192758344, -0.25003943179187305)): shape (37, 800, 800)
      Valid pixels: 47856/640000 (7.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=364822, num_faces=364824
      Valid probs shape: (37, 47856)
    ✓ Random_3 (pose=(0.2032328242801067, -2.1115961742443385, 2.478151066171584)): shape (37, 800, 800)
      Valid pixels: 59756/640000 (9.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1386, max=364817, num_faces=364824
      Valid probs shape: (37, 59756)
    ✓ Random_4 (pose=(0.6827891852810275, -1.0855023607609664, 0.45887707521883625)): shape (37, 800, 800)
      Valid pixels: 94664/640000 (14.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=364820, num_faces=364824
      Valid probs shape: (37, 94664)
    ✓ Random_5 (pose=(-2.29295706413658, 2.4581579181835664, 0.6476707687607579)): shape (37, 800, 800)
      Valid pixels: 58463/640000 (9.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=364823, num_faces=364824
      Valid probs shape: (37, 58463)
    ✓ Random_6 (pose=(3.061862934163421, -0.9339274072945765, 0.31011364432253474)): shape (37, 800, 800)
      Valid pixels: 60676/640000 (9.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=17794, max=364175, num_faces=364824
      Valid probs shape: (37, 60676)
    ✓ Random_7 (pose=(-2.9362824822991977, 2.264700148779591, -0.026796647574397703)): shape (37, 800, 800)
      Valid pixels: 54795/640000 (8.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=364823, num_faces=364824
      Valid probs shape: (37, 54795)
    ✓ Random_8 (pose=(-0.3170975860264562, -2.0862883500190854, -2.6038503872393735)): shape (37, 800, 800)
      Valid pixels: 60562/640000 (9.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=10591, max=364170, num_faces=364824
      Valid probs shape: (37, 60562)
    ✓ Random_9 (pose=(2.8466363788446145, 2.3720217618614248, -1.3766756615480908)): shape (37, 800, 800)
      Valid pixels: 64028/640000 (10.0%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=1, max=364543, num_faces=364824
      Valid probs shape: (37, 64028)
    ✓ Random_10 (pose=(2.0837401239108084, 1.2585428501870837, 1.3363173505640686)): shape (37, 800, 800)
      Valid pixels: 69038/640000 (10.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=134, max=364820, num_faces=364824
      Valid probs shape: (37, 69038)
    ✓ Random_11 (pose=(1.0477290492678826, 1.3274366244529334, -1.0017844828393785)): shape (37, 800, 800)
      Valid pixels: 98773/640000 (15.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=24, max=364820, num_faces=364824
      Valid probs shape: (37, 98773)
    ✓ Random_12 (pose=(-1.5605341322390887, 2.584562195352726, -1.274941871536402)): shape (37, 800, 800)
      Valid pixels: 70133/640000 (11.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=36, max=363064, num_faces=364824
      Valid probs shape: (37, 70133)
    ✓ Random_13 (pose=(-0.6965471730707802, 2.90591643185088, -0.1597091435843363)): shape (37, 800, 800)
      Valid pixels: 78317/640000 (12.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=20033, max=364498, num_faces=364824
      Valid probs shape: (37, 78317)
    ✓ Random_14 (pose=(-0.39752897443067736, -2.7399588403588133, 1.769764793448525)): shape (37, 800, 800)
      Valid pixels: 58964/640000 (9.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1078, max=364813, num_faces=364824
      Valid probs shape: (37, 58964)
    ✓ Random_15 (pose=(0.07110078637645412, 1.0387819391778113, 0.6967378443958196)): shape (37, 800, 800)
      Valid pixels: 76729/640000 (12.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=364169, num_faces=364824
      Valid probs shape: (37, 76729)
    ✓ Random_16 (pose=(0.09982802665924373, -2.5665968952117786, 0.07533458102577661)): shape (37, 800, 800)
      Valid pixels: 48139/640000 (7.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1557, max=364823, num_faces=364824
      Valid probs shape: (37, 48139)
    ✓ Random_17 (pose=(3.0757444801541522, -1.855057151506901, -0.09848716888599096)): shape (37, 800, 800)
      Valid pixels: 55523/640000 (8.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=364675, num_faces=364824
      Valid probs shape: (37, 55523)
    ✓ Random_18 (pose=(2.144465397124195, 1.7072205422385993, -0.8591326931541299)): shape (37, 800, 800)
      Valid pixels: 64176/640000 (10.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=91, max=364823, num_faces=364824
      Valid probs shape: (37, 64176)
    ✓ Random_19 (pose=(1.4876135078086579, -0.5253587314252672, 2.4235172443189477)): shape (37, 800, 800)
      Valid pixels: 90364/640000 (14.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8, max=364175, num_faces=364824
      Valid probs shape: (37, 90364)
    P stats: min=0.0000, max=1.0000, mean=0.0235
    Non-zero vertices: 158713/182414
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 23701  1541  1640  3537     0  2787  1309  5086  8904]
  Ground Truth Stats:
    Labels shape: (182414,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/Colin27-1/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
/autofs/space/ballarat_004/users/np341/PRIR_Code/Training/White/prir_x_y_z_conditional_1_unet/run_training_and_prediction/test_conditioned_model_v2.py:201: RuntimeWarning: invalid value encountered in divide
  P_normalized = P_smooth / np.sum(P_smooth, axis=0, keepdims=True)
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6989
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7441
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7660

  RESULTS:
  RAW:         median(top-10)=0.8331, mean(top-10)=0.8412, median(all)=0.7732, mean(all)=0.6989
  + SMOOTHING: median(top-10)=0.8814, mean(top-10)=0.8828, median(all)=0.8197, mean(all)=0.7441 [+0.0483]
  + MRF:       median(top-10)=0.8815, mean(top-10)=0.8830, median(all)=0.8205, mean(all)=0.7660 [+0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0484

================================================================================
Subject: HLN-12-1
================================================================================
  Step 0: Generating predictions with V2 model (20 random views)...
  Mesh: 138729 vertices, 277454 faces
  Generating 20 random views...
  Generating predictions for 20 views (continuous camera pose)...
    ✓ Random_0 (pose=(-0.4361339093079777, 0.3297138558305237, -2.687204368194475)): shape (37, 800, 800)
      Valid pixels: 81336/640000 (12.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=277449, num_faces=277454
      Valid probs shape: (37, 81336)
    ✓ Random_1 (pose=(1.0579222532169643, 0.5636181964988083, -1.0088445156104044)): shape (37, 800, 800)
      Valid pixels: 103543/640000 (16.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=11, max=277453, num_faces=277454
      Valid probs shape: (37, 103543)
    ✓ Random_2 (pose=(1.6672335330132455, -0.167875045209545, -3.137302901774663)): shape (37, 800, 800)
      Valid pixels: 101384/640000 (15.8%)
      Probs stats: min=0.0000, max=0.9995, mean=0.0270
      Face IDs: min=32, max=277285, num_faces=277454
      Valid probs shape: (37, 101384)
    ✓ Random_3 (pose=(2.507548509615213, -2.2993182968887127, 0.1604271613313779)): shape (37, 800, 800)
      Valid pixels: 80504/640000 (12.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=277449, num_faces=277454
      Valid probs shape: (37, 80504)
    ✓ Random_4 (pose=(2.028557862507663, 2.2415751297776962, -0.6469145016089732)): shape (37, 800, 800)
      Valid pixels: 97444/640000 (15.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7, max=277453, num_faces=277454
      Valid probs shape: (37, 97444)
    ✓ Random_5 (pose=(-2.243395514014649, 2.7109391939658014, -2.924978457133192)): shape (37, 800, 800)
      Valid pixels: 88199/640000 (13.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=277453, num_faces=277454
      Valid probs shape: (37, 88199)
    ✓ Random_6 (pose=(-0.2936618737991914, -2.9604353955411953, -2.2642122020283773)): shape (37, 800, 800)
      Valid pixels: 57624/640000 (9.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=13442, max=277370, num_faces=277454
      Valid probs shape: (37, 57624)
    ✓ Random_7 (pose=(0.887671171737896, 1.3224235622174767, -2.6720071382290684)): shape (37, 800, 800)
      Valid pixels: 73883/640000 (11.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=14, max=277452, num_faces=277454
      Valid probs shape: (37, 73883)
    ✓ Random_8 (pose=(-2.922018392843427, 0.16142634836619107, 2.6978908296775117)): shape (37, 800, 800)
      Valid pixels: 50109/640000 (7.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=8003, max=277453, num_faces=277454
      Valid probs shape: (37, 50109)
    ✓ Random_9 (pose=(0.1646095987444256, 0.5304509581212282, 0.023574928811518348)): shape (37, 800, 800)
      Valid pixels: 69041/640000 (10.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=277442, num_faces=277454
      Valid probs shape: (37, 69041)
    ✓ Random_10 (pose=(-0.8635117195700461, -1.6009649169725684, -0.9062023954795384)): shape (37, 800, 800)
      Valid pixels: 106837/640000 (16.7%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=1, max=277285, num_faces=277454
      Valid probs shape: (37, 106837)
    ✓ Random_11 (pose=(3.058443789797412, -0.4525774786832102, 2.937376872113341)): shape (37, 800, 800)
      Valid pixels: 71560/640000 (11.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6782, max=277448, num_faces=277454
      Valid probs shape: (37, 71560)
    ✓ Random_12 (pose=(-0.3644413089322054, -0.9922293005283609, 0.23756469308322714)): shape (37, 800, 800)
      Valid pixels: 63990/640000 (10.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=277453, num_faces=277454
      Valid probs shape: (37, 63990)
    ✓ Random_13 (pose=(-2.7314509253375494, 2.2785590817695773, 2.4564419401688733)): shape (37, 800, 800)
      Valid pixels: 91947/640000 (14.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=277453, num_faces=277454
      Valid probs shape: (37, 91947)
    ✓ Random_14 (pose=(1.113607004945643, 1.8169457473377992, -2.9664985654726816)): shape (37, 800, 800)
      Valid pixels: 84595/640000 (13.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=7, max=277447, num_faces=277454
      Valid probs shape: (37, 84595)
    ✓ Random_15 (pose=(0.44193702104910093, -1.2065018247738122, -0.16325067636492996)): shape (37, 800, 800)
      Valid pixels: 82497/640000 (12.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=277453, num_faces=277454
      Valid probs shape: (37, 82497)
    ✓ Random_16 (pose=(-1.3420884173843821, -2.175439012767723, -0.18514847362723064)): shape (37, 800, 800)
      Valid pixels: 101887/640000 (15.9%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=1, max=277285, num_faces=277454
      Valid probs shape: (37, 101887)
    ✓ Random_17 (pose=(-0.4764276025515861, 0.34477729421033976, 2.9904160318644655)): shape (37, 800, 800)
      Valid pixels: 78632/640000 (12.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=277453, num_faces=277454
      Valid probs shape: (37, 78632)
    ✓ Random_18 (pose=(0.10910775796830974, 0.9993584239273678, 2.292450301049673)): shape (37, 800, 800)
      Valid pixels: 71435/640000 (11.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=277025, num_faces=277454
      Valid probs shape: (37, 71435)
    ✓ Random_19 (pose=(-1.858268782219761, 1.857825531101839, 2.8673653485580433)): shape (37, 800, 800)
      Valid pixels: 110706/640000 (17.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=277453, num_faces=277454
      Valid probs shape: (37, 110706)
    P stats: min=0.0000, max=1.0000, mean=0.0231
    Non-zero vertices: 118746/138729
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 19983  1109  1150  2720     0  1790   996  5043  6527]
  Ground Truth Stats:
    Labels shape: (138729,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/HLN-12-1/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7296
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8175
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8179

  RESULTS:
  RAW:         median(top-10)=0.8803, mean(top-10)=0.8825, median(all)=0.7765, mean(all)=0.7296
  + SMOOTHING: median(top-10)=0.9111, mean(top-10)=0.9168, median(all)=0.8592, mean(all)=0.8175 [+0.0307]
  + MRF:       median(top-10)=0.9119, mean(top-10)=0.9172, median(all)=0.8596, mean(all)=0.8179 [+0.0008]
  TOTAL IMPROVEMENT (median top-10): +0.0315

================================================================================
Subject: HLN-12-10
================================================================================
  Step 0: Generating predictions with V2 model (20 random views)...
  Mesh: 134639 vertices, 269274 faces
  Generating 20 random views...
  Generating predictions for 20 views (continuous camera pose)...
    ✓ Random_0 (pose=(-2.322288255369613, 2.496416556721141, 1.471879845977198)): shape (37, 800, 800)
      Valid pixels: 71231/640000 (11.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=10, max=269154, num_faces=269274
      Valid probs shape: (37, 71231)
    ✓ Random_1 (pose=(0.5495892343295972, 0.9570683650645995, -2.231376094466892)): shape (37, 800, 800)
      Valid pixels: 66809/640000 (10.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=269155, num_faces=269274
      Valid probs shape: (37, 66809)
    ✓ Random_2 (pose=(2.5977144505013943, -0.23984222487653062, -0.5489099603461898)): shape (37, 800, 800)
      Valid pixels: 70718/640000 (11.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=114, max=269272, num_faces=269274
      Valid probs shape: (37, 70718)
    ✓ Random_3 (pose=(-0.06570314071077066, 0.7318642939943443, -2.2318985231200568)): shape (37, 800, 800)
      Valid pixels: 76130/640000 (11.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=268823, num_faces=269274
      Valid probs shape: (37, 76130)
    ✓ Random_4 (pose=(-1.358119385421933, -1.5272262582474505, -1.7927409868793962)): shape (37, 800, 800)
      Valid pixels: 63451/640000 (9.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=269272, num_faces=269274
      Valid probs shape: (37, 63451)
    ✓ Random_5 (pose=(2.2969205882477235, 2.223292343223817, -2.314454871560694)): shape (37, 800, 800)
      Valid pixels: 86581/640000 (13.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=5, max=269214, num_faces=269274
      Valid probs shape: (37, 86581)
    ✓ Random_6 (pose=(-0.9175720119399955, -0.32492385764798515, -1.6728381203539924)): shape (37, 800, 800)
      Valid pixels: 62291/640000 (9.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=266963, num_faces=269274
      Valid probs shape: (37, 62291)
    ✓ Random_7 (pose=(2.038159076083418, 3.077549109481823, 0.6694218887661152)): shape (37, 800, 800)
      Valid pixels: 79551/640000 (12.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=268823, num_faces=269274
      Valid probs shape: (37, 79551)
    ✓ Random_8 (pose=(-2.9994119539318804, -1.8885496389420153, -0.35699252479820753)): shape (37, 800, 800)
      Valid pixels: 64754/640000 (10.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=269210, num_faces=269274
      Valid probs shape: (37, 64754)
    ✓ Random_9 (pose=(-2.841684092533114, -2.538790491656316, -1.8108741148217433)): shape (37, 800, 800)
      Valid pixels: 71584/640000 (11.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=268823, num_faces=269274
      Valid probs shape: (37, 71584)
    ✓ Random_10 (pose=(3.043198716960366, 2.04952838367448, 0.03450853962865574)): shape (37, 800, 800)
      Valid pixels: 63893/640000 (10.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=20, max=269164, num_faces=269274
      Valid probs shape: (37, 63893)
    ✓ Random_11 (pose=(2.78577738473672, 2.775680438282837, 2.7603071791059746)): shape (37, 800, 800)
      Valid pixels: 59357/640000 (9.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=267387, num_faces=269274
      Valid probs shape: (37, 59357)
    ✓ Random_12 (pose=(1.7815864019388892, 1.4197639659918844, 2.261717428348235)): shape (37, 800, 800)
      Valid pixels: 84181/640000 (13.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=269272, num_faces=269274
      Valid probs shape: (37, 84181)
    ✓ Random_13 (pose=(2.6121218672751185, -2.3740653880491895, -2.464580007258039)): shape (37, 800, 800)
      Valid pixels: 61063/640000 (9.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8, max=269150, num_faces=269274
      Valid probs shape: (37, 61063)
    ✓ Random_14 (pose=(-2.9970498780131, -2.4399345416137406, 0.521454077760855)): shape (37, 800, 800)
      Valid pixels: 73002/640000 (11.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=267402, num_faces=269274
      Valid probs shape: (37, 73002)
    ✓ Random_15 (pose=(-1.1460491108937967, 0.24745278153126593, 1.325831133941687)): shape (37, 800, 800)
      Valid pixels: 69159/640000 (10.8%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=4, max=269155, num_faces=269274
      Valid probs shape: (37, 69159)
    ✓ Random_16 (pose=(-0.6307221741008071, 0.21082954736141968, -1.8834145088444305)): shape (37, 800, 800)
      Valid pixels: 61011/640000 (9.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=268812, num_faces=269274
      Valid probs shape: (37, 61011)
    ✓ Random_17 (pose=(1.6997827706064035, -3.0670985415188596, 2.9872091800550304)): shape (37, 800, 800)
      Valid pixels: 97665/640000 (15.3%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=4, max=269228, num_faces=269274
      Valid probs shape: (37, 97665)
    ✓ Random_18 (pose=(-2.2185112660791635, -0.9125911102452977, -1.972884677321696)): shape (37, 800, 800)
      Valid pixels: 83311/640000 (13.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=118, max=269272, num_faces=269274
      Valid probs shape: (37, 83311)
    ✓ Random_19 (pose=(-2.992520308212668, -2.379131646675319, -2.452910718164242)): shape (37, 800, 800)
      Valid pixels: 76254/640000 (11.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=268823, num_faces=269274
      Valid probs shape: (37, 76254)
    P stats: min=0.0000, max=1.0000, mean=0.0229
    Non-zero vertices: 114119/134639
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 20520  1315  1070  2631     0  2831  1282  3681  6056]
  Ground Truth Stats:
    Labels shape: (134639,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/HLN-12-10/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7083
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7939
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7941

  RESULTS:
  RAW:         median(top-10)=0.8536, mean(top-10)=0.8627, median(all)=0.7632, mean(all)=0.7083
  + SMOOTHING: median(top-10)=0.8982, mean(top-10)=0.9044, median(all)=0.8622, mean(all)=0.7939 [+0.0445]
  + MRF:       median(top-10)=0.8987, mean(top-10)=0.9048, median(all)=0.8627, mean(all)=0.7941 [+0.0005]
  TOTAL IMPROVEMENT (median top-10): +0.0450

================================================================================
Subject: HLN-12-11
================================================================================
  Step 0: Generating predictions with V2 model (20 random views)...
  Mesh: 130710 vertices, 261416 faces
  Generating 20 random views...
  Generating predictions for 20 views (continuous camera pose)...
    ✓ Random_0 (pose=(-1.7841434883122549, -1.6612767048624375, 0.9776481357391589)): shape (37, 800, 800)
      Valid pixels: 83800/640000 (13.1%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=29, max=261119, num_faces=261416
      Valid probs shape: (37, 83800)
    ✓ Random_1 (pose=(-1.1665974194188746, 3.1349556478383525, 1.3334827026092642)): shape (37, 800, 800)
      Valid pixels: 76246/640000 (11.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=517, max=261415, num_faces=261416
      Valid probs shape: (37, 76246)
    ✓ Random_2 (pose=(0.905115847510908, -0.06542201849647489, -0.26598209142925544)): shape (37, 800, 800)
      Valid pixels: 91688/640000 (14.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=261302, num_faces=261416
      Valid probs shape: (37, 91688)
    ✓ Random_3 (pose=(1.7808611895380713, -2.7229392365630103, -0.393539940497047)): shape (37, 800, 800)
      Valid pixels: 109658/640000 (17.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=261410, num_faces=261416
      Valid probs shape: (37, 109658)
    ✓ Random_4 (pose=(0.3758213064596343, -3.07401140816006, -1.441884803211035)): shape (37, 800, 800)
      Valid pixels: 55960/640000 (8.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1670, max=261415, num_faces=261416
      Valid probs shape: (37, 55960)
    ✓ Random_5 (pose=(-0.40288397962120426, -1.207903291775172, 1.1070654305155223)): shape (37, 800, 800)
      Valid pixels: 94833/640000 (14.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=10, max=261411, num_faces=261416
      Valid probs shape: (37, 94833)
    ✓ Random_6 (pose=(-3.0356339001803954, -1.8597875931640173, 2.1492089354908828)): shape (37, 800, 800)
      Valid pixels: 82431/640000 (12.9%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=6, max=261119, num_faces=261416
      Valid probs shape: (37, 82431)
    ✓ Random_7 (pose=(-0.27690572954168724, 0.48924052775555626, 2.9225083431303034)): shape (37, 800, 800)
      Valid pixels: 62530/640000 (9.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=261362, num_faces=261416
      Valid probs shape: (37, 62530)
    ✓ Random_8 (pose=(-1.5805868903785532, 0.8134694165431338, 2.92450310244375)): shape (37, 800, 800)
      Valid pixels: 111224/640000 (17.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=27, max=261410, num_faces=261416
      Valid probs shape: (37, 111224)
    ✓ Random_9 (pose=(2.4826557781016447, -1.6707167451473819, 0.9981505232970243)): shape (37, 800, 800)
      Valid pixels: 83875/640000 (13.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=13, max=261111, num_faces=261416
      Valid probs shape: (37, 83875)
    ✓ Random_10 (pose=(-1.676357864171786, 0.5879244712148299, -0.030252460325332464)): shape (37, 800, 800)
      Valid pixels: 99292/640000 (15.5%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=6, max=261163, num_faces=261416
      Valid probs shape: (37, 99292)
    ✓ Random_11 (pose=(1.2980379083458562, -3.1209443492753786, 3.0720585168360106)): shape (37, 800, 800)
      Valid pixels: 100342/640000 (15.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=88, max=261119, num_faces=261416
      Valid probs shape: (37, 100342)
    ✓ Random_12 (pose=(-0.4049310036994749, -1.7857896517549432, -2.1686145684754092)): shape (37, 800, 800)
      Valid pixels: 92653/640000 (14.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=97, max=261117, num_faces=261416
      Valid probs shape: (37, 92653)
    ✓ Random_13 (pose=(0.13172448917924662, 0.39086762964056687, 0.40438829915702934)): shape (37, 800, 800)
      Valid pixels: 59471/640000 (9.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=258541, num_faces=261416
      Valid probs shape: (37, 59471)
    ✓ Random_14 (pose=(-2.55263008780131, -3.0677402582009226, -0.8871926400140167)): shape (37, 800, 800)
      Valid pixels: 71505/640000 (11.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=258629, num_faces=261416
      Valid probs shape: (37, 71505)
    ✓ Random_15 (pose=(2.146666834233086, 2.7360206593484158, 3.00103540201669)): shape (37, 800, 800)
      Valid pixels: 96278/640000 (15.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=261113, num_faces=261416
      Valid probs shape: (37, 96278)
    ✓ Random_16 (pose=(-0.4188178472004629, 1.8968881247607046, 1.0790829182469421)): shape (37, 800, 800)
      Valid pixels: 99911/640000 (15.6%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=88, max=261174, num_faces=261416
      Valid probs shape: (37, 99911)
    ✓ Random_17 (pose=(-1.139871949406773, 2.4393216829505002, -0.5390465507943207)): shape (37, 800, 800)
      Valid pixels: 97174/640000 (15.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=88, max=261155, num_faces=261416
      Valid probs shape: (37, 97174)
    ✓ Random_18 (pose=(-2.2060200890537205, 2.3828593610323985, 2.652871144702626)): shape (37, 800, 800)
      Valid pixels: 100575/640000 (15.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=261291, num_faces=261416
      Valid probs shape: (37, 100575)
    ✓ Random_19 (pose=(1.995210541635041, 1.2136370133242256, 0.688280992151002)): shape (37, 800, 800)
      Valid pixels: 99259/640000 (15.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=111, max=261133, num_faces=261416
      Valid probs shape: (37, 99259)
    P stats: min=0.0000, max=0.9999, mean=0.0245
    Non-zero vertices: 118658/130710
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 12052  1385   750  3308     0  1511  1004  3981  5816]
  Ground Truth Stats:
    Labels shape: (130710,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/HLN-12-11/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7662
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8235
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8239

  RESULTS:
  RAW:         median(top-10)=0.8922, mean(top-10)=0.8954, median(all)=0.8181, mean(all)=0.7662
  + SMOOTHING: median(top-10)=0.9229, mean(top-10)=0.9250, median(all)=0.8845, mean(all)=0.8235 [+0.0307]
  + MRF:       median(top-10)=0.9231, mean(top-10)=0.9254, median(all)=0.8860, mean(all)=0.8239 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0309

================================================================================
Subject: HLN-12-12
================================================================================
  Step 0: Generating predictions with V2 model (20 random views)...
  Mesh: 148128 vertices, 296252 faces
  Generating 20 random views...
  Generating predictions for 20 views (continuous camera pose)...
    ✓ Random_0 (pose=(-2.368876056804771, 3.082481373805443, -2.553589733575662)): shape (37, 800, 800)
      Valid pixels: 58105/640000 (9.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=296200, num_faces=296252
      Valid probs shape: (37, 58105)
    ✓ Random_1 (pose=(-0.07964623617264444, 0.8773155624231634, 2.7344594132412654)): shape (37, 800, 800)
      Valid pixels: 52358/640000 (8.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=296201, num_faces=296252
      Valid probs shape: (37, 52358)
    ✓ Random_2 (pose=(-1.475812644477203, -1.7158520292831894, -0.9819747916220165)): shape (37, 800, 800)
      Valid pixels: 80397/640000 (12.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=34, max=295557, num_faces=296252
      Valid probs shape: (37, 80397)
    ✓ Random_3 (pose=(-3.041343213078496, -0.37360775338740204, -0.5449701097806776)): shape (37, 800, 800)
      Valid pixels: 42700/640000 (6.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7993, max=296250, num_faces=296252
      Valid probs shape: (37, 42700)
    ✓ Random_4 (pose=(-0.4903176839150012, 0.09541060371678345, 1.6330817750326716)): shape (37, 800, 800)
      Valid pixels: 44350/640000 (6.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=296199, num_faces=296252
      Valid probs shape: (37, 44350)
    ✓ Random_5 (pose=(-0.15819182414947308, 1.8962531820559692, -0.08276941821321593)): shape (37, 800, 800)
      Valid pixels: 56522/640000 (8.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=106, max=296228, num_faces=296252
      Valid probs shape: (37, 56522)
    ✓ Random_6 (pose=(1.8715314445417013, -2.7271625056659143, -3.1340800658050587)): shape (37, 800, 800)
      Valid pixels: 76990/640000 (12.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=296203, num_faces=296252
      Valid probs shape: (37, 76990)
    ✓ Random_7 (pose=(1.1955668866855031, -2.0563137405180054, 1.3020064003039264)): shape (37, 800, 800)
      Valid pixels: 64994/640000 (10.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=12, max=296204, num_faces=296252
      Valid probs shape: (37, 64994)
    ✓ Random_8 (pose=(-1.498356413462983, 1.373008413791621, 1.2247699135765426)): shape (37, 800, 800)
      Valid pixels: 61811/640000 (9.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=71, max=296203, num_faces=296252
      Valid probs shape: (37, 61811)
    ✓ Random_9 (pose=(2.2853284301974854, 2.056596419136203, 0.404652196032639)): shape (37, 800, 800)
      Valid pixels: 86780/640000 (13.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7, max=296202, num_faces=296252
      Valid probs shape: (37, 86780)
    ✓ Random_10 (pose=(-0.059486006908430866, -2.1804934828044473, 0.3939926668902496)): shape (37, 800, 800)
      Valid pixels: 59165/640000 (9.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=192, max=296204, num_faces=296252
      Valid probs shape: (37, 59165)
    ✓ Random_11 (pose=(-0.5896293339552963, 0.32040978818019905, -1.8694088438727177)): shape (37, 800, 800)
      Valid pixels: 52368/640000 (8.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=296196, num_faces=296252
      Valid probs shape: (37, 52368)
    ✓ Random_12 (pose=(1.0684402158328927, 1.6038462427842228, 1.1834387804868918)): shape (37, 800, 800)
      Valid pixels: 58342/640000 (9.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=19, max=296228, num_faces=296252
      Valid probs shape: (37, 58342)
    ✓ Random_13 (pose=(0.005505176745870699, 0.7299627686116903, -0.5074067674088218)): shape (37, 800, 800)
      Valid pixels: 50907/640000 (8.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=296204, num_faces=296252
      Valid probs shape: (37, 50907)
    ✓ Random_14 (pose=(0.4344001211581112, 2.534966409989871, -0.5024041543623694)): shape (37, 800, 800)
      Valid pixels: 58519/640000 (9.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=163, max=296248, num_faces=296252
      Valid probs shape: (37, 58519)
    ✓ Random_15 (pose=(0.8726310521902958, -2.109808974958428, 0.8144144099517954)): shape (37, 800, 800)
      Valid pixels: 79285/640000 (12.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=148, max=296231, num_faces=296252
      Valid probs shape: (37, 79285)
    ✓ Random_16 (pose=(2.4695362246919155, 1.8975484456244436, -2.114697409903865)): shape (37, 800, 800)
      Valid pixels: 76679/640000 (12.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=2, max=296204, num_faces=296252
      Valid probs shape: (37, 76679)
    ✓ Random_17 (pose=(-2.4327102622238765, -2.6106210013633357, -1.8857304565176443)): shape (37, 800, 800)
      Valid pixels: 59259/640000 (9.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=296200, num_faces=296252
      Valid probs shape: (37, 59259)
    ✓ Random_18 (pose=(-1.369182525847473, 2.8488942833024815, -2.1222964800414563)): shape (37, 800, 800)
      Valid pixels: 64986/640000 (10.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=13, max=296199, num_faces=296252
      Valid probs shape: (37, 64986)
    ✓ Random_19 (pose=(-2.152172733760829, -2.5727454360306856, 2.326749147006754)): shape (37, 800, 800)
      Valid pixels: 65582/640000 (10.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=10, max=296202, num_faces=296252
      Valid probs shape: (37, 65582)
    P stats: min=0.0000, max=1.0000, mean=0.0230
    Non-zero vertices: 125862/148128
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 22266   840   935  3842     0  2272  1123  5664  6867]
  Ground Truth Stats:
    Labels shape: (148128,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/HLN-12-12/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7085
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7786
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7788

  RESULTS:
  RAW:         median(top-10)=0.8625, mean(top-10)=0.8701, median(all)=0.7977, mean(all)=0.7085
  + SMOOTHING: median(top-10)=0.9074, mean(top-10)=0.9081, median(all)=0.8372, mean(all)=0.7786 [+0.0448]
  + MRF:       median(top-10)=0.9080, mean(top-10)=0.9083, median(all)=0.8373, mean(all)=0.7788 [+0.0006]
  TOTAL IMPROVEMENT (median top-10): +0.0455

================================================================================
Subject: HLN-12-2
================================================================================
  Step 0: Generating predictions with V2 model (20 random views)...
  Mesh: 146833 vertices, 293662 faces
  Generating 20 random views...
  Generating predictions for 20 views (continuous camera pose)...
    ✓ Random_0 (pose=(1.2781834786106696, 0.6467887821272766, 1.1280719858554349)): shape (37, 800, 800)
      Valid pixels: 66690/640000 (10.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=24, max=293616, num_faces=293662
      Valid probs shape: (37, 66690)
    ✓ Random_1 (pose=(0.2457025365344747, 0.5599624776400347, 2.435666752332506)): shape (37, 800, 800)
      Valid pixels: 65452/640000 (10.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=4, max=293432, num_faces=293662
      Valid probs shape: (37, 65452)
    ✓ Random_2 (pose=(0.13076464410518973, 0.15230531254280866, 0.3017358857413761)): shape (37, 800, 800)
      Valid pixels: 50728/640000 (7.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=291554, num_faces=293662
      Valid probs shape: (37, 50728)
    ✓ Random_3 (pose=(1.235978316800015, 0.15785717899785112, 0.33711955240926716)): shape (37, 800, 800)
      Valid pixels: 88100/640000 (13.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=18, max=293617, num_faces=293662
      Valid probs shape: (37, 88100)
    ✓ Random_4 (pose=(-0.7214722214768061, -3.0021595196533655, 1.9401998647855807)): shape (37, 800, 800)
      Valid pixels: 73162/640000 (11.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=293657, num_faces=293662
      Valid probs shape: (37, 73162)
    ✓ Random_5 (pose=(-2.1863985307597695, 0.012052845299734383, -2.2418916430222535)): shape (37, 800, 800)
      Valid pixels: 66385/640000 (10.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=293617, num_faces=293662
      Valid probs shape: (37, 66385)
    ✓ Random_6 (pose=(-1.7029488491088194, -2.137806223633818, -2.9398102146009646)): shape (37, 800, 800)
      Valid pixels: 101379/640000 (15.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=293617, num_faces=293662
      Valid probs shape: (37, 101379)
    ✓ Random_7 (pose=(2.9701047495018758, 2.655601545454479, 2.641273651914805)): shape (37, 800, 800)
      Valid pixels: 55788/640000 (8.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=291506, num_faces=293662
      Valid probs shape: (37, 55788)
    ✓ Random_8 (pose=(-0.3724843602812786, 0.07013439288436585, 2.708620300289981)): shape (37, 800, 800)
      Valid pixels: 51594/640000 (8.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=293614, num_faces=293662
      Valid probs shape: (37, 51594)
    ✓ Random_9 (pose=(-1.206807417905116, 0.9072155605871508, 1.8716583263966644)): shape (37, 800, 800)
      Valid pixels: 62412/640000 (9.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=293659, num_faces=293662
      Valid probs shape: (37, 62412)
    ✓ Random_10 (pose=(1.6579732646850989, -2.7361573837310105, -3.1258825409650446)): shape (37, 800, 800)
      Valid pixels: 95464/640000 (14.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=23, max=293660, num_faces=293662
      Valid probs shape: (37, 95464)
    ✓ Random_11 (pose=(1.2456211112333468, -0.051580375400939626, -0.2443869207724867)): shape (37, 800, 800)
      Valid pixels: 98684/640000 (15.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=293617, num_faces=293662
      Valid probs shape: (37, 98684)
    ✓ Random_12 (pose=(1.381251788542393, 2.2088484734527665, -0.3986926270752065)): shape (37, 800, 800)
      Valid pixels: 106645/640000 (16.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=293617, num_faces=293662
      Valid probs shape: (37, 106645)
    ✓ Random_13 (pose=(0.5589241722863525, -0.9036460405167381, 1.3604228734511201)): shape (37, 800, 800)
      Valid pixels: 81167/640000 (12.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=293615, num_faces=293662
      Valid probs shape: (37, 81167)
    ✓ Random_14 (pose=(2.0235098357285066, -0.6186407406628147, -0.9319686673172658)): shape (37, 800, 800)
      Valid pixels: 100403/640000 (15.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=293661, num_faces=293662
      Valid probs shape: (37, 100403)
    ✓ Random_15 (pose=(-0.2195786840654037, -0.27249120571694396, 2.163806288896861)): shape (37, 800, 800)
      Valid pixels: 55222/640000 (8.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=293611, num_faces=293662
      Valid probs shape: (37, 55222)
    ✓ Random_16 (pose=(-0.932210753423405, 3.0392069053064414, 2.733466376856428)): shape (37, 800, 800)
      Valid pixels: 93359/640000 (14.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=293661, num_faces=293662
      Valid probs shape: (37, 93359)
    ✓ Random_17 (pose=(-2.701343721135426, 1.7899799358312167, -2.966408064465283)): shape (37, 800, 800)
      Valid pixels: 67027/640000 (10.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=28, max=293653, num_faces=293662
      Valid probs shape: (37, 67027)
    ✓ Random_18 (pose=(-0.632400725085319, 1.8154571439126288, -0.03350428941739514)): shape (37, 800, 800)
      Valid pixels: 88754/640000 (13.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=126, max=293660, num_faces=293662
      Valid probs shape: (37, 88754)
    ✓ Random_19 (pose=(0.9893999379655858, 0.36784240574329363, 1.5534088631124936)): shape (37, 800, 800)
      Valid pixels: 68431/640000 (10.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=293468, num_faces=293662
      Valid probs shape: (37, 68431)
    P stats: min=0.0000, max=1.0000, mean=0.0237
    Non-zero vertices: 128733/146833
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 18100   788  1036  3519     0  1984  1100  4493  5969]
  Ground Truth Stats:
    Labels shape: (146833,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/HLN-12-2/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7350
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8075
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8075

  RESULTS:
  RAW:         median(top-10)=0.8802, mean(top-10)=0.8851, median(all)=0.7864, mean(all)=0.7350
  + SMOOTHING: median(top-10)=0.9190, mean(top-10)=0.9235, median(all)=0.8541, mean(all)=0.8075 [+0.0388]
  + MRF:       median(top-10)=0.9195, mean(top-10)=0.9236, median(all)=0.8554, mean(all)=0.8075 [+0.0005]
  TOTAL IMPROVEMENT (median top-10): +0.0393

================================================================================
Subject: HLN-12-3
================================================================================
  Step 0: Generating predictions with V2 model (20 random views)...
  Mesh: 150991 vertices, 301978 faces
  Generating 20 random views...
  Generating predictions for 20 views (continuous camera pose)...
    ✓ Random_0 (pose=(-0.48809131370723247, 0.1808823770911272, -1.8459522608753116)): shape (37, 800, 800)
      Valid pixels: 58767/640000 (9.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=301340, num_faces=301978
      Valid probs shape: (37, 58767)
    ✓ Random_1 (pose=(-1.6954399882512083, -1.673862306984426, -0.267077962384076)): shape (37, 800, 800)
      Valid pixels: 101582/640000 (15.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=4, max=301904, num_faces=301978
      Valid probs shape: (37, 101582)
    ✓ Random_2 (pose=(0.5543917190603778, 2.9065674570206355, -0.7842920679812098)): shape (37, 800, 800)
      Valid pixels: 72805/640000 (11.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1366, max=301976, num_faces=301978
      Valid probs shape: (37, 72805)
    ✓ Random_3 (pose=(-2.0637198129136713, 0.05859806879975782, 0.9745930749095928)): shape (37, 800, 800)
      Valid pixels: 74210/640000 (11.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=830, max=301977, num_faces=301978
      Valid probs shape: (37, 74210)
    ✓ Random_4 (pose=(-2.529322812841523, -0.21993508657894534, -0.5000248733346173)): shape (37, 800, 800)
      Valid pixels: 76487/640000 (12.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=23266, max=301976, num_faces=301978
      Valid probs shape: (37, 76487)
    ✓ Random_5 (pose=(-3.1322312217263, -2.515013851086533, 1.7294090160331503)): shape (37, 800, 800)
      Valid pixels: 72439/640000 (11.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=301394, num_faces=301978
      Valid probs shape: (37, 72439)
    ✓ Random_6 (pose=(2.8729087583714827, -2.657151640200996, -0.12648817522421618)): shape (37, 800, 800)
      Valid pixels: 60438/640000 (9.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=301340, num_faces=301978
      Valid probs shape: (37, 60438)
    ✓ Random_7 (pose=(-2.7503178871587552, -2.9134954326260423, -2.1538634492081927)): shape (37, 800, 800)
      Valid pixels: 60661/640000 (9.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=301340, num_faces=301978
      Valid probs shape: (37, 60661)
    ✓ Random_8 (pose=(1.3085838426213918, 0.5381069321532426, 0.5762096414655917)): shape (37, 800, 800)
      Valid pixels: 81323/640000 (12.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=301976, num_faces=301978
      Valid probs shape: (37, 81323)
    ✓ Random_9 (pose=(2.117354274210177, 0.37798701999743045, -2.6002366958346084)): shape (37, 800, 800)
      Valid pixels: 85386/640000 (13.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=276, max=301975, num_faces=301978
      Valid probs shape: (37, 85386)
    ✓ Random_10 (pose=(-0.21063167394848614, 2.7781731513153227, 1.7099516999539377)): shape (37, 800, 800)
      Valid pixels: 60515/640000 (9.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7974, max=301976, num_faces=301978
      Valid probs shape: (37, 60515)
    ✓ Random_11 (pose=(0.8097284471527719, -1.8123653122932708, 1.3157280143151766)): shape (37, 800, 800)
      Valid pixels: 86096/640000 (13.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=301975, num_faces=301978
      Valid probs shape: (37, 86096)
    ✓ Random_12 (pose=(0.891632748219437, -1.805307963604836, -2.8078602731801956)): shape (37, 800, 800)
      Valid pixels: 100675/640000 (15.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=54, max=301968, num_faces=301978
      Valid probs shape: (37, 100675)
    ✓ Random_13 (pose=(2.9897675542530484, 0.8229269873730467, 2.6688190577427493)): shape (37, 800, 800)
      Valid pixels: 66942/640000 (10.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1561, max=301973, num_faces=301978
      Valid probs shape: (37, 66942)
    ✓ Random_14 (pose=(2.999229890584852, 2.6376292106556827, -2.4483011583188414)): shape (37, 800, 800)
      Valid pixels: 69138/640000 (10.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=0, max=301464, num_faces=301978
      Valid probs shape: (37, 69138)
    ✓ Random_15 (pose=(-1.085509202478406, -0.9301484852866415, 1.1957985142722913)): shape (37, 800, 800)
      Valid pixels: 70393/640000 (11.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=2, max=301973, num_faces=301978
      Valid probs shape: (37, 70393)
    ✓ Random_16 (pose=(0.9320521362239989, 1.1912868553983635, 0.4634393931686067)): shape (37, 800, 800)
      Valid pixels: 75480/640000 (11.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=301976, num_faces=301978
      Valid probs shape: (37, 75480)
    ✓ Random_17 (pose=(-0.5270005561825393, 0.4146998809807676, 2.215691447144783)): shape (37, 800, 800)
      Valid pixels: 59195/640000 (9.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=301788, num_faces=301978
      Valid probs shape: (37, 59195)
    ✓ Random_18 (pose=(-2.90579995243245, 0.10160961942545788, 1.9718050116740589)): shape (37, 800, 800)
      Valid pixels: 51252/640000 (8.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2358, max=301977, num_faces=301978
      Valid probs shape: (37, 51252)
    ✓ Random_19 (pose=(2.7820223681268956, 1.4918925545445658, -2.8254159056140526)): shape (37, 800, 800)
      Valid pixels: 94695/640000 (14.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=301910, num_faces=301978
      Valid probs shape: (37, 94695)
    P stats: min=0.0000, max=1.0000, mean=0.0233
    Non-zero vertices: 129999/150991
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 20992   777  1402  2815     0  2425  1211  3589  6931]
  Ground Truth Stats:
    Labels shape: (150991,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/HLN-12-3/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
    MRF iteration 5/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7186
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7975
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7977

  RESULTS:
  RAW:         median(top-10)=0.8569, mean(top-10)=0.8693, median(all)=0.7698, mean(all)=0.7186
  + SMOOTHING: median(top-10)=0.9092, mean(top-10)=0.9121, median(all)=0.8595, mean(all)=0.7975 [+0.0523]
  + MRF:       median(top-10)=0.9092, mean(top-10)=0.9122, median(all)=0.8605, mean(all)=0.7977 [-0.0000]
  TOTAL IMPROVEMENT (median top-10): +0.0522

================================================================================
Subject: HLN-12-4
================================================================================
  Step 0: Generating predictions with V2 model (20 random views)...
  Mesh: 137751 vertices, 275498 faces
  Generating 20 random views...
  Generating predictions for 20 views (continuous camera pose)...
    ✓ Random_0 (pose=(-2.9398155599061635, 2.332011159089298, 2.208247486634856)): shape (37, 800, 800)
      Valid pixels: 73963/640000 (11.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=275497, num_faces=275498
      Valid probs shape: (37, 73963)
    ✓ Random_1 (pose=(0.674985556419744, 2.814607366265596, 1.191241342159942)): shape (37, 800, 800)
      Valid pixels: 54249/640000 (8.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3933, max=275435, num_faces=275498
      Valid probs shape: (37, 54249)
    ✓ Random_2 (pose=(2.912893283218816, 0.43832409755914714, -1.9459324211410958)): shape (37, 800, 800)
      Valid pixels: 66169/640000 (10.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=17850, max=275495, num_faces=275498
      Valid probs shape: (37, 66169)
    ✓ Random_3 (pose=(2.9233140080991875, -2.4527432673097174, 0.5770491974481811)): shape (37, 800, 800)
      Valid pixels: 61619/640000 (9.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=275406, num_faces=275498
      Valid probs shape: (37, 61619)
    ✓ Random_4 (pose=(-0.497935729837776, 1.526431559393556, -1.2475006754031996)): shape (37, 800, 800)
      Valid pixels: 77301/640000 (12.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=15, max=275496, num_faces=275498
      Valid probs shape: (37, 77301)
    ✓ Random_5 (pose=(1.113770248613882, 0.4768940465386451, -2.6795667503977088)): shape (37, 800, 800)
      Valid pixels: 73696/640000 (11.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=275495, num_faces=275498
      Valid probs shape: (37, 73696)
    ✓ Random_6 (pose=(0.9039346806399431, -2.086308682982375, 0.07054553100707617)): shape (37, 800, 800)
      Valid pixels: 101296/640000 (15.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=48, max=275497, num_faces=275498
      Valid probs shape: (37, 101296)
    ✓ Random_7 (pose=(0.48753241748601406, -1.7686396036405947, -1.6120703911981191)): shape (37, 800, 800)
      Valid pixels: 82170/640000 (12.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=202, max=275495, num_faces=275498
      Valid probs shape: (37, 82170)
    ✓ Random_8 (pose=(-1.5865145876940365, -1.8547824039499738, 0.17154387266588955)): shape (37, 800, 800)
      Valid pixels: 89569/640000 (14.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=0, max=275496, num_faces=275498
      Valid probs shape: (37, 89569)
    ✓ Random_9 (pose=(2.64724956093339, 2.3397882026012526, 2.223522352984988)): shape (37, 800, 800)
      Valid pixels: 59156/640000 (9.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=275496, num_faces=275498
      Valid probs shape: (37, 59156)
    ✓ Random_10 (pose=(1.7866080145907057, 1.6405047707647027, 0.5720240308155593)): shape (37, 800, 800)
      Valid pixels: 90845/640000 (14.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=275497, num_faces=275498
      Valid probs shape: (37, 90845)
    ✓ Random_11 (pose=(-3.1175388102584547, 1.965999266857728, 2.3406187545013832)): shape (37, 800, 800)
      Valid pixels: 75116/640000 (11.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=275497, num_faces=275498
      Valid probs shape: (37, 75116)
    ✓ Random_12 (pose=(-1.0120187511506953, 2.268419826682444, 1.2805024122423)): shape (37, 800, 800)
      Valid pixels: 74768/640000 (11.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1887, max=275495, num_faces=275498
      Valid probs shape: (37, 74768)
    ✓ Random_13 (pose=(-1.4108536588334277, 0.39054348637473213, 0.5514187900336167)): shape (37, 800, 800)
      Valid pixels: 80385/640000 (12.6%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=1, max=275496, num_faces=275498
      Valid probs shape: (37, 80385)
    ✓ Random_14 (pose=(-2.9318093598058423, 0.1789735455676218, -1.5468783848570165)): shape (37, 800, 800)
      Valid pixels: 53492/640000 (8.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=49644, max=275453, num_faces=275498
      Valid probs shape: (37, 53492)
    ✓ Random_15 (pose=(0.8523718228361932, -1.5481456884443692, 2.979967283193159)): shape (37, 800, 800)
      Valid pixels: 92116/640000 (14.4%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=51, max=275424, num_faces=275498
      Valid probs shape: (37, 92116)
    ✓ Random_16 (pose=(-1.1002180907585943, 1.8536526942202602, -1.875995462172456)): shape (37, 800, 800)
      Valid pixels: 77600/640000 (12.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=48, max=275497, num_faces=275498
      Valid probs shape: (37, 77600)
    ✓ Random_17 (pose=(-1.6990709347796664, 2.4873789659368297, -2.6739885044119567)): shape (37, 800, 800)
      Valid pixels: 84666/640000 (13.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=275497, num_faces=275498
      Valid probs shape: (37, 84666)
    ✓ Random_18 (pose=(2.5827782636133048, -0.7901576410452118, 0.7389869747836428)): shape (37, 800, 800)
      Valid pixels: 57127/640000 (8.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3209, max=275437, num_faces=275498
      Valid probs shape: (37, 57127)
    ✓ Random_19 (pose=(-1.42680062319347, 2.151193942993018, -0.7666372541571147)): shape (37, 800, 800)
      Valid pixels: 91924/640000 (14.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=51, max=275424, num_faces=275498
      Valid probs shape: (37, 91924)
    P stats: min=0.0000, max=1.0000, mean=0.0239
    Non-zero vertices: 121624/137751
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 16127  1097  1119  3597     0  2230  1417  3737  6830]
  Ground Truth Stats:
    Labels shape: (137751,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/HLN-12-4/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
    MRF iteration 5/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7216
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7974
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7978

  RESULTS:
  RAW:         median(top-10)=0.8646, mean(top-10)=0.8735, median(all)=0.8119, mean(all)=0.7216
  + SMOOTHING: median(top-10)=0.9155, mean(top-10)=0.9186, median(all)=0.8649, mean(all)=0.7974 [+0.0509]
  + MRF:       median(top-10)=0.9159, mean(top-10)=0.9189, median(all)=0.8651, mean(all)=0.7978 [+0.0004]
  TOTAL IMPROVEMENT (median top-10): +0.0513

================================================================================
Subject: HLN-12-5
================================================================================
  Step 0: Generating predictions with V2 model (20 random views)...
  Mesh: 167182 vertices, 334360 faces
  Generating 20 random views...
  Generating predictions for 20 views (continuous camera pose)...
    ✓ Random_0 (pose=(-2.1089805050653867, -1.1397171607708363, -0.6165734873895792)): shape (37, 800, 800)
      Valid pixels: 97748/640000 (15.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=2406, max=334086, num_faces=334360
      Valid probs shape: (37, 97748)
    ✓ Random_1 (pose=(3.0861853877129546, -2.6086267882533405, 1.7064479553857383)): shape (37, 800, 800)
      Valid pixels: 80155/640000 (12.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=333803, num_faces=334360
      Valid probs shape: (37, 80155)
    ✓ Random_2 (pose=(1.6392544683264951, -0.18080782106722593, 0.37822338557576707)): shape (37, 800, 800)
      Valid pixels: 106078/640000 (16.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=4, max=334321, num_faces=334360
      Valid probs shape: (37, 106078)
    ✓ Random_3 (pose=(2.489636870042407, 1.6488403708522412, 3.0266665873108227)): shape (37, 800, 800)
      Valid pixels: 103091/640000 (16.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=3, max=334327, num_faces=334360
      Valid probs shape: (37, 103091)
    ✓ Random_4 (pose=(3.1128078314615664, 0.47118771856619723, 1.6213724932544729)): shape (37, 800, 800)
      Valid pixels: 72176/640000 (11.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=364, max=334350, num_faces=334360
      Valid probs shape: (37, 72176)
    ✓ Random_5 (pose=(0.5871129625122196, 2.242837368945694, 1.088799063938242)): shape (37, 800, 800)
      Valid pixels: 92223/640000 (14.4%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=15668, max=334358, num_faces=334360
      Valid probs shape: (37, 92223)
    ✓ Random_6 (pose=(2.2502829597067784, -0.5102607194231621, 1.1019782604232162)): shape (37, 800, 800)
      Valid pixels: 72616/640000 (11.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=369, max=334350, num_faces=334360
      Valid probs shape: (37, 72616)
    ✓ Random_7 (pose=(0.4703867991959849, 2.863709403051537, -0.3461095594701473)): shape (37, 800, 800)
      Valid pixels: 75080/640000 (11.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=364, max=334359, num_faces=334360
      Valid probs shape: (37, 75080)
    ✓ Random_8 (pose=(-1.4636082763918614, 2.531215389158393, -0.10925681094096529)): shape (37, 800, 800)
      Valid pixels: 112602/640000 (17.6%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=11, max=334358, num_faces=334360
      Valid probs shape: (37, 112602)
    ✓ Random_9 (pose=(2.0309280145904376, -2.4962647633855424, -1.146784129939827)): shape (37, 800, 800)
      Valid pixels: 102963/640000 (16.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=334357, num_faces=334360
      Valid probs shape: (37, 102963)
    ✓ Random_10 (pose=(2.522765935593486, 1.3495376954452345, -3.068667549493794)): shape (37, 800, 800)
      Valid pixels: 108097/640000 (16.9%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=723, max=334358, num_faces=334360
      Valid probs shape: (37, 108097)
    ✓ Random_11 (pose=(2.5651746719156705, 3.1042157888806594, -0.37088255220571487)): shape (37, 800, 800)
      Valid pixels: 80834/640000 (12.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=334330, num_faces=334360
      Valid probs shape: (37, 80834)
    ✓ Random_12 (pose=(-2.6911967526100167, 2.5178318274263605, -1.4364933561588402)): shape (37, 800, 800)
      Valid pixels: 93804/640000 (14.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=333055, num_faces=334360
      Valid probs shape: (37, 93804)
    ✓ Random_13 (pose=(2.4285579086312676, -1.1173246378337827, 0.8063664616112938)): shape (37, 800, 800)
      Valid pixels: 76100/640000 (11.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6929, max=333052, num_faces=334360
      Valid probs shape: (37, 76100)
    ✓ Random_14 (pose=(0.3925211686184764, -1.1706156722341257, 2.0394871476731344)): shape (37, 800, 800)
      Valid pixels: 89973/640000 (14.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=333737, num_faces=334360
      Valid probs shape: (37, 89973)
    ✓ Random_15 (pose=(1.4165394453200397, 1.230829309999197, -2.1813697895234307)): shape (37, 800, 800)
      Valid pixels: 86606/640000 (13.5%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=49, max=334356, num_faces=334360
      Valid probs shape: (37, 86606)
    ✓ Random_16 (pose=(-0.5397561292129822, 1.0091402624845482, 1.8035314225432728)): shape (37, 800, 800)
      Valid pixels: 82111/640000 (12.8%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=33, max=334356, num_faces=334360
      Valid probs shape: (37, 82111)
    ✓ Random_17 (pose=(-2.842315553974022, -2.4413764861078637, -1.571059690973436)): shape (37, 800, 800)
      Valid pixels: 87796/640000 (13.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=334321, num_faces=334360
      Valid probs shape: (37, 87796)
    ✓ Random_18 (pose=(2.9261613340463493, -2.8462863420938946, -1.3152682705076488)): shape (37, 800, 800)
      Valid pixels: 69277/640000 (10.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=334321, num_faces=334360
      Valid probs shape: (37, 69277)
    ✓ Random_19 (pose=(-1.0127828816018924, 0.4542937470006492, -1.1982529834385351)): shape (37, 800, 800)
      Valid pixels: 78701/640000 (12.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=333055, num_faces=334360
      Valid probs shape: (37, 78701)
    P stats: min=0.0000, max=0.9999, mean=0.0232
    Non-zero vertices: 143779/167182
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 23403  1228  1733  3421     0  2419  1105  4872  7887]
  Ground Truth Stats:
    Labels shape: (167182,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/HLN-12-5/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7128
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7996
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8002

  RESULTS:
  RAW:         median(top-10)=0.8791, mean(top-10)=0.8785, median(all)=0.7508, mean(all)=0.7128
  + SMOOTHING: median(top-10)=0.9187, mean(top-10)=0.9129, median(all)=0.8522, mean(all)=0.7996 [+0.0396]
  + MRF:       median(top-10)=0.9194, mean(top-10)=0.9135, median(all)=0.8522, mean(all)=0.8002 [+0.0007]
  TOTAL IMPROVEMENT (median top-10): +0.0402

================================================================================
Subject: HLN-12-6
================================================================================
  Step 0: Generating predictions with V2 model (20 random views)...
  Mesh: 149409 vertices, 298814 faces
  Generating 20 random views...
  Generating predictions for 20 views (continuous camera pose)...
    ✓ Random_0 (pose=(-1.0279162962773971, -2.594183111222675, 0.24731228466947863)): shape (37, 800, 800)
      Valid pixels: 78874/640000 (12.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=220, max=298809, num_faces=298814
      Valid probs shape: (37, 78874)
    ✓ Random_1 (pose=(2.4475143707601736, 0.25912730098785364, 0.49408555063066695)): shape (37, 800, 800)
      Valid pixels: 76498/640000 (12.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=19, max=298813, num_faces=298814
      Valid probs shape: (37, 76498)
    ✓ Random_2 (pose=(-0.08776678889101319, -2.65732427836447, -0.15678249291298396)): shape (37, 800, 800)
      Valid pixels: 56001/640000 (8.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1246, max=298813, num_faces=298814
      Valid probs shape: (37, 56001)
    ✓ Random_3 (pose=(1.5237391197676784, 1.2277008282161628, -1.7712931720970637)): shape (37, 800, 800)
      Valid pixels: 66855/640000 (10.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=18, max=298813, num_faces=298814
      Valid probs shape: (37, 66855)
    ✓ Random_4 (pose=(-2.145569577531619, 1.81911017419288, -2.1041678560192194)): shape (37, 800, 800)
      Valid pixels: 64747/640000 (10.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=298795, num_faces=298814
      Valid probs shape: (37, 64747)
    ✓ Random_5 (pose=(-1.6516015330635312, 2.1393736082855312, 2.3005806892928478)): shape (37, 800, 800)
      Valid pixels: 101420/640000 (15.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=298811, num_faces=298814
      Valid probs shape: (37, 101420)
    ✓ Random_6 (pose=(2.904074021281666, -2.1491977031463563, 1.5640248092739677)): shape (37, 800, 800)
      Valid pixels: 94531/640000 (14.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=298668, num_faces=298814
      Valid probs shape: (37, 94531)
    ✓ Random_7 (pose=(0.05877439081139402, 0.572540050055899, -1.1311902017239)): shape (37, 800, 800)
      Valid pixels: 64884/640000 (10.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=298711, num_faces=298814
      Valid probs shape: (37, 64884)
    ✓ Random_8 (pose=(0.6780326310428455, -1.4923552555030348, -0.5376625990206385)): shape (37, 800, 800)
      Valid pixels: 69679/640000 (10.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=11, max=298812, num_faces=298814
      Valid probs shape: (37, 69679)
    ✓ Random_9 (pose=(0.1508024122761178, 1.4998963692151026, 3.1304174740272535)): shape (37, 800, 800)
      Valid pixels: 66432/640000 (10.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8, max=298813, num_faces=298814
      Valid probs shape: (37, 66432)
    ✓ Random_10 (pose=(3.0864913858033036, -0.4991606418359811, 3.0171652809380136)): shape (37, 800, 800)
      Valid pixels: 55233/640000 (8.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1247, max=298812, num_faces=298814
      Valid probs shape: (37, 55233)
    ✓ Random_11 (pose=(-0.04112344655215461, 0.2419410953102532, -2.507863201646915)): shape (37, 800, 800)
      Valid pixels: 51770/640000 (8.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=298527, num_faces=298814
      Valid probs shape: (37, 51770)
    ✓ Random_12 (pose=(-1.8215278243536903, 3.135317971232536, -0.39697936471985784)): shape (37, 800, 800)
      Valid pixels: 102095/640000 (16.0%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=6, max=298812, num_faces=298814
      Valid probs shape: (37, 102095)
    ✓ Random_13 (pose=(2.4506968485770377, 2.2900188748518264, 2.923874619348835)): shape (37, 800, 800)
      Valid pixels: 86582/640000 (13.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=298668, num_faces=298814
      Valid probs shape: (37, 86582)
    ✓ Random_14 (pose=(-0.019497925925878068, -2.2487791292665054, 3.004075553729912)): shape (37, 800, 800)
      Valid pixels: 60335/640000 (9.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=9330, max=298812, num_faces=298814
      Valid probs shape: (37, 60335)
    ✓ Random_15 (pose=(-3.128893131082416, 0.2554422003074719, -2.220868310665709)): shape (37, 800, 800)
      Valid pixels: 59824/640000 (9.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=88461, max=298813, num_faces=298814
      Valid probs shape: (37, 59824)
    ✓ Random_16 (pose=(1.1346040461437976, -2.7658898998185832, -0.7341702440568918)): shape (37, 800, 800)
      Valid pixels: 92800/640000 (14.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=9, max=298812, num_faces=298814
      Valid probs shape: (37, 92800)
    ✓ Random_17 (pose=(0.5330072212729586, 2.743817754648136, 0.3291573924548956)): shape (37, 800, 800)
      Valid pixels: 61318/640000 (9.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3209, max=298813, num_faces=298814
      Valid probs shape: (37, 61318)
    ✓ Random_18 (pose=(3.1068458968117962, -1.5396411466466369, 2.4879839834433914)): shape (37, 800, 800)
      Valid pixels: 75537/640000 (11.8%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=18, max=298810, num_faces=298814
      Valid probs shape: (37, 75537)
    ✓ Random_19 (pose=(-0.5006808494969994, 1.482738475344413, -2.2382130777697307)): shape (37, 800, 800)
      Valid pixels: 108283/640000 (16.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=298813, num_faces=298814
      Valid probs shape: (37, 108283)
    P stats: min=0.0000, max=0.9999, mean=0.0231
    Non-zero vertices: 127817/149409
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 21592  1399  1048  3160     0  1924   967  5872  6240]
  Ground Truth Stats:
    Labels shape: (149409,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/HLN-12-6/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7189
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8017
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8019

  RESULTS:
  RAW:         median(top-10)=0.8392, mean(top-10)=0.8537, median(all)=0.7791, mean(all)=0.7189
  + SMOOTHING: median(top-10)=0.9095, mean(top-10)=0.9120, median(all)=0.8369, mean(all)=0.8017 [+0.0702]
  + MRF:       median(top-10)=0.9093, mean(top-10)=0.9122, median(all)=0.8385, mean(all)=0.8019 [-0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0701

================================================================================
Subject: HLN-12-7
================================================================================
  Step 0: Generating predictions with V2 model (20 random views)...
  Mesh: 122042 vertices, 244080 faces
  Generating 20 random views...
  Generating predictions for 20 views (continuous camera pose)...
    ✓ Random_0 (pose=(-1.7910083376426893, -1.569508555737799, -0.25450805167891444)): shape (37, 800, 800)
      Valid pixels: 95523/640000 (14.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=23, max=244079, num_faces=244080
      Valid probs shape: (37, 95523)
    ✓ Random_1 (pose=(-0.4712915155910191, 0.30803495713398465, 1.5296260162386597)): shape (37, 800, 800)
      Valid pixels: 62068/640000 (9.7%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=6, max=243703, num_faces=244080
      Valid probs shape: (37, 62068)
    ✓ Random_2 (pose=(-3.0629191801129525, -0.9676013710022455, -2.511586861787009)): shape (37, 800, 800)
      Valid pixels: 83418/640000 (13.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=68, max=244079, num_faces=244080
      Valid probs shape: (37, 83418)
    ✓ Random_3 (pose=(-0.592812737518384, -1.8601275854495944, -1.2061277168632378)): shape (37, 800, 800)
      Valid pixels: 92601/640000 (14.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=103, max=244079, num_faces=244080
      Valid probs shape: (37, 92601)
    ✓ Random_4 (pose=(-2.741624294745663, -1.1497331845433914, 0.9902020003011041)): shape (37, 800, 800)
      Valid pixels: 89522/640000 (14.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=125, max=244079, num_faces=244080
      Valid probs shape: (37, 89522)
    ✓ Random_5 (pose=(-2.270711426278667, 2.4253632196248898, -1.861482947029079)): shape (37, 800, 800)
      Valid pixels: 69522/640000 (10.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=243807, num_faces=244080
      Valid probs shape: (37, 69522)
    ✓ Random_6 (pose=(0.6742017323356664, 1.4742909545340739, -0.030986247834983605)): shape (37, 800, 800)
      Valid pixels: 78816/640000 (12.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=243895, num_faces=244080
      Valid probs shape: (37, 78816)
    ✓ Random_7 (pose=(1.7738212504378073, 2.96508717561687, -0.30429602341773965)): shape (37, 800, 800)
      Valid pixels: 99100/640000 (15.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=244000, num_faces=244080
      Valid probs shape: (37, 99100)
    ✓ Random_8 (pose=(2.614557564458493, 1.0598660296384157, -0.7006834809057079)): shape (37, 800, 800)
      Valid pixels: 69541/640000 (10.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=708, max=244079, num_faces=244080
      Valid probs shape: (37, 69541)
    ✓ Random_9 (pose=(1.775403141827688, 1.821016319216107, 2.043451994475353)): shape (37, 800, 800)
      Valid pixels: 76561/640000 (12.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=244076, num_faces=244080
      Valid probs shape: (37, 76561)
    ✓ Random_10 (pose=(0.529864650967057, 1.7226885280452668, 0.5308683744795597)): shape (37, 800, 800)
      Valid pixels: 66725/640000 (10.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=244079, num_faces=244080
      Valid probs shape: (37, 66725)
    ✓ Random_11 (pose=(2.51856262439292, 0.738193805606822, 2.2069465141126763)): shape (37, 800, 800)
      Valid pixels: 63560/640000 (9.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=19, max=244076, num_faces=244080
      Valid probs shape: (37, 63560)
    ✓ Random_12 (pose=(-0.5654118455789021, -2.363032459418671, -0.9552747225109894)): shape (37, 800, 800)
      Valid pixels: 83792/640000 (13.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2289, max=244079, num_faces=244080
      Valid probs shape: (37, 83792)
    ✓ Random_13 (pose=(-0.21605390565775284, -1.0199792742830245, 1.6338888448200573)): shape (37, 800, 800)
      Valid pixels: 87302/640000 (13.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=243990, num_faces=244080
      Valid probs shape: (37, 87302)
    ✓ Random_14 (pose=(2.083688510062629, 2.1765804626554397, 1.4057605408666367)): shape (37, 800, 800)
      Valid pixels: 75213/640000 (11.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=243892, num_faces=244080
      Valid probs shape: (37, 75213)
    ✓ Random_15 (pose=(0.923018140777093, -0.15724434289303568, 2.365047683754555)): shape (37, 800, 800)
      Valid pixels: 79232/640000 (12.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=243810, num_faces=244080
      Valid probs shape: (37, 79232)
    ✓ Random_16 (pose=(2.6869197986005826, -1.237172624516043, 0.6962391304899684)): shape (37, 800, 800)
      Valid pixels: 73129/640000 (11.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=415, max=244076, num_faces=244080
      Valid probs shape: (37, 73129)
    ✓ Random_17 (pose=(-0.06955138622404755, 0.6250487995692273, 0.07068701049623538)): shape (37, 800, 800)
      Valid pixels: 60064/640000 (9.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=243809, num_faces=244080
      Valid probs shape: (37, 60064)
    ✓ Random_18 (pose=(-1.560345055898792, 2.8204972511317665, -2.3726871869842245)): shape (37, 800, 800)
      Valid pixels: 80496/640000 (12.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=243897, num_faces=244080
      Valid probs shape: (37, 80496)
    ✓ Random_19 (pose=(0.9860110859561964, -0.7868383391061693, 1.922546202799733)): shape (37, 800, 800)
      Valid pixels: 65577/640000 (10.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=243845, num_faces=244080
      Valid probs shape: (37, 65577)
    P stats: min=0.0000, max=1.0000, mean=0.0239
    Non-zero vertices: 107768/122042
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 14274   648  1182  3089     0  1756   663  3814  4237]
  Ground Truth Stats:
    Labels shape: (122042,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/HLN-12-7/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7568
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8248
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8253

  RESULTS:
  RAW:         median(top-10)=0.8750, mean(top-10)=0.8870, median(all)=0.7942, mean(all)=0.7568
  + SMOOTHING: median(top-10)=0.9201, mean(top-10)=0.9198, median(all)=0.8676, mean(all)=0.8248 [+0.0451]
  + MRF:       median(top-10)=0.9209, mean(top-10)=0.9201, median(all)=0.8682, mean(all)=0.8253 [+0.0008]
  TOTAL IMPROVEMENT (median top-10): +0.0458

================================================================================
Subject: HLN-12-8
================================================================================
  Step 0: Generating predictions with V2 model (20 random views)...
  Mesh: 163705 vertices, 327406 faces
  Generating 20 random views...
  Generating predictions for 20 views (continuous camera pose)...
    ✓ Random_0 (pose=(0.19260150625195394, 1.4917253828324375, -2.9474688481692506)): shape (37, 800, 800)
      Valid pixels: 63913/640000 (10.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=15, max=327271, num_faces=327406
      Valid probs shape: (37, 63913)
    ✓ Random_1 (pose=(-0.592551990155274, -0.970886894849849, 2.3151473609485285)): shape (37, 800, 800)
      Valid pixels: 90238/640000 (14.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=13, max=327271, num_faces=327406
      Valid probs shape: (37, 90238)
    ✓ Random_2 (pose=(1.9798602924714803, 0.7588945030171117, 1.971892031255865)): shape (37, 800, 800)
      Valid pixels: 65219/640000 (10.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=618, max=327404, num_faces=327406
      Valid probs shape: (37, 65219)
    ✓ Random_3 (pose=(-0.03520650524417457, 2.7899075507493434, -1.9011667137546664)): shape (37, 800, 800)
      Valid pixels: 48762/640000 (7.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=522, max=327405, num_faces=327406
      Valid probs shape: (37, 48762)
    ✓ Random_4 (pose=(-1.5699366815427493, 1.0713629781499296, 1.113940734974757)): shape (37, 800, 800)
      Valid pixels: 70183/640000 (11.0%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=5, max=327390, num_faces=327406
      Valid probs shape: (37, 70183)
    ✓ Random_5 (pose=(0.7427020954428687, 0.1458106947713005, 2.4112140000374893)): shape (37, 800, 800)
      Valid pixels: 72674/640000 (11.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=327314, num_faces=327406
      Valid probs shape: (37, 72674)
    ✓ Random_6 (pose=(2.891600635592746, -0.7046287499312509, 0.17608024892196372)): shape (37, 800, 800)
      Valid pixels: 53032/640000 (8.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=11183, max=327405, num_faces=327406
      Valid probs shape: (37, 53032)
    ✓ Random_7 (pose=(1.5747586759471943, -0.6791081515789168, 2.571575579584664)): shape (37, 800, 800)
      Valid pixels: 96512/640000 (15.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=5, max=327392, num_faces=327406
      Valid probs shape: (37, 96512)
    ✓ Random_8 (pose=(-0.7347752635819282, -1.6387250929041908, -0.25555981785517146)): shape (37, 800, 800)
      Valid pixels: 78238/640000 (12.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=14, max=327404, num_faces=327406
      Valid probs shape: (37, 78238)
    ✓ Random_9 (pose=(-2.17572671245073, 1.8545123867054798, -1.631135371323064)): shape (37, 800, 800)
      Valid pixels: 83678/640000 (13.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=11, max=327403, num_faces=327406
      Valid probs shape: (37, 83678)
    ✓ Random_10 (pose=(-2.7842381603452493, -2.0887214351960237, -2.7109953982247874)): shape (37, 800, 800)
      Valid pixels: 86918/640000 (13.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=327191, num_faces=327406
      Valid probs shape: (37, 86918)
    ✓ Random_11 (pose=(3.136940260089583, 0.6232939919290073, 0.4051434653584698)): shape (37, 800, 800)
      Valid pixels: 56678/640000 (8.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=60, max=327405, num_faces=327406
      Valid probs shape: (37, 56678)
    ✓ Random_12 (pose=(-1.4395778872028007, -1.3503587564298072, 0.4269290061127924)): shape (37, 800, 800)
      Valid pixels: 78027/640000 (12.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=15, max=327402, num_faces=327406
      Valid probs shape: (37, 78027)
    ✓ Random_13 (pose=(0.8512726588984658, 2.7044299853766525, -1.4026228810167907)): shape (37, 800, 800)
      Valid pixels: 73327/640000 (11.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=114, max=327393, num_faces=327406
      Valid probs shape: (37, 73327)
    ✓ Random_14 (pose=(1.4113156276902723, 2.475551112448315, -0.16621011797536944)): shape (37, 800, 800)
      Valid pixels: 100813/640000 (15.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=2, max=327264, num_faces=327406
      Valid probs shape: (37, 100813)
    ✓ Random_15 (pose=(-1.6099166831408833, -2.4494026179804638, 1.0025201785013378)): shape (37, 800, 800)
      Valid pixels: 71512/640000 (11.2%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=20, max=327402, num_faces=327406
      Valid probs shape: (37, 71512)
    ✓ Random_16 (pose=(-0.6019222043803669, 0.5454359987138733, 1.1772310392706444)): shape (37, 800, 800)
      Valid pixels: 62948/640000 (9.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=6, max=326966, num_faces=327406
      Valid probs shape: (37, 62948)
    ✓ Random_17 (pose=(-0.9100845738583585, -0.7628035007293845, -2.145348515571471)): shape (37, 800, 800)
      Valid pixels: 60181/640000 (9.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=327390, num_faces=327406
      Valid probs shape: (37, 60181)
    ✓ Random_18 (pose=(-3.036321506915509, 1.0927442575861495, -0.4007676689637245)): shape (37, 800, 800)
      Valid pixels: 69853/640000 (10.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1814, max=327404, num_faces=327406
      Valid probs shape: (37, 69853)
    ✓ Random_19 (pose=(2.4075832400967974, -2.292988650499403, 0.8611289306355614)): shape (37, 800, 800)
      Valid pixels: 59697/640000 (9.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=327390, num_faces=327406
      Valid probs shape: (37, 59697)
    P stats: min=0.0000, max=1.0000, mean=0.0240
    Non-zero vertices: 145533/163705
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 18172   947  1312  3443     0  2179  1379  5605  6734]
  Ground Truth Stats:
    Labels shape: (163705,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/HLN-12-8/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
    MRF iteration 5/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7228
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7946
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7948

  RESULTS:
  RAW:         median(top-10)=0.8704, mean(top-10)=0.8688, median(all)=0.7705, mean(all)=0.7228
  + SMOOTHING: median(top-10)=0.8989, mean(top-10)=0.9065, median(all)=0.8095, mean(all)=0.7946 [+0.0285]
  + MRF:       median(top-10)=0.8998, mean(top-10)=0.9070, median(all)=0.8094, mean(all)=0.7948 [+0.0009]
  TOTAL IMPROVEMENT (median top-10): +0.0294

================================================================================
Subject: HLN-12-9
================================================================================
  Step 0: Generating predictions with V2 model (20 random views)...
  Mesh: 137393 vertices, 274782 faces
  Generating 20 random views...
  Generating predictions for 20 views (continuous camera pose)...
    ✓ Random_0 (pose=(-3.071276307486239, 1.7430552733245284, 1.6536514025380127)): shape (37, 800, 800)
      Valid pixels: 103021/640000 (16.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=14, max=274781, num_faces=274782
      Valid probs shape: (37, 103021)
    ✓ Random_1 (pose=(-1.6076002339799138, -1.2416578013298252, -2.923796242612402)): shape (37, 800, 800)
      Valid pixels: 99308/640000 (15.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=274781, num_faces=274782
      Valid probs shape: (37, 99308)
    ✓ Random_2 (pose=(1.9765291720485294, 2.8832907004169828, 1.9436666540992382)): shape (37, 800, 800)
      Valid pixels: 78683/640000 (12.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=274759, num_faces=274782
      Valid probs shape: (37, 78683)
    ✓ Random_3 (pose=(-0.8356321666377027, 0.8799065719800421, 1.4276136314597698)): shape (37, 800, 800)
      Valid pixels: 70183/640000 (11.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=274778, num_faces=274782
      Valid probs shape: (37, 70183)
    ✓ Random_4 (pose=(2.6722453806069018, 1.90815017559125, -2.224165379261609)): shape (37, 800, 800)
      Valid pixels: 96880/640000 (15.1%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=1, max=274759, num_faces=274782
      Valid probs shape: (37, 96880)
    ✓ Random_5 (pose=(1.7170482764491624, 1.8143613979398783, 2.8993583512166783)): shape (37, 800, 800)
      Valid pixels: 103451/640000 (16.2%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=8, max=274759, num_faces=274782
      Valid probs shape: (37, 103451)
    ✓ Random_6 (pose=(-2.4055019539133125, -0.29205917682994675, 0.39352403770470357)): shape (37, 800, 800)
      Valid pixels: 83987/640000 (13.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7529, max=274781, num_faces=274782
      Valid probs shape: (37, 83987)
    ✓ Random_7 (pose=(-0.39174553090924613, 1.6006907387560654, -3.122613157774747)): shape (37, 800, 800)
      Valid pixels: 89865/640000 (14.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=70, max=274773, num_faces=274782
      Valid probs shape: (37, 89865)
    ✓ Random_8 (pose=(1.2980881294676658, 0.12927653597493372, 0.3320933331060707)): shape (37, 800, 800)
      Valid pixels: 90558/640000 (14.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=274781, num_faces=274782
      Valid probs shape: (37, 90558)
    ✓ Random_9 (pose=(-2.6472651464685333, -2.4585660820520974, -2.3922170197885917)): shape (37, 800, 800)
      Valid pixels: 84627/640000 (13.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=274781, num_faces=274782
      Valid probs shape: (37, 84627)
    ✓ Random_10 (pose=(0.7932277206212639, 1.724997613247922, 1.5341922292889736)): shape (37, 800, 800)
      Valid pixels: 100429/640000 (15.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=8, max=274759, num_faces=274782
      Valid probs shape: (37, 100429)
    ✓ Random_11 (pose=(0.779133265990013, 1.4778486914442865, 3.074464365351793)): shape (37, 800, 800)
      Valid pixels: 77423/640000 (12.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=274780, num_faces=274782
      Valid probs shape: (37, 77423)
    ✓ Random_12 (pose=(-0.8658326501624773, -0.4986928581658767, 0.9875113011784347)): shape (37, 800, 800)
      Valid pixels: 60349/640000 (9.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=274780, num_faces=274782
      Valid probs shape: (37, 60349)
    ✓ Random_13 (pose=(2.51194536979163, -2.46929798403474, 2.3646967656081905)): shape (37, 800, 800)
      Valid pixels: 84566/640000 (13.2%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=0, max=274699, num_faces=274782
      Valid probs shape: (37, 84566)
    ✓ Random_14 (pose=(-0.30291116692674613, -1.4014191449253324, -1.8231958623343336)): shape (37, 800, 800)
      Valid pixels: 102635/640000 (16.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=3, max=274759, num_faces=274782
      Valid probs shape: (37, 102635)
    ✓ Random_15 (pose=(-1.300695260044226, -3.0934123229278416, 2.8432572054670215)): shape (37, 800, 800)
      Valid pixels: 106489/640000 (16.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=110, max=274781, num_faces=274782
      Valid probs shape: (37, 106489)
    ✓ Random_16 (pose=(-1.6314741182189534, -0.5029554293531033, 2.481607997152408)): shape (37, 800, 800)
      Valid pixels: 106114/640000 (16.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=44, max=274779, num_faces=274782
      Valid probs shape: (37, 106114)
    ✓ Random_17 (pose=(-2.4108961223196204, 0.5330373678225211, 1.3625884905891796)): shape (37, 800, 800)
      Valid pixels: 73922/640000 (11.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1112, max=274780, num_faces=274782
      Valid probs shape: (37, 73922)
    ✓ Random_18 (pose=(0.4251962590494669, -2.186848183346141, -0.0672131455462579)): shape (37, 800, 800)
      Valid pixels: 83588/640000 (13.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=308, max=274780, num_faces=274782
      Valid probs shape: (37, 83588)
    ✓ Random_19 (pose=(-0.4163480023553432, -0.6705986264047095, -1.9441224556859291)): shape (37, 800, 800)
      Valid pixels: 77569/640000 (12.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=274759, num_faces=274782
      Valid probs shape: (37, 77569)
    P stats: min=0.0000, max=0.9999, mean=0.0247
    Non-zero vertices: 125335/137393
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 12058  1152  1053  2853     0  2267  1097  4476  6157]
  Ground Truth Stats:
    Labels shape: (137393,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/HLN-12-9/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7726
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8369
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8370

  RESULTS:
  RAW:         median(top-10)=0.8894, mean(top-10)=0.8983, median(all)=0.8533, mean(all)=0.7726
  + SMOOTHING: median(top-10)=0.9388, mean(top-10)=0.9396, median(all)=0.8974, mean(all)=0.8369 [+0.0494]
  + MRF:       median(top-10)=0.9387, mean(top-10)=0.9396, median(all)=0.8968, mean(all)=0.8370 [-0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0493

================================================================================
Subject: MMRR-21-1
================================================================================
  Step 0: Generating predictions with V2 model (20 random views)...
  Mesh: 130631 vertices, 261258 faces
  Generating 20 random views...
  Generating predictions for 20 views (continuous camera pose)...
    ✓ Random_0 (pose=(0.6329570122718406, 2.398399949901232, -2.651512962363405)): shape (37, 800, 800)
      Valid pixels: 61931/640000 (9.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1932, max=261255, num_faces=261258
      Valid probs shape: (37, 61931)
    ✓ Random_1 (pose=(0.33048381441373564, -2.519994083202078, 1.4981601478181563)): shape (37, 800, 800)
      Valid pixels: 62980/640000 (9.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=315, max=261254, num_faces=261258
      Valid probs shape: (37, 62980)
    ✓ Random_2 (pose=(-2.578149419942941, -0.3925459200646193, 1.5739460997681816)): shape (37, 800, 800)
      Valid pixels: 59109/640000 (9.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2019, max=261255, num_faces=261258
      Valid probs shape: (37, 59109)
    ✓ Random_3 (pose=(-2.5959368608847546, -2.6907285189115453, 0.9873716452181824)): shape (37, 800, 800)
      Valid pixels: 64104/640000 (10.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=261248, num_faces=261258
      Valid probs shape: (37, 64104)
    ✓ Random_4 (pose=(1.361274687870452, -0.6272388717197064, 1.7215501863752332)): shape (37, 800, 800)
      Valid pixels: 57735/640000 (9.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=261245, num_faces=261258
      Valid probs shape: (37, 57735)
    ✓ Random_5 (pose=(1.9821414293531747, 2.8871551517258958, 0.6649898515634431)): shape (37, 800, 800)
      Valid pixels: 78384/640000 (12.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=261192, num_faces=261258
      Valid probs shape: (37, 78384)
    ✓ Random_6 (pose=(1.1837900621870823, -1.891987387463167, -1.7820093920167066)): shape (37, 800, 800)
      Valid pixels: 69427/640000 (10.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=143, max=261256, num_faces=261258
      Valid probs shape: (37, 69427)
    ✓ Random_7 (pose=(1.6213453038083872, -2.1707953620227425, 1.8876645183016167)): shape (37, 800, 800)
      Valid pixels: 74235/640000 (11.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=261257, num_faces=261258
      Valid probs shape: (37, 74235)
    ✓ Random_8 (pose=(0.6821766215233214, -2.8561253138536697, 2.4604128179786855)): shape (37, 800, 800)
      Valid pixels: 67599/640000 (10.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=16751, max=261257, num_faces=261258
      Valid probs shape: (37, 67599)
    ✓ Random_9 (pose=(-1.7645073459891503, -0.2608156241525852, 2.471284234116661)): shape (37, 800, 800)
      Valid pixels: 96063/640000 (15.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=56, max=261199, num_faces=261258
      Valid probs shape: (37, 96063)
    ✓ Random_10 (pose=(0.19955643284190927, -1.2040665863554352, 1.7523640365613575)): shape (37, 800, 800)
      Valid pixels: 84936/640000 (13.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=261198, num_faces=261258
      Valid probs shape: (37, 84936)
    ✓ Random_11 (pose=(-2.144069721783798, 2.0724757392454176, 0.7358770622429951)): shape (37, 800, 800)
      Valid pixels: 61979/640000 (9.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=10, max=261255, num_faces=261258
      Valid probs shape: (37, 61979)
    ✓ Random_12 (pose=(-0.30084924360119514, 1.2319333035659312, -2.189304421296298)): shape (37, 800, 800)
      Valid pixels: 95198/640000 (14.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=261191, num_faces=261258
      Valid probs shape: (37, 95198)
    ✓ Random_13 (pose=(-2.623811180221016, -2.628994826541821, 1.0300038369935196)): shape (37, 800, 800)
      Valid pixels: 65766/640000 (10.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=261249, num_faces=261258
      Valid probs shape: (37, 65766)
    ✓ Random_14 (pose=(0.26177782142934714, -3.0878123448164674, -1.093095194567923)): shape (37, 800, 800)
      Valid pixels: 41165/640000 (6.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1661, max=261254, num_faces=261258
      Valid probs shape: (37, 41165)
    ✓ Random_15 (pose=(-1.062202796831245, 2.8368828626886833, -0.5703641018879089)): shape (37, 800, 800)
      Valid pixels: 86368/640000 (13.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5004, max=261257, num_faces=261258
      Valid probs shape: (37, 86368)
    ✓ Random_16 (pose=(2.9170290310991867, 2.6757402921396194, 2.372057218771448)): shape (37, 800, 800)
      Valid pixels: 49742/640000 (7.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=260717, num_faces=261258
      Valid probs shape: (37, 49742)
    ✓ Random_17 (pose=(2.1050395493131875, 2.9948674004226383, 0.7174047762270761)): shape (37, 800, 800)
      Valid pixels: 73116/640000 (11.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=261197, num_faces=261258
      Valid probs shape: (37, 73116)
    ✓ Random_18 (pose=(-2.3437441513043717, 0.4980669187736626, -2.847266457448975)): shape (37, 800, 800)
      Valid pixels: 65412/640000 (10.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=14, max=261254, num_faces=261258
      Valid probs shape: (37, 65412)
    ✓ Random_19 (pose=(0.8705917971990029, 2.146678154636265, 1.1452823556389982)): shape (37, 800, 800)
      Valid pixels: 63557/640000 (9.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1372, max=261257, num_faces=261258
      Valid probs shape: (37, 63557)
    P stats: min=0.0000, max=1.0000, mean=0.0236
    Non-zero vertices: 113852/130631
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 35]
    Pred label counts: [    0 16779   635  1092  3008     0  1650   861  4788  5236]
  Ground Truth Stats:
    Labels shape: (130631,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-1/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7346
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=33
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8089
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=33
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8090

  RESULTS:
  RAW:         median(top-10)=0.8729, mean(top-10)=0.8852, median(all)=0.7992, mean(all)=0.7346
  + SMOOTHING: median(top-10)=0.9231, mean(top-10)=0.9281, median(all)=0.8779, mean(all)=0.8089 [+0.0501]
  + MRF:       median(top-10)=0.9234, mean(top-10)=0.9282, median(all)=0.8786, mean(all)=0.8090 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0504

================================================================================
Subject: MMRR-21-10
================================================================================
  Step 0: Generating predictions with V2 model (20 random views)...
  Mesh: 148162 vertices, 296320 faces
  Generating 20 random views...
  Generating predictions for 20 views (continuous camera pose)...
    ✓ Random_0 (pose=(-2.7689112444896162, -0.009139317450435502, -2.7905318429012316)): shape (37, 800, 800)
      Valid pixels: 50113/640000 (7.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2740, max=296319, num_faces=296320
      Valid probs shape: (37, 50113)
    ✓ Random_1 (pose=(1.908999432044534, 1.0326877048263308, 2.17484729359333)): shape (37, 800, 800)
      Valid pixels: 70306/640000 (11.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=13, max=296313, num_faces=296320
      Valid probs shape: (37, 70306)
    ✓ Random_2 (pose=(1.3805721931184038, -2.022695714425459, 3.1020928987636642)): shape (37, 800, 800)
      Valid pixels: 94731/640000 (14.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=37, max=296313, num_faces=296320
      Valid probs shape: (37, 94731)
    ✓ Random_3 (pose=(0.279068550219844, 2.1478232588397512, -2.455726353602278)): shape (37, 800, 800)
      Valid pixels: 69137/640000 (10.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=89, max=296318, num_faces=296320
      Valid probs shape: (37, 69137)
    ✓ Random_4 (pose=(-0.5552398887201093, 0.0994365898866798, 0.8814898758610488)): shape (37, 800, 800)
      Valid pixels: 55995/640000 (8.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=296091, num_faces=296320
      Valid probs shape: (37, 55995)
    ✓ Random_5 (pose=(-0.32603329706123585, -0.4165725341842079, 2.953750712808141)): shape (37, 800, 800)
      Valid pixels: 59564/640000 (9.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=296093, num_faces=296320
      Valid probs shape: (37, 59564)
    ✓ Random_6 (pose=(-1.5278088338531597, 1.0167140832881092, -1.5650629934148435)): shape (37, 800, 800)
      Valid pixels: 60906/640000 (9.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=296313, num_faces=296320
      Valid probs shape: (37, 60906)
    ✓ Random_7 (pose=(-0.6142483718306075, 1.0099418051535283, -1.298589115975201)): shape (37, 800, 800)
      Valid pixels: 69457/640000 (10.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=296313, num_faces=296320
      Valid probs shape: (37, 69457)
    ✓ Random_8 (pose=(0.17366159974339102, 2.2659709679289888, -3.0143284975733837)): shape (37, 800, 800)
      Valid pixels: 61378/640000 (9.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=105, max=296319, num_faces=296320
      Valid probs shape: (37, 61378)
    ✓ Random_9 (pose=(1.3443827085907278, -0.4644435556347166, 1.2578654122601378)): shape (37, 800, 800)
      Valid pixels: 68388/640000 (10.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=296310, num_faces=296320
      Valid probs shape: (37, 68388)
    ✓ Random_10 (pose=(-2.3971380293813644, 1.6656322992094497, -2.3417258249685364)): shape (37, 800, 800)
      Valid pixels: 60386/640000 (9.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=296313, num_faces=296320
      Valid probs shape: (37, 60386)
    ✓ Random_11 (pose=(2.577526071844318, 1.5030975455253337, 0.7031333641884703)): shape (37, 800, 800)
      Valid pixels: 99929/640000 (15.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=8, max=296319, num_faces=296320
      Valid probs shape: (37, 99929)
    ✓ Random_12 (pose=(0.2412159524139379, 1.864905780381485, 1.4348110131986278)): shape (37, 800, 800)
      Valid pixels: 93494/640000 (14.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=296313, num_faces=296320
      Valid probs shape: (37, 93494)
    ✓ Random_13 (pose=(-2.927322258239771, 1.3850118824812379, 0.6888798544008177)): shape (37, 800, 800)
      Valid pixels: 80608/640000 (12.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=12, max=296318, num_faces=296320
      Valid probs shape: (37, 80608)
    ✓ Random_14 (pose=(2.2872303715994473, -0.2684734968773075, 2.1983757122983034)): shape (37, 800, 800)
      Valid pixels: 80556/640000 (12.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=18737, max=296318, num_faces=296320
      Valid probs shape: (37, 80556)
    ✓ Random_15 (pose=(-1.5280489854013288, -2.181748492340448, -3.0230975085707943)): shape (37, 800, 800)
      Valid pixels: 95423/640000 (14.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=296319, num_faces=296320
      Valid probs shape: (37, 95423)
    ✓ Random_16 (pose=(1.240648708341566, -0.7062101420362681, -0.1647720245358526)): shape (37, 800, 800)
      Valid pixels: 96299/640000 (15.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=296318, num_faces=296320
      Valid probs shape: (37, 96299)
    ✓ Random_17 (pose=(-0.06473131658754694, 0.23586452933384416, 0.6484009781593123)): shape (37, 800, 800)
      Valid pixels: 49399/640000 (7.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=293634, num_faces=296320
      Valid probs shape: (37, 49399)
    ✓ Random_18 (pose=(-2.0164546629008564, 1.9335864834970025, 3.109270072261957)): shape (37, 800, 800)
      Valid pixels: 87478/640000 (13.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=296291, num_faces=296320
      Valid probs shape: (37, 87478)
    ✓ Random_19 (pose=(-0.8049244909915743, -2.072575233054171, -2.565808989053247)): shape (37, 800, 800)
      Valid pixels: 64850/640000 (10.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=296313, num_faces=296320
      Valid probs shape: (37, 64850)
    P stats: min=0.0000, max=0.9999, mean=0.0235
    Non-zero vertices: 128713/148162
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 19449   929   980  3535     0  2747  1201  4603  6367]
  Ground Truth Stats:
    Labels shape: (148162,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-10/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7384
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8175
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8178

  RESULTS:
  RAW:         median(top-10)=0.8766, mean(top-10)=0.8840, median(all)=0.8016, mean(all)=0.7384
  + SMOOTHING: median(top-10)=0.9146, mean(top-10)=0.9177, median(all)=0.8630, mean(all)=0.8175 [+0.0380]
  + MRF:       median(top-10)=0.9149, mean(top-10)=0.9180, median(all)=0.8626, mean(all)=0.8178 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0383

================================================================================
Subject: MMRR-21-11
================================================================================
  Step 0: Generating predictions with V2 model (20 random views)...
  Mesh: 136982 vertices, 273960 faces
  Generating 20 random views...
  Generating predictions for 20 views (continuous camera pose)...
    ✓ Random_0 (pose=(-0.3755167211831951, -1.5552881652743287, 0.01688741503564417)): shape (37, 800, 800)
      Valid pixels: 75308/640000 (11.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=5, max=273954, num_faces=273960
      Valid probs shape: (37, 75308)
    ✓ Random_1 (pose=(2.039761841412064, 1.2961400064043316, -2.509194805828339)): shape (37, 800, 800)
      Valid pixels: 95816/640000 (15.0%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=30, max=273957, num_faces=273960
      Valid probs shape: (37, 95816)
    ✓ Random_2 (pose=(-1.2538078562851216, -1.1753813352197473, 2.775321315674227)): shape (37, 800, 800)
      Valid pixels: 110671/640000 (17.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=273959, num_faces=273960
      Valid probs shape: (37, 110671)
    ✓ Random_3 (pose=(3.0952020312375694, -1.388465607449614, -2.9786486508677483)): shape (37, 800, 800)
      Valid pixels: 77115/640000 (12.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=273953, num_faces=273960
      Valid probs shape: (37, 77115)
    ✓ Random_4 (pose=(-1.3295327620902346, -1.027446868286741, -0.4907114511255548)): shape (37, 800, 800)
      Valid pixels: 107894/640000 (16.9%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=9, max=273951, num_faces=273960
      Valid probs shape: (37, 107894)
    ✓ Random_5 (pose=(0.2577904693003572, 0.14731080738815683, -0.057718134559976875)): shape (37, 800, 800)
      Valid pixels: 59526/640000 (9.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=273741, num_faces=273960
      Valid probs shape: (37, 59526)
    ✓ Random_6 (pose=(-0.7225463341070832, -1.9206168319792545, 3.126011466770004)): shape (37, 800, 800)
      Valid pixels: 81830/640000 (12.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=28, max=273641, num_faces=273960
      Valid probs shape: (37, 81830)
    ✓ Random_7 (pose=(0.4662539147019156, 1.8362210377314607, -0.24483251580448018)): shape (37, 800, 800)
      Valid pixels: 80851/640000 (12.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=273958, num_faces=273960
      Valid probs shape: (37, 80851)
    ✓ Random_8 (pose=(2.031426859330808, 1.2657854531128194, 2.566752362703303)): shape (37, 800, 800)
      Valid pixels: 95910/640000 (15.0%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=164, max=273952, num_faces=273960
      Valid probs shape: (37, 95910)
    ✓ Random_9 (pose=(-0.28194914471805754, 0.5867787568837328, 1.4701192265399277)): shape (37, 800, 800)
      Valid pixels: 72233/640000 (11.3%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=1, max=273951, num_faces=273960
      Valid probs shape: (37, 72233)
    ✓ Random_10 (pose=(0.43237300189673666, -2.5202057754063696, 1.2744970085137854)): shape (37, 800, 800)
      Valid pixels: 75164/640000 (11.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=146, max=273954, num_faces=273960
      Valid probs shape: (37, 75164)
    ✓ Random_11 (pose=(-2.0812867149503447, -0.11741820291167171, -0.5839617251452704)): shape (37, 800, 800)
      Valid pixels: 97709/640000 (15.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=6528, max=273955, num_faces=273960
      Valid probs shape: (37, 97709)
    ✓ Random_12 (pose=(0.07905526747794811, 2.8050397342968614, -2.4430805383221372)): shape (37, 800, 800)
      Valid pixels: 60167/640000 (9.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1779, max=273956, num_faces=273960
      Valid probs shape: (37, 60167)
    ✓ Random_13 (pose=(-0.49177918254647324, -1.3375233473733916, -2.772054169309535)): shape (37, 800, 800)
      Valid pixels: 71067/640000 (11.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=273203, num_faces=273960
      Valid probs shape: (37, 71067)
    ✓ Random_14 (pose=(-3.0974256010197543, 0.3349896303522053, -0.29071364728192606)): shape (37, 800, 800)
      Valid pixels: 61376/640000 (9.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=9133, max=273959, num_faces=273960
      Valid probs shape: (37, 61376)
    ✓ Random_15 (pose=(0.7234712614277616, 1.4593617132986534, 0.1783926165060068)): shape (37, 800, 800)
      Valid pixels: 79474/640000 (12.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=273643, num_faces=273960
      Valid probs shape: (37, 79474)
    ✓ Random_16 (pose=(-1.9172671619784516, 0.28537189251294937, -0.5859194537689087)): shape (37, 800, 800)
      Valid pixels: 103669/640000 (16.2%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=1836, max=273954, num_faces=273960
      Valid probs shape: (37, 103669)
    ✓ Random_17 (pose=(-0.17509027249740328, 1.9417625824174145, 2.384897643209186)): shape (37, 800, 800)
      Valid pixels: 79533/640000 (12.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=159, max=273957, num_faces=273960
      Valid probs shape: (37, 79533)
    ✓ Random_18 (pose=(-0.3108195442888335, -3.0799026468617647, 1.1169235663588974)): shape (37, 800, 800)
      Valid pixels: 59796/640000 (9.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=9030, max=273959, num_faces=273960
      Valid probs shape: (37, 59796)
    ✓ Random_19 (pose=(-0.4028259980406048, 0.9869625315226145, 0.9995771111682439)): shape (37, 800, 800)
      Valid pixels: 97054/640000 (15.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=6, max=273951, num_faces=273960
      Valid probs shape: (37, 97054)
    P stats: min=0.0000, max=0.9999, mean=0.0247
    Non-zero vertices: 125059/136982
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 11923  1594   760  1972     0  2024  1090  4802  6640]
  Ground Truth Stats:
    Labels shape: (136982,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-11/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6769
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7265
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7269

  RESULTS:
  RAW:         median(top-10)=0.8612, mean(top-10)=0.8639, median(all)=0.7485, mean(all)=0.6769
  + SMOOTHING: median(top-10)=0.8937, mean(top-10)=0.8961, median(all)=0.8009, mean(all)=0.7265 [+0.0324]
  + MRF:       median(top-10)=0.8946, mean(top-10)=0.8964, median(all)=0.8007, mean(all)=0.7269 [+0.0009]
  TOTAL IMPROVEMENT (median top-10): +0.0334

================================================================================
Subject: MMRR-21-12
================================================================================
  Step 0: Generating predictions with V2 model (20 random views)...
  Mesh: 102602 vertices, 205200 faces
  Generating 20 random views...
  Generating predictions for 20 views (continuous camera pose)...
    ✓ Random_0 (pose=(-1.6118011961115077, -0.6610724319288623, -2.6364605598022175)): shape (37, 800, 800)
      Valid pixels: 85781/640000 (13.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=205196, num_faces=205200
      Valid probs shape: (37, 85781)
    ✓ Random_1 (pose=(-2.8438165429945403, 0.8651228984816326, -1.849228068661599)): shape (37, 800, 800)
      Valid pixels: 86818/640000 (13.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5691, max=205198, num_faces=205200
      Valid probs shape: (37, 86818)
    ✓ Random_2 (pose=(-1.3163483553145574, -0.9340299233301415, -3.1389052820742096)): shape (37, 800, 800)
      Valid pixels: 94161/640000 (14.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=205196, num_faces=205200
      Valid probs shape: (37, 94161)
    ✓ Random_3 (pose=(0.14212624897951232, 0.9577813773105506, 0.1087437685119701)): shape (37, 800, 800)
      Valid pixels: 58489/640000 (9.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=205183, num_faces=205200
      Valid probs shape: (37, 58489)
    ✓ Random_4 (pose=(-1.9394450327586654, -0.32744350759292473, -2.8902674609778916)): shape (37, 800, 800)
      Valid pixels: 90679/640000 (14.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=109, max=205196, num_faces=205200
      Valid probs shape: (37, 90679)
    ✓ Random_5 (pose=(-1.5772934761362754, 0.6569458462640712, 1.1075156391571799)): shape (37, 800, 800)
      Valid pixels: 71177/640000 (11.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=62, max=205023, num_faces=205200
      Valid probs shape: (37, 71177)
    ✓ Random_6 (pose=(-1.7250821938722876, -0.019082958730786803, 0.7435785147208303)): shape (37, 800, 800)
      Valid pixels: 76399/640000 (11.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=89, max=205023, num_faces=205200
      Valid probs shape: (37, 76399)
    ✓ Random_7 (pose=(-2.9216530824233176, 1.873536406445984, 1.8666782744012664)): shape (37, 800, 800)
      Valid pixels: 95759/640000 (15.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=205195, num_faces=205200
      Valid probs shape: (37, 95759)
    ✓ Random_8 (pose=(-1.050333826204319, 2.3413663030295924, 1.6482312830201922)): shape (37, 800, 800)
      Valid pixels: 68491/640000 (10.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=169, max=205194, num_faces=205200
      Valid probs shape: (37, 68491)
    ✓ Random_9 (pose=(-1.2368466745114561, 2.436357527280129, 1.854998217375015)): shape (37, 800, 800)
      Valid pixels: 66696/640000 (10.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=107, max=205194, num_faces=205200
      Valid probs shape: (37, 66696)
    ✓ Random_10 (pose=(-2.0113350055424264, 2.6744657610309943, -0.43927166666347084)): shape (37, 800, 800)
      Valid pixels: 89115/640000 (13.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=205109, num_faces=205200
      Valid probs shape: (37, 89115)
    ✓ Random_11 (pose=(-1.2200590680500225, -1.3506146342931717, -1.08974908197166)): shape (37, 800, 800)
      Valid pixels: 93443/640000 (14.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=2, max=205114, num_faces=205200
      Valid probs shape: (37, 93443)
    ✓ Random_12 (pose=(-2.211583184123654, -2.4391905688838404, 2.1596528489216524)): shape (37, 800, 800)
      Valid pixels: 63728/640000 (10.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=3, max=205190, num_faces=205200
      Valid probs shape: (37, 63728)
    ✓ Random_13 (pose=(2.2741806454492757, 2.6844245631938826, -2.8138724661179535)): shape (37, 800, 800)
      Valid pixels: 79813/640000 (12.5%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=1, max=204956, num_faces=205200
      Valid probs shape: (37, 79813)
    ✓ Random_14 (pose=(0.8569275509799832, 2.4606616018727037, 2.194996954610386)): shape (37, 800, 800)
      Valid pixels: 91581/640000 (14.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=239, max=205198, num_faces=205200
      Valid probs shape: (37, 91581)
    ✓ Random_15 (pose=(0.22243716125981505, 2.230853571487997, -1.1563765380819422)): shape (37, 800, 800)
      Valid pixels: 79176/640000 (12.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=106, max=205196, num_faces=205200
      Valid probs shape: (37, 79176)
    ✓ Random_16 (pose=(-1.915158050137982, 1.4153679701856454, -2.9626347875498014)): shape (37, 800, 800)
      Valid pixels: 84208/640000 (13.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=205196, num_faces=205200
      Valid probs shape: (37, 84208)
    ✓ Random_17 (pose=(0.6863887860457507, 2.885445982650052, 3.1346729637300443)): shape (37, 800, 800)
      Valid pixels: 76005/640000 (11.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=505, max=205199, num_faces=205200
      Valid probs shape: (37, 76005)
    ✓ Random_18 (pose=(0.5550337187660537, -2.21162200529644, -0.531232074488448)): shape (37, 800, 800)
      Valid pixels: 62970/640000 (9.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=128, max=205199, num_faces=205200
      Valid probs shape: (37, 62970)
    ✓ Random_19 (pose=(-1.6571398962305721, 1.0841947392323048, 0.49493460646990073)): shape (37, 800, 800)
      Valid pixels: 78908/640000 (12.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=3, max=205023, num_faces=205200
      Valid probs shape: (37, 78908)
    P stats: min=0.0000, max=1.0000, mean=0.0249
    Non-zero vertices: 94425/102602
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 8177 1039  877 1842    0 1836  818 3352 4159]
  Ground Truth Stats:
    Labels shape: (102602,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-12/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7584
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8076
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8076

  RESULTS:
  RAW:         median(top-10)=0.8895, mean(top-10)=0.8985, median(all)=0.8311, mean(all)=0.7584
  + SMOOTHING: median(top-10)=0.9282, mean(top-10)=0.9289, median(all)=0.8662, mean(all)=0.8076 [+0.0387]
  + MRF:       median(top-10)=0.9283, mean(top-10)=0.9290, median(all)=0.8674, mean(all)=0.8076 [+0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0388

================================================================================
Subject: MMRR-21-13
================================================================================
  Step 0: Generating predictions with V2 model (20 random views)...
  Mesh: 128887 vertices, 257770 faces
  Generating 20 random views...
  Generating predictions for 20 views (continuous camera pose)...
    ✓ Random_0 (pose=(-2.0343112908583594, -1.8894141255021855, -2.0708017457360155)): shape (37, 800, 800)
      Valid pixels: 103640/640000 (16.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=7, max=257769, num_faces=257770
      Valid probs shape: (37, 103640)
    ✓ Random_1 (pose=(2.314733781253328, 0.793379018296513, 0.785822393594775)): shape (37, 800, 800)
      Valid pixels: 112756/640000 (17.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=91, max=257769, num_faces=257770
      Valid probs shape: (37, 112756)
    ✓ Random_2 (pose=(-0.29257748768538017, 0.5289846404360525, -0.20843174716368473)): shape (37, 800, 800)
      Valid pixels: 86636/640000 (13.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=257574, num_faces=257770
      Valid probs shape: (37, 86636)
    ✓ Random_3 (pose=(2.877936747059464, 2.399976513620814, 0.4673551673088774)): shape (37, 800, 800)
      Valid pixels: 90413/640000 (14.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=257766, num_faces=257770
      Valid probs shape: (37, 90413)
    ✓ Random_4 (pose=(-1.9624259962678339, 0.35388218262391424, -0.2585192008430397)): shape (37, 800, 800)
      Valid pixels: 115821/640000 (18.1%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=1185, max=257767, num_faces=257770
      Valid probs shape: (37, 115821)
    ✓ Random_5 (pose=(-0.20664609995068295, -2.163975647445545, 1.5161003065815457)): shape (37, 800, 800)
      Valid pixels: 121022/640000 (18.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=257769, num_faces=257770
      Valid probs shape: (37, 121022)
    ✓ Random_6 (pose=(-1.0275030492556767, -1.3513804997259682, 1.2458650560065037)): shape (37, 800, 800)
      Valid pixels: 88554/640000 (13.8%)
      Probs stats: min=0.0000, max=0.9995, mean=0.0270
      Face IDs: min=3, max=257636, num_faces=257770
      Valid probs shape: (37, 88554)
    ✓ Random_7 (pose=(-3.030128704136537, 2.3092661317108902, 1.8444500238896095)): shape (37, 800, 800)
      Valid pixels: 99842/640000 (15.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=257769, num_faces=257770
      Valid probs shape: (37, 99842)
    ✓ Random_8 (pose=(-1.1112174470802723, -2.755813257234616, -2.1600623298915593)): shape (37, 800, 800)
      Valid pixels: 83841/640000 (13.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=136, max=257769, num_faces=257770
      Valid probs shape: (37, 83841)
    ✓ Random_9 (pose=(-1.4246076804725096, -1.4512295742635835, 2.0079093935063836)): shape (37, 800, 800)
      Valid pixels: 112118/640000 (17.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=50, max=257766, num_faces=257770
      Valid probs shape: (37, 112118)
    ✓ Random_10 (pose=(-1.7177945210383503, -1.0855696416129823, 1.3957430670972624)): shape (37, 800, 800)
      Valid pixels: 88642/640000 (13.9%)
      Probs stats: min=0.0000, max=0.9994, mean=0.0270
      Face IDs: min=84, max=257765, num_faces=257770
      Valid probs shape: (37, 88642)
    ✓ Random_11 (pose=(1.1898785189131234, 1.4676024870834121, -0.424662929157559)): shape (37, 800, 800)
      Valid pixels: 128989/640000 (20.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=0, max=257769, num_faces=257770
      Valid probs shape: (37, 128989)
    ✓ Random_12 (pose=(-2.9850461304567126, 1.8281601071289506, -0.0023985980512253313)): shape (37, 800, 800)
      Valid pixels: 80151/640000 (12.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=257633, num_faces=257770
      Valid probs shape: (37, 80151)
    ✓ Random_13 (pose=(-0.4993597139599526, -0.07130661701996477, -2.580218286465542)): shape (37, 800, 800)
      Valid pixels: 81756/640000 (12.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=257769, num_faces=257770
      Valid probs shape: (37, 81756)
    ✓ Random_14 (pose=(-2.3382001086498194, 0.7328555849718383, 2.803374093317789)): shape (37, 800, 800)
      Valid pixels: 109207/640000 (17.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=152, max=257769, num_faces=257770
      Valid probs shape: (37, 109207)
    ✓ Random_15 (pose=(-0.32092891454881123, -0.9064378373559387, 1.6484083998281251)): shape (37, 800, 800)
      Valid pixels: 106698/640000 (16.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=257769, num_faces=257770
      Valid probs shape: (37, 106698)
    ✓ Random_16 (pose=(-2.0413641136875915, -0.48342816351388285, 1.4068707498668447)): shape (37, 800, 800)
      Valid pixels: 92644/640000 (14.5%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=1577, max=257767, num_faces=257770
      Valid probs shape: (37, 92644)
    ✓ Random_17 (pose=(0.10833587382833576, -2.142937916226266, -2.579438858705358)): shape (37, 800, 800)
      Valid pixels: 105224/640000 (16.4%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=7107, max=257767, num_faces=257770
      Valid probs shape: (37, 105224)
    ✓ Random_18 (pose=(-2.8388433389696734, -3.0015479708533106, 0.7453444809606671)): shape (37, 800, 800)
      Valid pixels: 77883/640000 (12.2%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=1, max=256790, num_faces=257770
      Valid probs shape: (37, 77883)
    ✓ Random_19 (pose=(2.2970923426629337, -1.1677722053120378, 0.5053807699450603)): shape (37, 800, 800)
      Valid pixels: 85828/640000 (13.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=136, max=257769, num_faces=257770
      Valid probs shape: (37, 85828)
    P stats: min=0.0000, max=0.9999, mean=0.0234
    Non-zero vertices: 111729/128887
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 17158   818   981  2439     0  1833   683  4402  4942]
  Ground Truth Stats:
    Labels shape: (128887,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-13/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7281
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8037
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8037

  RESULTS:
  RAW:         median(top-10)=0.8786, mean(top-10)=0.8725, median(all)=0.7859, mean(all)=0.7281
  + SMOOTHING: median(top-10)=0.9057, mean(top-10)=0.9100, median(all)=0.8416, mean(all)=0.8037 [+0.0271]
  + MRF:       median(top-10)=0.9059, mean(top-10)=0.9102, median(all)=0.8415, mean(all)=0.8037 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0273

================================================================================
Subject: MMRR-21-14
================================================================================
  Step 0: Generating predictions with V2 model (20 random views)...
  Mesh: 127387 vertices, 254770 faces
  Generating 20 random views...
  Generating predictions for 20 views (continuous camera pose)...
    ✓ Random_0 (pose=(0.3891158884475274, 2.5123013586803173, 2.3173405471549016)): shape (37, 800, 800)
      Valid pixels: 76559/640000 (12.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3580, max=254769, num_faces=254770
      Valid probs shape: (37, 76559)
    ✓ Random_1 (pose=(-2.536050103775202, -2.5345453960651323, -2.591330265029592)): shape (37, 800, 800)
      Valid pixels: 80795/640000 (12.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=254672, num_faces=254770
      Valid probs shape: (37, 80795)
    ✓ Random_2 (pose=(2.3048368074623014, 1.5560509577432224, -0.701236380170212)): shape (37, 800, 800)
      Valid pixels: 71382/640000 (11.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=254768, num_faces=254770
      Valid probs shape: (37, 71382)
    ✓ Random_3 (pose=(2.797867272298939, -3.093614311746602, 0.49377687327933106)): shape (37, 800, 800)
      Valid pixels: 54762/640000 (8.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=254638, num_faces=254770
      Valid probs shape: (37, 54762)
    ✓ Random_4 (pose=(-0.788821252649123, 2.518386802935842, 0.20260428807757735)): shape (37, 800, 800)
      Valid pixels: 89130/640000 (13.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1980, max=254769, num_faces=254770
      Valid probs shape: (37, 89130)
    ✓ Random_5 (pose=(0.4683723975999827, 0.8819241769449722, -0.41389024548092523)): shape (37, 800, 800)
      Valid pixels: 74605/640000 (11.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=254638, num_faces=254770
      Valid probs shape: (37, 74605)
    ✓ Random_6 (pose=(-2.317258679617197, -1.2854437416301119, 2.237931983186833)): shape (37, 800, 800)
      Valid pixels: 69162/640000 (10.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=178, max=254769, num_faces=254770
      Valid probs shape: (37, 69162)
    ✓ Random_7 (pose=(1.929228271515755, 2.38996742927372, 1.8754633968626617)): shape (37, 800, 800)
      Valid pixels: 66514/640000 (10.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=252424, num_faces=254770
      Valid probs shape: (37, 66514)
    ✓ Random_8 (pose=(2.7795894715030194, -0.4161803109169484, -1.4033537731721275)): shape (37, 800, 800)
      Valid pixels: 67664/640000 (10.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=459, max=254768, num_faces=254770
      Valid probs shape: (37, 67664)
    ✓ Random_9 (pose=(1.0538411406463286, 1.4502314009693809, -1.230720446733035)): shape (37, 800, 800)
      Valid pixels: 100254/640000 (15.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=254767, num_faces=254770
      Valid probs shape: (37, 100254)
    ✓ Random_10 (pose=(-1.8391241157207248, -0.02810495149306602, -2.5433488995475892)): shape (37, 800, 800)
      Valid pixels: 81203/640000 (12.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=38, max=254638, num_faces=254770
      Valid probs shape: (37, 81203)
    ✓ Random_11 (pose=(1.9216842792901438, 0.3208464831073461, 1.2854068382526913)): shape (37, 800, 800)
      Valid pixels: 67338/640000 (10.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=40, max=254638, num_faces=254770
      Valid probs shape: (37, 67338)
    ✓ Random_12 (pose=(-1.2879139383897231, -1.463874526524073, 2.4118596816820848)): shape (37, 800, 800)
      Valid pixels: 104549/640000 (16.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=254767, num_faces=254770
      Valid probs shape: (37, 104549)
    ✓ Random_13 (pose=(2.8482533927680223, 1.58150090498542, -1.3322564155512737)): shape (37, 800, 800)
      Valid pixels: 79485/640000 (12.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=21, max=254769, num_faces=254770
      Valid probs shape: (37, 79485)
    ✓ Random_14 (pose=(-0.2453339311612881, 0.3729596153762258, 1.9261230640662683)): shape (37, 800, 800)
      Valid pixels: 52159/640000 (8.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=254640, num_faces=254770
      Valid probs shape: (37, 52159)
    ✓ Random_15 (pose=(-0.39955651435648676, -0.8755424210363887, 0.276843604916972)): shape (37, 800, 800)
      Valid pixels: 56922/640000 (8.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=254769, num_faces=254770
      Valid probs shape: (37, 56922)
    ✓ Random_16 (pose=(0.8584787336699087, 1.054244673436381, 1.9359972373120655)): shape (37, 800, 800)
      Valid pixels: 97084/640000 (15.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=252424, num_faces=254770
      Valid probs shape: (37, 97084)
    ✓ Random_17 (pose=(1.3169662043625001, -0.2368739419875041, -2.454695727025097)): shape (37, 800, 800)
      Valid pixels: 75330/640000 (11.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=254768, num_faces=254770
      Valid probs shape: (37, 75330)
    ✓ Random_18 (pose=(-0.6857317365300863, 1.6987003253601491, 1.594533580197874)): shape (37, 800, 800)
      Valid pixels: 76746/640000 (12.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=13, max=254769, num_faces=254770
      Valid probs shape: (37, 76746)
    ✓ Random_19 (pose=(-0.011473315263927475, -1.8566272889947513, -1.879789775860632)): shape (37, 800, 800)
      Valid pixels: 96844/640000 (15.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=6, max=254769, num_faces=254770
      Valid probs shape: (37, 96844)
    P stats: min=0.0000, max=0.9999, mean=0.0246
    Non-zero vertices: 115759/127387
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 11628   860  1095  3343     0  1983   995  4714  5355]
  Ground Truth Stats:
    Labels shape: (127387,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-14/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7444
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7988
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7993

  RESULTS:
  RAW:         median(top-10)=0.8987, mean(top-10)=0.8995, median(all)=0.7882, mean(all)=0.7444
  + SMOOTHING: median(top-10)=0.9197, mean(top-10)=0.9281, median(all)=0.8258, mean(all)=0.7988 [+0.0210]
  + MRF:       median(top-10)=0.9199, mean(top-10)=0.9283, median(all)=0.8274, mean(all)=0.7993 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0212

================================================================================
Subject: MMRR-21-15
================================================================================
  Step 0: Generating predictions with V2 model (20 random views)...
  Mesh: 137028 vertices, 274052 faces
  Generating 20 random views...
  Generating predictions for 20 views (continuous camera pose)...
    ✓ Random_0 (pose=(-1.198164999607175, -2.215976090888487, -0.652203297838982)): shape (37, 800, 800)
      Valid pixels: 87487/640000 (13.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=20, max=274051, num_faces=274052
      Valid probs shape: (37, 87487)
    ✓ Random_1 (pose=(2.4463557141905747, 0.363575210125477, -0.5162052434404778)): shape (37, 800, 800)
      Valid pixels: 62578/640000 (9.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=140, max=274051, num_faces=274052
      Valid probs shape: (37, 62578)
    ✓ Random_2 (pose=(-0.06647347143462401, 0.6562436930700986, -3.064212742047349)): shape (37, 800, 800)
      Valid pixels: 48180/640000 (7.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=274004, num_faces=274052
      Valid probs shape: (37, 48180)
    ✓ Random_3 (pose=(-2.6848619438675283, -2.122307599134512, 2.949560509788472)): shape (37, 800, 800)
      Valid pixels: 64205/640000 (10.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=274040, num_faces=274052
      Valid probs shape: (37, 64205)
    ✓ Random_4 (pose=(-1.4128179198647497, 0.9482160800860218, 1.6298720172153374)): shape (37, 800, 800)
      Valid pixels: 60739/640000 (9.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=274043, num_faces=274052
      Valid probs shape: (37, 60739)
    ✓ Random_5 (pose=(-1.2063289820993648, 0.6493907706945157, -2.538684304443482)): shape (37, 800, 800)
      Valid pixels: 78822/640000 (12.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=273971, num_faces=274052
      Valid probs shape: (37, 78822)
    ✓ Random_6 (pose=(-1.2250236487912374, 0.42657855038456516, -0.08658326820463946)): shape (37, 800, 800)
      Valid pixels: 83034/640000 (13.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=274043, num_faces=274052
      Valid probs shape: (37, 83034)
    ✓ Random_7 (pose=(0.4298929840093022, -1.596665585355805, 1.984326849571147)): shape (37, 800, 800)
      Valid pixels: 69575/640000 (10.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=273971, num_faces=274052
      Valid probs shape: (37, 69575)
    ✓ Random_8 (pose=(-1.3388359938913612, -2.168995959602422, 1.7351260605814343)): shape (37, 800, 800)
      Valid pixels: 72113/640000 (11.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=42, max=274024, num_faces=274052
      Valid probs shape: (37, 72113)
    ✓ Random_9 (pose=(-1.4452446878371472, -0.07001730232248038, 1.7565497119448228)): shape (37, 800, 800)
      Valid pixels: 65308/640000 (10.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=10, max=274043, num_faces=274052
      Valid probs shape: (37, 65308)
    ✓ Random_10 (pose=(0.9886329251953869, -2.5300561979958283, 0.1001440714514108)): shape (37, 800, 800)
      Valid pixels: 83327/640000 (13.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=120, max=274047, num_faces=274052
      Valid probs shape: (37, 83327)
    ✓ Random_11 (pose=(1.699549371632247, -0.9202787160370609, 0.10614494247734152)): shape (37, 800, 800)
      Valid pixels: 85928/640000 (13.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=273971, num_faces=274052
      Valid probs shape: (37, 85928)
    ✓ Random_12 (pose=(-1.3087795084187355, 2.650258976008499, 0.34194124697492345)): shape (37, 800, 800)
      Valid pixels: 79536/640000 (12.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=21, max=274051, num_faces=274052
      Valid probs shape: (37, 79536)
    ✓ Random_13 (pose=(2.241818804634204, 2.736310544560231, 2.9529136059317587)): shape (37, 800, 800)
      Valid pixels: 75581/640000 (11.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=272910, num_faces=274052
      Valid probs shape: (37, 75581)
    ✓ Random_14 (pose=(2.3895406843916023, -3.1260276173465726, -1.1624169044368444)): shape (37, 800, 800)
      Valid pixels: 57041/640000 (8.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=273988, num_faces=274052
      Valid probs shape: (37, 57041)
    ✓ Random_15 (pose=(1.447239483892039, 2.217028479842414, -0.26681492569957976)): shape (37, 800, 800)
      Valid pixels: 91761/640000 (14.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=273971, num_faces=274052
      Valid probs shape: (37, 91761)
    ✓ Random_16 (pose=(-0.6335285937579558, -2.037477769891379, 1.993114257700003)): shape (37, 800, 800)
      Valid pixels: 86707/640000 (13.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=24, max=274051, num_faces=274052
      Valid probs shape: (37, 86707)
    ✓ Random_17 (pose=(0.987172307337854, -1.4830398866946888, 1.5737455705277652)): shape (37, 800, 800)
      Valid pixels: 66487/640000 (10.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=273971, num_faces=274052
      Valid probs shape: (37, 66487)
    ✓ Random_18 (pose=(-2.425768449449039, -2.990877585806456, 0.18660774840324645)): shape (37, 800, 800)
      Valid pixels: 63313/640000 (9.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=273817, num_faces=274052
      Valid probs shape: (37, 63313)
    ✓ Random_19 (pose=(-0.19804145954126406, 0.8142762543363906, 2.053738346092655)): shape (37, 800, 800)
      Valid pixels: 57767/640000 (9.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=274044, num_faces=274052
      Valid probs shape: (37, 57767)
    P stats: min=0.0000, max=0.9999, mean=0.0228
    Non-zero vertices: 115635/137028
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 21393  1106  1137  2660     0  2376   929  4092  5298]
  Ground Truth Stats:
    Labels shape: (137028,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-15/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7500
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8279
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8283

  RESULTS:
  RAW:         median(top-10)=0.8707, mean(top-10)=0.8782, median(all)=0.7848, mean(all)=0.7500
  + SMOOTHING: median(top-10)=0.8999, mean(top-10)=0.9082, median(all)=0.8695, mean(all)=0.8279 [+0.0292]
  + MRF:       median(top-10)=0.9005, mean(top-10)=0.9084, median(all)=0.8698, mean(all)=0.8283 [+0.0006]
  TOTAL IMPROVEMENT (median top-10): +0.0298

================================================================================
Subject: MMRR-21-16
================================================================================
  Step 0: Generating predictions with V2 model (20 random views)...
  Mesh: 147500 vertices, 294996 faces
  Generating 20 random views...
  Generating predictions for 20 views (continuous camera pose)...
    ✓ Random_0 (pose=(1.6644298864297777, -1.6192407707310972, 0.7998409980140755)): shape (37, 800, 800)
      Valid pixels: 68678/640000 (10.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=294973, num_faces=294996
      Valid probs shape: (37, 68678)
    ✓ Random_1 (pose=(2.781376265345828, 2.654008061011198, 0.9595750085982635)): shape (37, 800, 800)
      Valid pixels: 61935/640000 (9.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=294924, num_faces=294996
      Valid probs shape: (37, 61935)
    ✓ Random_2 (pose=(-1.0322807761938448, 3.033629697417971, -1.457112553832808)): shape (37, 800, 800)
      Valid pixels: 56646/640000 (8.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=12577, max=294995, num_faces=294996
      Valid probs shape: (37, 56646)
    ✓ Random_3 (pose=(1.9049046169887909, 0.08396629063906813, -1.1647846988529094)): shape (37, 800, 800)
      Valid pixels: 74917/640000 (11.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=223, max=294970, num_faces=294996
      Valid probs shape: (37, 74917)
    ✓ Random_4 (pose=(-1.8378762502491823, 2.8248640703060595, 0.5475696539282353)): shape (37, 800, 800)
      Valid pixels: 69692/640000 (10.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=0, max=294914, num_faces=294996
      Valid probs shape: (37, 69692)
    ✓ Random_5 (pose=(-1.9928017460010394, 2.6252011532918473, -2.8884158312954455)): shape (37, 800, 800)
      Valid pixels: 76152/640000 (11.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=294925, num_faces=294996
      Valid probs shape: (37, 76152)
    ✓ Random_6 (pose=(-1.7222294800395455, -0.2304556334569403, -2.171616161409601)): shape (37, 800, 800)
      Valid pixels: 67391/640000 (10.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=18, max=294995, num_faces=294996
      Valid probs shape: (37, 67391)
    ✓ Random_7 (pose=(1.1231928673060594, -2.0224373065823995, -2.9616033986663033)): shape (37, 800, 800)
      Valid pixels: 89739/640000 (14.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=47, max=294991, num_faces=294996
      Valid probs shape: (37, 89739)
    ✓ Random_8 (pose=(-1.5831333880311216, -0.38638479001090165, 2.6124684795023336)): shape (37, 800, 800)
      Valid pixels: 95791/640000 (15.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6, max=294925, num_faces=294996
      Valid probs shape: (37, 95791)
    ✓ Random_9 (pose=(-0.8605290457782022, 2.5421406720700572, -1.477485298120253)): shape (37, 800, 800)
      Valid pixels: 58345/640000 (9.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=294995, num_faces=294996
      Valid probs shape: (37, 58345)
    ✓ Random_10 (pose=(-0.7759162909465527, -0.18263435400383266, -2.156675634742464)): shape (37, 800, 800)
      Valid pixels: 53860/640000 (8.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=294919, num_faces=294996
      Valid probs shape: (37, 53860)
    ✓ Random_11 (pose=(-2.354821566834242, 0.2083183016377359, -2.041885067743617)): shape (37, 800, 800)
      Valid pixels: 53676/640000 (8.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1592, max=294995, num_faces=294996
      Valid probs shape: (37, 53676)
    ✓ Random_12 (pose=(-1.330103497325177, 0.7093883760326611, -1.9096580915118635)): shape (37, 800, 800)
      Valid pixels: 64065/640000 (10.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=294923, num_faces=294996
      Valid probs shape: (37, 64065)
    ✓ Random_13 (pose=(0.574245623783654, 0.46250235708855403, -1.954596827315953)): shape (37, 800, 800)
      Valid pixels: 51664/640000 (8.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=294924, num_faces=294996
      Valid probs shape: (37, 51664)
    ✓ Random_14 (pose=(-1.7080482866052293, 0.03238689911889514, -1.7693404988822614)): shape (37, 800, 800)
      Valid pixels: 59151/640000 (9.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=10, max=294995, num_faces=294996
      Valid probs shape: (37, 59151)
    ✓ Random_15 (pose=(2.638176217771819, 2.639776129073004, 2.0642401981444847)): shape (37, 800, 800)
      Valid pixels: 49655/640000 (7.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=294295, num_faces=294996
      Valid probs shape: (37, 49655)
    ✓ Random_16 (pose=(-0.7278674590627361, -0.5257722033755954, 0.6117786096703459)): shape (37, 800, 800)
      Valid pixels: 56011/640000 (8.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=294924, num_faces=294996
      Valid probs shape: (37, 56011)
    ✓ Random_17 (pose=(2.6421948301015643, 0.6400644641446598, 2.518297862428276)): shape (37, 800, 800)
      Valid pixels: 55011/640000 (8.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=17692, max=294995, num_faces=294996
      Valid probs shape: (37, 55011)
    ✓ Random_18 (pose=(-0.4918829865860541, 1.7876731210563985, -1.2015653372784592)): shape (37, 800, 800)
      Valid pixels: 68307/640000 (10.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=9, max=294995, num_faces=294996
      Valid probs shape: (37, 68307)
    ✓ Random_19 (pose=(2.8117721721645283, -3.041949381560145, -2.386776511207749)): shape (37, 800, 800)
      Valid pixels: 46614/640000 (7.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=294916, num_faces=294996
      Valid probs shape: (37, 46614)
    P stats: min=0.0000, max=1.0000, mean=0.0225
    Non-zero vertices: 122758/147500
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 24742   743  1445  2802     0  2353   831  4180  6218]
  Ground Truth Stats:
    Labels shape: (147500,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-16/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7252
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8109
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8115

  RESULTS:
  RAW:         median(top-10)=0.8390, mean(top-10)=0.8574, median(all)=0.7830, mean(all)=0.7252
  + SMOOTHING: median(top-10)=0.9138, mean(top-10)=0.9179, median(all)=0.8516, mean(all)=0.8109 [+0.0748]
  + MRF:       median(top-10)=0.9144, mean(top-10)=0.9183, median(all)=0.8525, mean(all)=0.8115 [+0.0005]
  TOTAL IMPROVEMENT (median top-10): +0.0754

================================================================================
Subject: MMRR-21-17
================================================================================
  Step 0: Generating predictions with V2 model (20 random views)...
  Mesh: 126138 vertices, 252272 faces
  Generating 20 random views...
  Generating predictions for 20 views (continuous camera pose)...
    ✓ Random_0 (pose=(-2.5211475454319365, 2.187838872848019, 1.329074028928126)): shape (37, 800, 800)
      Valid pixels: 82611/640000 (12.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=252204, num_faces=252272
      Valid probs shape: (37, 82611)
    ✓ Random_1 (pose=(1.266572230974388, -0.30173713378456624, 2.83938338369059)): shape (37, 800, 800)
      Valid pixels: 100181/640000 (15.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=252271, num_faces=252272
      Valid probs shape: (37, 100181)
    ✓ Random_2 (pose=(-2.1455637305481883, -1.8321184361232647, -1.2608539708032986)): shape (37, 800, 800)
      Valid pixels: 62101/640000 (9.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=8, max=252270, num_faces=252272
      Valid probs shape: (37, 62101)
    ✓ Random_3 (pose=(-1.5413830975845992, 1.6935236339985975, -0.22655394527589134)): shape (37, 800, 800)
      Valid pixels: 100714/640000 (15.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=16, max=252271, num_faces=252272
      Valid probs shape: (37, 100714)
    ✓ Random_4 (pose=(-0.4401348481893823, 0.8489656805495391, 2.0718178820871005)): shape (37, 800, 800)
      Valid pixels: 57756/640000 (9.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=252200, num_faces=252272
      Valid probs shape: (37, 57756)
    ✓ Random_5 (pose=(2.465957730506645, 2.838547464140486, -1.0499102730401053)): shape (37, 800, 800)
      Valid pixels: 55016/640000 (8.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=252203, num_faces=252272
      Valid probs shape: (37, 55016)
    ✓ Random_6 (pose=(-1.8408795030043044, 0.8904532478179732, 0.9581817130516272)): shape (37, 800, 800)
      Valid pixels: 67730/640000 (10.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=229, max=252166, num_faces=252272
      Valid probs shape: (37, 67730)
    ✓ Random_7 (pose=(0.907142225198867, 3.1098406100180753, 1.976873872176471)): shape (37, 800, 800)
      Valid pixels: 74473/640000 (11.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7535, max=252269, num_faces=252272
      Valid probs shape: (37, 74473)
    ✓ Random_8 (pose=(2.252427838159278, 1.6680262574574778, -0.12078393494298467)): shape (37, 800, 800)
      Valid pixels: 99947/640000 (15.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=252204, num_faces=252272
      Valid probs shape: (37, 99947)
    ✓ Random_9 (pose=(-2.312605318420307, -1.2946597584452912, 3.0099772958759914)): shape (37, 800, 800)
      Valid pixels: 98265/640000 (15.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=89, max=252204, num_faces=252272
      Valid probs shape: (37, 98265)
    ✓ Random_10 (pose=(2.5164334471884082, 0.9633347867570219, -1.3455916040337714)): shape (37, 800, 800)
      Valid pixels: 70364/640000 (11.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=238, max=252271, num_faces=252272
      Valid probs shape: (37, 70364)
    ✓ Random_11 (pose=(-1.0616396640613566, 2.493016892392525, -0.1547993551566207)): shape (37, 800, 800)
      Valid pixels: 97709/640000 (15.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=590, max=252271, num_faces=252272
      Valid probs shape: (37, 97709)
    ✓ Random_12 (pose=(-0.8686119572214936, 2.6571510397956306, -0.7575990885148456)): shape (37, 800, 800)
      Valid pixels: 76306/640000 (11.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7531, max=252271, num_faces=252272
      Valid probs shape: (37, 76306)
    ✓ Random_13 (pose=(-2.836260844260845, -1.8817370955321364, -1.2909362825903903)): shape (37, 800, 800)
      Valid pixels: 80548/640000 (12.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=252204, num_faces=252272
      Valid probs shape: (37, 80548)
    ✓ Random_14 (pose=(2.7325306796229327, -1.7276544054851197, 0.33630424898698363)): shape (37, 800, 800)
      Valid pixels: 60909/640000 (9.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=252270, num_faces=252272
      Valid probs shape: (37, 60909)
    ✓ Random_15 (pose=(2.1597244617342852, -2.2117017938533285, -2.1733628796050226)): shape (37, 800, 800)
      Valid pixels: 60719/640000 (9.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=2, max=252203, num_faces=252272
      Valid probs shape: (37, 60719)
    ✓ Random_16 (pose=(-0.911405711530572, 0.0036152469077479488, 1.289635016663878)): shape (37, 800, 800)
      Valid pixels: 55131/640000 (8.6%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=1, max=252200, num_faces=252272
      Valid probs shape: (37, 55131)
    ✓ Random_17 (pose=(-1.122425495534047, -1.8686646358490187, -1.9151118555205122)): shape (37, 800, 800)
      Valid pixels: 64227/640000 (10.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=36, max=252270, num_faces=252272
      Valid probs shape: (37, 64227)
    ✓ Random_18 (pose=(-1.9891933921237606, -2.3962690329936667, -1.5237483015631)): shape (37, 800, 800)
      Valid pixels: 62256/640000 (9.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=252270, num_faces=252272
      Valid probs shape: (37, 62256)
    ✓ Random_19 (pose=(-2.401213357978381, -0.7186173405574765, -1.6051250479569616)): shape (37, 800, 800)
      Valid pixels: 65564/640000 (10.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=698, max=252269, num_faces=252272
      Valid probs shape: (37, 65564)
    P stats: min=0.0000, max=0.9999, mean=0.0240
    Non-zero vertices: 112111/126138
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 14027   842  1203  2516     0  2748   704  4136  4561]
  Ground Truth Stats:
    Labels shape: (126138,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-17/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7652
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8216
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8221

  RESULTS:
  RAW:         median(top-10)=0.8976, mean(top-10)=0.8946, median(all)=0.8145, mean(all)=0.7652
  + SMOOTHING: median(top-10)=0.9337, mean(top-10)=0.9286, median(all)=0.8689, mean(all)=0.8216 [+0.0361]
  + MRF:       median(top-10)=0.9340, mean(top-10)=0.9290, median(all)=0.8691, mean(all)=0.8221 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0364

================================================================================
Subject: MMRR-21-18
================================================================================
  Step 0: Generating predictions with V2 model (20 random views)...
  Mesh: 131379 vertices, 262754 faces
  Generating 20 random views...
  Generating predictions for 20 views (continuous camera pose)...
    ✓ Random_0 (pose=(0.7774096202679641, -2.1846453285185436, -1.0456729877334277)): shape (37, 800, 800)
      Valid pixels: 64809/640000 (10.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=281, max=262741, num_faces=262754
      Valid probs shape: (37, 64809)
    ✓ Random_1 (pose=(0.6114169987062881, -1.2943969892736213, 1.1716579857791691)): shape (37, 800, 800)
      Valid pixels: 84645/640000 (13.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=262753, num_faces=262754
      Valid probs shape: (37, 84645)
    ✓ Random_2 (pose=(-0.9521713854487066, 3.137507093624036, -0.5958477368198491)): shape (37, 800, 800)
      Valid pixels: 81897/640000 (12.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=8478, max=262751, num_faces=262754
      Valid probs shape: (37, 81897)
    ✓ Random_3 (pose=(-2.4267770748262016, 2.0504508440022207, 2.230651363497027)): shape (37, 800, 800)
      Valid pixels: 88611/640000 (13.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=262753, num_faces=262754
      Valid probs shape: (37, 88611)
    ✓ Random_4 (pose=(-2.444818194931911, 1.1498785079575775, 1.3964923867103876)): shape (37, 800, 800)
      Valid pixels: 86753/640000 (13.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=262748, num_faces=262754
      Valid probs shape: (37, 86753)
    ✓ Random_5 (pose=(1.874722714072905, 0.4321653864990296, -0.03859119341885853)): shape (37, 800, 800)
      Valid pixels: 91789/640000 (14.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=29, max=262753, num_faces=262754
      Valid probs shape: (37, 91789)
    ✓ Random_6 (pose=(-3.1305777564640507, -0.4041296110106942, -2.9422456269709945)): shape (37, 800, 800)
      Valid pixels: 44861/640000 (7.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1058, max=262748, num_faces=262754
      Valid probs shape: (37, 44861)
    ✓ Random_7 (pose=(-2.654052745248209, -1.0331981961785979, -0.3198528653964474)): shape (37, 800, 800)
      Valid pixels: 68228/640000 (10.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8033, max=262751, num_faces=262754
      Valid probs shape: (37, 68228)
    ✓ Random_8 (pose=(-2.3834919266143877, 2.069134692936995, -2.167474128659337)): shape (37, 800, 800)
      Valid pixels: 66152/640000 (10.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=262750, num_faces=262754
      Valid probs shape: (37, 66152)
    ✓ Random_9 (pose=(-0.3669807178858173, -2.695502988824137, -0.8598783831897214)): shape (37, 800, 800)
      Valid pixels: 66348/640000 (10.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=24045, max=262752, num_faces=262754
      Valid probs shape: (37, 66348)
    ✓ Random_10 (pose=(-2.1883428492391124, 2.4801507323423584, 2.111695563721179)): shape (37, 800, 800)
      Valid pixels: 83624/640000 (13.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=262753, num_faces=262754
      Valid probs shape: (37, 83624)
    ✓ Random_11 (pose=(0.4895617017321219, -0.5350914374581355, 0.17877512703478304)): shape (37, 800, 800)
      Valid pixels: 67999/640000 (10.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=262753, num_faces=262754
      Valid probs shape: (37, 67999)
    ✓ Random_12 (pose=(-0.25342653920530855, 2.646465680155445, 0.07484596364248697)): shape (37, 800, 800)
      Valid pixels: 63288/640000 (9.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=21207, max=262751, num_faces=262754
      Valid probs shape: (37, 63288)
    ✓ Random_13 (pose=(1.673713561130187, -0.8826578899069393, 0.6221028049136459)): shape (37, 800, 800)
      Valid pixels: 75206/640000 (11.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=262753, num_faces=262754
      Valid probs shape: (37, 75206)
    ✓ Random_14 (pose=(-2.3436794568788337, -0.16242655170272258, 2.9214744608552836)): shape (37, 800, 800)
      Valid pixels: 75604/640000 (11.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=262753, num_faces=262754
      Valid probs shape: (37, 75604)
    ✓ Random_15 (pose=(0.090853940452166, 0.550508173782958, 1.7748825865106497)): shape (37, 800, 800)
      Valid pixels: 61772/640000 (9.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=262442, num_faces=262754
      Valid probs shape: (37, 61772)
    ✓ Random_16 (pose=(-0.33572039312107727, -2.7565266495676983, -0.4120377520225529)): shape (37, 800, 800)
      Valid pixels: 59356/640000 (9.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5774, max=262751, num_faces=262754
      Valid probs shape: (37, 59356)
    ✓ Random_17 (pose=(-2.978313910999912, 0.5033751673206508, 0.5069467685531)): shape (37, 800, 800)
      Valid pixels: 48920/640000 (7.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1042, max=262748, num_faces=262754
      Valid probs shape: (37, 48920)
    ✓ Random_18 (pose=(1.2558124862061533, 0.21577889100223402, 0.20937330731866277)): shape (37, 800, 800)
      Valid pixels: 81535/640000 (12.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=262753, num_faces=262754
      Valid probs shape: (37, 81535)
    ✓ Random_19 (pose=(2.646264867433457, -2.0280356557450263, 2.780760269870046)): shape (37, 800, 800)
      Valid pixels: 69659/640000 (10.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=20, max=262442, num_faces=262754
      Valid probs shape: (37, 69659)
    P stats: min=0.0000, max=0.9999, mean=0.0237
    Non-zero vertices: 115399/131379
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 15980   883  1295  2876     0  1548   989  4258  4493]
  Ground Truth Stats:
    Labels shape: (131379,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-18/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7313
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7863
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7865

  RESULTS:
  RAW:         median(top-10)=0.8890, mean(top-10)=0.8946, median(all)=0.8044, mean(all)=0.7313
  + SMOOTHING: median(top-10)=0.9107, mean(top-10)=0.9161, median(all)=0.8362, mean(all)=0.7863 [+0.0217]
  + MRF:       median(top-10)=0.9116, mean(top-10)=0.9166, median(all)=0.8358, mean(all)=0.7865 [+0.0009]
  TOTAL IMPROVEMENT (median top-10): +0.0226

================================================================================
Subject: MMRR-21-19
================================================================================
  Step 0: Generating predictions with V2 model (20 random views)...
  Mesh: 145253 vertices, 290502 faces
  Generating 20 random views...
  Generating predictions for 20 views (continuous camera pose)...
    ✓ Random_0 (pose=(1.5126607036682884, -2.6878165080722316, 2.6480435968884466)): shape (37, 800, 800)
      Valid pixels: 104368/640000 (16.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=290144, num_faces=290502
      Valid probs shape: (37, 104368)
    ✓ Random_1 (pose=(2.368769411271911, 1.2570592088789496, -3.0897735105177446)): shape (37, 800, 800)
      Valid pixels: 99723/640000 (15.6%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=6, max=290144, num_faces=290502
      Valid probs shape: (37, 99723)
    ✓ Random_2 (pose=(2.4025050099692224, -2.314258775262845, 0.2205510656739973)): shape (37, 800, 800)
      Valid pixels: 74434/640000 (11.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=290421, num_faces=290502
      Valid probs shape: (37, 74434)
    ✓ Random_3 (pose=(-1.307083994134657, -0.960829234714236, -0.7498805671414184)): shape (37, 800, 800)
      Valid pixels: 106018/640000 (16.6%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=3, max=290137, num_faces=290502
      Valid probs shape: (37, 106018)
    ✓ Random_4 (pose=(2.7539042399388602, -2.8382248881535834, -0.9681474762815765)): shape (37, 800, 800)
      Valid pixels: 61527/640000 (9.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=290495, num_faces=290502
      Valid probs shape: (37, 61527)
    ✓ Random_5 (pose=(-2.6368630733757117, 2.950530948038491, 1.4982372596761007)): shape (37, 800, 800)
      Valid pixels: 48564/640000 (7.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=290498, num_faces=290502
      Valid probs shape: (37, 48564)
    ✓ Random_6 (pose=(-0.19430252664078074, 2.543742294875666, 1.3263417755102438)): shape (37, 800, 800)
      Valid pixels: 72924/640000 (11.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7748, max=290501, num_faces=290502
      Valid probs shape: (37, 72924)
    ✓ Random_7 (pose=(-1.1197452063159448, -3.0981359939647133, 2.733577556126571)): shape (37, 800, 800)
      Valid pixels: 107052/640000 (16.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=34, max=290501, num_faces=290502
      Valid probs shape: (37, 107052)
    ✓ Random_8 (pose=(-1.7078663490463217, 2.9985224586327766, -1.7246022540029367)): shape (37, 800, 800)
      Valid pixels: 68435/640000 (10.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=289785, num_faces=290502
      Valid probs shape: (37, 68435)
    ✓ Random_9 (pose=(1.3499952845196592, -1.1870859717761721, -0.6880111358294347)): shape (37, 800, 800)
      Valid pixels: 99523/640000 (15.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=37, max=290501, num_faces=290502
      Valid probs shape: (37, 99523)
    ✓ Random_10 (pose=(-2.4007086651590495, -2.8900962025117205, -1.9313313876220597)): shape (37, 800, 800)
      Valid pixels: 69335/640000 (10.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=290421, num_faces=290502
      Valid probs shape: (37, 69335)
    ✓ Random_11 (pose=(-2.9990832284319526, -2.3269344504481313, -1.2274536136005914)): shape (37, 800, 800)
      Valid pixels: 74015/640000 (11.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=290500, num_faces=290502
      Valid probs shape: (37, 74015)
    ✓ Random_12 (pose=(0.18674492560914624, -1.8136400122847174, -0.8108318401630799)): shape (37, 800, 800)
      Valid pixels: 76936/640000 (12.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=117, max=290501, num_faces=290502
      Valid probs shape: (37, 76936)
    ✓ Random_13 (pose=(1.2280117417074452, 2.3206849779750867, -0.8193068155776619)): shape (37, 800, 800)
      Valid pixels: 109671/640000 (17.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=38, max=290501, num_faces=290502
      Valid probs shape: (37, 109671)
    ✓ Random_14 (pose=(1.5681611979478216, -1.3391049257096646, 0.9612981507730032)): shape (37, 800, 800)
      Valid pixels: 75736/640000 (11.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=13, max=290437, num_faces=290502
      Valid probs shape: (37, 75736)
    ✓ Random_15 (pose=(-1.0350074938800957, -2.1568533310328606, -2.876899457685483)): shape (37, 800, 800)
      Valid pixels: 78588/640000 (12.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=24, max=290501, num_faces=290502
      Valid probs shape: (37, 78588)
    ✓ Random_16 (pose=(-0.3814948860852687, -2.229989833592171, -2.1832809524771384)): shape (37, 800, 800)
      Valid pixels: 78353/640000 (12.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=13520, max=290501, num_faces=290502
      Valid probs shape: (37, 78353)
    ✓ Random_17 (pose=(2.366522928454528, -2.2179877934448933, -2.3072811242843065)): shape (37, 800, 800)
      Valid pixels: 58355/640000 (9.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=290501, num_faces=290502
      Valid probs shape: (37, 58355)
    ✓ Random_18 (pose=(-2.3311670942193334, -0.9899974839639918, 2.0674290029367546)): shape (37, 800, 800)
      Valid pixels: 75332/640000 (11.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=102, max=290501, num_faces=290502
      Valid probs shape: (37, 75332)
    ✓ Random_19 (pose=(2.7961274457726564, -2.4681679011583375, -0.8388441159541986)): shape (37, 800, 800)
      Valid pixels: 74462/640000 (11.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=290438, num_faces=290502
      Valid probs shape: (37, 74462)
    P stats: min=0.0000, max=1.0000, mean=0.0236
    Non-zero vertices: 126836/145253
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 18417   586  1051  3558     0  2021  1073  4544  5870]
  Ground Truth Stats:
    Labels shape: (145253,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-19/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7373
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7968
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7971

  RESULTS:
  RAW:         median(top-10)=0.8871, mean(top-10)=0.8902, median(all)=0.7734, mean(all)=0.7373
  + SMOOTHING: median(top-10)=0.9233, mean(top-10)=0.9229, median(all)=0.8591, mean(all)=0.7968 [+0.0362]
  + MRF:       median(top-10)=0.9236, mean(top-10)=0.9233, median(all)=0.8595, mean(all)=0.7971 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0365

================================================================================
Subject: MMRR-21-2
================================================================================
  Step 0: Generating predictions with V2 model (20 random views)...
  Mesh: 148593 vertices, 297182 faces
  Generating 20 random views...
  Generating predictions for 20 views (continuous camera pose)...
    ✓ Random_0 (pose=(-2.5171733355422306, 0.48724837783951314, -2.901724806655258)): shape (37, 800, 800)
      Valid pixels: 64677/640000 (10.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=740, max=297178, num_faces=297182
      Valid probs shape: (37, 64677)
    ✓ Random_1 (pose=(0.122971935849018, 3.034359222104821, 0.5682290310571467)): shape (37, 800, 800)
      Valid pixels: 44819/640000 (7.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=36383, max=297178, num_faces=297182
      Valid probs shape: (37, 44819)
    ✓ Random_2 (pose=(0.7736847723189735, 2.9062826507592208, 1.41796789148757)): shape (37, 800, 800)
      Valid pixels: 58563/640000 (9.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=22353, max=297178, num_faces=297182
      Valid probs shape: (37, 58563)
    ✓ Random_3 (pose=(1.3460849279299234, -0.7229413199726298, -0.7906813646122477)): shape (37, 800, 800)
      Valid pixels: 90553/640000 (14.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=297181, num_faces=297182
      Valid probs shape: (37, 90553)
    ✓ Random_4 (pose=(2.9446039782362767, 1.7446916638243684, -0.9360392805433677)): shape (37, 800, 800)
      Valid pixels: 74436/640000 (11.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=26, max=297181, num_faces=297182
      Valid probs shape: (37, 74436)
    ✓ Random_5 (pose=(2.969191317810618, 3.0112079509379077, -0.7740299013918701)): shape (37, 800, 800)
      Valid pixels: 45142/640000 (7.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=296846, num_faces=297182
      Valid probs shape: (37, 45142)
    ✓ Random_6 (pose=(-2.046038313619417, -1.4576684860969877, -0.01180119755290887)): shape (37, 800, 800)
      Valid pixels: 98841/640000 (15.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=48, max=297178, num_faces=297182
      Valid probs shape: (37, 98841)
    ✓ Random_7 (pose=(-2.220431836947422, 3.0940956505885246, -1.5129534230238408)): shape (37, 800, 800)
      Valid pixels: 58809/640000 (9.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=297129, num_faces=297182
      Valid probs shape: (37, 58809)
    ✓ Random_8 (pose=(2.46370080292842, 2.7666144664624124, -2.988146632309303)): shape (37, 800, 800)
      Valid pixels: 77481/640000 (12.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=0, max=297129, num_faces=297182
      Valid probs shape: (37, 77481)
    ✓ Random_9 (pose=(2.4005479058075947, -1.7635019511778984, 1.6703289122596772)): shape (37, 800, 800)
      Valid pixels: 96279/640000 (15.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=11, max=297178, num_faces=297182
      Valid probs shape: (37, 96279)
    ✓ Random_10 (pose=(2.7290931119531745, 1.8592553083999457, -0.819612474913411)): shape (37, 800, 800)
      Valid pixels: 68147/640000 (10.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=23, max=297181, num_faces=297182
      Valid probs shape: (37, 68147)
    ✓ Random_11 (pose=(0.14661286581007937, -1.2267254129430525, -1.1874230144122306)): shape (37, 800, 800)
      Valid pixels: 78165/640000 (12.2%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=7, max=297181, num_faces=297182
      Valid probs shape: (37, 78165)
    ✓ Random_12 (pose=(-2.8639190430339547, 1.3833509709140843, -2.3026265769456047)): shape (37, 800, 800)
      Valid pixels: 87534/640000 (13.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=55, max=297178, num_faces=297182
      Valid probs shape: (37, 87534)
    ✓ Random_13 (pose=(0.5020422422295683, 0.370428414694822, 2.5192869778979157)): shape (37, 800, 800)
      Valid pixels: 68427/640000 (10.7%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=0, max=297135, num_faces=297182
      Valid probs shape: (37, 68427)
    ✓ Random_14 (pose=(0.13738469129301567, -0.07305437004315296, 1.098723391800453)): shape (37, 800, 800)
      Valid pixels: 43236/640000 (6.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=296846, num_faces=297182
      Valid probs shape: (37, 43236)
    ✓ Random_15 (pose=(0.6445959137195065, 2.1503051975889216, -2.935539810878027)): shape (37, 800, 800)
      Valid pixels: 69684/640000 (10.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1015, max=297181, num_faces=297182
      Valid probs shape: (37, 69684)
    ✓ Random_16 (pose=(0.435037683780759, 1.6083474822924213, -3.061494017981601)): shape (37, 800, 800)
      Valid pixels: 69860/640000 (10.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=23, max=297181, num_faces=297182
      Valid probs shape: (37, 69860)
    ✓ Random_17 (pose=(-2.1364327502791967, -1.1330958089536711, -1.8426865538782267)): shape (37, 800, 800)
      Valid pixels: 78094/640000 (12.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=10, max=297178, num_faces=297182
      Valid probs shape: (37, 78094)
    ✓ Random_18 (pose=(-2.307658206905272, -0.8009092810347056, 1.3145800028421117)): shape (37, 800, 800)
      Valid pixels: 74140/640000 (11.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1049, max=297181, num_faces=297182
      Valid probs shape: (37, 74140)
    ✓ Random_19 (pose=(-0.24312511498720157, -0.022165083772959004, -0.5594852977723699)): shape (37, 800, 800)
      Valid pixels: 50862/640000 (7.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=296095, num_faces=297182
      Valid probs shape: (37, 50862)
    P stats: min=0.0000, max=1.0000, mean=0.0229
    Non-zero vertices: 126029/148593
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 22564   989   904  3427     0  1887   928  4276  6490]
  Ground Truth Stats:
    Labels shape: (148593,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-2/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7126
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=33
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7877
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=33
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7881

  RESULTS:
  RAW:         median(top-10)=0.8741, mean(top-10)=0.8754, median(all)=0.7880, mean(all)=0.7126
  + SMOOTHING: median(top-10)=0.9129, mean(top-10)=0.9154, median(all)=0.8432, mean(all)=0.7877 [+0.0388]
  + MRF:       median(top-10)=0.9135, mean(top-10)=0.9158, median(all)=0.8433, mean(all)=0.7881 [+0.0006]
  TOTAL IMPROVEMENT (median top-10): +0.0394

================================================================================
Subject: MMRR-21-20
================================================================================
  Step 0: Generating predictions with V2 model (20 random views)...
  Mesh: 149927 vertices, 299850 faces
  Generating 20 random views...
  Generating predictions for 20 views (continuous camera pose)...
    ✓ Random_0 (pose=(1.804477679644143, -2.5085511017541346, 1.6533569286910126)): shape (37, 800, 800)
      Valid pixels: 61680/640000 (9.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=299434, num_faces=299850
      Valid probs shape: (37, 61680)
    ✓ Random_1 (pose=(2.4508283627074503, 2.0922697324693713, 2.9515832893315697)): shape (37, 800, 800)
      Valid pixels: 72916/640000 (11.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=299542, num_faces=299850
      Valid probs shape: (37, 72916)
    ✓ Random_2 (pose=(-1.7325996653576436, 2.869839995865906, -0.7826806891046063)): shape (37, 800, 800)
      Valid pixels: 85388/640000 (13.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=299824, num_faces=299850
      Valid probs shape: (37, 85388)
    ✓ Random_3 (pose=(0.9011643513886813, 1.4958213173465804, -0.7693287265180873)): shape (37, 800, 800)
      Valid pixels: 96319/640000 (15.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7, max=299849, num_faces=299850
      Valid probs shape: (37, 96319)
    ✓ Random_4 (pose=(-0.7784996083221478, -1.9426741165485895, 1.1077184339490929)): shape (37, 800, 800)
      Valid pixels: 64715/640000 (10.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=13, max=299849, num_faces=299850
      Valid probs shape: (37, 64715)
    ✓ Random_5 (pose=(2.3619990769701573, 2.908179329672942, 2.511436959730047)): shape (37, 800, 800)
      Valid pixels: 63909/640000 (10.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=299663, num_faces=299850
      Valid probs shape: (37, 63909)
    ✓ Random_6 (pose=(0.9832569692280009, -0.8727568983833813, 1.1269836215991624)): shape (37, 800, 800)
      Valid pixels: 72724/640000 (11.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=299608, num_faces=299850
      Valid probs shape: (37, 72724)
    ✓ Random_7 (pose=(-2.6252978146015824, 1.6052098935083654, 0.37457022212859004)): shape (37, 800, 800)
      Valid pixels: 58893/640000 (9.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=35, max=299849, num_faces=299850
      Valid probs shape: (37, 58893)
    ✓ Random_8 (pose=(1.5970612154302017, 1.7813383255048807, -3.0093920003975305)): shape (37, 800, 800)
      Valid pixels: 85947/640000 (13.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=299847, num_faces=299850
      Valid probs shape: (37, 85947)
    ✓ Random_9 (pose=(-1.6234952997318304, -2.620777064627639, 2.3395606457044256)): shape (37, 800, 800)
      Valid pixels: 86648/640000 (13.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=299849, num_faces=299850
      Valid probs shape: (37, 86648)
    ✓ Random_10 (pose=(-1.7905497131237968, 1.3177744681871042, 0.0035120348573869364)): shape (37, 800, 800)
      Valid pixels: 83857/640000 (13.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=299844, num_faces=299850
      Valid probs shape: (37, 83857)
    ✓ Random_11 (pose=(2.393499381774843, 2.6447073088721353, 1.8794391963643546)): shape (37, 800, 800)
      Valid pixels: 47876/640000 (7.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=299601, num_faces=299850
      Valid probs shape: (37, 47876)
    ✓ Random_12 (pose=(-0.7079015758137732, 2.691612406290723, -1.7553980291430002)): shape (37, 800, 800)
      Valid pixels: 58739/640000 (9.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1742, max=299608, num_faces=299850
      Valid probs shape: (37, 58739)
    ✓ Random_13 (pose=(2.4254167503869084, -0.7749924660167458, 2.4384447995767182)): shape (37, 800, 800)
      Valid pixels: 82952/640000 (13.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=647, max=299847, num_faces=299850
      Valid probs shape: (37, 82952)
    ✓ Random_14 (pose=(1.1577689030800649, -0.6113676093764826, -1.8872823798244809)): shape (37, 800, 800)
      Valid pixels: 63649/640000 (9.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=2, max=299848, num_faces=299850
      Valid probs shape: (37, 63649)
    ✓ Random_15 (pose=(2.0861178229695225, 0.8737467660264757, 1.4758828657686927)): shape (37, 800, 800)
      Valid pixels: 62916/640000 (9.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=11, max=299608, num_faces=299850
      Valid probs shape: (37, 62916)
    ✓ Random_16 (pose=(-2.6467449477493705, -1.863221771455268, 0.7289778385128187)): shape (37, 800, 800)
      Valid pixels: 87288/640000 (13.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=7, max=299816, num_faces=299850
      Valid probs shape: (37, 87288)
    ✓ Random_17 (pose=(-0.7679071646267941, 0.1256154206264064, 1.5304698195677364)): shape (37, 800, 800)
      Valid pixels: 50127/640000 (7.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=299849, num_faces=299850
      Valid probs shape: (37, 50127)
    ✓ Random_18 (pose=(0.1383198865485169, -2.4889060893976693, -2.2734476351260504)): shape (37, 800, 800)
      Valid pixels: 72617/640000 (11.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=11344, max=299845, num_faces=299850
      Valid probs shape: (37, 72617)
    ✓ Random_19 (pose=(1.8540259351321327, -0.3998438466424763, -2.9947401172004584)): shape (37, 800, 800)
      Valid pixels: 83379/640000 (13.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=19, max=299847, num_faces=299850
      Valid probs shape: (37, 83379)
    P stats: min=0.0000, max=0.9999, mean=0.0243
    Non-zero vertices: 134634/149927
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 15293  1320  1328  2959     0  2245   960  4908  6163]
  Ground Truth Stats:
    Labels shape: (149927,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-20/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7583
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8143
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8147

  RESULTS:
  RAW:         median(top-10)=0.8848, mean(top-10)=0.8890, median(all)=0.8288, mean(all)=0.7583
  + SMOOTHING: median(top-10)=0.9149, mean(top-10)=0.9189, median(all)=0.8644, mean(all)=0.8143 [+0.0301]
  + MRF:       median(top-10)=0.9150, mean(top-10)=0.9191, median(all)=0.8645, mean(all)=0.8147 [+0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0301

================================================================================
Subject: MMRR-21-21
================================================================================
  Step 0: Generating predictions with V2 model (20 random views)...
  Mesh: 137496 vertices, 274988 faces
  Generating 20 random views...
  Generating predictions for 20 views (continuous camera pose)...
    ✓ Random_0 (pose=(0.949827304184633, 1.4183354079357873, 2.9566407883150303)): shape (37, 800, 800)
      Valid pixels: 79725/640000 (12.5%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=4, max=274984, num_faces=274988
      Valid probs shape: (37, 79725)
    ✓ Random_1 (pose=(-1.2481985309574903, -2.715253071575567, -1.9394289183638878)): shape (37, 800, 800)
      Valid pixels: 64434/640000 (10.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=840, max=274987, num_faces=274988
      Valid probs shape: (37, 64434)
    ✓ Random_2 (pose=(-0.4926843164740409, -0.7973156538787038, 2.6354539148347165)): shape (37, 800, 800)
      Valid pixels: 73635/640000 (11.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=274984, num_faces=274988
      Valid probs shape: (37, 73635)
    ✓ Random_3 (pose=(-1.9865115146500136, -2.7280039631448254, -0.4795583046966274)): shape (37, 800, 800)
      Valid pixels: 90902/640000 (14.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8, max=274950, num_faces=274988
      Valid probs shape: (37, 90902)
    ✓ Random_4 (pose=(-1.320584360731534, -1.6486915193301197, -1.427667033158937)): shape (37, 800, 800)
      Valid pixels: 79219/640000 (12.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=274959, num_faces=274988
      Valid probs shape: (37, 79219)
    ✓ Random_5 (pose=(1.666630944252022, -3.136488158515554, 2.075161863700795)): shape (37, 800, 800)
      Valid pixels: 84104/640000 (13.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=274959, num_faces=274988
      Valid probs shape: (37, 84104)
    ✓ Random_6 (pose=(1.0850654047773522, 0.06984255521812921, -2.156778523086153)): shape (37, 800, 800)
      Valid pixels: 66033/640000 (10.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=274984, num_faces=274988
      Valid probs shape: (37, 66033)
    ✓ Random_7 (pose=(2.6273866839048754, -1.7682081612887999, 2.0696558931079387)): shape (37, 800, 800)
      Valid pixels: 90864/640000 (14.2%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=9, max=274967, num_faces=274988
      Valid probs shape: (37, 90864)
    ✓ Random_8 (pose=(-1.0896845544892093, -1.158784133048684, 2.8804611190277862)): shape (37, 800, 800)
      Valid pixels: 91916/640000 (14.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=274982, num_faces=274988
      Valid probs shape: (37, 91916)
    ✓ Random_9 (pose=(2.2536819534493597, 2.3356499969823545, 1.2886961342766368)): shape (37, 800, 800)
      Valid pixels: 70977/640000 (11.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=274985, num_faces=274988
      Valid probs shape: (37, 70977)
    ✓ Random_10 (pose=(2.5662311180801467, 1.011589622837417, -0.39003571211152854)): shape (37, 800, 800)
      Valid pixels: 72534/640000 (11.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=40, max=274985, num_faces=274988
      Valid probs shape: (37, 72534)
    ✓ Random_11 (pose=(-1.430181803572426, 2.391155065111926, 0.17490433425826124)): shape (37, 800, 800)
      Valid pixels: 88577/640000 (13.8%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=1, max=274983, num_faces=274988
      Valid probs shape: (37, 88577)
    ✓ Random_12 (pose=(1.4849592950292232, -1.0692504505662273, -0.24266999830379676)): shape (37, 800, 800)
      Valid pixels: 101238/640000 (15.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=10, max=274987, num_faces=274988
      Valid probs shape: (37, 101238)
    ✓ Random_13 (pose=(-3.115915545991518, -0.3663107823106868, -1.1352804757270172)): shape (37, 800, 800)
      Valid pixels: 54203/640000 (8.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2801, max=274983, num_faces=274988
      Valid probs shape: (37, 54203)
    ✓ Random_14 (pose=(-1.8093406133699415, -2.7185710942111267, -2.10499229220263)): shape (37, 800, 800)
      Valid pixels: 71609/640000 (11.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=274985, num_faces=274988
      Valid probs shape: (37, 71609)
    ✓ Random_15 (pose=(2.0565183541979657, 0.6033728410969146, 1.7290582275502837)): shape (37, 800, 800)
      Valid pixels: 61489/640000 (9.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=840, max=274985, num_faces=274988
      Valid probs shape: (37, 61489)
    ✓ Random_16 (pose=(0.39453743420383525, -0.44702851658380105, 3.087926243700972)): shape (37, 800, 800)
      Valid pixels: 67532/640000 (10.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=273333, num_faces=274988
      Valid probs shape: (37, 67532)
    ✓ Random_17 (pose=(-3.0943039848691636, 2.3898252672411253, 1.8628381151630027)): shape (37, 800, 800)
      Valid pixels: 70911/640000 (11.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=274985, num_faces=274988
      Valid probs shape: (37, 70911)
    ✓ Random_18 (pose=(1.8794374330832095, 2.469324837698265, 1.7151305591773287)): shape (37, 800, 800)
      Valid pixels: 62383/640000 (9.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=10, max=273339, num_faces=274988
      Valid probs shape: (37, 62383)
    ✓ Random_19 (pose=(2.4589470867951633, -2.7760665921693284, 2.1394310307621494)): shape (37, 800, 800)
      Valid pixels: 78026/640000 (12.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=2, max=274452, num_faces=274988
      Valid probs shape: (37, 78026)
    P stats: min=0.0000, max=0.9999, mean=0.0241
    Non-zero vertices: 122461/137496
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 15035  1400  1158  2761     0  2287   931  4502  6935]
  Ground Truth Stats:
    Labels shape: (137496,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-21/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7405
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8073
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8073

  RESULTS:
  RAW:         median(top-10)=0.8867, mean(top-10)=0.8872, median(all)=0.7965, mean(all)=0.7405
  + SMOOTHING: median(top-10)=0.9127, mean(top-10)=0.9199, median(all)=0.8601, mean(all)=0.8073 [+0.0260]
  + MRF:       median(top-10)=0.9128, mean(top-10)=0.9204, median(all)=0.8605, mean(all)=0.8073 [+0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0260

================================================================================
Subject: MMRR-21-3
================================================================================
  Step 0: Generating predictions with V2 model (20 random views)...
  Mesh: 144159 vertices, 288314 faces
  Generating 20 random views...
  Generating predictions for 20 views (continuous camera pose)...
    ✓ Random_0 (pose=(2.6038717586453837, 2.0055387859985148, -0.7551510605367646)): shape (37, 800, 800)
      Valid pixels: 57774/640000 (9.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8, max=288309, num_faces=288314
      Valid probs shape: (37, 57774)
    ✓ Random_1 (pose=(-0.5879032023505033, -1.9036137136293971, 3.0139351195532917)): shape (37, 800, 800)
      Valid pixels: 69254/640000 (10.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=15, max=288279, num_faces=288314
      Valid probs shape: (37, 69254)
    ✓ Random_2 (pose=(1.8262776889633763, 2.9596756988501483, 1.5331506911713433)): shape (37, 800, 800)
      Valid pixels: 58836/640000 (9.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=288278, num_faces=288314
      Valid probs shape: (37, 58836)
    ✓ Random_3 (pose=(-1.1305705839486953, 2.5959561101993804, -0.7015780024142129)): shape (37, 800, 800)
      Valid pixels: 83685/640000 (13.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=145, max=288265, num_faces=288314
      Valid probs shape: (37, 83685)
    ✓ Random_4 (pose=(-0.9492537036420545, -1.880272419029937, 1.2309413635771227)): shape (37, 800, 800)
      Valid pixels: 72881/640000 (11.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=27, max=288310, num_faces=288314
      Valid probs shape: (37, 72881)
    ✓ Random_5 (pose=(-0.8255025682552857, 2.9178321703388264, 1.8474490209200463)): shape (37, 800, 800)
      Valid pixels: 60913/640000 (9.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1100, max=288309, num_faces=288314
      Valid probs shape: (37, 60913)
    ✓ Random_6 (pose=(-0.6479853588868103, 2.1598283814776, -0.14104077192290987)): shape (37, 800, 800)
      Valid pixels: 80983/640000 (12.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=916, max=288263, num_faces=288314
      Valid probs shape: (37, 80983)
    ✓ Random_7 (pose=(0.5561835834136697, 1.8429913258846975, 0.2868564283281976)): shape (37, 800, 800)
      Valid pixels: 60619/640000 (9.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=13, max=288274, num_faces=288314
      Valid probs shape: (37, 60619)
    ✓ Random_8 (pose=(1.6416497385813855, -0.22836157845351135, -0.4885748047389673)): shape (37, 800, 800)
      Valid pixels: 98605/640000 (15.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=288313, num_faces=288314
      Valid probs shape: (37, 98605)
    ✓ Random_9 (pose=(-2.5109433489201094, -3.010988060893285, 0.3733886621367657)): shape (37, 800, 800)
      Valid pixels: 63970/640000 (10.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=287875, num_faces=288314
      Valid probs shape: (37, 63970)
    ✓ Random_10 (pose=(1.8553973831496204, 2.2035889419339467, 0.7751334098321099)): shape (37, 800, 800)
      Valid pixels: 78828/640000 (12.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=288312, num_faces=288314
      Valid probs shape: (37, 78828)
    ✓ Random_11 (pose=(-2.4044154132482896, 0.036318883935853474, -3.023972649705608)): shape (37, 800, 800)
      Valid pixels: 67000/640000 (10.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=133, max=288313, num_faces=288314
      Valid probs shape: (37, 67000)
    ✓ Random_12 (pose=(1.8978610707892951, -1.3088697702226901, 1.630915408110213)): shape (37, 800, 800)
      Valid pixels: 76084/640000 (11.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=147, max=288266, num_faces=288314
      Valid probs shape: (37, 76084)
    ✓ Random_13 (pose=(0.12797162202311707, 2.2259280948696745, 1.1197459145005393)): shape (37, 800, 800)
      Valid pixels: 82662/640000 (12.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=11044, max=288306, num_faces=288314
      Valid probs shape: (37, 82662)
    ✓ Random_14 (pose=(0.12079511666339426, -0.9735452018280735, -0.006714007962083546)): shape (37, 800, 800)
      Valid pixels: 54396/640000 (8.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=288309, num_faces=288314
      Valid probs shape: (37, 54396)
    ✓ Random_15 (pose=(0.49145262569226267, 1.6883130608572046, 2.7682825463991536)): shape (37, 800, 800)
      Valid pixels: 71288/640000 (11.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=72, max=288311, num_faces=288314
      Valid probs shape: (37, 71288)
    ✓ Random_16 (pose=(-2.3730703838236966, -2.0874283165524705, 0.46671874645588574)): shape (37, 800, 800)
      Valid pixels: 89790/640000 (14.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8, max=287875, num_faces=288314
      Valid probs shape: (37, 89790)
    ✓ Random_17 (pose=(-2.3533451372164977, 2.7414407003233316, -0.6460430276573623)): shape (37, 800, 800)
      Valid pixels: 79287/640000 (12.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=0, max=288240, num_faces=288314
      Valid probs shape: (37, 79287)
    ✓ Random_18 (pose=(1.3976234689344604, -2.381404390978892, -0.10745271017947333)): shape (37, 800, 800)
      Valid pixels: 97894/640000 (15.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=288313, num_faces=288314
      Valid probs shape: (37, 97894)
    ✓ Random_19 (pose=(0.5691196668231582, 1.2710696112365492, 2.500096306752309)): shape (37, 800, 800)
      Valid pixels: 77146/640000 (12.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=11, max=288312, num_faces=288314
      Valid probs shape: (37, 77146)
    P stats: min=0.0000, max=1.0000, mean=0.0241
    Non-zero vertices: 128546/144159
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 15613  1434  1069  3280     0  1891  1486  4405  6048]
  Ground Truth Stats:
    Labels shape: (144159,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-3/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7632
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8373
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8374

  RESULTS:
  RAW:         median(top-10)=0.8857, mean(top-10)=0.8965, median(all)=0.8279, mean(all)=0.7632
  + SMOOTHING: median(top-10)=0.9403, mean(top-10)=0.9375, median(all)=0.8840, mean(all)=0.8373 [+0.0546]
  + MRF:       median(top-10)=0.9405, mean(top-10)=0.9377, median(all)=0.8837, mean(all)=0.8374 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0548

================================================================================
Subject: MMRR-21-4
================================================================================
  Step 0: Generating predictions with V2 model (20 random views)...
  Mesh: 118034 vertices, 236064 faces
  Generating 20 random views...
  Generating predictions for 20 views (continuous camera pose)...
    ✓ Random_0 (pose=(3.000760832987871, -2.5051105025587956, 1.9268344247597957)): shape (37, 800, 800)
      Valid pixels: 70250/640000 (11.0%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=1, max=234903, num_faces=236064
      Valid probs shape: (37, 70250)
    ✓ Random_1 (pose=(-0.03271868863733651, 1.3187429410640474, 1.718372920150971)): shape (37, 800, 800)
      Valid pixels: 85088/640000 (13.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=236061, num_faces=236064
      Valid probs shape: (37, 85088)
    ✓ Random_2 (pose=(0.7183514888745504, 2.245131861432081, 1.2330115694045078)): shape (37, 800, 800)
      Valid pixels: 69957/640000 (10.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3417, max=236063, num_faces=236064
      Valid probs shape: (37, 69957)
    ✓ Random_3 (pose=(-1.7160112981164828, 2.574724073433071, 2.537007097539438)): shape (37, 800, 800)
      Valid pixels: 95262/640000 (14.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=236016, num_faces=236064
      Valid probs shape: (37, 95262)
    ✓ Random_4 (pose=(0.5837877413613652, 0.1461777452085724, -2.890544760319304)): shape (37, 800, 800)
      Valid pixels: 62148/640000 (9.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=0, max=234900, num_faces=236064
      Valid probs shape: (37, 62148)
    ✓ Random_5 (pose=(-2.8147969795360757, 1.465406295776547, -0.09571715674463199)): shape (37, 800, 800)
      Valid pixels: 68588/640000 (10.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=114, max=236008, num_faces=236064
      Valid probs shape: (37, 68588)
    ✓ Random_6 (pose=(1.495256027682764, -1.021079988177497, 1.8877186854594106)): shape (37, 800, 800)
      Valid pixels: 70773/640000 (11.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=236063, num_faces=236064
      Valid probs shape: (37, 70773)
    ✓ Random_7 (pose=(-0.1376300063797946, -0.5684148517696523, 1.602551731060898)): shape (37, 800, 800)
      Valid pixels: 60787/640000 (9.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=236015, num_faces=236064
      Valid probs shape: (37, 60787)
    ✓ Random_8 (pose=(1.6982889753765713, 1.6753205043183614, 1.4580696034466412)): shape (37, 800, 800)
      Valid pixels: 63134/640000 (9.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=236063, num_faces=236064
      Valid probs shape: (37, 63134)
    ✓ Random_9 (pose=(-2.6687292918088437, -2.7077930629646936, -2.30142352478707)): shape (37, 800, 800)
      Valid pixels: 63814/640000 (10.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=236015, num_faces=236064
      Valid probs shape: (37, 63814)
    ✓ Random_10 (pose=(2.123478075234291, -1.3355902430339217, -0.23214128664311762)): shape (37, 800, 800)
      Valid pixels: 89988/640000 (14.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=236016, num_faces=236064
      Valid probs shape: (37, 89988)
    ✓ Random_11 (pose=(-2.314312156529595, -0.6142433144112891, -2.512449210168592)): shape (37, 800, 800)
      Valid pixels: 83837/640000 (13.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=30, max=236016, num_faces=236064
      Valid probs shape: (37, 83837)
    ✓ Random_12 (pose=(2.163979046511984, 1.4995253063458076, 1.239752529502363)): shape (37, 800, 800)
      Valid pixels: 78810/640000 (12.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=236015, num_faces=236064
      Valid probs shape: (37, 78810)
    ✓ Random_13 (pose=(1.601570534574897, -1.7024854607390507, 0.606688339447969)): shape (37, 800, 800)
      Valid pixels: 79337/640000 (12.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=236015, num_faces=236064
      Valid probs shape: (37, 79337)
    ✓ Random_14 (pose=(1.1001135506329343, -1.073482436110274, -0.2223617477229647)): shape (37, 800, 800)
      Valid pixels: 91036/640000 (14.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=18, max=236016, num_faces=236064
      Valid probs shape: (37, 91036)
    ✓ Random_15 (pose=(-2.1311246312215504, 0.785096925596553, 2.943707911176145)): shape (37, 800, 800)
      Valid pixels: 88239/640000 (13.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=236016, num_faces=236064
      Valid probs shape: (37, 88239)
    ✓ Random_16 (pose=(2.0475971182432993, -2.368466030033439, -0.5781793036358507)): shape (37, 800, 800)
      Valid pixels: 91911/640000 (14.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=236016, num_faces=236064
      Valid probs shape: (37, 91911)
    ✓ Random_17 (pose=(-1.2244925545251175, 1.791830263613976, -2.1548049671487934)): shape (37, 800, 800)
      Valid pixels: 78736/640000 (12.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=236029, num_faces=236064
      Valid probs shape: (37, 78736)
    ✓ Random_18 (pose=(1.320828475078824, -0.349829696886399, 1.7056929745049354)): shape (37, 800, 800)
      Valid pixels: 61417/640000 (9.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=236063, num_faces=236064
      Valid probs shape: (37, 61417)
    ✓ Random_19 (pose=(-2.8568321075720826, -2.6491800404805157, 1.7002212783578985)): shape (37, 800, 800)
      Valid pixels: 57988/640000 (9.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=235421, num_faces=236064
      Valid probs shape: (37, 57988)
    P stats: min=0.0000, max=0.9999, mean=0.0230
    Non-zero vertices: 100278/118034
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 17756   762   934  2678     0  1711  1113  3926  4486]
  Ground Truth Stats:
    Labels shape: (118034,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-4/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7187
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7888
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7891

  RESULTS:
  RAW:         median(top-10)=0.8811, mean(top-10)=0.8839, median(all)=0.7796, mean(all)=0.7187
  + SMOOTHING: median(top-10)=0.9192, mean(top-10)=0.9266, median(all)=0.8333, mean(all)=0.7888 [+0.0381]
  + MRF:       median(top-10)=0.9194, mean(top-10)=0.9267, median(all)=0.8341, mean(all)=0.7891 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0383

================================================================================
Subject: MMRR-21-5
================================================================================
  Step 0: Generating predictions with V2 model (20 random views)...
  Mesh: 145215 vertices, 290426 faces
  Generating 20 random views...
  Generating predictions for 20 views (continuous camera pose)...
    ✓ Random_0 (pose=(-2.488048488371434, -2.421061429810226, 2.671075221554707)): shape (37, 800, 800)
      Valid pixels: 70035/640000 (10.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=290425, num_faces=290426
      Valid probs shape: (37, 70035)
    ✓ Random_1 (pose=(1.1665446342290497, -3.1359781820465527, -0.9648246470705408)): shape (37, 800, 800)
      Valid pixels: 94784/640000 (14.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=138, max=290425, num_faces=290426
      Valid probs shape: (37, 94784)
    ✓ Random_2 (pose=(2.4734674127072687, 1.412150254449176, 2.6054980323075947)): shape (37, 800, 800)
      Valid pixels: 72298/640000 (11.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=288846, num_faces=290426
      Valid probs shape: (37, 72298)
    ✓ Random_3 (pose=(2.6159650208743326, -1.2379502388471757, -0.6593161908301743)): shape (37, 800, 800)
      Valid pixels: 92091/640000 (14.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8, max=290421, num_faces=290426
      Valid probs shape: (37, 92091)
    ✓ Random_4 (pose=(-0.5634374455765019, -1.4225604314471878, -0.7247963773011188)): shape (37, 800, 800)
      Valid pixels: 88390/640000 (13.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=5, max=288854, num_faces=290426
      Valid probs shape: (37, 88390)
    ✓ Random_5 (pose=(2.911989177405773, -1.4651855391738846, 1.7269245707330425)): shape (37, 800, 800)
      Valid pixels: 100419/640000 (15.7%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=24, max=290117, num_faces=290426
      Valid probs shape: (37, 100419)
    ✓ Random_6 (pose=(2.670580114056686, -0.3434509685537437, 2.660764097154506)): shape (37, 800, 800)
      Valid pixels: 74242/640000 (11.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6835, max=290331, num_faces=290426
      Valid probs shape: (37, 74242)
    ✓ Random_7 (pose=(-1.564436430046934, -1.1085235668729827, -0.643658917796631)): shape (37, 800, 800)
      Valid pixels: 103942/640000 (16.2%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=7, max=288849, num_faces=290426
      Valid probs shape: (37, 103942)
    ✓ Random_8 (pose=(2.0005700260819026, 2.401366285550516, 1.6578518580076187)): shape (37, 800, 800)
      Valid pixels: 67059/640000 (10.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=288856, num_faces=290426
      Valid probs shape: (37, 67059)
    ✓ Random_9 (pose=(1.5672688979213927, -2.1571874735168985, -2.5476131432439284)): shape (37, 800, 800)
      Valid pixels: 81273/640000 (12.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=0, max=290156, num_faces=290426
      Valid probs shape: (37, 81273)
    ✓ Random_10 (pose=(1.4944009539661005, -0.002230623974557311, 2.4542608189781854)): shape (37, 800, 800)
      Valid pixels: 103121/640000 (16.1%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=6, max=288849, num_faces=290426
      Valid probs shape: (37, 103121)
    ✓ Random_11 (pose=(0.7011449517428061, -0.15371335400964314, -2.2455258018315285)): shape (37, 800, 800)
      Valid pixels: 65171/640000 (10.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=290351, num_faces=290426
      Valid probs shape: (37, 65171)
    ✓ Random_12 (pose=(-1.4872005870428255, -1.4498810968172366, 0.13733268093171436)): shape (37, 800, 800)
      Valid pixels: 91428/640000 (14.3%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=2, max=289227, num_faces=290426
      Valid probs shape: (37, 91428)
    ✓ Random_13 (pose=(-1.7137564197266046, 0.14750685016323262, 1.5018185309724377)): shape (37, 800, 800)
      Valid pixels: 71359/640000 (11.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=225, max=290425, num_faces=290426
      Valid probs shape: (37, 71359)
    ✓ Random_14 (pose=(2.8200018318191624, -0.05293045668712626, 2.6421701008991807)): shape (37, 800, 800)
      Valid pixels: 62264/640000 (9.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=68939, max=290385, num_faces=290426
      Valid probs shape: (37, 62264)
    ✓ Random_15 (pose=(1.2966004645612017, 1.358583948302046, 1.8175343970793216)): shape (37, 800, 800)
      Valid pixels: 93154/640000 (14.6%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=3, max=288855, num_faces=290426
      Valid probs shape: (37, 93154)
    ✓ Random_16 (pose=(-0.8532901671674864, 2.1332866519396037, 2.1074287208737)): shape (37, 800, 800)
      Valid pixels: 71320/640000 (11.1%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=528, max=290425, num_faces=290426
      Valid probs shape: (37, 71320)
    ✓ Random_17 (pose=(0.7695257786934198, -1.0406279878309186, 2.857050491677799)): shape (37, 800, 800)
      Valid pixels: 90894/640000 (14.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=0, max=290261, num_faces=290426
      Valid probs shape: (37, 90894)
    ✓ Random_18 (pose=(-2.648456765468158, 1.2472588688785908, 0.3136717560957476)): shape (37, 800, 800)
      Valid pixels: 72152/640000 (11.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=223, max=290423, num_faces=290426
      Valid probs shape: (37, 72152)
    ✓ Random_19 (pose=(0.3806501412004728, -1.8245396930670046, -0.11421433763836353)): shape (37, 800, 800)
      Valid pixels: 81725/640000 (12.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=114, max=290425, num_faces=290426
      Valid probs shape: (37, 81725)
    P stats: min=0.0000, max=0.9999, mean=0.0236
    Non-zero vertices: 127033/145215
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 18182  1246  1125  4314     0  1646  1005  3471  4906]
  Ground Truth Stats:
    Labels shape: (145215,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-5/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7491
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8181
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8186

  RESULTS:
  RAW:         median(top-10)=0.8893, mean(top-10)=0.8877, median(all)=0.7907, mean(all)=0.7491
  + SMOOTHING: median(top-10)=0.9262, mean(top-10)=0.9251, median(all)=0.8616, mean(all)=0.8181 [+0.0369]
  + MRF:       median(top-10)=0.9261, mean(top-10)=0.9253, median(all)=0.8623, mean(all)=0.8186 [-0.0000]
  TOTAL IMPROVEMENT (median top-10): +0.0368

================================================================================
Subject: MMRR-21-6
================================================================================
  Step 0: Generating predictions with V2 model (20 random views)...
  Mesh: 128994 vertices, 257984 faces
  Generating 20 random views...
  Generating predictions for 20 views (continuous camera pose)...
    ✓ Random_0 (pose=(1.9455607139748423, 1.6622281832673478, -1.5419896603664187)): shape (37, 800, 800)
      Valid pixels: 68283/640000 (10.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=257982, num_faces=257984
      Valid probs shape: (37, 68283)
    ✓ Random_1 (pose=(1.1129213783849403, -3.053072408399195, -0.5024339584431856)): shape (37, 800, 800)
      Valid pixels: 92100/640000 (14.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=90, max=257983, num_faces=257984
      Valid probs shape: (37, 92100)
    ✓ Random_2 (pose=(0.1745801555813946, 1.118813586534988, -2.1921747670283445)): shape (37, 800, 800)
      Valid pixels: 89395/640000 (14.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=257982, num_faces=257984
      Valid probs shape: (37, 89395)
    ✓ Random_3 (pose=(-2.5418870715371904, 1.2921211051554105, 0.6125959826960536)): shape (37, 800, 800)
      Valid pixels: 64942/640000 (10.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=29, max=257983, num_faces=257984
      Valid probs shape: (37, 64942)
    ✓ Random_4 (pose=(-2.7472917611034626, -0.39773095640272516, 0.368968428566431)): shape (37, 800, 800)
      Valid pixels: 75071/640000 (11.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2970, max=257983, num_faces=257984
      Valid probs shape: (37, 75071)
    ✓ Random_5 (pose=(0.6856158010908704, 0.17940252575274096, -1.9309746040257219)): shape (37, 800, 800)
      Valid pixels: 54585/640000 (8.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=257981, num_faces=257984
      Valid probs shape: (37, 54585)
    ✓ Random_6 (pose=(2.1396917681897207, -1.6249373616484672, -2.4177767432411197)): shape (37, 800, 800)
      Valid pixels: 67637/640000 (10.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=257982, num_faces=257984
      Valid probs shape: (37, 67637)
    ✓ Random_7 (pose=(2.895882221089945, -2.5500135653572347, 1.322222372987202)): shape (37, 800, 800)
      Valid pixels: 66745/640000 (10.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=256956, num_faces=257984
      Valid probs shape: (37, 66745)
    ✓ Random_8 (pose=(-1.5650239495671427, 1.202912485088257, 0.42867846514520735)): shape (37, 800, 800)
      Valid pixels: 81720/640000 (12.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=15, max=257980, num_faces=257984
      Valid probs shape: (37, 81720)
    ✓ Random_9 (pose=(0.3026806852429491, -2.394092088235774, 2.3597105935537197)): shape (37, 800, 800)
      Valid pixels: 59469/640000 (9.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2144, max=257983, num_faces=257984
      Valid probs shape: (37, 59469)
    ✓ Random_10 (pose=(1.521254623537165, -0.5651695964959824, -1.3477195180161823)): shape (37, 800, 800)
      Valid pixels: 69874/640000 (10.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=257983, num_faces=257984
      Valid probs shape: (37, 69874)
    ✓ Random_11 (pose=(-1.5873864787785124, -3.0991237417469564, 0.7599102990849369)): shape (37, 800, 800)
      Valid pixels: 73928/640000 (11.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=20, max=257981, num_faces=257984
      Valid probs shape: (37, 73928)
    ✓ Random_12 (pose=(1.2341779963267525, -2.780024407653138, 0.07289202012962992)): shape (37, 800, 800)
      Valid pixels: 96614/640000 (15.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=118, max=257983, num_faces=257984
      Valid probs shape: (37, 96614)
    ✓ Random_13 (pose=(-0.23496202875145533, 1.0160681874013289, -0.4314442283839166)): shape (37, 800, 800)
      Valid pixels: 58022/640000 (9.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=257638, num_faces=257984
      Valid probs shape: (37, 58022)
    ✓ Random_14 (pose=(-3.1229423040444733, 0.23073876190254738, 1.7086529097575367)): shape (37, 800, 800)
      Valid pixels: 47059/640000 (7.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1409, max=257983, num_faces=257984
      Valid probs shape: (37, 47059)
    ✓ Random_15 (pose=(-1.2215675331103901, -2.771314192079107, -1.9839188444880762)): shape (37, 800, 800)
      Valid pixels: 63966/640000 (10.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=929, max=257850, num_faces=257984
      Valid probs shape: (37, 63966)
    ✓ Random_16 (pose=(1.8642407122281162, -1.9255872144047501, 0.12186505650408064)): shape (37, 800, 800)
      Valid pixels: 89260/640000 (13.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=257940, num_faces=257984
      Valid probs shape: (37, 89260)
    ✓ Random_17 (pose=(1.2150080999001043, 0.5541703639349556, -0.28710833912780664)): shape (37, 800, 800)
      Valid pixels: 99607/640000 (15.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=257982, num_faces=257984
      Valid probs shape: (37, 99607)
    ✓ Random_18 (pose=(1.1597143423011875, 0.9559205060230536, 2.480447984189226)): shape (37, 800, 800)
      Valid pixels: 95628/640000 (14.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=257774, num_faces=257984
      Valid probs shape: (37, 95628)
    ✓ Random_19 (pose=(-1.66471690550087, 2.27055446359663, 0.5978416001259106)): shape (37, 800, 800)
      Valid pixels: 75005/640000 (11.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=4, max=257982, num_faces=257984
      Valid probs shape: (37, 75005)
    P stats: min=0.0000, max=0.9999, mean=0.0240
    Non-zero vertices: 114614/128994
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 14380  1432  1067  3181     0  2009   851  5201  4828]
  Ground Truth Stats:
    Labels shape: (128994,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-6/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7413
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8070
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8073

  RESULTS:
  RAW:         median(top-10)=0.8805, mean(top-10)=0.8851, median(all)=0.8134, mean(all)=0.7413
  + SMOOTHING: median(top-10)=0.9232, mean(top-10)=0.9211, median(all)=0.8462, mean(all)=0.8070 [+0.0427]
  + MRF:       median(top-10)=0.9230, mean(top-10)=0.9216, median(all)=0.8464, mean(all)=0.8073 [-0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0426

================================================================================
Subject: MMRR-21-7
================================================================================
  Step 0: Generating predictions with V2 model (20 random views)...
  Mesh: 148998 vertices, 297992 faces
  Generating 20 random views...
  Generating predictions for 20 views (continuous camera pose)...
    ✓ Random_0 (pose=(0.04999290373517207, 1.1296350992658093, 0.35190028489893876)): shape (37, 800, 800)
      Valid pixels: 64035/640000 (10.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=297878, num_faces=297992
      Valid probs shape: (37, 64035)
    ✓ Random_1 (pose=(2.893409037309972, -0.5131537158988184, -2.1993843206071917)): shape (37, 800, 800)
      Valid pixels: 50229/640000 (7.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=288, max=297956, num_faces=297992
      Valid probs shape: (37, 50229)
    ✓ Random_2 (pose=(0.10312667263846587, -2.1054188292811498, -2.373999767436663)): shape (37, 800, 800)
      Valid pixels: 80872/640000 (12.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1651, max=297991, num_faces=297992
      Valid probs shape: (37, 80872)
    ✓ Random_3 (pose=(2.0294750228934726, 0.8507587585286029, -1.8715076292942272)): shape (37, 800, 800)
      Valid pixels: 63955/640000 (10.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1035, max=297954, num_faces=297992
      Valid probs shape: (37, 63955)
    ✓ Random_4 (pose=(0.4635987797932448, -2.442960843594958, -1.0660303815986394)): shape (37, 800, 800)
      Valid pixels: 55432/640000 (8.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1655, max=297991, num_faces=297992
      Valid probs shape: (37, 55432)
    ✓ Random_5 (pose=(-0.8432244541775158, -0.8883118950927127, -1.2440779216993398)): shape (37, 800, 800)
      Valid pixels: 82369/640000 (12.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=297954, num_faces=297992
      Valid probs shape: (37, 82369)
    ✓ Random_6 (pose=(-0.788213530713556, -0.25036388686335354, 0.08336718007727484)): shape (37, 800, 800)
      Valid pixels: 65215/640000 (10.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=297954, num_faces=297992
      Valid probs shape: (37, 65215)
    ✓ Random_7 (pose=(-1.5939992592432701, -1.1914476228800472, 0.1657656535498666)): shape (37, 800, 800)
      Valid pixels: 81644/640000 (12.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=18, max=297991, num_faces=297992
      Valid probs shape: (37, 81644)
    ✓ Random_8 (pose=(-0.11909383517281125, 2.0045762563373186, 0.8905192477115751)): shape (37, 800, 800)
      Valid pixels: 84584/640000 (13.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=155, max=297991, num_faces=297992
      Valid probs shape: (37, 84584)
    ✓ Random_9 (pose=(-1.0108432236973943, -2.3537384822968663, -3.0602793896025755)): shape (37, 800, 800)
      Valid pixels: 73866/640000 (11.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=50, max=297817, num_faces=297992
      Valid probs shape: (37, 73866)
    ✓ Random_10 (pose=(-0.33162152983395776, 1.9862547373681263, -0.6591038981244424)): shape (37, 800, 800)
      Valid pixels: 55399/640000 (8.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6, max=297986, num_faces=297992
      Valid probs shape: (37, 55399)
    ✓ Random_11 (pose=(0.9365318796133488, -2.706361116625809, -0.016810425941609086)): shape (37, 800, 800)
      Valid pixels: 81771/640000 (12.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=56, max=297956, num_faces=297992
      Valid probs shape: (37, 81771)
    ✓ Random_12 (pose=(2.770100931875761, 0.5376819823303443, 1.7616065506922212)): shape (37, 800, 800)
      Valid pixels: 51983/640000 (8.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=54, max=297986, num_faces=297992
      Valid probs shape: (37, 51983)
    ✓ Random_13 (pose=(2.8149112160772347, -0.7631265494652544, -1.9999051732959408)): shape (37, 800, 800)
      Valid pixels: 66651/640000 (10.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=287, max=297956, num_faces=297992
      Valid probs shape: (37, 66651)
    ✓ Random_14 (pose=(0.07296417652935894, -2.197794580088816, -1.444583440610878)): shape (37, 800, 800)
      Valid pixels: 75744/640000 (11.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3229, max=297991, num_faces=297992
      Valid probs shape: (37, 75744)
    ✓ Random_15 (pose=(-0.30157792199831146, 3.0754980667785157, 1.6863612576732407)): shape (37, 800, 800)
      Valid pixels: 40505/640000 (6.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=400, max=297991, num_faces=297992
      Valid probs shape: (37, 40505)
    ✓ Random_16 (pose=(0.5232388188453307, 1.4997070589603947, -1.1063109473027537)): shape (37, 800, 800)
      Valid pixels: 92314/640000 (14.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6, max=297815, num_faces=297992
      Valid probs shape: (37, 92314)
    ✓ Random_17 (pose=(2.837614853479633, -0.7342129858029596, 1.7966882110918272)): shape (37, 800, 800)
      Valid pixels: 75072/640000 (11.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5658, max=297991, num_faces=297992
      Valid probs shape: (37, 75072)
    ✓ Random_18 (pose=(0.8802849330447131, -1.16919408872592, 1.4963776320270492)): shape (37, 800, 800)
      Valid pixels: 66671/640000 (10.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=297820, num_faces=297992
      Valid probs shape: (37, 66671)
    ✓ Random_19 (pose=(2.9365245490945577, -2.73650032561675, -0.8714119241048017)): shape (37, 800, 800)
      Valid pixels: 54420/640000 (8.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=297828, num_faces=297992
      Valid probs shape: (37, 54420)
    P stats: min=0.0000, max=1.0000, mean=0.0247
    Non-zero vertices: 135958/148998
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 13040  1189  1439  3186     0  1952  1242  5139  5717]
  Ground Truth Stats:
    Labels shape: (148998,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-7/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7615
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8241
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8246

  RESULTS:
  RAW:         median(top-10)=0.8938, mean(top-10)=0.8966, median(all)=0.8394, mean(all)=0.7615
  + SMOOTHING: median(top-10)=0.9324, mean(top-10)=0.9318, median(all)=0.8981, mean(all)=0.8241 [+0.0386]
  + MRF:       median(top-10)=0.9329, mean(top-10)=0.9322, median(all)=0.8994, mean(all)=0.8246 [+0.0006]
  TOTAL IMPROVEMENT (median top-10): +0.0391

================================================================================
Subject: MMRR-21-8
================================================================================
  Step 0: Generating predictions with V2 model (20 random views)...
  Mesh: 124399 vertices, 248794 faces
  Generating 20 random views...
  Generating predictions for 20 views (continuous camera pose)...
    ✓ Random_0 (pose=(1.249037645817543, 2.1697456032287032, -0.1786664395542954)): shape (37, 800, 800)
      Valid pixels: 97779/640000 (15.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=38, max=248793, num_faces=248794
      Valid probs shape: (37, 97779)
    ✓ Random_1 (pose=(-2.778090993441498, 2.1175224901505834, 2.742163054832713)): shape (37, 800, 800)
      Valid pixels: 71157/640000 (11.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=248777, num_faces=248794
      Valid probs shape: (37, 71157)
    ✓ Random_2 (pose=(1.1797434991298417, -0.9286016465502573, 0.05500612874959376)): shape (37, 800, 800)
      Valid pixels: 100484/640000 (15.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=9, max=248793, num_faces=248794
      Valid probs shape: (37, 100484)
    ✓ Random_3 (pose=(-0.09194715131059805, 1.0258701113848057, 0.5767505880181649)): shape (37, 800, 800)
      Valid pixels: 81672/640000 (12.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=248570, num_faces=248794
      Valid probs shape: (37, 81672)
    ✓ Random_4 (pose=(2.359436036364065, -1.9620289021137662, -0.16614730765352714)): shape (37, 800, 800)
      Valid pixels: 80786/640000 (12.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=248777, num_faces=248794
      Valid probs shape: (37, 80786)
    ✓ Random_5 (pose=(2.506052432636438, 0.20414363382458012, 1.0929704136937346)): shape (37, 800, 800)
      Valid pixels: 58651/640000 (9.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=57, max=248780, num_faces=248794
      Valid probs shape: (37, 58651)
    ✓ Random_6 (pose=(-2.3272370236940887, -0.6247994683858651, 2.194136081502731)): shape (37, 800, 800)
      Valid pixels: 59570/640000 (9.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=909, max=248790, num_faces=248794
      Valid probs shape: (37, 59570)
    ✓ Random_7 (pose=(0.8438497530810922, 1.3598198578664418, -1.8930023938586282)): shape (37, 800, 800)
      Valid pixels: 77468/640000 (12.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=20, max=248793, num_faces=248794
      Valid probs shape: (37, 77468)
    ✓ Random_8 (pose=(2.234797394196632, -2.30941200119027, 1.4842641711014481)): shape (37, 800, 800)
      Valid pixels: 75445/640000 (11.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=248570, num_faces=248794
      Valid probs shape: (37, 75445)
    ✓ Random_9 (pose=(2.0604845209829232, 2.9134903848351206, -1.5086295273254313)): shape (37, 800, 800)
      Valid pixels: 56055/640000 (8.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=17, max=248793, num_faces=248794
      Valid probs shape: (37, 56055)
    ✓ Random_10 (pose=(-3.0287294452024702, 1.928818075409871, 2.925853906191164)): shape (37, 800, 800)
      Valid pixels: 61284/640000 (9.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=248777, num_faces=248794
      Valid probs shape: (37, 61284)
    ✓ Random_11 (pose=(-0.8535325305728416, -2.1802708935881445, -0.470237552944885)): shape (37, 800, 800)
      Valid pixels: 87823/640000 (13.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=16, max=248788, num_faces=248794
      Valid probs shape: (37, 87823)
    ✓ Random_12 (pose=(-0.3644472770898384, 1.8079934342602755, 0.5075021646507216)): shape (37, 800, 800)
      Valid pixels: 94061/640000 (14.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=129, max=248573, num_faces=248794
      Valid probs shape: (37, 94061)
    ✓ Random_13 (pose=(-2.635741876955789, 0.419008217555759, 1.0156238077703348)): shape (37, 800, 800)
      Valid pixels: 51102/640000 (8.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=439, max=248793, num_faces=248794
      Valid probs shape: (37, 51102)
    ✓ Random_14 (pose=(-1.8735896770642317, 0.9620072138601019, -2.2543107084307588)): shape (37, 800, 800)
      Valid pixels: 65717/640000 (10.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=248775, num_faces=248794
      Valid probs shape: (37, 65717)
    ✓ Random_15 (pose=(0.20364938076571892, -0.7740463831150293, -2.911266959743919)): shape (37, 800, 800)
      Valid pixels: 69070/640000 (10.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=248569, num_faces=248794
      Valid probs shape: (37, 69070)
    ✓ Random_16 (pose=(0.6957725593951909, 2.2777042359700257, 2.9958889119780725)): shape (37, 800, 800)
      Valid pixels: 74804/640000 (11.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=709, max=248788, num_faces=248794
      Valid probs shape: (37, 74804)
    ✓ Random_17 (pose=(0.592578442183334, -2.9116775126078216, 2.4475149310145534)): shape (37, 800, 800)
      Valid pixels: 65270/640000 (10.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=26755, max=248573, num_faces=248794
      Valid probs shape: (37, 65270)
    ✓ Random_18 (pose=(-0.513755813382772, 2.3413249634531788, 2.193165331047279)): shape (37, 800, 800)
      Valid pixels: 60584/640000 (9.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3139, max=248790, num_faces=248794
      Valid probs shape: (37, 60584)
    ✓ Random_19 (pose=(0.6284214452242698, 1.1593137765559192, 0.003156390092781791)): shape (37, 800, 800)
      Valid pixels: 69798/640000 (10.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=248776, num_faces=248794
      Valid probs shape: (37, 69798)
    P stats: min=0.0000, max=0.9999, mean=0.0241
    Non-zero vertices: 110715/124399
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 13684   783  1072  2840     0  1908   882  3748  5678]
  Ground Truth Stats:
    Labels shape: (124399,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-8/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7451
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8102
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8103

  RESULTS:
  RAW:         median(top-10)=0.8920, mean(top-10)=0.8908, median(all)=0.7926, mean(all)=0.7451
  + SMOOTHING: median(top-10)=0.9248, mean(top-10)=0.9255, median(all)=0.8696, mean(all)=0.8102 [+0.0328]
  + MRF:       median(top-10)=0.9248, mean(top-10)=0.9259, median(all)=0.8696, mean(all)=0.8103 [+0.0000]
  TOTAL IMPROVEMENT (median top-10): +0.0328

================================================================================
Subject: MMRR-21-9
================================================================================
  Step 0: Generating predictions with V2 model (20 random views)...
  Mesh: 131827 vertices, 263650 faces
  Generating 20 random views...
  Generating predictions for 20 views (continuous camera pose)...
    ✓ Random_0 (pose=(-1.8601405990405828, 2.9855890917032104, -2.3939435942768554)): shape (37, 800, 800)
      Valid pixels: 75246/640000 (11.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=263643, num_faces=263650
      Valid probs shape: (37, 75246)
    ✓ Random_1 (pose=(-3.078758169868835, 1.241289545417624, -1.9198263155707835)): shape (37, 800, 800)
      Valid pixels: 97477/640000 (15.2%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=177, max=263646, num_faces=263650
      Valid probs shape: (37, 97477)
    ✓ Random_2 (pose=(-2.0667487600377474, -2.1872736774183577, 0.38256304497329996)): shape (37, 800, 800)
      Valid pixels: 92455/640000 (14.4%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=6, max=263640, num_faces=263650
      Valid probs shape: (37, 92455)
    ✓ Random_3 (pose=(0.9773144705521828, 0.21768058363385734, -1.5735416002902343)): shape (37, 800, 800)
      Valid pixels: 59835/640000 (9.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=263534, num_faces=263650
      Valid probs shape: (37, 59835)
    ✓ Random_4 (pose=(2.5870260247397274, -0.9746550889266037, -0.06816266264154036)): shape (37, 800, 800)
      Valid pixels: 71117/640000 (11.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=58, max=263649, num_faces=263650
      Valid probs shape: (37, 71117)
    ✓ Random_5 (pose=(0.6503616932277136, -1.165151778210161, 1.3979232401393524)): shape (37, 800, 800)
      Valid pixels: 83445/640000 (13.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=263643, num_faces=263650
      Valid probs shape: (37, 83445)
    ✓ Random_6 (pose=(-0.5761758154826131, -0.6935934809430901, 1.14167472757266)): shape (37, 800, 800)
      Valid pixels: 65148/640000 (10.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=263544, num_faces=263650
      Valid probs shape: (37, 65148)
    ✓ Random_7 (pose=(2.521544646543693, -2.9237386492174133, 2.3145768823704493)): shape (37, 800, 800)
      Valid pixels: 74410/640000 (11.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=263639, num_faces=263650
      Valid probs shape: (37, 74410)
    ✓ Random_8 (pose=(2.010530629712047, -2.1834691224210068, 1.6395513763455645)): shape (37, 800, 800)
      Valid pixels: 82819/640000 (12.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=263639, num_faces=263650
      Valid probs shape: (37, 82819)
    ✓ Random_9 (pose=(-2.731730152504634, -2.683795512471161, -2.3055166004871843)): shape (37, 800, 800)
      Valid pixels: 69417/640000 (10.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=263641, num_faces=263650
      Valid probs shape: (37, 69417)
    ✓ Random_10 (pose=(-3.1214945615307648, 2.122006196375086, -0.13704696769694502)): shape (37, 800, 800)
      Valid pixels: 59825/640000 (9.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=263649, num_faces=263650
      Valid probs shape: (37, 59825)
    ✓ Random_11 (pose=(3.025276807179802, 2.9475700548837462, -0.24046847308359443)): shape (37, 800, 800)
      Valid pixels: 45775/640000 (7.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=263525, num_faces=263650
      Valid probs shape: (37, 45775)
    ✓ Random_12 (pose=(-1.0971997623632346, 1.8908704973111545, -2.452172806371853)): shape (37, 800, 800)
      Valid pixels: 95141/640000 (14.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=60, max=263643, num_faces=263650
      Valid probs shape: (37, 95141)
    ✓ Random_13 (pose=(2.3033917155824586, -2.7160648433299097, -1.050895829112756)): shape (37, 800, 800)
      Valid pixels: 82771/640000 (12.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=263649, num_faces=263650
      Valid probs shape: (37, 82771)
    ✓ Random_14 (pose=(1.566862668441857, 0.4615736676862334, 1.9586955695137185)): shape (37, 800, 800)
      Valid pixels: 82146/640000 (12.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=263649, num_faces=263650
      Valid probs shape: (37, 82146)
    ✓ Random_15 (pose=(-2.247373949539531, 2.694660860835362, -2.9275943939668063)): shape (37, 800, 800)
      Valid pixels: 76188/640000 (11.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=263648, num_faces=263650
      Valid probs shape: (37, 76188)
    ✓ Random_16 (pose=(2.098734257753396, 2.2564531720258776, 2.675842537998288)): shape (37, 800, 800)
      Valid pixels: 91066/640000 (14.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=263639, num_faces=263650
      Valid probs shape: (37, 91066)
    ✓ Random_17 (pose=(-0.3591337402942689, 1.7464606915126737, 0.07284901783136588)): shape (37, 800, 800)
      Valid pixels: 84050/640000 (13.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=171, max=263649, num_faces=263650
      Valid probs shape: (37, 84050)
    ✓ Random_18 (pose=(-3.0336373491318556, -1.6096658626725227, -0.8245974684090971)): shape (37, 800, 800)
      Valid pixels: 75738/640000 (11.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8, max=263648, num_faces=263650
      Valid probs shape: (37, 75738)
    ✓ Random_19 (pose=(1.9328423540803117, -3.0819940502148193, 0.4600213843774634)): shape (37, 800, 800)
      Valid pixels: 83812/640000 (13.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=263649, num_faces=263650
      Valid probs shape: (37, 83812)
    P stats: min=0.0000, max=0.9999, mean=0.0230
    Non-zero vertices: 112204/131827
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 19623   817  1150  3319     0  1726  1004  3561  5892]
  Ground Truth Stats:
    Labels shape: (131827,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-9/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7261
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8138
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8141

  RESULTS:
  RAW:         median(top-10)=0.8840, mean(top-10)=0.8891, median(all)=0.7978, mean(all)=0.7261
  + SMOOTHING: median(top-10)=0.9148, mean(top-10)=0.9224, median(all)=0.8760, mean(all)=0.8138 [+0.0307]
  + MRF:       median(top-10)=0.9150, mean(top-10)=0.9224, median(all)=0.8757, mean(all)=0.8141 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0310

================================================================================
Subject: MMRR-3T7T-2-1
================================================================================
  Step 0: Generating predictions with V2 model (20 random views)...
  Mesh: 150156 vertices, 300308 faces
  Generating 20 random views...
  Generating predictions for 20 views (continuous camera pose)...
    ✓ Random_0 (pose=(0.5916827970828353, 1.2605992749206978, -1.3981550773736302)): shape (37, 800, 800)
      Valid pixels: 110345/640000 (17.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=9, max=300306, num_faces=300308
      Valid probs shape: (37, 110345)
    ✓ Random_1 (pose=(-2.1992541087075064, -2.642525990316987, -2.6244419037583744)): shape (37, 800, 800)
      Valid pixels: 94621/640000 (14.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=300304, num_faces=300308
      Valid probs shape: (37, 94621)
    ✓ Random_2 (pose=(3.0170536101092997, -1.4116872762798114, -2.423302114997326)): shape (37, 800, 800)
      Valid pixels: 102046/640000 (15.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=42, max=300306, num_faces=300308
      Valid probs shape: (37, 102046)
    ✓ Random_3 (pose=(-0.28254592663333034, -2.6304121728652605, -1.1213632861372789)): shape (37, 800, 800)
      Valid pixels: 78906/640000 (12.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=11770, max=300280, num_faces=300308
      Valid probs shape: (37, 78906)
    ✓ Random_4 (pose=(-1.4369567707527957, -1.1097141624115143, -0.6815158105081927)): shape (37, 800, 800)
      Valid pixels: 110740/640000 (17.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=8, max=300280, num_faces=300308
      Valid probs shape: (37, 110740)
    ✓ Random_5 (pose=(2.280230152016655, -2.203435698413038, -0.30098157088506605)): shape (37, 800, 800)
      Valid pixels: 97137/640000 (15.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=300305, num_faces=300308
      Valid probs shape: (37, 97137)
    ✓ Random_6 (pose=(-0.08648431276642654, -1.5552402804855157, 2.1813919567866664)): shape (37, 800, 800)
      Valid pixels: 94293/640000 (14.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=300307, num_faces=300308
      Valid probs shape: (37, 94293)
    ✓ Random_7 (pose=(-1.053254650389008, 0.25045778924574114, 0.42120235460839917)): shape (37, 800, 800)
      Valid pixels: 89314/640000 (14.0%)
      Probs stats: min=0.0000, max=0.9995, mean=0.0270
      Face IDs: min=0, max=300279, num_faces=300308
      Valid probs shape: (37, 89314)
    ✓ Random_8 (pose=(-2.0324754677699177, 2.765978988339156, 2.2417016372793794)): shape (37, 800, 800)
      Valid pixels: 97647/640000 (15.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=300301, num_faces=300308
      Valid probs shape: (37, 97647)
    ✓ Random_9 (pose=(2.5194550315733713, -0.8793414036859333, 1.2856287151735568)): shape (37, 800, 800)
      Valid pixels: 87414/640000 (13.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=6634, max=300280, num_faces=300308
      Valid probs shape: (37, 87414)
    ✓ Random_10 (pose=(0.631143269476476, -2.1207628182823015, 1.8084401845181386)): shape (37, 800, 800)
      Valid pixels: 73335/640000 (11.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=48, max=300307, num_faces=300308
      Valid probs shape: (37, 73335)
    ✓ Random_11 (pose=(1.6523416184274282, 3.013528411587825, -2.3352683754922072)): shape (37, 800, 800)
      Valid pixels: 78403/640000 (12.3%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=1, max=300279, num_faces=300308
      Valid probs shape: (37, 78403)
    ✓ Random_12 (pose=(-2.239341188977062, -0.0483329239102539, 0.9568987814720531)): shape (37, 800, 800)
      Valid pixels: 73834/640000 (11.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=3853, max=300279, num_faces=300308
      Valid probs shape: (37, 73834)
    ✓ Random_13 (pose=(-1.2028476769389154, -1.7480772653626055, -1.6448834217210637)): shape (37, 800, 800)
      Valid pixels: 83118/640000 (13.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=31, max=300273, num_faces=300308
      Valid probs shape: (37, 83118)
    ✓ Random_14 (pose=(0.40400467596212275, 0.4023758792755969, 2.848479282674705)): shape (37, 800, 800)
      Valid pixels: 69959/640000 (10.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=299530, num_faces=300308
      Valid probs shape: (37, 69959)
    ✓ Random_15 (pose=(0.6768730859478822, 0.599997387336578, -1.1964234164611567)): shape (37, 800, 800)
      Valid pixels: 87132/640000 (13.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=300120, num_faces=300308
      Valid probs shape: (37, 87132)
    ✓ Random_16 (pose=(-0.5873653597843864, 2.7262505234814975, -0.5112459850811777)): shape (37, 800, 800)
      Valid pixels: 75443/640000 (11.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8253, max=300280, num_faces=300308
      Valid probs shape: (37, 75443)
    ✓ Random_17 (pose=(2.274384846364942, -2.35276436279906, 2.7550927853079052)): shape (37, 800, 800)
      Valid pixels: 94259/640000 (14.7%)
      Probs stats: min=0.0000, max=0.9993, mean=0.0270
      Face IDs: min=7, max=300279, num_faces=300308
      Valid probs shape: (37, 94259)
    ✓ Random_18 (pose=(-2.5323384796119166, 2.4043910866031295, -0.8557167993651746)): shape (37, 800, 800)
      Valid pixels: 95424/640000 (14.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=7, max=300258, num_faces=300308
      Valid probs shape: (37, 95424)
    ✓ Random_19 (pose=(1.37747226971595, -2.9192264942713395, 2.7080581891946025)): shape (37, 800, 800)
      Valid pixels: 108925/640000 (17.0%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=71, max=300280, num_faces=300308
      Valid probs shape: (37, 108925)
    P stats: min=0.0000, max=0.9999, mean=0.0246
    Non-zero vertices: 136722/150156
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 13434  1348  1107  3930     0  1623   928  5673  6752]
  Ground Truth Stats:
    Labels shape: (150156,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-3T7T-2-1/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7522
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8143
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8147

  RESULTS:
  RAW:         median(top-10)=0.8856, mean(top-10)=0.8945, median(all)=0.8229, mean(all)=0.7522
  + SMOOTHING: median(top-10)=0.9248, mean(top-10)=0.9276, median(all)=0.8572, mean(all)=0.8143 [+0.0391]
  + MRF:       median(top-10)=0.9254, mean(top-10)=0.9280, median(all)=0.8572, mean(all)=0.8147 [+0.0007]
  TOTAL IMPROVEMENT (median top-10): +0.0398

================================================================================
Subject: MMRR-3T7T-2-2
================================================================================
  Step 0: Generating predictions with V2 model (20 random views)...
  Mesh: 135252 vertices, 270500 faces
  Generating 20 random views...
  Generating predictions for 20 views (continuous camera pose)...
    ✓ Random_0 (pose=(1.928107446831694, 0.6223536177792628, 3.1111521800825637)): shape (37, 800, 800)
      Valid pixels: 93427/640000 (14.6%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=381, max=270499, num_faces=270500
      Valid probs shape: (37, 93427)
    ✓ Random_1 (pose=(-1.3881378142443734, -0.1381202857859063, -0.8798531442115687)): shape (37, 800, 800)
      Valid pixels: 91302/640000 (14.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=9, max=270498, num_faces=270500
      Valid probs shape: (37, 91302)
    ✓ Random_2 (pose=(-1.40011172480413, -0.0575823952142156, 2.0450374605550143)): shape (37, 800, 800)
      Valid pixels: 83559/640000 (13.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=270445, num_faces=270500
      Valid probs shape: (37, 83559)
    ✓ Random_3 (pose=(1.4446966986593397, -2.7704863977197434, 1.6044296874828143)): shape (37, 800, 800)
      Valid pixels: 62442/640000 (9.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=9, max=270499, num_faces=270500
      Valid probs shape: (37, 62442)
    ✓ Random_4 (pose=(0.8236397779792495, 0.04925002775998166, -1.8179330083218788)): shape (37, 800, 800)
      Valid pixels: 59904/640000 (9.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=270442, num_faces=270500
      Valid probs shape: (37, 59904)
    ✓ Random_5 (pose=(0.2030992961857674, -0.32182598385879135, -2.24466573567193)): shape (37, 800, 800)
      Valid pixels: 64096/640000 (10.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=270166, num_faces=270500
      Valid probs shape: (37, 64096)
    ✓ Random_6 (pose=(1.5143658117947476, -0.5513721627625796, 0.5736580810295644)): shape (37, 800, 800)
      Valid pixels: 82311/640000 (12.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=270440, num_faces=270500
      Valid probs shape: (37, 82311)
    ✓ Random_7 (pose=(1.2031348280453438, 2.562662789697945, -2.240103343957488)): shape (37, 800, 800)
      Valid pixels: 67974/640000 (10.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=714, max=270483, num_faces=270500
      Valid probs shape: (37, 67974)
    ✓ Random_8 (pose=(-1.8063832056560112, 3.094988188925373, 0.46022487258883205)): shape (37, 800, 800)
      Valid pixels: 79198/640000 (12.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=11, max=270498, num_faces=270500
      Valid probs shape: (37, 79198)
    ✓ Random_9 (pose=(1.4132460942708507, 1.8030769471954322, -1.4295772730110436)): shape (37, 800, 800)
      Valid pixels: 76841/640000 (12.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=270485, num_faces=270500
      Valid probs shape: (37, 76841)
    ✓ Random_10 (pose=(2.9782858804720673, 0.0020959255689150247, -1.642662583808396)): shape (37, 800, 800)
      Valid pixels: 47101/640000 (7.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6677, max=270497, num_faces=270500
      Valid probs shape: (37, 47101)
    ✓ Random_11 (pose=(2.9781210445559028, 1.630174844214575, -0.36457577935939955)): shape (37, 800, 800)
      Valid pixels: 66566/640000 (10.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=4, max=270446, num_faces=270500
      Valid probs shape: (37, 66566)
    ✓ Random_12 (pose=(-2.951787529216122, 2.184727937857753, -0.5437279828171278)): shape (37, 800, 800)
      Valid pixels: 69440/640000 (10.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=270436, num_faces=270500
      Valid probs shape: (37, 69440)
    ✓ Random_13 (pose=(-0.18856877569593689, -2.8776958814990756, -1.484615913989405)): shape (37, 800, 800)
      Valid pixels: 60660/640000 (9.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=72385, max=270499, num_faces=270500
      Valid probs shape: (37, 60660)
    ✓ Random_14 (pose=(-0.8269950406961932, 1.789163837417882, -1.1533258075661779)): shape (37, 800, 800)
      Valid pixels: 66376/640000 (10.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=270498, num_faces=270500
      Valid probs shape: (37, 66376)
    ✓ Random_15 (pose=(-2.42446369741875, -1.0139898786011212, 0.574164788990104)): shape (37, 800, 800)
      Valid pixels: 90637/640000 (14.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=295, max=270499, num_faces=270500
      Valid probs shape: (37, 90637)
    ✓ Random_16 (pose=(2.2770068289789727, -1.592359748011357, 2.0095242880018898)): shape (37, 800, 800)
      Valid pixels: 96865/640000 (15.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=3, max=270499, num_faces=270500
      Valid probs shape: (37, 96865)
    ✓ Random_17 (pose=(-2.1800576616257867, -2.8417395568877435, -1.0212721804215974)): shape (37, 800, 800)
      Valid pixels: 72540/640000 (11.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=270485, num_faces=270500
      Valid probs shape: (37, 72540)
    ✓ Random_18 (pose=(-2.9241116014251025, -1.1985225632343233, 2.5346923282852583)): shape (37, 800, 800)
      Valid pixels: 66921/640000 (10.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1183, max=270441, num_faces=270500
      Valid probs shape: (37, 66921)
    ✓ Random_19 (pose=(-0.053013997487320275, -0.3131848564238826, -2.9288973607724134)): shape (37, 800, 800)
      Valid pixels: 52322/640000 (8.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=269498, num_faces=270500
      Valid probs shape: (37, 52322)
    P stats: min=0.0000, max=1.0000, mean=0.0234
    Non-zero vertices: 117245/135252
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 18007   955   949  2541     0  1404   873  3479  6530]
  Ground Truth Stats:
    Labels shape: (135252,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-3T7T-2-2/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
    MRF iteration 5/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7249
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7862
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7870

  RESULTS:
  RAW:         median(top-10)=0.8793, mean(top-10)=0.8769, median(all)=0.7729, mean(all)=0.7249
  + SMOOTHING: median(top-10)=0.9049, mean(top-10)=0.9104, median(all)=0.8206, mean(all)=0.7862 [+0.0256]
  + MRF:       median(top-10)=0.9056, mean(top-10)=0.9109, median(all)=0.8214, mean(all)=0.7870 [+0.0006]
  TOTAL IMPROVEMENT (median top-10): +0.0263

================================================================================
Subject: NKI-RS-22-1
================================================================================
  Step 0: Generating predictions with V2 model (20 random views)...
  Mesh: 137338 vertices, 274672 faces
  Generating 20 random views...
  Generating predictions for 20 views (continuous camera pose)...
    ✓ Random_0 (pose=(-2.6266810199765023, -0.7644286630089767, 1.0631542804643992)): shape (37, 800, 800)
      Valid pixels: 83261/640000 (13.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5606, max=274671, num_faces=274672
      Valid probs shape: (37, 83261)
    ✓ Random_1 (pose=(-2.5425447194327018, 1.9168702810946732, 1.550712232636375)): shape (37, 800, 800)
      Valid pixels: 95477/640000 (14.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=274669, num_faces=274672
      Valid probs shape: (37, 95477)
    ✓ Random_2 (pose=(-1.534052063810694, 1.9232332429627483, -2.8780377611547276)): shape (37, 800, 800)
      Valid pixels: 97875/640000 (15.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=274588, num_faces=274672
      Valid probs shape: (37, 97875)
    ✓ Random_3 (pose=(-2.0941998212383957, -1.8159450675934568, -0.9652117314991777)): shape (37, 800, 800)
      Valid pixels: 65334/640000 (10.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=11, max=273780, num_faces=274672
      Valid probs shape: (37, 65334)
    ✓ Random_4 (pose=(-2.760290699298049, -0.24824511187076936, -3.057774776130397)): shape (37, 800, 800)
      Valid pixels: 62648/640000 (9.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=792, max=274671, num_faces=274672
      Valid probs shape: (37, 62648)
    ✓ Random_5 (pose=(2.8578813674162413, 2.7698292039383405, 2.9893619481918643)): shape (37, 800, 800)
      Valid pixels: 63608/640000 (9.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=273779, num_faces=274672
      Valid probs shape: (37, 63608)
    ✓ Random_6 (pose=(2.6314898467986767, 0.3585486655306451, 2.52273955497399)): shape (37, 800, 800)
      Valid pixels: 61610/640000 (9.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=28416, max=274670, num_faces=274672
      Valid probs shape: (37, 61610)
    ✓ Random_7 (pose=(1.2385781797648292, 0.3337267872269636, 1.5658188220419573)): shape (37, 800, 800)
      Valid pixels: 66379/640000 (10.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=273777, num_faces=274672
      Valid probs shape: (37, 66379)
    ✓ Random_8 (pose=(1.0577712607590408, -0.5579154009983869, -2.6939709976883464)): shape (37, 800, 800)
      Valid pixels: 86361/640000 (13.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=274642, num_faces=274672
      Valid probs shape: (37, 86361)
    ✓ Random_9 (pose=(-2.067376160834245, 2.1930761484417225, 0.7519996316231636)): shape (37, 800, 800)
      Valid pixels: 66602/640000 (10.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=9, max=274669, num_faces=274672
      Valid probs shape: (37, 66602)
    ✓ Random_10 (pose=(-2.8010244577073213, -0.4324145696005637, 2.963031153191764)): shape (37, 800, 800)
      Valid pixels: 62115/640000 (9.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1801, max=274670, num_faces=274672
      Valid probs shape: (37, 62115)
    ✓ Random_11 (pose=(1.503770890609462, 0.1229836372087676, 2.768463077955122)): shape (37, 800, 800)
      Valid pixels: 101190/640000 (15.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=21, max=274335, num_faces=274672
      Valid probs shape: (37, 101190)
    ✓ Random_12 (pose=(-0.3367244061848407, 0.8686074579409553, -3.0528582773014112)): shape (37, 800, 800)
      Valid pixels: 69157/640000 (10.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=274669, num_faces=274672
      Valid probs shape: (37, 69157)
    ✓ Random_13 (pose=(1.356660286939702, 2.113411692010157, -2.7374704958993923)): shape (37, 800, 800)
      Valid pixels: 79976/640000 (12.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=117, max=274670, num_faces=274672
      Valid probs shape: (37, 79976)
    ✓ Random_14 (pose=(-2.861802486075575, -0.15901937782496978, 1.9807104045553654)): shape (37, 800, 800)
      Valid pixels: 50295/640000 (7.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2996, max=274671, num_faces=274672
      Valid probs shape: (37, 50295)
    ✓ Random_15 (pose=(-0.8087650631558141, -1.6759917366352026, -1.421539670388181)): shape (37, 800, 800)
      Valid pixels: 98864/640000 (15.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=65, max=274670, num_faces=274672
      Valid probs shape: (37, 98864)
    ✓ Random_16 (pose=(-0.7910823096711415, -0.539618186036682, 0.15051221092128975)): shape (37, 800, 800)
      Valid pixels: 70239/640000 (11.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=274668, num_faces=274672
      Valid probs shape: (37, 70239)
    ✓ Random_17 (pose=(-0.12494668001579967, 1.6126620265521536, 0.08986040642378113)): shape (37, 800, 800)
      Valid pixels: 72054/640000 (11.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=274664, num_faces=274672
      Valid probs shape: (37, 72054)
    ✓ Random_18 (pose=(0.9168038599637853, 2.4172083808171125, -3.0537682058285385)): shape (37, 800, 800)
      Valid pixels: 79401/640000 (12.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1809, max=274670, num_faces=274672
      Valid probs shape: (37, 79401)
    ✓ Random_19 (pose=(0.824329844787532, -2.5025874113592836, -0.2844441379006266)): shape (37, 800, 800)
      Valid pixels: 89838/640000 (14.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=596, max=274670, num_faces=274672
      Valid probs shape: (37, 89838)
    P stats: min=0.0000, max=0.9999, mean=0.0250
    Non-zero vertices: 127213/137338
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 10125  1304   940  3420     0  2218  1217  4672  5818]
  Ground Truth Stats:
    Labels shape: (137338,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-1/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7566
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8116
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8115

  RESULTS:
  RAW:         median(top-10)=0.8972, mean(top-10)=0.9060, median(all)=0.7983, mean(all)=0.7566
  + SMOOTHING: median(top-10)=0.9307, mean(top-10)=0.9323, median(all)=0.8526, mean(all)=0.8116 [+0.0335]
  + MRF:       median(top-10)=0.9305, mean(top-10)=0.9323, median(all)=0.8524, mean(all)=0.8115 [-0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0333

================================================================================
Subject: NKI-RS-22-10
================================================================================
  Step 0: Generating predictions with V2 model (20 random views)...
  Mesh: 130448 vertices, 260892 faces
  Generating 20 random views...
  Generating predictions for 20 views (continuous camera pose)...
    ✓ Random_0 (pose=(1.0497222557710035, -0.2461603529709504, 1.0736571841424087)): shape (37, 800, 800)
      Valid pixels: 74890/640000 (11.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=260885, num_faces=260892
      Valid probs shape: (37, 74890)
    ✓ Random_1 (pose=(3.016332664372502, 1.8426594287275924, 1.365796283750102)): shape (37, 800, 800)
      Valid pixels: 106499/640000 (16.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=260885, num_faces=260892
      Valid probs shape: (37, 106499)
    ✓ Random_2 (pose=(-0.6548632573199074, -2.6066966867414116, 1.6007720440852466)): shape (37, 800, 800)
      Valid pixels: 81758/640000 (12.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1792, max=260889, num_faces=260892
      Valid probs shape: (37, 81758)
    ✓ Random_3 (pose=(2.542972867695477, -2.9796695506642457, -3.0309807225390526)): shape (37, 800, 800)
      Valid pixels: 71501/640000 (11.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=0, max=259461, num_faces=260892
      Valid probs shape: (37, 71501)
    ✓ Random_4 (pose=(1.7445865126811846, 2.191500861222355, -3.0498409254507868)): shape (37, 800, 800)
      Valid pixels: 102527/640000 (16.0%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=9, max=260804, num_faces=260892
      Valid probs shape: (37, 102527)
    ✓ Random_5 (pose=(0.5385833262579829, -1.3146896247329887, 1.9208432682069603)): shape (37, 800, 800)
      Valid pixels: 78954/640000 (12.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=260885, num_faces=260892
      Valid probs shape: (37, 78954)
    ✓ Random_6 (pose=(-1.6396812411577795, -0.002002442576678032, -0.8046438475413629)): shape (37, 800, 800)
      Valid pixels: 100641/640000 (15.7%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=9, max=260798, num_faces=260892
      Valid probs shape: (37, 100641)
    ✓ Random_7 (pose=(0.010585121915732465, -2.0794497419653304, 1.3942353450441347)): shape (37, 800, 800)
      Valid pixels: 102153/640000 (16.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=836, max=260885, num_faces=260892
      Valid probs shape: (37, 102153)
    ✓ Random_8 (pose=(1.201755441824214, -1.2533188374728472, -1.028559072885606)): shape (37, 800, 800)
      Valid pixels: 74011/640000 (11.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=30, max=260891, num_faces=260892
      Valid probs shape: (37, 74011)
    ✓ Random_9 (pose=(-2.1618251787585194, -2.4529970788095605, -2.3009273964510264)): shape (37, 800, 800)
      Valid pixels: 89352/640000 (14.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=260885, num_faces=260892
      Valid probs shape: (37, 89352)
    ✓ Random_10 (pose=(0.20254442669286243, 3.0799620891808868, -0.5257006852050776)): shape (37, 800, 800)
      Valid pixels: 51664/640000 (8.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3632, max=260885, num_faces=260892
      Valid probs shape: (37, 51664)
    ✓ Random_11 (pose=(1.6606760181641267, -0.9657518963805622, -2.7415489971534632)): shape (37, 800, 800)
      Valid pixels: 88898/640000 (13.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=22, max=260805, num_faces=260892
      Valid probs shape: (37, 88898)
    ✓ Random_12 (pose=(-2.814009480424474, -1.3914689583309545, 3.0932987079774916)): shape (37, 800, 800)
      Valid pixels: 81774/640000 (12.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=138, max=260891, num_faces=260892
      Valid probs shape: (37, 81774)
    ✓ Random_13 (pose=(1.3747340017067344, 1.636899787249357, 2.46617493375345)): shape (37, 800, 800)
      Valid pixels: 106349/640000 (16.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=5, max=260805, num_faces=260892
      Valid probs shape: (37, 106349)
    ✓ Random_14 (pose=(-0.6424121459781755, 2.8535091889729776, -0.27619017544541036)): shape (37, 800, 800)
      Valid pixels: 82754/640000 (12.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=19180, max=260804, num_faces=260892
      Valid probs shape: (37, 82754)
    ✓ Random_15 (pose=(-2.9365187086611466, 2.3077727113053683, 2.686279760140641)): shape (37, 800, 800)
      Valid pixels: 72298/640000 (11.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=260885, num_faces=260892
      Valid probs shape: (37, 72298)
    ✓ Random_16 (pose=(2.241270084137552, -2.8212504973154546, 0.24511784700217465)): shape (37, 800, 800)
      Valid pixels: 82607/640000 (12.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=260885, num_faces=260892
      Valid probs shape: (37, 82607)
    ✓ Random_17 (pose=(-0.8950573721048163, -0.6517048656573707, -1.6650446964274372)): shape (37, 800, 800)
      Valid pixels: 79106/640000 (12.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=260800, num_faces=260892
      Valid probs shape: (37, 79106)
    ✓ Random_18 (pose=(-2.8363998975370133, -2.746651217276082, -2.0418049595534566)): shape (37, 800, 800)
      Valid pixels: 68230/640000 (10.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=260884, num_faces=260892
      Valid probs shape: (37, 68230)
    ✓ Random_19 (pose=(-2.657075724315556, -2.6069816451265293, -3.0988585458221216)): shape (37, 800, 800)
      Valid pixels: 73734/640000 (11.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=260891, num_faces=260892
      Valid probs shape: (37, 73734)
    P stats: min=0.0000, max=0.9999, mean=0.0253
    Non-zero vertices: 121872/130448
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 8576 1357  914 2536    0 1907 1053 4158 6543]
  Ground Truth Stats:
    Labels shape: (130448,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-10/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7666
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8258
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8262

  RESULTS:
  RAW:         median(top-10)=0.8979, mean(top-10)=0.9080, median(all)=0.8457, mean(all)=0.7666
  + SMOOTHING: median(top-10)=0.9241, mean(top-10)=0.9270, median(all)=0.8812, mean(all)=0.8258 [+0.0262]
  + MRF:       median(top-10)=0.9246, mean(top-10)=0.9272, median(all)=0.8820, mean(all)=0.8262 [+0.0005]
  TOTAL IMPROVEMENT (median top-10): +0.0267

================================================================================
Subject: NKI-RS-22-11
================================================================================
  Step 0: Generating predictions with V2 model (20 random views)...
  Mesh: 138161 vertices, 276318 faces
  Generating 20 random views...
  Generating predictions for 20 views (continuous camera pose)...
    ✓ Random_0 (pose=(2.5798280661266206, -3.029104194904354, 2.133867051858995)): shape (37, 800, 800)
      Valid pixels: 62033/640000 (9.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=273221, num_faces=276318
      Valid probs shape: (37, 62033)
    ✓ Random_1 (pose=(0.24267317367029007, -2.4154516236223356, -0.7983056612416011)): shape (37, 800, 800)
      Valid pixels: 61830/640000 (9.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1612, max=276313, num_faces=276318
      Valid probs shape: (37, 61830)
    ✓ Random_2 (pose=(-0.4855571236997527, 0.9579995269554811, 1.20516659056897)): shape (37, 800, 800)
      Valid pixels: 78424/640000 (12.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=276184, num_faces=276318
      Valid probs shape: (37, 78424)
    ✓ Random_3 (pose=(0.7195736280943201, 2.8375622620461334, 1.1522699808673247)): shape (37, 800, 800)
      Valid pixels: 52831/640000 (8.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=824, max=276234, num_faces=276318
      Valid probs shape: (37, 52831)
    ✓ Random_4 (pose=(1.423046679911657, -2.726469203341756, -0.9660465855007248)): shape (37, 800, 800)
      Valid pixels: 84835/640000 (13.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=15, max=276313, num_faces=276318
      Valid probs shape: (37, 84835)
    ✓ Random_5 (pose=(0.5381484312848253, -0.39101642890915356, -2.252242779008607)): shape (37, 800, 800)
      Valid pixels: 64991/640000 (10.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=276070, num_faces=276318
      Valid probs shape: (37, 64991)
    ✓ Random_6 (pose=(-2.2873866209228435, 0.4543363415096837, 2.206059560216435)): shape (37, 800, 800)
      Valid pixels: 84128/640000 (13.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=171, max=276313, num_faces=276318
      Valid probs shape: (37, 84128)
    ✓ Random_7 (pose=(-0.034373036023399806, -0.47604544354197387, 3.0261328150384053)): shape (37, 800, 800)
      Valid pixels: 48921/640000 (7.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=276224, num_faces=276318
      Valid probs shape: (37, 48921)
    ✓ Random_8 (pose=(0.9913218310232565, -0.12196637830635249, -0.05477271418280649)): shape (37, 800, 800)
      Valid pixels: 88252/640000 (13.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=276238, num_faces=276318
      Valid probs shape: (37, 88252)
    ✓ Random_9 (pose=(-0.40810923876690497, -0.5860087686826012, 0.6884719653285538)): shape (37, 800, 800)
      Valid pixels: 50648/640000 (7.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=276231, num_faces=276318
      Valid probs shape: (37, 50648)
    ✓ Random_10 (pose=(2.256534827856811, -0.3722806782807706, 0.8866287964393225)): shape (37, 800, 800)
      Valid pixels: 60970/640000 (9.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=121, max=276235, num_faces=276318
      Valid probs shape: (37, 60970)
    ✓ Random_11 (pose=(-0.3325558277176097, 2.652814532121999, -1.7069325701808626)): shape (37, 800, 800)
      Valid pixels: 59659/640000 (9.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=116, max=276240, num_faces=276318
      Valid probs shape: (37, 59659)
    ✓ Random_12 (pose=(1.2248574548120565, -2.8435999248115493, 1.2816497377412022)): shape (37, 800, 800)
      Valid pixels: 65383/640000 (10.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=276240, num_faces=276318
      Valid probs shape: (37, 65383)
    ✓ Random_13 (pose=(1.5078580253755804, 0.314356594949297, -1.5409238407346508)): shape (37, 800, 800)
      Valid pixels: 64581/640000 (10.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=276313, num_faces=276318
      Valid probs shape: (37, 64581)
    ✓ Random_14 (pose=(-2.685452665879719, 2.478771176301656, -0.9135613427294298)): shape (37, 800, 800)
      Valid pixels: 73482/640000 (11.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=276181, num_faces=276318
      Valid probs shape: (37, 73482)
    ✓ Random_15 (pose=(-2.7681153417528783, -0.7515405410049998, -3.124606207787275)): shape (37, 800, 800)
      Valid pixels: 67696/640000 (10.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=192, max=276313, num_faces=276318
      Valid probs shape: (37, 67696)
    ✓ Random_16 (pose=(1.292346820616605, -0.9961988147058722, 2.6457844068530783)): shape (37, 800, 800)
      Valid pixels: 92062/640000 (14.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=13, max=276315, num_faces=276318
      Valid probs shape: (37, 92062)
    ✓ Random_17 (pose=(-1.6298839625957626, 0.8113996161607719, -1.981095975880806)): shape (37, 800, 800)
      Valid pixels: 66298/640000 (10.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=276235, num_faces=276318
      Valid probs shape: (37, 66298)
    ✓ Random_18 (pose=(0.13724788551261424, -1.2808191625632317, 1.6869750358669746)): shape (37, 800, 800)
      Valid pixels: 91697/640000 (14.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=276236, num_faces=276318
      Valid probs shape: (37, 91697)
    ✓ Random_19 (pose=(0.30489827351865406, -2.8310425353548343, -0.8160867017530968)): shape (37, 800, 800)
      Valid pixels: 47426/640000 (7.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1338, max=276313, num_faces=276318
      Valid probs shape: (37, 47426)
    P stats: min=0.0000, max=0.9999, mean=0.0232
    Non-zero vertices: 118415/138161
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 19746   976  1076  2755     0  2259  1106  4024  5729]
  Ground Truth Stats:
    Labels shape: (138161,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-11/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7321
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8099
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8103

  RESULTS:
  RAW:         median(top-10)=0.8787, mean(top-10)=0.8812, median(all)=0.7993, mean(all)=0.7321
  + SMOOTHING: median(top-10)=0.9161, mean(top-10)=0.9179, median(all)=0.8568, mean(all)=0.8099 [+0.0374]
  + MRF:       median(top-10)=0.9168, mean(top-10)=0.9183, median(all)=0.8579, mean(all)=0.8103 [+0.0007]
  TOTAL IMPROVEMENT (median top-10): +0.0381

================================================================================
Subject: NKI-RS-22-12
================================================================================
  Step 0: Generating predictions with V2 model (20 random views)...
  Mesh: 144832 vertices, 289660 faces
  Generating 20 random views...
  Generating predictions for 20 views (continuous camera pose)...
    ✓ Random_0 (pose=(-2.1246137238392064, -1.8078425655529036, -1.3554019179699008)): shape (37, 800, 800)
      Valid pixels: 62855/640000 (9.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=9, max=289650, num_faces=289660
      Valid probs shape: (37, 62855)
    ✓ Random_1 (pose=(-0.4630706136214733, -0.2809633120588515, -0.5297756438160088)): shape (37, 800, 800)
      Valid pixels: 59777/640000 (9.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=287505, num_faces=289660
      Valid probs shape: (37, 59777)
    ✓ Random_2 (pose=(1.4544862388575268, -1.1586208148390507, -0.24850571439986124)): shape (37, 800, 800)
      Valid pixels: 97474/640000 (15.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=34, max=289648, num_faces=289660
      Valid probs shape: (37, 97474)
    ✓ Random_3 (pose=(-3.1302716055844115, 0.00649722277041187, 0.9787764621871418)): shape (37, 800, 800)
      Valid pixels: 41170/640000 (6.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=9923, max=289657, num_faces=289660
      Valid probs shape: (37, 41170)
    ✓ Random_4 (pose=(-2.306865804132332, -0.4835955606344293, -2.7481732186556864)): shape (37, 800, 800)
      Valid pixels: 75952/640000 (11.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=183, max=289648, num_faces=289660
      Valid probs shape: (37, 75952)
    ✓ Random_5 (pose=(0.6099303725707776, 3.0078432552202035, -0.4502771702041275)): shape (37, 800, 800)
      Valid pixels: 63983/640000 (10.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1311, max=289648, num_faces=289660
      Valid probs shape: (37, 63983)
    ✓ Random_6 (pose=(0.6896925476284355, -2.6127400792723976, -2.0815763170379133)): shape (37, 800, 800)
      Valid pixels: 67569/640000 (10.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3067, max=289650, num_faces=289660
      Valid probs shape: (37, 67569)
    ✓ Random_7 (pose=(-2.969361236011935, 2.7386674267539766, 3.007223037178391)): shape (37, 800, 800)
      Valid pixels: 48482/640000 (7.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=289448, num_faces=289660
      Valid probs shape: (37, 48482)
    ✓ Random_8 (pose=(-1.3850186224923493, -1.7987184936031368, 2.092228811965666)): shape (37, 800, 800)
      Valid pixels: 92040/640000 (14.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=20, max=289646, num_faces=289660
      Valid probs shape: (37, 92040)
    ✓ Random_9 (pose=(0.8216868155291688, 0.3937664270333956, -2.467583772626685)): shape (37, 800, 800)
      Valid pixels: 56280/640000 (8.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=289547, num_faces=289660
      Valid probs shape: (37, 56280)
    ✓ Random_10 (pose=(0.7420543161280264, -1.3159009707074776, 1.4919077879557516)): shape (37, 800, 800)
      Valid pixels: 70795/640000 (11.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=13, max=289648, num_faces=289660
      Valid probs shape: (37, 70795)
    ✓ Random_11 (pose=(1.3449587179081934, 0.3690926443176319, -0.7326516581393441)): shape (37, 800, 800)
      Valid pixels: 93505/640000 (14.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=289646, num_faces=289660
      Valid probs shape: (37, 93505)
    ✓ Random_12 (pose=(2.1506783475460782, -0.7974798326478116, -1.8970106261178759)): shape (37, 800, 800)
      Valid pixels: 67090/640000 (10.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=329, max=289658, num_faces=289660
      Valid probs shape: (37, 67090)
    ✓ Random_13 (pose=(1.4595658889367131, -2.6261520081119016, 1.9454818507539366)): shape (37, 800, 800)
      Valid pixels: 77226/640000 (12.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=14, max=289650, num_faces=289660
      Valid probs shape: (37, 77226)
    ✓ Random_14 (pose=(0.0010687907075697112, -2.2900566661661834, -1.5775764163590413)): shape (37, 800, 800)
      Valid pixels: 76762/640000 (12.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4452, max=289650, num_faces=289660
      Valid probs shape: (37, 76762)
    ✓ Random_15 (pose=(0.045812291952973094, -1.0668186548135434, 0.9814250606961616)): shape (37, 800, 800)
      Valid pixels: 86021/640000 (13.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=13, max=289646, num_faces=289660
      Valid probs shape: (37, 86021)
    ✓ Random_16 (pose=(-0.5252210325562627, 0.7655767892326426, 0.04620331964623725)): shape (37, 800, 800)
      Valid pixels: 77590/640000 (12.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=289655, num_faces=289660
      Valid probs shape: (37, 77590)
    ✓ Random_17 (pose=(0.5303021120134286, 2.995245235506454, -1.1747382495034808)): shape (37, 800, 800)
      Valid pixels: 57738/640000 (9.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=850, max=289651, num_faces=289660
      Valid probs shape: (37, 57738)
    ✓ Random_18 (pose=(1.6307360211001019, 2.7380529457079748, 0.9221257385503687)): shape (37, 800, 800)
      Valid pixels: 67874/640000 (10.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=15, max=289648, num_faces=289660
      Valid probs shape: (37, 67874)
    ✓ Random_19 (pose=(-0.41574243474360983, -1.3766294125115255, 0.011677165757665087)): shape (37, 800, 800)
      Valid pixels: 64563/640000 (10.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=9, max=289658, num_faces=289660
      Valid probs shape: (37, 64563)
    P stats: min=0.0000, max=1.0000, mean=0.0242
    Non-zero vertices: 129924/144832
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 14908  1160  1188  2781     0  2903  1132  4303  5646]
  Ground Truth Stats:
    Labels shape: (144832,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-12/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7536
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8262
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8265

  RESULTS:
  RAW:         median(top-10)=0.8843, mean(top-10)=0.8881, median(all)=0.8104, mean(all)=0.7536
  + SMOOTHING: median(top-10)=0.9242, mean(top-10)=0.9267, median(all)=0.8800, mean(all)=0.8262 [+0.0399]
  + MRF:       median(top-10)=0.9244, mean(top-10)=0.9272, median(all)=0.8808, mean(all)=0.8265 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0401

================================================================================
Subject: NKI-RS-22-13
================================================================================
  Step 0: Generating predictions with V2 model (20 random views)...
  Mesh: 121451 vertices, 242898 faces
  Generating 20 random views...
  Generating predictions for 20 views (continuous camera pose)...
    ✓ Random_0 (pose=(-1.6243222485675894, 0.9878093462602653, 0.5713026920465758)): shape (37, 800, 800)
      Valid pixels: 71484/640000 (11.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=32, max=242897, num_faces=242898
      Valid probs shape: (37, 71484)
    ✓ Random_1 (pose=(0.3234483588447685, -2.3912209906922857, 2.7130640623508055)): shape (37, 800, 800)
      Valid pixels: 48887/640000 (7.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=17381, max=241720, num_faces=242898
      Valid probs shape: (37, 48887)
    ✓ Random_2 (pose=(-1.8299392471821625, -0.11872028576919869, 1.6360702250832206)): shape (37, 800, 800)
      Valid pixels: 58774/640000 (9.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=290, max=242897, num_faces=242898
      Valid probs shape: (37, 58774)
    ✓ Random_3 (pose=(2.035737524173297, 2.0972781643482463, -2.238419513723106)): shape (37, 800, 800)
      Valid pixels: 71680/640000 (11.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=26, max=242896, num_faces=242898
      Valid probs shape: (37, 71680)
    ✓ Random_4 (pose=(-0.7434711568231656, 0.8791989597725971, 0.6079657993142007)): shape (37, 800, 800)
      Valid pixels: 79860/640000 (12.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=242806, num_faces=242898
      Valid probs shape: (37, 79860)
    ✓ Random_5 (pose=(-1.1847297907463388, 0.778659088486052, 0.3569258767466805)): shape (37, 800, 800)
      Valid pixels: 81519/640000 (12.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=11, max=242897, num_faces=242898
      Valid probs shape: (37, 81519)
    ✓ Random_6 (pose=(-2.6958033181930654, -2.844659637253225, 2.1821562408951545)): shape (37, 800, 800)
      Valid pixels: 41378/640000 (6.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=242887, num_faces=242898
      Valid probs shape: (37, 41378)
    ✓ Random_7 (pose=(0.31926333705527776, 2.249478249299032, -0.4976409203437804)): shape (37, 800, 800)
      Valid pixels: 63641/640000 (9.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=504, max=242201, num_faces=242898
      Valid probs shape: (37, 63641)
    ✓ Random_8 (pose=(2.934121756251142, -0.9010434049000993, 0.3715290110460945)): shape (37, 800, 800)
      Valid pixels: 53136/640000 (8.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=16950, max=241820, num_faces=242898
      Valid probs shape: (37, 53136)
    ✓ Random_9 (pose=(-3.1212163304663707, 2.802319868701007, -1.409274290455471)): shape (37, 800, 800)
      Valid pixels: 47742/640000 (7.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=242422, num_faces=242898
      Valid probs shape: (37, 47742)
    ✓ Random_10 (pose=(0.6684391057451253, -2.990086159503503, -1.23638170111639)): shape (37, 800, 800)
      Valid pixels: 48214/640000 (7.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1263, max=242894, num_faces=242898
      Valid probs shape: (37, 48214)
    ✓ Random_11 (pose=(-0.2920067570500895, 2.8334833526693206, 2.3046842412609703)): shape (37, 800, 800)
      Valid pixels: 41952/640000 (6.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4184, max=242894, num_faces=242898
      Valid probs shape: (37, 41952)
    ✓ Random_12 (pose=(-0.7663512384848272, 1.8642116272415796, 1.6308757741332727)): shape (37, 800, 800)
      Valid pixels: 67595/640000 (10.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=32, max=242896, num_faces=242898
      Valid probs shape: (37, 67595)
    ✓ Random_13 (pose=(0.2868238008373081, 2.3590298131632403, 0.45021231719645805)): shape (37, 800, 800)
      Valid pixels: 50597/640000 (7.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=21543, max=241820, num_faces=242898
      Valid probs shape: (37, 50597)
    ✓ Random_14 (pose=(1.7339653867578662, 1.1291815619516221, -2.0814276274578276)): shape (37, 800, 800)
      Valid pixels: 66650/640000 (10.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=32, max=242896, num_faces=242898
      Valid probs shape: (37, 66650)
    ✓ Random_15 (pose=(0.472220416823526, 2.860955048355031, 0.23322288917488043)): shape (37, 800, 800)
      Valid pixels: 48774/640000 (7.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=733, max=242203, num_faces=242898
      Valid probs shape: (37, 48774)
    ✓ Random_16 (pose=(-1.632682542817041, 0.27884699707502714, -2.648296131528524)): shape (37, 800, 800)
      Valid pixels: 77868/640000 (12.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=242568, num_faces=242898
      Valid probs shape: (37, 77868)
    ✓ Random_17 (pose=(2.174037112575701, 2.919951512508522, -1.366579702021409)): shape (37, 800, 800)
      Valid pixels: 50685/640000 (7.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=242886, num_faces=242898
      Valid probs shape: (37, 50685)
    ✓ Random_18 (pose=(-0.8981521294555774, -2.9317766570254298, -1.6975281850475354)): shape (37, 800, 800)
      Valid pixels: 51134/640000 (8.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=15665, max=241819, num_faces=242898
      Valid probs shape: (37, 51134)
    ✓ Random_19 (pose=(-0.09090887015901172, 2.844339057835609, 2.4426566217976555)): shape (37, 800, 800)
      Valid pixels: 42396/640000 (6.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4224, max=242894, num_faces=242898
      Valid probs shape: (37, 42396)
    P stats: min=0.0000, max=1.0000, mean=0.0220
    Non-zero vertices: 98796/121451
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 22655   808   804  2016     0  2193   730  3554  4365]
  Ground Truth Stats:
    Labels shape: (121451,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-13/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7094
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7810
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7810

  RESULTS:
  RAW:         median(top-10)=0.8575, mean(top-10)=0.8623, median(all)=0.7611, mean(all)=0.7094
  + SMOOTHING: median(top-10)=0.9072, mean(top-10)=0.9042, median(all)=0.8340, mean(all)=0.7810 [+0.0497]
  + MRF:       median(top-10)=0.9078, mean(top-10)=0.9046, median(all)=0.8345, mean(all)=0.7810 [+0.0006]
  TOTAL IMPROVEMENT (median top-10): +0.0503

================================================================================
Subject: NKI-RS-22-14
================================================================================
  Step 0: Generating predictions with V2 model (20 random views)...
  Mesh: 142823 vertices, 285642 faces
  Generating 20 random views...
  Generating predictions for 20 views (continuous camera pose)...
    ✓ Random_0 (pose=(0.7824870763037168, 0.16237945127834896, 0.007089725452035456)): shape (37, 800, 800)
      Valid pixels: 65915/640000 (10.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=285637, num_faces=285642
      Valid probs shape: (37, 65915)
    ✓ Random_1 (pose=(-2.325227334894872, -2.5981742029997057, -0.31837331943330005)): shape (37, 800, 800)
      Valid pixels: 70946/640000 (11.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=285097, num_faces=285642
      Valid probs shape: (37, 70946)
    ✓ Random_2 (pose=(-2.094973124943252, 1.1188060314335502, 0.40203168203085893)): shape (37, 800, 800)
      Valid pixels: 66373/640000 (10.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=404, max=285641, num_faces=285642
      Valid probs shape: (37, 66373)
    ✓ Random_3 (pose=(1.5341695473640824, -2.2753981307399007, 2.380275610992361)): shape (37, 800, 800)
      Valid pixels: 85011/640000 (13.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=285229, num_faces=285642
      Valid probs shape: (37, 85011)
    ✓ Random_4 (pose=(-0.2052709913005315, 2.0540117668027644, -1.6247500003683875)): shape (37, 800, 800)
      Valid pixels: 77154/640000 (12.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=194, max=285638, num_faces=285642
      Valid probs shape: (37, 77154)
    ✓ Random_5 (pose=(0.9291555269514387, -2.3541411299858823, -0.21416999646123758)): shape (37, 800, 800)
      Valid pixels: 80924/640000 (12.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=195, max=285640, num_faces=285642
      Valid probs shape: (37, 80924)
    ✓ Random_6 (pose=(0.3787350426404541, 0.47707847038193707, -2.5805307809880698)): shape (37, 800, 800)
      Valid pixels: 49015/640000 (7.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=285641, num_faces=285642
      Valid probs shape: (37, 49015)
    ✓ Random_7 (pose=(-1.48813404941756, 1.5893791860667026, -2.4210529905951628)): shape (37, 800, 800)
      Valid pixels: 72575/640000 (11.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=285638, num_faces=285642
      Valid probs shape: (37, 72575)
    ✓ Random_8 (pose=(-0.3563572335448124, 1.2443798729081363, 1.842592311631189)): shape (37, 800, 800)
      Valid pixels: 67826/640000 (10.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=20, max=285641, num_faces=285642
      Valid probs shape: (37, 67826)
    ✓ Random_9 (pose=(-2.7860504734446803, -0.8100631795724951, 2.539744236535789)): shape (37, 800, 800)
      Valid pixels: 51844/640000 (8.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1289, max=285641, num_faces=285642
      Valid probs shape: (37, 51844)
    ✓ Random_10 (pose=(-1.923903988561862, 1.1508949025684956, 0.4672032230269245)): shape (37, 800, 800)
      Valid pixels: 67860/640000 (10.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=22, max=285641, num_faces=285642
      Valid probs shape: (37, 67860)
    ✓ Random_11 (pose=(0.6401989266210188, -0.08568465239755385, 2.693227611177776)): shape (37, 800, 800)
      Valid pixels: 59506/640000 (9.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=284208, num_faces=285642
      Valid probs shape: (37, 59506)
    ✓ Random_12 (pose=(3.111897247403375, -0.25038628650442263, -1.540739667023121)): shape (37, 800, 800)
      Valid pixels: 42909/640000 (6.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3176, max=285638, num_faces=285642
      Valid probs shape: (37, 42909)
    ✓ Random_13 (pose=(-1.0063338314379866, -1.597104596549229, -2.6359892614030485)): shape (37, 800, 800)
      Valid pixels: 65539/640000 (10.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6, max=285637, num_faces=285642
      Valid probs shape: (37, 65539)
    ✓ Random_14 (pose=(1.0358332857133083, -1.8719532904200586, 1.0785279912611019)): shape (37, 800, 800)
      Valid pixels: 74321/640000 (11.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7, max=285638, num_faces=285642
      Valid probs shape: (37, 74321)
    ✓ Random_15 (pose=(-1.5448100771421753, 0.19758925563404928, -0.2733085756177984)): shape (37, 800, 800)
      Valid pixels: 87350/640000 (13.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=285584, num_faces=285642
      Valid probs shape: (37, 87350)
    ✓ Random_16 (pose=(-0.5275629047563668, 2.2235786396734953, 1.0222360138594615)): shape (37, 800, 800)
      Valid pixels: 76418/640000 (11.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=30, max=285641, num_faces=285642
      Valid probs shape: (37, 76418)
    ✓ Random_17 (pose=(-0.9067170934216962, -1.1643817981406483, 2.867787476035785)): shape (37, 800, 800)
      Valid pixels: 78623/640000 (12.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=285638, num_faces=285642
      Valid probs shape: (37, 78623)
    ✓ Random_18 (pose=(0.14132919369784736, -0.16646860038285904, 2.7151638203649675)): shape (37, 800, 800)
      Valid pixels: 38960/640000 (6.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=285017, num_faces=285642
      Valid probs shape: (37, 38960)
    ✓ Random_19 (pose=(0.7427724160115186, -1.7607600592232975, -1.2013866339762072)): shape (37, 800, 800)
      Valid pixels: 65102/640000 (10.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=271, max=285641, num_faces=285642
      Valid probs shape: (37, 65102)
    P stats: min=0.0000, max=1.0000, mean=0.0243
    Non-zero vertices: 128454/142823
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 14369  1335  1251  2427     0  2304  1110  4783  6293]
  Ground Truth Stats:
    Labels shape: (142823,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-14/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7604
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8313
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8314

  RESULTS:
  RAW:         median(top-10)=0.8903, mean(top-10)=0.8950, median(all)=0.8314, mean(all)=0.7604
  + SMOOTHING: median(top-10)=0.9221, mean(top-10)=0.9263, median(all)=0.8855, mean(all)=0.8313 [+0.0317]
  + MRF:       median(top-10)=0.9223, mean(top-10)=0.9265, median(all)=0.8856, mean(all)=0.8314 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0319

================================================================================
Subject: NKI-RS-22-15
================================================================================
  Step 0: Generating predictions with V2 model (20 random views)...
  Mesh: 158740 vertices, 317476 faces
  Generating 20 random views...
  Generating predictions for 20 views (continuous camera pose)...
    ✓ Random_0 (pose=(0.04682220970768247, 1.3781997964724937, 2.7369701547928793)): shape (37, 800, 800)
      Valid pixels: 72022/640000 (11.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=317472, num_faces=317476
      Valid probs shape: (37, 72022)
    ✓ Random_1 (pose=(0.0226492188550389, 0.3189874039318732, -1.6077644517761414)): shape (37, 800, 800)
      Valid pixels: 58877/640000 (9.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=317475, num_faces=317476
      Valid probs shape: (37, 58877)
    ✓ Random_2 (pose=(2.070249936568916, 1.2878556397085017, -2.388845058150168)): shape (37, 800, 800)
      Valid pixels: 91537/640000 (14.3%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=4, max=317474, num_faces=317476
      Valid probs shape: (37, 91537)
    ✓ Random_3 (pose=(3.0619398824026316, 2.2436863310156507, -1.5139365542123933)): shape (37, 800, 800)
      Valid pixels: 84221/640000 (13.2%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=6, max=317430, num_faces=317476
      Valid probs shape: (37, 84221)
    ✓ Random_4 (pose=(2.4269305050651946, -2.5924919714115804, -0.4220972713335249)): shape (37, 800, 800)
      Valid pixels: 85049/640000 (13.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=317474, num_faces=317476
      Valid probs shape: (37, 85049)
    ✓ Random_5 (pose=(3.016138757586389, 1.6554290108527159, 1.2227168985247197)): shape (37, 800, 800)
      Valid pixels: 109773/640000 (17.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=79, max=317474, num_faces=317476
      Valid probs shape: (37, 109773)
    ✓ Random_6 (pose=(-1.9970402128451725, 2.972750194021126, -0.037619411068384956)): shape (37, 800, 800)
      Valid pixels: 93910/640000 (14.7%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=3, max=317429, num_faces=317476
      Valid probs shape: (37, 93910)
    ✓ Random_7 (pose=(-1.4840817074386168, -2.431002701449302, 2.8314461636556407)): shape (37, 800, 800)
      Valid pixels: 111775/640000 (17.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=50, max=317474, num_faces=317476
      Valid probs shape: (37, 111775)
    ✓ Random_8 (pose=(-2.0247891794304627, 2.826124049897028, 2.280270687881993)): shape (37, 800, 800)
      Valid pixels: 93283/640000 (14.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=9, max=317474, num_faces=317476
      Valid probs shape: (37, 93283)
    ✓ Random_9 (pose=(0.799898034803789, 1.5513189988061704, -1.5541161788065032)): shape (37, 800, 800)
      Valid pixels: 104830/640000 (16.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=79, max=317474, num_faces=317476
      Valid probs shape: (37, 104830)
    ✓ Random_10 (pose=(-1.2229516358421992, 0.8915502699413365, 1.9904169019135578)): shape (37, 800, 800)
      Valid pixels: 72058/640000 (11.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=317475, num_faces=317476
      Valid probs shape: (37, 72058)
    ✓ Random_11 (pose=(-0.7676928788546302, 2.9679301079012, 1.5292685111083095)): shape (37, 800, 800)
      Valid pixels: 71821/640000 (11.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2814, max=317471, num_faces=317476
      Valid probs shape: (37, 71821)
    ✓ Random_12 (pose=(-0.6118183101739354, 0.06591893324520459, 2.757380593228409)): shape (37, 800, 800)
      Valid pixels: 69894/640000 (10.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=317474, num_faces=317476
      Valid probs shape: (37, 69894)
    ✓ Random_13 (pose=(-0.39717790287173393, -1.542354853965107, -0.5066468695032156)): shape (37, 800, 800)
      Valid pixels: 81238/640000 (12.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=4, max=317474, num_faces=317476
      Valid probs shape: (37, 81238)
    ✓ Random_14 (pose=(-2.6702745700626185, 2.243127074304833, 1.0482905973598875)): shape (37, 800, 800)
      Valid pixels: 74777/640000 (11.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=8, max=317475, num_faces=317476
      Valid probs shape: (37, 74777)
    ✓ Random_15 (pose=(0.30848146191910875, 0.9923925293728155, -0.16259045105889447)): shape (37, 800, 800)
      Valid pixels: 74406/640000 (11.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=317475, num_faces=317476
      Valid probs shape: (37, 74406)
    ✓ Random_16 (pose=(-0.4273135663864438, -1.6695232952011496, -0.033041717008945426)): shape (37, 800, 800)
      Valid pixels: 76939/640000 (12.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=317474, num_faces=317476
      Valid probs shape: (37, 76939)
    ✓ Random_17 (pose=(3.0386168126409094, 0.9474073995890686, -2.082891071455031)): shape (37, 800, 800)
      Valid pixels: 93559/640000 (14.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=4496, max=317406, num_faces=317476
      Valid probs shape: (37, 93559)
    ✓ Random_18 (pose=(2.971851671412633, -2.918463332051056, -0.3536691347576042)): shape (37, 800, 800)
      Valid pixels: 59526/640000 (9.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=317471, num_faces=317476
      Valid probs shape: (37, 59526)
    ✓ Random_19 (pose=(0.4937485894208935, 2.9947010184528633, -0.017675041913089107)): shape (37, 800, 800)
      Valid pixels: 66362/640000 (10.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3050, max=317475, num_faces=317476
      Valid probs shape: (37, 66362)
    P stats: min=0.0000, max=1.0000, mean=0.0231
    Non-zero vertices: 135780/158740
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 22960   892  1383  3070     0  2073  1336  5411  7297]
  Ground Truth Stats:
    Labels shape: (158740,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-15/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7383
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8141
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8145

  RESULTS:
  RAW:         median(top-10)=0.8575, mean(top-10)=0.8649, median(all)=0.7951, mean(all)=0.7383
  + SMOOTHING: median(top-10)=0.8928, mean(top-10)=0.9041, median(all)=0.8531, mean(all)=0.8141 [+0.0353]
  + MRF:       median(top-10)=0.8931, mean(top-10)=0.9044, median(all)=0.8537, mean(all)=0.8145 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0356

================================================================================
Subject: NKI-RS-22-16
================================================================================
  Step 0: Generating predictions with V2 model (20 random views)...
  Mesh: 137370 vertices, 274736 faces
  Generating 20 random views...
  Generating predictions for 20 views (continuous camera pose)...
    ✓ Random_0 (pose=(-2.8650778628912845, 0.8661926155650415, -2.850233504413169)): shape (37, 800, 800)
      Valid pixels: 69536/640000 (10.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6718, max=274722, num_faces=274736
      Valid probs shape: (37, 69536)
    ✓ Random_1 (pose=(2.9580071852808816, -0.9088713276695315, 1.754027050332871)): shape (37, 800, 800)
      Valid pixels: 106666/640000 (16.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=9871, max=274731, num_faces=274736
      Valid probs shape: (37, 106666)
    ✓ Random_2 (pose=(-1.798401502976317, 1.6767371620570959, -1.1741274937930373)): shape (37, 800, 800)
      Valid pixels: 106764/640000 (16.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=9, max=274536, num_faces=274736
      Valid probs shape: (37, 106764)
    ✓ Random_3 (pose=(1.340297919172003, -2.100633223773787, -1.7444283249192876)): shape (37, 800, 800)
      Valid pixels: 82916/640000 (13.0%)
      Probs stats: min=0.0000, max=0.9994, mean=0.0270
      Face IDs: min=77, max=274713, num_faces=274736
      Valid probs shape: (37, 82916)
    ✓ Random_4 (pose=(-0.8528738259232567, -1.1437404321826228, 0.18659003222499138)): shape (37, 800, 800)
      Valid pixels: 86161/640000 (13.5%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=11, max=274463, num_faces=274736
      Valid probs shape: (37, 86161)
    ✓ Random_5 (pose=(2.281622621376516, -2.6325966346364766, 0.6780407653624749)): shape (37, 800, 800)
      Valid pixels: 77516/640000 (12.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=274710, num_faces=274736
      Valid probs shape: (37, 77516)
    ✓ Random_6 (pose=(-3.0994555812851927, 1.4676426499518964, 2.6782193934916103)): shape (37, 800, 800)
      Valid pixels: 83429/640000 (13.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=274711, num_faces=274736
      Valid probs shape: (37, 83429)
    ✓ Random_7 (pose=(-1.2653016397182573, -0.2358629251650486, -2.103943499029437)): shape (37, 800, 800)
      Valid pixels: 80538/640000 (12.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=274713, num_faces=274736
      Valid probs shape: (37, 80538)
    ✓ Random_8 (pose=(0.48925887088307185, 0.9919193015160204, 1.3687456510430804)): shape (37, 800, 800)
      Valid pixels: 103236/640000 (16.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=274536, num_faces=274736
      Valid probs shape: (37, 103236)
    ✓ Random_9 (pose=(-1.1806864517318312, 0.813545613369318, 2.742796116791318)): shape (37, 800, 800)
      Valid pixels: 113550/640000 (17.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=274733, num_faces=274736
      Valid probs shape: (37, 113550)
    ✓ Random_10 (pose=(-0.810501336759561, 2.4986295130627596, -3.1340658821673113)): shape (37, 800, 800)
      Valid pixels: 109778/640000 (17.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=170, max=274733, num_faces=274736
      Valid probs shape: (37, 109778)
    ✓ Random_11 (pose=(2.716881199365478, -2.7500637124543545, -2.407524406070665)): shape (37, 800, 800)
      Valid pixels: 65311/640000 (10.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=274441, num_faces=274736
      Valid probs shape: (37, 65311)
    ✓ Random_12 (pose=(0.9734759094855514, 2.8680841075809766, -2.0368990921881087)): shape (37, 800, 800)
      Valid pixels: 78203/640000 (12.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=2137, max=274731, num_faces=274736
      Valid probs shape: (37, 78203)
    ✓ Random_13 (pose=(-1.0844137776664162, -2.7817131057783717, -2.343647151882255)): shape (37, 800, 800)
      Valid pixels: 83726/640000 (13.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1054, max=274722, num_faces=274736
      Valid probs shape: (37, 83726)
    ✓ Random_14 (pose=(-2.7170665945152304, 1.904128123118844, -2.038056848075014)): shape (37, 800, 800)
      Valid pixels: 104854/640000 (16.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=274537, num_faces=274736
      Valid probs shape: (37, 104854)
    ✓ Random_15 (pose=(0.5186547650714624, 1.059061540600716, -0.6400500184975075)): shape (37, 800, 800)
      Valid pixels: 101462/640000 (15.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=274733, num_faces=274736
      Valid probs shape: (37, 101462)
    ✓ Random_16 (pose=(0.057501739450582345, 2.899619358366335, 0.3906050023316534)): shape (37, 800, 800)
      Valid pixels: 62213/640000 (9.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=69193, max=274735, num_faces=274736
      Valid probs shape: (37, 62213)
    ✓ Random_17 (pose=(0.7139127601404436, -1.9895416337912968, 1.1453918336190112)): shape (37, 800, 800)
      Valid pixels: 105845/640000 (16.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=274735, num_faces=274736
      Valid probs shape: (37, 105845)
    ✓ Random_18 (pose=(0.03253413318815079, 2.6786156536261156, 0.1595486405753932)): shape (37, 800, 800)
      Valid pixels: 64977/640000 (10.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=35828, max=274735, num_faces=274736
      Valid probs shape: (37, 64977)
    ✓ Random_19 (pose=(3.0758425114825476, 1.4697921402914664, 2.694151517682738)): shape (37, 800, 800)
      Valid pixels: 80144/640000 (12.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=274707, num_faces=274736
      Valid probs shape: (37, 80144)
    P stats: min=0.0000, max=0.9998, mean=0.0236
    Non-zero vertices: 120044/137370
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 17326   401  1192  2846     0  2023   813  4557  4447]
  Ground Truth Stats:
    Labels shape: (137370,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-16/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7244
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7940
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7941

  RESULTS:
  RAW:         median(top-10)=0.8684, mean(top-10)=0.8807, median(all)=0.7710, mean(all)=0.7244
  + SMOOTHING: median(top-10)=0.9061, mean(top-10)=0.9125, median(all)=0.8386, mean(all)=0.7940 [+0.0377]
  + MRF:       median(top-10)=0.9065, mean(top-10)=0.9129, median(all)=0.8393, mean(all)=0.7941 [+0.0004]
  TOTAL IMPROVEMENT (median top-10): +0.0381

================================================================================
Subject: NKI-RS-22-17
================================================================================
  Step 0: Generating predictions with V2 model (20 random views)...
  Mesh: 161773 vertices, 323542 faces
  Generating 20 random views...
  Generating predictions for 20 views (continuous camera pose)...
    ✓ Random_0 (pose=(-1.3553136544795414, -1.2080271741100679, -1.3958915046084603)): shape (37, 800, 800)
      Valid pixels: 82966/640000 (13.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=13, max=321669, num_faces=323542
      Valid probs shape: (37, 82966)
    ✓ Random_1 (pose=(2.528670083493976, 0.8068195704030314, 0.5353929310849299)): shape (37, 800, 800)
      Valid pixels: 94463/640000 (14.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=627, max=323494, num_faces=323542
      Valid probs shape: (37, 94463)
    ✓ Random_2 (pose=(2.6645450133451485, -0.19306647086517525, -2.9935875005097703)): shape (37, 800, 800)
      Valid pixels: 67338/640000 (10.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=14340, max=323535, num_faces=323542
      Valid probs shape: (37, 67338)
    ✓ Random_3 (pose=(-2.1675613790128203, -1.943797015122888, -2.090406066447709)): shape (37, 800, 800)
      Valid pixels: 86748/640000 (13.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=11, max=323342, num_faces=323542
      Valid probs shape: (37, 86748)
    ✓ Random_4 (pose=(0.9691445396568907, -0.5592679355376236, 0.945097460686144)): shape (37, 800, 800)
      Valid pixels: 77312/640000 (12.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=323336, num_faces=323542
      Valid probs shape: (37, 77312)
    ✓ Random_5 (pose=(1.2275506554715374, -2.4389492897988605, -0.034087755709333756)): shape (37, 800, 800)
      Valid pixels: 106496/640000 (16.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=56, max=323494, num_faces=323542
      Valid probs shape: (37, 106496)
    ✓ Random_6 (pose=(-3.052843934132037, -0.6079267853458861, -0.42312867479607785)): shape (37, 800, 800)
      Valid pixels: 56484/640000 (8.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1983, max=322968, num_faces=323542
      Valid probs shape: (37, 56484)
    ✓ Random_7 (pose=(2.719688161004812, 2.988615274647289, 2.1992554813224006)): shape (37, 800, 800)
      Valid pixels: 59223/640000 (9.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=321655, num_faces=323542
      Valid probs shape: (37, 59223)
    ✓ Random_8 (pose=(-1.5564970253684076, -1.7962734002891299, 2.747966016504728)): shape (37, 800, 800)
      Valid pixels: 109090/640000 (17.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=12, max=323497, num_faces=323542
      Valid probs shape: (37, 109090)
    ✓ Random_9 (pose=(-2.493445326891541, -1.7570468084670932, 1.6870570502383462)): shape (37, 800, 800)
      Valid pixels: 75007/640000 (11.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=22, max=323541, num_faces=323542
      Valid probs shape: (37, 75007)
    ✓ Random_10 (pose=(-1.1230649274911944, -3.092127260405505, -0.03464437009077459)): shape (37, 800, 800)
      Valid pixels: 94086/640000 (14.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=685, max=323503, num_faces=323542
      Valid probs shape: (37, 94086)
    ✓ Random_11 (pose=(-0.43449056186352086, -1.8479814533917323, -2.8019236884862733)): shape (37, 800, 800)
      Valid pixels: 62439/640000 (9.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=113, max=321667, num_faces=323542
      Valid probs shape: (37, 62439)
    ✓ Random_12 (pose=(-1.4905153243317977, 1.8462472425754282, -0.38528178644179434)): shape (37, 800, 800)
      Valid pixels: 103255/640000 (16.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=59, max=323471, num_faces=323542
      Valid probs shape: (37, 103255)
    ✓ Random_13 (pose=(-2.829754092576027, -2.545916103609691, 1.7783854185249712)): shape (37, 800, 800)
      Valid pixels: 64664/640000 (10.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=323125, num_faces=323542
      Valid probs shape: (37, 64664)
    ✓ Random_14 (pose=(-0.8824982328379245, 1.7069032595519582, -2.9455054267297043)): shape (37, 800, 800)
      Valid pixels: 108747/640000 (17.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=84, max=323540, num_faces=323542
      Valid probs shape: (37, 108747)
    ✓ Random_15 (pose=(-0.3063947829728364, 1.0332348113309768, -2.528507699891656)): shape (37, 800, 800)
      Valid pixels: 92630/640000 (14.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=323540, num_faces=323542
      Valid probs shape: (37, 92630)
    ✓ Random_16 (pose=(-0.7170630237535653, -2.306681566905766, -1.119991906520971)): shape (37, 800, 800)
      Valid pixels: 94863/640000 (14.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1293, max=323473, num_faces=323542
      Valid probs shape: (37, 94863)
    ✓ Random_17 (pose=(2.164966068805409, 0.33525968279430884, 2.3825188837026188)): shape (37, 800, 800)
      Valid pixels: 87036/640000 (13.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=15029, max=323477, num_faces=323542
      Valid probs shape: (37, 87036)
    ✓ Random_18 (pose=(-0.0023716593483689152, 0.44317055007703354, 0.9469950718202211)): shape (37, 800, 800)
      Valid pixels: 65688/640000 (10.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=321660, num_faces=323542
      Valid probs shape: (37, 65688)
    ✓ Random_19 (pose=(0.25000016859666596, 1.8926821074312503, -1.1547184791709648)): shape (37, 800, 800)
      Valid pixels: 97234/640000 (15.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=179, max=323478, num_faces=323542
      Valid probs shape: (37, 97234)
    P stats: min=0.0000, max=1.0000, mean=0.0243
    Non-zero vertices: 145605/161773
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 16168   964  1012  5361     0  2288  1317  4993  7221]
  Ground Truth Stats:
    Labels shape: (161773,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-17/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7525
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8147
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8151

  RESULTS:
  RAW:         median(top-10)=0.8893, mean(top-10)=0.8945, median(all)=0.8193, mean(all)=0.7525
  + SMOOTHING: median(top-10)=0.9183, mean(top-10)=0.9225, median(all)=0.8755, mean(all)=0.8147 [+0.0290]
  + MRF:       median(top-10)=0.9183, mean(top-10)=0.9227, median(all)=0.8773, mean(all)=0.8151 [-0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0289

================================================================================
Subject: NKI-RS-22-18
================================================================================
  Step 0: Generating predictions with V2 model (20 random views)...
  Mesh: 147633 vertices, 295262 faces
  Generating 20 random views...
  Generating predictions for 20 views (continuous camera pose)...
    ✓ Random_0 (pose=(1.008920284180781, -1.173558768620992, 0.7088272981741035)): shape (37, 800, 800)
      Valid pixels: 92488/640000 (14.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=295261, num_faces=295262
      Valid probs shape: (37, 92488)
    ✓ Random_1 (pose=(2.859427793457466, -2.667359422637317, -2.833663809171026)): shape (37, 800, 800)
      Valid pixels: 47807/640000 (7.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=295214, num_faces=295262
      Valid probs shape: (37, 47807)
    ✓ Random_2 (pose=(1.4123346778804757, 0.6468683795798431, -2.141012999314018)): shape (37, 800, 800)
      Valid pixels: 65518/640000 (10.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=18, max=295217, num_faces=295262
      Valid probs shape: (37, 65518)
    ✓ Random_3 (pose=(0.1629447271705189, 1.8763978387939648, -1.3053504210475164)): shape (37, 800, 800)
      Valid pixels: 93021/640000 (14.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=78, max=295261, num_faces=295262
      Valid probs shape: (37, 93021)
    ✓ Random_4 (pose=(-2.9191314364757996, 0.7558044669293849, 2.6073986641281683)): shape (37, 800, 800)
      Valid pixels: 61627/640000 (9.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=616, max=295260, num_faces=295262
      Valid probs shape: (37, 61627)
    ✓ Random_5 (pose=(-2.560106188234184, 2.7552995649096417, -1.745092674723162)): shape (37, 800, 800)
      Valid pixels: 60252/640000 (9.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=294688, num_faces=295262
      Valid probs shape: (37, 60252)
    ✓ Random_6 (pose=(1.7718673239695004, 2.897345547591165, -1.945727405065284)): shape (37, 800, 800)
      Valid pixels: 64207/640000 (10.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=15, max=295260, num_faces=295262
      Valid probs shape: (37, 64207)
    ✓ Random_7 (pose=(1.8969303506223785, -2.2440120173040303, 1.1055916484023163)): shape (37, 800, 800)
      Valid pixels: 58728/640000 (9.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=294978, num_faces=295262
      Valid probs shape: (37, 58728)
    ✓ Random_8 (pose=(-0.6992100868371747, 1.7760374956906713, -2.1671016477981713)): shape (37, 800, 800)
      Valid pixels: 95221/640000 (14.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=27, max=295261, num_faces=295262
      Valid probs shape: (37, 95221)
    ✓ Random_9 (pose=(1.3853903769465452, -0.085423172955013, 0.8750056830478155)): shape (37, 800, 800)
      Valid pixels: 70084/640000 (11.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=295251, num_faces=295262
      Valid probs shape: (37, 70084)
    ✓ Random_10 (pose=(1.5481443225691702, -2.853301259947112, 1.2970593921514855)): shape (37, 800, 800)
      Valid pixels: 60880/640000 (9.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=295253, num_faces=295262
      Valid probs shape: (37, 60880)
    ✓ Random_11 (pose=(-0.37455693412772595, -0.5113477886417246, 0.8878944698911582)): shape (37, 800, 800)
      Valid pixels: 50132/640000 (7.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=295218, num_faces=295262
      Valid probs shape: (37, 50132)
    ✓ Random_12 (pose=(-2.544431640956521, 1.7585445573699081, -1.4244873593122953)): shape (37, 800, 800)
      Valid pixels: 97080/640000 (15.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=295198, num_faces=295262
      Valid probs shape: (37, 97080)
    ✓ Random_13 (pose=(-1.686317428592249, 2.1568303641050104, -1.693330144005249)): shape (37, 800, 800)
      Valid pixels: 57131/640000 (8.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=294979, num_faces=295262
      Valid probs shape: (37, 57131)
    ✓ Random_14 (pose=(1.0779087839004156, 1.2073324805014893, -0.021761662243353186)): shape (37, 800, 800)
      Valid pixels: 84091/640000 (13.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=295261, num_faces=295262
      Valid probs shape: (37, 84091)
    ✓ Random_15 (pose=(2.8292950087515063, -2.581835614387969, 2.4202771264255114)): shape (37, 800, 800)
      Valid pixels: 63773/640000 (10.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=294628, num_faces=295262
      Valid probs shape: (37, 63773)
    ✓ Random_16 (pose=(-0.5011371699546521, 1.6284607755173663, -2.437831946928684)): shape (37, 800, 800)
      Valid pixels: 102490/640000 (16.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=295261, num_faces=295262
      Valid probs shape: (37, 102490)
    ✓ Random_17 (pose=(-0.9239190028803539, 1.9319977928601473, 2.8532594793506716)): shape (37, 800, 800)
      Valid pixels: 90909/640000 (14.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=66, max=295261, num_faces=295262
      Valid probs shape: (37, 90909)
    ✓ Random_18 (pose=(0.8584480299159916, -0.8692464634389219, 0.7951607481301881)): shape (37, 800, 800)
      Valid pixels: 85990/640000 (13.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=295261, num_faces=295262
      Valid probs shape: (37, 85990)
    ✓ Random_19 (pose=(-3.037759004961642, -2.396504230897151, -0.9938984641496149)): shape (37, 800, 800)
      Valid pixels: 60782/640000 (9.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=295250, num_faces=295262
      Valid probs shape: (37, 60782)
    P stats: min=0.0000, max=0.9999, mean=0.0225
    Non-zero vertices: 122674/147633
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 24959  1229  1064  2899     0  2489   960  5006  7559]
  Ground Truth Stats:
    Labels shape: (147633,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-18/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6911
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7501
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7504

  RESULTS:
  RAW:         median(top-10)=0.8535, mean(top-10)=0.8587, median(all)=0.7634, mean(all)=0.6911
  + SMOOTHING: median(top-10)=0.8967, mean(top-10)=0.8998, median(all)=0.8229, mean(all)=0.7501 [+0.0432]
  + MRF:       median(top-10)=0.8971, mean(top-10)=0.9000, median(all)=0.8235, mean(all)=0.7504 [+0.0004]
  TOTAL IMPROVEMENT (median top-10): +0.0436

================================================================================
Subject: NKI-RS-22-19
================================================================================
  Step 0: Generating predictions with V2 model (20 random views)...
  Mesh: 141397 vertices, 282790 faces
  Generating 20 random views...
  Generating predictions for 20 views (continuous camera pose)...
    ✓ Random_0 (pose=(0.33221242894461067, 1.5985555423674391, 0.41843817528226035)): shape (37, 800, 800)
      Valid pixels: 57502/640000 (9.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=12, max=282724, num_faces=282790
      Valid probs shape: (37, 57502)
    ✓ Random_1 (pose=(-1.9662708469860573, -0.03842181370804276, 0.7403087101941117)): shape (37, 800, 800)
      Valid pixels: 68609/640000 (10.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=830, max=282788, num_faces=282790
      Valid probs shape: (37, 68609)
    ✓ Random_2 (pose=(-2.4027952674995996, 2.087498372513367, -1.3376462140117422)): shape (37, 800, 800)
      Valid pixels: 81271/640000 (12.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=282691, num_faces=282790
      Valid probs shape: (37, 81271)
    ✓ Random_3 (pose=(-0.45124582023688564, 2.746848712515777, 0.11275941895108588)): shape (37, 800, 800)
      Valid pixels: 68969/640000 (10.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=29683, max=282789, num_faces=282790
      Valid probs shape: (37, 68969)
    ✓ Random_4 (pose=(1.534088209285068, -3.1141304490805024, 2.065979478121199)): shape (37, 800, 800)
      Valid pixels: 75220/640000 (11.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=282741, num_faces=282790
      Valid probs shape: (37, 75220)
    ✓ Random_5 (pose=(2.567514080141815, -0.8472999227724216, -2.368138552355301)): shape (37, 800, 800)
      Valid pixels: 51614/640000 (8.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=215, max=282789, num_faces=282790
      Valid probs shape: (37, 51614)
    ✓ Random_6 (pose=(-2.5662656050610515, 0.09955446115810185, -0.7728196709150046)): shape (37, 800, 800)
      Valid pixels: 67670/640000 (10.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=31420, max=282789, num_faces=282790
      Valid probs shape: (37, 67670)
    ✓ Random_7 (pose=(-2.461196583502348, 0.4874237985556227, 0.3047907528352436)): shape (37, 800, 800)
      Valid pixels: 60471/640000 (9.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1553, max=282788, num_faces=282790
      Valid probs shape: (37, 60471)
    ✓ Random_8 (pose=(0.3811170923439451, -1.6083825270385315, -0.8420988840538519)): shape (37, 800, 800)
      Valid pixels: 64362/640000 (10.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=23, max=282787, num_faces=282790
      Valid probs shape: (37, 64362)
    ✓ Random_9 (pose=(-2.7798581685690817, -0.37821366898498576, -1.1721769917483675)): shape (37, 800, 800)
      Valid pixels: 47909/640000 (7.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2617, max=282789, num_faces=282790
      Valid probs shape: (37, 47909)
    ✓ Random_10 (pose=(0.9910915037861852, 0.16370329119198734, 1.1632552605220017)): shape (37, 800, 800)
      Valid pixels: 52710/640000 (8.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=282685, num_faces=282790
      Valid probs shape: (37, 52710)
    ✓ Random_11 (pose=(-0.6463159794953324, 2.271359147893647, 1.7287093497425392)): shape (37, 800, 800)
      Valid pixels: 61748/640000 (9.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1445, max=282789, num_faces=282790
      Valid probs shape: (37, 61748)
    ✓ Random_12 (pose=(-3.063358362328401, 2.8278866668415166, -0.7959713567386077)): shape (37, 800, 800)
      Valid pixels: 47183/640000 (7.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=282358, num_faces=282790
      Valid probs shape: (37, 47183)
    ✓ Random_13 (pose=(1.7368038389625546, -0.7296530315766399, 1.3878985912295798)): shape (37, 800, 800)
      Valid pixels: 55843/640000 (8.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6, max=282724, num_faces=282790
      Valid probs shape: (37, 55843)
    ✓ Random_14 (pose=(2.1077720017234816, 0.8321521981435884, -1.731609889877678)): shape (37, 800, 800)
      Valid pixels: 63570/640000 (9.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=857, max=282789, num_faces=282790
      Valid probs shape: (37, 63570)
    ✓ Random_15 (pose=(1.7900084623941757, -0.09932619611742988, 3.026992684923944)): shape (37, 800, 800)
      Valid pixels: 86556/640000 (13.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=26, max=282789, num_faces=282790
      Valid probs shape: (37, 86556)
    ✓ Random_16 (pose=(-1.8500886406735089, -2.4216942767529783, -0.6041629456625088)): shape (37, 800, 800)
      Valid pixels: 80976/640000 (12.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=282732, num_faces=282790
      Valid probs shape: (37, 80976)
    ✓ Random_17 (pose=(-1.4049537304242226, -0.9717567456199019, -1.012429259524819)): shape (37, 800, 800)
      Valid pixels: 80726/640000 (12.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=282737, num_faces=282790
      Valid probs shape: (37, 80726)
    ✓ Random_18 (pose=(0.5778205247873114, -2.988978728670958, 2.733407254686539)): shape (37, 800, 800)
      Valid pixels: 68061/640000 (10.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=31463, max=282789, num_faces=282790
      Valid probs shape: (37, 68061)
    ✓ Random_19 (pose=(0.4928966606723888, 0.09559597761520289, -2.78671389038353)): shape (37, 800, 800)
      Valid pixels: 51654/640000 (8.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=0, max=282539, num_faces=282790
      Valid probs shape: (37, 51654)
    P stats: min=0.0000, max=1.0000, mean=0.0216
    Non-zero vertices: 112794/141397
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 28603  1128  1030  3566     0  1422   508  4364  5504]
  Ground Truth Stats:
    Labels shape: (141397,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-19/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6639
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7602
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7606

  RESULTS:
  RAW:         median(top-10)=0.8716, mean(top-10)=0.8709, median(all)=0.7216, mean(all)=0.6639
  + SMOOTHING: median(top-10)=0.8967, mean(top-10)=0.8996, median(all)=0.8360, mean(all)=0.7602 [+0.0251]
  + MRF:       median(top-10)=0.8969, mean(top-10)=0.9000, median(all)=0.8365, mean(all)=0.7606 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0253

================================================================================
Subject: NKI-RS-22-2
================================================================================
  Step 0: Generating predictions with V2 model (20 random views)...
  Mesh: 137791 vertices, 275578 faces
  Generating 20 random views...
  Generating predictions for 20 views (continuous camera pose)...
    ✓ Random_0 (pose=(1.9658276752423367, -1.259782344215233, 2.9284789462751473)): shape (37, 800, 800)
      Valid pixels: 86757/640000 (13.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=128, max=275577, num_faces=275578
      Valid probs shape: (37, 86757)
    ✓ Random_1 (pose=(1.4951874214103738, 1.1236068103690666, 1.767404138350316)): shape (37, 800, 800)
      Valid pixels: 73737/640000 (11.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6, max=275577, num_faces=275578
      Valid probs shape: (37, 73737)
    ✓ Random_2 (pose=(0.3703219448427464, -1.2795283947907627, -3.0617618528696235)): shape (37, 800, 800)
      Valid pixels: 80714/640000 (12.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=275577, num_faces=275578
      Valid probs shape: (37, 80714)
    ✓ Random_3 (pose=(1.1694546810472097, -1.0074698525134584, -2.720306173621509)): shape (37, 800, 800)
      Valid pixels: 86309/640000 (13.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=5, max=275577, num_faces=275578
      Valid probs shape: (37, 86309)
    ✓ Random_4 (pose=(-0.5095818491220148, -0.09915115534356733, 1.9953191061453825)): shape (37, 800, 800)
      Valid pixels: 57863/640000 (9.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=275500, num_faces=275578
      Valid probs shape: (37, 57863)
    ✓ Random_5 (pose=(-0.013242659347915353, 2.1755345171084732, 0.9355058244843093)): shape (37, 800, 800)
      Valid pixels: 86505/640000 (13.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4463, max=275577, num_faces=275578
      Valid probs shape: (37, 86505)
    ✓ Random_6 (pose=(-0.07879880826121077, 0.549275946815158, 2.8651437869480842)): shape (37, 800, 800)
      Valid pixels: 50243/640000 (7.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=275328, num_faces=275578
      Valid probs shape: (37, 50243)
    ✓ Random_7 (pose=(-2.010326114196391, 1.4407883979937441, -2.9489976098366273)): shape (37, 800, 800)
      Valid pixels: 76712/640000 (12.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8, max=275567, num_faces=275578
      Valid probs shape: (37, 76712)
    ✓ Random_8 (pose=(1.4007101004103655, 0.6772870196768594, -0.8109112370250906)): shape (37, 800, 800)
      Valid pixels: 97481/640000 (15.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=31, max=275500, num_faces=275578
      Valid probs shape: (37, 97481)
    ✓ Random_9 (pose=(-0.5178339162662335, -0.4595505416970864, -2.5691981870374616)): shape (37, 800, 800)
      Valid pixels: 52196/640000 (8.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=274167, num_faces=275578
      Valid probs shape: (37, 52196)
    ✓ Random_10 (pose=(0.990261268196523, -0.2847037695941812, -2.12238297838846)): shape (37, 800, 800)
      Valid pixels: 64255/640000 (10.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=0, max=275412, num_faces=275578
      Valid probs shape: (37, 64255)
    ✓ Random_11 (pose=(2.4623035660291306, 3.097905974822539, -1.9366660539740155)): shape (37, 800, 800)
      Valid pixels: 53993/640000 (8.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=275324, num_faces=275578
      Valid probs shape: (37, 53993)
    ✓ Random_12 (pose=(0.7563424673391252, 0.8092681958031807, -1.2984493861890358)): shape (37, 800, 800)
      Valid pixels: 87685/640000 (13.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=9, max=275500, num_faces=275578
      Valid probs shape: (37, 87685)
    ✓ Random_13 (pose=(1.730849672700205, -1.40855666408012, 2.1739604619366437)): shape (37, 800, 800)
      Valid pixels: 93027/640000 (14.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=12, max=275577, num_faces=275578
      Valid probs shape: (37, 93027)
    ✓ Random_14 (pose=(-0.08314024372749129, -0.7075894819397144, -1.8610269553238117)): shape (37, 800, 800)
      Valid pixels: 73073/640000 (11.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=275539, num_faces=275578
      Valid probs shape: (37, 73073)
    ✓ Random_15 (pose=(-1.2102213970630276, 0.4820087443276351, -1.79418926747696)): shape (37, 800, 800)
      Valid pixels: 61801/640000 (9.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=275575, num_faces=275578
      Valid probs shape: (37, 61801)
    ✓ Random_16 (pose=(-1.4708662606050218, -2.6594544224792127, -1.8510768754583138)): shape (37, 800, 800)
      Valid pixels: 61338/640000 (9.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=8, max=275575, num_faces=275578
      Valid probs shape: (37, 61338)
    ✓ Random_17 (pose=(2.8890026899277697, 1.3021155913956388, 0.8564923917025569)): shape (37, 800, 800)
      Valid pixels: 99137/640000 (15.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=44, max=275496, num_faces=275578
      Valid probs shape: (37, 99137)
    ✓ Random_18 (pose=(2.6625133431950303, -0.49077762536954905, 1.4814629308678962)): shape (37, 800, 800)
      Valid pixels: 71198/640000 (11.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=14672, max=275575, num_faces=275578
      Valid probs shape: (37, 71198)
    ✓ Random_19 (pose=(-0.022641746417557673, -2.1775365055342504, 0.021066237376614172)): shape (37, 800, 800)
      Valid pixels: 58746/640000 (9.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=710, max=275471, num_faces=275578
      Valid probs shape: (37, 58746)
    P stats: min=0.0000, max=0.9999, mean=0.0244
    Non-zero vertices: 124370/137791
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 13421   912  1061  3159     0  1381   763  4419  6898]
  Ground Truth Stats:
    Labels shape: (137791,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-2/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7422
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8112
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8114

  RESULTS:
  RAW:         median(top-10)=0.8784, mean(top-10)=0.8876, median(all)=0.8124, mean(all)=0.7422
  + SMOOTHING: median(top-10)=0.9272, mean(top-10)=0.9218, median(all)=0.8630, mean(all)=0.8112 [+0.0488]
  + MRF:       median(top-10)=0.9272, mean(top-10)=0.9221, median(all)=0.8636, mean(all)=0.8114 [+0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0489

================================================================================
Subject: NKI-RS-22-20
================================================================================
  Step 0: Generating predictions with V2 model (20 random views)...
  Mesh: 140825 vertices, 281646 faces
  Generating 20 random views...
  Generating predictions for 20 views (continuous camera pose)...
    ✓ Random_0 (pose=(1.938901800785513, -0.46018973341897684, 0.8858382573931385)): shape (37, 800, 800)
      Valid pixels: 69842/640000 (10.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=321, max=281636, num_faces=281646
      Valid probs shape: (37, 69842)
    ✓ Random_1 (pose=(-2.6458010198099133, -0.227040623413012, -0.20835977346400902)): shape (37, 800, 800)
      Valid pixels: 70221/640000 (11.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=34383, max=281645, num_faces=281646
      Valid probs shape: (37, 70221)
    ✓ Random_2 (pose=(-0.8628576750326409, 0.6867810415294713, -1.9937469774484051)): shape (37, 800, 800)
      Valid pixels: 73416/640000 (11.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=281535, num_faces=281646
      Valid probs shape: (37, 73416)
    ✓ Random_3 (pose=(0.4503462594721803, 2.910645857463913, -1.3522878834773802)): shape (37, 800, 800)
      Valid pixels: 59537/640000 (9.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3483, max=281645, num_faces=281646
      Valid probs shape: (37, 59537)
    ✓ Random_4 (pose=(-1.4489506779221473, 1.6262086330553647, 1.6556548018649622)): shape (37, 800, 800)
      Valid pixels: 69284/640000 (10.8%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=30, max=281644, num_faces=281646
      Valid probs shape: (37, 69284)
    ✓ Random_5 (pose=(-2.9129253489350906, 0.2605654436214824, -3.012831649787843)): shape (37, 800, 800)
      Valid pixels: 51040/640000 (8.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6759, max=281645, num_faces=281646
      Valid probs shape: (37, 51040)
    ✓ Random_6 (pose=(-2.748829120122952, 1.5972116267085967, -3.0872583177570343)): shape (37, 800, 800)
      Valid pixels: 66699/640000 (10.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=9, max=281535, num_faces=281646
      Valid probs shape: (37, 66699)
    ✓ Random_7 (pose=(-1.5376435083850164, 2.1230907369810987, -0.09999912081986562)): shape (37, 800, 800)
      Valid pixels: 94748/640000 (14.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=15, max=281473, num_faces=281646
      Valid probs shape: (37, 94748)
    ✓ Random_8 (pose=(2.0496427563617594, -0.15101420824407086, -2.1296665643930686)): shape (37, 800, 800)
      Valid pixels: 69883/640000 (10.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=302, max=281644, num_faces=281646
      Valid probs shape: (37, 69883)
    ✓ Random_9 (pose=(3.0386658267290105, 0.7719193846543471, -2.296825255258786)): shape (37, 800, 800)
      Valid pixels: 81252/640000 (12.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=14691, max=281645, num_faces=281646
      Valid probs shape: (37, 81252)
    ✓ Random_10 (pose=(-2.085467512896625, 2.764255649035987, -0.9521731214881122)): shape (37, 800, 800)
      Valid pixels: 89913/640000 (14.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=281470, num_faces=281646
      Valid probs shape: (37, 89913)
    ✓ Random_11 (pose=(-2.045896499125482, -0.24267585212269127, 0.718838768258677)): shape (37, 800, 800)
      Valid pixels: 76606/640000 (12.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=296, max=281644, num_faces=281646
      Valid probs shape: (37, 76606)
    ✓ Random_12 (pose=(-0.0471433234871963, -2.913371130944975, -2.21458840036918)): shape (37, 800, 800)
      Valid pixels: 53152/640000 (8.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=76902, max=281645, num_faces=281646
      Valid probs shape: (37, 53152)
    ✓ Random_13 (pose=(0.5131942489638677, -1.2034843787501686, 2.2876717678356115)): shape (37, 800, 800)
      Valid pixels: 64612/640000 (10.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=281478, num_faces=281646
      Valid probs shape: (37, 64612)
    ✓ Random_14 (pose=(0.13868615589254096, -2.163824621979943, 0.6064331496935318)): shape (37, 800, 800)
      Valid pixels: 88056/640000 (13.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=281645, num_faces=281646
      Valid probs shape: (37, 88056)
    ✓ Random_15 (pose=(3.0316094109347107, 2.192522285140871, 1.0934024149890984)): shape (37, 800, 800)
      Valid pixels: 85370/640000 (13.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=281583, num_faces=281646
      Valid probs shape: (37, 85370)
    ✓ Random_16 (pose=(-2.024453868761939, -2.64680536146901, 1.7668816452104483)): shape (37, 800, 800)
      Valid pixels: 62412/640000 (9.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=281645, num_faces=281646
      Valid probs shape: (37, 62412)
    ✓ Random_17 (pose=(-1.7695377972836226, 2.185671339059125, 0.959224017603372)): shape (37, 800, 800)
      Valid pixels: 70803/640000 (11.1%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=2, max=281643, num_faces=281646
      Valid probs shape: (37, 70803)
    ✓ Random_18 (pose=(-1.440383313136405, -3.1166325911301076, 0.22174123524703404)): shape (37, 800, 800)
      Valid pixels: 86250/640000 (13.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=20, max=281642, num_faces=281646
      Valid probs shape: (37, 86250)
    ✓ Random_19 (pose=(-0.240396412879039, 1.4853592502246187, -2.8033261640584617)): shape (37, 800, 800)
      Valid pixels: 93657/640000 (14.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=281594, num_faces=281646
      Valid probs shape: (37, 93657)
    P stats: min=0.0000, max=1.0000, mean=0.0243
    Non-zero vertices: 126779/140825
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 14046  1560   872  3504     0  2522  1060  4734  5328]
  Ground Truth Stats:
    Labels shape: (140825,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-20/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7453
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8051
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8053

  RESULTS:
  RAW:         median(top-10)=0.8752, mean(top-10)=0.8802, median(all)=0.7907, mean(all)=0.7453
  + SMOOTHING: median(top-10)=0.9056, mean(top-10)=0.9163, median(all)=0.8270, mean(all)=0.8051 [+0.0304]
  + MRF:       median(top-10)=0.9061, mean(top-10)=0.9165, median(all)=0.8273, mean(all)=0.8053 [+0.0005]
  TOTAL IMPROVEMENT (median top-10): +0.0309

================================================================================
Subject: NKI-RS-22-21
================================================================================
  Step 0: Generating predictions with V2 model (20 random views)...
  Mesh: 138920 vertices, 277836 faces
  Generating 20 random views...
  Generating predictions for 20 views (continuous camera pose)...
    ✓ Random_0 (pose=(2.3055076353574284, -1.6739498476329637, 1.1256636884460374)): shape (37, 800, 800)
      Valid pixels: 69606/640000 (10.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7, max=277106, num_faces=277836
      Valid probs shape: (37, 69606)
    ✓ Random_1 (pose=(-2.8290892877983747, 2.666980057651612, 0.7010813620214691)): shape (37, 800, 800)
      Valid pixels: 46794/640000 (7.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=277835, num_faces=277836
      Valid probs shape: (37, 46794)
    ✓ Random_2 (pose=(2.9986280941523153, 1.9148053515831922, -1.5755206657396157)): shape (37, 800, 800)
      Valid pixels: 75263/640000 (11.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=10, max=277824, num_faces=277836
      Valid probs shape: (37, 75263)
    ✓ Random_3 (pose=(2.02860732845805, 1.8777097648122858, -0.2426786428039871)): shape (37, 800, 800)
      Valid pixels: 91865/640000 (14.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=28, max=277829, num_faces=277836
      Valid probs shape: (37, 91865)
    ✓ Random_4 (pose=(1.5934658692695205, -0.7317578778694012, -0.05680723957195832)): shape (37, 800, 800)
      Valid pixels: 92086/640000 (14.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=277829, num_faces=277836
      Valid probs shape: (37, 92086)
    ✓ Random_5 (pose=(0.5154799214001984, 0.30379419879647473, 1.353691612886231)): shape (37, 800, 800)
      Valid pixels: 49276/640000 (7.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=277103, num_faces=277836
      Valid probs shape: (37, 49276)
    ✓ Random_6 (pose=(-0.9177959658383217, -2.067635320133292, -2.781276773945698)): shape (37, 800, 800)
      Valid pixels: 64837/640000 (10.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=277829, num_faces=277836
      Valid probs shape: (37, 64837)
    ✓ Random_7 (pose=(-0.29268851357561365, 2.5704860504543188, 3.074666162194619)): shape (37, 800, 800)
      Valid pixels: 52254/640000 (8.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=212, max=277835, num_faces=277836
      Valid probs shape: (37, 52254)
    ✓ Random_8 (pose=(-0.8124968472387741, -0.4968714247281456, -1.50592568773905)): shape (37, 800, 800)
      Valid pixels: 66782/640000 (10.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=277103, num_faces=277836
      Valid probs shape: (37, 66782)
    ✓ Random_9 (pose=(-1.930756168184541, -2.0746170193110274, -3.0249705833069025)): shape (37, 800, 800)
      Valid pixels: 93957/640000 (14.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=277829, num_faces=277836
      Valid probs shape: (37, 93957)
    ✓ Random_10 (pose=(1.5908565114511708, -2.348508315310876, 1.8825867254748028)): shape (37, 800, 800)
      Valid pixels: 71694/640000 (11.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=277129, num_faces=277836
      Valid probs shape: (37, 71694)
    ✓ Random_11 (pose=(0.8784159535992124, -1.0574310966066638, 0.8092633603515162)): shape (37, 800, 800)
      Valid pixels: 84046/640000 (13.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=8, max=277832, num_faces=277836
      Valid probs shape: (37, 84046)
    ✓ Random_12 (pose=(0.38522908874577766, 2.4407749899318025, -2.774491040173142)): shape (37, 800, 800)
      Valid pixels: 51281/640000 (8.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1475, max=277835, num_faces=277836
      Valid probs shape: (37, 51281)
    ✓ Random_13 (pose=(-1.11108505252442, 0.26816696977056287, 0.24249434340468312)): shape (37, 800, 800)
      Valid pixels: 74047/640000 (11.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=277834, num_faces=277836
      Valid probs shape: (37, 74047)
    ✓ Random_14 (pose=(0.044297325980429125, 1.2053979830208572, -2.2030494357665242)): shape (37, 800, 800)
      Valid pixels: 87720/640000 (13.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=12, max=277829, num_faces=277836
      Valid probs shape: (37, 87720)
    ✓ Random_15 (pose=(-1.9658822027700995, 3.138640062148438, 2.9287707544424366)): shape (37, 800, 800)
      Valid pixels: 89023/640000 (13.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=13, max=277829, num_faces=277836
      Valid probs shape: (37, 89023)
    ✓ Random_16 (pose=(2.731004890073752, -1.0665568886468577, 1.021274222450658)): shape (37, 800, 800)
      Valid pixels: 77924/640000 (12.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1055, max=277137, num_faces=277836
      Valid probs shape: (37, 77924)
    ✓ Random_17 (pose=(1.427929281064511, -2.13196863521155, -1.1071428867146214)): shape (37, 800, 800)
      Valid pixels: 74064/640000 (11.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=115, max=277830, num_faces=277836
      Valid probs shape: (37, 74064)
    ✓ Random_18 (pose=(2.643530919440895, -0.4809971146520047, 1.3816288336751184)): shape (37, 800, 800)
      Valid pixels: 65636/640000 (10.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=17757, max=277834, num_faces=277836
      Valid probs shape: (37, 65636)
    ✓ Random_19 (pose=(0.3075221728034818, -1.143607533073717, -2.377513237529893)): shape (37, 800, 800)
      Valid pixels: 83903/640000 (13.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=277103, num_faces=277836
      Valid probs shape: (37, 83903)
    P stats: min=0.0000, max=0.9999, mean=0.0240
    Non-zero vertices: 123411/138920
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 15509  1177  1377  3118     0  2140   898  4691  5990]
  Ground Truth Stats:
    Labels shape: (138920,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-21/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7394
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8048
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8050

  RESULTS:
  RAW:         median(top-10)=0.8592, mean(top-10)=0.8660, median(all)=0.7937, mean(all)=0.7394
  + SMOOTHING: median(top-10)=0.9095, mean(top-10)=0.9105, median(all)=0.8444, mean(all)=0.8048 [+0.0503]
  + MRF:       median(top-10)=0.9098, mean(top-10)=0.9108, median(all)=0.8451, mean(all)=0.8050 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0506

================================================================================
Subject: NKI-RS-22-22
================================================================================
  Step 0: Generating predictions with V2 model (20 random views)...
  Mesh: 129976 vertices, 259948 faces
  Generating 20 random views...
  Generating predictions for 20 views (continuous camera pose)...
    ✓ Random_0 (pose=(1.8755506739905021, 2.2034318704502303, -2.3420137983890026)): shape (37, 800, 800)
      Valid pixels: 69903/640000 (10.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8, max=259944, num_faces=259948
      Valid probs shape: (37, 69903)
    ✓ Random_1 (pose=(-1.8215207017407464, 0.44063614036489884, 2.700215210796723)): shape (37, 800, 800)
      Valid pixels: 91452/640000 (14.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=40, max=259946, num_faces=259948
      Valid probs shape: (37, 91452)
    ✓ Random_2 (pose=(-2.332472233121729, 2.28094149985872, 0.08701743335541945)): shape (37, 800, 800)
      Valid pixels: 64245/640000 (10.0%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=1, max=259938, num_faces=259948
      Valid probs shape: (37, 64245)
    ✓ Random_3 (pose=(-1.1960974018390491, 1.9019874755510298, 1.3691333077889496)): shape (37, 800, 800)
      Valid pixels: 66979/640000 (10.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=18, max=259946, num_faces=259948
      Valid probs shape: (37, 66979)
    ✓ Random_4 (pose=(0.5657291625525049, -2.322170474049371, 0.4702091646607416)): shape (37, 800, 800)
      Valid pixels: 79471/640000 (12.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=66, max=259947, num_faces=259948
      Valid probs shape: (37, 79471)
    ✓ Random_5 (pose=(-2.3752365054547395, -2.709628066776947, -2.2708592399463927)): shape (37, 800, 800)
      Valid pixels: 65716/640000 (10.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=259938, num_faces=259948
      Valid probs shape: (37, 65716)
    ✓ Random_6 (pose=(1.3874398329256836, 1.1010763815035993, 0.9850697042138519)): shape (37, 800, 800)
      Valid pixels: 64315/640000 (10.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=22, max=259849, num_faces=259948
      Valid probs shape: (37, 64315)
    ✓ Random_7 (pose=(-0.21935377620589014, -3.0641197069521633, 1.2616371742232797)): shape (37, 800, 800)
      Valid pixels: 40185/640000 (6.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3636, max=259947, num_faces=259948
      Valid probs shape: (37, 40185)
    ✓ Random_8 (pose=(2.2943283729270902, -2.093211678165647, -2.2228334466375284)): shape (37, 800, 800)
      Valid pixels: 60411/640000 (9.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=11, max=259946, num_faces=259948
      Valid probs shape: (37, 60411)
    ✓ Random_9 (pose=(-0.40202268628983395, 1.4108906413172004, -2.7578182726774676)): shape (37, 800, 800)
      Valid pixels: 89378/640000 (14.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=259946, num_faces=259948
      Valid probs shape: (37, 89378)
    ✓ Random_10 (pose=(0.802759558243157, -2.9283655847686036, 2.0788380740720536)): shape (37, 800, 800)
      Valid pixels: 63531/640000 (9.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=16053, max=259946, num_faces=259948
      Valid probs shape: (37, 63531)
    ✓ Random_11 (pose=(2.832569447772273, 0.8986914780610915, -0.44860106116930876)): shape (37, 800, 800)
      Valid pixels: 57900/640000 (9.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1489, max=259946, num_faces=259948
      Valid probs shape: (37, 57900)
    ✓ Random_12 (pose=(0.4935767311257133, 1.7407538283052597, 2.0561334954407817)): shape (37, 800, 800)
      Valid pixels: 83085/640000 (13.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=259947, num_faces=259948
      Valid probs shape: (37, 83085)
    ✓ Random_13 (pose=(-1.2227969471962636, -0.17968373741287147, 1.2982797254297367)): shape (37, 800, 800)
      Valid pixels: 60730/640000 (9.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=259946, num_faces=259948
      Valid probs shape: (37, 60730)
    ✓ Random_14 (pose=(-0.5389500474750535, 0.7473165896275722, 1.5858550748910742)): shape (37, 800, 800)
      Valid pixels: 59917/640000 (9.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=259897, num_faces=259948
      Valid probs shape: (37, 59917)
    ✓ Random_15 (pose=(-2.1022181578582853, 1.7443944113560104, -0.12668522145922)): shape (37, 800, 800)
      Valid pixels: 72547/640000 (11.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8, max=259888, num_faces=259948
      Valid probs shape: (37, 72547)
    ✓ Random_16 (pose=(2.426242617638768, 1.2297389465928648, 0.3007222689539053)): shape (37, 800, 800)
      Valid pixels: 91636/640000 (14.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=28, max=259946, num_faces=259948
      Valid probs shape: (37, 91636)
    ✓ Random_17 (pose=(0.13323176926083713, -2.3042656002268616, -2.8943856813475883)): shape (37, 800, 800)
      Valid pixels: 67829/640000 (10.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=10699, max=259944, num_faces=259948
      Valid probs shape: (37, 67829)
    ✓ Random_18 (pose=(0.976774983035857, -0.27899903961984407, 2.3089302376592142)): shape (37, 800, 800)
      Valid pixels: 73144/640000 (11.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=258568, num_faces=259948
      Valid probs shape: (37, 73144)
    ✓ Random_19 (pose=(-1.3167328856171445, 2.5608842995118186, 1.0228112213693903)): shape (37, 800, 800)
      Valid pixels: 67647/640000 (10.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=257, max=259945, num_faces=259948
      Valid probs shape: (37, 67647)
    P stats: min=0.0000, max=1.0000, mean=0.0239
    Non-zero vertices: 115163/129976
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 14813  1004   808  2805     0  1730  1040  4380  4977]
  Ground Truth Stats:
    Labels shape: (129976,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-22/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7395
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8033
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8035

  RESULTS:
  RAW:         median(top-10)=0.8884, mean(top-10)=0.8842, median(all)=0.8019, mean(all)=0.7395
  + SMOOTHING: median(top-10)=0.9138, mean(top-10)=0.9192, median(all)=0.8625, mean(all)=0.8033 [+0.0254]
  + MRF:       median(top-10)=0.9144, mean(top-10)=0.9196, median(all)=0.8623, mean(all)=0.8035 [+0.0006]
  TOTAL IMPROVEMENT (median top-10): +0.0260

================================================================================
Subject: NKI-RS-22-3
================================================================================
  Step 0: Generating predictions with V2 model (20 random views)...
  Mesh: 136714 vertices, 273424 faces
  Generating 20 random views...
  Generating predictions for 20 views (continuous camera pose)...
    ✓ Random_0 (pose=(0.24130770355782616, 1.7059642096502419, -1.8547575823450095)): shape (37, 800, 800)
      Valid pixels: 104237/640000 (16.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=12, max=273423, num_faces=273424
      Valid probs shape: (37, 104237)
    ✓ Random_1 (pose=(0.8010363929036277, 2.167260534230067, -2.7847991286562648)): shape (37, 800, 800)
      Valid pixels: 74115/640000 (11.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=80, max=273373, num_faces=273424
      Valid probs shape: (37, 74115)
    ✓ Random_2 (pose=(-0.28606419980892994, 0.02820771192733096, 3.113251860396004)): shape (37, 800, 800)
      Valid pixels: 55887/640000 (8.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=273411, num_faces=273424
      Valid probs shape: (37, 55887)
    ✓ Random_3 (pose=(0.19959542383170747, 2.3078980702418583, -1.1869271484595403)): shape (37, 800, 800)
      Valid pixels: 80439/640000 (12.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=767, max=273423, num_faces=273424
      Valid probs shape: (37, 80439)
    ✓ Random_4 (pose=(1.9143912504975908, 3.015143110267055, 2.060320404956756)): shape (37, 800, 800)
      Valid pixels: 79674/640000 (12.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=272264, num_faces=273424
      Valid probs shape: (37, 79674)
    ✓ Random_5 (pose=(1.6700055152707183, -0.9602180026274723, 0.5920634763229229)): shape (37, 800, 800)
      Valid pixels: 83789/640000 (13.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=30, max=273422, num_faces=273424
      Valid probs shape: (37, 83789)
    ✓ Random_6 (pose=(1.4377804998347283, 0.996304807324746, -0.1724514275957021)): shape (37, 800, 800)
      Valid pixels: 105202/640000 (16.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6, max=273422, num_faces=273424
      Valid probs shape: (37, 105202)
    ✓ Random_7 (pose=(0.16116312113485387, -2.105892723734497, -2.2481934500103438)): shape (37, 800, 800)
      Valid pixels: 94055/640000 (14.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1615, max=273373, num_faces=273424
      Valid probs shape: (37, 94055)
    ✓ Random_8 (pose=(2.435606051923319, 1.7134527611609052, -0.25548417670782264)): shape (37, 800, 800)
      Valid pixels: 86072/640000 (13.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=12, max=273416, num_faces=273424
      Valid probs shape: (37, 86072)
    ✓ Random_9 (pose=(2.614221663315952, -0.821914292291841, -1.9746237179431005)): shape (37, 800, 800)
      Valid pixels: 75030/640000 (11.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=784, max=273423, num_faces=273424
      Valid probs shape: (37, 75030)
    ✓ Random_10 (pose=(1.6219022273411294, 1.7126366197505005, -2.169904180368028)): shape (37, 800, 800)
      Valid pixels: 77611/640000 (12.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=75, max=273373, num_faces=273424
      Valid probs shape: (37, 77611)
    ✓ Random_11 (pose=(1.747893422743739, 1.759836407336608, 1.5866933890412218)): shape (37, 800, 800)
      Valid pixels: 67009/640000 (10.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=10, max=273418, num_faces=273424
      Valid probs shape: (37, 67009)
    ✓ Random_12 (pose=(-2.767312479320808, 1.8955171511091624, 2.8693732660258453)): shape (37, 800, 800)
      Valid pixels: 74801/640000 (11.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=273419, num_faces=273424
      Valid probs shape: (37, 74801)
    ✓ Random_13 (pose=(-0.24019805575067688, -0.3684671763484526, -0.7115393410892872)): shape (37, 800, 800)
      Valid pixels: 60461/640000 (9.4%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=0, max=272927, num_faces=273424
      Valid probs shape: (37, 60461)
    ✓ Random_14 (pose=(-0.471817969624857, 0.8317973474503728, -3.116761062348082)): shape (37, 800, 800)
      Valid pixels: 79115/640000 (12.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=273419, num_faces=273424
      Valid probs shape: (37, 79115)
    ✓ Random_15 (pose=(1.4078028300857302, -0.5857186664610343, -2.898475582370544)): shape (37, 800, 800)
      Valid pixels: 91507/640000 (14.3%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=1, max=273373, num_faces=273424
      Valid probs shape: (37, 91507)
    ✓ Random_16 (pose=(1.5278447048213435, 1.630919459531122, 0.22505482142398625)): shape (37, 800, 800)
      Valid pixels: 96480/640000 (15.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=15, max=273421, num_faces=273424
      Valid probs shape: (37, 96480)
    ✓ Random_17 (pose=(-1.0291481780500384, -1.4943932165053104, 2.5846904508731825)): shape (37, 800, 800)
      Valid pixels: 104771/640000 (16.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=15, max=273421, num_faces=273424
      Valid probs shape: (37, 104771)
    ✓ Random_18 (pose=(-0.17656616504372824, -2.0450881068135596, -0.3512523863222259)): shape (37, 800, 800)
      Valid pixels: 73713/640000 (11.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=82, max=273373, num_faces=273424
      Valid probs shape: (37, 73713)
    ✓ Random_19 (pose=(-0.004193230105270285, -1.311469456017258, 1.7132975383970646)): shape (37, 800, 800)
      Valid pixels: 98216/640000 (15.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=273422, num_faces=273424
      Valid probs shape: (37, 98216)
    P stats: min=0.0000, max=0.9999, mean=0.0239
    Non-zero vertices: 120922/136714
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 15792  1267  1124  2868     0  2632  1133  4713  6379]
  Ground Truth Stats:
    Labels shape: (136714,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-3/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7386
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8110
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8116

  RESULTS:
  RAW:         median(top-10)=0.8727, mean(top-10)=0.8764, median(all)=0.8007, mean(all)=0.7386
  + SMOOTHING: median(top-10)=0.9213, mean(top-10)=0.9186, median(all)=0.8481, mean(all)=0.8110 [+0.0486]
  + MRF:       median(top-10)=0.9216, mean(top-10)=0.9189, median(all)=0.8485, mean(all)=0.8116 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0489

================================================================================
Subject: NKI-RS-22-4
================================================================================
  Step 0: Generating predictions with V2 model (20 random views)...
  Mesh: 169171 vertices, 338338 faces
  Generating 20 random views...
  Generating predictions for 20 views (continuous camera pose)...
    ✓ Random_0 (pose=(2.051592404273274, 2.0424919222983515, -2.2942705616095775)): shape (37, 800, 800)
      Valid pixels: 76998/640000 (12.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=4, max=338334, num_faces=338338
      Valid probs shape: (37, 76998)
    ✓ Random_1 (pose=(-1.1510125011437167, 0.24354447488414843, -1.315776459761092)): shape (37, 800, 800)
      Valid pixels: 60645/640000 (9.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=338294, num_faces=338338
      Valid probs shape: (37, 60645)
    ✓ Random_2 (pose=(0.7512817075070539, -0.11673211990482635, -0.9942333548542779)): shape (37, 800, 800)
      Valid pixels: 66789/640000 (10.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=338207, num_faces=338338
      Valid probs shape: (37, 66789)
    ✓ Random_3 (pose=(2.375596010669116, 1.3143360974668257, 2.828397738915733)): shape (37, 800, 800)
      Valid pixels: 82025/640000 (12.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=32, max=338334, num_faces=338338
      Valid probs shape: (37, 82025)
    ✓ Random_4 (pose=(2.321850169952971, -2.21273924832186, 2.307182821098335)): shape (37, 800, 800)
      Valid pixels: 83240/640000 (13.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=13, max=338099, num_faces=338338
      Valid probs shape: (37, 83240)
    ✓ Random_5 (pose=(-0.48285764858952884, 2.799834655415726, -3.1123889087430423)): shape (37, 800, 800)
      Valid pixels: 58606/640000 (9.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1515, max=338337, num_faces=338338
      Valid probs shape: (37, 58606)
    ✓ Random_6 (pose=(0.44353694140189237, 1.0034202931773724, -1.3960375604477353)): shape (37, 800, 800)
      Valid pixels: 92051/640000 (14.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=338335, num_faces=338338
      Valid probs shape: (37, 92051)
    ✓ Random_7 (pose=(-1.04594598766734, -1.3871775002982714, 2.2207644895745613)): shape (37, 800, 800)
      Valid pixels: 100446/640000 (15.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=15, max=338337, num_faces=338338
      Valid probs shape: (37, 100446)
    ✓ Random_8 (pose=(1.79049854889577, -0.8397137685696947, 0.15791383524647395)): shape (37, 800, 800)
      Valid pixels: 85871/640000 (13.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=10, max=338337, num_faces=338338
      Valid probs shape: (37, 85871)
    ✓ Random_9 (pose=(-0.2514127150850465, 1.3335440080287029, -1.460231915923217)): shape (37, 800, 800)
      Valid pixels: 84228/640000 (13.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=338336, num_faces=338338
      Valid probs shape: (37, 84228)
    ✓ Random_10 (pose=(2.470854502173645, -2.3060063436421925, 2.5417131184999695)): shape (37, 800, 800)
      Valid pixels: 74208/640000 (11.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=338047, num_faces=338338
      Valid probs shape: (37, 74208)
    ✓ Random_11 (pose=(1.4502605895392984, -1.3905411113914334, 0.4694613128645506)): shape (37, 800, 800)
      Valid pixels: 86318/640000 (13.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=338337, num_faces=338338
      Valid probs shape: (37, 86318)
    ✓ Random_12 (pose=(1.614288971319584, 0.11504785136752238, -0.6791663526291254)): shape (37, 800, 800)
      Valid pixels: 96913/640000 (15.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=69, max=338337, num_faces=338338
      Valid probs shape: (37, 96913)
    ✓ Random_13 (pose=(0.04827493175584152, -1.2984982123232338, 1.7946773032610963)): shape (37, 800, 800)
      Valid pixels: 87071/640000 (13.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=338336, num_faces=338338
      Valid probs shape: (37, 87071)
    ✓ Random_14 (pose=(-2.487717557363254, 0.5563958402906666, 2.7037541867610413)): shape (37, 800, 800)
      Valid pixels: 70848/640000 (11.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=356, max=338337, num_faces=338338
      Valid probs shape: (37, 70848)
    ✓ Random_15 (pose=(-0.19715748540143707, -0.30636897777273164, -0.26268340245224975)): shape (37, 800, 800)
      Valid pixels: 49761/640000 (7.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=338148, num_faces=338338
      Valid probs shape: (37, 49761)
    ✓ Random_16 (pose=(-1.170504981474297, 1.2527671990676934, 1.7300578330588454)): shape (37, 800, 800)
      Valid pixels: 61783/640000 (9.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=25, max=338152, num_faces=338338
      Valid probs shape: (37, 61783)
    ✓ Random_17 (pose=(1.3387699294023099, 3.1348960291549632, -1.417733965240335)): shape (37, 800, 800)
      Valid pixels: 64355/640000 (10.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=172, max=338311, num_faces=338338
      Valid probs shape: (37, 64355)
    ✓ Random_18 (pose=(-2.000950525699465, -1.2413399083184489, 2.818793469068872)): shape (37, 800, 800)
      Valid pixels: 94254/640000 (14.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=78, max=338337, num_faces=338338
      Valid probs shape: (37, 94254)
    ✓ Random_19 (pose=(-2.491672177838038, 1.0238926891428637, 2.326168494343004)): shape (37, 800, 800)
      Valid pixels: 85916/640000 (13.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=338337, num_faces=338338
      Valid probs shape: (37, 85916)
    P stats: min=0.0000, max=0.9999, mean=0.0228
    Non-zero vertices: 142977/169171
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 26194  1371  1247  3351     0  2877  1242  5378  7204]
  Ground Truth Stats:
    Labels shape: (169171,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-4/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6949
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7779
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7783

  RESULTS:
  RAW:         median(top-10)=0.8469, mean(top-10)=0.8635, median(all)=0.7512, mean(all)=0.6949
  + SMOOTHING: median(top-10)=0.9061, mean(top-10)=0.9046, median(all)=0.8328, mean(all)=0.7779 [+0.0592]
  + MRF:       median(top-10)=0.9062, mean(top-10)=0.9050, median(all)=0.8334, mean(all)=0.7783 [+0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0594

================================================================================
Subject: NKI-RS-22-5
================================================================================
  Step 0: Generating predictions with V2 model (20 random views)...
  Mesh: 138967 vertices, 277930 faces
  Generating 20 random views...
  Generating predictions for 20 views (continuous camera pose)...
    ✓ Random_0 (pose=(-2.996127931327739, -1.4070432031684266, -2.998280191122005)): shape (37, 800, 800)
      Valid pixels: 74852/640000 (11.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=100, max=277925, num_faces=277930
      Valid probs shape: (37, 74852)
    ✓ Random_1 (pose=(0.3981171439598681, 1.6009563999610092, -2.3007312838052663)): shape (37, 800, 800)
      Valid pixels: 83189/640000 (13.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=9, max=277925, num_faces=277930
      Valid probs shape: (37, 83189)
    ✓ Random_2 (pose=(2.1344020170226568, -0.49492810158510814, 1.4581624949663015)): shape (37, 800, 800)
      Valid pixels: 69184/640000 (10.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2685, max=277693, num_faces=277930
      Valid probs shape: (37, 69184)
    ✓ Random_3 (pose=(-1.3406931558958568, 2.5500933089768623, -1.0797820465181736)): shape (37, 800, 800)
      Valid pixels: 79782/640000 (12.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=186, max=277854, num_faces=277930
      Valid probs shape: (37, 79782)
    ✓ Random_4 (pose=(-1.0361653251703404, -0.6879229334936854, 1.1306801419030776)): shape (37, 800, 800)
      Valid pixels: 61262/640000 (9.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=9, max=277927, num_faces=277930
      Valid probs shape: (37, 61262)
    ✓ Random_5 (pose=(-1.2625576704295447, -2.1222994597471168, 2.6166653412713377)): shape (37, 800, 800)
      Valid pixels: 95797/640000 (15.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=277924, num_faces=277930
      Valid probs shape: (37, 95797)
    ✓ Random_6 (pose=(1.9029386654410319, 1.0465400519579653, 1.5928482715997614)): shape (37, 800, 800)
      Valid pixels: 61268/640000 (9.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=188, max=276856, num_faces=277930
      Valid probs shape: (37, 61268)
    ✓ Random_7 (pose=(0.974947009356602, -1.9131624208766425, 2.950190554708092)): shape (37, 800, 800)
      Valid pixels: 91733/640000 (14.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=53, max=277861, num_faces=277930
      Valid probs shape: (37, 91733)
    ✓ Random_8 (pose=(-0.4206993525520497, -1.1843802748002759, 0.16574551192045517)): shape (37, 800, 800)
      Valid pixels: 61229/640000 (9.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=17, max=277926, num_faces=277930
      Valid probs shape: (37, 61229)
    ✓ Random_9 (pose=(-2.991671605783295, -0.5176279441172533, -1.9519110501118)): shape (37, 800, 800)
      Valid pixels: 54950/640000 (8.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3558, max=277928, num_faces=277930
      Valid probs shape: (37, 54950)
    ✓ Random_10 (pose=(-1.2542216550766117, 1.12970323036697, 2.957350766798397)): shape (37, 800, 800)
      Valid pixels: 97153/640000 (15.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=16, max=277928, num_faces=277930
      Valid probs shape: (37, 97153)
    ✓ Random_11 (pose=(0.6933391359603287, 2.557582151413089, -1.5622092900806142)): shape (37, 800, 800)
      Valid pixels: 67850/640000 (10.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1474, max=277924, num_faces=277930
      Valid probs shape: (37, 67850)
    ✓ Random_12 (pose=(1.6138783865963946, -0.8748563889650445, -3.016054105345779)): shape (37, 800, 800)
      Valid pixels: 83370/640000 (13.0%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=26, max=277926, num_faces=277930
      Valid probs shape: (37, 83370)
    ✓ Random_13 (pose=(-2.3317865238103135, -2.247488785491464, -0.8417168805845727)): shape (37, 800, 800)
      Valid pixels: 59692/640000 (9.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=277068, num_faces=277930
      Valid probs shape: (37, 59692)
    ✓ Random_14 (pose=(0.9544932509832966, 1.2770942291413299, 2.5966511733909563)): shape (37, 800, 800)
      Valid pixels: 83022/640000 (13.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=17, max=277925, num_faces=277930
      Valid probs shape: (37, 83022)
    ✓ Random_15 (pose=(-2.575283057684037, -0.6993580717022896, -2.3803458989767323)): shape (37, 800, 800)
      Valid pixels: 71649/640000 (11.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=163, max=277928, num_faces=277930
      Valid probs shape: (37, 71649)
    ✓ Random_16 (pose=(-2.4400296476835983, 2.6200143258059354, 2.046354617914436)): shape (37, 800, 800)
      Valid pixels: 80711/640000 (12.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=277917, num_faces=277930
      Valid probs shape: (37, 80711)
    ✓ Random_17 (pose=(0.009941441890763514, 3.088607228447527, 2.7672859207899156)): shape (37, 800, 800)
      Valid pixels: 43428/640000 (6.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=74860, max=277921, num_faces=277930
      Valid probs shape: (37, 43428)
    ✓ Random_18 (pose=(-1.9387567626995958, 0.7114727601128386, 2.8730654731673138)): shape (37, 800, 800)
      Valid pixels: 89769/640000 (14.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=277917, num_faces=277930
      Valid probs shape: (37, 89769)
    ✓ Random_19 (pose=(3.0420138603203304, -2.1336869887406245, 0.43132969645429586)): shape (37, 800, 800)
      Valid pixels: 65261/640000 (10.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=277068, num_faces=277930
      Valid probs shape: (37, 65261)
    P stats: min=0.0000, max=1.0000, mean=0.0238
    Non-zero vertices: 122317/138967
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 16650  1028   973  4008     0  1895  1247  4102  4298]
  Ground Truth Stats:
    Labels shape: (138967,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-5/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7306
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8047
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8047

  RESULTS:
  RAW:         median(top-10)=0.8751, mean(top-10)=0.8841, median(all)=0.7846, mean(all)=0.7306
  + SMOOTHING: median(top-10)=0.9097, mean(top-10)=0.9187, median(all)=0.8619, mean(all)=0.8047 [+0.0346]
  + MRF:       median(top-10)=0.9098, mean(top-10)=0.9190, median(all)=0.8619, mean(all)=0.8047 [+0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0347

================================================================================
Subject: NKI-RS-22-6
================================================================================
  Step 0: Generating predictions with V2 model (20 random views)...
  Mesh: 185380 vertices, 370756 faces
  Generating 20 random views...
  Generating predictions for 20 views (continuous camera pose)...
    ✓ Random_0 (pose=(-0.25512241293690296, 1.4850565155997622, -2.6984180618818794)): shape (37, 800, 800)
      Valid pixels: 88325/640000 (13.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=79, max=370715, num_faces=370756
      Valid probs shape: (37, 88325)
    ✓ Random_1 (pose=(-1.1365711864368575, 2.0292522923369276, 1.4737935559709614)): shape (37, 800, 800)
      Valid pixels: 68247/640000 (10.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=32, max=370753, num_faces=370756
      Valid probs shape: (37, 68247)
    ✓ Random_2 (pose=(-0.13643933665392183, -0.506997539164423, -2.6487644941196224)): shape (37, 800, 800)
      Valid pixels: 49226/640000 (7.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=368888, num_faces=370756
      Valid probs shape: (37, 49226)
    ✓ Random_3 (pose=(1.3962548953550877, -1.8081083059002268, 0.4425801890056924)): shape (37, 800, 800)
      Valid pixels: 87889/640000 (13.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=370715, num_faces=370756
      Valid probs shape: (37, 87889)
    ✓ Random_4 (pose=(1.6221119585180466, -2.9569097081549307, 0.5256168502705627)): shape (37, 800, 800)
      Valid pixels: 79483/640000 (12.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=18, max=370715, num_faces=370756
      Valid probs shape: (37, 79483)
    ✓ Random_5 (pose=(-1.1263111183922478, 1.0484189965850588, 1.3488775249348102)): shape (37, 800, 800)
      Valid pixels: 67057/640000 (10.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=22, max=370751, num_faces=370756
      Valid probs shape: (37, 67057)
    ✓ Random_6 (pose=(1.8542533741573148, 1.3373465802475728, -2.4358711989020145)): shape (37, 800, 800)
      Valid pixels: 78514/640000 (12.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=44, max=370753, num_faces=370756
      Valid probs shape: (37, 78514)
    ✓ Random_7 (pose=(-1.7908166932141198, -1.9662792123026618, 2.5365867870110392)): shape (37, 800, 800)
      Valid pixels: 89756/640000 (14.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=95, max=370715, num_faces=370756
      Valid probs shape: (37, 89756)
    ✓ Random_8 (pose=(1.487223022297556, 2.8391212210504415, -1.5329602299732632)): shape (37, 800, 800)
      Valid pixels: 62373/640000 (9.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=55, max=370714, num_faces=370756
      Valid probs shape: (37, 62373)
    ✓ Random_9 (pose=(0.15107153809868246, 2.974681062816928, -1.779168629516317)): shape (37, 800, 800)
      Valid pixels: 39476/640000 (6.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=779, max=370755, num_faces=370756
      Valid probs shape: (37, 39476)
    ✓ Random_10 (pose=(0.904457362791562, -2.8583094046112367, 0.8609768030719955)): shape (37, 800, 800)
      Valid pixels: 65195/640000 (10.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=13, max=370740, num_faces=370756
      Valid probs shape: (37, 65195)
    ✓ Random_11 (pose=(-0.4639985391739989, 2.2950106525565435, -3.0920115999480466)): shape (37, 800, 800)
      Valid pixels: 75420/640000 (11.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=75, max=370755, num_faces=370756
      Valid probs shape: (37, 75420)
    ✓ Random_12 (pose=(-3.0489113347196057, 1.2307801397057236, 1.6033810068100873)): shape (37, 800, 800)
      Valid pixels: 91729/640000 (14.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=79, max=370715, num_faces=370756
      Valid probs shape: (37, 91729)
    ✓ Random_13 (pose=(-2.724541101415287, 0.06309266464981134, -3.033952797589562)): shape (37, 800, 800)
      Valid pixels: 49656/640000 (7.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=113, max=370750, num_faces=370756
      Valid probs shape: (37, 49656)
    ✓ Random_14 (pose=(-1.9396036938144856, -1.2517192524963114, -1.3037417349882854)): shape (37, 800, 800)
      Valid pixels: 57932/640000 (9.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=45, max=370749, num_faces=370756
      Valid probs shape: (37, 57932)
    ✓ Random_15 (pose=(-2.3546556580304463, -0.1674271531378242, -0.22069994679832927)): shape (37, 800, 800)
      Valid pixels: 77297/640000 (12.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=16559, max=370753, num_faces=370756
      Valid probs shape: (37, 77297)
    ✓ Random_16 (pose=(1.9302809332927868, -1.4853583918982567, -0.8837992787512285)): shape (37, 800, 800)
      Valid pixels: 95937/640000 (15.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=76, max=370715, num_faces=370756
      Valid probs shape: (37, 95937)
    ✓ Random_17 (pose=(2.996691296120587, -2.367456442633993, -1.1659460082634996)): shape (37, 800, 800)
      Valid pixels: 72087/640000 (11.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=370715, num_faces=370756
      Valid probs shape: (37, 72087)
    ✓ Random_18 (pose=(-2.588148534111383, 2.614462203367829, 0.44500954710640794)): shape (37, 800, 800)
      Valid pixels: 50266/640000 (7.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=370709, num_faces=370756
      Valid probs shape: (37, 50266)
    ✓ Random_19 (pose=(-1.9041250469456836, 0.9830581261848979, 2.437075970768701)): shape (37, 800, 800)
      Valid pixels: 96395/640000 (15.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=113, max=370715, num_faces=370756
      Valid probs shape: (37, 96395)
    P stats: min=0.0000, max=1.0000, mean=0.0224
    Non-zero vertices: 153589/185380
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 31791   957  1842  2979     0  3107  1311  6396  7318]
  Ground Truth Stats:
    Labels shape: (185380,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-6/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7146
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7943
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7947

  RESULTS:
  RAW:         median(top-10)=0.8865, mean(top-10)=0.8868, median(all)=0.7797, mean(all)=0.7146
  + SMOOTHING: median(top-10)=0.9198, mean(top-10)=0.9198, median(all)=0.8455, mean(all)=0.7943 [+0.0334]
  + MRF:       median(top-10)=0.9203, mean(top-10)=0.9202, median(all)=0.8456, mean(all)=0.7947 [+0.0005]
  TOTAL IMPROVEMENT (median top-10): +0.0338

================================================================================
Subject: NKI-RS-22-7
================================================================================
  Step 0: Generating predictions with V2 model (20 random views)...
  Mesh: 153181 vertices, 306358 faces
  Generating 20 random views...
  Generating predictions for 20 views (continuous camera pose)...
    ✓ Random_0 (pose=(1.046087521962539, -2.9249167625672157, -0.28172373920207816)): shape (37, 800, 800)
      Valid pixels: 102954/640000 (16.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=306273, num_faces=306358
      Valid probs shape: (37, 102954)
    ✓ Random_1 (pose=(1.287438175899239, 2.5405571185140943, 1.5573517428049426)): shape (37, 800, 800)
      Valid pixels: 70166/640000 (11.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2390, max=306357, num_faces=306358
      Valid probs shape: (37, 70166)
    ✓ Random_2 (pose=(-1.953662372820557, 1.6568080633316402, 1.533203746981207)): shape (37, 800, 800)
      Valid pixels: 81479/640000 (12.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=306250, num_faces=306358
      Valid probs shape: (37, 81479)
    ✓ Random_3 (pose=(1.2358403367670538, 2.4158957223675666, -1.243098679150642)): shape (37, 800, 800)
      Valid pixels: 94794/640000 (14.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=306335, num_faces=306358
      Valid probs shape: (37, 94794)
    ✓ Random_4 (pose=(1.5796079632502869, 0.008748550375967223, 2.230962750649633)): shape (37, 800, 800)
      Valid pixels: 97928/640000 (15.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=17, max=306356, num_faces=306358
      Valid probs shape: (37, 97928)
    ✓ Random_5 (pose=(-0.665830175653785, 0.47258505225296554, 2.1323832679061194)): shape (37, 800, 800)
      Valid pixels: 53773/640000 (8.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=306156, num_faces=306358
      Valid probs shape: (37, 53773)
    ✓ Random_6 (pose=(0.26330721957334857, -1.0637787324631534, 2.7468897800951027)): shape (37, 800, 800)
      Valid pixels: 65584/640000 (10.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=306357, num_faces=306358
      Valid probs shape: (37, 65584)
    ✓ Random_7 (pose=(-1.607189362307859, 1.0694619056562384, -2.4662156777956636)): shape (37, 800, 800)
      Valid pixels: 87763/640000 (13.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=2, max=306250, num_faces=306358
      Valid probs shape: (37, 87763)
    ✓ Random_8 (pose=(-2.847177805105799, 1.472112388321979, 0.8806233388811116)): shape (37, 800, 800)
      Valid pixels: 96882/640000 (15.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=306250, num_faces=306358
      Valid probs shape: (37, 96882)
    ✓ Random_9 (pose=(-1.6828289530047291, 2.878962327751342, -0.9640966083072637)): shape (37, 800, 800)
      Valid pixels: 96565/640000 (15.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=17, max=306354, num_faces=306358
      Valid probs shape: (37, 96565)
    ✓ Random_10 (pose=(2.1322489820209194, -0.0027295431377809543, 1.9324167453911452)): shape (37, 800, 800)
      Valid pixels: 76614/640000 (12.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=12176, max=306355, num_faces=306358
      Valid probs shape: (37, 76614)
    ✓ Random_11 (pose=(1.1921881515546664, -0.8894699283162297, 0.3147932006794023)): shape (37, 800, 800)
      Valid pixels: 109861/640000 (17.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=306250, num_faces=306358
      Valid probs shape: (37, 109861)
    ✓ Random_12 (pose=(-0.06932552904672473, 2.3658716841652163, 2.218443093985031)): shape (37, 800, 800)
      Valid pixels: 77975/640000 (12.2%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=2175, max=306353, num_faces=306358
      Valid probs shape: (37, 77975)
    ✓ Random_13 (pose=(-2.5641569607968724, -0.7075527074565633, 2.955059142050735)): shape (37, 800, 800)
      Valid pixels: 83374/640000 (13.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1398, max=306352, num_faces=306358
      Valid probs shape: (37, 83374)
    ✓ Random_14 (pose=(-0.18453641580746583, -1.2344847200385332, 0.07397365950101475)): shape (37, 800, 800)
      Valid pixels: 63523/640000 (9.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=11, max=306158, num_faces=306358
      Valid probs shape: (37, 63523)
    ✓ Random_15 (pose=(0.3840708179572312, 0.6755742368813262, -1.1158296112087425)): shape (37, 800, 800)
      Valid pixels: 83839/640000 (13.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=306250, num_faces=306358
      Valid probs shape: (37, 83839)
    ✓ Random_16 (pose=(0.8098332821433059, 1.0371747235940694, 0.8263119222244755)): shape (37, 800, 800)
      Valid pixels: 65674/640000 (10.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=306357, num_faces=306358
      Valid probs shape: (37, 65674)
    ✓ Random_17 (pose=(1.6382968922938357, 2.026356121407976, 2.6397440685963813)): shape (37, 800, 800)
      Valid pixels: 107185/640000 (16.7%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=16, max=306350, num_faces=306358
      Valid probs shape: (37, 107185)
    ✓ Random_18 (pose=(-0.049604737153656764, -2.436590595005461, 0.6301804156867168)): shape (37, 800, 800)
      Valid pixels: 73701/640000 (11.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1447, max=306353, num_faces=306358
      Valid probs shape: (37, 73701)
    ✓ Random_19 (pose=(-1.1356092821024752, 0.7861217323996259, 1.563291986683648)): shape (37, 800, 800)
      Valid pixels: 67529/640000 (10.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8, max=306158, num_faces=306358
      Valid probs shape: (37, 67529)
    P stats: min=0.0000, max=1.0000, mean=0.0229
    Non-zero vertices: 129793/153181
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 23388   586  1250  3718     0  3118   883  4507  4329]
  Ground Truth Stats:
    Labels shape: (153181,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-7/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7081
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7872
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7877

  RESULTS:
  RAW:         median(top-10)=0.8793, mean(top-10)=0.8848, median(all)=0.7831, mean(all)=0.7081
  + SMOOTHING: median(top-10)=0.9211, mean(top-10)=0.9206, median(all)=0.8582, mean(all)=0.7872 [+0.0418]
  + MRF:       median(top-10)=0.9213, mean(top-10)=0.9211, median(all)=0.8587, mean(all)=0.7877 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0420

================================================================================
Subject: NKI-RS-22-8
================================================================================
  Step 0: Generating predictions with V2 model (20 random views)...
  Mesh: 158049 vertices, 316094 faces
  Generating 20 random views...
  Generating predictions for 20 views (continuous camera pose)...
    ✓ Random_0 (pose=(-1.3056954562926912, 1.7916926413703553, -0.7311720835922175)): shape (37, 800, 800)
      Valid pixels: 86782/640000 (13.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=315713, num_faces=316094
      Valid probs shape: (37, 86782)
    ✓ Random_1 (pose=(0.7460399598596412, -2.288033914486947, 1.258430642229647)): shape (37, 800, 800)
      Valid pixels: 79368/640000 (12.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=203, max=315865, num_faces=316094
      Valid probs shape: (37, 79368)
    ✓ Random_2 (pose=(2.538350338637102, -2.708380877285824, -0.8557423379611588)): shape (37, 800, 800)
      Valid pixels: 73413/640000 (11.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=316044, num_faces=316094
      Valid probs shape: (37, 73413)
    ✓ Random_3 (pose=(0.8575971563899065, 0.13043146244862136, 2.5719320373258245)): shape (37, 800, 800)
      Valid pixels: 84150/640000 (13.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=314968, num_faces=316094
      Valid probs shape: (37, 84150)
    ✓ Random_4 (pose=(2.7102837529596444, -1.5150336519406111, -1.8150129349213713)): shape (37, 800, 800)
      Valid pixels: 98482/640000 (15.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=12, max=316093, num_faces=316094
      Valid probs shape: (37, 98482)
    ✓ Random_5 (pose=(1.3590403469916073, -2.9952081522729084, -2.6146048532402766)): shape (37, 800, 800)
      Valid pixels: 83480/640000 (13.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1101, max=316092, num_faces=316094
      Valid probs shape: (37, 83480)
    ✓ Random_6 (pose=(2.5881146521939193, 2.8953349091702885, -0.3343140676772256)): shape (37, 800, 800)
      Valid pixels: 60236/640000 (9.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=316049, num_faces=316094
      Valid probs shape: (37, 60236)
    ✓ Random_7 (pose=(-1.6799219752122077, 0.8105168012631978, -0.9119225649787399)): shape (37, 800, 800)
      Valid pixels: 91625/640000 (14.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=315744, num_faces=316094
      Valid probs shape: (37, 91625)
    ✓ Random_8 (pose=(1.527036880961977, -2.5456547316177085, -2.9965410394567744)): shape (37, 800, 800)
      Valid pixels: 92762/640000 (14.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=30, max=316092, num_faces=316094
      Valid probs shape: (37, 92762)
    ✓ Random_9 (pose=(-0.4715142658321403, -1.0026091202561296, -2.7342706185069696)): shape (37, 800, 800)
      Valid pixels: 60465/640000 (9.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=315774, num_faces=316094
      Valid probs shape: (37, 60465)
    ✓ Random_10 (pose=(2.7892006861872085, 0.8466695837011011, -2.1428503374140178)): shape (37, 800, 800)
      Valid pixels: 85526/640000 (13.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2973, max=316093, num_faces=316094
      Valid probs shape: (37, 85526)
    ✓ Random_11 (pose=(-1.4677449349215885, 0.5379224443399289, 1.565343077975033)): shape (37, 800, 800)
      Valid pixels: 63092/640000 (9.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=44, max=316093, num_faces=316094
      Valid probs shape: (37, 63092)
    ✓ Random_12 (pose=(2.9567243616197443, 3.0132496962423874, 1.2381531736771558)): shape (37, 800, 800)
      Valid pixels: 50670/640000 (7.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=315776, num_faces=316094
      Valid probs shape: (37, 50670)
    ✓ Random_13 (pose=(1.4962733354966966, 0.8804870927931123, -2.3868804821289413)): shape (37, 800, 800)
      Valid pixels: 76447/640000 (11.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=15, max=316093, num_faces=316094
      Valid probs shape: (37, 76447)
    ✓ Random_14 (pose=(1.7263025574406567, -0.44265232907734564, -0.4215460147125949)): shape (37, 800, 800)
      Valid pixels: 104060/640000 (16.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=316044, num_faces=316094
      Valid probs shape: (37, 104060)
    ✓ Random_15 (pose=(-1.7211773967571657, 0.261220053690125, 2.8901574370422844)): shape (37, 800, 800)
      Valid pixels: 104733/640000 (16.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=13, max=316044, num_faces=316094
      Valid probs shape: (37, 104733)
    ✓ Random_16 (pose=(-2.7190775087814703, 0.39514990735025046, -2.051106780368596)): shape (37, 800, 800)
      Valid pixels: 52864/640000 (8.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=59832, max=315641, num_faces=316094
      Valid probs shape: (37, 52864)
    ✓ Random_17 (pose=(-0.8692398195750712, -1.6752131433503663, 2.7993998509816036)): shape (37, 800, 800)
      Valid pixels: 94198/640000 (14.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8, max=315865, num_faces=316094
      Valid probs shape: (37, 94198)
    ✓ Random_18 (pose=(2.8728378860408395, -2.7359491657540396, 3.0433242819772124)): shape (37, 800, 800)
      Valid pixels: 55368/640000 (8.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=315494, num_faces=316094
      Valid probs shape: (37, 55368)
    ✓ Random_19 (pose=(0.863551362948277, 0.20512895653051144, -1.1559318465243948)): shape (37, 800, 800)
      Valid pixels: 66256/640000 (10.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=316093, num_faces=316094
      Valid probs shape: (37, 66256)
    P stats: min=0.0000, max=1.0000, mean=0.0249
    Non-zero vertices: 145497/158049
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 12552  1095  1211  4085     0  2749  1132  5125  6194]
  Ground Truth Stats:
    Labels shape: (158049,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-8/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7556
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8218
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8220

  RESULTS:
  RAW:         median(top-10)=0.8825, mean(top-10)=0.8893, median(all)=0.8108, mean(all)=0.7556
  + SMOOTHING: median(top-10)=0.9220, mean(top-10)=0.9231, median(all)=0.8612, mean(all)=0.8218 [+0.0396]
  + MRF:       median(top-10)=0.9223, mean(top-10)=0.9232, median(all)=0.8613, mean(all)=0.8220 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0399

================================================================================
Subject: NKI-RS-22-9
================================================================================
  Step 0: Generating predictions with V2 model (20 random views)...
  Mesh: 129746 vertices, 259488 faces
  Generating 20 random views...
  Generating predictions for 20 views (continuous camera pose)...
    ✓ Random_0 (pose=(-1.7646720856375906, 1.6047913418490882, -3.059991638252929)): shape (37, 800, 800)
      Valid pixels: 86858/640000 (13.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=259422, num_faces=259488
      Valid probs shape: (37, 86858)
    ✓ Random_1 (pose=(-2.365770049965303, -0.8741550140083914, 1.5600038945206869)): shape (37, 800, 800)
      Valid pixels: 65414/640000 (10.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=674, max=259486, num_faces=259488
      Valid probs shape: (37, 65414)
    ✓ Random_2 (pose=(-2.6676157722316, -0.042153680044945574, 1.393704508385456)): shape (37, 800, 800)
      Valid pixels: 47322/640000 (7.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1237, max=259486, num_faces=259488
      Valid probs shape: (37, 47322)
    ✓ Random_3 (pose=(-0.7701676488571327, -2.5715707796460183, 0.5088188957085564)): shape (37, 800, 800)
      Valid pixels: 61638/640000 (9.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1239, max=259486, num_faces=259488
      Valid probs shape: (37, 61638)
    ✓ Random_4 (pose=(-1.4715627014741923, 2.642067469226344, -2.691652900612824)): shape (37, 800, 800)
      Valid pixels: 82009/640000 (12.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=259418, num_faces=259488
      Valid probs shape: (37, 82009)
    ✓ Random_5 (pose=(1.009654105567476, 2.932374566012105, 1.3963245585134114)): shape (37, 800, 800)
      Valid pixels: 52526/640000 (8.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4643, max=259486, num_faces=259488
      Valid probs shape: (37, 52526)
    ✓ Random_6 (pose=(-3.1055453609629478, 3.074538344411372, 1.561261685120174)): shape (37, 800, 800)
      Valid pixels: 38413/640000 (6.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=258930, num_faces=259488
      Valid probs shape: (37, 38413)
    ✓ Random_7 (pose=(3.0887529395865325, -1.0373110006235668, 2.783490577126198)): shape (37, 800, 800)
      Valid pixels: 61600/640000 (9.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=674, max=259486, num_faces=259488
      Valid probs shape: (37, 61600)
    ✓ Random_8 (pose=(2.4821651194338923, 2.959243416998511, -0.24792321364098546)): shape (37, 800, 800)
      Valid pixels: 68855/640000 (10.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=259417, num_faces=259488
      Valid probs shape: (37, 68855)
    ✓ Random_9 (pose=(0.021144203447879928, -1.761859262662655, 1.4410384075468272)): shape (37, 800, 800)
      Valid pixels: 95397/640000 (14.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=83, max=259426, num_faces=259488
      Valid probs shape: (37, 95397)
    ✓ Random_10 (pose=(-2.948269392775497, 1.504614336636524, -2.653453452342071)): shape (37, 800, 800)
      Valid pixels: 71550/640000 (11.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=259485, num_faces=259488
      Valid probs shape: (37, 71550)
    ✓ Random_11 (pose=(2.0807171132446536, -1.0748076217989793, 0.9527322469224417)): shape (37, 800, 800)
      Valid pixels: 57046/640000 (8.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=231, max=259486, num_faces=259488
      Valid probs shape: (37, 57046)
    ✓ Random_12 (pose=(1.4677082328929512, -2.130170046483485, -2.4927512358204065)): shape (37, 800, 800)
      Valid pixels: 72923/640000 (11.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=73, max=259487, num_faces=259488
      Valid probs shape: (37, 72923)
    ✓ Random_13 (pose=(1.335151517468839, -1.264689833288867, -2.8186116573409206)): shape (37, 800, 800)
      Valid pixels: 84910/640000 (13.3%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=1, max=259486, num_faces=259488
      Valid probs shape: (37, 84910)
    ✓ Random_14 (pose=(0.3993081975826125, -1.1075411433243332, -1.7629008508127721)): shape (37, 800, 800)
      Valid pixels: 75083/640000 (11.7%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=10, max=259484, num_faces=259488
      Valid probs shape: (37, 75083)
    ✓ Random_15 (pose=(-2.7008434893447193, -1.9716274036980062, -2.7230726394969467)): shape (37, 800, 800)
      Valid pixels: 89232/640000 (13.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=259432, num_faces=259488
      Valid probs shape: (37, 89232)
    ✓ Random_16 (pose=(-0.7398099102614841, -1.9497040734447901, 2.5545530658702678)): shape (37, 800, 800)
      Valid pixels: 86028/640000 (13.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=259423, num_faces=259488
      Valid probs shape: (37, 86028)
    ✓ Random_17 (pose=(2.8378321723954905, -0.39055720230393653, 3.065990001056683)): shape (37, 800, 800)
      Valid pixels: 54893/640000 (8.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1234, max=259486, num_faces=259488
      Valid probs shape: (37, 54893)
    ✓ Random_18 (pose=(1.378179323589066, -2.309328148052544, 1.356741083804982)): shape (37, 800, 800)
      Valid pixels: 61214/640000 (9.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=259484, num_faces=259488
      Valid probs shape: (37, 61214)
    ✓ Random_19 (pose=(3.0978820330526506, 2.1909205395556475, 0.4570656502266206)): shape (37, 800, 800)
      Valid pixels: 69147/640000 (10.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=259426, num_faces=259488
      Valid probs shape: (37, 69147)
    P stats: min=0.0000, max=1.0000, mean=0.0238
    Non-zero vertices: 114268/129746
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 35]
    Pred label counts: [    0 15478  1339   872  2749     0  2058  1004  4473  5346]
  Ground Truth Stats:
    Labels shape: (129746,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-9/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7450
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=33
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8136
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=33
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8138

  RESULTS:
  RAW:         median(top-10)=0.8953, mean(top-10)=0.8949, median(all)=0.8007, mean(all)=0.7450
  + SMOOTHING: median(top-10)=0.9296, mean(top-10)=0.9319, median(all)=0.8611, mean(all)=0.8136 [+0.0343]
  + MRF:       median(top-10)=0.9298, mean(top-10)=0.9322, median(all)=0.8609, mean(all)=0.8138 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0345

================================================================================
Subject: NKI-TRT-20-1
================================================================================
  Step 0: Generating predictions with V2 model (20 random views)...
  Mesh: 143932 vertices, 287860 faces
  Generating 20 random views...
  Generating predictions for 20 views (continuous camera pose)...
    ✓ Random_0 (pose=(-0.5235726087554502, -0.8451136214862545, 0.8834578164222968)): shape (37, 800, 800)
      Valid pixels: 73775/640000 (11.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=287849, num_faces=287860
      Valid probs shape: (37, 73775)
    ✓ Random_1 (pose=(2.5106707464776656, 0.11256169629437629, -2.789057240814505)): shape (37, 800, 800)
      Valid pixels: 100418/640000 (15.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=10668, max=287858, num_faces=287860
      Valid probs shape: (37, 100418)
    ✓ Random_2 (pose=(1.4690398338383828, -2.9560247891695433, -1.913914595757368)): shape (37, 800, 800)
      Valid pixels: 91361/640000 (14.3%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=216, max=287858, num_faces=287860
      Valid probs shape: (37, 91361)
    ✓ Random_3 (pose=(-2.7846966313286625, -1.0356237148739558, -2.896598176652697)): shape (37, 800, 800)
      Valid pixels: 117630/640000 (18.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=479, max=287859, num_faces=287860
      Valid probs shape: (37, 117630)
    ✓ Random_4 (pose=(-2.318490791429598, 2.8521953588676308, 3.0775170469337487)): shape (37, 800, 800)
      Valid pixels: 105495/640000 (16.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=287765, num_faces=287860
      Valid probs shape: (37, 105495)
    ✓ Random_5 (pose=(-3.074379167050158, -0.6724160828637844, 1.645943368633481)): shape (37, 800, 800)
      Valid pixels: 101974/640000 (15.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=10716, max=287858, num_faces=287860
      Valid probs shape: (37, 101974)
    ✓ Random_6 (pose=(1.0210484999804477, 2.0412534538331855, 2.8892402052160158)): shape (37, 800, 800)
      Valid pixels: 116954/640000 (18.3%)
      Probs stats: min=0.0000, max=0.9995, mean=0.0270
      Face IDs: min=439, max=287857, num_faces=287860
      Valid probs shape: (37, 116954)
    ✓ Random_7 (pose=(1.6728388245244759, -2.3848297370215232, -2.388273443863998)): shape (37, 800, 800)
      Valid pixels: 97589/640000 (15.2%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=8, max=287858, num_faces=287860
      Valid probs shape: (37, 97589)
    ✓ Random_8 (pose=(-2.782004117101222, -3.0796532107198153, 0.2093294184745922)): shape (37, 800, 800)
      Valid pixels: 85609/640000 (13.4%)
      Probs stats: min=0.0000, max=0.9994, mean=0.0270
      Face IDs: min=1, max=286860, num_faces=287860
      Valid probs shape: (37, 85609)
    ✓ Random_9 (pose=(0.3769984559589856, 0.2035555994305307, -0.08149482203839531)): shape (37, 800, 800)
      Valid pixels: 82203/640000 (12.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=287141, num_faces=287860
      Valid probs shape: (37, 82203)
    ✓ Random_10 (pose=(-2.073748417011796, 0.4730286907332948, 0.0788547845878167)): shape (37, 800, 800)
      Valid pixels: 112578/640000 (17.6%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=2702, max=287859, num_faces=287860
      Valid probs shape: (37, 112578)
    ✓ Random_11 (pose=(-1.5387097378467571, -0.0658135704445173, 1.8196360121339756)): shape (37, 800, 800)
      Valid pixels: 91088/640000 (14.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=232, max=287858, num_faces=287860
      Valid probs shape: (37, 91088)
    ✓ Random_12 (pose=(2.8651128662153935, -1.3981141594377509, 1.2531016545697593)): shape (37, 800, 800)
      Valid pixels: 125468/640000 (19.6%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=74, max=287855, num_faces=287860
      Valid probs shape: (37, 125468)
    ✓ Random_13 (pose=(-0.3445718668295643, 2.870342567736518, 2.430468955905231)): shape (37, 800, 800)
      Valid pixels: 77319/640000 (12.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1569, max=287857, num_faces=287860
      Valid probs shape: (37, 77319)
    ✓ Random_14 (pose=(-2.756605426707865, -1.3722541096543963, -1.5266997317534041)): shape (37, 800, 800)
      Valid pixels: 120286/640000 (18.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=287849, num_faces=287860
      Valid probs shape: (37, 120286)
    ✓ Random_15 (pose=(1.7257866541115625, 1.166062373683368, 1.610819554171111)): shape (37, 800, 800)
      Valid pixels: 81821/640000 (12.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=4, max=287852, num_faces=287860
      Valid probs shape: (37, 81821)
    ✓ Random_16 (pose=(-1.3583176101061996, 1.2140987207364953, -1.187370464216692)): shape (37, 800, 800)
      Valid pixels: 87523/640000 (13.7%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=14, max=287851, num_faces=287860
      Valid probs shape: (37, 87523)
    ✓ Random_17 (pose=(-2.3029507408861507, 0.5573236154179648, 1.8258540205689249)): shape (37, 800, 800)
      Valid pixels: 116417/640000 (18.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=543, max=287859, num_faces=287860
      Valid probs shape: (37, 116417)
    ✓ Random_18 (pose=(-1.7178314447992071, -1.4628612297200414, -0.8020307055018505)): shape (37, 800, 800)
      Valid pixels: 114807/640000 (17.9%)
      Probs stats: min=0.0000, max=0.9994, mean=0.0270
      Face IDs: min=24, max=287855, num_faces=287860
      Valid probs shape: (37, 114807)
    ✓ Random_19 (pose=(-0.19325881113058418, 1.032969046906798, 2.1325378542965305)): shape (37, 800, 800)
      Valid pixels: 91711/640000 (14.3%)
      Probs stats: min=0.0000, max=0.9995, mean=0.0270
      Face IDs: min=7, max=287859, num_faces=287860
      Valid probs shape: (37, 91711)
    P stats: min=0.0000, max=0.9998, mean=0.0243
    Non-zero vertices: 129197/143932
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 14735  1200   923  3288     0  1603   948  4437  7456]
  Ground Truth Stats:
    Labels shape: (143932,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-1/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7270
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7896
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7899

  RESULTS:
  RAW:         median(top-10)=0.8609, mean(top-10)=0.8666, median(all)=0.7899, mean(all)=0.7270
  + SMOOTHING: median(top-10)=0.9078, mean(top-10)=0.9133, median(all)=0.8526, mean(all)=0.7896 [+0.0468]
  + MRF:       median(top-10)=0.9081, mean(top-10)=0.9139, median(all)=0.8535, mean(all)=0.7899 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0471

================================================================================
Subject: NKI-TRT-20-10
================================================================================
  Step 0: Generating predictions with V2 model (20 random views)...
  Mesh: 122978 vertices, 245952 faces
  Generating 20 random views...
  Generating predictions for 20 views (continuous camera pose)...
    ✓ Random_0 (pose=(0.4496264479207408, 0.4276498254845489, 0.5702036443114844)): shape (37, 800, 800)
      Valid pixels: 45936/640000 (7.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=244763, num_faces=245952
      Valid probs shape: (37, 45936)
    ✓ Random_1 (pose=(-2.4863378485341396, -1.8867274873395168, -1.9011076181282323)): shape (37, 800, 800)
      Valid pixels: 76629/640000 (12.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=11, max=245944, num_faces=245952
      Valid probs shape: (37, 76629)
    ✓ Random_2 (pose=(1.7599087074223672, -0.05438886661461817, -1.761149757960141)): shape (37, 800, 800)
      Valid pixels: 57947/640000 (9.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=65, max=245951, num_faces=245952
      Valid probs shape: (37, 57947)
    ✓ Random_3 (pose=(1.5018231353512705, -0.9518287832326862, -2.311587846033128)): shape (37, 800, 800)
      Valid pixels: 65249/640000 (10.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=73, max=245903, num_faces=245952
      Valid probs shape: (37, 65249)
    ✓ Random_4 (pose=(-1.728516780033788, -2.7478317892280466, 1.6580478004697285)): shape (37, 800, 800)
      Valid pixels: 55942/640000 (8.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8, max=245951, num_faces=245952
      Valid probs shape: (37, 55942)
    ✓ Random_5 (pose=(-0.3146791398697282, -2.898283903918766, -2.501586924492651)): shape (37, 800, 800)
      Valid pixels: 38889/640000 (6.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=215, max=245950, num_faces=245952
      Valid probs shape: (37, 38889)
    ✓ Random_6 (pose=(3.047778668929305, 0.06183495084633561, -2.924185382325405)): shape (37, 800, 800)
      Valid pixels: 39151/640000 (6.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=57436, max=245951, num_faces=245952
      Valid probs shape: (37, 39151)
    ✓ Random_7 (pose=(2.9656829252483172, -0.5526844786184166, 2.904572454934555)): shape (37, 800, 800)
      Valid pixels: 51287/640000 (8.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4672, max=245950, num_faces=245952
      Valid probs shape: (37, 51287)
    ✓ Random_8 (pose=(2.9641196682019944, -1.2102052563632753, 1.1188497600818526)): shape (37, 800, 800)
      Valid pixels: 77997/640000 (12.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=14, max=245871, num_faces=245952
      Valid probs shape: (37, 77997)
    ✓ Random_9 (pose=(0.21291131786609485, -2.443902735061253, -2.8555488784130074)): shape (37, 800, 800)
      Valid pixels: 60075/640000 (9.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=14856, max=245951, num_faces=245952
      Valid probs shape: (37, 60075)
    ✓ Random_10 (pose=(-0.5065652807677998, 0.5572838077930924, 2.2987439293087597)): shape (37, 800, 800)
      Valid pixels: 44644/640000 (7.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=245899, num_faces=245952
      Valid probs shape: (37, 44644)
    ✓ Random_11 (pose=(1.7227472893947162, 0.5396641382632215, 1.9609320716101282)): shape (37, 800, 800)
      Valid pixels: 64292/640000 (10.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=245950, num_faces=245952
      Valid probs shape: (37, 64292)
    ✓ Random_12 (pose=(-1.962516680270553, -1.2449887754771345, 0.3959278388394023)): shape (37, 800, 800)
      Valid pixels: 80510/640000 (12.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=69, max=245885, num_faces=245952
      Valid probs shape: (37, 80510)
    ✓ Random_13 (pose=(2.534188785343762, 2.637676228022266, -2.003855714159722)): shape (37, 800, 800)
      Valid pixels: 56112/640000 (8.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=0, max=245545, num_faces=245952
      Valid probs shape: (37, 56112)
    ✓ Random_14 (pose=(-1.8999476069443706, 0.8589202808750418, -2.1838871877432537)): shape (37, 800, 800)
      Valid pixels: 57745/640000 (9.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6, max=245948, num_faces=245952
      Valid probs shape: (37, 57745)
    ✓ Random_15 (pose=(1.8777668452613892, -0.21270094628314773, -0.01727505119662398)): shape (37, 800, 800)
      Valid pixels: 81602/640000 (12.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=245944, num_faces=245952
      Valid probs shape: (37, 81602)
    ✓ Random_16 (pose=(-2.909677025546495, -2.5002014567152604, -2.362755692209385)): shape (37, 800, 800)
      Valid pixels: 59748/640000 (9.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=245940, num_faces=245952
      Valid probs shape: (37, 59748)
    ✓ Random_17 (pose=(-2.193895569285029, -2.5385868675833656, 1.8742272785289895)): shape (37, 800, 800)
      Valid pixels: 50452/640000 (7.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=245899, num_faces=245952
      Valid probs shape: (37, 50452)
    ✓ Random_18 (pose=(-2.9680744341762075, -0.24631724120841447, -2.5132391246438557)): shape (37, 800, 800)
      Valid pixels: 42409/640000 (6.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=49, max=245950, num_faces=245952
      Valid probs shape: (37, 42409)
    ✓ Random_19 (pose=(-1.9181335129452635, -0.43565918231042033, 1.4546516704482961)): shape (37, 800, 800)
      Valid pixels: 58317/640000 (9.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1929, max=245950, num_faces=245952
      Valid probs shape: (37, 58317)
    P stats: min=0.0000, max=1.0000, mean=0.0246
    Non-zero vertices: 111932/122978
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 11046  1342   819  2687     0  2290  1023  3864  5567]
  Ground Truth Stats:
    Labels shape: (122978,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-10/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7612
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8206
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8210

  RESULTS:
  RAW:         median(top-10)=0.8897, mean(top-10)=0.8976, median(all)=0.8062, mean(all)=0.7612
  + SMOOTHING: median(top-10)=0.9190, mean(top-10)=0.9228, median(all)=0.8698, mean(all)=0.8206 [+0.0294]
  + MRF:       median(top-10)=0.9195, mean(top-10)=0.9231, median(all)=0.8703, mean(all)=0.8210 [+0.0005]
  TOTAL IMPROVEMENT (median top-10): +0.0298

================================================================================
Subject: NKI-TRT-20-11
================================================================================
  Step 0: Generating predictions with V2 model (20 random views)...
  Mesh: 146103 vertices, 292202 faces
  Generating 20 random views...
  Generating predictions for 20 views (continuous camera pose)...
    ✓ Random_0 (pose=(0.44104795889434056, -0.5503753686749859, 2.8087849287661752)): shape (37, 800, 800)
      Valid pixels: 81966/640000 (12.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=291056, num_faces=292202
      Valid probs shape: (37, 81966)
    ✓ Random_1 (pose=(1.408335117345601, 0.9446547970407817, 2.5613472235915786)): shape (37, 800, 800)
      Valid pixels: 111973/640000 (17.5%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=3, max=292197, num_faces=292202
      Valid probs shape: (37, 111973)
    ✓ Random_2 (pose=(2.0564460644798563, -0.8087041956490841, -1.6419012776852138)): shape (37, 800, 800)
      Valid pixels: 89154/640000 (13.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=65, max=292201, num_faces=292202
      Valid probs shape: (37, 89154)
    ✓ Random_3 (pose=(1.4360347507321318, 0.5630145107081392, -1.0628336237333005)): shape (37, 800, 800)
      Valid pixels: 97442/640000 (15.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=13, max=292131, num_faces=292202
      Valid probs shape: (37, 97442)
    ✓ Random_4 (pose=(-0.20082426319581126, -1.8542483761519775, -1.63831243210623)): shape (37, 800, 800)
      Valid pixels: 106395/640000 (16.6%)
      Probs stats: min=0.0000, max=0.9995, mean=0.0270
      Face IDs: min=104, max=292198, num_faces=292202
      Valid probs shape: (37, 106395)
    ✓ Random_5 (pose=(0.648298424738281, 0.17422051019003293, -0.7561950167725326)): shape (37, 800, 800)
      Valid pixels: 69239/640000 (10.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=292004, num_faces=292202
      Valid probs shape: (37, 69239)
    ✓ Random_6 (pose=(-1.2308093052676596, 0.38397509360655935, -0.11891674958934262)): shape (37, 800, 800)
      Valid pixels: 109796/640000 (17.2%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=7, max=292185, num_faces=292202
      Valid probs shape: (37, 109796)
    ✓ Random_7 (pose=(2.2505720911159504, 2.234806828096356, 2.4159943747819046)): shape (37, 800, 800)
      Valid pixels: 87150/640000 (13.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=2, max=290659, num_faces=292202
      Valid probs shape: (37, 87150)
    ✓ Random_8 (pose=(-0.45038217057285923, -2.8822310730189127, 0.38989706611147223)): shape (37, 800, 800)
      Valid pixels: 72297/640000 (11.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=8553, max=292201, num_faces=292202
      Valid probs shape: (37, 72297)
    ✓ Random_9 (pose=(1.6561075557752893, -0.7004644979701036, -2.9746516712142985)): shape (37, 800, 800)
      Valid pixels: 99133/640000 (15.5%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=15, max=292198, num_faces=292202
      Valid probs shape: (37, 99133)
    ✓ Random_10 (pose=(-2.9684209091553644, 0.832504741558493, 3.0157624345200063)): shape (37, 800, 800)
      Valid pixels: 62646/640000 (9.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3008, max=292192, num_faces=292202
      Valid probs shape: (37, 62646)
    ✓ Random_11 (pose=(-2.0757878229850624, 2.048442583284369, 0.42843480459602556)): shape (37, 800, 800)
      Valid pixels: 78911/640000 (12.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=19, max=292138, num_faces=292202
      Valid probs shape: (37, 78911)
    ✓ Random_12 (pose=(0.11693551662258361, 0.06736195356186236, -1.5335130593981297)): shape (37, 800, 800)
      Valid pixels: 50821/640000 (7.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=289522, num_faces=292202
      Valid probs shape: (37, 50821)
    ✓ Random_13 (pose=(1.5296128893220802, -0.8673486283438576, 1.6436054545123495)): shape (37, 800, 800)
      Valid pixels: 73076/640000 (11.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8, max=292001, num_faces=292202
      Valid probs shape: (37, 73076)
    ✓ Random_14 (pose=(2.574381473620754, 0.827458172251271, 1.1026641188877067)): shape (37, 800, 800)
      Valid pixels: 98124/640000 (15.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=135, max=292201, num_faces=292202
      Valid probs shape: (37, 98124)
    ✓ Random_15 (pose=(0.7858644401021331, -1.7228800803029964, -2.6716479340005246)): shape (37, 800, 800)
      Valid pixels: 109839/640000 (17.2%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=31, max=292198, num_faces=292202
      Valid probs shape: (37, 109839)
    ✓ Random_16 (pose=(-2.5510841894600063, 1.9408017622516605, 2.4559046838240377)): shape (37, 800, 800)
      Valid pixels: 99010/640000 (15.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6, max=292004, num_faces=292202
      Valid probs shape: (37, 99010)
    ✓ Random_17 (pose=(0.0033889951086689685, -2.009477054620855, -2.085465274412231)): shape (37, 800, 800)
      Valid pixels: 100719/640000 (15.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1268, max=292193, num_faces=292202
      Valid probs shape: (37, 100719)
    ✓ Random_18 (pose=(-2.035873249910998, 1.5886787024067104, -1.6447193429361582)): shape (37, 800, 800)
      Valid pixels: 92716/640000 (14.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=8, max=291276, num_faces=292202
      Valid probs shape: (37, 92716)
    ✓ Random_19 (pose=(0.8786409517314251, -2.3494599688458466, 2.164892842519504)): shape (37, 800, 800)
      Valid pixels: 64995/640000 (10.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=16933, max=292196, num_faces=292202
      Valid probs shape: (37, 64995)
    P stats: min=0.0000, max=1.0000, mean=0.0249
    Non-zero vertices: 134781/146103
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 11322   694   900  3725     0  2618  1088  4136  5076]
  Ground Truth Stats:
    Labels shape: (146103,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-11/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7336
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7881
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7885

  RESULTS:
  RAW:         median(top-10)=0.9069, mean(top-10)=0.9009, median(all)=0.7642, mean(all)=0.7336
  + SMOOTHING: median(top-10)=0.9230, mean(top-10)=0.9239, median(all)=0.8276, mean(all)=0.7881 [+0.0161]
  + MRF:       median(top-10)=0.9231, mean(top-10)=0.9241, median(all)=0.8287, mean(all)=0.7885 [+0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0162

================================================================================
Subject: NKI-TRT-20-12
================================================================================
  Step 0: Generating predictions with V2 model (20 random views)...
  Mesh: 117868 vertices, 235732 faces
  Generating 20 random views...
  Generating predictions for 20 views (continuous camera pose)...
    ✓ Random_0 (pose=(3.0754079043984808, -1.0006086752227143, -0.37215619588814697)): shape (37, 800, 800)
      Valid pixels: 71904/640000 (11.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=56, max=235731, num_faces=235732
      Valid probs shape: (37, 71904)
    ✓ Random_1 (pose=(-2.48515965897674, 2.918951932885747, -0.593689013331165)): shape (37, 800, 800)
      Valid pixels: 82639/640000 (12.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=0, max=235591, num_faces=235732
      Valid probs shape: (37, 82639)
    ✓ Random_2 (pose=(-1.268716166478161, -0.009254416739170157, -2.057695164670385)): shape (37, 800, 800)
      Valid pixels: 74173/640000 (11.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=235591, num_faces=235732
      Valid probs shape: (37, 74173)
    ✓ Random_3 (pose=(0.9889048456260179, -0.9880185553456133, 1.2454740366020474)): shape (37, 800, 800)
      Valid pixels: 82002/640000 (12.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=235571, num_faces=235732
      Valid probs shape: (37, 82002)
    ✓ Random_4 (pose=(0.41951128526901327, -0.8595391185427901, -2.1591013144840874)): shape (37, 800, 800)
      Valid pixels: 90428/640000 (14.1%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=1, max=235567, num_faces=235732
      Valid probs shape: (37, 90428)
    ✓ Random_5 (pose=(1.4587127528618753, 1.0051288095895092, -1.3372801010480189)): shape (37, 800, 800)
      Valid pixels: 87648/640000 (13.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=235731, num_faces=235732
      Valid probs shape: (37, 87648)
    ✓ Random_6 (pose=(0.810833160929687, 3.1383647511178596, -1.977184380945007)): shape (37, 800, 800)
      Valid pixels: 70743/640000 (11.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=479, max=235731, num_faces=235732
      Valid probs shape: (37, 70743)
    ✓ Random_7 (pose=(-2.5943042991644374, 2.633952648480185, -0.9920476532979099)): shape (37, 800, 800)
      Valid pixels: 84774/640000 (13.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=0, max=235591, num_faces=235732
      Valid probs shape: (37, 84774)
    ✓ Random_8 (pose=(-0.3005171153595003, -0.7839898748529972, 1.7290074455151432)): shape (37, 800, 800)
      Valid pixels: 88385/640000 (13.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=235536, num_faces=235732
      Valid probs shape: (37, 88385)
    ✓ Random_9 (pose=(1.4343385733153715, -1.5507043224113166, 1.1670872152563332)): shape (37, 800, 800)
      Valid pixels: 77586/640000 (12.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=22, max=235591, num_faces=235732
      Valid probs shape: (37, 77586)
    ✓ Random_10 (pose=(2.7349937164501146, 0.42404803406695013, 1.1229648918380315)): shape (37, 800, 800)
      Valid pixels: 70733/640000 (11.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=61, max=235730, num_faces=235732
      Valid probs shape: (37, 70733)
    ✓ Random_11 (pose=(1.5496892145500372, 2.1266362061673663, 1.7328489126750393)): shape (37, 800, 800)
      Valid pixels: 77430/640000 (12.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=235592, num_faces=235732
      Valid probs shape: (37, 77430)
    ✓ Random_12 (pose=(-1.8042705791535474, -0.7328472825870458, -0.6887149782317827)): shape (37, 800, 800)
      Valid pixels: 101329/640000 (15.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=57, max=235731, num_faces=235732
      Valid probs shape: (37, 101329)
    ✓ Random_13 (pose=(-2.730487321009064, -2.419941493797422, -2.4424618820244732)): shape (37, 800, 800)
      Valid pixels: 87235/640000 (13.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=235535, num_faces=235732
      Valid probs shape: (37, 87235)
    ✓ Random_14 (pose=(-2.94187433856966, -0.5764514917411541, -1.548979520041111)): shape (37, 800, 800)
      Valid pixels: 71986/640000 (11.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=68, max=235730, num_faces=235732
      Valid probs shape: (37, 71986)
    ✓ Random_15 (pose=(0.4117080129331945, -0.013074575301440294, -1.956027933240451)): shape (37, 800, 800)
      Valid pixels: 59458/640000 (9.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=235531, num_faces=235732
      Valid probs shape: (37, 59458)
    ✓ Random_16 (pose=(-1.90809433235511, 1.480387341831011, -0.11583174284258657)): shape (37, 800, 800)
      Valid pixels: 94975/640000 (14.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=235731, num_faces=235732
      Valid probs shape: (37, 94975)
    ✓ Random_17 (pose=(1.8624948008735878, -0.47503928599025524, 2.953581788128825)): shape (37, 800, 800)
      Valid pixels: 102264/640000 (16.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=215, max=235731, num_faces=235732
      Valid probs shape: (37, 102264)
    ✓ Random_18 (pose=(1.3604450445409162, 2.7785017966953403, -0.4903624460950642)): shape (37, 800, 800)
      Valid pixels: 113791/640000 (17.8%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=5, max=235687, num_faces=235732
      Valid probs shape: (37, 113791)
    ✓ Random_19 (pose=(-2.2543070539764973, 0.7726425845044651, -2.683964693451829)): shape (37, 800, 800)
      Valid pixels: 76082/640000 (11.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=25, max=235719, num_faces=235732
      Valid probs shape: (37, 76082)
    P stats: min=0.0000, max=0.9998, mean=0.0245
    Non-zero vertices: 106668/117868
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 11200  1101   849  3335     0  2440   847  3334  5297]
  Ground Truth Stats:
    Labels shape: (117868,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-12/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
    MRF iteration 5/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7445
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8079
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8082

  RESULTS:
  RAW:         median(top-10)=0.8752, mean(top-10)=0.8821, median(all)=0.7796, mean(all)=0.7445
  + SMOOTHING: median(top-10)=0.8907, mean(top-10)=0.9092, median(all)=0.8476, mean(all)=0.8079 [+0.0155]
  + MRF:       median(top-10)=0.8906, mean(top-10)=0.9095, median(all)=0.8481, mean(all)=0.8082 [-0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0154

================================================================================
Subject: NKI-TRT-20-13
================================================================================
  Step 0: Generating predictions with V2 model (20 random views)...
  Mesh: 168760 vertices, 337516 faces
  Generating 20 random views...
  Generating predictions for 20 views (continuous camera pose)...
    ✓ Random_0 (pose=(0.03559908812982604, -0.08118810619918904, -2.4451997526101503)): shape (37, 800, 800)
      Valid pixels: 48497/640000 (7.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=335762, num_faces=337516
      Valid probs shape: (37, 48497)
    ✓ Random_1 (pose=(1.7462846851492708, 2.1438901088996074, -1.4184553360738856)): shape (37, 800, 800)
      Valid pixels: 66487/640000 (10.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=337513, num_faces=337516
      Valid probs shape: (37, 66487)
    ✓ Random_2 (pose=(2.806052214511011, -2.9761455250417543, 2.5215897398844414)): shape (37, 800, 800)
      Valid pixels: 62670/640000 (9.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=336867, num_faces=337516
      Valid probs shape: (37, 62670)
    ✓ Random_3 (pose=(0.45317631677609693, 0.9866017660424946, 2.845363361012563)): shape (37, 800, 800)
      Valid pixels: 71672/640000 (11.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=9, max=337512, num_faces=337516
      Valid probs shape: (37, 71672)
    ✓ Random_4 (pose=(-1.5307160152224255, -0.2859422665378242, 0.3461324964245285)): shape (37, 800, 800)
      Valid pixels: 88509/640000 (13.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=3, max=337509, num_faces=337516
      Valid probs shape: (37, 88509)
    ✓ Random_5 (pose=(2.212576485911561, -0.6225832642260136, -1.4936644613178371)): shape (37, 800, 800)
      Valid pixels: 81507/640000 (12.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=178, max=337513, num_faces=337516
      Valid probs shape: (37, 81507)
    ✓ Random_6 (pose=(0.06717785368390672, -2.0373805462641825, 2.112394351541867)): shape (37, 800, 800)
      Valid pixels: 82045/640000 (12.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=107, max=337515, num_faces=337516
      Valid probs shape: (37, 82045)
    ✓ Random_7 (pose=(-1.0849616162828526, 0.18577579678509837, -0.6999275571104362)): shape (37, 800, 800)
      Valid pixels: 89954/640000 (14.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=337424, num_faces=337516
      Valid probs shape: (37, 89954)
    ✓ Random_8 (pose=(-2.35729065928575, 2.79171808182436, -0.08501141633285014)): shape (37, 800, 800)
      Valid pixels: 78050/640000 (12.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=337508, num_faces=337516
      Valid probs shape: (37, 78050)
    ✓ Random_9 (pose=(1.7263125490767166, -1.5487308798855945, -1.3651636726112253)): shape (37, 800, 800)
      Valid pixels: 79097/640000 (12.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7, max=337513, num_faces=337516
      Valid probs shape: (37, 79097)
    ✓ Random_10 (pose=(1.1835993778065115, 3.0615858179269253, -0.33414785520395807)): shape (37, 800, 800)
      Valid pixels: 103152/640000 (16.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=179, max=337515, num_faces=337516
      Valid probs shape: (37, 103152)
    ✓ Random_11 (pose=(-1.6119173624156258, -1.7962598800613068, 2.6975014765818264)): shape (37, 800, 800)
      Valid pixels: 104915/640000 (16.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=48, max=337514, num_faces=337516
      Valid probs shape: (37, 104915)
    ✓ Random_12 (pose=(0.1448446556486087, -2.7500923707010174, 0.6787942529056541)): shape (37, 800, 800)
      Valid pixels: 60775/640000 (9.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1679, max=337514, num_faces=337516
      Valid probs shape: (37, 60775)
    ✓ Random_13 (pose=(-1.38881557170235, -2.676578735472449, -1.9464190931643466)): shape (37, 800, 800)
      Valid pixels: 67275/640000 (10.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=14, max=337515, num_faces=337516
      Valid probs shape: (37, 67275)
    ✓ Random_14 (pose=(1.8354796435059946, -0.565056684085445, 3.028349953134404)): shape (37, 800, 800)
      Valid pixels: 96814/640000 (15.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=28, max=337508, num_faces=337516
      Valid probs shape: (37, 96814)
    ✓ Random_15 (pose=(-2.384674802303739, -0.044047693655092424, 0.9948511410034833)): shape (37, 800, 800)
      Valid pixels: 68354/640000 (10.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6131, max=337512, num_faces=337516
      Valid probs shape: (37, 68354)
    ✓ Random_16 (pose=(-0.47311373267391543, 3.0161883050607834, 2.9859471947780234)): shape (37, 800, 800)
      Valid pixels: 66787/640000 (10.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1637, max=337515, num_faces=337516
      Valid probs shape: (37, 66787)
    ✓ Random_17 (pose=(-2.6943930538621337, 1.0417968128164716, 0.9677933956783509)): shape (37, 800, 800)
      Valid pixels: 81722/640000 (12.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=179, max=337514, num_faces=337516
      Valid probs shape: (37, 81722)
    ✓ Random_18 (pose=(2.0432710798648674, -2.0851063187536756, 0.9862933078119323)): shape (37, 800, 800)
      Valid pixels: 64207/640000 (10.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=337513, num_faces=337516
      Valid probs shape: (37, 64207)
    ✓ Random_19 (pose=(0.3864595211093853, -1.9399111907171602, 2.0840770731048295)): shape (37, 800, 800)
      Valid pixels: 74598/640000 (11.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=89, max=337515, num_faces=337516
      Valid probs shape: (37, 74598)
    P stats: min=0.0000, max=1.0000, mean=0.0237
    Non-zero vertices: 148281/168760
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 20479  1436  1731  3528     0  2527  1330  5470  7857]
  Ground Truth Stats:
    Labels shape: (168760,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-13/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7381
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8111
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8115

  RESULTS:
  RAW:         median(top-10)=0.8535, mean(top-10)=0.8650, median(all)=0.7935, mean(all)=0.7381
  + SMOOTHING: median(top-10)=0.9187, mean(top-10)=0.9154, median(all)=0.8447, mean(all)=0.8111 [+0.0651]
  + MRF:       median(top-10)=0.9191, mean(top-10)=0.9158, median(all)=0.8456, mean(all)=0.8115 [+0.0005]
  TOTAL IMPROVEMENT (median top-10): +0.0656

================================================================================
Subject: NKI-TRT-20-14
================================================================================
  Step 0: Generating predictions with V2 model (20 random views)...
  Mesh: 142909 vertices, 285814 faces
  Generating 20 random views...
  Generating predictions for 20 views (continuous camera pose)...
    ✓ Random_0 (pose=(-3.128723756741521, 2.5490010651878565, -2.860836365427131)): shape (37, 800, 800)
      Valid pixels: 47165/640000 (7.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=284866, num_faces=285814
      Valid probs shape: (37, 47165)
    ✓ Random_1 (pose=(-2.88574574736134, 2.6619804442063595, -0.6242037817009196)): shape (37, 800, 800)
      Valid pixels: 53717/640000 (8.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=285297, num_faces=285814
      Valid probs shape: (37, 53717)
    ✓ Random_2 (pose=(1.4440904831284067, 2.929496025165947, -0.7646674505269764)): shape (37, 800, 800)
      Valid pixels: 86845/640000 (13.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7, max=285813, num_faces=285814
      Valid probs shape: (37, 86845)
    ✓ Random_3 (pose=(-0.8269796412969463, 0.13569521607263946, 2.137284620987492)): shape (37, 800, 800)
      Valid pixels: 59999/640000 (9.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=285753, num_faces=285814
      Valid probs shape: (37, 59999)
    ✓ Random_4 (pose=(0.6914533127772646, 0.29064534410001563, 0.6931508267002462)): shape (37, 800, 800)
      Valid pixels: 50481/640000 (7.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=285813, num_faces=285814
      Valid probs shape: (37, 50481)
    ✓ Random_5 (pose=(-1.678471044038893, -3.0437273687128767, -2.118512136984847)): shape (37, 800, 800)
      Valid pixels: 65064/640000 (10.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=285813, num_faces=285814
      Valid probs shape: (37, 65064)
    ✓ Random_6 (pose=(0.5122292011503453, -2.1647880234648533, -1.5247819181470905)): shape (37, 800, 800)
      Valid pixels: 66948/640000 (10.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1361, max=285811, num_faces=285814
      Valid probs shape: (37, 66948)
    ✓ Random_7 (pose=(1.0332592557798899, -0.852475227713207, -1.0725252781330186)): shape (37, 800, 800)
      Valid pixels: 59367/640000 (9.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=9, max=285813, num_faces=285814
      Valid probs shape: (37, 59367)
    ✓ Random_8 (pose=(0.21796859620488007, -2.572926835189871, -1.5811868877564632)): shape (37, 800, 800)
      Valid pixels: 60929/640000 (9.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=14177, max=285812, num_faces=285814
      Valid probs shape: (37, 60929)
    ✓ Random_9 (pose=(-1.4594935001084146, 2.481142527918802, 0.07574073571409601)): shape (37, 800, 800)
      Valid pixels: 82587/640000 (12.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=11, max=285813, num_faces=285814
      Valid probs shape: (37, 82587)
    ✓ Random_10 (pose=(-0.8011144527088945, -2.7000762133628022, -1.3334128340080358)): shape (37, 800, 800)
      Valid pixels: 71016/640000 (11.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=11548, max=285809, num_faces=285814
      Valid probs shape: (37, 71016)
    ✓ Random_11 (pose=(0.3555502781740527, 1.780850182390175, -0.920489464029481)): shape (37, 800, 800)
      Valid pixels: 81290/640000 (12.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7, max=285812, num_faces=285814
      Valid probs shape: (37, 81290)
    ✓ Random_12 (pose=(2.3906839462381493, -2.913237928978051, -2.9231679088074953)): shape (37, 800, 800)
      Valid pixels: 60250/640000 (9.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=9, max=285409, num_faces=285814
      Valid probs shape: (37, 60250)
    ✓ Random_13 (pose=(-2.2714434918819437, -0.3198854818360246, 2.2927898839836987)): shape (37, 800, 800)
      Valid pixels: 61558/640000 (9.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=476, max=285813, num_faces=285814
      Valid probs shape: (37, 61558)
    ✓ Random_14 (pose=(-0.9586009270813998, 1.765117715449371, 3.1280368283202327)): shape (37, 800, 800)
      Valid pixels: 89374/640000 (14.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7, max=285812, num_faces=285814
      Valid probs shape: (37, 89374)
    ✓ Random_15 (pose=(2.1701714732331245, 1.5708837575054542, 2.5163512346219035)): shape (37, 800, 800)
      Valid pixels: 69996/640000 (10.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6, max=285420, num_faces=285814
      Valid probs shape: (37, 69996)
    ✓ Random_16 (pose=(-1.5783479846262602, 2.2468268207471995, 2.7397462547231655)): shape (37, 800, 800)
      Valid pixels: 91662/640000 (14.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6, max=285812, num_faces=285814
      Valid probs shape: (37, 91662)
    ✓ Random_17 (pose=(-2.494659404287646, 0.7608768708757476, -2.531492652532685)): shape (37, 800, 800)
      Valid pixels: 57707/640000 (9.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1621, max=285813, num_faces=285814
      Valid probs shape: (37, 57707)
    ✓ Random_18 (pose=(-1.6446955014518663, -1.8484207420368757, -1.4328630931999415)): shape (37, 800, 800)
      Valid pixels: 57677/640000 (9.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=284740, num_faces=285814
      Valid probs shape: (37, 57677)
    ✓ Random_19 (pose=(1.234498087087637, -1.1080494901232045, 0.449834920642608)): shape (37, 800, 800)
      Valid pixels: 85531/640000 (13.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=285813, num_faces=285814
      Valid probs shape: (37, 85531)
    P stats: min=0.0000, max=1.0000, mean=0.0246
    Non-zero vertices: 130036/142909
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 12873  1217  1245  2677     0  2438  1048  5068  6293]
  Ground Truth Stats:
    Labels shape: (142909,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-14/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7563
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8189
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8189

  RESULTS:
  RAW:         median(top-10)=0.8928, mean(top-10)=0.8967, median(all)=0.8287, mean(all)=0.7563
  + SMOOTHING: median(top-10)=0.9209, mean(top-10)=0.9238, median(all)=0.8858, mean(all)=0.8189 [+0.0281]
  + MRF:       median(top-10)=0.9206, mean(top-10)=0.9239, median(all)=0.8860, mean(all)=0.8189 [-0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0279

================================================================================
Subject: NKI-TRT-20-15
================================================================================
  Step 0: Generating predictions with V2 model (20 random views)...
  Mesh: 133351 vertices, 266698 faces
  Generating 20 random views...
  Generating predictions for 20 views (continuous camera pose)...
    ✓ Random_0 (pose=(-0.8085946952229519, 1.975829081537622, 2.236523003558559)): shape (37, 800, 800)
      Valid pixels: 75277/640000 (11.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1968, max=266664, num_faces=266698
      Valid probs shape: (37, 75277)
    ✓ Random_1 (pose=(2.917897168726891, -1.9185606817186076, -1.776818430523056)): shape (37, 800, 800)
      Valid pixels: 107908/640000 (16.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=13, max=266663, num_faces=266698
      Valid probs shape: (37, 107908)
    ✓ Random_2 (pose=(0.4642844594482294, 3.008665213339362, 1.7286940003911422)): shape (37, 800, 800)
      Valid pixels: 60918/640000 (9.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=47643, max=266697, num_faces=266698
      Valid probs shape: (37, 60918)
    ✓ Random_3 (pose=(3.141369460339919, 2.933373015879069, -0.5729945626415862)): shape (37, 800, 800)
      Valid pixels: 54454/640000 (8.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=0, max=265851, num_faces=266698
      Valid probs shape: (37, 54454)
    ✓ Random_4 (pose=(-2.2920495407661905, -1.006945106071805, -1.074863636153561)): shape (37, 800, 800)
      Valid pixels: 67130/640000 (10.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=191, max=266697, num_faces=266698
      Valid probs shape: (37, 67130)
    ✓ Random_5 (pose=(-2.7265608727778425, -1.078299007098268, 0.1894251989893001)): shape (37, 800, 800)
      Valid pixels: 94992/640000 (14.8%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=966, max=266697, num_faces=266698
      Valid probs shape: (37, 94992)
    ✓ Random_6 (pose=(-0.09294262545097798, -1.680788290012423, -2.8142814307375623)): shape (37, 800, 800)
      Valid pixels: 78073/640000 (12.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=191, max=266697, num_faces=266698
      Valid probs shape: (37, 78073)
    ✓ Random_7 (pose=(1.1565698782449747, 0.830323822019396, -1.058474787780669)): shape (37, 800, 800)
      Valid pixels: 103160/640000 (16.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=266663, num_faces=266698
      Valid probs shape: (37, 103160)
    ✓ Random_8 (pose=(2.4890888901371166, -0.7892400029365456, 3.140559982374665)): shape (37, 800, 800)
      Valid pixels: 84060/640000 (13.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=3161, max=266695, num_faces=266698
      Valid probs shape: (37, 84060)
    ✓ Random_9 (pose=(2.80597642803463, 2.931048009535819, -0.5558278143738833)): shape (37, 800, 800)
      Valid pixels: 51789/640000 (8.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=266659, num_faces=266698
      Valid probs shape: (37, 51789)
    ✓ Random_10 (pose=(0.09916152515831733, -2.50311985779258, 0.5205049453287218)): shape (37, 800, 800)
      Valid pixels: 82362/640000 (12.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1040, max=266694, num_faces=266698
      Valid probs shape: (37, 82362)
    ✓ Random_11 (pose=(-1.5052786275446928, 1.8241061720393352, 0.04175924306689405)): shape (37, 800, 800)
      Valid pixels: 108599/640000 (17.0%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=12, max=266695, num_faces=266698
      Valid probs shape: (37, 108599)
    ✓ Random_12 (pose=(-2.1684022950033826, 0.01839020965552418, -2.381222749348151)): shape (37, 800, 800)
      Valid pixels: 79455/640000 (12.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=94, max=266697, num_faces=266698
      Valid probs shape: (37, 79455)
    ✓ Random_13 (pose=(1.536788708284691, 2.969425751230241, -0.54911729640913)): shape (37, 800, 800)
      Valid pixels: 116463/640000 (18.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=24, max=266663, num_faces=266698
      Valid probs shape: (37, 116463)
    ✓ Random_14 (pose=(-1.630104163438539, 2.5984109588902307, -2.2159174961303716)): shape (37, 800, 800)
      Valid pixels: 83690/640000 (13.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=13, max=266663, num_faces=266698
      Valid probs shape: (37, 83690)
    ✓ Random_15 (pose=(-2.6889876667792088, -2.5598179696003145, 2.6288475943697636)): shape (37, 800, 800)
      Valid pixels: 54774/640000 (8.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=266663, num_faces=266698
      Valid probs shape: (37, 54774)
    ✓ Random_16 (pose=(2.866885280792638, 2.6480587345139552, 0.43040484224143416)): shape (37, 800, 800)
      Valid pixels: 67804/640000 (10.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=266660, num_faces=266698
      Valid probs shape: (37, 67804)
    ✓ Random_17 (pose=(-2.4068173018120556, -0.15929830722705862, -0.358644906925079)): shape (37, 800, 800)
      Valid pixels: 88201/640000 (13.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=18017, max=266697, num_faces=266698
      Valid probs shape: (37, 88201)
    ✓ Random_18 (pose=(-0.39360058843222, -2.086653377197078, 2.5043381234148168)): shape (37, 800, 800)
      Valid pixels: 93935/640000 (14.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=188, max=266697, num_faces=266698
      Valid probs shape: (37, 93935)
    ✓ Random_19 (pose=(1.2817425463492453, -2.364369255798503, -2.577263053209916)): shape (37, 800, 800)
      Valid pixels: 97979/640000 (15.3%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=48, max=266693, num_faces=266698
      Valid probs shape: (37, 97979)
    P stats: min=0.0000, max=1.0000, mean=0.0239
    Non-zero vertices: 117681/133351
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 15670   995  1012  3167     0  1612   721  4648  4658]
  Ground Truth Stats:
    Labels shape: (133351,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-15/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7562
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8183
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8189

  RESULTS:
  RAW:         median(top-10)=0.8995, mean(top-10)=0.9000, median(all)=0.8047, mean(all)=0.7562
  + SMOOTHING: median(top-10)=0.9417, mean(top-10)=0.9306, median(all)=0.8575, mean(all)=0.8183 [+0.0422]
  + MRF:       median(top-10)=0.9424, mean(top-10)=0.9311, median(all)=0.8579, mean(all)=0.8189 [+0.0007]
  TOTAL IMPROVEMENT (median top-10): +0.0429

================================================================================
Subject: NKI-TRT-20-16
================================================================================
  Step 0: Generating predictions with V2 model (20 random views)...
  Mesh: 157852 vertices, 315700 faces
  Generating 20 random views...
  Generating predictions for 20 views (continuous camera pose)...
    ✓ Random_0 (pose=(1.6105966532998819, 1.3218195063178166, -2.606149840692616)): shape (37, 800, 800)
      Valid pixels: 81742/640000 (12.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=15, max=315699, num_faces=315700
      Valid probs shape: (37, 81742)
    ✓ Random_1 (pose=(1.530106557006552, 1.0686248571298709, 0.978666739689217)): shape (37, 800, 800)
      Valid pixels: 73678/640000 (11.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=34, max=315625, num_faces=315700
      Valid probs shape: (37, 73678)
    ✓ Random_2 (pose=(2.204667587416462, 0.7929823222843315, 2.6085848774062903)): shape (37, 800, 800)
      Valid pixels: 81995/640000 (12.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3169, max=315696, num_faces=315700
      Valid probs shape: (37, 81995)
    ✓ Random_3 (pose=(-0.7217832516679934, 1.8795808902699092, 2.902472989200562)): shape (37, 800, 800)
      Valid pixels: 88118/640000 (13.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=22, max=315699, num_faces=315700
      Valid probs shape: (37, 88118)
    ✓ Random_4 (pose=(2.132694837960509, 2.1001681480927683, 1.48513762771859)): shape (37, 800, 800)
      Valid pixels: 73699/640000 (11.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=8, max=315625, num_faces=315700
      Valid probs shape: (37, 73699)
    ✓ Random_5 (pose=(2.5587333821644327, -2.414348097009983, 1.2781110235025173)): shape (37, 800, 800)
      Valid pixels: 76330/640000 (11.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=315557, num_faces=315700
      Valid probs shape: (37, 76330)
    ✓ Random_6 (pose=(0.15548567491638376, -1.27836298284117, -0.9339160869430332)): shape (37, 800, 800)
      Valid pixels: 73326/640000 (11.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=26, max=315699, num_faces=315700
      Valid probs shape: (37, 73326)
    ✓ Random_7 (pose=(-1.7382135417612106, 1.3442652391827128, 0.5041689961654221)): shape (37, 800, 800)
      Valid pixels: 79109/640000 (12.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=10, max=315699, num_faces=315700
      Valid probs shape: (37, 79109)
    ✓ Random_8 (pose=(1.106170011808361, 1.8741357651254766, 0.8039792932747494)): shape (37, 800, 800)
      Valid pixels: 67074/640000 (10.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=30, max=315625, num_faces=315700
      Valid probs shape: (37, 67074)
    ✓ Random_9 (pose=(1.2793651395278358, 0.9725361113461908, 0.8321559088706358)): shape (37, 800, 800)
      Valid pixels: 72253/640000 (11.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=28, max=315625, num_faces=315700
      Valid probs shape: (37, 72253)
    ✓ Random_10 (pose=(2.061166942817021, 3.0754229841096743, -2.320074036834318)): shape (37, 800, 800)
      Valid pixels: 69565/640000 (10.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=26, max=315699, num_faces=315700
      Valid probs shape: (37, 69565)
    ✓ Random_11 (pose=(-3.0294611526126376, -2.7891698891954047, 1.0392986631304373)): shape (37, 800, 800)
      Valid pixels: 61247/640000 (9.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=13, max=314665, num_faces=315700
      Valid probs shape: (37, 61247)
    ✓ Random_12 (pose=(2.1208253403540853, 2.2985753531671973, 2.372494086363348)): shape (37, 800, 800)
      Valid pixels: 78265/640000 (12.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=315557, num_faces=315700
      Valid probs shape: (37, 78265)
    ✓ Random_13 (pose=(1.1508250887232263, -2.534863206492407, -1.632319097323251)): shape (37, 800, 800)
      Valid pixels: 71422/640000 (11.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=24, max=315699, num_faces=315700
      Valid probs shape: (37, 71422)
    ✓ Random_14 (pose=(-1.0217350645929097, -1.9772693321151062, -1.6556052871384193)): shape (37, 800, 800)
      Valid pixels: 80243/640000 (12.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=386, max=315688, num_faces=315700
      Valid probs shape: (37, 80243)
    ✓ Random_15 (pose=(-2.4725703354487836, 1.8222746534673009, -3.0536207001788473)): shape (37, 800, 800)
      Valid pixels: 74513/640000 (11.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=41, max=315625, num_faces=315700
      Valid probs shape: (37, 74513)
    ✓ Random_16 (pose=(-2.0054124640013646, -0.0015615381798856909, 2.289793082064926)): shape (37, 800, 800)
      Valid pixels: 92057/640000 (14.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=29, max=315699, num_faces=315700
      Valid probs shape: (37, 92057)
    ✓ Random_17 (pose=(-0.2746229056197822, 0.14075387875684253, 2.374144747268642)): shape (37, 800, 800)
      Valid pixels: 43903/640000 (6.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=18, max=315414, num_faces=315700
      Valid probs shape: (37, 43903)
    ✓ Random_18 (pose=(-2.0107796827996225, 0.34447604821937317, 2.598562523868625)): shape (37, 800, 800)
      Valid pixels: 99727/640000 (15.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=22, max=315698, num_faces=315700
      Valid probs shape: (37, 99727)
    ✓ Random_19 (pose=(-0.4549818903160938, 0.7357026670765126, 1.0099364663011992)): shape (37, 800, 800)
      Valid pixels: 78106/640000 (12.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=9, max=315686, num_faces=315700
      Valid probs shape: (37, 78106)
    P stats: min=0.0000, max=0.9999, mean=0.0236
    Non-zero vertices: 138060/157852
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 19792  1184  1014  3978     0  2173   884  5530  6705]
  Ground Truth Stats:
    Labels shape: (157852,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-16/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
    MRF iteration 5/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7211
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7826
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7830

  RESULTS:
  RAW:         median(top-10)=0.8681, mean(top-10)=0.8741, median(all)=0.7941, mean(all)=0.7211
  + SMOOTHING: median(top-10)=0.9175, mean(top-10)=0.9197, median(all)=0.8495, mean(all)=0.7826 [+0.0494]
  + MRF:       median(top-10)=0.9176, mean(top-10)=0.9201, median(all)=0.8498, mean(all)=0.7830 [+0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0495

================================================================================
Subject: NKI-TRT-20-17
================================================================================
  Step 0: Generating predictions with V2 model (20 random views)...
  Mesh: 135896 vertices, 271788 faces
  Generating 20 random views...
  Generating predictions for 20 views (continuous camera pose)...
    ✓ Random_0 (pose=(-1.1011188471727946, -1.0848679732670896, -2.1383186370737626)): shape (37, 800, 800)
      Valid pixels: 61338/640000 (9.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=271626, num_faces=271788
      Valid probs shape: (37, 61338)
    ✓ Random_1 (pose=(0.5635697590323137, 0.7099575692149851, 0.17003053630922116)): shape (37, 800, 800)
      Valid pixels: 60721/640000 (9.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=271786, num_faces=271788
      Valid probs shape: (37, 60721)
    ✓ Random_2 (pose=(1.660391964833603, 1.3787074858402022, 2.6800882586453154)): shape (37, 800, 800)
      Valid pixels: 91567/640000 (14.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=271779, num_faces=271788
      Valid probs shape: (37, 91567)
    ✓ Random_3 (pose=(2.0737469034281517, 1.2543962423009685, -1.7443284001911377)): shape (37, 800, 800)
      Valid pixels: 70854/640000 (11.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=183, max=271773, num_faces=271788
      Valid probs shape: (37, 70854)
    ✓ Random_4 (pose=(2.2841210229089777, 2.268781854570549, 1.3785044010943812)): shape (37, 800, 800)
      Valid pixels: 69076/640000 (10.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=271785, num_faces=271788
      Valid probs shape: (37, 69076)
    ✓ Random_5 (pose=(-1.091516363713017, 0.050195699241106784, 2.4515662487701197)): shape (37, 800, 800)
      Valid pixels: 85831/640000 (13.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=271787, num_faces=271788
      Valid probs shape: (37, 85831)
    ✓ Random_6 (pose=(0.8349299668282355, 1.2920760279795855, -1.6390572744124632)): shape (37, 800, 800)
      Valid pixels: 89349/640000 (14.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=271787, num_faces=271788
      Valid probs shape: (37, 89349)
    ✓ Random_7 (pose=(-2.8637351066208474, 0.8780690368379691, 3.0488358678752343)): shape (37, 800, 800)
      Valid pixels: 59329/640000 (9.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1982, max=271785, num_faces=271788
      Valid probs shape: (37, 59329)
    ✓ Random_8 (pose=(0.0745538586034229, -0.3207600565364581, -2.5354184146308425)): shape (37, 800, 800)
      Valid pixels: 47704/640000 (7.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=270545, num_faces=271788
      Valid probs shape: (37, 47704)
    ✓ Random_9 (pose=(0.4705968532488556, 0.2109714108240306, -0.3065432310963887)): shape (37, 800, 800)
      Valid pixels: 58978/640000 (9.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=271583, num_faces=271788
      Valid probs shape: (37, 58978)
    ✓ Random_10 (pose=(2.1486884704642177, -2.709874570603109, -1.684002153739805)): shape (37, 800, 800)
      Valid pixels: 62705/640000 (9.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=271716, num_faces=271788
      Valid probs shape: (37, 62705)
    ✓ Random_11 (pose=(-1.8622448523630029, -0.6741561483873615, -0.5024284043011567)): shape (37, 800, 800)
      Valid pixels: 90721/640000 (14.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=271785, num_faces=271788
      Valid probs shape: (37, 90721)
    ✓ Random_12 (pose=(-1.4390261390370216, 2.2816478752831735, 1.9105014592544975)): shape (37, 800, 800)
      Valid pixels: 73879/640000 (11.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=89, max=271787, num_faces=271788
      Valid probs shape: (37, 73879)
    ✓ Random_13 (pose=(2.411656875746554, 2.222817330564962, 0.03958109698536516)): shape (37, 800, 800)
      Valid pixels: 86496/640000 (13.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=271787, num_faces=271788
      Valid probs shape: (37, 86496)
    ✓ Random_14 (pose=(0.07382118405971205, -0.6588325868463349, 1.6245597288861289)): shape (37, 800, 800)
      Valid pixels: 65399/640000 (10.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=271766, num_faces=271788
      Valid probs shape: (37, 65399)
    ✓ Random_15 (pose=(1.7553030519941162, -0.6748240927448363, -1.3545273795191675)): shape (37, 800, 800)
      Valid pixels: 77362/640000 (12.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=88, max=271787, num_faces=271788
      Valid probs shape: (37, 77362)
    ✓ Random_16 (pose=(2.4837682715500833, 2.9725379759541237, 0.28815955964400075)): shape (37, 800, 800)
      Valid pixels: 67536/640000 (10.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=271787, num_faces=271788
      Valid probs shape: (37, 67536)
    ✓ Random_17 (pose=(-2.995908556899946, -0.8638471804255308, -0.07657874381213858)): shape (37, 800, 800)
      Valid pixels: 60151/640000 (9.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6467, max=271785, num_faces=271788
      Valid probs shape: (37, 60151)
    ✓ Random_18 (pose=(-3.1257341322706886, 2.7137435804692913, -0.6291353209899779)): shape (37, 800, 800)
      Valid pixels: 48349/640000 (7.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=271582, num_faces=271788
      Valid probs shape: (37, 48349)
    ✓ Random_19 (pose=(0.9702558323480863, 1.8304141319160818, 0.3616274035512732)): shape (37, 800, 800)
      Valid pixels: 68559/640000 (10.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=46, max=271785, num_faces=271788
      Valid probs shape: (37, 68559)
    P stats: min=0.0000, max=1.0000, mean=0.0227
    Non-zero vertices: 113949/135896
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 21947   602  1311  3129     0  1823   817  4633  5456]
  Ground Truth Stats:
    Labels shape: (135896,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-17/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7150
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7974
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7978

  RESULTS:
  RAW:         median(top-10)=0.8560, mean(top-10)=0.8689, median(all)=0.8069, mean(all)=0.7150
  + SMOOTHING: median(top-10)=0.9125, mean(top-10)=0.9166, median(all)=0.8324, mean(all)=0.7974 [+0.0565]
  + MRF:       median(top-10)=0.9129, mean(top-10)=0.9169, median(all)=0.8329, mean(all)=0.7978 [+0.0005]
  TOTAL IMPROVEMENT (median top-10): +0.0569

================================================================================
Subject: NKI-TRT-20-18
================================================================================
  Step 0: Generating predictions with V2 model (20 random views)...
  Mesh: 132036 vertices, 264068 faces
  Generating 20 random views...
  Generating predictions for 20 views (continuous camera pose)...
    ✓ Random_0 (pose=(2.1844956808082907, 1.1362049086341335, -2.0791877061116253)): shape (37, 800, 800)
      Valid pixels: 82680/640000 (12.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=793, max=264066, num_faces=264068
      Valid probs shape: (37, 82680)
    ✓ Random_1 (pose=(0.4616867847092876, -1.6219238977556085, 1.3498813760795532)): shape (37, 800, 800)
      Valid pixels: 98469/640000 (15.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=264062, num_faces=264068
      Valid probs shape: (37, 98469)
    ✓ Random_2 (pose=(2.4566426876862213, -2.3965152185947685, 1.513297560536766)): shape (37, 800, 800)
      Valid pixels: 85789/640000 (13.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=263923, num_faces=264068
      Valid probs shape: (37, 85789)
    ✓ Random_3 (pose=(-1.9941338587719637, 1.6215857253144392, -3.1026747021574974)): shape (37, 800, 800)
      Valid pixels: 89013/640000 (13.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8, max=264055, num_faces=264068
      Valid probs shape: (37, 89013)
    ✓ Random_4 (pose=(-3.027087361658808, 2.560164129502769, -1.8979034592347368)): shape (37, 800, 800)
      Valid pixels: 74556/640000 (11.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=263923, num_faces=264068
      Valid probs shape: (37, 74556)
    ✓ Random_5 (pose=(-0.31771867908182694, -0.5289485865967611, 2.021000581717967)): shape (37, 800, 800)
      Valid pixels: 69469/640000 (10.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=264052, num_faces=264068
      Valid probs shape: (37, 69469)
    ✓ Random_6 (pose=(0.8644996848682096, -1.5612143510708358, -0.605515006050644)): shape (37, 800, 800)
      Valid pixels: 78632/640000 (12.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=60, max=264065, num_faces=264068
      Valid probs shape: (37, 78632)
    ✓ Random_7 (pose=(-0.18683935262546836, -2.7646241780861875, 0.9922565255818059)): shape (37, 800, 800)
      Valid pixels: 56420/640000 (8.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=42, max=264067, num_faces=264068
      Valid probs shape: (37, 56420)
    ✓ Random_8 (pose=(2.5785747739622042, 2.2375499892175608, -2.1530448210521866)): shape (37, 800, 800)
      Valid pixels: 86565/640000 (13.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=5, max=263923, num_faces=264068
      Valid probs shape: (37, 86565)
    ✓ Random_9 (pose=(0.9069682739145328, -0.016459717080099967, -1.1197747437601633)): shape (37, 800, 800)
      Valid pixels: 67389/640000 (10.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=264065, num_faces=264068
      Valid probs shape: (37, 67389)
    ✓ Random_10 (pose=(-2.8401677402282655, -0.675836993540492, 2.9565806350530712)): shape (37, 800, 800)
      Valid pixels: 65780/640000 (10.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=19, max=264065, num_faces=264068
      Valid probs shape: (37, 65780)
    ✓ Random_11 (pose=(0.8836318548977511, -3.1340306817243344, 0.5072541775377601)): shape (37, 800, 800)
      Valid pixels: 74525/640000 (11.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=40, max=264067, num_faces=264068
      Valid probs shape: (37, 74525)
    ✓ Random_12 (pose=(0.08049997024450084, -3.1180835362682395, -2.460327109570181)): shape (37, 800, 800)
      Valid pixels: 47001/640000 (7.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6410, max=264063, num_faces=264068
      Valid probs shape: (37, 47001)
    ✓ Random_13 (pose=(-0.4882879687388293, 1.8104056033711888, -1.0518674901631027)): shape (37, 800, 800)
      Valid pixels: 71905/640000 (11.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=264055, num_faces=264068
      Valid probs shape: (37, 71905)
    ✓ Random_14 (pose=(-1.3417778128002924, 0.07136892237140824, 1.5435356445686992)): shape (37, 800, 800)
      Valid pixels: 65627/640000 (10.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=10, max=264065, num_faces=264068
      Valid probs shape: (37, 65627)
    ✓ Random_15 (pose=(-3.0373984953967175, 1.2433491153223102, 1.5837703110456705)): shape (37, 800, 800)
      Valid pixels: 104079/640000 (16.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=87, max=264062, num_faces=264068
      Valid probs shape: (37, 104079)
    ✓ Random_16 (pose=(1.8077689910566663, -0.13401199849962397, -2.630912098664002)): shape (37, 800, 800)
      Valid pixels: 81602/640000 (12.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=793, max=264064, num_faces=264068
      Valid probs shape: (37, 81602)
    ✓ Random_17 (pose=(2.2689363929438073, -1.4958773927069093, 1.499770935115185)): shape (37, 800, 800)
      Valid pixels: 94264/640000 (14.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=3, max=263919, num_faces=264068
      Valid probs shape: (37, 94264)
    ✓ Random_18 (pose=(-2.262525254137442, -0.4026843515450209, -0.6488848068988546)): shape (37, 800, 800)
      Valid pixels: 81355/640000 (12.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8751, max=263923, num_faces=264068
      Valid probs shape: (37, 81355)
    ✓ Random_19 (pose=(-1.2680427369667882, -0.007054477661681435, 0.1261332748661914)): shape (37, 800, 800)
      Valid pixels: 91650/640000 (14.3%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=9, max=263923, num_faces=264068
      Valid probs shape: (37, 91650)
    P stats: min=0.0000, max=0.9999, mean=0.0249
    Non-zero vertices: 121791/132036
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 10245   982   924  3513     0  2027  1045  3992  6012]
  Ground Truth Stats:
    Labels shape: (132036,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-18/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7443
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8008
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8009

  RESULTS:
  RAW:         median(top-10)=0.8945, mean(top-10)=0.8956, median(all)=0.8132, mean(all)=0.7443
  + SMOOTHING: median(top-10)=0.9228, mean(top-10)=0.9234, median(all)=0.8667, mean(all)=0.8008 [+0.0282]
  + MRF:       median(top-10)=0.9229, mean(top-10)=0.9235, median(all)=0.8667, mean(all)=0.8009 [+0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0283

================================================================================
Subject: NKI-TRT-20-19
================================================================================
  Step 0: Generating predictions with V2 model (20 random views)...
  Mesh: 131542 vertices, 263080 faces
  Generating 20 random views...
  Generating predictions for 20 views (continuous camera pose)...
    ✓ Random_0 (pose=(1.6701836494170035, -1.3548037035425937, 2.3647084318698974)): shape (37, 800, 800)
      Valid pixels: 87473/640000 (13.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=263000, num_faces=263080
      Valid probs shape: (37, 87473)
    ✓ Random_1 (pose=(-0.5546213178446173, 2.253173348572492, 0.8445141285859288)): shape (37, 800, 800)
      Valid pixels: 76122/640000 (11.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=93, max=263078, num_faces=263080
      Valid probs shape: (37, 76122)
    ✓ Random_2 (pose=(-0.7272171376906069, -1.1394681296064966, -0.2696412767390042)): shape (37, 800, 800)
      Valid pixels: 65837/640000 (10.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=263072, num_faces=263080
      Valid probs shape: (37, 65837)
    ✓ Random_3 (pose=(1.749899202438077, 0.4263549882683981, 1.5825987602797786)): shape (37, 800, 800)
      Valid pixels: 57190/640000 (8.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=16, max=262998, num_faces=263080
      Valid probs shape: (37, 57190)
    ✓ Random_4 (pose=(0.7216649976772311, -1.8146147836038362, 2.271832452098743)): shape (37, 800, 800)
      Valid pixels: 56859/640000 (8.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=37, max=263000, num_faces=263080
      Valid probs shape: (37, 56859)
    ✓ Random_5 (pose=(2.5093684796940714, -0.09067104863439779, 2.0571566979575966)): shape (37, 800, 800)
      Valid pixels: 61791/640000 (9.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=12568, max=263079, num_faces=263080
      Valid probs shape: (37, 61791)
    ✓ Random_6 (pose=(1.935068911698206, 1.462367442597543, -2.781743488614923)): shape (37, 800, 800)
      Valid pixels: 80816/640000 (12.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=263072, num_faces=263080
      Valid probs shape: (37, 80816)
    ✓ Random_7 (pose=(-0.8881564894408505, 2.336046602951236, -2.3022137773768523)): shape (37, 800, 800)
      Valid pixels: 71980/640000 (11.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=27, max=263079, num_faces=263080
      Valid probs shape: (37, 71980)
    ✓ Random_8 (pose=(2.2491870013930333, -0.1499435741158739, 2.221786282907477)): shape (37, 800, 800)
      Valid pixels: 74387/640000 (11.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8004, max=263079, num_faces=263080
      Valid probs shape: (37, 74387)
    ✓ Random_9 (pose=(2.442573257973014, -2.240145210841471, 1.965116154214459)): shape (37, 800, 800)
      Valid pixels: 80748/640000 (12.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=12, max=262998, num_faces=263080
      Valid probs shape: (37, 80748)
    ✓ Random_10 (pose=(-3.0973036684068256, -0.615661992322134, 2.5387403172008227)): shape (37, 800, 800)
      Valid pixels: 48936/640000 (7.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4534, max=263078, num_faces=263080
      Valid probs shape: (37, 48936)
    ✓ Random_11 (pose=(-2.8191512861749333, -1.5552062393639594, 0.2864146454363685)): shape (37, 800, 800)
      Valid pixels: 82254/640000 (12.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=12, max=262998, num_faces=263080
      Valid probs shape: (37, 82254)
    ✓ Random_12 (pose=(-2.3760903516106575, -2.766890590891445, 0.7580283633370257)): shape (37, 800, 800)
      Valid pixels: 60387/640000 (9.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=262932, num_faces=263080
      Valid probs shape: (37, 60387)
    ✓ Random_13 (pose=(2.2605677105203137, -2.486438319548262, 1.5046259574698535)): shape (37, 800, 800)
      Valid pixels: 68724/640000 (10.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=262998, num_faces=263080
      Valid probs shape: (37, 68724)
    ✓ Random_14 (pose=(2.7807584789914976, -2.846597867966543, 0.3267144268484494)): shape (37, 800, 800)
      Valid pixels: 42931/640000 (6.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=11, max=262831, num_faces=263080
      Valid probs shape: (37, 42931)
    ✓ Random_15 (pose=(-2.593657058972875, 1.5201316233688038, 1.33330114068802)): shape (37, 800, 800)
      Valid pixels: 88512/640000 (13.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=263072, num_faces=263080
      Valid probs shape: (37, 88512)
    ✓ Random_16 (pose=(-2.539627673377039, 1.8483486018848687, -0.17023084047363213)): shape (37, 800, 800)
      Valid pixels: 63661/640000 (9.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=263078, num_faces=263080
      Valid probs shape: (37, 63661)
    ✓ Random_17 (pose=(-2.7435127934743035, -1.0856664688724775, 1.4093971050400569)): shape (37, 800, 800)
      Valid pixels: 71817/640000 (11.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=142, max=263078, num_faces=263080
      Valid probs shape: (37, 71817)
    ✓ Random_18 (pose=(1.1774441659013455, 2.491116205954068, -1.3908522819767632)): shape (37, 800, 800)
      Valid pixels: 75482/640000 (11.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=120, max=263076, num_faces=263080
      Valid probs shape: (37, 75482)
    ✓ Random_19 (pose=(-0.623860977488552, -1.0361451313253647, -1.093402210869642)): shape (37, 800, 800)
      Valid pixels: 79953/640000 (12.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=262998, num_faces=263080
      Valid probs shape: (37, 79953)
    P stats: min=0.0000, max=1.0000, mean=0.0246
    Non-zero vertices: 119589/131542
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 11953  1380  1099  3124     0  2145   913  3747  6319]
  Ground Truth Stats:
    Labels shape: (131542,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-19/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7604
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8243
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8248

  RESULTS:
  RAW:         median(top-10)=0.9032, mean(top-10)=0.9019, median(all)=0.7979, mean(all)=0.7604
  + SMOOTHING: median(top-10)=0.9257, mean(top-10)=0.9251, median(all)=0.8773, mean(all)=0.8243 [+0.0225]
  + MRF:       median(top-10)=0.9262, mean(top-10)=0.9254, median(all)=0.8781, mean(all)=0.8248 [+0.0005]
  TOTAL IMPROVEMENT (median top-10): +0.0230

================================================================================
Subject: NKI-TRT-20-2
================================================================================
  Step 0: Generating predictions with V2 model (20 random views)...
  Mesh: 174172 vertices, 348340 faces
  Generating 20 random views...
  Generating predictions for 20 views (continuous camera pose)...
    ✓ Random_0 (pose=(0.026562293543114457, -1.246701869578459, -2.256574944729336)): shape (37, 800, 800)
      Valid pixels: 84753/640000 (13.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=346950, num_faces=348340
      Valid probs shape: (37, 84753)
    ✓ Random_1 (pose=(1.4713496395289614, -2.0292462745646995, -0.027268284984016677)): shape (37, 800, 800)
      Valid pixels: 93403/640000 (14.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=13, max=348273, num_faces=348340
      Valid probs shape: (37, 93403)
    ✓ Random_2 (pose=(-2.5491644195054395, 0.9549685234220879, -1.3486333294049033)): shape (37, 800, 800)
      Valid pixels: 83356/640000 (13.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4281, max=348339, num_faces=348340
      Valid probs shape: (37, 83356)
    ✓ Random_3 (pose=(0.6359032561510753, -3.1034095246706612, 1.1162116125004644)): shape (37, 800, 800)
      Valid pixels: 49765/640000 (7.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=175, max=348339, num_faces=348340
      Valid probs shape: (37, 49765)
    ✓ Random_4 (pose=(-2.395365348004445, -0.29060078639964404, -2.700894847148949)): shape (37, 800, 800)
      Valid pixels: 67619/640000 (10.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=155, max=348339, num_faces=348340
      Valid probs shape: (37, 67619)
    ✓ Random_5 (pose=(3.0195680259308117, 0.15797439656790546, -1.162616766061033)): shape (37, 800, 800)
      Valid pixels: 43572/640000 (6.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6902, max=348339, num_faces=348340
      Valid probs shape: (37, 43572)
    ✓ Random_6 (pose=(0.09378457566312326, 1.1980867016945576, -1.1161807683597544)): shape (37, 800, 800)
      Valid pixels: 78890/640000 (12.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=9, max=348268, num_faces=348340
      Valid probs shape: (37, 78890)
    ✓ Random_7 (pose=(1.8326358329176546, -1.8338067191767466, 0.033791440351040425)): shape (37, 800, 800)
      Valid pixels: 84679/640000 (13.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=348273, num_faces=348340
      Valid probs shape: (37, 84679)
    ✓ Random_8 (pose=(2.8279139387285444, 1.0263804273732084, -0.07580597643604525)): shape (37, 800, 800)
      Valid pixels: 64831/640000 (10.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=469, max=348339, num_faces=348340
      Valid probs shape: (37, 64831)
    ✓ Random_9 (pose=(1.9608826115251903, 1.3780770079248725, 0.6453249148938953)): shape (37, 800, 800)
      Valid pixels: 84958/640000 (13.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=12, max=348273, num_faces=348340
      Valid probs shape: (37, 84958)
    ✓ Random_10 (pose=(-2.901268289614969, -0.3083940199391746, 2.5037884743186103)): shape (37, 800, 800)
      Valid pixels: 42879/640000 (6.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=583, max=348339, num_faces=348340
      Valid probs shape: (37, 42879)
    ✓ Random_11 (pose=(-0.21136003342361853, -2.019456500141071, -1.412948720629415)): shape (37, 800, 800)
      Valid pixels: 83285/640000 (13.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=119, max=348339, num_faces=348340
      Valid probs shape: (37, 83285)
    ✓ Random_12 (pose=(1.9835659692612158, 2.973924509724646, 1.5218303991960838)): shape (37, 800, 800)
      Valid pixels: 57371/640000 (9.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=348266, num_faces=348340
      Valid probs shape: (37, 57371)
    ✓ Random_13 (pose=(-1.5504914988653278, 2.2741310341189713, -0.12535279963082768)): shape (37, 800, 800)
      Valid pixels: 87709/640000 (13.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=14, max=348338, num_faces=348340
      Valid probs shape: (37, 87709)
    ✓ Random_14 (pose=(-1.5078923959640727, 2.1737715171127654, 2.088772595921313)): shape (37, 800, 800)
      Valid pixels: 78331/640000 (12.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=50, max=348339, num_faces=348340
      Valid probs shape: (37, 78331)
    ✓ Random_15 (pose=(-0.638988440790059, -1.0948291495313671, 2.1827824777767626)): shape (37, 800, 800)
      Valid pixels: 87216/640000 (13.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=348273, num_faces=348340
      Valid probs shape: (37, 87216)
    ✓ Random_16 (pose=(2.83241011011841, 2.6834499167488257, 2.966753124746905)): shape (37, 800, 800)
      Valid pixels: 53332/640000 (8.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=346950, num_faces=348340
      Valid probs shape: (37, 53332)
    ✓ Random_17 (pose=(2.66388985829457, 2.442154332026882, -0.4010025746534258)): shape (37, 800, 800)
      Valid pixels: 55008/640000 (8.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6, max=348337, num_faces=348340
      Valid probs shape: (37, 55008)
    ✓ Random_18 (pose=(1.4052578384580219, 0.9365895244065845, -1.8685910732086557)): shape (37, 800, 800)
      Valid pixels: 61048/640000 (9.5%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=22, max=348339, num_faces=348340
      Valid probs shape: (37, 61048)
    ✓ Random_19 (pose=(-2.2220799794892847, -2.3924401055859463, 0.9036067421562786)): shape (37, 800, 800)
      Valid pixels: 69794/640000 (10.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=348339, num_faces=348340
      Valid probs shape: (37, 69794)
    P stats: min=0.0000, max=1.0000, mean=0.0240
    Non-zero vertices: 154858/174172
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 19314  1737  1317  3993     0  2703  1160  5462  8681]
  Ground Truth Stats:
    Labels shape: (174172,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-2/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7411
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8167
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8170

  RESULTS:
  RAW:         median(top-10)=0.8596, mean(top-10)=0.8675, median(all)=0.7950, mean(all)=0.7411
  + SMOOTHING: median(top-10)=0.9128, mean(top-10)=0.9143, median(all)=0.8747, mean(all)=0.8167 [+0.0532]
  + MRF:       median(top-10)=0.9129, mean(top-10)=0.9146, median(all)=0.8752, mean(all)=0.8170 [+0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0533

================================================================================
Subject: NKI-TRT-20-20
================================================================================
  Step 0: Generating predictions with V2 model (20 random views)...
  Mesh: 147840 vertices, 295676 faces
  Generating 20 random views...
  Generating predictions for 20 views (continuous camera pose)...
    ✓ Random_0 (pose=(-1.1686883147824787, -0.6170153821711022, 1.2786970686328596)): shape (37, 800, 800)
      Valid pixels: 71818/640000 (11.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=295665, num_faces=295676
      Valid probs shape: (37, 71818)
    ✓ Random_1 (pose=(-1.0320455632735817, 2.0207880787359693, 0.962678748377682)): shape (37, 800, 800)
      Valid pixels: 99132/640000 (15.5%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=2, max=295675, num_faces=295676
      Valid probs shape: (37, 99132)
    ✓ Random_2 (pose=(0.42255994573181566, 1.6766804846855, 1.0480401986038936)): shape (37, 800, 800)
      Valid pixels: 107923/640000 (16.9%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=124, max=295584, num_faces=295676
      Valid probs shape: (37, 107923)
    ✓ Random_3 (pose=(-2.2339354188848306, 2.624062372749222, -3.054505392549762)): shape (37, 800, 800)
      Valid pixels: 94712/640000 (14.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=295672, num_faces=295676
      Valid probs shape: (37, 94712)
    ✓ Random_4 (pose=(0.43276212618056853, -0.674079071379555, -1.9005711847592068)): shape (37, 800, 800)
      Valid pixels: 87054/640000 (13.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=295243, num_faces=295676
      Valid probs shape: (37, 87054)
    ✓ Random_5 (pose=(1.8088441828859878, 1.2098225116965882, -2.981679541466101)): shape (37, 800, 800)
      Valid pixels: 111903/640000 (17.5%)
      Probs stats: min=0.0000, max=0.9992, mean=0.0270
      Face IDs: min=5, max=295675, num_faces=295676
      Valid probs shape: (37, 111903)
    ✓ Random_6 (pose=(0.619319975143664, -1.153930949459023, 0.8738783918245927)): shape (37, 800, 800)
      Valid pixels: 112858/640000 (17.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=9, max=295671, num_faces=295676
      Valid probs shape: (37, 112858)
    ✓ Random_7 (pose=(-1.506473326792976, -1.5749619267990405, -2.329550859426633)): shape (37, 800, 800)
      Valid pixels: 91441/640000 (14.3%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=50, max=295671, num_faces=295676
      Valid probs shape: (37, 91441)
    ✓ Random_8 (pose=(1.1292726985086219, 1.974896592944293, 0.8767384713781476)): shape (37, 800, 800)
      Valid pixels: 78543/640000 (12.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=108, max=295670, num_faces=295676
      Valid probs shape: (37, 78543)
    ✓ Random_9 (pose=(-0.504880459717671, -2.334619585677733, -0.8223351448843941)): shape (37, 800, 800)
      Valid pixels: 99712/640000 (15.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=11671, max=295675, num_faces=295676
      Valid probs shape: (37, 99712)
    ✓ Random_10 (pose=(-2.1388872680683844, 2.0961854285656933, 2.1752021410169933)): shape (37, 800, 800)
      Valid pixels: 114593/640000 (17.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=10, max=295668, num_faces=295676
      Valid probs shape: (37, 114593)
    ✓ Random_11 (pose=(-0.6952673658757704, -2.4875169060008373, 0.7200270547394805)): shape (37, 800, 800)
      Valid pixels: 83796/640000 (13.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=4875, max=295675, num_faces=295676
      Valid probs shape: (37, 83796)
    ✓ Random_12 (pose=(-0.8741013802196518, 0.9654239750002036, 3.078899607613507)): shape (37, 800, 800)
      Valid pixels: 107114/640000 (16.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=295668, num_faces=295676
      Valid probs shape: (37, 107114)
    ✓ Random_13 (pose=(-2.3258535181635756, 1.032401215957953, -2.016857050750812)): shape (37, 800, 800)
      Valid pixels: 82296/640000 (12.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1245, max=295607, num_faces=295676
      Valid probs shape: (37, 82296)
    ✓ Random_14 (pose=(2.8751387316931387, 1.839594134590853, -2.918780250781342)): shape (37, 800, 800)
      Valid pixels: 101957/640000 (15.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=3, max=295579, num_faces=295676
      Valid probs shape: (37, 101957)
    ✓ Random_15 (pose=(-1.8251039339196087, 2.184392964360492, -1.524705173935601)): shape (37, 800, 800)
      Valid pixels: 88838/640000 (13.9%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=4, max=295579, num_faces=295676
      Valid probs shape: (37, 88838)
    ✓ Random_16 (pose=(-0.0629050558028621, 0.1774226747495531, 0.26911594326591226)): shape (37, 800, 800)
      Valid pixels: 66056/640000 (10.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=292904, num_faces=295676
      Valid probs shape: (37, 66056)
    ✓ Random_17 (pose=(0.3940542180429647, 1.1519788074488027, -1.235521741781799)): shape (37, 800, 800)
      Valid pixels: 111079/640000 (17.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7, max=295668, num_faces=295676
      Valid probs shape: (37, 111079)
    ✓ Random_18 (pose=(0.0906317084283188, -1.2830938878258857, 3.0146770929950666)): shape (37, 800, 800)
      Valid pixels: 75018/640000 (11.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=11, max=295663, num_faces=295676
      Valid probs shape: (37, 75018)
    ✓ Random_19 (pose=(-2.577646060457752, -1.003595178524923, -1.0325866112765523)): shape (37, 800, 800)
      Valid pixels: 76185/640000 (11.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1517, max=295656, num_faces=295676
      Valid probs shape: (37, 76185)
    P stats: min=0.0000, max=0.9998, mean=0.0242
    Non-zero vertices: 132527/147840
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 15313  1075  1269  4689     0  2044   806  4400  5013]
  Ground Truth Stats:
    Labels shape: (147840,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-20/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7562
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8237
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8240

  RESULTS:
  RAW:         median(top-10)=0.8797, mean(top-10)=0.8829, median(all)=0.8170, mean(all)=0.7562
  + SMOOTHING: median(top-10)=0.9111, mean(top-10)=0.9178, median(all)=0.8808, mean(all)=0.8237 [+0.0314]
  + MRF:       median(top-10)=0.9113, mean(top-10)=0.9178, median(all)=0.8816, mean(all)=0.8240 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0316

================================================================================
Subject: NKI-TRT-20-3
================================================================================
  Step 0: Generating predictions with V2 model (20 random views)...
  Mesh: 123781 vertices, 247558 faces
  Generating 20 random views...
  Generating predictions for 20 views (continuous camera pose)...
    ✓ Random_0 (pose=(0.8583605795464022, 1.9982662912596378, -0.09773943458841705)): shape (37, 800, 800)
      Valid pixels: 96489/640000 (15.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=247553, num_faces=247558
      Valid probs shape: (37, 96489)
    ✓ Random_1 (pose=(-3.125096493556023, 1.5659364693952469, -1.0883831726359592)): shape (37, 800, 800)
      Valid pixels: 95369/640000 (14.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=73, max=247557, num_faces=247558
      Valid probs shape: (37, 95369)
    ✓ Random_2 (pose=(-2.128637006630669, 2.2485618086569197, -2.7415986594123885)): shape (37, 800, 800)
      Valid pixels: 89834/640000 (14.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=247553, num_faces=247558
      Valid probs shape: (37, 89834)
    ✓ Random_3 (pose=(1.625555120169805, 1.810116085603112, 1.9606451250012986)): shape (37, 800, 800)
      Valid pixels: 93418/640000 (14.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=6, max=246057, num_faces=247558
      Valid probs shape: (37, 93418)
    ✓ Random_4 (pose=(2.734725156788543, -2.4760907061403863, 1.853174474324426)): shape (37, 800, 800)
      Valid pixels: 97040/640000 (15.2%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=0, max=247502, num_faces=247558
      Valid probs shape: (37, 97040)
    ✓ Random_5 (pose=(-0.6856338575675074, -1.802265990459684, -0.4816991917615292)): shape (37, 800, 800)
      Valid pixels: 98597/640000 (15.4%)
      Probs stats: min=0.0000, max=0.9994, mean=0.0270
      Face IDs: min=97, max=247557, num_faces=247558
      Valid probs shape: (37, 98597)
    ✓ Random_6 (pose=(0.9434575438911708, 0.22192178443189903, -1.4395846243049606)): shape (37, 800, 800)
      Valid pixels: 70720/640000 (11.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=247553, num_faces=247558
      Valid probs shape: (37, 70720)
    ✓ Random_7 (pose=(-1.5347860181348674, 0.8482428258376036, 2.3144514767915583)): shape (37, 800, 800)
      Valid pixels: 111262/640000 (17.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=52, max=247553, num_faces=247558
      Valid probs shape: (37, 111262)
    ✓ Random_8 (pose=(-2.5868522370804508, 1.778735750080605, -2.4913976224192163)): shape (37, 800, 800)
      Valid pixels: 78560/640000 (12.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=16, max=246059, num_faces=247558
      Valid probs shape: (37, 78560)
    ✓ Random_9 (pose=(-2.4068012554207288, -1.1117846756876841, 0.6196036806868372)): shape (37, 800, 800)
      Valid pixels: 110350/640000 (17.2%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=482, max=247557, num_faces=247558
      Valid probs shape: (37, 110350)
    ✓ Random_10 (pose=(3.047441501498027, 1.398503920555533, 3.1010427588460727)): shape (37, 800, 800)
      Valid pixels: 73926/640000 (11.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=164, max=245370, num_faces=247558
      Valid probs shape: (37, 73926)
    ✓ Random_11 (pose=(-2.251345582803225, -1.4239150589529745, -1.975459465077829)): shape (37, 800, 800)
      Valid pixels: 102025/640000 (15.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=9, max=247553, num_faces=247558
      Valid probs shape: (37, 102025)
    ✓ Random_12 (pose=(0.6723609554570218, -0.9880339633262465, 1.884973977487518)): shape (37, 800, 800)
      Valid pixels: 84388/640000 (13.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=247552, num_faces=247558
      Valid probs shape: (37, 84388)
    ✓ Random_13 (pose=(-2.9977764896899775, -0.44239684767671283, 2.1419066413864236)): shape (37, 800, 800)
      Valid pixels: 76013/640000 (11.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=8967, max=247557, num_faces=247558
      Valid probs shape: (37, 76013)
    ✓ Random_14 (pose=(-1.5319796090104267, 0.0673616002004267, -0.2483365205992727)): shape (37, 800, 800)
      Valid pixels: 114528/640000 (17.9%)
      Probs stats: min=0.0000, max=0.9993, mean=0.0270
      Face IDs: min=26, max=247551, num_faces=247558
      Valid probs shape: (37, 114528)
    ✓ Random_15 (pose=(-1.8728047223442807, 1.572304546660928, -0.5611446282651484)): shape (37, 800, 800)
      Valid pixels: 114635/640000 (17.9%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=6, max=247551, num_faces=247558
      Valid probs shape: (37, 114635)
    ✓ Random_16 (pose=(1.4479077325859588, 0.9280614579541568, -2.112078511224051)): shape (37, 800, 800)
      Valid pixels: 81200/640000 (12.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=247557, num_faces=247558
      Valid probs shape: (37, 81200)
    ✓ Random_17 (pose=(-1.1420305063710525, -1.9331276463062341, 0.9022105604936419)): shape (37, 800, 800)
      Valid pixels: 82292/640000 (12.9%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=104, max=247557, num_faces=247558
      Valid probs shape: (37, 82292)
    ✓ Random_18 (pose=(-2.9916916641331976, 0.2800324042612914, -0.6579744801564567)): shape (37, 800, 800)
      Valid pixels: 71904/640000 (11.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=12714, max=247557, num_faces=247558
      Valid probs shape: (37, 71904)
    ✓ Random_19 (pose=(2.0979298734755343, -2.6240270978335345, 1.0049308199477593)): shape (37, 800, 800)
      Valid pixels: 79572/640000 (12.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=247552, num_faces=247558
      Valid probs shape: (37, 79572)
    P stats: min=0.0000, max=0.9998, mean=0.0238
    Non-zero vertices: 108863/123781
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 14918  1079   996  3628     0  1515   533  4098  4416]
  Ground Truth Stats:
    Labels shape: (123781,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-3/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
    MRF iteration 5/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7513
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8166
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8167

  RESULTS:
  RAW:         median(top-10)=0.8879, mean(top-10)=0.8831, median(all)=0.8115, mean(all)=0.7513
  + SMOOTHING: median(top-10)=0.9199, mean(top-10)=0.9185, median(all)=0.8577, mean(all)=0.8166 [+0.0320]
  + MRF:       median(top-10)=0.9196, mean(top-10)=0.9189, median(all)=0.8576, mean(all)=0.8167 [-0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0317

================================================================================
Subject: NKI-TRT-20-4
================================================================================
  Step 0: Generating predictions with V2 model (20 random views)...
  Mesh: 158207 vertices, 316410 faces
  Generating 20 random views...
  Generating predictions for 20 views (continuous camera pose)...
    ✓ Random_0 (pose=(2.452284424724591, 2.2838210358399316, 1.5188666010866383)): shape (37, 800, 800)
      Valid pixels: 81247/640000 (12.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=316409, num_faces=316410
      Valid probs shape: (37, 81247)
    ✓ Random_1 (pose=(0.6332643074925053, -0.8825609561912819, -0.9608779298018635)): shape (37, 800, 800)
      Valid pixels: 67436/640000 (10.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=11, max=316311, num_faces=316410
      Valid probs shape: (37, 67436)
    ✓ Random_2 (pose=(-0.7315242464656575, 2.478154077202724, -1.8867081395631347)): shape (37, 800, 800)
      Valid pixels: 80595/640000 (12.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=71, max=316409, num_faces=316410
      Valid probs shape: (37, 80595)
    ✓ Random_3 (pose=(-2.7834935612261327, 2.4361151439332085, -2.0930642822592187)): shape (37, 800, 800)
      Valid pixels: 89744/640000 (14.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=316216, num_faces=316410
      Valid probs shape: (37, 89744)
    ✓ Random_4 (pose=(2.1511437038683363, -0.631160265797237, 2.9500724941408842)): shape (37, 800, 800)
      Valid pixels: 95895/640000 (15.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=3645, max=316407, num_faces=316410
      Valid probs shape: (37, 95895)
    ✓ Random_5 (pose=(1.1821774818189974, -1.3261072316631544, -0.755123461658739)): shape (37, 800, 800)
      Valid pixels: 97041/640000 (15.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=10, max=316403, num_faces=316410
      Valid probs shape: (37, 97041)
    ✓ Random_6 (pose=(-0.7157910952357236, 2.0960174499712725, -1.959440199252838)): shape (37, 800, 800)
      Valid pixels: 95811/640000 (15.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=316409, num_faces=316410
      Valid probs shape: (37, 95811)
    ✓ Random_7 (pose=(-3.0024673600736222, 1.176464368619719, -2.600344390096727)): shape (37, 800, 800)
      Valid pixels: 93016/640000 (14.5%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=5608, max=316407, num_faces=316410
      Valid probs shape: (37, 93016)
    ✓ Random_8 (pose=(0.1701995528173077, 1.3458512732782228, 2.5475850257591937)): shape (37, 800, 800)
      Valid pixels: 80716/640000 (12.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=15, max=316311, num_faces=316410
      Valid probs shape: (37, 80716)
    ✓ Random_9 (pose=(-1.9537429976077345, 1.3309624958903656, -1.0901175261955967)): shape (37, 800, 800)
      Valid pixels: 111958/640000 (17.5%)
      Probs stats: min=0.0000, max=0.9995, mean=0.0270
      Face IDs: min=56, max=316406, num_faces=316410
      Valid probs shape: (37, 111958)
    ✓ Random_10 (pose=(0.7221138951537438, -0.4512120281529728, -0.4498564262506002)): shape (37, 800, 800)
      Valid pixels: 81202/640000 (12.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=316403, num_faces=316410
      Valid probs shape: (37, 81202)
    ✓ Random_11 (pose=(-2.096509393188736, 2.6227237065015636, 2.3140202972080592)): shape (37, 800, 800)
      Valid pixels: 103010/640000 (16.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=316409, num_faces=316410
      Valid probs shape: (37, 103010)
    ✓ Random_12 (pose=(2.3270817378762185, 0.2140905073054764, 1.7453097401579525)): shape (37, 800, 800)
      Valid pixels: 64053/640000 (10.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=20790, max=316409, num_faces=316410
      Valid probs shape: (37, 64053)
    ✓ Random_13 (pose=(1.0743033168158442, 0.22097797320674184, 1.8034177201938544)): shape (37, 800, 800)
      Valid pixels: 91331/640000 (14.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=20, max=316220, num_faces=316410
      Valid probs shape: (37, 91331)
    ✓ Random_14 (pose=(3.0916758695925743, 0.02382595483998351, 0.2895170225923094)): shape (37, 800, 800)
      Valid pixels: 52881/640000 (8.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4279, max=316407, num_faces=316410
      Valid probs shape: (37, 52881)
    ✓ Random_15 (pose=(-2.761508334907501, -2.09276028768542, 1.6836289708759695)): shape (37, 800, 800)
      Valid pixels: 83440/640000 (13.0%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=11, max=316306, num_faces=316410
      Valid probs shape: (37, 83440)
    ✓ Random_16 (pose=(1.6406347648497226, 0.8120188025214428, 0.6680172095851638)): shape (37, 800, 800)
      Valid pixels: 91318/640000 (14.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=316409, num_faces=316410
      Valid probs shape: (37, 91318)
    ✓ Random_17 (pose=(-0.2105392517891036, -0.9825980262226048, 1.9602345485722754)): shape (37, 800, 800)
      Valid pixels: 95468/640000 (14.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=316409, num_faces=316410
      Valid probs shape: (37, 95468)
    ✓ Random_18 (pose=(-2.5208706052736587, -0.7849076572649638, 0.5939537598447351)): shape (37, 800, 800)
      Valid pixels: 98800/640000 (15.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=8068, max=316407, num_faces=316410
      Valid probs shape: (37, 98800)
    ✓ Random_19 (pose=(-0.40961617317988086, 1.2942228021127793, -1.3059347328630595)): shape (37, 800, 800)
      Valid pixels: 86984/640000 (13.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=18, max=316409, num_faces=316410
      Valid probs shape: (37, 86984)
    P stats: min=0.0000, max=0.9999, mean=0.0244
    Non-zero vertices: 142777/158207
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 15430   931   966  3893     0  2602  1218  5322  6093]
  Ground Truth Stats:
    Labels shape: (158207,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-4/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7386
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8085
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8089

  RESULTS:
  RAW:         median(top-10)=0.8883, mean(top-10)=0.8931, median(all)=0.8082, mean(all)=0.7386
  + SMOOTHING: median(top-10)=0.9151, mean(top-10)=0.9231, median(all)=0.8714, mean(all)=0.8085 [+0.0268]
  + MRF:       median(top-10)=0.9155, mean(top-10)=0.9236, median(all)=0.8712, mean(all)=0.8089 [+0.0004]
  TOTAL IMPROVEMENT (median top-10): +0.0272

================================================================================
Subject: NKI-TRT-20-5
================================================================================
  Step 0: Generating predictions with V2 model (20 random views)...
  Mesh: 137753 vertices, 275502 faces
  Generating 20 random views...
  Generating predictions for 20 views (continuous camera pose)...
    ✓ Random_0 (pose=(0.8355225674224225, -1.7636538009767317, 2.556415435356832)): shape (37, 800, 800)
      Valid pixels: 74430/640000 (11.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=242, max=273940, num_faces=275502
      Valid probs shape: (37, 74430)
    ✓ Random_1 (pose=(-1.6182982503973276, 2.4377697967028356, -2.4809506763347913)): shape (37, 800, 800)
      Valid pixels: 82734/640000 (12.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=26, max=275501, num_faces=275502
      Valid probs shape: (37, 82734)
    ✓ Random_2 (pose=(-0.07988483180984174, -1.5497365126990872, -2.65111451157839)): shape (37, 800, 800)
      Valid pixels: 81703/640000 (12.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=273940, num_faces=275502
      Valid probs shape: (37, 81703)
    ✓ Random_3 (pose=(1.1089922248320958, -0.2591812961032782, -1.7501037648236268)): shape (37, 800, 800)
      Valid pixels: 68827/640000 (10.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=275462, num_faces=275502
      Valid probs shape: (37, 68827)
    ✓ Random_4 (pose=(-1.876047126119332, -1.3416343309468808, 1.5759863181373195)): shape (37, 800, 800)
      Valid pixels: 73305/640000 (11.5%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=29, max=275460, num_faces=275502
      Valid probs shape: (37, 73305)
    ✓ Random_5 (pose=(1.809188460725922, 0.6771496350980111, -0.5691642083425537)): shape (37, 800, 800)
      Valid pixels: 99764/640000 (15.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=275498, num_faces=275502
      Valid probs shape: (37, 99764)
    ✓ Random_6 (pose=(2.892085871316799, 2.849382149614147, -0.7952652025617719)): shape (37, 800, 800)
      Valid pixels: 52452/640000 (8.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=275331, num_faces=275502
      Valid probs shape: (37, 52452)
    ✓ Random_7 (pose=(0.5086619097934801, -2.6041415126019487, 1.445546024104706)): shape (37, 800, 800)
      Valid pixels: 68662/640000 (10.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=839, max=275501, num_faces=275502
      Valid probs shape: (37, 68662)
    ✓ Random_8 (pose=(-2.458872439260542, -2.584021344418508, -1.0288781065075105)): shape (37, 800, 800)
      Valid pixels: 56940/640000 (8.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=273938, num_faces=275502
      Valid probs shape: (37, 56940)
    ✓ Random_9 (pose=(2.717880500929069, -1.9768133296439734, 2.677722728175751)): shape (37, 800, 800)
      Valid pixels: 77894/640000 (12.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=4, max=275462, num_faces=275502
      Valid probs shape: (37, 77894)
    ✓ Random_10 (pose=(-1.7260123012484614, 2.4988278067303877, 3.0557375236987765)): shape (37, 800, 800)
      Valid pixels: 103136/640000 (16.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=275501, num_faces=275502
      Valid probs shape: (37, 103136)
    ✓ Random_11 (pose=(-0.22975713180935742, -0.8179490301354657, -1.9141018185633665)): shape (37, 800, 800)
      Valid pixels: 79579/640000 (12.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=275114, num_faces=275502
      Valid probs shape: (37, 79579)
    ✓ Random_12 (pose=(-2.8287397992759806, -1.9093886324865272, -1.6292855056701736)): shape (37, 800, 800)
      Valid pixels: 92524/640000 (14.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=275498, num_faces=275502
      Valid probs shape: (37, 92524)
    ✓ Random_13 (pose=(1.7589857497927701, -2.6931033249884266, 0.5367630836842747)): shape (37, 800, 800)
      Valid pixels: 83396/640000 (13.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=275501, num_faces=275502
      Valid probs shape: (37, 83396)
    ✓ Random_14 (pose=(0.011062452275478751, -0.7560759110557931, -1.0122298197118846)): shape (37, 800, 800)
      Valid pixels: 67812/640000 (10.6%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=0, max=275462, num_faces=275502
      Valid probs shape: (37, 67812)
    ✓ Random_15 (pose=(0.26838086052582444, -0.41584993889677646, 0.15696976356768433)): shape (37, 800, 800)
      Valid pixels: 62281/640000 (9.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=275497, num_faces=275502
      Valid probs shape: (37, 62281)
    ✓ Random_16 (pose=(2.4007906032269117, 2.8808308068969133, 1.300249600519476)): shape (37, 800, 800)
      Valid pixels: 62493/640000 (9.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=275497, num_faces=275502
      Valid probs shape: (37, 62493)
    ✓ Random_17 (pose=(2.5983827920909626, 3.089640195324354, -3.0877966274153565)): shape (37, 800, 800)
      Valid pixels: 66747/640000 (10.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=0, max=274407, num_faces=275502
      Valid probs shape: (37, 66747)
    ✓ Random_18 (pose=(-2.118826664601149, 1.4539280873231526, -1.6735914887324501)): shape (37, 800, 800)
      Valid pixels: 83868/640000 (13.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=273941, num_faces=275502
      Valid probs shape: (37, 83868)
    ✓ Random_19 (pose=(1.955681987315244, -2.3066122993086116, 2.5278490836134706)): shape (37, 800, 800)
      Valid pixels: 97918/640000 (15.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=0, max=275453, num_faces=275502
      Valid probs shape: (37, 97918)
    P stats: min=0.0000, max=0.9999, mean=0.0229
    Non-zero vertices: 116638/137753
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 21115  1146  1025  2947     0  2755   880  4512  7262]
  Ground Truth Stats:
    Labels shape: (137753,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-5/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7008
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7752
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7756

  RESULTS:
  RAW:         median(top-10)=0.8685, mean(top-10)=0.8763, median(all)=0.7580, mean(all)=0.7008
  + SMOOTHING: median(top-10)=0.9091, mean(top-10)=0.9081, median(all)=0.8210, mean(all)=0.7752 [+0.0406]
  + MRF:       median(top-10)=0.9095, mean(top-10)=0.9084, median(all)=0.8218, mean(all)=0.7756 [+0.0004]
  TOTAL IMPROVEMENT (median top-10): +0.0410

================================================================================
Subject: NKI-TRT-20-6
================================================================================
  Step 0: Generating predictions with V2 model (20 random views)...
  Mesh: 158025 vertices, 316046 faces
  Generating 20 random views...
  Generating predictions for 20 views (continuous camera pose)...
    ✓ Random_0 (pose=(-0.062328018812905395, 2.320525273790947, -1.3606500083341433)): shape (37, 800, 800)
      Valid pixels: 81277/640000 (12.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=316044, num_faces=316046
      Valid probs shape: (37, 81277)
    ✓ Random_1 (pose=(-2.7570313128781168, -1.7457872198276898, -1.3665531682331826)): shape (37, 800, 800)
      Valid pixels: 86714/640000 (13.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=316043, num_faces=316046
      Valid probs shape: (37, 86714)
    ✓ Random_2 (pose=(-2.7461005255165483, 0.9737973830220827, 0.5262655595662173)): shape (37, 800, 800)
      Valid pixels: 71991/640000 (11.2%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=368, max=316045, num_faces=316046
      Valid probs shape: (37, 71991)
    ✓ Random_3 (pose=(-1.0419637985970556, -0.6380212239552416, 1.7909611372776117)): shape (37, 800, 800)
      Valid pixels: 83286/640000 (13.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=15, max=316043, num_faces=316046
      Valid probs shape: (37, 83286)
    ✓ Random_4 (pose=(-1.0993288769733747, -2.7078432120865084, -1.4521961384576032)): shape (37, 800, 800)
      Valid pixels: 76807/640000 (12.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1230, max=316025, num_faces=316046
      Valid probs shape: (37, 76807)
    ✓ Random_5 (pose=(2.306833668429652, 0.012837219221747187, -1.7778012658767999)): shape (37, 800, 800)
      Valid pixels: 70295/640000 (11.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1752, max=316045, num_faces=316046
      Valid probs shape: (37, 70295)
    ✓ Random_6 (pose=(-2.277605823361299, 0.7610999735180539, -2.873256394729128)): shape (37, 800, 800)
      Valid pixels: 74092/640000 (11.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=316043, num_faces=316046
      Valid probs shape: (37, 74092)
    ✓ Random_7 (pose=(1.9219923946999922, -0.5940140931023978, 2.422431946988935)): shape (37, 800, 800)
      Valid pixels: 103164/640000 (16.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=164, max=316045, num_faces=316046
      Valid probs shape: (37, 103164)
    ✓ Random_8 (pose=(-1.7475485710462852, 1.788596327667106, -3.075866407417708)): shape (37, 800, 800)
      Valid pixels: 102017/640000 (15.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=10, max=316043, num_faces=316046
      Valid probs shape: (37, 102017)
    ✓ Random_9 (pose=(-2.885840049372314, 0.7336585008306571, -1.3714873380468025)): shape (37, 800, 800)
      Valid pixels: 84274/640000 (13.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6151, max=316044, num_faces=316046
      Valid probs shape: (37, 84274)
    ✓ Random_10 (pose=(2.2433995140840945, -2.7234452425284994, 1.50051061074533)): shape (37, 800, 800)
      Valid pixels: 75642/640000 (11.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=314909, num_faces=316046
      Valid probs shape: (37, 75642)
    ✓ Random_11 (pose=(1.6904791561620183, -2.252847737795297, 1.8548065555561593)): shape (37, 800, 800)
      Valid pixels: 86756/640000 (13.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=9, max=315777, num_faces=316046
      Valid probs shape: (37, 86756)
    ✓ Random_12 (pose=(2.754920949749822, 0.12095049604711239, -2.306077097318741)): shape (37, 800, 800)
      Valid pixels: 64190/640000 (10.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=11268, max=316045, num_faces=316046
      Valid probs shape: (37, 64190)
    ✓ Random_13 (pose=(0.3978256137014111, -0.9139201946072602, 1.3667196188203246)): shape (37, 800, 800)
      Valid pixels: 87003/640000 (13.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=316043, num_faces=316046
      Valid probs shape: (37, 87003)
    ✓ Random_14 (pose=(-1.235964112284411, -2.3193168679437184, 2.20220800627098)): shape (37, 800, 800)
      Valid pixels: 108923/640000 (17.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=316045, num_faces=316046
      Valid probs shape: (37, 108923)
    ✓ Random_15 (pose=(-0.831571616062944, -1.8497295265808653, -2.3148771891276136)): shape (37, 800, 800)
      Valid pixels: 62052/640000 (9.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=804, max=316029, num_faces=316046
      Valid probs shape: (37, 62052)
    ✓ Random_16 (pose=(-2.126724208703123, 0.21410575719343417, -1.971542388825604)): shape (37, 800, 800)
      Valid pixels: 60906/640000 (9.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2981, max=316029, num_faces=316046
      Valid probs shape: (37, 60906)
    ✓ Random_17 (pose=(0.39701132097200853, -2.5481597330676093, 1.8598732460189895)): shape (37, 800, 800)
      Valid pixels: 59679/640000 (9.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1952, max=316044, num_faces=316046
      Valid probs shape: (37, 59679)
    ✓ Random_18 (pose=(0.5255751233491153, -0.9360770201163855, 2.029663932785555)): shape (37, 800, 800)
      Valid pixels: 71112/640000 (11.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=316043, num_faces=316046
      Valid probs shape: (37, 71112)
    ✓ Random_19 (pose=(0.9632617483280299, 2.350837808797735, 1.5645690814538327)): shape (37, 800, 800)
      Valid pixels: 83637/640000 (13.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1872, max=316024, num_faces=316046
      Valid probs shape: (37, 83637)
    P stats: min=0.0000, max=1.0000, mean=0.0227
    Non-zero vertices: 132868/158025
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 25157   569  1032  3565     0  2237  1002  4604  5484]
  Ground Truth Stats:
    Labels shape: (158025,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-6/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7292
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8113
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8116

  RESULTS:
  RAW:         median(top-10)=0.8857, mean(top-10)=0.8891, median(all)=0.7671, mean(all)=0.7292
  + SMOOTHING: median(top-10)=0.9130, mean(top-10)=0.9149, median(all)=0.8539, mean(all)=0.8113 [+0.0273]
  + MRF:       median(top-10)=0.9132, mean(top-10)=0.9152, median(all)=0.8540, mean(all)=0.8116 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0275

================================================================================
Subject: NKI-TRT-20-7
================================================================================
  Step 0: Generating predictions with V2 model (20 random views)...
  Mesh: 145017 vertices, 290030 faces
  Generating 20 random views...
  Generating predictions for 20 views (continuous camera pose)...
    ✓ Random_0 (pose=(-2.0597505898753505, -0.7884132692126355, 2.2719820647685642)): shape (37, 800, 800)
      Valid pixels: 79823/640000 (12.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=39, max=290027, num_faces=290030
      Valid probs shape: (37, 79823)
    ✓ Random_1 (pose=(2.755177246578844, -1.6868517754108088, -2.8198268748290056)): shape (37, 800, 800)
      Valid pixels: 67915/640000 (10.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=21, max=290028, num_faces=290030
      Valid probs shape: (37, 67915)
    ✓ Random_2 (pose=(-3.0274733773740827, 1.1441576222421528, 0.611419044821508)): shape (37, 800, 800)
      Valid pixels: 85346/640000 (13.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=56, max=290027, num_faces=290030
      Valid probs shape: (37, 85346)
    ✓ Random_3 (pose=(-2.2750033436551176, 0.016795731783821655, -1.6114655878962758)): shape (37, 800, 800)
      Valid pixels: 55210/640000 (8.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=11694, max=290028, num_faces=290030
      Valid probs shape: (37, 55210)
    ✓ Random_4 (pose=(-1.3399760841897594, -1.5365912624727396, 0.6925881208881051)): shape (37, 800, 800)
      Valid pixels: 75726/640000 (11.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=6, max=290028, num_faces=290030
      Valid probs shape: (37, 75726)
    ✓ Random_5 (pose=(2.845180348147024, 1.4674582654986104, -1.7432837749972332)): shape (37, 800, 800)
      Valid pixels: 90209/640000 (14.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=4, max=290029, num_faces=290030
      Valid probs shape: (37, 90209)
    ✓ Random_6 (pose=(1.4608989940738155, 2.2677574372541836, -1.074589514236632)): shape (37, 800, 800)
      Valid pixels: 91496/640000 (14.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=12, max=290013, num_faces=290030
      Valid probs shape: (37, 91496)
    ✓ Random_7 (pose=(0.9408639603955651, 1.854442639858287, -0.9251967934133378)): shape (37, 800, 800)
      Valid pixels: 102968/640000 (16.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=289954, num_faces=290030
      Valid probs shape: (37, 102968)
    ✓ Random_8 (pose=(1.0141787010578565, -0.1804883599320002, 2.5034888205599133)): shape (37, 800, 800)
      Valid pixels: 88824/640000 (13.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=290021, num_faces=290030
      Valid probs shape: (37, 88824)
    ✓ Random_9 (pose=(0.28270925609162934, 2.2929421103455976, -0.08186137040938224)): shape (37, 800, 800)
      Valid pixels: 61285/640000 (9.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=873, max=289634, num_faces=290030
      Valid probs shape: (37, 61285)
    ✓ Random_10 (pose=(0.22958026311202318, -2.661127175551229, -1.2103085676642193)): shape (37, 800, 800)
      Valid pixels: 65135/640000 (10.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3349, max=290029, num_faces=290030
      Valid probs shape: (37, 65135)
    ✓ Random_11 (pose=(1.9266609091526954, -2.0040351995478183, 0.7634971501195089)): shape (37, 800, 800)
      Valid pixels: 73690/640000 (11.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=289864, num_faces=290030
      Valid probs shape: (37, 73690)
    ✓ Random_12 (pose=(-2.5460224676444407, 1.0802572500108054, -3.03995491324634)): shape (37, 800, 800)
      Valid pixels: 69899/640000 (10.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=31, max=289374, num_faces=290030
      Valid probs shape: (37, 69899)
    ✓ Random_13 (pose=(-1.1920974862275382, 1.5857684760156108, -0.7368620776914909)): shape (37, 800, 800)
      Valid pixels: 84979/640000 (13.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=290029, num_faces=290030
      Valid probs shape: (37, 84979)
    ✓ Random_14 (pose=(1.5983852264118168, -2.0638809788498858, -1.07354987964636)): shape (37, 800, 800)
      Valid pixels: 87891/640000 (13.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=12, max=290028, num_faces=290030
      Valid probs shape: (37, 87891)
    ✓ Random_15 (pose=(-2.500775886590411, -0.6126507590140333, -2.555849537910877)): shape (37, 800, 800)
      Valid pixels: 82934/640000 (13.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=978, max=289951, num_faces=290030
      Valid probs shape: (37, 82934)
    ✓ Random_16 (pose=(-2.42217760068488, 1.079222158497279, -1.0727055588142398)): shape (37, 800, 800)
      Valid pixels: 93254/640000 (14.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=378, max=290029, num_faces=290030
      Valid probs shape: (37, 93254)
    ✓ Random_17 (pose=(-0.8227271975191015, -1.3614473054510101, 2.079229217748436)): shape (37, 800, 800)
      Valid pixels: 101181/640000 (15.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=289950, num_faces=290030
      Valid probs shape: (37, 101181)
    ✓ Random_18 (pose=(3.070045939049468, -3.074119750330228, -0.3515568708122654)): shape (37, 800, 800)
      Valid pixels: 47861/640000 (7.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=288080, num_faces=290030
      Valid probs shape: (37, 47861)
    ✓ Random_19 (pose=(0.5525355971621155, 0.21616348772156702, -2.2114160293071548)): shape (37, 800, 800)
      Valid pixels: 50722/640000 (7.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=289953, num_faces=290030
      Valid probs shape: (37, 50722)
    P stats: min=0.0000, max=0.9999, mean=0.0238
    Non-zero vertices: 127732/145017
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 17285  1343  1058  3382     0  1850   966  4889  5079]
  Ground Truth Stats:
    Labels shape: (145017,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-7/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7460
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8184
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8191

  RESULTS:
  RAW:         median(top-10)=0.8694, mean(top-10)=0.8775, median(all)=0.8103, mean(all)=0.7460
  + SMOOTHING: median(top-10)=0.9225, mean(top-10)=0.9236, median(all)=0.8692, mean(all)=0.8184 [+0.0531]
  + MRF:       median(top-10)=0.9230, mean(top-10)=0.9242, median(all)=0.8700, mean(all)=0.8191 [+0.0005]
  TOTAL IMPROVEMENT (median top-10): +0.0536

================================================================================
Subject: NKI-TRT-20-8
================================================================================
  Step 0: Generating predictions with V2 model (20 random views)...
  Mesh: 147404 vertices, 294804 faces
  Generating 20 random views...
  Generating predictions for 20 views (continuous camera pose)...
    ✓ Random_0 (pose=(3.0698491690237457, -3.0863802132279425, -2.521135773814695)): shape (37, 800, 800)
      Valid pixels: 45465/640000 (7.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=294003, num_faces=294804
      Valid probs shape: (37, 45465)
    ✓ Random_1 (pose=(2.7708837345366, -0.13270222591437042, 1.5075252713643073)): shape (37, 800, 800)
      Valid pixels: 54994/640000 (8.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6042, max=294800, num_faces=294804
      Valid probs shape: (37, 54994)
    ✓ Random_2 (pose=(1.6561255151548009, -1.2782096031451562, 3.002703240937448)): shape (37, 800, 800)
      Valid pixels: 90530/640000 (14.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=15, max=294571, num_faces=294804
      Valid probs shape: (37, 90530)
    ✓ Random_3 (pose=(1.145521466052113, -0.3710038914677751, 0.2241367180091265)): shape (37, 800, 800)
      Valid pixels: 90038/640000 (14.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=294739, num_faces=294804
      Valid probs shape: (37, 90038)
    ✓ Random_4 (pose=(-2.990550663508761, 0.21742178156848757, 0.4348993874731706)): shape (37, 800, 800)
      Valid pixels: 47531/640000 (7.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5617, max=294795, num_faces=294804
      Valid probs shape: (37, 47531)
    ✓ Random_5 (pose=(1.0807594686297053, 0.9581633365718494, 2.741395056463719)): shape (37, 800, 800)
      Valid pixels: 84340/640000 (13.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=294756, num_faces=294804
      Valid probs shape: (37, 84340)
    ✓ Random_6 (pose=(-1.998711025928707, 2.4770777652278335, 1.8072187779299451)): shape (37, 800, 800)
      Valid pixels: 79516/640000 (12.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=294673, num_faces=294804
      Valid probs shape: (37, 79516)
    ✓ Random_7 (pose=(-0.24540169203092965, 2.950060969928379, -2.8575877892960673)): shape (37, 800, 800)
      Valid pixels: 49458/640000 (7.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4555, max=294795, num_faces=294804
      Valid probs shape: (37, 49458)
    ✓ Random_8 (pose=(2.35241594300179, -1.979104584598305, 1.7116245851024008)): shape (37, 800, 800)
      Valid pixels: 88657/640000 (13.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=293723, num_faces=294804
      Valid probs shape: (37, 88657)
    ✓ Random_9 (pose=(2.4320916816008875, 1.9697377857660978, 0.766475597797514)): shape (37, 800, 800)
      Valid pixels: 94186/640000 (14.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=294738, num_faces=294804
      Valid probs shape: (37, 94186)
    ✓ Random_10 (pose=(2.288491131990109, -3.1350816016544223, 0.8573644094103825)): shape (37, 800, 800)
      Valid pixels: 65640/640000 (10.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=294726, num_faces=294804
      Valid probs shape: (37, 65640)
    ✓ Random_11 (pose=(-0.14682407627347294, 1.0362865339377016, -1.015559000109667)): shape (37, 800, 800)
      Valid pixels: 71737/640000 (11.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=294761, num_faces=294804
      Valid probs shape: (37, 71737)
    ✓ Random_12 (pose=(0.13395936858365243, 1.7205916340523455, 0.8198766502740376)): shape (37, 800, 800)
      Valid pixels: 87987/640000 (13.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=10, max=294782, num_faces=294804
      Valid probs shape: (37, 87987)
    ✓ Random_13 (pose=(2.49283060406327, -0.6296832690477223, 0.6459769163088764)): shape (37, 800, 800)
      Valid pixels: 58223/640000 (9.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5792, max=294797, num_faces=294804
      Valid probs shape: (37, 58223)
    ✓ Random_14 (pose=(0.04876171364588355, 1.3001575556986618, 2.435960387885615)): shape (37, 800, 800)
      Valid pixels: 69428/640000 (10.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=6, max=294778, num_faces=294804
      Valid probs shape: (37, 69428)
    ✓ Random_15 (pose=(-2.232932364855611, 3.0300529826673737, -0.8416226730743728)): shape (37, 800, 800)
      Valid pixels: 75967/640000 (11.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=293625, num_faces=294804
      Valid probs shape: (37, 75967)
    ✓ Random_16 (pose=(-2.136454293519578, -2.140888179141382, 2.756206444269621)): shape (37, 800, 800)
      Valid pixels: 86104/640000 (13.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=294673, num_faces=294804
      Valid probs shape: (37, 86104)
    ✓ Random_17 (pose=(1.1663525580904306, 0.14217797233369156, -2.7075588520398717)): shape (37, 800, 800)
      Valid pixels: 71131/640000 (11.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=294795, num_faces=294804
      Valid probs shape: (37, 71131)
    ✓ Random_18 (pose=(0.10071054163301207, 0.9548015504610374, 0.6035492810656193)): shape (37, 800, 800)
      Valid pixels: 71633/640000 (11.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=293584, num_faces=294804
      Valid probs shape: (37, 71633)
    ✓ Random_19 (pose=(-1.3237373991461598, 0.512076748182337, -0.7762581171672971)): shape (37, 800, 800)
      Valid pixels: 86047/640000 (13.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=294375, num_faces=294804
      Valid probs shape: (37, 86047)
    P stats: min=0.0000, max=1.0000, mean=0.0237
    Non-zero vertices: 129441/147404
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 17963  1753   864  2845     0  2199  1150  4491  6989]
  Ground Truth Stats:
    Labels shape: (147404,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-8/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6918
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7532
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7534

  RESULTS:
  RAW:         median(top-10)=0.8578, mean(top-10)=0.8632, median(all)=0.7642, mean(all)=0.6918
  + SMOOTHING: median(top-10)=0.9005, mean(top-10)=0.9028, median(all)=0.8169, mean(all)=0.7532 [+0.0427]
  + MRF:       median(top-10)=0.9008, mean(top-10)=0.9030, median(all)=0.8180, mean(all)=0.7534 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0430

================================================================================
Subject: NKI-TRT-20-9
================================================================================
  Step 0: Generating predictions with V2 model (20 random views)...
  Mesh: 141802 vertices, 283600 faces
  Generating 20 random views...
  Generating predictions for 20 views (continuous camera pose)...
    ✓ Random_0 (pose=(2.3841440227522597, 2.6050094214440564, -0.26114734557442754)): shape (37, 800, 800)
      Valid pixels: 80493/640000 (12.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=283513, num_faces=283600
      Valid probs shape: (37, 80493)
    ✓ Random_1 (pose=(-1.3533577011739124, 2.191696843790215, 2.648220534548579)): shape (37, 800, 800)
      Valid pixels: 104952/640000 (16.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=20, max=283514, num_faces=283600
      Valid probs shape: (37, 104952)
    ✓ Random_2 (pose=(-0.7134093734544429, -1.8949943981032722, 0.4316579781636123)): shape (37, 800, 800)
      Valid pixels: 67980/640000 (10.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=677, max=283599, num_faces=283600
      Valid probs shape: (37, 67980)
    ✓ Random_3 (pose=(2.83395378255398, 3.01090706896595, 2.675744740951459)): shape (37, 800, 800)
      Valid pixels: 55997/640000 (8.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=280393, num_faces=283600
      Valid probs shape: (37, 55997)
    ✓ Random_4 (pose=(1.5992407357511773, 1.8136381939113138, -2.6009503764834117)): shape (37, 800, 800)
      Valid pixels: 84440/640000 (13.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=94, max=283597, num_faces=283600
      Valid probs shape: (37, 84440)
    ✓ Random_5 (pose=(1.1777660629264233, -2.873996903462375, -0.7217787371699451)): shape (37, 800, 800)
      Valid pixels: 95486/640000 (14.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=61, max=283513, num_faces=283600
      Valid probs shape: (37, 95486)
    ✓ Random_6 (pose=(-1.5252760394310447, -0.23499821981596503, 0.926132192274352)): shape (37, 800, 800)
      Valid pixels: 72145/640000 (11.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=204, max=283599, num_faces=283600
      Valid probs shape: (37, 72145)
    ✓ Random_7 (pose=(1.2324994295410079, 0.7845298700327867, -0.7142369314983377)): shape (37, 800, 800)
      Valid pixels: 104998/640000 (16.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=27, max=283514, num_faces=283600
      Valid probs shape: (37, 104998)
    ✓ Random_8 (pose=(0.3213106757961537, -2.5357928222028243, -1.901471004972029)): shape (37, 800, 800)
      Valid pixels: 77200/640000 (12.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8500, max=283599, num_faces=283600
      Valid probs shape: (37, 77200)
    ✓ Random_9 (pose=(-1.7146783094086724, 2.8761004579081364, -0.012536028087615225)): shape (37, 800, 800)
      Valid pixels: 98781/640000 (15.4%)
      Probs stats: min=0.0000, max=0.9995, mean=0.0270
      Face IDs: min=6, max=283593, num_faces=283600
      Valid probs shape: (37, 98781)
    ✓ Random_10 (pose=(0.6353999907518224, -2.986436348167751, 2.4525113998207573)): shape (37, 800, 800)
      Valid pixels: 71585/640000 (11.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5041, max=283589, num_faces=283600
      Valid probs shape: (37, 71585)
    ✓ Random_11 (pose=(0.23115308017379466, -2.95079882741257, 1.9750481890326066)): shape (37, 800, 800)
      Valid pixels: 46015/640000 (7.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6586, max=283589, num_faces=283600
      Valid probs shape: (37, 46015)
    ✓ Random_12 (pose=(1.7709024169351357, -1.5602299028929358, 0.3657860256162002)): shape (37, 800, 800)
      Valid pixels: 87817/640000 (13.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=20, max=283563, num_faces=283600
      Valid probs shape: (37, 87817)
    ✓ Random_13 (pose=(1.246925935667309, 0.4845016612153188, 0.7690680425287999)): shape (37, 800, 800)
      Valid pixels: 71740/640000 (11.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=283563, num_faces=283600
      Valid probs shape: (37, 71740)
    ✓ Random_14 (pose=(-1.9416328244977266, 2.5941447797158466, -0.126777429181951)): shape (37, 800, 800)
      Valid pixels: 94507/640000 (14.8%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=0, max=283595, num_faces=283600
      Valid probs shape: (37, 94507)
    ✓ Random_15 (pose=(-1.4228117491549248, 0.28506153786001676, -0.14709108428721152)): shape (37, 800, 800)
      Valid pixels: 102680/640000 (16.0%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=1, max=283593, num_faces=283600
      Valid probs shape: (37, 102680)
    ✓ Random_16 (pose=(-2.236582456285416, 2.4269691044782604, 1.1366951140789618)): shape (37, 800, 800)
      Valid pixels: 57266/640000 (8.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=283599, num_faces=283600
      Valid probs shape: (37, 57266)
    ✓ Random_17 (pose=(1.3299826728054551, 1.911195503609095, 2.1613680443631367)): shape (37, 800, 800)
      Valid pixels: 99131/640000 (15.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=30, max=283589, num_faces=283600
      Valid probs shape: (37, 99131)
    ✓ Random_18 (pose=(1.8054376697123509, 2.006846084532473, 1.795786875910772)): shape (37, 800, 800)
      Valid pixels: 59740/640000 (9.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=20, max=283563, num_faces=283600
      Valid probs shape: (37, 59740)
    ✓ Random_19 (pose=(2.44055406902073, -1.3989701124739011, -1.105548320265791)): shape (37, 800, 800)
      Valid pixels: 110054/640000 (17.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=49, max=283513, num_faces=283600
      Valid probs shape: (37, 110054)
    P stats: min=0.0000, max=1.0000, mean=0.0249
    Non-zero vertices: 130741/141802
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 11061  1384  1032  3214     0  2156   794  4708  7219]
  Ground Truth Stats:
    Labels shape: (141802,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-9/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7631
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8145
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8146

  RESULTS:
  RAW:         median(top-10)=0.9031, mean(top-10)=0.8985, median(all)=0.8039, mean(all)=0.7631
  + SMOOTHING: median(top-10)=0.9251, mean(top-10)=0.9210, median(all)=0.8692, mean(all)=0.8145 [+0.0220]
  + MRF:       median(top-10)=0.9256, mean(top-10)=0.9212, median(all)=0.8698, mean(all)=0.8146 [+0.0005]
  TOTAL IMPROVEMENT (median top-10): +0.0225

================================================================================
Subject: OASIS-TRT-20-1
================================================================================
  Step 0: Generating predictions with V2 model (20 random views)...
  Mesh: 149052 vertices, 298100 faces
  Generating 20 random views...
  Generating predictions for 20 views (continuous camera pose)...
    ✓ Random_0 (pose=(0.5555994646653026, -1.3581803036516733, -2.6951674131214083)): shape (37, 800, 800)
      Valid pixels: 83270/640000 (13.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=298098, num_faces=298100
      Valid probs shape: (37, 83270)
    ✓ Random_1 (pose=(2.327975592094841, -0.1337987077558953, -2.054643142356152)): shape (37, 800, 800)
      Valid pixels: 48834/640000 (7.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=795, max=298099, num_faces=298100
      Valid probs shape: (37, 48834)
    ✓ Random_2 (pose=(-1.8942539058929582, 2.4821977852923247, 1.5625874265968642)): shape (37, 800, 800)
      Valid pixels: 64519/640000 (10.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6, max=297997, num_faces=298100
      Valid probs shape: (37, 64519)
    ✓ Random_3 (pose=(0.6232468070378996, 2.889388625051904, 0.1963484683701422)): shape (37, 800, 800)
      Valid pixels: 51899/640000 (8.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=473, max=298099, num_faces=298100
      Valid probs shape: (37, 51899)
    ✓ Random_4 (pose=(-0.49263628641946866, 1.9674330232472128, 0.06936583126744145)): shape (37, 800, 800)
      Valid pixels: 77891/640000 (12.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=38, max=298098, num_faces=298100
      Valid probs shape: (37, 77891)
    ✓ Random_5 (pose=(-2.9202742067953795, 2.904424331060798, -2.0107457669907562)): shape (37, 800, 800)
      Valid pixels: 40287/640000 (6.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=297345, num_faces=298100
      Valid probs shape: (37, 40287)
    ✓ Random_6 (pose=(1.0015161987877246, 2.2019431799959275, 2.3574100479464715)): shape (37, 800, 800)
      Valid pixels: 82021/640000 (12.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=79, max=298098, num_faces=298100
      Valid probs shape: (37, 82021)
    ✓ Random_7 (pose=(-0.03212138043365842, -1.2057945903390817, 2.1731398985782278)): shape (37, 800, 800)
      Valid pixels: 64364/640000 (10.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=298099, num_faces=298100
      Valid probs shape: (37, 64364)
    ✓ Random_8 (pose=(2.8386513045125783, -0.6178232727872484, 0.25724322569388436)): shape (37, 800, 800)
      Valid pixels: 46639/640000 (7.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2716, max=298099, num_faces=298100
      Valid probs shape: (37, 46639)
    ✓ Random_9 (pose=(1.7990333390524764, -1.9208317689705179, 2.365923335947377)): shape (37, 800, 800)
      Valid pixels: 84523/640000 (13.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=298098, num_faces=298100
      Valid probs shape: (37, 84523)
    ✓ Random_10 (pose=(2.485639024938803, -0.7832830836507174, -0.8964740843325707)): shape (37, 800, 800)
      Valid pixels: 70655/640000 (11.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=298099, num_faces=298100
      Valid probs shape: (37, 70655)
    ✓ Random_11 (pose=(-0.4155796093615325, -1.1005374369520995, -0.08941113201154716)): shape (37, 800, 800)
      Valid pixels: 56938/640000 (8.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=297997, num_faces=298100
      Valid probs shape: (37, 56938)
    ✓ Random_12 (pose=(-0.4618352674229107, -2.404006735227166, 3.1215420787784263)): shape (37, 800, 800)
      Valid pixels: 53906/640000 (8.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=467, max=298099, num_faces=298100
      Valid probs shape: (37, 53906)
    ✓ Random_13 (pose=(0.022316365683051398, 2.206810357951139, 0.42430017191954494)): shape (37, 800, 800)
      Valid pixels: 65921/640000 (10.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=433, max=298098, num_faces=298100
      Valid probs shape: (37, 65921)
    ✓ Random_14 (pose=(-1.309561926868494, 1.0741900027890772, 2.675859008195779)): shape (37, 800, 800)
      Valid pixels: 86435/640000 (13.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=298099, num_faces=298100
      Valid probs shape: (37, 86435)
    ✓ Random_15 (pose=(-2.9576844543427843, 0.17734818423931475, -2.9868113031741315)): shape (37, 800, 800)
      Valid pixels: 39042/640000 (6.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7074, max=298099, num_faces=298100
      Valid probs shape: (37, 39042)
    ✓ Random_16 (pose=(-2.5035282665647682, -0.22935283222823877, -0.5640713633433014)): shape (37, 800, 800)
      Valid pixels: 64154/640000 (10.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=19815, max=298099, num_faces=298100
      Valid probs shape: (37, 64154)
    ✓ Random_17 (pose=(1.9561440924108906, -1.3667732950679403, -0.8471173286363953)): shape (37, 800, 800)
      Valid pixels: 87997/640000 (13.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=298099, num_faces=298100
      Valid probs shape: (37, 87997)
    ✓ Random_18 (pose=(-1.1323832997395331, -0.2845090367506895, -0.1206781307181437)): shape (37, 800, 800)
      Valid pixels: 70235/640000 (11.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=9, max=298088, num_faces=298100
      Valid probs shape: (37, 70235)
    ✓ Random_19 (pose=(-1.0634200428935667, 0.08091704333431338, 0.7121160202736312)): shape (37, 800, 800)
      Valid pixels: 57947/640000 (9.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=297995, num_faces=298100
      Valid probs shape: (37, 57947)
    P stats: min=0.0000, max=1.0000, mean=0.0246
    Non-zero vertices: 135713/149052
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 13339  1288  1216  3925     0  2062  1027  4805  6021]
  Ground Truth Stats:
    Labels shape: (149052,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-1/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7492
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8096
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8098

  RESULTS:
  RAW:         median(top-10)=0.8916, mean(top-10)=0.8961, median(all)=0.8224, mean(all)=0.7492
  + SMOOTHING: median(top-10)=0.9183, mean(top-10)=0.9253, median(all)=0.8702, mean(all)=0.8096 [+0.0267]
  + MRF:       median(top-10)=0.9190, mean(top-10)=0.9256, median(all)=0.8711, mean(all)=0.8098 [+0.0007]
  TOTAL IMPROVEMENT (median top-10): +0.0274

================================================================================
Subject: OASIS-TRT-20-10
================================================================================
  Step 0: Generating predictions with V2 model (20 random views)...
  Mesh: 129540 vertices, 259076 faces
  Generating 20 random views...
  Generating predictions for 20 views (continuous camera pose)...
    ✓ Random_0 (pose=(1.5523833586006432, 0.46395882768686514, 3.043049269159682)): shape (37, 800, 800)
      Valid pixels: 81981/640000 (12.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=259075, num_faces=259076
      Valid probs shape: (37, 81981)
    ✓ Random_1 (pose=(-2.882954225329107, 1.8605416888891764, 0.7167434274161089)): shape (37, 800, 800)
      Valid pixels: 76110/640000 (11.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6, max=259071, num_faces=259076
      Valid probs shape: (37, 76110)
    ✓ Random_2 (pose=(-2.3700472873675835, -1.0377695906016684, -2.5516362564947386)): shape (37, 800, 800)
      Valid pixels: 81162/640000 (12.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=259068, num_faces=259076
      Valid probs shape: (37, 81162)
    ✓ Random_3 (pose=(0.7326374199657257, -2.8235880573796046, 0.6010035534490936)): shape (37, 800, 800)
      Valid pixels: 62374/640000 (9.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=259072, num_faces=259076
      Valid probs shape: (37, 62374)
    ✓ Random_4 (pose=(-2.1847670062676876, 3.087855874376892, -0.3956082086445143)): shape (37, 800, 800)
      Valid pixels: 71173/640000 (11.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=255054, num_faces=259076
      Valid probs shape: (37, 71173)
    ✓ Random_5 (pose=(-1.8637652903682098, -0.4420242635494116, -1.576549126751038)): shape (37, 800, 800)
      Valid pixels: 55957/640000 (8.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=259074, num_faces=259076
      Valid probs shape: (37, 55957)
    ✓ Random_6 (pose=(-2.975478321871167, 2.2971958336478773, 0.783211830043657)): shape (37, 800, 800)
      Valid pixels: 68157/640000 (10.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=259070, num_faces=259076
      Valid probs shape: (37, 68157)
    ✓ Random_7 (pose=(-0.4879397741451603, 1.6152348171794157, 0.1011126019108235)): shape (37, 800, 800)
      Valid pixels: 79245/640000 (12.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=259074, num_faces=259076
      Valid probs shape: (37, 79245)
    ✓ Random_8 (pose=(0.35975612237292376, 2.4781199062952055, 1.6751975860487978)): shape (37, 800, 800)
      Valid pixels: 74466/640000 (11.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=23066, max=259071, num_faces=259076
      Valid probs shape: (37, 74466)
    ✓ Random_9 (pose=(0.5803707396748856, 1.6364628170195763, -0.7244731736888612)): shape (37, 800, 800)
      Valid pixels: 80722/640000 (12.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=259071, num_faces=259076
      Valid probs shape: (37, 80722)
    ✓ Random_10 (pose=(-3.027353156566686, 0.17602805373909503, -2.0005942944959494)): shape (37, 800, 800)
      Valid pixels: 49047/640000 (7.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=68422, max=259075, num_faces=259076
      Valid probs shape: (37, 49047)
    ✓ Random_11 (pose=(0.26898720022566636, 1.8128386809943908, -0.8551457369044817)): shape (37, 800, 800)
      Valid pixels: 74310/640000 (11.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6, max=259074, num_faces=259076
      Valid probs shape: (37, 74310)
    ✓ Random_12 (pose=(-2.3922059289370505, 1.0736948684684853, 1.5230546355072425)): shape (37, 800, 800)
      Valid pixels: 78586/640000 (12.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=40, max=259072, num_faces=259076
      Valid probs shape: (37, 78586)
    ✓ Random_13 (pose=(-2.6455515930873243, -2.9077533776269937, -2.3371059440465283)): shape (37, 800, 800)
      Valid pixels: 54185/640000 (8.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=258996, num_faces=259076
      Valid probs shape: (37, 54185)
    ✓ Random_14 (pose=(0.9245813499708353, -1.079048568277765, 3.123149765057751)): shape (37, 800, 800)
      Valid pixels: 81167/640000 (12.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=259057, num_faces=259076
      Valid probs shape: (37, 81167)
    ✓ Random_15 (pose=(2.6468634914152025, -2.2718973336919897, 0.37447670925149)): shape (37, 800, 800)
      Valid pixels: 50596/640000 (7.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=258988, num_faces=259076
      Valid probs shape: (37, 50596)
    ✓ Random_16 (pose=(1.2555144043836028, -1.3976459770812795, -1.6419729872994935)): shape (37, 800, 800)
      Valid pixels: 61901/640000 (9.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=258999, num_faces=259076
      Valid probs shape: (37, 61901)
    ✓ Random_17 (pose=(2.7348520574078163, 2.9316478052862767, 2.240497956720067)): shape (37, 800, 800)
      Valid pixels: 44129/640000 (6.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=219214, num_faces=259076
      Valid probs shape: (37, 44129)
    ✓ Random_18 (pose=(2.41232022613349, -0.793574402728126, 1.775455310498062)): shape (37, 800, 800)
      Valid pixels: 81117/640000 (12.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=849, max=259069, num_faces=259076
      Valid probs shape: (37, 81117)
    ✓ Random_19 (pose=(0.7406900001316861, 0.9745898679628526, -2.770788685615068)): shape (37, 800, 800)
      Valid pixels: 60356/640000 (9.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8, max=258999, num_faces=259076
      Valid probs shape: (37, 60356)
    P stats: min=0.0000, max=1.0000, mean=0.0248
    Non-zero vertices: 118700/129540
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 10840  1017  1048  3819     0  2082  1162  4300  6287]
  Ground Truth Stats:
    Labels shape: (129540,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-10/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7653
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8273
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8277

  RESULTS:
  RAW:         median(top-10)=0.9004, mean(top-10)=0.9013, median(all)=0.8313, mean(all)=0.7653
  + SMOOTHING: median(top-10)=0.9310, mean(top-10)=0.9296, median(all)=0.8695, mean(all)=0.8273 [+0.0306]
  + MRF:       median(top-10)=0.9314, mean(top-10)=0.9300, median(all)=0.8703, mean(all)=0.8277 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0310

================================================================================
Subject: OASIS-TRT-20-11
================================================================================
  Step 0: Generating predictions with V2 model (20 random views)...
  Mesh: 146531 vertices, 293058 faces
  Generating 20 random views...
  Generating predictions for 20 views (continuous camera pose)...
    ✓ Random_0 (pose=(2.5774809270427417, 2.42799700407566, 2.173278167060346)): shape (37, 800, 800)
      Valid pixels: 53882/640000 (8.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=293056, num_faces=293058
      Valid probs shape: (37, 53882)
    ✓ Random_1 (pose=(1.9674305327233892, -0.3137604831532612, 0.32115329962485584)): shape (37, 800, 800)
      Valid pixels: 82115/640000 (12.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=293057, num_faces=293058
      Valid probs shape: (37, 82115)
    ✓ Random_2 (pose=(2.239575288022899, 0.008280969140035843, -0.8640060294193237)): shape (37, 800, 800)
      Valid pixels: 75754/640000 (11.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=95, max=293057, num_faces=293058
      Valid probs shape: (37, 75754)
    ✓ Random_3 (pose=(2.0037312556129203, 1.051748580685592, 3.11741721064614)): shape (37, 800, 800)
      Valid pixels: 93297/640000 (14.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=138, max=292595, num_faces=293058
      Valid probs shape: (37, 93297)
    ✓ Random_4 (pose=(1.01655621442064, 3.006333370309422, -0.2232070344211512)): shape (37, 800, 800)
      Valid pixels: 86164/640000 (13.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=34, max=293057, num_faces=293058
      Valid probs shape: (37, 86164)
    ✓ Random_5 (pose=(-0.8583252104515564, 2.9042516704028003, -0.2213755708800833)): shape (37, 800, 800)
      Valid pixels: 83825/640000 (13.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=5963, max=293053, num_faces=293058
      Valid probs shape: (37, 83825)
    ✓ Random_6 (pose=(1.6245707515947734, -3.066197123957312, 2.1486137611112035)): shape (37, 800, 800)
      Valid pixels: 84503/640000 (13.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=37, max=292498, num_faces=293058
      Valid probs shape: (37, 84503)
    ✓ Random_7 (pose=(0.9997612695011702, 1.3886370823828917, -0.7497982625159851)): shape (37, 800, 800)
      Valid pixels: 99481/640000 (15.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=293055, num_faces=293058
      Valid probs shape: (37, 99481)
    ✓ Random_8 (pose=(-2.9995471936175173, -1.0350129723875563, -1.7670162026492668)): shape (37, 800, 800)
      Valid pixels: 86290/640000 (13.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=33, max=293057, num_faces=293058
      Valid probs shape: (37, 86290)
    ✓ Random_9 (pose=(-2.2980446141804443, 0.6698527703281747, -3.0405289942799367)): shape (37, 800, 800)
      Valid pixels: 73206/640000 (11.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=36, max=293057, num_faces=293058
      Valid probs shape: (37, 73206)
    ✓ Random_10 (pose=(1.2875746193064268, -3.006015665116135, 1.1274549117770105)): shape (37, 800, 800)
      Valid pixels: 65556/640000 (10.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=293057, num_faces=293058
      Valid probs shape: (37, 65556)
    ✓ Random_11 (pose=(0.3376368777592078, 2.3850940138945287, -3.089124971900149)): shape (37, 800, 800)
      Valid pixels: 60272/640000 (9.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1780, max=293056, num_faces=293058
      Valid probs shape: (37, 60272)
    ✓ Random_12 (pose=(-2.136295141457201, 0.5049934007251258, 1.4033053124133819)): shape (37, 800, 800)
      Valid pixels: 60926/640000 (9.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=125, max=293055, num_faces=293058
      Valid probs shape: (37, 60926)
    ✓ Random_13 (pose=(0.4231706672463402, -0.22354960561241688, -2.6512223594332474)): shape (37, 800, 800)
      Valid pixels: 59153/640000 (9.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=292530, num_faces=293058
      Valid probs shape: (37, 59153)
    ✓ Random_14 (pose=(-1.356487512947648, 0.715028223609167, 1.1126572553625858)): shape (37, 800, 800)
      Valid pixels: 69299/640000 (10.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=3, max=293056, num_faces=293058
      Valid probs shape: (37, 69299)
    ✓ Random_15 (pose=(0.6284633676828011, 1.17489689889626, -0.01435442273457177)): shape (37, 800, 800)
      Valid pixels: 69986/640000 (10.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=293055, num_faces=293058
      Valid probs shape: (37, 69986)
    ✓ Random_16 (pose=(-0.26447385911934695, 0.6559191914242426, 3.1326763020090596)): shape (37, 800, 800)
      Valid pixels: 59907/640000 (9.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=293057, num_faces=293058
      Valid probs shape: (37, 59907)
    ✓ Random_17 (pose=(-2.2476539192398275, 0.07623009781252321, -0.2547449435325091)): shape (37, 800, 800)
      Valid pixels: 83634/640000 (13.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4023, max=293053, num_faces=293058
      Valid probs shape: (37, 83634)
    ✓ Random_18 (pose=(-0.15980418313694011, 2.9296023640918927, -2.541317776020576)): shape (37, 800, 800)
      Valid pixels: 46777/640000 (7.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2503, max=293057, num_faces=293058
      Valid probs shape: (37, 46777)
    ✓ Random_19 (pose=(0.09091182295839317, -1.8960732970642475, -1.913076244719792)): shape (37, 800, 800)
      Valid pixels: 91291/640000 (14.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=240, max=293056, num_faces=293058
      Valid probs shape: (37, 91291)
    P stats: min=0.0000, max=1.0000, mean=0.0238
    Non-zero vertices: 129031/146531
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 17500  1189  1162  3361     0  2561   948  4770  6724]
  Ground Truth Stats:
    Labels shape: (146531,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-11/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
    MRF iteration 5/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7657
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8392
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8393

  RESULTS:
  RAW:         median(top-10)=0.8845, mean(top-10)=0.8903, median(all)=0.8199, mean(all)=0.7657
  + SMOOTHING: median(top-10)=0.9229, mean(top-10)=0.9254, median(all)=0.8791, mean(all)=0.8392 [+0.0384]
  + MRF:       median(top-10)=0.9231, mean(top-10)=0.9256, median(all)=0.8789, mean(all)=0.8393 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0386

================================================================================
Subject: OASIS-TRT-20-12
================================================================================
  Step 0: Generating predictions with V2 model (20 random views)...
  Mesh: 144559 vertices, 289114 faces
  Generating 20 random views...
  Generating predictions for 20 views (continuous camera pose)...
    ✓ Random_0 (pose=(-1.956020164035494, 2.571898970537206, 0.9435512285640959)): shape (37, 800, 800)
      Valid pixels: 61020/640000 (9.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=288952, num_faces=289114
      Valid probs shape: (37, 61020)
    ✓ Random_1 (pose=(2.805314645753839, -0.5341809970641749, 1.9911854519007566)): shape (37, 800, 800)
      Valid pixels: 67608/640000 (10.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=20891, max=289113, num_faces=289114
      Valid probs shape: (37, 67608)
    ✓ Random_2 (pose=(-2.3757499794750894, -1.0833645080516354, 0.8447876427099961)): shape (37, 800, 800)
      Valid pixels: 79881/640000 (12.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=751, max=289113, num_faces=289114
      Valid probs shape: (37, 79881)
    ✓ Random_3 (pose=(-2.872994641254411, -1.740223801566848, 1.5921633182543564)): shape (37, 800, 800)
      Valid pixels: 74519/640000 (11.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=289112, num_faces=289114
      Valid probs shape: (37, 74519)
    ✓ Random_4 (pose=(1.150867281407927, 0.19397137556030009, -3.0256232361126263)): shape (37, 800, 800)
      Valid pixels: 71312/640000 (11.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8, max=289109, num_faces=289114
      Valid probs shape: (37, 71312)
    ✓ Random_5 (pose=(2.3738531616010947, -1.8986940694050891, -1.8384952935459853)): shape (37, 800, 800)
      Valid pixels: 75587/640000 (11.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=288988, num_faces=289114
      Valid probs shape: (37, 75587)
    ✓ Random_6 (pose=(2.3542590767434186, 0.6695441080255824, -1.5403844758913496)): shape (37, 800, 800)
      Valid pixels: 55725/640000 (8.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=149, max=289110, num_faces=289114
      Valid probs shape: (37, 55725)
    ✓ Random_7 (pose=(0.8758941939007823, -0.34064433014183626, 2.325335324087514)): shape (37, 800, 800)
      Valid pixels: 58389/640000 (9.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=289067, num_faces=289114
      Valid probs shape: (37, 58389)
    ✓ Random_8 (pose=(2.1122886021396523, 1.2247136981715583, -1.7097623720243909)): shape (37, 800, 800)
      Valid pixels: 63949/640000 (10.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=128, max=289113, num_faces=289114
      Valid probs shape: (37, 63949)
    ✓ Random_9 (pose=(-2.0446765542572574, 3.0825652091309603, -2.070469598093414)): shape (37, 800, 800)
      Valid pixels: 54208/640000 (8.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=288984, num_faces=289114
      Valid probs shape: (37, 54208)
    ✓ Random_10 (pose=(-0.1515915864819375, -0.9174982260592706, 0.03758209455320349)): shape (37, 800, 800)
      Valid pixels: 53445/640000 (8.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=288954, num_faces=289114
      Valid probs shape: (37, 53445)
    ✓ Random_11 (pose=(0.03473598297685543, 0.8462016754359216, -0.5500892872893717)): shape (37, 800, 800)
      Valid pixels: 52125/640000 (8.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=288984, num_faces=289114
      Valid probs shape: (37, 52125)
    ✓ Random_12 (pose=(2.595086295336303, 2.27618001396998, -1.2682279607494138)): shape (37, 800, 800)
      Valid pixels: 59533/640000 (9.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=288952, num_faces=289114
      Valid probs shape: (37, 59533)
    ✓ Random_13 (pose=(-1.9989989395168606, 1.9701173055968741, -2.4206746134810975)): shape (37, 800, 800)
      Valid pixels: 58626/640000 (9.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=289053, num_faces=289114
      Valid probs shape: (37, 58626)
    ✓ Random_14 (pose=(2.293684924632778, -1.2719870110652753, -1.2829607792809399)): shape (37, 800, 800)
      Valid pixels: 85279/640000 (13.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=71, max=288988, num_faces=289114
      Valid probs shape: (37, 85279)
    ✓ Random_15 (pose=(1.3361712034535218, 0.30496904664871094, 2.813945360406162)): shape (37, 800, 800)
      Valid pixels: 81382/640000 (12.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=15, max=289065, num_faces=289114
      Valid probs shape: (37, 81382)
    ✓ Random_16 (pose=(-0.27330586092094666, -2.319758817534673, -2.485069774607024)): shape (37, 800, 800)
      Valid pixels: 60444/640000 (9.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4157, max=289113, num_faces=289114
      Valid probs shape: (37, 60444)
    ✓ Random_17 (pose=(-0.014831779599495665, 1.3705422713592137, 1.1787681066078735)): shape (37, 800, 800)
      Valid pixels: 82417/640000 (12.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=10, max=289111, num_faces=289114
      Valid probs shape: (37, 82417)
    ✓ Random_18 (pose=(-1.8667547949152237, 1.6117962211698327, -2.6773266099171105)): shape (37, 800, 800)
      Valid pixels: 66764/640000 (10.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=289041, num_faces=289114
      Valid probs shape: (37, 66764)
    ✓ Random_19 (pose=(-1.4941361716078438, 0.6074280531448162, 1.0556751389882653)): shape (37, 800, 800)
      Valid pixels: 63967/640000 (10.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=74, max=289103, num_faces=289114
      Valid probs shape: (37, 63967)
    P stats: min=0.0000, max=1.0000, mean=0.0245
    Non-zero vertices: 131221/144559
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 13338  1506  1138  3006     0  2358   882  4988  5563]
  Ground Truth Stats:
    Labels shape: (144559,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-12/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7549
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8166
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8169

  RESULTS:
  RAW:         median(top-10)=0.8770, mean(top-10)=0.8820, median(all)=0.7866, mean(all)=0.7549
  + SMOOTHING: median(top-10)=0.9069, mean(top-10)=0.9123, median(all)=0.8439, mean(all)=0.8166 [+0.0299]
  + MRF:       median(top-10)=0.9073, mean(top-10)=0.9124, median(all)=0.8448, mean(all)=0.8169 [+0.0004]
  TOTAL IMPROVEMENT (median top-10): +0.0303

================================================================================
Subject: OASIS-TRT-20-13
================================================================================
  Step 0: Generating predictions with V2 model (20 random views)...
  Mesh: 122339 vertices, 244674 faces
  Generating 20 random views...
  Generating predictions for 20 views (continuous camera pose)...
    ✓ Random_0 (pose=(0.72296441469984, 1.9487513350188532, -1.9543908787648805)): shape (37, 800, 800)
      Valid pixels: 74590/640000 (11.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=190, max=244673, num_faces=244674
      Valid probs shape: (37, 74590)
    ✓ Random_1 (pose=(-0.33963744864868417, 1.6602225117459382, 2.453870242726895)): shape (37, 800, 800)
      Valid pixels: 65195/640000 (10.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=185, max=244673, num_faces=244674
      Valid probs shape: (37, 65195)
    ✓ Random_2 (pose=(-0.8782278164397193, -0.6013719436454084, -0.5930746394296422)): shape (37, 800, 800)
      Valid pixels: 82311/640000 (12.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=244577, num_faces=244674
      Valid probs shape: (37, 82311)
    ✓ Random_3 (pose=(-0.6806417424740894, -1.1587061038665625, -2.672835268835288)): shape (37, 800, 800)
      Valid pixels: 58901/640000 (9.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=244596, num_faces=244674
      Valid probs shape: (37, 58901)
    ✓ Random_4 (pose=(-2.2571788410762412, 0.2989001838120804, -1.7084504952297195)): shape (37, 800, 800)
      Valid pixels: 54219/640000 (8.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1031, max=244671, num_faces=244674
      Valid probs shape: (37, 54219)
    ✓ Random_5 (pose=(0.829441655077185, -2.1855789861480748, 2.7077898803423066)): shape (37, 800, 800)
      Valid pixels: 70725/640000 (11.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=10, max=244671, num_faces=244674
      Valid probs shape: (37, 70725)
    ✓ Random_6 (pose=(-1.7982100044704021, 1.108880621788722, 0.9549898132422605)): shape (37, 800, 800)
      Valid pixels: 65828/640000 (10.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=218, max=244673, num_faces=244674
      Valid probs shape: (37, 65828)
    ✓ Random_7 (pose=(0.8748280339458612, -1.8965665498884037, 1.3232060992394947)): shape (37, 800, 800)
      Valid pixels: 77703/640000 (12.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=48, max=244602, num_faces=244674
      Valid probs shape: (37, 77703)
    ✓ Random_8 (pose=(0.9654479296448049, 0.8655578422304888, -2.44965448840708)): shape (37, 800, 800)
      Valid pixels: 65319/640000 (10.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=17, max=244673, num_faces=244674
      Valid probs shape: (37, 65319)
    ✓ Random_9 (pose=(2.7670123459188147, 0.4941762428820904, -2.4978829927890684)): shape (37, 800, 800)
      Valid pixels: 66853/640000 (10.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=22702, max=244672, num_faces=244674
      Valid probs shape: (37, 66853)
    ✓ Random_10 (pose=(-1.587422224318165, -2.346468799748494, -2.9194109929159904)): shape (37, 800, 800)
      Valid pixels: 91292/640000 (14.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=30, max=244602, num_faces=244674
      Valid probs shape: (37, 91292)
    ✓ Random_11 (pose=(2.0010683204260884, 1.6406302399907142, -3.109616470882389)): shape (37, 800, 800)
      Valid pixels: 91917/640000 (14.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=0, max=244673, num_faces=244674
      Valid probs shape: (37, 91917)
    ✓ Random_12 (pose=(0.2622929040090374, 0.0225440244198043, 2.4050324284891538)): shape (37, 800, 800)
      Valid pixels: 52078/640000 (8.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=243673, num_faces=244674
      Valid probs shape: (37, 52078)
    ✓ Random_13 (pose=(-2.8532403948331946, -0.6812999658021814, -2.1053576772594766)): shape (37, 800, 800)
      Valid pixels: 73111/640000 (11.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=112, max=244672, num_faces=244674
      Valid probs shape: (37, 73111)
    ✓ Random_14 (pose=(1.3356229438793754, 2.691243918530275, 0.7686764248391644)): shape (37, 800, 800)
      Valid pixels: 71887/640000 (11.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=29, max=244602, num_faces=244674
      Valid probs shape: (37, 71887)
    ✓ Random_15 (pose=(-2.4991921918784517, 1.2594840179186217, -0.5623631152250095)): shape (37, 800, 800)
      Valid pixels: 81945/640000 (12.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=439, max=244673, num_faces=244674
      Valid probs shape: (37, 81945)
    ✓ Random_16 (pose=(2.471593269943389, -0.505770878316965, 1.3480037418932156)): shape (37, 800, 800)
      Valid pixels: 56180/640000 (8.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=15152, max=244671, num_faces=244674
      Valid probs shape: (37, 56180)
    ✓ Random_17 (pose=(-0.21326785814041882, -1.0028270034414977, 1.0192939578934057)): shape (37, 800, 800)
      Valid pixels: 74141/640000 (11.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=244672, num_faces=244674
      Valid probs shape: (37, 74141)
    ✓ Random_18 (pose=(-2.9506826241817707, -2.779587176729976, -0.4529828571298897)): shape (37, 800, 800)
      Valid pixels: 47307/640000 (7.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=243674, num_faces=244674
      Valid probs shape: (37, 47307)
    ✓ Random_19 (pose=(-2.3357089094843153, 1.1846400017130936, 1.148683669437057)): shape (37, 800, 800)
      Valid pixels: 68879/640000 (10.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=175, max=244673, num_faces=244674
      Valid probs shape: (37, 68879)
    P stats: min=0.0000, max=1.0000, mean=0.0246
    Non-zero vertices: 111556/122339
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 10783  1167  1213  2941     0  1828  1076  4104  5614]
  Ground Truth Stats:
    Labels shape: (122339,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-13/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7551
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8214
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8213

  RESULTS:
  RAW:         median(top-10)=0.8802, mean(top-10)=0.8894, median(all)=0.8216, mean(all)=0.7551
  + SMOOTHING: median(top-10)=0.9062, mean(top-10)=0.9180, median(all)=0.8777, mean(all)=0.8214 [+0.0261]
  + MRF:       median(top-10)=0.9063, mean(top-10)=0.9180, median(all)=0.8780, mean(all)=0.8213 [+0.0000]
  TOTAL IMPROVEMENT (median top-10): +0.0261

================================================================================
Subject: OASIS-TRT-20-14
================================================================================
  Step 0: Generating predictions with V2 model (20 random views)...
  Mesh: 128019 vertices, 256034 faces
  Generating 20 random views...
  Generating predictions for 20 views (continuous camera pose)...
    ✓ Random_0 (pose=(-2.617386976228349, -0.9496069978567294, -1.8733108403093752)): shape (37, 800, 800)
      Valid pixels: 73109/640000 (11.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=170, max=255933, num_faces=256034
      Valid probs shape: (37, 73109)
    ✓ Random_1 (pose=(0.02550345055713743, -2.9864524311473732, 1.4882826994348344)): shape (37, 800, 800)
      Valid pixels: 39751/640000 (6.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=334, max=256033, num_faces=256034
      Valid probs shape: (37, 39751)
    ✓ Random_2 (pose=(2.619141049539466, -0.11301149769875307, 1.7555115102481231)): shape (37, 800, 800)
      Valid pixels: 55248/640000 (8.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=14676, max=256033, num_faces=256034
      Valid probs shape: (37, 55248)
    ✓ Random_3 (pose=(0.6872359081464565, -0.9824046302230216, -3.109323007589586)): shape (37, 800, 800)
      Valid pixels: 79692/640000 (12.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=255691, num_faces=256034
      Valid probs shape: (37, 79692)
    ✓ Random_4 (pose=(-0.9335339850613726, 2.9480971275017396, 1.387702545123621)): shape (37, 800, 800)
      Valid pixels: 53221/640000 (8.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=503, max=256030, num_faces=256034
      Valid probs shape: (37, 53221)
    ✓ Random_5 (pose=(2.254608275636352, 1.1985577916868069, 2.915776144164596)): shape (37, 800, 800)
      Valid pixels: 84209/640000 (13.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=7, max=255989, num_faces=256034
      Valid probs shape: (37, 84209)
    ✓ Random_6 (pose=(-2.417469286197299, -0.5834590074461907, -2.6049414544291416)): shape (37, 800, 800)
      Valid pixels: 73025/640000 (11.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=104, max=256029, num_faces=256034
      Valid probs shape: (37, 73025)
    ✓ Random_7 (pose=(0.11625172527274286, 0.6383790291761922, 0.7597985240986036)): shape (37, 800, 800)
      Valid pixels: 57162/640000 (8.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=255556, num_faces=256034
      Valid probs shape: (37, 57162)
    ✓ Random_8 (pose=(3.1082827698740205, -2.7260076432969558, -2.343748030185142)): shape (37, 800, 800)
      Valid pixels: 49770/640000 (7.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=255931, num_faces=256034
      Valid probs shape: (37, 49770)
    ✓ Random_9 (pose=(2.5068905505156502, -1.1749814819912907, -2.410326824506334)): shape (37, 800, 800)
      Valid pixels: 59262/640000 (9.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=102, max=256030, num_faces=256034
      Valid probs shape: (37, 59262)
    ✓ Random_10 (pose=(0.11193696755952276, 2.936097370658505, 1.5861230380530422)): shape (37, 800, 800)
      Valid pixels: 48202/640000 (7.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=59919, max=256033, num_faces=256034
      Valid probs shape: (37, 48202)
    ✓ Random_11 (pose=(-0.2921769857487466, -2.588652393431137, -2.337832335283883)): shape (37, 800, 800)
      Valid pixels: 55320/640000 (8.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=33718, max=256033, num_faces=256034
      Valid probs shape: (37, 55320)
    ✓ Random_12 (pose=(1.9411532605050237, 2.773674881363247, 2.855019178322177)): shape (37, 800, 800)
      Valid pixels: 84398/640000 (13.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=255973, num_faces=256034
      Valid probs shape: (37, 84398)
    ✓ Random_13 (pose=(-1.9267621717534258, 1.0520149462140216, -1.801109745303672)): shape (37, 800, 800)
      Valid pixels: 60515/640000 (9.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=29, max=255980, num_faces=256034
      Valid probs shape: (37, 60515)
    ✓ Random_14 (pose=(-1.3207117735248088, -0.6745193569880841, 2.986072818300377)): shape (37, 800, 800)
      Valid pixels: 88253/640000 (13.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=255933, num_faces=256034
      Valid probs shape: (37, 88253)
    ✓ Random_15 (pose=(-1.7359347064447739, 2.176524594364171, 3.0100819685191613)): shape (37, 800, 800)
      Valid pixels: 89426/640000 (14.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7, max=255933, num_faces=256034
      Valid probs shape: (37, 89426)
    ✓ Random_16 (pose=(0.9761164438319598, -1.630628266458238, 2.89910164107798)): shape (37, 800, 800)
      Valid pixels: 85799/640000 (13.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=12, max=255978, num_faces=256034
      Valid probs shape: (37, 85799)
    ✓ Random_17 (pose=(-0.8566929636328564, -2.503116288966976, 2.5400914264340573)): shape (37, 800, 800)
      Valid pixels: 80023/640000 (12.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=89, max=256029, num_faces=256034
      Valid probs shape: (37, 80023)
    ✓ Random_18 (pose=(1.7096634286845989, -0.032136632478103166, -1.7832768328210398)): shape (37, 800, 800)
      Valid pixels: 59135/640000 (9.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=39, max=256030, num_faces=256034
      Valid probs shape: (37, 59135)
    ✓ Random_19 (pose=(-2.2566288351436303, 1.4008228984230646, -0.21806688630011006)): shape (37, 800, 800)
      Valid pixels: 72026/640000 (11.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=65, max=256030, num_faces=256034
      Valid probs shape: (37, 72026)
    P stats: min=0.0000, max=1.0000, mean=0.0247
    Non-zero vertices: 117054/128019
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 10965  1344  1200  2961     0  1961  1030  3657  5480]
  Ground Truth Stats:
    Labels shape: (128019,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-14/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7582
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8189
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8192

  RESULTS:
  RAW:         median(top-10)=0.8802, mean(top-10)=0.8830, median(all)=0.8265, mean(all)=0.7582
  + SMOOTHING: median(top-10)=0.9129, mean(top-10)=0.9123, median(all)=0.8684, mean(all)=0.8189 [+0.0327]
  + MRF:       median(top-10)=0.9128, mean(top-10)=0.9122, median(all)=0.8688, mean(all)=0.8192 [-0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0327

================================================================================
Subject: OASIS-TRT-20-15
================================================================================
  Step 0: Generating predictions with V2 model (20 random views)...
  Mesh: 121081 vertices, 242158 faces
  Generating 20 random views...
  Generating predictions for 20 views (continuous camera pose)...
    ✓ Random_0 (pose=(-1.2885409667672605, 2.0242133278658363, 2.3382471330183607)): shape (37, 800, 800)
      Valid pixels: 71694/640000 (11.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=14, max=242156, num_faces=242158
      Valid probs shape: (37, 71694)
    ✓ Random_1 (pose=(-3.0282570225265912, -2.8981422262221948, 0.6597949402143439)): shape (37, 800, 800)
      Valid pixels: 45216/640000 (7.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=241821, num_faces=242158
      Valid probs shape: (37, 45216)
    ✓ Random_2 (pose=(1.2920805679783323, 1.2469697094925936, -0.8140544901028508)): shape (37, 800, 800)
      Valid pixels: 85007/640000 (13.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=15, max=242156, num_faces=242158
      Valid probs shape: (37, 85007)
    ✓ Random_3 (pose=(0.12752688309538662, -2.2401383091325164, -2.3889273532755473)): shape (37, 800, 800)
      Valid pixels: 70714/640000 (11.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4846, max=241827, num_faces=242158
      Valid probs shape: (37, 70714)
    ✓ Random_4 (pose=(0.4514066754844821, 0.7690990863252707, -0.6683799098944636)): shape (37, 800, 800)
      Valid pixels: 64332/640000 (10.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=242157, num_faces=242158
      Valid probs shape: (37, 64332)
    ✓ Random_5 (pose=(-0.4120466044666453, -0.15611256142366114, -2.495173074025824)): shape (37, 800, 800)
      Valid pixels: 40086/640000 (6.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=242157, num_faces=242158
      Valid probs shape: (37, 40086)
    ✓ Random_6 (pose=(0.24640833256894767, 0.4978463627628078, 2.7398577090132816)): shape (37, 800, 800)
      Valid pixels: 50690/640000 (7.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=241827, num_faces=242158
      Valid probs shape: (37, 50690)
    ✓ Random_7 (pose=(0.4065413105436315, 0.626671494673773, 2.1131020719333025)): shape (37, 800, 800)
      Valid pixels: 62528/640000 (9.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=241822, num_faces=242158
      Valid probs shape: (37, 62528)
    ✓ Random_8 (pose=(2.9235233190425935, 2.8026267573695502, -2.6887162856026836)): shape (37, 800, 800)
      Valid pixels: 49701/640000 (7.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=241816, num_faces=242158
      Valid probs shape: (37, 49701)
    ✓ Random_9 (pose=(0.09115428091926736, -0.10601946566576226, -0.5873590197442455)): shape (37, 800, 800)
      Valid pixels: 37999/640000 (5.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=242152, num_faces=242158
      Valid probs shape: (37, 37999)
    ✓ Random_10 (pose=(-1.3714144067280873, 0.4582979085943313, -1.484284030146474)): shape (37, 800, 800)
      Valid pixels: 49187/640000 (7.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=240823, num_faces=242158
      Valid probs shape: (37, 49187)
    ✓ Random_11 (pose=(-1.0315884207198138, 0.1378163219005084, -0.5211413286098461)): shape (37, 800, 800)
      Valid pixels: 73657/640000 (11.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=241776, num_faces=242158
      Valid probs shape: (37, 73657)
    ✓ Random_12 (pose=(2.1546195756444275, 2.7825813172393534, 0.012886713284546047)): shape (37, 800, 800)
      Valid pixels: 76162/640000 (11.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=242157, num_faces=242158
      Valid probs shape: (37, 76162)
    ✓ Random_13 (pose=(1.5945180449209984, -1.4899919197233065, -2.144431822119051)): shape (37, 800, 800)
      Valid pixels: 58511/640000 (9.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=230, max=242156, num_faces=242158
      Valid probs shape: (37, 58511)
    ✓ Random_14 (pose=(2.2160900127264167, 2.069011011945922, -2.206172386561852)): shape (37, 800, 800)
      Valid pixels: 68215/640000 (10.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=242146, num_faces=242158
      Valid probs shape: (37, 68215)
    ✓ Random_15 (pose=(-2.3307732166434842, -0.6334337144080107, 2.2004522770474004)): shape (37, 800, 800)
      Valid pixels: 48243/640000 (7.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=79, max=242156, num_faces=242158
      Valid probs shape: (37, 48243)
    ✓ Random_16 (pose=(1.4030217273380199, -2.3053565614944294, 2.019544187758327)): shape (37, 800, 800)
      Valid pixels: 62956/640000 (9.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=240824, num_faces=242158
      Valid probs shape: (37, 62956)
    ✓ Random_17 (pose=(-2.9722303465195687, -1.861236549583741, -0.5807864068405522)): shape (37, 800, 800)
      Valid pixels: 52274/640000 (8.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=242157, num_faces=242158
      Valid probs shape: (37, 52274)
    ✓ Random_18 (pose=(1.9780642362054328, 1.5767426695546147, -1.2373885928020854)): shape (37, 800, 800)
      Valid pixels: 53755/640000 (8.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=19, max=242156, num_faces=242158
      Valid probs shape: (37, 53755)
    ✓ Random_19 (pose=(1.0157453703743684, 1.2168164900190472, -3.1047337789870553)): shape (37, 800, 800)
      Valid pixels: 65435/640000 (10.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8, max=242151, num_faces=242158
      Valid probs shape: (37, 65435)
    P stats: min=0.0000, max=1.0000, mean=0.0238
    Non-zero vertices: 106678/121081
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 14403  1252  1096  2020     0  1594   750  4292  5222]
  Ground Truth Stats:
    Labels shape: (121081,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-15/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7261
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7884
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7885

  RESULTS:
  RAW:         median(top-10)=0.8844, mean(top-10)=0.8827, median(all)=0.7968, mean(all)=0.7261
  + SMOOTHING: median(top-10)=0.9028, mean(top-10)=0.9083, median(all)=0.8370, mean(all)=0.7884 [+0.0183]
  + MRF:       median(top-10)=0.9026, mean(top-10)=0.9086, median(all)=0.8372, mean(all)=0.7885 [-0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0182

================================================================================
Subject: OASIS-TRT-20-16
================================================================================
  Step 0: Generating predictions with V2 model (20 random views)...
  Mesh: 137726 vertices, 275448 faces
  Generating 20 random views...
  Generating predictions for 20 views (continuous camera pose)...
    ✓ Random_0 (pose=(-1.917295572944515, 1.295064625058191, 0.3530056494367786)): shape (37, 800, 800)
      Valid pixels: 82975/640000 (13.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=41, max=275342, num_faces=275448
      Valid probs shape: (37, 82975)
    ✓ Random_1 (pose=(-2.393995064341227, 0.8203805066290775, -2.413345387858794)): shape (37, 800, 800)
      Valid pixels: 59433/640000 (9.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2291, max=275447, num_faces=275448
      Valid probs shape: (37, 59433)
    ✓ Random_2 (pose=(-1.219297096479365, 0.06683903077502729, 0.8758724629070853)): shape (37, 800, 800)
      Valid pixels: 72421/640000 (11.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=5, max=275342, num_faces=275448
      Valid probs shape: (37, 72421)
    ✓ Random_3 (pose=(-3.1016019346171055, -0.02342135286968361, 2.1281489371330498)): shape (37, 800, 800)
      Valid pixels: 49607/640000 (7.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=11593, max=275446, num_faces=275448
      Valid probs shape: (37, 49607)
    ✓ Random_4 (pose=(0.0469975367085147, -2.122015389999426, -0.14787368091128172)): shape (37, 800, 800)
      Valid pixels: 71953/640000 (11.2%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=1171, max=275442, num_faces=275448
      Valid probs shape: (37, 71953)
    ✓ Random_5 (pose=(-1.5022909829588265, 0.5575094931429407, 0.8722607967344738)): shape (37, 800, 800)
      Valid pixels: 77808/640000 (12.2%)
      Probs stats: min=0.0000, max=0.9995, mean=0.0270
      Face IDs: min=23, max=275342, num_faces=275448
      Valid probs shape: (37, 77808)
    ✓ Random_6 (pose=(-1.4415589641664432, -2.6904081153570925, -0.1894324940724812)): shape (37, 800, 800)
      Valid pixels: 109580/640000 (17.1%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=118, max=275443, num_faces=275448
      Valid probs shape: (37, 109580)
    ✓ Random_7 (pose=(-2.9798687378419224, 2.809092654744063, -0.5758654541542318)): shape (37, 800, 800)
      Valid pixels: 57217/640000 (8.9%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=0, max=274930, num_faces=275448
      Valid probs shape: (37, 57217)
    ✓ Random_8 (pose=(-1.8431044383283133, 1.8369616423658055, -2.993293821187435)): shape (37, 800, 800)
      Valid pixels: 97190/640000 (15.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=275447, num_faces=275448
      Valid probs shape: (37, 97190)
    ✓ Random_9 (pose=(-2.874595116214025, -0.4021241998130134, -1.9706647865661542)): shape (37, 800, 800)
      Valid pixels: 64353/640000 (10.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=482, max=275446, num_faces=275448
      Valid probs shape: (37, 64353)
    ✓ Random_10 (pose=(-1.0845668115340392, -0.8380586418570397, 1.419674400929063)): shape (37, 800, 800)
      Valid pixels: 76657/640000 (12.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=275343, num_faces=275448
      Valid probs shape: (37, 76657)
    ✓ Random_11 (pose=(-2.5001150162358203, 2.966790540470245, -2.7999467206467243)): shape (37, 800, 800)
      Valid pixels: 73753/640000 (11.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=275447, num_faces=275448
      Valid probs shape: (37, 73753)
    ✓ Random_12 (pose=(0.28347603254667453, 2.6966231316641167, 0.6768844188879246)): shape (37, 800, 800)
      Valid pixels: 57404/640000 (9.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=35272, max=275444, num_faces=275448
      Valid probs shape: (37, 57404)
    ✓ Random_13 (pose=(-2.538601769509984, 1.8259700878810214, 0.6103204410258614)): shape (37, 800, 800)
      Valid pixels: 66914/640000 (10.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=23, max=275343, num_faces=275448
      Valid probs shape: (37, 66914)
    ✓ Random_14 (pose=(-1.1614015109806177, 1.4136532132079092, -2.534914938809812)): shape (37, 800, 800)
      Valid pixels: 107064/640000 (16.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=275447, num_faces=275448
      Valid probs shape: (37, 107064)
    ✓ Random_15 (pose=(-2.239015305960286, 1.5761881324137992, 2.5174786474082547)): shape (37, 800, 800)
      Valid pixels: 113360/640000 (17.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=275447, num_faces=275448
      Valid probs shape: (37, 113360)
    ✓ Random_16 (pose=(-2.4704200458054415, 1.3562401398558714, 1.4723038025191508)): shape (37, 800, 800)
      Valid pixels: 113885/640000 (17.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=4, max=275447, num_faces=275448
      Valid probs shape: (37, 113885)
    ✓ Random_17 (pose=(0.8930297778041174, 3.002799794627628, 2.41544907194747)): shape (37, 800, 800)
      Valid pixels: 96347/640000 (15.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=10329, max=275447, num_faces=275448
      Valid probs shape: (37, 96347)
    ✓ Random_18 (pose=(-1.6105402424894426, 3.0223947357918766, -2.486504841834614)): shape (37, 800, 800)
      Valid pixels: 86298/640000 (13.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=5, max=275447, num_faces=275448
      Valid probs shape: (37, 86298)
    ✓ Random_19 (pose=(-0.5139518378807773, 1.705262254723296, 0.2380042847058732)): shape (37, 800, 800)
      Valid pixels: 107742/640000 (16.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=122, max=275447, num_faces=275448
      Valid probs shape: (37, 107742)
    P stats: min=0.0000, max=1.0000, mean=0.0241
    Non-zero vertices: 122926/137726
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 14800  1170   964  3254     0  1752   955  4827  6064]
  Ground Truth Stats:
    Labels shape: (137726,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-16/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7469
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8142
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8144

  RESULTS:
  RAW:         median(top-10)=0.8781, mean(top-10)=0.8842, median(all)=0.7845, mean(all)=0.7469
  + SMOOTHING: median(top-10)=0.9108, mean(top-10)=0.9130, median(all)=0.8528, mean(all)=0.8142 [+0.0327]
  + MRF:       median(top-10)=0.9108, mean(top-10)=0.9132, median(all)=0.8531, mean(all)=0.8144 [+0.0000]
  TOTAL IMPROVEMENT (median top-10): +0.0327

================================================================================
Subject: OASIS-TRT-20-17
================================================================================
  Step 0: Generating predictions with V2 model (20 random views)...
  Mesh: 148245 vertices, 296486 faces
  Generating 20 random views...
  Generating predictions for 20 views (continuous camera pose)...
    ✓ Random_0 (pose=(-2.8881913453589627, -1.4122015154731935, -0.6428819919649906)): shape (37, 800, 800)
      Valid pixels: 69867/640000 (10.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=11, max=296477, num_faces=296486
      Valid probs shape: (37, 69867)
    ✓ Random_1 (pose=(0.8128367045695692, -1.0686110828730122, 0.6693086425315311)): shape (37, 800, 800)
      Valid pixels: 107160/640000 (16.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=296477, num_faces=296486
      Valid probs shape: (37, 107160)
    ✓ Random_2 (pose=(0.5160341876922563, -2.132466811914488, -2.3399574147250024)): shape (37, 800, 800)
      Valid pixels: 102018/640000 (15.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=251, max=296396, num_faces=296486
      Valid probs shape: (37, 102018)
    ✓ Random_3 (pose=(0.6337749952038436, 0.7569687478562805, 2.4139887237126976)): shape (37, 800, 800)
      Valid pixels: 96794/640000 (15.1%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=9, max=296396, num_faces=296486
      Valid probs shape: (37, 96794)
    ✓ Random_4 (pose=(-2.7316586765127457, -1.9798685151068247, 0.5691326442316447)): shape (37, 800, 800)
      Valid pixels: 109507/640000 (17.1%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=11, max=296396, num_faces=296486
      Valid probs shape: (37, 109507)
    ✓ Random_5 (pose=(1.3171681193129752, 0.42468410007923074, 0.12123797433285022)): shape (37, 800, 800)
      Valid pixels: 104297/640000 (16.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=296477, num_faces=296486
      Valid probs shape: (37, 104297)
    ✓ Random_6 (pose=(-0.1945179107795627, -0.5749656179723979, -1.5711004973920453)): shape (37, 800, 800)
      Valid pixels: 87202/640000 (13.6%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=1, max=294675, num_faces=296486
      Valid probs shape: (37, 87202)
    ✓ Random_7 (pose=(2.4688067834516865, -0.045414163421662934, -0.2196393271677941)): shape (37, 800, 800)
      Valid pixels: 89988/640000 (14.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=455, max=296485, num_faces=296486
      Valid probs shape: (37, 89988)
    ✓ Random_8 (pose=(1.1289955573483281, -0.8833198249853811, 0.32862349882113495)): shape (37, 800, 800)
      Valid pixels: 109575/640000 (17.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=296477, num_faces=296486
      Valid probs shape: (37, 109575)
    ✓ Random_9 (pose=(-1.3317915848595905, 1.1090424080887393, 1.6139179763690894)): shape (37, 800, 800)
      Valid pixels: 67134/640000 (10.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=8, max=296485, num_faces=296486
      Valid probs shape: (37, 67134)
    ✓ Random_10 (pose=(0.1154838018954698, 1.8390376889904392, 1.9438285730542795)): shape (37, 800, 800)
      Valid pixels: 97538/640000 (15.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=138, max=296396, num_faces=296486
      Valid probs shape: (37, 97538)
    ✓ Random_11 (pose=(-1.2929007197825104, 1.0974961046875489, -1.207353609380598)): shape (37, 800, 800)
      Valid pixels: 74006/640000 (11.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=296396, num_faces=296486
      Valid probs shape: (37, 74006)
    ✓ Random_12 (pose=(0.5306462791150284, -3.011721013072105, -2.8858589191098756)): shape (37, 800, 800)
      Valid pixels: 74857/640000 (11.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=16309, max=296485, num_faces=296486
      Valid probs shape: (37, 74857)
    ✓ Random_13 (pose=(-2.4873754007193387, -2.878248305702787, 0.44965112590361844)): shape (37, 800, 800)
      Valid pixels: 85026/640000 (13.3%)
      Probs stats: min=0.0000, max=0.9994, mean=0.0270
      Face IDs: min=1, max=294857, num_faces=296486
      Valid probs shape: (37, 85026)
    ✓ Random_14 (pose=(0.5886761758970089, -0.876523311251602, 1.6023977614322398)): shape (37, 800, 800)
      Valid pixels: 81666/640000 (12.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=296477, num_faces=296486
      Valid probs shape: (37, 81666)
    ✓ Random_15 (pose=(0.6566389314312837, 1.6466792072120038, 3.0903122713650664)): shape (37, 800, 800)
      Valid pixels: 77844/640000 (12.2%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=25, max=296418, num_faces=296486
      Valid probs shape: (37, 77844)
    ✓ Random_16 (pose=(-2.15829343608949, -1.8396240066780467, 1.9210401837285316)): shape (37, 800, 800)
      Valid pixels: 66394/640000 (10.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=15, max=296485, num_faces=296486
      Valid probs shape: (37, 66394)
    ✓ Random_17 (pose=(-0.11222155954401192, -1.6153486430007806, 0.6649917724040888)): shape (37, 800, 800)
      Valid pixels: 99475/640000 (15.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=21, max=296477, num_faces=296486
      Valid probs shape: (37, 99475)
    ✓ Random_18 (pose=(1.4582603571297712, 2.518589047973588, 3.0820390995451534)): shape (37, 800, 800)
      Valid pixels: 107093/640000 (16.7%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=0, max=296396, num_faces=296486
      Valid probs shape: (37, 107093)
    ✓ Random_19 (pose=(1.7591634172890531, 2.4416090103383636, 2.0140955241294396)): shape (37, 800, 800)
      Valid pixels: 87162/640000 (13.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=15, max=296396, num_faces=296486
      Valid probs shape: (37, 87162)
    P stats: min=0.0000, max=0.9999, mean=0.0248
    Non-zero vertices: 136261/148245
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 11984  1334  1138  3968     0  1843  1297  4807  5558]
  Ground Truth Stats:
    Labels shape: (148245,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-17/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7470
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8054
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8059

  RESULTS:
  RAW:         median(top-10)=0.8714, mean(top-10)=0.8718, median(all)=0.7861, mean(all)=0.7470
  + SMOOTHING: median(top-10)=0.9050, mean(top-10)=0.9030, median(all)=0.8432, mean(all)=0.8054 [+0.0336]
  + MRF:       median(top-10)=0.9059, mean(top-10)=0.9034, median(all)=0.8432, mean(all)=0.8059 [+0.0008]
  TOTAL IMPROVEMENT (median top-10): +0.0344

================================================================================
Subject: OASIS-TRT-20-18
================================================================================
  Step 0: Generating predictions with V2 model (20 random views)...
  Mesh: 140676 vertices, 281348 faces
  Generating 20 random views...
  Generating predictions for 20 views (continuous camera pose)...
    ✓ Random_0 (pose=(1.0797663649893003, -1.946661673019286, -1.1115038594907674)): shape (37, 800, 800)
      Valid pixels: 64958/640000 (10.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=273, max=281320, num_faces=281348
      Valid probs shape: (37, 64958)
    ✓ Random_1 (pose=(-2.247489031275971, -0.2728165052436129, -2.6666501318950178)): shape (37, 800, 800)
      Valid pixels: 69551/640000 (10.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=70, max=281344, num_faces=281348
      Valid probs shape: (37, 69551)
    ✓ Random_2 (pose=(3.072362167956898, -2.20890604318555, -2.065758414884399)): shape (37, 800, 800)
      Valid pixels: 78280/640000 (12.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=281347, num_faces=281348
      Valid probs shape: (37, 78280)
    ✓ Random_3 (pose=(2.5376826055602635, -0.4850104906865442, -2.756127621939178)): shape (37, 800, 800)
      Valid pixels: 54500/640000 (8.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1687, max=281249, num_faces=281348
      Valid probs shape: (37, 54500)
    ✓ Random_4 (pose=(2.760990603057861, -0.9630213450247656, 0.6330314985963832)): shape (37, 800, 800)
      Valid pixels: 64591/640000 (10.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4997, max=281305, num_faces=281348
      Valid probs shape: (37, 64591)
    ✓ Random_5 (pose=(1.128838921987322, 3.09009077339378, 0.6862019426539097)): shape (37, 800, 800)
      Valid pixels: 65327/640000 (10.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=281, max=281345, num_faces=281348
      Valid probs shape: (37, 65327)
    ✓ Random_6 (pose=(-0.8182230423689059, 0.8115334359334421, -1.7860801014180667)): shape (37, 800, 800)
      Valid pixels: 60387/640000 (9.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=281345, num_faces=281348
      Valid probs shape: (37, 60387)
    ✓ Random_7 (pose=(1.3468379173104514, 2.78309290829585, 0.8650940948771577)): shape (37, 800, 800)
      Valid pixels: 62864/640000 (9.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=281345, num_faces=281348
      Valid probs shape: (37, 62864)
    ✓ Random_8 (pose=(-0.8030806195540903, -1.3632682280973087, -2.005699039732054)): shape (37, 800, 800)
      Valid pixels: 77018/640000 (12.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=281297, num_faces=281348
      Valid probs shape: (37, 77018)
    ✓ Random_9 (pose=(2.604237811027745, -1.648565369323488, -2.4717587307839257)): shape (37, 800, 800)
      Valid pixels: 70675/640000 (11.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=19, max=281347, num_faces=281348
      Valid probs shape: (37, 70675)
    ✓ Random_10 (pose=(0.13388696202713124, 2.401187368410823, 2.250532739240292)): shape (37, 800, 800)
      Valid pixels: 61019/640000 (9.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2380, max=281300, num_faces=281348
      Valid probs shape: (37, 61019)
    ✓ Random_11 (pose=(2.6505606554789773, 1.7850335643861808, -0.14198306211186207)): shape (37, 800, 800)
      Valid pixels: 80180/640000 (12.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=281347, num_faces=281348
      Valid probs shape: (37, 80180)
    ✓ Random_12 (pose=(-2.7792323165480415, -1.9276862828509445, 0.7066976658460331)): shape (37, 800, 800)
      Valid pixels: 86182/640000 (13.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=8, max=279642, num_faces=281348
      Valid probs shape: (37, 86182)
    ✓ Random_13 (pose=(-0.42844983986789753, 0.6871204433135234, 1.2221789266007477)): shape (37, 800, 800)
      Valid pixels: 61680/640000 (9.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=280405, num_faces=281348
      Valid probs shape: (37, 61680)
    ✓ Random_14 (pose=(-1.3545344342505545, -0.11684230106855331, -0.5447713660966587)): shape (37, 800, 800)
      Valid pixels: 88500/640000 (13.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=14, max=281291, num_faces=281348
      Valid probs shape: (37, 88500)
    ✓ Random_15 (pose=(2.885094928323319, 1.3040333541526454, 1.556817323973121)): shape (37, 800, 800)
      Valid pixels: 78926/640000 (12.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=27, max=281345, num_faces=281348
      Valid probs shape: (37, 78926)
    ✓ Random_16 (pose=(0.06388838219338133, 0.13622823682069463, -2.3841213739812064)): shape (37, 800, 800)
      Valid pixels: 40015/640000 (6.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=281232, num_faces=281348
      Valid probs shape: (37, 40015)
    ✓ Random_17 (pose=(-1.753034235129583, -0.6862581220214463, -1.0696539093225708)): shape (37, 800, 800)
      Valid pixels: 79533/640000 (12.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=281304, num_faces=281348
      Valid probs shape: (37, 79533)
    ✓ Random_18 (pose=(1.2337789044955327, -0.31330218542802557, -2.935957526502817)): shape (37, 800, 800)
      Valid pixels: 74691/640000 (11.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=11, max=281249, num_faces=281348
      Valid probs shape: (37, 74691)
    ✓ Random_19 (pose=(0.34977063728810487, 2.9790283551002865, -2.59758222804573)): shape (37, 800, 800)
      Valid pixels: 44386/640000 (6.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3118, max=281298, num_faces=281348
      Valid probs shape: (37, 44386)
    P stats: min=0.0000, max=1.0000, mean=0.0243
    Non-zero vertices: 126553/140676
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 14123  1577  1070  3263     0  2519  1103  4168  6624]
  Ground Truth Stats:
    Labels shape: (140676,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-18/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7544
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8114
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8115

  RESULTS:
  RAW:         median(top-10)=0.8771, mean(top-10)=0.8850, median(all)=0.8041, mean(all)=0.7544
  + SMOOTHING: median(top-10)=0.9072, mean(top-10)=0.9128, median(all)=0.8473, mean(all)=0.8114 [+0.0301]
  + MRF:       median(top-10)=0.9076, mean(top-10)=0.9132, median(all)=0.8473, mean(all)=0.8115 [+0.0004]
  TOTAL IMPROVEMENT (median top-10): +0.0305

================================================================================
Subject: OASIS-TRT-20-19
================================================================================
  Step 0: Generating predictions with V2 model (20 random views)...
  Mesh: 114731 vertices, 229458 faces
  Generating 20 random views...
  Generating predictions for 20 views (continuous camera pose)...
    ✓ Random_0 (pose=(-2.2965116632743783, -2.940207729474535, -1.9301221117285614)): shape (37, 800, 800)
      Valid pixels: 66260/640000 (10.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=229396, num_faces=229458
      Valid probs shape: (37, 66260)
    ✓ Random_1 (pose=(-2.267408162161692, -2.4515370237020866, -1.267704435865714)): shape (37, 800, 800)
      Valid pixels: 64816/640000 (10.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=229439, num_faces=229458
      Valid probs shape: (37, 64816)
    ✓ Random_2 (pose=(-2.508518218690333, 0.5102301803672291, -0.6688993139136561)): shape (37, 800, 800)
      Valid pixels: 86196/640000 (13.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6183, max=229457, num_faces=229458
      Valid probs shape: (37, 86196)
    ✓ Random_3 (pose=(1.2544543519330977, 0.9587211812313647, 2.8878184524286414)): shape (37, 800, 800)
      Valid pixels: 98171/640000 (15.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=9, max=229453, num_faces=229458
      Valid probs shape: (37, 98171)
    ✓ Random_4 (pose=(-0.239220847624126, -0.6962899328622205, -2.5446682630354602)): shape (37, 800, 800)
      Valid pixels: 73447/640000 (11.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=222210, num_faces=229458
      Valid probs shape: (37, 73447)
    ✓ Random_5 (pose=(-2.409988640412812, -1.511510322429697, 1.1165560872485019)): shape (37, 800, 800)
      Valid pixels: 90985/640000 (14.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=17, max=229453, num_faces=229458
      Valid probs shape: (37, 90985)
    ✓ Random_6 (pose=(-2.2793215605288473, -1.3383851685155457, 0.28703752727245657)): shape (37, 800, 800)
      Valid pixels: 106352/640000 (16.6%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=1, max=229453, num_faces=229458
      Valid probs shape: (37, 106352)
    ✓ Random_7 (pose=(1.235399915001798, 1.7206719710842142, -1.2432105015721728)): shape (37, 800, 800)
      Valid pixels: 104336/640000 (16.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=19, max=229407, num_faces=229458
      Valid probs shape: (37, 104336)
    ✓ Random_8 (pose=(2.410705157198289, -1.2795551114602424, 2.1223104679671367)): shape (37, 800, 800)
      Valid pixels: 104048/640000 (16.3%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=4, max=229453, num_faces=229458
      Valid probs shape: (37, 104048)
    ✓ Random_9 (pose=(2.413377880354166, -1.1432227369784, -0.2665203141856507)): shape (37, 800, 800)
      Valid pixels: 87016/640000 (13.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=257, max=229450, num_faces=229458
      Valid probs shape: (37, 87016)
    ✓ Random_10 (pose=(1.7955070527527992, 2.6721865818057786, 0.351516107458667)): shape (37, 800, 800)
      Valid pixels: 95671/640000 (14.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=229406, num_faces=229458
      Valid probs shape: (37, 95671)
    ✓ Random_11 (pose=(0.5004108603976487, -2.386219953546429, -2.4955927016939876)): shape (37, 800, 800)
      Valid pixels: 91747/640000 (14.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=7105, max=229453, num_faces=229458
      Valid probs shape: (37, 91747)
    ✓ Random_12 (pose=(2.689064851769384, -1.5812944486706386, 0.49791968102886175)): shape (37, 800, 800)
      Valid pixels: 70760/640000 (11.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=40, max=229450, num_faces=229458
      Valid probs shape: (37, 70760)
    ✓ Random_13 (pose=(-1.9087744767291643, -0.5753390815180928, 1.3538041944517172)): shape (37, 800, 800)
      Valid pixels: 74321/640000 (11.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=307, max=229453, num_faces=229458
      Valid probs shape: (37, 74321)
    ✓ Random_14 (pose=(1.6407466600444218, -2.444840400862977, -2.8294961682403112)): shape (37, 800, 800)
      Valid pixels: 88288/640000 (13.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=0, max=229457, num_faces=229458
      Valid probs shape: (37, 88288)
    ✓ Random_15 (pose=(-1.9617721889465538, 2.744668876914133, -2.3448672748113513)): shape (37, 800, 800)
      Valid pixels: 73783/640000 (11.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=229404, num_faces=229458
      Valid probs shape: (37, 73783)
    ✓ Random_16 (pose=(0.5511278460590274, 0.6267905325388581, 1.5805265128677286)): shape (37, 800, 800)
      Valid pixels: 89091/640000 (13.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=229447, num_faces=229458
      Valid probs shape: (37, 89091)
    ✓ Random_17 (pose=(3.13320799859455, -1.2837062247435602, -1.237961726048505)): shape (37, 800, 800)
      Valid pixels: 94472/640000 (14.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=19, max=229426, num_faces=229458
      Valid probs shape: (37, 94472)
    ✓ Random_18 (pose=(-2.343153659520521, -0.39149640747563597, 1.3392070805835674)): shape (37, 800, 800)
      Valid pixels: 71445/640000 (11.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2179, max=229457, num_faces=229458
      Valid probs shape: (37, 71445)
    ✓ Random_19 (pose=(0.45041182042324746, 0.5836506430395305, 2.3133970400469837)): shape (37, 800, 800)
      Valid pixels: 79787/640000 (12.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=229278, num_faces=229458
      Valid probs shape: (37, 79787)
    P stats: min=0.0000, max=0.9999, mean=0.0246
    Non-zero vertices: 104615/114731
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 10116  1674   940  2518     0  1731  1020  3127  6684]
  Ground Truth Stats:
    Labels shape: (114731,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-19/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7507
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8071
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8073

  RESULTS:
  RAW:         median(top-10)=0.8919, mean(top-10)=0.8944, median(all)=0.7982, mean(all)=0.7507
  + SMOOTHING: median(top-10)=0.9255, mean(top-10)=0.9285, median(all)=0.8375, mean(all)=0.8071 [+0.0336]
  + MRF:       median(top-10)=0.9256, mean(top-10)=0.9287, median(all)=0.8380, mean(all)=0.8073 [+0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0337

================================================================================
Subject: OASIS-TRT-20-2
================================================================================
  Step 0: Generating predictions with V2 model (20 random views)...
  Mesh: 153483 vertices, 306962 faces
  Generating 20 random views...
  Generating predictions for 20 views (continuous camera pose)...
    ✓ Random_0 (pose=(-0.7431066080072473, -0.8275617844448684, 3.064708723828102)): shape (37, 800, 800)
      Valid pixels: 74210/640000 (11.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=306869, num_faces=306962
      Valid probs shape: (37, 74210)
    ✓ Random_1 (pose=(-0.4014940482270881, 1.7010864581285725, -2.3459339048998116)): shape (37, 800, 800)
      Valid pixels: 101949/640000 (15.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=306961, num_faces=306962
      Valid probs shape: (37, 101949)
    ✓ Random_2 (pose=(0.0641309208918246, -3.017750776730105, -0.0016017022533776348)): shape (37, 800, 800)
      Valid pixels: 38684/640000 (6.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2387, max=306960, num_faces=306962
      Valid probs shape: (37, 38684)
    ✓ Random_3 (pose=(-1.095274069133135, 1.5312604687966145, 0.6797531449713174)): shape (37, 800, 800)
      Valid pixels: 87309/640000 (13.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=306959, num_faces=306962
      Valid probs shape: (37, 87309)
    ✓ Random_4 (pose=(1.5588718662042318, 1.1386248363939506, 1.457311444342177)): shape (37, 800, 800)
      Valid pixels: 60156/640000 (9.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=9, max=306709, num_faces=306962
      Valid probs shape: (37, 60156)
    ✓ Random_5 (pose=(-1.199606164397304, 1.2037924710812762, -1.3419329980415513)): shape (37, 800, 800)
      Valid pixels: 60290/640000 (9.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=306712, num_faces=306962
      Valid probs shape: (37, 60290)
    ✓ Random_6 (pose=(-0.5242407772403399, -1.087277829566533, -2.1098466964671716)): shape (37, 800, 800)
      Valid pixels: 78634/640000 (12.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=305647, num_faces=306962
      Valid probs shape: (37, 78634)
    ✓ Random_7 (pose=(1.4311846413419262, 2.1123312289630354, -1.1850602611580099)): shape (37, 800, 800)
      Valid pixels: 87937/640000 (13.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=85, max=306960, num_faces=306962
      Valid probs shape: (37, 87937)
    ✓ Random_8 (pose=(3.0548789815557615, 2.100322863549417, -1.8033821018790126)): shape (37, 800, 800)
      Valid pixels: 84293/640000 (13.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=4, max=306960, num_faces=306962
      Valid probs shape: (37, 84293)
    ✓ Random_9 (pose=(-2.5213474299765735, -3.043363029023166, 0.7947876229967235)): shape (37, 800, 800)
      Valid pixels: 56620/640000 (8.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=306749, num_faces=306962
      Valid probs shape: (37, 56620)
    ✓ Random_10 (pose=(1.620578923979891, -0.7023349572496551, -2.040615693900719)): shape (37, 800, 800)
      Valid pixels: 69117/640000 (10.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=67, max=306960, num_faces=306962
      Valid probs shape: (37, 69117)
    ✓ Random_11 (pose=(-1.9611824309484556, -0.9689459915821503, -0.21303115746394896)): shape (37, 800, 800)
      Valid pixels: 94631/640000 (14.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=78, max=305596, num_faces=306962
      Valid probs shape: (37, 94631)
    ✓ Random_12 (pose=(2.3296495893827815, 1.314958548635425, -1.9495196348886488)): shape (37, 800, 800)
      Valid pixels: 82321/640000 (12.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=70, max=306959, num_faces=306962
      Valid probs shape: (37, 82321)
    ✓ Random_13 (pose=(0.3567880336051301, 0.4501644003294065, -0.8651129649135783)): shape (37, 800, 800)
      Valid pixels: 65320/640000 (10.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=306871, num_faces=306962
      Valid probs shape: (37, 65320)
    ✓ Random_14 (pose=(-1.8449515794371494, -2.1782234875921165, 2.3599213778582984)): shape (37, 800, 800)
      Valid pixels: 88236/640000 (13.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=306961, num_faces=306962
      Valid probs shape: (37, 88236)
    ✓ Random_15 (pose=(-0.2833051520821246, 2.28759807454969, -3.1186687139646505)): shape (37, 800, 800)
      Valid pixels: 69938/640000 (10.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=274, max=306960, num_faces=306962
      Valid probs shape: (37, 69938)
    ✓ Random_16 (pose=(2.3547556918888004, 0.04337852401368547, -2.4998747815823625)): shape (37, 800, 800)
      Valid pixels: 70913/640000 (11.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3314, max=306960, num_faces=306962
      Valid probs shape: (37, 70913)
    ✓ Random_17 (pose=(2.175298315881462, 3.106446928454943, -1.48374896669589)): shape (37, 800, 800)
      Valid pixels: 56401/640000 (8.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=306956, num_faces=306962
      Valid probs shape: (37, 56401)
    ✓ Random_18 (pose=(1.0448056904822964, 1.8137141214394594, -0.5862425879877184)): shape (37, 800, 800)
      Valid pixels: 99862/640000 (15.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=306961, num_faces=306962
      Valid probs shape: (37, 99862)
    ✓ Random_19 (pose=(1.567211305648037, 2.023796566558418, -1.817326440085836)): shape (37, 800, 800)
      Valid pixels: 65575/640000 (10.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=66, max=306960, num_faces=306962
      Valid probs shape: (37, 65575)
    P stats: min=0.0000, max=1.0000, mean=0.0246
    Non-zero vertices: 139773/153483
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 13710  1447  1281  3436     0  2203  1002  5464  6723]
  Ground Truth Stats:
    Labels shape: (153483,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-2/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7660
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8361
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8364

  RESULTS:
  RAW:         median(top-10)=0.8937, mean(top-10)=0.9014, median(all)=0.8421, mean(all)=0.7660
  + SMOOTHING: median(top-10)=0.9302, mean(top-10)=0.9339, median(all)=0.8962, mean(all)=0.8361 [+0.0366]
  + MRF:       median(top-10)=0.9305, mean(top-10)=0.9341, median(all)=0.8967, mean(all)=0.8364 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0368

================================================================================
Subject: OASIS-TRT-20-20
================================================================================
  Step 0: Generating predictions with V2 model (20 random views)...
  Mesh: 124947 vertices, 249890 faces
  Generating 20 random views...
  Generating predictions for 20 views (continuous camera pose)...
    ✓ Random_0 (pose=(-1.1301381353373028, 1.8547587671007326, 0.969662093676086)): shape (37, 800, 800)
      Valid pixels: 80735/640000 (12.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=19, max=249889, num_faces=249890
      Valid probs shape: (37, 80735)
    ✓ Random_1 (pose=(-1.7376674375103844, 1.3602607443869168, -0.8464974097353268)): shape (37, 800, 800)
      Valid pixels: 104654/640000 (16.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=96, max=249719, num_faces=249890
      Valid probs shape: (37, 104654)
    ✓ Random_2 (pose=(2.180656284165706, -2.7337979486068957, -2.463898550275951)): shape (37, 800, 800)
      Valid pixels: 62905/640000 (9.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=249886, num_faces=249890
      Valid probs shape: (37, 62905)
    ✓ Random_3 (pose=(-0.573869165966395, 1.4448997242058415, 1.1351947983902573)): shape (37, 800, 800)
      Valid pixels: 90073/640000 (14.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=26, max=249889, num_faces=249890
      Valid probs shape: (37, 90073)
    ✓ Random_4 (pose=(-0.377626325355235, -1.498801011562404, 2.4629149216811816)): shape (37, 800, 800)
      Valid pixels: 84538/640000 (13.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=249875, num_faces=249890
      Valid probs shape: (37, 84538)
    ✓ Random_5 (pose=(-0.8636009885670881, 2.622824538185899, 1.5364122119002763)): shape (37, 800, 800)
      Valid pixels: 72798/640000 (11.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=17, max=249889, num_faces=249890
      Valid probs shape: (37, 72798)
    ✓ Random_6 (pose=(-0.8365891966476826, 0.12079057512253666, -2.7391402798015205)): shape (37, 800, 800)
      Valid pixels: 80501/640000 (12.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=249852, num_faces=249890
      Valid probs shape: (37, 80501)
    ✓ Random_7 (pose=(0.7615997984974818, 2.5115432479981195, 1.0048797439779902)): shape (37, 800, 800)
      Valid pixels: 65647/640000 (10.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=11034, max=249719, num_faces=249890
      Valid probs shape: (37, 65647)
    ✓ Random_8 (pose=(-2.1343053152638225, 0.1500672818682327, -1.538398338431173)): shape (37, 800, 800)
      Valid pixels: 72616/640000 (11.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=885, max=249719, num_faces=249890
      Valid probs shape: (37, 72616)
    ✓ Random_9 (pose=(2.9799197814879586, -1.3588639607127213, 1.6807084406581483)): shape (37, 800, 800)
      Valid pixels: 98496/640000 (15.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=19, max=249889, num_faces=249890
      Valid probs shape: (37, 98496)
    ✓ Random_10 (pose=(-0.49292668350886837, -0.24837035814103814, -0.7312538808017015)): shape (37, 800, 800)
      Valid pixels: 67218/640000 (10.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=249719, num_faces=249890
      Valid probs shape: (37, 67218)
    ✓ Random_11 (pose=(2.012906415758275, -2.3277548681158318, 3.068642651649795)): shape (37, 800, 800)
      Valid pixels: 82346/640000 (12.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=249888, num_faces=249890
      Valid probs shape: (37, 82346)
    ✓ Random_12 (pose=(-1.2816354267695909, -3.116739001893716, 2.219290205227492)): shape (37, 800, 800)
      Valid pixels: 98823/640000 (15.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=19, max=249884, num_faces=249890
      Valid probs shape: (37, 98823)
    ✓ Random_13 (pose=(-2.1169550716490066, -2.8585167676178327, 2.2252391812027197)): shape (37, 800, 800)
      Valid pixels: 85821/640000 (13.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=249875, num_faces=249890
      Valid probs shape: (37, 85821)
    ✓ Random_14 (pose=(-2.280675516774524, 2.266255459679308, 1.5787155166588)): shape (37, 800, 800)
      Valid pixels: 93062/640000 (14.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=249875, num_faces=249890
      Valid probs shape: (37, 93062)
    ✓ Random_15 (pose=(-0.2328734656929683, 0.642026225278602, 2.923883911336704)): shape (37, 800, 800)
      Valid pixels: 61590/640000 (9.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=249875, num_faces=249890
      Valid probs shape: (37, 61590)
    ✓ Random_16 (pose=(-1.1792879813868484, -2.294449785039567, 1.4637115450635436)): shape (37, 800, 800)
      Valid pixels: 82236/640000 (12.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=18, max=249889, num_faces=249890
      Valid probs shape: (37, 82236)
    ✓ Random_17 (pose=(-0.5566165412924788, -0.712433540956765, -1.5209441789371383)): shape (37, 800, 800)
      Valid pixels: 85937/640000 (13.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=249719, num_faces=249890
      Valid probs shape: (37, 85937)
    ✓ Random_18 (pose=(-1.171909598021018, 2.9731502203392823, -2.19820503211117)): shape (37, 800, 800)
      Valid pixels: 71413/640000 (11.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=775, max=249794, num_faces=249890
      Valid probs shape: (37, 71413)
    ✓ Random_19 (pose=(-1.6561327731907045, -1.4260642419768557, -1.1908729292017863)): shape (37, 800, 800)
      Valid pixels: 88009/640000 (13.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=216, max=249719, num_faces=249890
      Valid probs shape: (37, 88009)
    P stats: min=0.0000, max=0.9998, mean=0.0243
    Non-zero vertices: 112236/124947
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 12711   976   888  3033     0  1494   765  4162  5549]
  Ground Truth Stats:
    Labels shape: (124947,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-20/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7568
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8105
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8109

  RESULTS:
  RAW:         median(top-10)=0.8698, mean(top-10)=0.8836, median(all)=0.8069, mean(all)=0.7568
  + SMOOTHING: median(top-10)=0.9133, mean(top-10)=0.9186, median(all)=0.8557, mean(all)=0.8105 [+0.0435]
  + MRF:       median(top-10)=0.9135, mean(top-10)=0.9187, median(all)=0.8563, mean(all)=0.8109 [+0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0436

================================================================================
Subject: OASIS-TRT-20-3
================================================================================
  Step 0: Generating predictions with V2 model (20 random views)...
  Mesh: 134843 vertices, 269682 faces
  Generating 20 random views...
  Generating predictions for 20 views (continuous camera pose)...
    ✓ Random_0 (pose=(-2.2773096098316863, 2.4238893321094395, -2.5614375010058743)): shape (37, 800, 800)
      Valid pixels: 57487/640000 (9.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=269639, num_faces=269682
      Valid probs shape: (37, 57487)
    ✓ Random_1 (pose=(-1.9671001701897872, 1.7762514372797655, -0.13668907496966254)): shape (37, 800, 800)
      Valid pixels: 77611/640000 (12.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=269638, num_faces=269682
      Valid probs shape: (37, 77611)
    ✓ Random_2 (pose=(0.38419092505767827, 0.7865376024338606, 1.7522459663723158)): shape (37, 800, 800)
      Valid pixels: 74163/640000 (11.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=269532, num_faces=269682
      Valid probs shape: (37, 74163)
    ✓ Random_3 (pose=(-2.213010803158001, -2.9592487802631053, 2.8884602585890526)): shape (37, 800, 800)
      Valid pixels: 76570/640000 (12.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=269639, num_faces=269682
      Valid probs shape: (37, 76570)
    ✓ Random_4 (pose=(-1.0324127179736706, -1.1877650702629432, 2.039258888045606)): shape (37, 800, 800)
      Valid pixels: 89747/640000 (14.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=269639, num_faces=269682
      Valid probs shape: (37, 89747)
    ✓ Random_5 (pose=(1.8613324310972112, 2.5738543121503348, 0.705096863480112)): shape (37, 800, 800)
      Valid pixels: 72861/640000 (11.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=269639, num_faces=269682
      Valid probs shape: (37, 72861)
    ✓ Random_6 (pose=(-2.242335916640017, -1.9112863800371807, 0.05638058515957578)): shape (37, 800, 800)
      Valid pixels: 87739/640000 (13.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=269680, num_faces=269682
      Valid probs shape: (37, 87739)
    ✓ Random_7 (pose=(-2.0615578598922313, -2.724422865276194, 1.6731734337606587)): shape (37, 800, 800)
      Valid pixels: 53377/640000 (8.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=10, max=269639, num_faces=269682
      Valid probs shape: (37, 53377)
    ✓ Random_8 (pose=(-0.22572117638900568, -0.8259284302399652, 0.23222955220707764)): shape (37, 800, 800)
      Valid pixels: 48486/640000 (7.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=269639, num_faces=269682
      Valid probs shape: (37, 48486)
    ✓ Random_9 (pose=(0.5080283712771441, 1.7069088188150943, 3.025636745992416)): shape (37, 800, 800)
      Valid pixels: 65552/640000 (10.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=66, max=269638, num_faces=269682
      Valid probs shape: (37, 65552)
    ✓ Random_10 (pose=(2.0410058101364053, 0.0004204503546549887, -0.5045904538529999)): shape (37, 800, 800)
      Valid pixels: 86933/640000 (13.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=110, max=269639, num_faces=269682
      Valid probs shape: (37, 86933)
    ✓ Random_11 (pose=(1.5500551460657945, 2.1882787566205186, -1.1066533230412632)): shape (37, 800, 800)
      Valid pixels: 79357/640000 (12.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=26, max=269639, num_faces=269682
      Valid probs shape: (37, 79357)
    ✓ Random_12 (pose=(-2.198455062742668, 3.1194354255304875, 1.9545863951435027)): shape (37, 800, 800)
      Valid pixels: 60752/640000 (9.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=9, max=269639, num_faces=269682
      Valid probs shape: (37, 60752)
    ✓ Random_13 (pose=(1.0468986113310068, -2.3109917529777055, 0.49769785913203224)): shape (37, 800, 800)
      Valid pixels: 85085/640000 (13.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=21, max=269639, num_faces=269682
      Valid probs shape: (37, 85085)
    ✓ Random_14 (pose=(-2.7458443014172955, -2.7690687618474956, 2.105297931236133)): shape (37, 800, 800)
      Valid pixels: 44558/640000 (7.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=269639, num_faces=269682
      Valid probs shape: (37, 44558)
    ✓ Random_15 (pose=(-2.6318607691967104, -2.421919157678007, 0.10499074058087077)): shape (37, 800, 800)
      Valid pixels: 73129/640000 (11.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=269532, num_faces=269682
      Valid probs shape: (37, 73129)
    ✓ Random_16 (pose=(0.7310042270747328, 2.123133756500793, -0.22659342083918332)): shape (37, 800, 800)
      Valid pixels: 72236/640000 (11.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=19, max=269634, num_faces=269682
      Valid probs shape: (37, 72236)
    ✓ Random_17 (pose=(-1.6797519097878906, -1.4801912234982768, -2.73005186398684)): shape (37, 800, 800)
      Valid pixels: 82481/640000 (12.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=20, max=269639, num_faces=269682
      Valid probs shape: (37, 82481)
    ✓ Random_18 (pose=(0.4586261811805721, 0.3322950781850218, -0.4048889636268318)): shape (37, 800, 800)
      Valid pixels: 56420/640000 (8.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=269639, num_faces=269682
      Valid probs shape: (37, 56420)
    ✓ Random_19 (pose=(0.449605449589217, -0.6270438671023011, 1.6162004890461175)): shape (37, 800, 800)
      Valid pixels: 57019/640000 (8.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=269634, num_faces=269682
      Valid probs shape: (37, 57019)
    P stats: min=0.0000, max=0.9999, mean=0.0232
    Non-zero vertices: 115667/134843
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 19176  1487  1012  2162     0  2353   956  4407  6753]
  Ground Truth Stats:
    Labels shape: (134843,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-3/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7332
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8059
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8061

  RESULTS:
  RAW:         median(top-10)=0.8981, mean(top-10)=0.8898, median(all)=0.7900, mean(all)=0.7332
  + SMOOTHING: median(top-10)=0.9124, mean(top-10)=0.9105, median(all)=0.8674, mean(all)=0.8059 [+0.0144]
  + MRF:       median(top-10)=0.9128, mean(top-10)=0.9109, median(all)=0.8676, mean(all)=0.8061 [+0.0004]
  TOTAL IMPROVEMENT (median top-10): +0.0148

================================================================================
Subject: OASIS-TRT-20-4
================================================================================
  Step 0: Generating predictions with V2 model (20 random views)...
  Mesh: 138101 vertices, 276198 faces
  Generating 20 random views...
  Generating predictions for 20 views (continuous camera pose)...
    ✓ Random_0 (pose=(2.43620246108628, -2.7444022833544817, 2.396359811083311)): shape (37, 800, 800)
      Valid pixels: 83598/640000 (13.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=275898, num_faces=276198
      Valid probs shape: (37, 83598)
    ✓ Random_1 (pose=(-0.8531596118083185, -2.296830329102372, -1.1534968607982448)): shape (37, 800, 800)
      Valid pixels: 92672/640000 (14.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=723, max=276196, num_faces=276198
      Valid probs shape: (37, 92672)
    ✓ Random_2 (pose=(-2.451773676264532, 2.457502809097833, 2.9402874096013507)): shape (37, 800, 800)
      Valid pixels: 77190/640000 (12.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=276197, num_faces=276198
      Valid probs shape: (37, 77190)
    ✓ Random_3 (pose=(-0.08271412513177978, -1.68668408344223, 2.3625555982199575)): shape (37, 800, 800)
      Valid pixels: 79161/640000 (12.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=15, max=276195, num_faces=276198
      Valid probs shape: (37, 79161)
    ✓ Random_4 (pose=(-2.078583945521308, 2.323424290789056, 0.7884838807540593)): shape (37, 800, 800)
      Valid pixels: 63202/640000 (9.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=276123, num_faces=276198
      Valid probs shape: (37, 63202)
    ✓ Random_5 (pose=(1.4462775628632007, 0.8557702726371534, -2.390373891966477)): shape (37, 800, 800)
      Valid pixels: 73714/640000 (11.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=16, max=276195, num_faces=276198
      Valid probs shape: (37, 73714)
    ✓ Random_6 (pose=(1.1945400017672672, 1.4624333029587389, -2.33727057460392)): shape (37, 800, 800)
      Valid pixels: 68364/640000 (10.7%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=65, max=276195, num_faces=276198
      Valid probs shape: (37, 68364)
    ✓ Random_7 (pose=(-0.027422922253760085, -1.0998081548570808, -1.3460532128350788)): shape (37, 800, 800)
      Valid pixels: 83984/640000 (13.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=276164, num_faces=276198
      Valid probs shape: (37, 83984)
    ✓ Random_8 (pose=(1.1782393605257049, 1.9186071044691868, 3.0950649210218737)): shape (37, 800, 800)
      Valid pixels: 86985/640000 (13.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=21, max=276196, num_faces=276198
      Valid probs shape: (37, 86985)
    ✓ Random_9 (pose=(1.090560715511689, -2.8732938027739765, 1.0930466483023364)): shape (37, 800, 800)
      Valid pixels: 67485/640000 (10.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=293, max=276197, num_faces=276198
      Valid probs shape: (37, 67485)
    ✓ Random_10 (pose=(2.2299834139322083, 2.712169914876326, -0.9306456488008235)): shape (37, 800, 800)
      Valid pixels: 65185/640000 (10.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=276193, num_faces=276198
      Valid probs shape: (37, 65185)
    ✓ Random_11 (pose=(1.6059090243639114, -3.02875354824999, 1.8529876089715982)): shape (37, 800, 800)
      Valid pixels: 77654/640000 (12.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=275472, num_faces=276198
      Valid probs shape: (37, 77654)
    ✓ Random_12 (pose=(-2.316844263957986, -0.834237776164076, -1.0918877233769635)): shape (37, 800, 800)
      Valid pixels: 56264/640000 (8.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2118, max=276197, num_faces=276198
      Valid probs shape: (37, 56264)
    ✓ Random_13 (pose=(1.8722154878847164, 2.178053846972478, 0.602830497366154)): shape (37, 800, 800)
      Valid pixels: 91206/640000 (14.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=276194, num_faces=276198
      Valid probs shape: (37, 91206)
    ✓ Random_14 (pose=(2.3381614483932704, 2.015749423065343, 2.789385282428394)): shape (37, 800, 800)
      Valid pixels: 87016/640000 (13.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=275472, num_faces=276198
      Valid probs shape: (37, 87016)
    ✓ Random_15 (pose=(2.9738340727715213, -1.833895909741162, 3.085731491389444)): shape (37, 800, 800)
      Valid pixels: 62172/640000 (9.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=24, max=276181, num_faces=276198
      Valid probs shape: (37, 62172)
    ✓ Random_16 (pose=(0.1241423695814583, 2.9758121010634015, 1.3132094378422332)): shape (37, 800, 800)
      Valid pixels: 50415/640000 (7.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=85830, max=276197, num_faces=276198
      Valid probs shape: (37, 50415)
    ✓ Random_17 (pose=(2.8454562905375633, 1.7008188036142364, -1.2741704533690696)): shape (37, 800, 800)
      Valid pixels: 78400/640000 (12.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=15, max=276176, num_faces=276198
      Valid probs shape: (37, 78400)
    ✓ Random_18 (pose=(-0.3603697809216668, 3.087013212685565, 0.6147857774860954)): shape (37, 800, 800)
      Valid pixels: 60118/640000 (9.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7980, max=276197, num_faces=276198
      Valid probs shape: (37, 60118)
    ✓ Random_19 (pose=(-2.614979818612882, 2.3032667005014407, -1.9607379534580596)): shape (37, 800, 800)
      Valid pixels: 81143/640000 (12.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=275896, num_faces=276198
      Valid probs shape: (37, 81143)
    P stats: min=0.0000, max=0.9999, mean=0.0243
    Non-zero vertices: 124160/138101
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 13941  1022   857  3510     0  1977  1058  3415  6336]
  Ground Truth Stats:
    Labels shape: (138101,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-4/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7502
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8109
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8111

  RESULTS:
  RAW:         median(top-10)=0.9136, mean(top-10)=0.9131, median(all)=0.8133, mean(all)=0.7502
  + SMOOTHING: median(top-10)=0.9375, mean(top-10)=0.9374, median(all)=0.8733, mean(all)=0.8109 [+0.0239]
  + MRF:       median(top-10)=0.9376, mean(top-10)=0.9374, median(all)=0.8736, mean(all)=0.8111 [+0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0240

================================================================================
Subject: OASIS-TRT-20-5
================================================================================
  Step 0: Generating predictions with V2 model (20 random views)...
  Mesh: 151342 vertices, 302680 faces
  Generating 20 random views...
  Generating predictions for 20 views (continuous camera pose)...
    ✓ Random_0 (pose=(1.607278212480181, -1.4693153883760504, 0.7915540461776565)): shape (37, 800, 800)
      Valid pixels: 82566/640000 (12.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=302623, num_faces=302680
      Valid probs shape: (37, 82566)
    ✓ Random_1 (pose=(0.15933123005386474, 2.468833754638169, 0.8662205867017372)): shape (37, 800, 800)
      Valid pixels: 75028/640000 (11.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=21815, max=302679, num_faces=302680
      Valid probs shape: (37, 75028)
    ✓ Random_2 (pose=(-1.0822313644328307, 1.9656786354911926, 2.972888178893114)): shape (37, 800, 800)
      Valid pixels: 107404/640000 (16.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=302670, num_faces=302680
      Valid probs shape: (37, 107404)
    ✓ Random_3 (pose=(1.4965185202907776, -1.5193313680136187, 1.3844340814448053)): shape (37, 800, 800)
      Valid pixels: 71364/640000 (11.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=302623, num_faces=302680
      Valid probs shape: (37, 71364)
    ✓ Random_4 (pose=(1.611950581628781, -3.0313083309644084, -1.1646708046986023)): shape (37, 800, 800)
      Valid pixels: 85465/640000 (13.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=302660, num_faces=302680
      Valid probs shape: (37, 85465)
    ✓ Random_5 (pose=(2.402971467968742, -0.7910314349879419, -0.7657507512961774)): shape (37, 800, 800)
      Valid pixels: 97563/640000 (15.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=302672, num_faces=302680
      Valid probs shape: (37, 97563)
    ✓ Random_6 (pose=(-2.0378180333448963, 1.1632518579196454, -1.101298534463837)): shape (37, 800, 800)
      Valid pixels: 101181/640000 (15.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=444, max=302679, num_faces=302680
      Valid probs shape: (37, 101181)
    ✓ Random_7 (pose=(-2.537700671312123, 2.8932930961726298, -2.0266105929555067)): shape (37, 800, 800)
      Valid pixels: 62081/640000 (9.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=302613, num_faces=302680
      Valid probs shape: (37, 62081)
    ✓ Random_8 (pose=(0.7794313950046945, -1.6641594328606928, -0.6273961372741326)): shape (37, 800, 800)
      Valid pixels: 72687/640000 (11.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=2, max=302661, num_faces=302680
      Valid probs shape: (37, 72687)
    ✓ Random_9 (pose=(0.9449245173315441, 0.2170749957403597, 3.0740000319570093)): shape (37, 800, 800)
      Valid pixels: 86033/640000 (13.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=6, max=302673, num_faces=302680
      Valid probs shape: (37, 86033)
    ✓ Random_10 (pose=(1.7801126555016937, 1.8682370815776341, -2.840564958139124)): shape (37, 800, 800)
      Valid pixels: 95821/640000 (15.0%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=6, max=302679, num_faces=302680
      Valid probs shape: (37, 95821)
    ✓ Random_11 (pose=(-2.6782358054591064, 0.6987597827419378, 2.5983489738486405)): shape (37, 800, 800)
      Valid pixels: 75751/640000 (11.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=302672, num_faces=302680
      Valid probs shape: (37, 75751)
    ✓ Random_12 (pose=(2.502912827407198, 1.1817576011539686, 0.42888604369816896)): shape (37, 800, 800)
      Valid pixels: 107906/640000 (16.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=302671, num_faces=302680
      Valid probs shape: (37, 107906)
    ✓ Random_13 (pose=(1.6376086095433333, 1.0195690938095838, 0.32178816599309856)): shape (37, 800, 800)
      Valid pixels: 100132/640000 (15.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=302623, num_faces=302680
      Valid probs shape: (37, 100132)
    ✓ Random_14 (pose=(2.322230886016638, -0.6705090732935766, -0.772715903534166)): shape (37, 800, 800)
      Valid pixels: 98940/640000 (15.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=302672, num_faces=302680
      Valid probs shape: (37, 98940)
    ✓ Random_15 (pose=(-3.1270737226479106, -0.920223132708299, 0.9031197639181032)): shape (37, 800, 800)
      Valid pixels: 89070/640000 (13.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4584, max=302679, num_faces=302680
      Valid probs shape: (37, 89070)
    ✓ Random_16 (pose=(2.659697698144794, -2.703929425658411, -2.5306057660220382)): shape (37, 800, 800)
      Valid pixels: 56928/640000 (8.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=302627, num_faces=302680
      Valid probs shape: (37, 56928)
    ✓ Random_17 (pose=(1.5894529756235931, 0.8802001496644634, -2.715139291092481)): shape (37, 800, 800)
      Valid pixels: 87248/640000 (13.6%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=16, max=302679, num_faces=302680
      Valid probs shape: (37, 87248)
    ✓ Random_18 (pose=(2.3307874287760555, 2.2789241271349985, -1.5569103181131283)): shape (37, 800, 800)
      Valid pixels: 68077/640000 (10.6%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=3, max=302630, num_faces=302680
      Valid probs shape: (37, 68077)
    ✓ Random_19 (pose=(1.246608181010843, 1.6703357345179501, -3.1146753340228037)): shape (37, 800, 800)
      Valid pixels: 88921/640000 (13.9%)
      Probs stats: min=0.0000, max=0.9994, mean=0.0270
      Face IDs: min=16, max=302679, num_faces=302680
      Valid probs shape: (37, 88921)
    P stats: min=0.0000, max=0.9998, mean=0.0244
    Non-zero vertices: 136877/151342
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 14465  1020   900  3585     0  2486  1134  6179  6630]
  Ground Truth Stats:
    Labels shape: (151342,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-5/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
    MRF iteration 5/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7400
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7945
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7949

  RESULTS:
  RAW:         median(top-10)=0.8860, mean(top-10)=0.8926, median(all)=0.8080, mean(all)=0.7400
  + SMOOTHING: median(top-10)=0.9147, mean(top-10)=0.9234, median(all)=0.8462, mean(all)=0.7945 [+0.0287]
  + MRF:       median(top-10)=0.9153, mean(top-10)=0.9239, median(all)=0.8471, mean(all)=0.7949 [+0.0005]
  TOTAL IMPROVEMENT (median top-10): +0.0292

================================================================================
Subject: OASIS-TRT-20-6
================================================================================
  Step 0: Generating predictions with V2 model (20 random views)...
  Mesh: 152023 vertices, 304042 faces
  Generating 20 random views...
  Generating predictions for 20 views (continuous camera pose)...
    ✓ Random_0 (pose=(-0.8982278302474236, 2.5725439232587286, 0.8032973221785924)): shape (37, 800, 800)
      Valid pixels: 72917/640000 (11.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1435, max=304041, num_faces=304042
      Valid probs shape: (37, 72917)
    ✓ Random_1 (pose=(-0.00865182805594511, 1.0125159596126885, 1.7448458154411046)): shape (37, 800, 800)
      Valid pixels: 73815/640000 (11.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=303988, num_faces=304042
      Valid probs shape: (37, 73815)
    ✓ Random_2 (pose=(-2.9448374610062236, 0.9526464061143489, 2.9843116622162515)): shape (37, 800, 800)
      Valid pixels: 57211/640000 (8.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=154, max=304041, num_faces=304042
      Valid probs shape: (37, 57211)
    ✓ Random_3 (pose=(-2.8409293907163757, -2.2402419656809944, 1.7309379517722796)): shape (37, 800, 800)
      Valid pixels: 64678/640000 (10.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=303562, num_faces=304042
      Valid probs shape: (37, 64678)
    ✓ Random_4 (pose=(0.7080422531030899, -1.9040715086239948, -2.1888467434932464)): shape (37, 800, 800)
      Valid pixels: 83641/640000 (13.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=46, max=304041, num_faces=304042
      Valid probs shape: (37, 83641)
    ✓ Random_5 (pose=(0.7827396584223156, 2.460542435093699, -1.4145177826728468)): shape (37, 800, 800)
      Valid pixels: 81077/640000 (12.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=48, max=304040, num_faces=304042
      Valid probs shape: (37, 81077)
    ✓ Random_6 (pose=(-2.9070075669056377, -0.6226415816438653, 2.291891738971092)): shape (37, 800, 800)
      Valid pixels: 55678/640000 (8.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3328, max=304041, num_faces=304042
      Valid probs shape: (37, 55678)
    ✓ Random_7 (pose=(2.3954186373741013, 0.3005956400452936, 3.0526928318349347)): shape (37, 800, 800)
      Valid pixels: 75052/640000 (11.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=24065, max=304041, num_faces=304042
      Valid probs shape: (37, 75052)
    ✓ Random_8 (pose=(-0.37408184368387687, 1.5125463238110068, 2.1081187879544396)): shape (37, 800, 800)
      Valid pixels: 67524/640000 (10.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=22, max=304039, num_faces=304042
      Valid probs shape: (37, 67524)
    ✓ Random_9 (pose=(1.8876307715139582, 2.0485744503696113, 2.2022373807318747)): shape (37, 800, 800)
      Valid pixels: 75452/640000 (11.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=303982, num_faces=304042
      Valid probs shape: (37, 75452)
    ✓ Random_10 (pose=(-0.9656399804423459, 0.6237360800129137, 2.891090885268687)): shape (37, 800, 800)
      Valid pixels: 83461/640000 (13.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=304029, num_faces=304042
      Valid probs shape: (37, 83461)
    ✓ Random_11 (pose=(-1.7821447135815236, 0.1513380867611489, -0.2013561606787566)): shape (37, 800, 800)
      Valid pixels: 89300/640000 (14.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=133, max=304041, num_faces=304042
      Valid probs shape: (37, 89300)
    ✓ Random_12 (pose=(1.9702642075752337, 0.3804167361975037, 0.7793098724110803)): shape (37, 800, 800)
      Valid pixels: 73009/640000 (11.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=304041, num_faces=304042
      Valid probs shape: (37, 73009)
    ✓ Random_13 (pose=(-0.9173226120546478, -1.1741506140425937, 0.6067540913401883)): shape (37, 800, 800)
      Valid pixels: 61757/640000 (9.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=12, max=303947, num_faces=304042
      Valid probs shape: (37, 61757)
    ✓ Random_14 (pose=(-0.487222164575531, -2.5812315056575152, -2.490998910649775)): shape (37, 800, 800)
      Valid pixels: 49435/640000 (7.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4969, max=304041, num_faces=304042
      Valid probs shape: (37, 49435)
    ✓ Random_15 (pose=(-1.9823269307240914, -0.8196495339523282, 0.8015521746211562)): shape (37, 800, 800)
      Valid pixels: 74601/640000 (11.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=132, max=304041, num_faces=304042
      Valid probs shape: (37, 74601)
    ✓ Random_16 (pose=(1.5974089612377131, 1.478613653692908, 3.0150530804612234)): shape (37, 800, 800)
      Valid pixels: 90552/640000 (14.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=38, max=304041, num_faces=304042
      Valid probs shape: (37, 90552)
    ✓ Random_17 (pose=(2.3954224424949997, -1.225008557300368, -2.1727280649666283)): shape (37, 800, 800)
      Valid pixels: 68756/640000 (10.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=363, max=304039, num_faces=304042
      Valid probs shape: (37, 68756)
    ✓ Random_18 (pose=(0.9338500262691181, 0.7690077178689196, 2.329912608529)): shape (37, 800, 800)
      Valid pixels: 87796/640000 (13.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=303988, num_faces=304042
      Valid probs shape: (37, 87796)
    ✓ Random_19 (pose=(-0.1695078268674508, 2.2183752216628, -1.2032601956726399)): shape (37, 800, 800)
      Valid pixels: 66847/640000 (10.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=304041, num_faces=304042
      Valid probs shape: (37, 66847)
    P stats: min=0.0000, max=1.0000, mean=0.0241
    Non-zero vertices: 135582/152023
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 16441  1221  1287  4578     0  1708   872  4840  5979]
  Ground Truth Stats:
    Labels shape: (152023,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-6/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
    MRF iteration 5/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7631
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8280
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8282

  RESULTS:
  RAW:         median(top-10)=0.8868, mean(top-10)=0.8890, median(all)=0.7867, mean(all)=0.7631
  + SMOOTHING: median(top-10)=0.9198, mean(top-10)=0.9215, median(all)=0.8584, mean(all)=0.8280 [+0.0330]
  + MRF:       median(top-10)=0.9198, mean(top-10)=0.9217, median(all)=0.8591, mean(all)=0.8282 [+0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0331

================================================================================
Subject: OASIS-TRT-20-7
================================================================================
  Step 0: Generating predictions with V2 model (20 random views)...
  Mesh: 142612 vertices, 285220 faces
  Generating 20 random views...
  Generating predictions for 20 views (continuous camera pose)...
    ✓ Random_0 (pose=(-1.4084385725935433, -2.4847017459689966, -2.723403147423052)): shape (37, 800, 800)
      Valid pixels: 90575/640000 (14.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=284967, num_faces=285220
      Valid probs shape: (37, 90575)
    ✓ Random_1 (pose=(2.916039173362754, -1.0585303710786147, 0.9795736428283961)): shape (37, 800, 800)
      Valid pixels: 92571/640000 (14.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=7305, max=285219, num_faces=285220
      Valid probs shape: (37, 92571)
    ✓ Random_2 (pose=(-2.464440218602282, -3.0448021133176573, 2.878522534855094)): shape (37, 800, 800)
      Valid pixels: 74439/640000 (11.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=285000, num_faces=285220
      Valid probs shape: (37, 74439)
    ✓ Random_3 (pose=(2.8535723593088456, 1.4572811347344095, 2.9552227533479316)): shape (37, 800, 800)
      Valid pixels: 72812/640000 (11.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=182, max=285218, num_faces=285220
      Valid probs shape: (37, 72812)
    ✓ Random_4 (pose=(3.0538815716031102, -0.587063196592855, -0.363009087963158)): shape (37, 800, 800)
      Valid pixels: 54683/640000 (8.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=973, max=285219, num_faces=285220
      Valid probs shape: (37, 54683)
    ✓ Random_5 (pose=(3.0878184576168417, 2.6592570176900265, 0.35159587772238377)): shape (37, 800, 800)
      Valid pixels: 54928/640000 (8.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=285166, num_faces=285220
      Valid probs shape: (37, 54928)
    ✓ Random_6 (pose=(-0.39158513096896597, 1.0154659611189363, -1.152667257822765)): shape (37, 800, 800)
      Valid pixels: 74805/640000 (11.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=284934, num_faces=285220
      Valid probs shape: (37, 74805)
    ✓ Random_7 (pose=(2.4246376645238508, 1.6148115354208565, -2.3235835813752197)): shape (37, 800, 800)
      Valid pixels: 102009/640000 (15.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=3, max=285213, num_faces=285220
      Valid probs shape: (37, 102009)
    ✓ Random_8 (pose=(2.203938269781858, 0.49976154784889104, 1.0995485761814496)): shape (37, 800, 800)
      Valid pixels: 75539/640000 (11.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=74, max=285218, num_faces=285220
      Valid probs shape: (37, 75539)
    ✓ Random_9 (pose=(0.8903749898484552, -0.5012092241415824, -2.338213537431384)): shape (37, 800, 800)
      Valid pixels: 79035/640000 (12.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=285109, num_faces=285220
      Valid probs shape: (37, 79035)
    ✓ Random_10 (pose=(1.0406069294030589, -1.2147578245151975, 1.5265100475581672)): shape (37, 800, 800)
      Valid pixels: 76033/640000 (11.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=285109, num_faces=285220
      Valid probs shape: (37, 76033)
    ✓ Random_11 (pose=(-0.6180251232233527, -2.3788457882096816, 2.304438990425359)): shape (37, 800, 800)
      Valid pixels: 97107/640000 (15.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=77, max=285209, num_faces=285220
      Valid probs shape: (37, 97107)
    ✓ Random_12 (pose=(1.4576551582972224, -1.8936618813437596, -2.398750310186866)): shape (37, 800, 800)
      Valid pixels: 83767/640000 (13.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=21, max=285161, num_faces=285220
      Valid probs shape: (37, 83767)
    ✓ Random_13 (pose=(-1.4647834346258495, -0.4595198536617655, -2.950359498469885)): shape (37, 800, 800)
      Valid pixels: 100988/640000 (15.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=284963, num_faces=285220
      Valid probs shape: (37, 100988)
    ✓ Random_14 (pose=(0.005338464790174857, 3.1073896095252014, -3.044156531450586)): shape (37, 800, 800)
      Valid pixels: 44975/640000 (7.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6557, max=285219, num_faces=285220
      Valid probs shape: (37, 44975)
    ✓ Random_15 (pose=(2.1368339184956904, -2.0041627690523818, 3.0598022796730735)): shape (37, 800, 800)
      Valid pixels: 86015/640000 (13.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=285161, num_faces=285220
      Valid probs shape: (37, 86015)
    ✓ Random_16 (pose=(-1.859058455324479, 1.002393366514145, 1.3541584505546957)): shape (37, 800, 800)
      Valid pixels: 73046/640000 (11.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=131, max=285163, num_faces=285220
      Valid probs shape: (37, 73046)
    ✓ Random_17 (pose=(-2.0247033137639425, -0.39096917244163754, 2.3192621980752985)): shape (37, 800, 800)
      Valid pixels: 98340/640000 (15.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=96, max=285166, num_faces=285220
      Valid probs shape: (37, 98340)
    ✓ Random_18 (pose=(-0.6156617945977825, 2.7434963013707163, -1.9312423059565922)): shape (37, 800, 800)
      Valid pixels: 65807/640000 (10.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=515, max=285219, num_faces=285220
      Valid probs shape: (37, 65807)
    ✓ Random_19 (pose=(-0.18857867422014207, -3.1033706592154204, -2.088429845423434)): shape (37, 800, 800)
      Valid pixels: 44194/640000 (6.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=944, max=285219, num_faces=285220
      Valid probs shape: (37, 44194)
    P stats: min=0.0000, max=1.0000, mean=0.0242
    Non-zero vertices: 127556/142612
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 15056  1024   825  3600     0  1971  1095  5225  6944]
  Ground Truth Stats:
    Labels shape: (142612,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-7/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7409
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8055
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8058

  RESULTS:
  RAW:         median(top-10)=0.9072, mean(top-10)=0.9014, median(all)=0.8040, mean(all)=0.7409
  + SMOOTHING: median(top-10)=0.9248, mean(top-10)=0.9263, median(all)=0.8714, mean(all)=0.8055 [+0.0176]
  + MRF:       median(top-10)=0.9252, mean(top-10)=0.9268, median(all)=0.8718, mean(all)=0.8058 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0179

================================================================================
Subject: OASIS-TRT-20-8
================================================================================
  Step 0: Generating predictions with V2 model (20 random views)...
  Mesh: 139571 vertices, 279138 faces
  Generating 20 random views...
  Generating predictions for 20 views (continuous camera pose)...
    ✓ Random_0 (pose=(-1.0272948415800562, 1.9071897558194948, 2.858754735155653)): shape (37, 800, 800)
      Valid pixels: 108988/640000 (17.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=333, max=279069, num_faces=279138
      Valid probs shape: (37, 108988)
    ✓ Random_1 (pose=(1.0344906829593015, -0.5256504030094846, -0.6100006120221564)): shape (37, 800, 800)
      Valid pixels: 94181/640000 (14.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7, max=279069, num_faces=279138
      Valid probs shape: (37, 94181)
    ✓ Random_2 (pose=(-0.5456697747761927, -0.9838052558066139, 0.39259060047143857)): shape (37, 800, 800)
      Valid pixels: 66817/640000 (10.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=279072, num_faces=279138
      Valid probs shape: (37, 66817)
    ✓ Random_3 (pose=(2.8552644665451314, 0.3766444840517642, -0.18786868959110947)): shape (37, 800, 800)
      Valid pixels: 61605/640000 (9.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1072, max=279127, num_faces=279138
      Valid probs shape: (37, 61605)
    ✓ Random_4 (pose=(-0.1935802489637215, -0.37185658337256955, 2.5291059455273173)): shape (37, 800, 800)
      Valid pixels: 72563/640000 (11.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=279068, num_faces=279138
      Valid probs shape: (37, 72563)
    ✓ Random_5 (pose=(-0.8145307956460277, 0.26357352029085845, 0.45979287492413157)): shape (37, 800, 800)
      Valid pixels: 83431/640000 (13.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=279019, num_faces=279138
      Valid probs shape: (37, 83431)
    ✓ Random_6 (pose=(-1.350392354925729, -1.1100335991590327, -0.282604595161303)): shape (37, 800, 800)
      Valid pixels: 110606/640000 (17.3%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=6, max=279134, num_faces=279138
      Valid probs shape: (37, 110606)
    ✓ Random_7 (pose=(3.0896688192336716, 2.4334928454139453, -0.008080765952223068)): shape (37, 800, 800)
      Valid pixels: 58125/640000 (9.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=279070, num_faces=279138
      Valid probs shape: (37, 58125)
    ✓ Random_8 (pose=(-3.0569484788932715, -0.48052486491401547, 2.3777370279894585)): shape (37, 800, 800)
      Valid pixels: 73710/640000 (11.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=12030, max=279137, num_faces=279138
      Valid probs shape: (37, 73710)
    ✓ Random_9 (pose=(-0.32773025839812986, 3.003998777174842, -2.438634034246582)): shape (37, 800, 800)
      Valid pixels: 56345/640000 (8.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=769, max=279137, num_faces=279138
      Valid probs shape: (37, 56345)
    ✓ Random_10 (pose=(0.42333023790652335, 0.2551309082982387, -0.8333134051676527)): shape (37, 800, 800)
      Valid pixels: 75502/640000 (11.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=279069, num_faces=279138
      Valid probs shape: (37, 75502)
    ✓ Random_11 (pose=(1.0762052748745212, -0.6542152843840445, 2.529049909309725)): shape (37, 800, 800)
      Valid pixels: 96383/640000 (15.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=279134, num_faces=279138
      Valid probs shape: (37, 96383)
    ✓ Random_12 (pose=(2.0551299839474115, 1.7315621656198408, -2.922477444015428)): shape (37, 800, 800)
      Valid pixels: 112905/640000 (17.6%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=5, max=279137, num_faces=279138
      Valid probs shape: (37, 112905)
    ✓ Random_13 (pose=(0.7476329025870583, -0.6769866878353086, 2.3694772437877702)): shape (37, 800, 800)
      Valid pixels: 70732/640000 (11.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=279129, num_faces=279138
      Valid probs shape: (37, 70732)
    ✓ Random_14 (pose=(-0.8052719764090672, 1.5084123918668624, -2.0355269393095483)): shape (37, 800, 800)
      Valid pixels: 109226/640000 (17.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=279070, num_faces=279138
      Valid probs shape: (37, 109226)
    ✓ Random_15 (pose=(-3.1118942478602176, 0.4173782651234381, -0.4646488445790071)): shape (37, 800, 800)
      Valid pixels: 70568/640000 (11.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=9017, max=279137, num_faces=279138
      Valid probs shape: (37, 70568)
    ✓ Random_16 (pose=(-2.0011941763151047, 2.4494583085100974, -2.373502530725353)): shape (37, 800, 800)
      Valid pixels: 81193/640000 (12.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=279070, num_faces=279138
      Valid probs shape: (37, 81193)
    ✓ Random_17 (pose=(-3.106685983630901, -0.8256880809334355, 3.000154475538597)): shape (37, 800, 800)
      Valid pixels: 72267/640000 (11.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4176, max=279072, num_faces=279138
      Valid probs shape: (37, 72267)
    ✓ Random_18 (pose=(3.012754989883973, -0.662932506639573, -1.6542668889598142)): shape (37, 800, 800)
      Valid pixels: 83207/640000 (13.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=451, max=279137, num_faces=279138
      Valid probs shape: (37, 83207)
    ✓ Random_19 (pose=(-0.06756151494983476, -3.0128210285796246, 0.9545426481992578)): shape (37, 800, 800)
      Valid pixels: 52555/640000 (8.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6551, max=279137, num_faces=279138
      Valid probs shape: (37, 52555)
    P stats: min=0.0000, max=1.0000, mean=0.0238
    Non-zero vertices: 122808/139571
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 16763  1037  1264  2796     0  2145   843  5167  5956]
  Ground Truth Stats:
    Labels shape: (139571,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-8/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7492
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8225
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8235

  RESULTS:
  RAW:         median(top-10)=0.8659, mean(top-10)=0.8709, median(all)=0.8046, mean(all)=0.7492
  + SMOOTHING: median(top-10)=0.9209, mean(top-10)=0.9236, median(all)=0.8564, mean(all)=0.8225 [+0.0550]
  + MRF:       median(top-10)=0.9213, mean(top-10)=0.9241, median(all)=0.8579, mean(all)=0.8235 [+0.0004]
  TOTAL IMPROVEMENT (median top-10): +0.0554

================================================================================
Subject: OASIS-TRT-20-9
================================================================================
  Step 0: Generating predictions with V2 model (20 random views)...
  Mesh: 134960 vertices, 269916 faces
  Generating 20 random views...
  Generating predictions for 20 views (continuous camera pose)...
    ✓ Random_0 (pose=(-2.1499005929510147, 2.563297519742341, -2.8104928324655667)): shape (37, 800, 800)
      Valid pixels: 68150/640000 (10.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=269780, num_faces=269916
      Valid probs shape: (37, 68150)
    ✓ Random_1 (pose=(2.8581814772908647, 2.9901435109891956, -2.0464201702552103)): shape (37, 800, 800)
      Valid pixels: 47420/640000 (7.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=269805, num_faces=269916
      Valid probs shape: (37, 47420)
    ✓ Random_2 (pose=(-0.5734312346410557, 2.866796625571099, 3.0118626350817213)): shape (37, 800, 800)
      Valid pixels: 61418/640000 (9.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1819, max=269911, num_faces=269916
      Valid probs shape: (37, 61418)
    ✓ Random_3 (pose=(-0.058315158426031743, 0.6526625548943366, -3.106849784341733)): shape (37, 800, 800)
      Valid pixels: 50704/640000 (7.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=269775, num_faces=269916
      Valid probs shape: (37, 50704)
    ✓ Random_4 (pose=(-0.44663093306738366, 1.227034433212654, -2.7171481112994296)): shape (37, 800, 800)
      Valid pixels: 90987/640000 (14.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=17, max=269906, num_faces=269916
      Valid probs shape: (37, 90987)
    ✓ Random_5 (pose=(2.064080704145904, 0.4768891476279764, 1.109663745446805)): shape (37, 800, 800)
      Valid pixels: 64364/640000 (10.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1202, max=269877, num_faces=269916
      Valid probs shape: (37, 64364)
    ✓ Random_6 (pose=(2.630522521291616, 0.4277921949474863, 2.7018085367724147)): shape (37, 800, 800)
      Valid pixels: 65124/640000 (10.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=20514, max=269914, num_faces=269916
      Valid probs shape: (37, 65124)
    ✓ Random_7 (pose=(-1.0309197236989327, 2.717633023152212, 2.835997745319971)): shape (37, 800, 800)
      Valid pixels: 85149/640000 (13.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=190, max=269912, num_faces=269916
      Valid probs shape: (37, 85149)
    ✓ Random_8 (pose=(0.9913906666173542, 1.9841878581446375, -2.7709696771870327)): shape (37, 800, 800)
      Valid pixels: 67810/640000 (10.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=49, max=269915, num_faces=269916
      Valid probs shape: (37, 67810)
    ✓ Random_9 (pose=(0.015763083327999805, -1.1031703087969467, 2.4966849134792017)): shape (37, 800, 800)
      Valid pixels: 63713/640000 (10.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=269808, num_faces=269916
      Valid probs shape: (37, 63713)
    ✓ Random_10 (pose=(-2.7192440501543818, -1.4425318115874888, -2.6930396864748705)): shape (37, 800, 800)
      Valid pixels: 93086/640000 (14.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=34, max=269912, num_faces=269916
      Valid probs shape: (37, 93086)
    ✓ Random_11 (pose=(1.8128316717114323, -0.6560243645415293, -0.42500745815971186)): shape (37, 800, 800)
      Valid pixels: 94893/640000 (14.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=269906, num_faces=269916
      Valid probs shape: (37, 94893)
    ✓ Random_12 (pose=(-0.2978830538196031, 0.5763045282413972, -0.6142753178385312)): shape (37, 800, 800)
      Valid pixels: 49420/640000 (7.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=269489, num_faces=269916
      Valid probs shape: (37, 49420)
    ✓ Random_13 (pose=(-0.23316176226855223, -2.5942247033188277, -1.8055489612840325)): shape (37, 800, 800)
      Valid pixels: 69096/640000 (10.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=14277, max=269915, num_faces=269916
      Valid probs shape: (37, 69096)
    ✓ Random_14 (pose=(-0.6659132914501278, -2.528747607798451, -2.645356900182348)): shape (37, 800, 800)
      Valid pixels: 56177/640000 (8.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1355, max=269910, num_faces=269916
      Valid probs shape: (37, 56177)
    ✓ Random_15 (pose=(-0.8340617699219415, -0.637454533001633, -0.023224404112718755)): shape (37, 800, 800)
      Valid pixels: 64040/640000 (10.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=269860, num_faces=269916
      Valid probs shape: (37, 64040)
    ✓ Random_16 (pose=(2.6009251896026013, -2.538510309316509, 0.4798141310163122)): shape (37, 800, 800)
      Valid pixels: 53449/640000 (8.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=269620, num_faces=269916
      Valid probs shape: (37, 53449)
    ✓ Random_17 (pose=(-1.3176691147573336, 0.017336433738365464, 0.4933775802199607)): shape (37, 800, 800)
      Valid pixels: 70367/640000 (11.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=269878, num_faces=269916
      Valid probs shape: (37, 70367)
    ✓ Random_18 (pose=(2.600278233031589, 1.4474868980229783, 0.6955606224097908)): shape (37, 800, 800)
      Valid pixels: 96202/640000 (15.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=269905, num_faces=269916
      Valid probs shape: (37, 96202)
    ✓ Random_19 (pose=(1.424941888653831, 0.4906594910184472, -2.7229673104898287)): shape (37, 800, 800)
      Valid pixels: 72015/640000 (11.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=14, max=269915, num_faces=269916
      Valid probs shape: (37, 72015)
    P stats: min=0.0000, max=1.0000, mean=0.0227
    Non-zero vertices: 113339/134960
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 21621   566   969  2430     0  1969  1313  5090  5163]
  Ground Truth Stats:
    Labels shape: (134960,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-9/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7106
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=33
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7805
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=33
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7809

  RESULTS:
  RAW:         median(top-10)=0.8798, mean(top-10)=0.8810, median(all)=0.7715, mean(all)=0.7106
  + SMOOTHING: median(top-10)=0.9153, mean(top-10)=0.9147, median(all)=0.8351, mean(all)=0.7805 [+0.0355]
  + MRF:       median(top-10)=0.9156, mean(top-10)=0.9149, median(all)=0.8354, mean(all)=0.7809 [+0.0004]
  TOTAL IMPROVEMENT (median top-10): +0.0358

================================================================================
Subject: Twins-2-1
================================================================================
  Step 0: Generating predictions with V2 model (20 random views)...
  Mesh: 145069 vertices, 290134 faces
  Generating 20 random views...
  Generating predictions for 20 views (continuous camera pose)...
    ✓ Random_0 (pose=(-2.667431794336593, -0.4010573908682007, -0.147501889606807)): shape (37, 800, 800)
      Valid pixels: 83788/640000 (13.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=28644, max=290131, num_faces=290134
      Valid probs shape: (37, 83788)
    ✓ Random_1 (pose=(-1.033625141676458, 1.578309753335235, 1.1673440464312517)): shape (37, 800, 800)
      Valid pixels: 93307/640000 (14.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=290132, num_faces=290134
      Valid probs shape: (37, 93307)
    ✓ Random_2 (pose=(-0.557783106431736, -1.1979089390487747, -0.5100434712212016)): shape (37, 800, 800)
      Valid pixels: 94368/640000 (14.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=2, max=290132, num_faces=290134
      Valid probs shape: (37, 94368)
    ✓ Random_3 (pose=(1.403011029102979, 1.4448362240455834, -2.3718792364235393)): shape (37, 800, 800)
      Valid pixels: 85473/640000 (13.4%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=6, max=290132, num_faces=290134
      Valid probs shape: (37, 85473)
    ✓ Random_4 (pose=(-1.5013149287804894, -3.1069457734067427, 2.1737853717019417)): shape (37, 800, 800)
      Valid pixels: 109662/640000 (17.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=14, max=290133, num_faces=290134
      Valid probs shape: (37, 109662)
    ✓ Random_5 (pose=(-1.2242527297662977, -3.0800582272794963, -0.6034084216622073)): shape (37, 800, 800)
      Valid pixels: 112979/640000 (17.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=40, max=290131, num_faces=290134
      Valid probs shape: (37, 112979)
    ✓ Random_6 (pose=(0.5474643179047289, 2.0811100749549976, 1.3192903552572623)): shape (37, 800, 800)
      Valid pixels: 105140/640000 (16.4%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=9390, max=290131, num_faces=290134
      Valid probs shape: (37, 105140)
    ✓ Random_7 (pose=(3.0877661887832977, 2.7321115224372567, -1.8177191573108613)): shape (37, 800, 800)
      Valid pixels: 76581/640000 (12.0%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=1, max=290024, num_faces=290134
      Valid probs shape: (37, 76581)
    ✓ Random_8 (pose=(1.9283401767189075, -0.39962163021154407, -1.4770146899482166)): shape (37, 800, 800)
      Valid pixels: 88047/640000 (13.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=935, max=290133, num_faces=290134
      Valid probs shape: (37, 88047)
    ✓ Random_9 (pose=(-0.9335673128205064, -0.08058026043467725, -0.12187803649982554)): shape (37, 800, 800)
      Valid pixels: 103252/640000 (16.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=3, max=290034, num_faces=290134
      Valid probs shape: (37, 103252)
    ✓ Random_10 (pose=(0.1624135863543441, -0.5839787335517213, 1.6924590333973866)): shape (37, 800, 800)
      Valid pixels: 83313/640000 (13.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=290132, num_faces=290134
      Valid probs shape: (37, 83313)
    ✓ Random_11 (pose=(-1.1458544177811898, 0.07043617418554105, 1.3800051797968083)): shape (37, 800, 800)
      Valid pixels: 66391/640000 (10.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=11, max=290133, num_faces=290134
      Valid probs shape: (37, 66391)
    ✓ Random_12 (pose=(-1.9966368248491677, -0.2814607419306112, -0.04899572879892089)): shape (37, 800, 800)
      Valid pixels: 112225/640000 (17.5%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=1340, max=290132, num_faces=290134
      Valid probs shape: (37, 112225)
    ✓ Random_13 (pose=(0.006690412351513686, 2.900253671730436, 2.049015131334621)): shape (37, 800, 800)
      Valid pixels: 69587/640000 (10.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=17943, max=290132, num_faces=290134
      Valid probs shape: (37, 69587)
    ✓ Random_14 (pose=(0.26349457204718263, -0.008458130870328429, 2.4417590576211454)): shape (37, 800, 800)
      Valid pixels: 68380/640000 (10.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=287838, num_faces=290134
      Valid probs shape: (37, 68380)
    ✓ Random_15 (pose=(0.289033699733928, -1.9016666690728505, 1.0396731423561114)): shape (37, 800, 800)
      Valid pixels: 124015/640000 (19.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=74, max=290133, num_faces=290134
      Valid probs shape: (37, 124015)
    ✓ Random_16 (pose=(1.3492559815917948, 2.181277773490697, -1.2208727962253538)): shape (37, 800, 800)
      Valid pixels: 106437/640000 (16.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=306, max=290133, num_faces=290134
      Valid probs shape: (37, 106437)
    ✓ Random_17 (pose=(-0.30108436152596685, -0.554130887144249, -1.3298083249819377)): shape (37, 800, 800)
      Valid pixels: 90542/640000 (14.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=289392, num_faces=290134
      Valid probs shape: (37, 90542)
    ✓ Random_18 (pose=(-1.2991459610636606, -0.81082924613544, 0.061701850658058444)): shape (37, 800, 800)
      Valid pixels: 103676/640000 (16.2%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=4, max=290133, num_faces=290134
      Valid probs shape: (37, 103676)
    ✓ Random_19 (pose=(0.8102589293736773, -1.7608902682320415, -2.2241360809653736)): shape (37, 800, 800)
      Valid pixels: 108036/640000 (16.9%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=2, max=290132, num_faces=290134
      Valid probs shape: (37, 108036)
    P stats: min=0.0000, max=1.0000, mean=0.0240
    Non-zero vertices: 129002/145069
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 16067  1214   770  3474     0  1470   843  5192  6330]
  Ground Truth Stats:
    Labels shape: (145069,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/Twins-2-1/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
    MRF iteration 5/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7480
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8208
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8209

  RESULTS:
  RAW:         median(top-10)=0.8873, mean(top-10)=0.8856, median(all)=0.8006, mean(all)=0.7480
  + SMOOTHING: median(top-10)=0.9211, mean(top-10)=0.9209, median(all)=0.8564, mean(all)=0.8208 [+0.0337]
  + MRF:       median(top-10)=0.9218, mean(top-10)=0.9213, median(all)=0.8565, mean(all)=0.8209 [+0.0007]
  TOTAL IMPROVEMENT (median top-10): +0.0344

================================================================================
Subject: Twins-2-2
================================================================================
  Step 0: Generating predictions with V2 model (20 random views)...
  Mesh: 149751 vertices, 299498 faces
  Generating 20 random views...
  Generating predictions for 20 views (continuous camera pose)...
    ✓ Random_0 (pose=(2.3015209455895578, -2.627183951905986, 2.299764633376168)): shape (37, 800, 800)
      Valid pixels: 126636/640000 (19.8%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=1, max=298364, num_faces=299498
      Valid probs shape: (37, 126636)
    ✓ Random_1 (pose=(-3.1025711233780333, 0.8492683513677455, -1.456857108896632)): shape (37, 800, 800)
      Valid pixels: 109660/640000 (17.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=6736, max=299256, num_faces=299498
      Valid probs shape: (37, 109660)
    ✓ Random_2 (pose=(1.965027617702007, -1.6298375290505136, -2.039815303606137)): shape (37, 800, 800)
      Valid pixels: 82226/640000 (12.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=140, max=299496, num_faces=299498
      Valid probs shape: (37, 82226)
    ✓ Random_3 (pose=(2.3014420467631878, 3.0147529658653083, -1.735959876362494)): shape (37, 800, 800)
      Valid pixels: 71742/640000 (11.2%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=0, max=299009, num_faces=299498
      Valid probs shape: (37, 71742)
    ✓ Random_4 (pose=(-0.5203823095275086, 0.002796947740406619, 0.32261559236489656)): shape (37, 800, 800)
      Valid pixels: 95484/640000 (14.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=298362, num_faces=299498
      Valid probs shape: (37, 95484)
    ✓ Random_5 (pose=(-2.0475595329450673, -1.02240638150155, -0.6961281975957672)): shape (37, 800, 800)
      Valid pixels: 108485/640000 (17.0%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=98, max=299115, num_faces=299498
      Valid probs shape: (37, 108485)
    ✓ Random_6 (pose=(1.3419238584854138, -0.020708884616337464, 0.9201593778879706)): shape (37, 800, 800)
      Valid pixels: 101127/640000 (15.8%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=1, max=299492, num_faces=299498
      Valid probs shape: (37, 101127)
    ✓ Random_7 (pose=(0.2905598127681901, 0.7366524267511152, 1.3446002449890946)): shape (37, 800, 800)
      Valid pixels: 118551/640000 (18.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=0, max=298364, num_faces=299498
      Valid probs shape: (37, 118551)
    ✓ Random_8 (pose=(1.8720641394606456, 2.009881961189037, -1.079312175601789)): shape (37, 800, 800)
      Valid pixels: 88359/640000 (13.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=299492, num_faces=299498
      Valid probs shape: (37, 88359)
    ✓ Random_9 (pose=(-2.8131314929617153, 2.3762615372447904, -1.6351286578096578)): shape (37, 800, 800)
      Valid pixels: 121185/640000 (18.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=298364, num_faces=299498
      Valid probs shape: (37, 121185)
    ✓ Random_10 (pose=(0.7362743904390263, 1.0972233234768778, 2.9746808089800894)): shape (37, 800, 800)
      Valid pixels: 102397/640000 (16.0%)
      Probs stats: min=0.0000, max=0.9994, mean=0.0270
      Face IDs: min=5, max=298364, num_faces=299498
      Valid probs shape: (37, 102397)
    ✓ Random_11 (pose=(0.02384910416439512, 2.8549966912249056, 1.5847543294439257)): shape (37, 800, 800)
      Valid pixels: 80435/640000 (12.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=22863, max=299452, num_faces=299498
      Valid probs shape: (37, 80435)
    ✓ Random_12 (pose=(1.220595519767496, 2.8210760761538696, 2.9955534172417453)): shape (37, 800, 800)
      Valid pixels: 123970/640000 (19.4%)
      Probs stats: min=0.0000, max=0.9994, mean=0.0270
      Face IDs: min=186, max=299256, num_faces=299498
      Valid probs shape: (37, 123970)
    ✓ Random_13 (pose=(-1.9383214865197145, 3.0090790156039544, 1.9302443786828372)): shape (37, 800, 800)
      Valid pixels: 90733/640000 (14.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=299497, num_faces=299498
      Valid probs shape: (37, 90733)
    ✓ Random_14 (pose=(1.6618999658770628, -0.1565542677887941, -1.7258770207763459)): shape (37, 800, 800)
      Valid pixels: 85528/640000 (13.4%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=253, max=299496, num_faces=299498
      Valid probs shape: (37, 85528)
    ✓ Random_15 (pose=(1.8978792176020969, 1.9187024734130924, -1.3395927697250385)): shape (37, 800, 800)
      Valid pixels: 80083/640000 (12.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=29, max=299496, num_faces=299498
      Valid probs shape: (37, 80083)
    ✓ Random_16 (pose=(1.6291535928356549, -2.4092580838570252, 2.2347417640477536)): shape (37, 800, 800)
      Valid pixels: 125562/640000 (19.6%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=2, max=298364, num_faces=299498
      Valid probs shape: (37, 125562)
    ✓ Random_17 (pose=(1.8581334484445726, 1.2993192270526164, 0.5051398117498676)): shape (37, 800, 800)
      Valid pixels: 133696/640000 (20.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=0, max=299497, num_faces=299498
      Valid probs shape: (37, 133696)
    ✓ Random_18 (pose=(2.221297036337827, -0.34417955631382435, 2.372037479128844)): shape (37, 800, 800)
      Valid pixels: 115846/640000 (18.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=8379, max=299256, num_faces=299498
      Valid probs shape: (37, 115846)
    ✓ Random_19 (pose=(0.5068320982852863, -1.7385100812867507, 2.6229247609688144)): shape (37, 800, 800)
      Valid pixels: 77735/640000 (12.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=298436, num_faces=299498
      Valid probs shape: (37, 77735)
    P stats: min=0.0000, max=0.9999, mean=0.0241
    Non-zero vertices: 133673/149751
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 16078   880  1021  3817     0  1861   812  4759  6344]
  Ground Truth Stats:
    Labels shape: (149751,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/Twins-2-2/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
    MRF iteration 5/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7275
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7910
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7916

  RESULTS:
  RAW:         median(top-10)=0.8788, mean(top-10)=0.8810, median(all)=0.7739, mean(all)=0.7275
  + SMOOTHING: median(top-10)=0.9143, mean(top-10)=0.9133, median(all)=0.8351, mean(all)=0.7910 [+0.0355]
  + MRF:       median(top-10)=0.9155, mean(top-10)=0.9139, median(all)=0.8356, mean(all)=0.7916 [+0.0012]
  TOTAL IMPROVEMENT (median top-10): +0.0367

================================================================================
AGGREGATE RESULTS ACROSS ALL TEST SUBJECTS
================================================================================
Number of subjects: 101

RAW PREDICTIONS:
  Median(top-10):  0.8793 ± 0.0153  (min: 0.8331, max: 0.9136)
  Mean(top-10):    0.8838 ± 0.0130  (min: 0.8412, max: 0.9131)
  Median(all):     0.7965 ± 0.0229  (min: 0.7216, max: 0.8533)
  Mean(all):       0.7380 ± 0.0211  (min: 0.6639, max: 0.7726)

+ SMOOTHING (α=0.75, 20 iter):
  Median(top-10):  0.9160 ± 0.0109  (min: 0.8814, max: 0.9417)
  Mean(top-10):    0.9185 ± 0.0094  (min: 0.8828, max: 0.9396)
  Median(all):     0.8558 ± 0.0194  (min: 0.8009, max: 0.8981)
  Mean(all):       0.8057 ± 0.0196  (min: 0.7265, max: 0.8392)
  Improvement:     median(top-10) +0.0367, mean(all) +0.0677

+ MRF (β=0.1, 5 iter):
  Median(top-10):  0.9163 ± 0.0108  (min: 0.8815, max: 0.9424)
  Mean(top-10):    0.9188 ± 0.0094  (min: 0.8830, max: 0.9396)
  Median(all):     0.8562 ± 0.0194  (min: 0.8007, max: 0.8994)
  Mean(all):       0.8062 ± 0.0190  (min: 0.7269, max: 0.8393)
  Improvement:     median(top-10) +0.0003, mean(all) +0.0005

TOTAL IMPROVEMENT (RAW → MRF):
  Median(top-10):  +0.0370
  Mean(top-10):    +0.0350
  Median(all):     +0.0597
  Mean(all):       +0.0682
================================================================================
