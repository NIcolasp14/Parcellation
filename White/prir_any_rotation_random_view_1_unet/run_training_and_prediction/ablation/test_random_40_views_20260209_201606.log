nohup: ignoring input
[GPU] PyTorch3D loaded - GPU raycasting AVAILABLE (FAST MODE: bin_size=None)
[GPU] PyTorch3D loaded - GPU raycasting AVAILABLE (will be enabled via --raycasting arg)
Using 40 random views for testing
Auto-detected latest checkpoint: last.ckpt

Loading model from: /autofs/space/ballarat_004/users/np341/PRIR_Code/Training/White/prir_x_y_z_conditional_1_unet/models/xyz_random_views_7794326/last.ckpt
✓ Model loaded (using TRAIN mode due to corrupted BN running stats)

================================================================================
Testing VIEW-CONDITIONED model V2 (Arbitrary Views) with PyTorch3D pipeline
Checkpoint: /autofs/space/ballarat_004/users/np341/PRIR_Code/Training/White/prir_x_y_z_conditional_1_unet/models/xyz_random_views_7794326/last.ckpt
Test data: /autofs/space/ballarat_004/users/np341/mindboggle2
Using 40 random views per subject
1. Generate predictions using V2 model (continuous camera pose)
2. Iterative smoothing (α=0.75, 20 iter)
3. MRF with ICM (β=0.1)
================================================================================

Found 101 test subjects

================================================================================
Subject: Afterthought-1
================================================================================
  Step 0: Generating predictions with V2 model (40 random views)...
  Mesh: 130921 vertices, 261838 faces
  Generating 40 random views...
  Generating predictions for 40 views (continuous camera pose)...
    ✓ Random_0 (pose=(2.3322560425688073, 0.9230250827052391, -2.4997157452571965)): shape (37, 800, 800)
      Valid pixels: 92887/640000 (14.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=737, max=261837, num_faces=261838
      Valid probs shape: (37, 92887)
    ✓ Random_1 (pose=(0.43932145300166603, 0.6040725967643263, -2.2905079196000884)): shape (37, 800, 800)
      Valid pixels: 59313/640000 (9.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=261786, num_faces=261838
      Valid probs shape: (37, 59313)
    ✓ Random_2 (pose=(0.9234072726243454, -1.5343591686913334, 0.6796132969400297)): shape (37, 800, 800)
      Valid pixels: 101858/640000 (15.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=261837, num_faces=261838
      Valid probs shape: (37, 101858)
    ✓ Random_3 (pose=(2.0008270962592594, 3.0377988067629227, -2.6676604100532266)): shape (37, 800, 800)
      Valid pixels: 80520/640000 (12.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=3, max=261786, num_faces=261838
      Valid probs shape: (37, 80520)
    ✓ Random_4 (pose=(-0.13046115835838545, 0.4725164021972472, -2.9719463965361728)): shape (37, 800, 800)
      Valid pixels: 57896/640000 (9.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=261518, num_faces=261838
      Valid probs shape: (37, 57896)
    ✓ Random_5 (pose=(2.0595282779605126, -1.1633909697843425, -1.561893476680083)): shape (37, 800, 800)
      Valid pixels: 93819/640000 (14.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=146, max=261836, num_faces=261838
      Valid probs shape: (37, 93819)
    ✓ Random_6 (pose=(2.3209154845824393, 0.4625874003784909, -1.3223323947124805)): shape (37, 800, 800)
      Valid pixels: 67062/640000 (10.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2968, max=261836, num_faces=261838
      Valid probs shape: (37, 67062)
    ✓ Random_7 (pose=(3.0860346148566986, 0.7329537466902409, 0.29096371505523155)): shape (37, 800, 800)
      Valid pixels: 71552/640000 (11.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1683, max=261836, num_faces=261838
      Valid probs shape: (37, 71552)
    ✓ Random_8 (pose=(0.49301913328415514, 2.665240673627098, 1.3822215015471455)): shape (37, 800, 800)
      Valid pixels: 74510/640000 (11.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=24867, max=261837, num_faces=261838
      Valid probs shape: (37, 74510)
    ✓ Random_9 (pose=(-0.10613727922199301, 0.7458495325661065, -3.0623776514849554)): shape (37, 800, 800)
      Valid pixels: 61841/640000 (9.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6, max=261786, num_faces=261838
      Valid probs shape: (37, 61841)
    ✓ Random_10 (pose=(1.011817297048105, -3.1335218123012782, -2.7670414432655646)): shape (37, 800, 800)
      Valid pixels: 82759/640000 (12.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=3014, max=261835, num_faces=261838
      Valid probs shape: (37, 82759)
    ✓ Random_11 (pose=(-0.2121717600988049, 1.2306838680386623, 1.3787060461278973)): shape (37, 800, 800)
      Valid pixels: 90855/640000 (14.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=3, max=261782, num_faces=261838
      Valid probs shape: (37, 90855)
    ✓ Random_12 (pose=(-0.7862375621177482, -1.3269702114750652, 0.7755523546189149)): shape (37, 800, 800)
      Valid pixels: 70130/640000 (11.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=261835, num_faces=261838
      Valid probs shape: (37, 70130)
    ✓ Random_13 (pose=(3.0586919992403727, 2.6859871516009504, 1.4081280903872369)): shape (37, 800, 800)
      Valid pixels: 63126/640000 (9.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=261836, num_faces=261838
      Valid probs shape: (37, 63126)
    ✓ Random_14 (pose=(2.2056369815107146, 0.8490094313951704, 1.0305462181733986)): shape (37, 800, 800)
      Valid pixels: 84644/640000 (13.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=261837, num_faces=261838
      Valid probs shape: (37, 84644)
    ✓ Random_15 (pose=(-2.8869792076931837, -0.34422702582097475, -0.4362117400194139)): shape (37, 800, 800)
      Valid pixels: 58655/640000 (9.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=58555, max=261837, num_faces=261838
      Valid probs shape: (37, 58655)
    ✓ Random_16 (pose=(0.3970171459230434, 1.3105964656572686, 1.4094861798749303)): shape (37, 800, 800)
      Valid pixels: 101173/640000 (15.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=261706, num_faces=261838
      Valid probs shape: (37, 101173)
    ✓ Random_17 (pose=(-1.3665478484553544, 2.2600308019689868, 1.5587451083270079)): shape (37, 800, 800)
      Valid pixels: 72135/640000 (11.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=108, max=261837, num_faces=261838
      Valid probs shape: (37, 72135)
    ✓ Random_18 (pose=(-0.3600058978713374, -1.2244607421097398, -0.09074761689671274)): shape (37, 800, 800)
      Valid pixels: 71918/640000 (11.2%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=5, max=261832, num_faces=261838
      Valid probs shape: (37, 71918)
    ✓ Random_19 (pose=(2.0468958917794975, 1.3531106876207737, -2.429518268182672)): shape (37, 800, 800)
      Valid pixels: 88603/640000 (13.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=290, max=261837, num_faces=261838
      Valid probs shape: (37, 88603)
    ✓ Random_20 (pose=(2.461234035317837, -2.480864475654218, -2.836049162013361)): shape (37, 800, 800)
      Valid pixels: 68167/640000 (10.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=3, max=261786, num_faces=261838
      Valid probs shape: (37, 68167)
    ✓ Random_21 (pose=(-1.543448133309273, 2.4883687321087793, 1.3874231284247065)): shape (37, 800, 800)
      Valid pixels: 71789/640000 (11.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=109, max=261837, num_faces=261838
      Valid probs shape: (37, 71789)
    ✓ Random_22 (pose=(1.9029899530144325, 2.827656446011723, -0.29493943716229154)): shape (37, 800, 800)
      Valid pixels: 101853/640000 (15.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=261834, num_faces=261838
      Valid probs shape: (37, 101853)
    ✓ Random_23 (pose=(0.5026853261445776, 1.4809090648017484, -1.3217511240570137)): shape (37, 800, 800)
      Valid pixels: 106773/640000 (16.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=261837, num_faces=261838
      Valid probs shape: (37, 106773)
    ✓ Random_24 (pose=(1.3357735225212135, -0.04641702501164202, 1.7387221910420951)): shape (37, 800, 800)
      Valid pixels: 75603/640000 (11.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=261704, num_faces=261838
      Valid probs shape: (37, 75603)
    ✓ Random_25 (pose=(-0.09739720376977745, 2.34238758917765, 2.551376338228521)): shape (37, 800, 800)
      Valid pixels: 67488/640000 (10.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2011, max=261836, num_faces=261838
      Valid probs shape: (37, 67488)
    ✓ Random_26 (pose=(0.3057732334898864, -0.8623925901845069, -2.798747084844003)): shape (37, 800, 800)
      Valid pixels: 86615/640000 (13.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=261692, num_faces=261838
      Valid probs shape: (37, 86615)
    ✓ Random_27 (pose=(-1.0316918071232997, 0.8356477300138581, 0.2900806750947882)): shape (37, 800, 800)
      Valid pixels: 94148/640000 (14.7%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=3, max=261742, num_faces=261838
      Valid probs shape: (37, 94148)
    ✓ Random_28 (pose=(0.2552214709946785, -1.8314068496729194, 1.030077870671387)): shape (37, 800, 800)
      Valid pixels: 106203/640000 (16.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=47, max=261837, num_faces=261838
      Valid probs shape: (37, 106203)
    ✓ Random_29 (pose=(0.06270803661147495, 2.3755674398936932, 0.7784583413004795)): shape (37, 800, 800)
      Valid pixels: 82378/640000 (12.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8287, max=261832, num_faces=261838
      Valid probs shape: (37, 82378)
    ✓ Random_30 (pose=(-2.7139656478764698, 0.861744631563913, -1.1790726363477149)): shape (37, 800, 800)
      Valid pixels: 89753/640000 (14.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6208, max=261837, num_faces=261838
      Valid probs shape: (37, 89753)
    ✓ Random_31 (pose=(2.779166194659491, 0.3050316702648579, -0.23405214913903416)): shape (37, 800, 800)
      Valid pixels: 62898/640000 (9.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1630, max=261837, num_faces=261838
      Valid probs shape: (37, 62898)
    ✓ Random_32 (pose=(2.5684212750134217, -0.2927764212782953, 2.8934945292897565)): shape (37, 800, 800)
      Valid pixels: 76623/640000 (12.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3945, max=261837, num_faces=261838
      Valid probs shape: (37, 76623)
    ✓ Random_33 (pose=(3.126467476184623, -1.8583755971110807, 1.9809035128387702)): shape (37, 800, 800)
      Valid pixels: 82563/640000 (12.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=6, max=261786, num_faces=261838
      Valid probs shape: (37, 82563)
    ✓ Random_34 (pose=(1.0722082855165054, -1.1137030108226815, 0.009084509757419479)): shape (37, 800, 800)
      Valid pixels: 104728/640000 (16.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=261837, num_faces=261838
      Valid probs shape: (37, 104728)
    ✓ Random_35 (pose=(2.6796185867675346, 1.7559833462339869, -0.9834498980738844)): shape (37, 800, 800)
      Valid pixels: 74155/640000 (11.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=10, max=261837, num_faces=261838
      Valid probs shape: (37, 74155)
    ✓ Random_36 (pose=(-0.004953288477953954, 2.5120497261933163, -3.0747056400874433)): shape (37, 800, 800)
      Valid pixels: 59674/640000 (9.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1849, max=261835, num_faces=261838
      Valid probs shape: (37, 59674)
    ✓ Random_37 (pose=(2.0993629499630497, -3.0397586480682635, -1.9462496002822454)): shape (37, 800, 800)
      Valid pixels: 66298/640000 (10.4%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=14, max=261820, num_faces=261838
      Valid probs shape: (37, 66298)
    ✓ Random_38 (pose=(-2.659424146079769, -0.5327465146911607, -1.9176253263637655)): shape (37, 800, 800)
      Valid pixels: 73205/640000 (11.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=594, max=261837, num_faces=261838
      Valid probs shape: (37, 73205)
    ✓ Random_39 (pose=(2.7510221767215572, 2.754488320600556, -2.138936832140065)): shape (37, 800, 800)
      Valid pixels: 70020/640000 (10.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=261678, num_faces=261838
      Valid probs shape: (37, 70020)
    P stats: min=0.0000, max=1.0000, mean=0.0260
    Non-zero vertices: 125790/130921
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 5131 1445  945 3778    0 1913 1089 4043 6449]
  Ground Truth Stats:
    Labels shape: (130921,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/Afterthought-1/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.8047
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8508
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8510

  RESULTS:
  RAW:         median(top-10)=0.9121, mean(top-10)=0.9168, median(all)=0.8507, mean(all)=0.8047
  + SMOOTHING: median(top-10)=0.9290, mean(top-10)=0.9325, median(all)=0.8812, mean(all)=0.8508 [+0.0168]
  + MRF:       median(top-10)=0.9295, mean(top-10)=0.9329, median(all)=0.8816, mean(all)=0.8510 [+0.0005]
  TOTAL IMPROVEMENT (median top-10): +0.0173

================================================================================
Subject: Colin27-1
================================================================================
  Step 0: Generating predictions with V2 model (40 random views)...
  Mesh: 182414 vertices, 364824 faces
  Generating 40 random views...
  Generating predictions for 40 views (continuous camera pose)...
    ✓ Random_0 (pose=(-1.5045343339811599, -0.4887691474486928, 2.367922506454918)): shape (37, 800, 800)
      Valid pixels: 94652/640000 (14.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=90, max=364819, num_faces=364824
      Valid probs shape: (37, 94652)
    ✓ Random_1 (pose=(0.8366993821647886, -1.8506730486047696, -1.7288360346178733)): shape (37, 800, 800)
      Valid pixels: 71658/640000 (11.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=236, max=364823, num_faces=364824
      Valid probs shape: (37, 71658)
    ✓ Random_2 (pose=(-0.9022018774603957, -0.48415664736952735, 0.37801631211250486)): shape (37, 800, 800)
      Valid pixels: 65228/640000 (10.2%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=1, max=364543, num_faces=364824
      Valid probs shape: (37, 65228)
    ✓ Random_3 (pose=(0.5314823644471454, 2.278364070767834, 1.096423131219848)): shape (37, 800, 800)
      Valid pixels: 71264/640000 (11.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=10593, max=364175, num_faces=364824
      Valid probs shape: (37, 71264)
    ✓ Random_4 (pose=(-0.2842944330878052, 2.102502175439584, 2.4832460026907013)): shape (37, 800, 800)
      Valid pixels: 59393/640000 (9.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1704, max=364823, num_faces=364824
      Valid probs shape: (37, 59393)
    ✓ Random_5 (pose=(1.8895401798729035, 1.5462654002503928, -0.9549819414012557)): shape (37, 800, 800)
      Valid pixels: 72767/640000 (11.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=94, max=364821, num_faces=364824
      Valid probs shape: (37, 72767)
    ✓ Random_6 (pose=(-2.004269547273494, 1.021957066607964, -1.0224756933858687)): shape (37, 800, 800)
      Valid pixels: 91987/640000 (14.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=171, max=364173, num_faces=364824
      Valid probs shape: (37, 91987)
    ✓ Random_7 (pose=(3.1221428065468073, -2.319460296977278, 2.7902795223301107)): shape (37, 800, 800)
      Valid pixels: 54855/640000 (8.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=364823, num_faces=364824
      Valid probs shape: (37, 54855)
    ✓ Random_8 (pose=(-3.1325661951440327, 1.183043672083997, -1.8503901813392227)): shape (37, 800, 800)
      Valid pixels: 90473/640000 (14.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=852, max=364681, num_faces=364824
      Valid probs shape: (37, 90473)
    ✓ Random_9 (pose=(0.6813559278650367, -2.4787231327410106, -0.8875881973133861)): shape (37, 800, 800)
      Valid pixels: 54408/640000 (8.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1061, max=364823, num_faces=364824
      Valid probs shape: (37, 54408)
    ✓ Random_10 (pose=(0.5168759489456072, 0.21555879192402294, -2.678778354285008)): shape (37, 800, 800)
      Valid pixels: 55027/640000 (8.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=364823, num_faces=364824
      Valid probs shape: (37, 55027)
    ✓ Random_11 (pose=(-1.2064774801391682, -2.302743306821561, 0.34802665607971495)): shape (37, 800, 800)
      Valid pixels: 73167/640000 (11.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=238, max=364823, num_faces=364824
      Valid probs shape: (37, 73167)
    ✓ Random_12 (pose=(0.7111434167206263, -2.177555671497977, 1.5262903251495326)): shape (37, 800, 800)
      Valid pixels: 69461/640000 (10.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=621, max=364820, num_faces=364824
      Valid probs shape: (37, 69461)
    ✓ Random_13 (pose=(-2.7006694782894596, -1.0624269327956335, -1.9192305991475944)): shape (37, 800, 800)
      Valid pixels: 85031/640000 (13.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=485, max=364820, num_faces=364824
      Valid probs shape: (37, 85031)
    ✓ Random_14 (pose=(1.7929144327423634, -0.32051144117653996, -0.7694363663689363)): shape (37, 800, 800)
      Valid pixels: 93519/640000 (14.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=94, max=364819, num_faces=364824
      Valid probs shape: (37, 93519)
    ✓ Random_15 (pose=(-0.25540331380635095, -2.476183731962518, -1.0489220155622636)): shape (37, 800, 800)
      Valid pixels: 73802/640000 (11.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8709, max=364677, num_faces=364824
      Valid probs shape: (37, 73802)
    ✓ Random_16 (pose=(1.081422287865104, 0.378457054074008, 1.8413372503587366)): shape (37, 800, 800)
      Valid pixels: 73693/640000 (11.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=363708, num_faces=364824
      Valid probs shape: (37, 73693)
    ✓ Random_17 (pose=(-2.504393978437903, -1.5181468821983497, 0.9127161472948027)): shape (37, 800, 800)
      Valid pixels: 90039/640000 (14.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=127, max=364540, num_faces=364824
      Valid probs shape: (37, 90039)
    ✓ Random_18 (pose=(-0.5681194939305105, -0.2677037218925, -2.0591427788343193)): shape (37, 800, 800)
      Valid pixels: 48570/640000 (7.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=364675, num_faces=364824
      Valid probs shape: (37, 48570)
    ✓ Random_19 (pose=(1.2410577773115783, 0.08058662130035987, 2.7322376888610505)): shape (37, 800, 800)
      Valid pixels: 89753/640000 (14.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=364511, num_faces=364824
      Valid probs shape: (37, 89753)
    ✓ Random_20 (pose=(-2.5411602666298627, 2.2323241067221407, 2.5213137834247865)): shape (37, 800, 800)
      Valid pixels: 82003/640000 (12.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=364820, num_faces=364824
      Valid probs shape: (37, 82003)
    ✓ Random_21 (pose=(-1.4776243894811492, 1.022652388480835, -0.4515612216306053)): shape (37, 800, 800)
      Valid pixels: 93591/640000 (14.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=364686, num_faces=364824
      Valid probs shape: (37, 93591)
    ✓ Random_22 (pose=(0.8378881743748243, -1.569975574747061, 0.06256622760389297)): shape (37, 800, 800)
      Valid pixels: 96200/640000 (15.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=132, max=364819, num_faces=364824
      Valid probs shape: (37, 96200)
    ✓ Random_23 (pose=(0.6608088579529703, -2.4457516743052232, 0.9553653867652088)): shape (37, 800, 800)
      Valid pixels: 75441/640000 (11.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=571, max=364820, num_faces=364824
      Valid probs shape: (37, 75441)
    ✓ Random_24 (pose=(2.6351619795040877, -0.42182398365959006, 2.8451826304606067)): shape (37, 800, 800)
      Valid pixels: 68473/640000 (10.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6695, max=364541, num_faces=364824
      Valid probs shape: (37, 68473)
    ✓ Random_25 (pose=(1.8276479105433587, -0.2504552770275543, -2.2277466709426603)): shape (37, 800, 800)
      Valid pixels: 65296/640000 (10.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=264, max=364823, num_faces=364824
      Valid probs shape: (37, 65296)
    ✓ Random_26 (pose=(2.506571567576356, 1.154331485803345, -0.40066818246656055)): shape (37, 800, 800)
      Valid pixels: 68859/640000 (10.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=172, max=364823, num_faces=364824
      Valid probs shape: (37, 68859)
    ✓ Random_27 (pose=(0.9665510689262229, -1.9882952206797202, 2.027373521588312)): shape (37, 800, 800)
      Valid pixels: 55617/640000 (8.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=759, max=364662, num_faces=364824
      Valid probs shape: (37, 55617)
    ✓ Random_28 (pose=(2.7858156340604063, 2.3433586358463208, -2.9795445237744786)): shape (37, 800, 800)
      Valid pixels: 71594/640000 (11.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=364170, num_faces=364824
      Valid probs shape: (37, 71594)
    ✓ Random_29 (pose=(-0.44332450576956717, 0.19282830333681877, 2.8345733802937527)): shape (37, 800, 800)
      Valid pixels: 59933/640000 (9.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=364820, num_faces=364824
      Valid probs shape: (37, 59933)
    ✓ Random_30 (pose=(2.981802613281391, 0.4426145406822264, 1.8574414812652815)): shape (37, 800, 800)
      Valid pixels: 54314/640000 (8.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1384, max=364820, num_faces=364824
      Valid probs shape: (37, 54314)
    ✓ Random_31 (pose=(-2.8185791583868878, -2.884592960939899, 0.008363743308795524)): shape (37, 800, 800)
      Valid pixels: 56555/640000 (8.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=0, max=364536, num_faces=364824
      Valid probs shape: (37, 56555)
    ✓ Random_32 (pose=(-0.05561594040050455, -1.5117645010615535, -1.4107880677382687)): shape (37, 800, 800)
      Valid pixels: 86643/640000 (13.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=364540, num_faces=364824
      Valid probs shape: (37, 86643)
    ✓ Random_33 (pose=(0.032799625830752355, 0.9949264628352354, 1.1542685940170498)): shape (37, 800, 800)
      Valid pixels: 82832/640000 (12.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=364511, num_faces=364824
      Valid probs shape: (37, 82832)
    ✓ Random_34 (pose=(-2.8773702225074063, 1.0290810223664044, 1.9704233150290102)): shape (37, 800, 800)
      Valid pixels: 83534/640000 (13.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=94, max=364820, num_faces=364824
      Valid probs shape: (37, 83534)
    ✓ Random_35 (pose=(1.524421759313653, -1.8167790336298992, 0.193730293762028)): shape (37, 800, 800)
      Valid pixels: 94086/640000 (14.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=92, max=364820, num_faces=364824
      Valid probs shape: (37, 94086)
    ✓ Random_36 (pose=(-0.22292549810779194, 1.7500054999682204, 0.18167129158444784)): shape (37, 800, 800)
      Valid pixels: 75724/640000 (11.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=364170, num_faces=364824
      Valid probs shape: (37, 75724)
    ✓ Random_37 (pose=(1.1485045634371458, 2.76691332049573, -0.2835954544217629)): shape (37, 800, 800)
      Valid pixels: 91775/640000 (14.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=172, max=364820, num_faces=364824
      Valid probs shape: (37, 91775)
    ✓ Random_38 (pose=(0.159569889869422, 3.1128865504594314, 1.4262401630497648)): shape (37, 800, 800)
      Valid pixels: 44958/640000 (7.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=110231, max=364671, num_faces=364824
      Valid probs shape: (37, 44958)
    ✓ Random_39 (pose=(-0.9832228221472268, -1.4155153792501831, -1.521234709030554)): shape (37, 800, 800)
      Valid pixels: 85027/640000 (13.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=12, max=364170, num_faces=364824
      Valid probs shape: (37, 85027)
    P stats: min=0.0000, max=0.9999, mean=0.0260
    Non-zero vertices: 175524/182414
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 6890 1858 1649 4265    0 2654 1205 5408 9652]
  Ground Truth Stats:
    Labels shape: (182414,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/Colin27-1/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7753
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8198
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8201

  RESULTS:
  RAW:         median(top-10)=0.8857, mean(top-10)=0.8953, median(all)=0.8431, mean(all)=0.7753
  + SMOOTHING: median(top-10)=0.9087, mean(top-10)=0.9105, median(all)=0.8687, mean(all)=0.8198 [+0.0231]
  + MRF:       median(top-10)=0.9093, mean(top-10)=0.9108, median(all)=0.8691, mean(all)=0.8201 [+0.0006]
  TOTAL IMPROVEMENT (median top-10): +0.0237

================================================================================
Subject: HLN-12-1
================================================================================
  Step 0: Generating predictions with V2 model (40 random views)...
  Mesh: 138729 vertices, 277454 faces
  Generating 40 random views...
  Generating predictions for 40 views (continuous camera pose)...
    ✓ Random_0 (pose=(-7.083391186313293e-05, 3.0895657730571786, 1.9135961682065483)): shape (37, 800, 800)
      Valid pixels: 61526/640000 (9.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3118, max=277441, num_faces=277454
      Valid probs shape: (37, 61526)
    ✓ Random_1 (pose=(0.8377260700308495, 1.714924378867635, -1.958226178183814)): shape (37, 800, 800)
      Valid pixels: 87850/640000 (13.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=13, max=277453, num_faces=277454
      Valid probs shape: (37, 87850)
    ✓ Random_2 (pose=(-2.458405417093796, 0.06381865793168062, 2.3381373195370507)): shape (37, 800, 800)
      Valid pixels: 75101/640000 (11.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1528, max=277452, num_faces=277454
      Valid probs shape: (37, 75101)
    ✓ Random_3 (pose=(0.4473107959840976, 2.5583396992801894, -2.5712773341138)): shape (37, 800, 800)
      Valid pixels: 74902/640000 (11.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=2416, max=277452, num_faces=277454
      Valid probs shape: (37, 74902)
    ✓ Random_4 (pose=(-0.787057581748333, 2.1753448652552096, 2.6084978614901573)): shape (37, 800, 800)
      Valid pixels: 83669/640000 (13.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=52, max=277453, num_faces=277454
      Valid probs shape: (37, 83669)
    ✓ Random_5 (pose=(-2.884702022014977, 1.9931341182638551, -2.682897608948565)): shape (37, 800, 800)
      Valid pixels: 74324/640000 (11.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=277261, num_faces=277454
      Valid probs shape: (37, 74324)
    ✓ Random_6 (pose=(2.0240073951226067, -2.151942282225031, 2.2043980507763283)): shape (37, 800, 800)
      Valid pixels: 105155/640000 (16.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=277285, num_faces=277454
      Valid probs shape: (37, 105155)
    ✓ Random_7 (pose=(-1.9495929945356942, -0.6883511698665314, -2.4142002372599976)): shape (37, 800, 800)
      Valid pixels: 87047/640000 (13.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=277449, num_faces=277454
      Valid probs shape: (37, 87047)
    ✓ Random_8 (pose=(-2.6303063541233067, -2.102757474881288, 2.038623825598532)): shape (37, 800, 800)
      Valid pixels: 66906/640000 (10.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=277452, num_faces=277454
      Valid probs shape: (37, 66906)
    ✓ Random_9 (pose=(2.1255769283490205, -0.2591353237588243, -0.887044714979897)): shape (37, 800, 800)
      Valid pixels: 94953/640000 (14.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=13, max=277453, num_faces=277454
      Valid probs shape: (37, 94953)
    ✓ Random_10 (pose=(-1.0884984646090325, 0.10637316722656998, 1.707875309889773)): shape (37, 800, 800)
      Valid pixels: 68720/640000 (10.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6, max=277453, num_faces=277454
      Valid probs shape: (37, 68720)
    ✓ Random_11 (pose=(0.8278752755511363, -0.6866698260695254, 0.6322937754805147)): shape (37, 800, 800)
      Valid pixels: 101303/640000 (15.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=277453, num_faces=277454
      Valid probs shape: (37, 101303)
    ✓ Random_12 (pose=(0.718199959014632, -1.6206301658412792, -0.12105817389141382)): shape (37, 800, 800)
      Valid pixels: 101681/640000 (15.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=13, max=277453, num_faces=277454
      Valid probs shape: (37, 101681)
    ✓ Random_13 (pose=(-1.233343788174525, -0.44369308995183365, 1.5868905724619307)): shape (37, 800, 800)
      Valid pixels: 75206/640000 (11.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=11, max=277453, num_faces=277454
      Valid probs shape: (37, 75206)
    ✓ Random_14 (pose=(2.8379745568373105, 1.6967611117206198, -0.8485206286649221)): shape (37, 800, 800)
      Valid pixels: 75363/640000 (11.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=10, max=277452, num_faces=277454
      Valid probs shape: (37, 75363)
    ✓ Random_15 (pose=(-2.049386884543729, 1.972005130666716, 2.9787995143072425)): shape (37, 800, 800)
      Valid pixels: 101577/640000 (15.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=277453, num_faces=277454
      Valid probs shape: (37, 101577)
    ✓ Random_16 (pose=(0.44117113651936, 0.10323965074582286, -0.22304118116020133)): shape (37, 800, 800)
      Valid pixels: 77293/640000 (12.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=277453, num_faces=277454
      Valid probs shape: (37, 77293)
    ✓ Random_17 (pose=(-1.89831971733584, -1.6968411963858827, 0.3134612333794844)): shape (37, 800, 800)
      Valid pixels: 101254/640000 (15.8%)
      Probs stats: min=0.0000, max=0.9993, mean=0.0270
      Face IDs: min=2, max=277285, num_faces=277454
      Valid probs shape: (37, 101254)
    ✓ Random_18 (pose=(-2.7702526844883115, -2.04196941554137, 0.8722903676656459)): shape (37, 800, 800)
      Valid pixels: 98402/640000 (15.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=277285, num_faces=277454
      Valid probs shape: (37, 98402)
    ✓ Random_19 (pose=(-1.9611777451200432, -2.752595259177508, -0.33755989518149176)): shape (37, 800, 800)
      Valid pixels: 101991/640000 (15.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=277283, num_faces=277454
      Valid probs shape: (37, 101991)
    ✓ Random_20 (pose=(-0.27901086516811313, 0.38679432150019055, -1.7828586559031974)): shape (37, 800, 800)
      Valid pixels: 76064/640000 (11.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=277453, num_faces=277454
      Valid probs shape: (37, 76064)
    ✓ Random_21 (pose=(-1.1616675813914445, -1.8825856851753613, 0.3844275586552839)): shape (37, 800, 800)
      Valid pixels: 82229/640000 (12.8%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=10, max=277448, num_faces=277454
      Valid probs shape: (37, 82229)
    ✓ Random_22 (pose=(-0.9357861682312008, -0.664327509049842, 1.941355644271951)): shape (37, 800, 800)
      Valid pixels: 100577/640000 (15.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=14, max=277453, num_faces=277454
      Valid probs shape: (37, 100577)
    ✓ Random_23 (pose=(2.3398227099527986, 1.4212555230148567, 1.413130303576482)): shape (37, 800, 800)
      Valid pixels: 87141/640000 (13.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=0, max=277449, num_faces=277454
      Valid probs shape: (37, 87141)
    ✓ Random_24 (pose=(-0.1650484134435377, -0.29478964603656976, 1.087635426509756)): shape (37, 800, 800)
      Valid pixels: 63726/640000 (10.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=277442, num_faces=277454
      Valid probs shape: (37, 63726)
    ✓ Random_25 (pose=(-1.8095133418704548, 0.7611878407194603, 0.25957786456940557)): shape (37, 800, 800)
      Valid pixels: 89560/640000 (14.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=33, max=277441, num_faces=277454
      Valid probs shape: (37, 89560)
    ✓ Random_26 (pose=(1.564329464173853, -1.5648990854503786, -1.1194557241404524)): shape (37, 800, 800)
      Valid pixels: 94228/640000 (14.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=13, max=277453, num_faces=277454
      Valid probs shape: (37, 94228)
    ✓ Random_27 (pose=(-1.1537664433597619, -0.6596834906232423, 2.785523545520279)): shape (37, 800, 800)
      Valid pixels: 110625/640000 (17.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=0, max=277453, num_faces=277454
      Valid probs shape: (37, 110625)
    ✓ Random_28 (pose=(1.0562164453853304, 3.043543168888961, 0.5714401090142185)): shape (37, 800, 800)
      Valid pixels: 75523/640000 (11.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=12, max=277449, num_faces=277454
      Valid probs shape: (37, 75523)
    ✓ Random_29 (pose=(-1.5725418363251427, 0.785342930799287, 1.9268800771892316)): shape (37, 800, 800)
      Valid pixels: 89313/640000 (14.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=31, max=277453, num_faces=277454
      Valid probs shape: (37, 89313)
    ✓ Random_30 (pose=(-2.556237355304228, 3.1171030597670715, -1.9785597135217263)): shape (37, 800, 800)
      Valid pixels: 70760/640000 (11.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=277442, num_faces=277454
      Valid probs shape: (37, 70760)
    ✓ Random_31 (pose=(-1.143165361221171, 0.07655202990866616, 1.1309955553205837)): shape (37, 800, 800)
      Valid pixels: 67157/640000 (10.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=9, max=277452, num_faces=277454
      Valid probs shape: (37, 67157)
    ✓ Random_32 (pose=(0.8123214298260182, -1.4716359271922141, 1.595304198686196)): shape (37, 800, 800)
      Valid pixels: 83931/640000 (13.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=277449, num_faces=277454
      Valid probs shape: (37, 83931)
    ✓ Random_33 (pose=(2.8675506020652453, -1.2689710562647598, -2.447219536780496)): shape (37, 800, 800)
      Valid pixels: 89035/640000 (13.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=36, max=277453, num_faces=277454
      Valid probs shape: (37, 89035)
    ✓ Random_34 (pose=(2.0753439240762726, -1.2373797812051228, 0.9869125598981627)): shape (37, 800, 800)
      Valid pixels: 70751/640000 (11.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=363, max=277449, num_faces=277454
      Valid probs shape: (37, 70751)
    ✓ Random_35 (pose=(0.22047895357003577, 1.7637406342081547, -0.4019685353367741)): shape (37, 800, 800)
      Valid pixels: 78592/640000 (12.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=3, max=277449, num_faces=277454
      Valid probs shape: (37, 78592)
    ✓ Random_36 (pose=(1.8954737988619241, -3.067514803587385, -1.8637456604915505)): shape (37, 800, 800)
      Valid pixels: 68677/640000 (10.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=26, max=277453, num_faces=277454
      Valid probs shape: (37, 68677)
    ✓ Random_37 (pose=(-0.008668936751184297, -2.281508989039218, 2.94502507143004)): shape (37, 800, 800)
      Valid pixels: 61159/640000 (9.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5864, max=277453, num_faces=277454
      Valid probs shape: (37, 61159)
    ✓ Random_38 (pose=(2.3299092102223407, 0.3912080293831899, 3.107672016886295)): shape (37, 800, 800)
      Valid pixels: 100002/640000 (15.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7271, max=277286, num_faces=277454
      Valid probs shape: (37, 100002)
    ✓ Random_39 (pose=(-1.3188787211149986, 1.491369263680249, -2.4576935208236717)): shape (37, 800, 800)
      Valid pixels: 95250/640000 (14.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=0, max=277449, num_faces=277454
      Valid probs shape: (37, 95250)
    P stats: min=0.0000, max=0.9998, mean=0.0255
    Non-zero vertices: 130997/138729
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 7732 1305 1092 3370    0 2015  919 5153 7145]
  Ground Truth Stats:
    Labels shape: (138729,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/HLN-12-1/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7772
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8289
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8294

  RESULTS:
  RAW:         median(top-10)=0.9105, mean(top-10)=0.9081, median(all)=0.8335, mean(all)=0.7772
  + SMOOTHING: median(top-10)=0.9305, mean(top-10)=0.9303, median(all)=0.8812, mean(all)=0.8289 [+0.0200]
  + MRF:       median(top-10)=0.9307, mean(top-10)=0.9305, median(all)=0.8826, mean(all)=0.8294 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0202

================================================================================
Subject: HLN-12-10
================================================================================
  Step 0: Generating predictions with V2 model (40 random views)...
  Mesh: 134639 vertices, 269274 faces
  Generating 40 random views...
  Generating predictions for 40 views (continuous camera pose)...
    ✓ Random_0 (pose=(3.086752963975167, -1.6807212503951345, 2.201170440583545)): shape (37, 800, 800)
      Valid pixels: 82609/640000 (12.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=4, max=269228, num_faces=269274
      Valid probs shape: (37, 82609)
    ✓ Random_1 (pose=(1.8803012799869432, -2.1161501508918015, 2.8463761555734006)): shape (37, 800, 800)
      Valid pixels: 95726/640000 (15.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=8, max=269228, num_faces=269274
      Valid probs shape: (37, 95726)
    ✓ Random_2 (pose=(-2.751172975173984, -2.8918771708218856, 0.37194229879363494)): shape (37, 800, 800)
      Valid pixels: 65282/640000 (10.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=268101, num_faces=269274
      Valid probs shape: (37, 65282)
    ✓ Random_3 (pose=(2.8749934594583673, 2.1037540869215023, 1.6299626512685865)): shape (37, 800, 800)
      Valid pixels: 85615/640000 (13.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=269268, num_faces=269274
      Valid probs shape: (37, 85615)
    ✓ Random_4 (pose=(-0.3325336399379415, 1.0085917637346267, 2.8937519021651648)): shape (37, 800, 800)
      Valid pixels: 62887/640000 (9.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=269156, num_faces=269274
      Valid probs shape: (37, 62887)
    ✓ Random_5 (pose=(1.981126263352925, -0.0462536302922425, -2.169455875931367)): shape (37, 800, 800)
      Valid pixels: 73211/640000 (11.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1223, max=269273, num_faces=269274
      Valid probs shape: (37, 73211)
    ✓ Random_6 (pose=(-3.041964040217794, -2.461773773788976, -0.7809925449841213)): shape (37, 800, 800)
      Valid pixels: 62239/640000 (9.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=268812, num_faces=269274
      Valid probs shape: (37, 62239)
    ✓ Random_7 (pose=(1.3592842523393687, -1.5982396423297154, -3.1096526183548767)): shape (37, 800, 800)
      Valid pixels: 99056/640000 (15.5%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=4, max=269270, num_faces=269274
      Valid probs shape: (37, 99056)
    ✓ Random_8 (pose=(-0.805481188548248, -2.672657912794307, -1.0534073309869538)): shape (37, 800, 800)
      Valid pixels: 86811/640000 (13.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5103, max=269273, num_faces=269274
      Valid probs shape: (37, 86811)
    ✓ Random_9 (pose=(0.9045384768640004, 2.4173049624426666, 2.35395817437933)): shape (37, 800, 800)
      Valid pixels: 93785/640000 (14.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=945, max=269273, num_faces=269274
      Valid probs shape: (37, 93785)
    ✓ Random_10 (pose=(-0.4824001124343096, 2.408642879169742, 1.2675643963335457)): shape (37, 800, 800)
      Valid pixels: 80246/640000 (12.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3640, max=269270, num_faces=269274
      Valid probs shape: (37, 80246)
    ✓ Random_11 (pose=(2.3989368138098603, 2.927728149471368, 1.6815676432583402)): shape (37, 800, 800)
      Valid pixels: 56342/640000 (8.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=268811, num_faces=269274
      Valid probs shape: (37, 56342)
    ✓ Random_12 (pose=(1.0898804564615432, -1.675516689133772, -3.0819620659645963)): shape (37, 800, 800)
      Valid pixels: 99966/640000 (15.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=10, max=269228, num_faces=269274
      Valid probs shape: (37, 99966)
    ✓ Random_13 (pose=(1.5364132990326622, -0.7868955326773168, -1.340949959948916)): shape (37, 800, 800)
      Valid pixels: 71587/640000 (11.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=18, max=269267, num_faces=269274
      Valid probs shape: (37, 71587)
    ✓ Random_14 (pose=(-2.877259518255269, 1.7742697353516315, 0.8008647985679791)): shape (37, 800, 800)
      Valid pixels: 86667/640000 (13.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=269156, num_faces=269274
      Valid probs shape: (37, 86667)
    ✓ Random_15 (pose=(-0.5876030646639818, -0.8940235551131717, -2.3658945773761437)): shape (37, 800, 800)
      Valid pixels: 60721/640000 (9.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=266965, num_faces=269274
      Valid probs shape: (37, 60721)
    ✓ Random_16 (pose=(-0.4050719089311934, 1.056478552195256, -1.8051428371370868)): shape (37, 800, 800)
      Valid pixels: 90161/640000 (14.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=268823, num_faces=269274
      Valid probs shape: (37, 90161)
    ✓ Random_17 (pose=(2.462707673706026, -2.4559581072937915, 0.9058554206690292)): shape (37, 800, 800)
      Valid pixels: 58219/640000 (9.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=266964, num_faces=269274
      Valid probs shape: (37, 58219)
    ✓ Random_18 (pose=(-0.5447615504066956, -0.04678478116980367, 1.5963257064059242)): shape (37, 800, 800)
      Valid pixels: 56763/640000 (8.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=269146, num_faces=269274
      Valid probs shape: (37, 56763)
    ✓ Random_19 (pose=(1.5258223816347884, 0.6024554880356154, 3.112946639137987)): shape (37, 800, 800)
      Valid pixels: 96190/640000 (15.0%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=5, max=269228, num_faces=269274
      Valid probs shape: (37, 96190)
    ✓ Random_20 (pose=(1.4704380240965147, 0.8380586703933015, 2.149713051343671)): shape (37, 800, 800)
      Valid pixels: 90472/640000 (14.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=269268, num_faces=269274
      Valid probs shape: (37, 90472)
    ✓ Random_21 (pose=(-0.8274417994296401, -0.4391781227644409, -0.133551932081462)): shape (37, 800, 800)
      Valid pixels: 79686/640000 (12.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=5, max=269214, num_faces=269274
      Valid probs shape: (37, 79686)
    ✓ Random_22 (pose=(-0.01910904538005065, 0.2876870109538161, 1.593483550522671)): shape (37, 800, 800)
      Valid pixels: 58461/640000 (9.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=268101, num_faces=269274
      Valid probs shape: (37, 58461)
    ✓ Random_23 (pose=(1.1616916315210082, -2.7215881251220955, -0.17766881903564435)): shape (37, 800, 800)
      Valid pixels: 99652/640000 (15.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=85, max=269273, num_faces=269274
      Valid probs shape: (37, 99652)
    ✓ Random_24 (pose=(1.128855085290133, 2.0253966071206815, -2.254373065829832)): shape (37, 800, 800)
      Valid pixels: 70277/640000 (11.0%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=284, max=269270, num_faces=269274
      Valid probs shape: (37, 70277)
    ✓ Random_25 (pose=(0.9248589743407738, 0.02469884942996492, 1.78822601416325)): shape (37, 800, 800)
      Valid pixels: 65404/640000 (10.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=266960, num_faces=269274
      Valid probs shape: (37, 65404)
    ✓ Random_26 (pose=(-0.5228264057667831, 0.9394599896820246, -1.1798918752917045)): shape (37, 800, 800)
      Valid pixels: 68710/640000 (10.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=268823, num_faces=269274
      Valid probs shape: (37, 68710)
    ✓ Random_27 (pose=(2.259296067931767, -2.111470533080839, 0.12941845839412647)): shape (37, 800, 800)
      Valid pixels: 79192/640000 (12.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=268823, num_faces=269274
      Valid probs shape: (37, 79192)
    ✓ Random_28 (pose=(1.605784189029154, -1.5870584964017942, 1.901246149771051)): shape (37, 800, 800)
      Valid pixels: 78130/640000 (12.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=269272, num_faces=269274
      Valid probs shape: (37, 78130)
    ✓ Random_29 (pose=(0.47933042850574425, 0.3170124368929077, 2.5536402898857222)): shape (37, 800, 800)
      Valid pixels: 69933/640000 (10.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=268551, num_faces=269274
      Valid probs shape: (37, 69933)
    ✓ Random_30 (pose=(1.1091558869874625, -0.5318538906491805, -1.1016645201186885)): shape (37, 800, 800)
      Valid pixels: 67293/640000 (10.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=11, max=269156, num_faces=269274
      Valid probs shape: (37, 67293)
    ✓ Random_31 (pose=(-2.914376504082795, 1.932167914883463, 2.4833560212193913)): shape (37, 800, 800)
      Valid pixels: 80560/640000 (12.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=268823, num_faces=269274
      Valid probs shape: (37, 80560)
    ✓ Random_32 (pose=(-0.5722922008085991, 1.7700859119748724, -1.7729258474385428)): shape (37, 800, 800)
      Valid pixels: 92875/640000 (14.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=91, max=269272, num_faces=269274
      Valid probs shape: (37, 92875)
    ✓ Random_33 (pose=(-1.5093238032007128, 2.1792171167240895, -0.8611698378642374)): shape (37, 800, 800)
      Valid pixels: 91016/640000 (14.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=8, max=269270, num_faces=269274
      Valid probs shape: (37, 91016)
    ✓ Random_34 (pose=(-1.8989556318440615, -2.949164766595293, -2.4498490379112896)): shape (37, 800, 800)
      Valid pixels: 82320/640000 (12.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=268823, num_faces=269274
      Valid probs shape: (37, 82320)
    ✓ Random_35 (pose=(1.1292551452146817, -0.15153253781710863, 2.837174526479302)): shape (37, 800, 800)
      Valid pixels: 93607/640000 (14.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=3, max=269228, num_faces=269274
      Valid probs shape: (37, 93607)
    ✓ Random_36 (pose=(-0.6907935347476424, -0.8415886755992878, 2.649733256805863)): shape (37, 800, 800)
      Valid pixels: 87669/640000 (13.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=268823, num_faces=269274
      Valid probs shape: (37, 87669)
    ✓ Random_37 (pose=(-0.5836806995104604, 2.7874155310807422, -1.1838668235983338)): shape (37, 800, 800)
      Valid pixels: 59062/640000 (9.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=15172, max=269272, num_faces=269274
      Valid probs shape: (37, 59062)
    ✓ Random_38 (pose=(3.0227157385994294, 2.9641249571251516, -1.6443820360090233)): shape (37, 800, 800)
      Valid pixels: 55316/640000 (8.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=268630, num_faces=269274
      Valid probs shape: (37, 55316)
    ✓ Random_39 (pose=(-2.8098069023067453, 2.600831745718299, 1.6704786573372035)): shape (37, 800, 800)
      Valid pixels: 71515/640000 (11.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=268823, num_faces=269274
      Valid probs shape: (37, 71515)
    P stats: min=0.0000, max=0.9999, mean=0.0260
    Non-zero vertices: 129700/134639
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 4939 1594 1168 2822    0 2801 1290 4436 6179]
  Ground Truth Stats:
    Labels shape: (134639,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/HLN-12-10/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7871
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8349
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8354

  RESULTS:
  RAW:         median(top-10)=0.9084, mean(top-10)=0.9161, median(all)=0.8588, mean(all)=0.7871
  + SMOOTHING: median(top-10)=0.9308, mean(top-10)=0.9323, median(all)=0.8860, mean(all)=0.8349 [+0.0223]
  + MRF:       median(top-10)=0.9318, mean(top-10)=0.9328, median(all)=0.8861, mean(all)=0.8354 [+0.0010]
  TOTAL IMPROVEMENT (median top-10): +0.0234

================================================================================
Subject: HLN-12-11
================================================================================
  Step 0: Generating predictions with V2 model (40 random views)...
  Mesh: 130710 vertices, 261416 faces
  Generating 40 random views...
  Generating predictions for 40 views (continuous camera pose)...
    ✓ Random_0 (pose=(-2.9354050521665163, -1.6376831852885938, 0.1428985424458702)): shape (37, 800, 800)
      Valid pixels: 84484/640000 (13.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=13, max=261116, num_faces=261416
      Valid probs shape: (37, 84484)
    ✓ Random_1 (pose=(-2.841109817264856, 1.431369776562141, 0.0007131286935213588)): shape (37, 800, 800)
      Valid pixels: 78051/640000 (12.2%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=64, max=261415, num_faces=261416
      Valid probs shape: (37, 78051)
    ✓ Random_2 (pose=(-1.3696613936338995, -2.865946129363109, -0.31961726044317906)): shape (37, 800, 800)
      Valid pixels: 103275/640000 (16.1%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=16, max=261119, num_faces=261416
      Valid probs shape: (37, 103275)
    ✓ Random_3 (pose=(-2.1559519341424167, -0.1073852862068545, -0.8732027280104111)): shape (37, 800, 800)
      Valid pixels: 89297/640000 (14.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8327, max=261118, num_faces=261416
      Valid probs shape: (37, 89297)
    ✓ Random_4 (pose=(2.076180927274809, -1.889204708507698, 1.3770947264904985)): shape (37, 800, 800)
      Valid pixels: 81446/640000 (12.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=261116, num_faces=261416
      Valid probs shape: (37, 81446)
    ✓ Random_5 (pose=(-1.8020123525408647, 0.18334792872661065, 1.0837275129241366)): shape (37, 800, 800)
      Valid pixels: 80200/640000 (12.5%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=221, max=261415, num_faces=261416
      Valid probs shape: (37, 80200)
    ✓ Random_6 (pose=(-0.3363326489582583, 2.152031308807717, 0.12379160455249627)): shape (37, 800, 800)
      Valid pixels: 87267/640000 (13.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=8346, max=261119, num_faces=261416
      Valid probs shape: (37, 87267)
    ✓ Random_7 (pose=(0.4377248353170238, -3.1347641688971666, -2.5583720623264905)): shape (37, 800, 800)
      Valid pixels: 68750/640000 (10.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1660, max=261415, num_faces=261416
      Valid probs shape: (37, 68750)
    ✓ Random_8 (pose=(-2.1113078167415527, 1.8839675664741078, -0.33562530299170534)): shape (37, 800, 800)
      Valid pixels: 94031/640000 (14.7%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=7, max=261119, num_faces=261416
      Valid probs shape: (37, 94031)
    ✓ Random_9 (pose=(-0.7131262643748015, 2.5067266260977226, 0.6255544281536247)): shape (37, 800, 800)
      Valid pixels: 92261/640000 (14.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=2260, max=261413, num_faces=261416
      Valid probs shape: (37, 92261)
    ✓ Random_10 (pose=(-2.625209502408397, 0.5867428395948941, 1.775484073393673)): shape (37, 800, 800)
      Valid pixels: 84057/640000 (13.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=377, max=261413, num_faces=261416
      Valid probs shape: (37, 84057)
    ✓ Random_11 (pose=(2.2937234873340877, 1.1298515094798773, -2.4649622865814274)): shape (37, 800, 800)
      Valid pixels: 99160/640000 (15.5%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=89, max=261299, num_faces=261416
      Valid probs shape: (37, 99160)
    ✓ Random_12 (pose=(2.493468437587035, -0.9439021652013042, -1.1358794474660594)): shape (37, 800, 800)
      Valid pixels: 101338/640000 (15.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=204, max=261411, num_faces=261416
      Valid probs shape: (37, 101338)
    ✓ Random_13 (pose=(-2.504370754406748, -1.519687851736219, 2.3610838369977607)): shape (37, 800, 800)
      Valid pixels: 75559/640000 (11.8%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=170, max=261415, num_faces=261416
      Valid probs shape: (37, 75559)
    ✓ Random_14 (pose=(-1.608282873804143, -1.1475852680947507, -2.4004581713364224)): shape (37, 800, 800)
      Valid pixels: 87667/640000 (13.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=21, max=261133, num_faces=261416
      Valid probs shape: (37, 87667)
    ✓ Random_15 (pose=(-0.9043838120624281, -0.5197801014625218, 1.8364253765132714)): shape (37, 800, 800)
      Valid pixels: 84984/640000 (13.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=261357, num_faces=261416
      Valid probs shape: (37, 84984)
    ✓ Random_16 (pose=(-1.6317926261322109, 0.6934377162096323, 2.5088217850917633)): shape (37, 800, 800)
      Valid pixels: 108814/640000 (17.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=261411, num_faces=261416
      Valid probs shape: (37, 108814)
    ✓ Random_17 (pose=(3.063543344311225, -2.0321494717777515, 3.1042360904854203)): shape (37, 800, 800)
      Valid pixels: 68670/640000 (10.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=261415, num_faces=261416
      Valid probs shape: (37, 68670)
    ✓ Random_18 (pose=(0.7691011226386069, 2.7040724844032074, -0.41956287353652755)): shape (37, 800, 800)
      Valid pixels: 87292/640000 (13.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=379, max=261193, num_faces=261416
      Valid probs shape: (37, 87292)
    ✓ Random_19 (pose=(1.5359394226202996, -2.9830749977175164, -1.9223651579235963)): shape (37, 800, 800)
      Valid pixels: 78654/640000 (12.3%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=53, max=261415, num_faces=261416
      Valid probs shape: (37, 78654)
    ✓ Random_20 (pose=(-1.1685052074330682, 0.7462908265017707, 3.0440042929186095)): shape (37, 800, 800)
      Valid pixels: 106706/640000 (16.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=261410, num_faces=261416
      Valid probs shape: (37, 106706)
    ✓ Random_21 (pose=(2.1459503052499365, -1.4521248142894276, 2.8314022204455593)): shape (37, 800, 800)
      Valid pixels: 93844/640000 (14.7%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=75, max=261119, num_faces=261416
      Valid probs shape: (37, 93844)
    ✓ Random_22 (pose=(0.7384891700025009, -1.2000900997000958, 2.341815959356074)): shape (37, 800, 800)
      Valid pixels: 69228/640000 (10.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=258611, num_faces=261416
      Valid probs shape: (37, 69228)
    ✓ Random_23 (pose=(0.5485236494183536, -2.846783603271231, 3.056754372501021)): shape (37, 800, 800)
      Valid pixels: 82712/640000 (12.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=38990, max=261155, num_faces=261416
      Valid probs shape: (37, 82712)
    ✓ Random_24 (pose=(2.7169949404889, 1.6632372495118926, 1.3222131599065632)): shape (37, 800, 800)
      Valid pixels: 103679/640000 (16.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=261235, num_faces=261416
      Valid probs shape: (37, 103679)
    ✓ Random_25 (pose=(1.2441405186322338, -2.065280122966368, 0.9844453470151473)): shape (37, 800, 800)
      Valid pixels: 87492/640000 (13.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8, max=261217, num_faces=261416
      Valid probs shape: (37, 87492)
    ✓ Random_26 (pose=(0.9862304268494473, -1.7663621746830689, 1.6246141635235603)): shape (37, 800, 800)
      Valid pixels: 79662/640000 (12.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=27, max=261132, num_faces=261416
      Valid probs shape: (37, 79662)
    ✓ Random_27 (pose=(-0.8825344246069413, 1.154037823983014, 0.4678015861242186)): shape (37, 800, 800)
      Valid pixels: 100314/640000 (15.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=5, max=261119, num_faces=261416
      Valid probs shape: (37, 100314)
    ✓ Random_28 (pose=(-2.696940210600899, -0.012151382992998006, -0.2653896292934679)): shape (37, 800, 800)
      Valid pixels: 75389/640000 (11.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=32140, max=261413, num_faces=261416
      Valid probs shape: (37, 75389)
    ✓ Random_29 (pose=(2.8673002880086855, 0.47396256346985943, -0.005339485210328565)): shape (37, 800, 800)
      Valid pixels: 65543/640000 (10.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1666, max=261413, num_faces=261416
      Valid probs shape: (37, 65543)
    ✓ Random_30 (pose=(0.015073047159424924, -2.373074977432379, 2.05006778275394)): shape (37, 800, 800)
      Valid pixels: 77033/640000 (12.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1434, max=261133, num_faces=261416
      Valid probs shape: (37, 77033)
    ✓ Random_31 (pose=(0.49523645028597496, 0.0963122258841862, -0.30728471656197254)): shape (37, 800, 800)
      Valid pixels: 71153/640000 (11.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=261196, num_faces=261416
      Valid probs shape: (37, 71153)
    ✓ Random_32 (pose=(2.616181483104242, 2.0092258695967127, -1.024278721224881)): shape (37, 800, 800)
      Valid pixels: 75498/640000 (11.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=10, max=261415, num_faces=261416
      Valid probs shape: (37, 75498)
    ✓ Random_33 (pose=(-0.14586898289183603, 1.409742596097228, -1.3510435832235272)): shape (37, 800, 800)
      Valid pixels: 96153/640000 (15.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=261178, num_faces=261416
      Valid probs shape: (37, 96153)
    ✓ Random_34 (pose=(0.4705235251691553, 0.49488439647548255, 0.7851575929440044)): shape (37, 800, 800)
      Valid pixels: 62701/640000 (9.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=258541, num_faces=261416
      Valid probs shape: (37, 62701)
    ✓ Random_35 (pose=(-1.9342191779637306, -2.05674491145421, 0.4944359684797104)): shape (37, 800, 800)
      Valid pixels: 94696/640000 (14.8%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=3, max=261119, num_faces=261416
      Valid probs shape: (37, 94696)
    ✓ Random_36 (pose=(-2.9862704730641525, -2.3349042055798312, 2.5259279370499828)): shape (37, 800, 800)
      Valid pixels: 67347/640000 (10.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=261415, num_faces=261416
      Valid probs shape: (37, 67347)
    ✓ Random_37 (pose=(0.7640609302432866, -1.6937496856089163, 1.6903284767003566)): shape (37, 800, 800)
      Valid pixels: 83524/640000 (13.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8, max=261133, num_faces=261416
      Valid probs shape: (37, 83524)
    ✓ Random_38 (pose=(-2.4340884247108514, 1.1701252236812527, -1.6085053034091694)): shape (37, 800, 800)
      Valid pixels: 98448/640000 (15.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=54, max=261155, num_faces=261416
      Valid probs shape: (37, 98448)
    ✓ Random_39 (pose=(0.7242511685382831, -2.8932081185232765, 2.9989246785045323)): shape (37, 800, 800)
      Valid pixels: 88301/640000 (13.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=18545, max=261413, num_faces=261416
      Valid probs shape: (37, 88301)
    P stats: min=0.0000, max=0.9998, mean=0.0260
    Non-zero vertices: 125660/130710
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 5050 1698  910 3628    0 1805 1271 3943 5823]
  Ground Truth Stats:
    Labels shape: (130710,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/HLN-12-11/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7959
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8325
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8325

  RESULTS:
  RAW:         median(top-10)=0.9163, mean(top-10)=0.9188, median(all)=0.8635, mean(all)=0.7959
  + SMOOTHING: median(top-10)=0.9355, mean(top-10)=0.9380, median(all)=0.8875, mean(all)=0.8325 [+0.0191]
  + MRF:       median(top-10)=0.9354, mean(top-10)=0.9381, median(all)=0.8879, mean(all)=0.8325 [-0.0000]
  TOTAL IMPROVEMENT (median top-10): +0.0191

================================================================================
Subject: HLN-12-12
================================================================================
  Step 0: Generating predictions with V2 model (40 random views)...
  Mesh: 148128 vertices, 296252 faces
  Generating 40 random views...
  Generating predictions for 40 views (continuous camera pose)...
    ✓ Random_0 (pose=(-0.37398938056956066, -0.08166357483074638, 3.030766525200658)): shape (37, 800, 800)
      Valid pixels: 48204/640000 (7.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=296200, num_faces=296252
      Valid probs shape: (37, 48204)
    ✓ Random_1 (pose=(-0.043311833371765474, 1.0246516615799663, 1.6901816512900636)): shape (37, 800, 800)
      Valid pixels: 70084/640000 (11.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=7, max=296203, num_faces=296252
      Valid probs shape: (37, 70084)
    ✓ Random_2 (pose=(-1.1852700778507628, 3.093466983977356, -2.6474883059079524)): shape (37, 800, 800)
      Valid pixels: 72713/640000 (11.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=111, max=296248, num_faces=296252
      Valid probs shape: (37, 72713)
    ✓ Random_3 (pose=(0.4441637809885446, 1.0370332082746616, 2.533032943265323)): shape (37, 800, 800)
      Valid pixels: 67190/640000 (10.5%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=2, max=296203, num_faces=296252
      Valid probs shape: (37, 67190)
    ✓ Random_4 (pose=(1.2841630514994335, 2.214966744968976, 2.4117762449406683)): shape (37, 800, 800)
      Valid pixels: 85116/640000 (13.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=9, max=296249, num_faces=296252
      Valid probs shape: (37, 85116)
    ✓ Random_5 (pose=(-1.099211536397418, 1.0664397129019392, -0.6632298547358317)): shape (37, 800, 800)
      Valid pixels: 72756/640000 (11.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=295501, num_faces=296252
      Valid probs shape: (37, 72756)
    ✓ Random_6 (pose=(3.03421578215167, 0.364256488738929, 2.0987132226095895)): shape (37, 800, 800)
      Valid pixels: 43581/640000 (6.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3174, max=296251, num_faces=296252
      Valid probs shape: (37, 43581)
    ✓ Random_7 (pose=(0.9574772699548628, 0.9697439394759959, 2.9580928749598483)): shape (37, 800, 800)
      Valid pixels: 71768/640000 (11.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=296203, num_faces=296252
      Valid probs shape: (37, 71768)
    ✓ Random_8 (pose=(1.425034206263958, 0.01610747126771761, -3.1042745642453737)): shape (37, 800, 800)
      Valid pixels: 80309/640000 (12.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=0, max=296203, num_faces=296252
      Valid probs shape: (37, 80309)
    ✓ Random_9 (pose=(2.9373539721303814, -1.954822738652121, -2.686334068977293)): shape (37, 800, 800)
      Valid pixels: 60620/640000 (9.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=296200, num_faces=296252
      Valid probs shape: (37, 60620)
    ✓ Random_10 (pose=(-1.9181252587363866, 2.7897042029468055, -1.9053222356268407)): shape (37, 800, 800)
      Valid pixels: 54489/640000 (8.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=295950, num_faces=296252
      Valid probs shape: (37, 54489)
    ✓ Random_11 (pose=(0.40463588384734317, -1.3355364118686213, 2.7101681688101227)): shape (37, 800, 800)
      Valid pixels: 53833/640000 (8.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=295942, num_faces=296252
      Valid probs shape: (37, 53833)
    ✓ Random_12 (pose=(3.010976445084287, 2.0984013762929363, 1.633810838379504)): shape (37, 800, 800)
      Valid pixels: 75415/640000 (11.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=296203, num_faces=296252
      Valid probs shape: (37, 75415)
    ✓ Random_13 (pose=(3.065568731229316, -1.1308605923141366, 2.4136306552327085)): shape (37, 800, 800)
      Valid pixels: 64977/640000 (10.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=638, max=296251, num_faces=296252
      Valid probs shape: (37, 64977)
    ✓ Random_14 (pose=(-3.0704080125637088, -1.5541840951392194, 0.3035649027515235)): shape (37, 800, 800)
      Valid pixels: 69416/640000 (10.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=38, max=295668, num_faces=296252
      Valid probs shape: (37, 69416)
    ✓ Random_15 (pose=(0.6793547059977723, 0.33630209823271784, 1.2697665647654546)): shape (37, 800, 800)
      Valid pixels: 47964/640000 (7.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=295497, num_faces=296252
      Valid probs shape: (37, 47964)
    ✓ Random_16 (pose=(-1.4052770353488642, 1.9943700049281565, -2.3393818934504567)): shape (37, 800, 800)
      Valid pixels: 72190/640000 (11.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=8, max=296202, num_faces=296252
      Valid probs shape: (37, 72190)
    ✓ Random_17 (pose=(-1.7589050396393808, 1.0745460670843308, 2.155698406532327)): shape (37, 800, 800)
      Valid pixels: 84199/640000 (13.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=90, max=296202, num_faces=296252
      Valid probs shape: (37, 84199)
    ✓ Random_18 (pose=(0.47668148688651657, -3.0368078372420806, -0.19999540268434446)): shape (37, 800, 800)
      Valid pixels: 50701/640000 (7.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=262, max=296251, num_faces=296252
      Valid probs shape: (37, 50701)
    ✓ Random_19 (pose=(0.5409401425248213, -2.3492634281239964, -0.3546023620326477)): shape (37, 800, 800)
      Valid pixels: 58781/640000 (9.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=216, max=296204, num_faces=296252
      Valid probs shape: (37, 58781)
    ✓ Random_20 (pose=(1.3049548519962864, 2.875149952710995, 2.642512200307893)): shape (37, 800, 800)
      Valid pixels: 84197/640000 (13.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=19, max=296249, num_faces=296252
      Valid probs shape: (37, 84197)
    ✓ Random_21 (pose=(-0.645656087294189, 0.6086143049280537, -1.6028864386735993)): shape (37, 800, 800)
      Valid pixels: 56443/640000 (8.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=296204, num_faces=296252
      Valid probs shape: (37, 56443)
    ✓ Random_22 (pose=(-3.1023520955947497, 1.3887163225010495, -1.7087280494899362)): shape (37, 800, 800)
      Valid pixels: 83828/640000 (13.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=296249, num_faces=296252
      Valid probs shape: (37, 83828)
    ✓ Random_23 (pose=(0.4660541474992299, -1.4832836060224213, 1.3889357519444747)): shape (37, 800, 800)
      Valid pixels: 81726/640000 (12.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8, max=296202, num_faces=296252
      Valid probs shape: (37, 81726)
    ✓ Random_24 (pose=(-1.8355039806546414, -0.9193466923421041, 0.5402124568959494)): shape (37, 800, 800)
      Valid pixels: 76039/640000 (11.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=85, max=296203, num_faces=296252
      Valid probs shape: (37, 76039)
    ✓ Random_25 (pose=(-0.8952198292484601, 3.0400782608154326, -1.2328171927673166)): shape (37, 800, 800)
      Valid pixels: 60209/640000 (9.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=16109, max=296250, num_faces=296252
      Valid probs shape: (37, 60209)
    ✓ Random_26 (pose=(-0.5747783115687919, 1.8763960081088014, -2.584557505868948)): shape (37, 800, 800)
      Valid pixels: 87087/640000 (13.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=160, max=296204, num_faces=296252
      Valid probs shape: (37, 87087)
    ✓ Random_27 (pose=(1.7743267975546066, 3.020650596971162, -0.949512083791006)): shape (37, 800, 800)
      Valid pixels: 78885/640000 (12.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=296204, num_faces=296252
      Valid probs shape: (37, 78885)
    ✓ Random_28 (pose=(1.5612586556334813, -2.7055516086067257, -0.856353898530033)): shape (37, 800, 800)
      Valid pixels: 83349/640000 (13.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=86, max=296204, num_faces=296252
      Valid probs shape: (37, 83349)
    ✓ Random_29 (pose=(-1.618266410395129, 1.7730512153306908, 1.3655744796024791)): shape (37, 800, 800)
      Valid pixels: 58285/640000 (9.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=63, max=296204, num_faces=296252
      Valid probs shape: (37, 58285)
    ✓ Random_30 (pose=(-2.9124854971965894, -2.4763681789036855, -0.5987153400440426)): shape (37, 800, 800)
      Valid pixels: 47118/640000 (7.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=295950, num_faces=296252
      Valid probs shape: (37, 47118)
    ✓ Random_31 (pose=(1.397173113819858, 0.28593557023354554, -0.21999119340148665)): shape (37, 800, 800)
      Valid pixels: 88825/640000 (13.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=11, max=296202, num_faces=296252
      Valid probs shape: (37, 88825)
    ✓ Random_32 (pose=(-1.8810873653559046, -0.4207451571548475, -2.515301303727746)): shape (37, 800, 800)
      Valid pixels: 73963/640000 (11.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=94, max=296202, num_faces=296252
      Valid probs shape: (37, 73963)
    ✓ Random_33 (pose=(-2.6546628495314817, 1.5613147440952142, 1.9299396103811297)): shape (37, 800, 800)
      Valid pixels: 89141/640000 (13.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=296203, num_faces=296252
      Valid probs shape: (37, 89141)
    ✓ Random_34 (pose=(1.4520849007770185, 0.4190225356751629, -1.893129343025246)): shape (37, 800, 800)
      Valid pixels: 59595/640000 (9.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=70, max=296202, num_faces=296252
      Valid probs shape: (37, 59595)
    ✓ Random_35 (pose=(-0.7223308385902238, 2.15400073402631, -2.0737242568094603)): shape (37, 800, 800)
      Valid pixels: 74560/640000 (11.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=149, max=296251, num_faces=296252
      Valid probs shape: (37, 74560)
    ✓ Random_36 (pose=(-1.7059422507029824, -2.7768778427630636, 2.676991427612627)): shape (37, 800, 800)
      Valid pixels: 88637/640000 (13.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=296203, num_faces=296252
      Valid probs shape: (37, 88637)
    ✓ Random_37 (pose=(-0.35681326034196115, 2.662067624367231, 3.0554799334426983)): shape (37, 800, 800)
      Valid pixels: 51083/640000 (8.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=221, max=296251, num_faces=296252
      Valid probs shape: (37, 51083)
    ✓ Random_38 (pose=(0.8028167576979279, 0.49255294812480255, 0.33599959756555275)): shape (37, 800, 800)
      Valid pixels: 59791/640000 (9.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=296202, num_faces=296252
      Valid probs shape: (37, 59791)
    ✓ Random_39 (pose=(2.5077153234940184, 0.543312105236005, 3.00932288081224)): shape (37, 800, 800)
      Valid pixels: 70946/640000 (11.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3193, max=296250, num_faces=296252
      Valid probs shape: (37, 70946)
    P stats: min=0.0000, max=1.0000, mean=0.0257
    Non-zero vertices: 141027/148128
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 7101 1611  948 4246    0 2462 1261 6076 7504]
  Ground Truth Stats:
    Labels shape: (148128,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/HLN-12-12/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7767
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8288
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8294

  RESULTS:
  RAW:         median(top-10)=0.9026, mean(top-10)=0.9071, median(all)=0.8499, mean(all)=0.7767
  + SMOOTHING: median(top-10)=0.9236, mean(top-10)=0.9266, median(all)=0.8640, mean(all)=0.8288 [+0.0211]
  + MRF:       median(top-10)=0.9241, mean(top-10)=0.9268, median(all)=0.8642, mean(all)=0.8294 [+0.0005]
  TOTAL IMPROVEMENT (median top-10): +0.0215

================================================================================
Subject: HLN-12-2
================================================================================
  Step 0: Generating predictions with V2 model (40 random views)...
  Mesh: 146833 vertices, 293662 faces
  Generating 40 random views...
  Generating predictions for 40 views (continuous camera pose)...
    ✓ Random_0 (pose=(1.2698748524285657, -2.80335476004416, -1.8927542305035279)): shape (37, 800, 800)
      Valid pixels: 72236/640000 (11.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=482, max=293655, num_faces=293662
      Valid probs shape: (37, 72236)
    ✓ Random_1 (pose=(-0.44887812545388206, 2.5904165428552215, 2.8431298293848135)): shape (37, 800, 800)
      Valid pixels: 69325/640000 (10.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=293656, num_faces=293662
      Valid probs shape: (37, 69325)
    ✓ Random_2 (pose=(-0.38608112639470615, 0.51072119888501, 2.5188842353871017)): shape (37, 800, 800)
      Valid pixels: 46672/640000 (7.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=293614, num_faces=293662
      Valid probs shape: (37, 46672)
    ✓ Random_3 (pose=(1.0973208101994913, 2.7211634451553044, -1.9841763252954943)): shape (37, 800, 800)
      Valid pixels: 68920/640000 (10.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=428, max=293655, num_faces=293662
      Valid probs shape: (37, 68920)
    ✓ Random_4 (pose=(-0.6314810311673851, -2.425257267833478, -1.3313243237827888)): shape (37, 800, 800)
      Valid pixels: 84617/640000 (13.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7838, max=293661, num_faces=293662
      Valid probs shape: (37, 84617)
    ✓ Random_5 (pose=(3.128031800783095, -0.7068442837476456, -2.5345321338288995)): shape (37, 800, 800)
      Valid pixels: 73316/640000 (11.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=293655, num_faces=293662
      Valid probs shape: (37, 73316)
    ✓ Random_6 (pose=(0.10590583638658346, 1.9586439588507618, -1.6930724099613237)): shape (37, 800, 800)
      Valid pixels: 102233/640000 (16.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=293631, num_faces=293662
      Valid probs shape: (37, 102233)
    ✓ Random_7 (pose=(1.4080119824626873, -1.2940050080812866, -0.8245679993536568)): shape (37, 800, 800)
      Valid pixels: 90583/640000 (14.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=293653, num_faces=293662
      Valid probs shape: (37, 90583)
    ✓ Random_8 (pose=(2.989965131232575, 3.121669389838737, -0.28913517609993233)): shape (37, 800, 800)
      Valid pixels: 46726/640000 (7.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=291552, num_faces=293662
      Valid probs shape: (37, 46726)
    ✓ Random_9 (pose=(-1.6884649132044882, 1.1309584639507593, -2.1840571819784858)): shape (37, 800, 800)
      Valid pixels: 72078/640000 (11.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=293616, num_faces=293662
      Valid probs shape: (37, 72078)
    ✓ Random_10 (pose=(-1.0244582408664487, -0.9389257228068839, 0.5637108031913054)): shape (37, 800, 800)
      Valid pixels: 68389/640000 (10.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=293661, num_faces=293662
      Valid probs shape: (37, 68389)
    ✓ Random_11 (pose=(-2.9696918033207607, 2.5484298228365825, 1.20906548106697)): shape (37, 800, 800)
      Valid pixels: 62559/640000 (9.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=293615, num_faces=293662
      Valid probs shape: (37, 62559)
    ✓ Random_12 (pose=(-2.615410550673498, -1.2184095805695423, -2.776968485237915)): shape (37, 800, 800)
      Valid pixels: 101596/640000 (15.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=293642, num_faces=293662
      Valid probs shape: (37, 101596)
    ✓ Random_13 (pose=(-0.7581765043579822, -0.738501974118758, 1.9461649370024299)): shape (37, 800, 800)
      Valid pixels: 84358/640000 (13.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=293640, num_faces=293662
      Valid probs shape: (37, 84358)
    ✓ Random_14 (pose=(0.5308236801553421, 2.9583910601701264, -2.7853389069759924)): shape (37, 800, 800)
      Valid pixels: 66394/640000 (10.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3535, max=293661, num_faces=293662
      Valid probs shape: (37, 66394)
    ✓ Random_15 (pose=(-1.119282740848238, -2.880610112286193, 0.03123017180109544)): shape (37, 800, 800)
      Valid pixels: 89345/640000 (14.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=427, max=293661, num_faces=293662
      Valid probs shape: (37, 89345)
    ✓ Random_16 (pose=(1.75894556409565, 0.3671665729990927, -1.4081450456863682)): shape (37, 800, 800)
      Valid pixels: 68968/640000 (10.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=86, max=293661, num_faces=293662
      Valid probs shape: (37, 68968)
    ✓ Random_17 (pose=(-2.577913385534831, -2.3531861170521204, -2.8846977951744264)): shape (37, 800, 800)
      Valid pixels: 80469/640000 (12.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=293617, num_faces=293662
      Valid probs shape: (37, 80469)
    ✓ Random_18 (pose=(-0.5013955882379957, -1.792361142673701, 2.775400321825285)): shape (37, 800, 800)
      Valid pixels: 80987/640000 (12.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8, max=293617, num_faces=293662
      Valid probs shape: (37, 80987)
    ✓ Random_19 (pose=(0.059410942946381606, -1.8238109687227484, 0.426954574622719)): shape (37, 800, 800)
      Valid pixels: 87443/640000 (13.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=293661, num_faces=293662
      Valid probs shape: (37, 87443)
    ✓ Random_20 (pose=(1.1671089497515705, 0.6309736456104038, -1.2078125082587843)): shape (37, 800, 800)
      Valid pixels: 84368/640000 (13.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7, max=293655, num_faces=293662
      Valid probs shape: (37, 84368)
    ✓ Random_21 (pose=(0.9331593564443592, -0.029728255864390984, -2.539255015066124)): shape (37, 800, 800)
      Valid pixels: 71833/640000 (11.2%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=4, max=293641, num_faces=293662
      Valid probs shape: (37, 71833)
    ✓ Random_22 (pose=(0.14143145104778787, -2.9500382013218265, 2.390365829546937)): shape (37, 800, 800)
      Valid pixels: 41857/640000 (6.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=13183, max=293661, num_faces=293662
      Valid probs shape: (37, 41857)
    ✓ Random_23 (pose=(-0.6448263415718789, -2.687374491524091, -2.7323204219313566)): shape (37, 800, 800)
      Valid pixels: 60035/640000 (9.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=293656, num_faces=293662
      Valid probs shape: (37, 60035)
    ✓ Random_24 (pose=(3.050816922902495, -2.247832112092684, 0.87377381311346)): shape (37, 800, 800)
      Valid pixels: 83956/640000 (13.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=293620, num_faces=293662
      Valid probs shape: (37, 83956)
    ✓ Random_25 (pose=(-0.8995220368572752, 1.0613516286243367, 2.2539433051785167)): shape (37, 800, 800)
      Valid pixels: 60444/640000 (9.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6, max=293661, num_faces=293662
      Valid probs shape: (37, 60444)
    ✓ Random_26 (pose=(-1.505288778530807, 2.5152619335636386, 0.5361895508885763)): shape (37, 800, 800)
      Valid pixels: 83843/640000 (13.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=80, max=293659, num_faces=293662
      Valid probs shape: (37, 83843)
    ✓ Random_27 (pose=(-2.232985587141793, -3.0522477026048453, -0.9177272761906741)): shape (37, 800, 800)
      Valid pixels: 80045/640000 (12.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=293447, num_faces=293662
      Valid probs shape: (37, 80045)
    ✓ Random_28 (pose=(0.7403204812250697, 2.5428957689413743, -2.6602845323434794)): shape (37, 800, 800)
      Valid pixels: 70337/640000 (11.0%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=2021, max=293660, num_faces=293662
      Valid probs shape: (37, 70337)
    ✓ Random_29 (pose=(2.3471839869526825, -1.101824744396826, -1.9237027448070114)): shape (37, 800, 800)
      Valid pixels: 80774/640000 (12.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=293661, num_faces=293662
      Valid probs shape: (37, 80774)
    ✓ Random_30 (pose=(-2.8076079081358003, 0.13642988372720088, -2.849406257819239)): shape (37, 800, 800)
      Valid pixels: 48151/640000 (7.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=293661, num_faces=293662
      Valid probs shape: (37, 48151)
    ✓ Random_31 (pose=(-1.4263155396780505, -0.035288830518615644, -1.6260283566792297)): shape (37, 800, 800)
      Valid pixels: 63377/640000 (9.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=24, max=293652, num_faces=293662
      Valid probs shape: (37, 63377)
    ✓ Random_32 (pose=(1.128264439766891, 0.7069207997003821, 2.459806732699704)): shape (37, 800, 800)
      Valid pixels: 98500/640000 (15.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=23, max=293659, num_faces=293662
      Valid probs shape: (37, 98500)
    ✓ Random_33 (pose=(0.004794272657250076, -1.967781335917005, 1.3735113409905102)): shape (37, 800, 800)
      Valid pixels: 101653/640000 (15.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=293617, num_faces=293662
      Valid probs shape: (37, 101653)
    ✓ Random_34 (pose=(-1.0887681012951673, 0.5858783615372603, -0.12580447659662486)): shape (37, 800, 800)
      Valid pixels: 97266/640000 (15.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=19, max=293657, num_faces=293662
      Valid probs shape: (37, 97266)
    ✓ Random_35 (pose=(-1.5102548667678228, 1.7714341609394868, -0.07826403711510288)): shape (37, 800, 800)
      Valid pixels: 98865/640000 (15.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=80, max=293661, num_faces=293662
      Valid probs shape: (37, 98865)
    ✓ Random_36 (pose=(2.2120971790931208, 2.4643504400762843, 2.5587010760944198)): shape (37, 800, 800)
      Valid pixels: 83460/640000 (13.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=293474, num_faces=293662
      Valid probs shape: (37, 83460)
    ✓ Random_37 (pose=(-2.0140754588196383, -0.2512623735203836, 1.7016409361076796)): shape (37, 800, 800)
      Valid pixels: 68308/640000 (10.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=189, max=293658, num_faces=293662
      Valid probs shape: (37, 68308)
    ✓ Random_38 (pose=(0.4534576609580161, 0.8044232193657495, 0.36636474635503635)): shape (37, 800, 800)
      Valid pixels: 62405/640000 (9.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=293607, num_faces=293662
      Valid probs shape: (37, 62405)
    ✓ Random_39 (pose=(-2.559714840408602, -0.7488932294135959, -1.580908042070575)): shape (37, 800, 800)
      Valid pixels: 68934/640000 (10.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=293651, num_faces=293662
      Valid probs shape: (37, 68934)
    P stats: min=0.0000, max=1.0000, mean=0.0257
    Non-zero vertices: 139836/146833
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 6997 1139  956 3810    0 2066  876 5034 6265]
  Ground Truth Stats:
    Labels shape: (146833,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/HLN-12-2/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7775
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8181
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8184

  RESULTS:
  RAW:         median(top-10)=0.9137, mean(top-10)=0.9112, median(all)=0.8315, mean(all)=0.7775
  + SMOOTHING: median(top-10)=0.9297, mean(top-10)=0.9306, median(all)=0.8659, mean(all)=0.8181 [+0.0161]
  + MRF:       median(top-10)=0.9299, mean(top-10)=0.9309, median(all)=0.8666, mean(all)=0.8184 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0162

================================================================================
Subject: HLN-12-3
================================================================================
  Step 0: Generating predictions with V2 model (40 random views)...
  Mesh: 150991 vertices, 301978 faces
  Generating 40 random views...
  Generating predictions for 40 views (continuous camera pose)...
    ✓ Random_0 (pose=(-2.865866388091538, 1.304996913033797, -1.3222368382779228)): shape (37, 800, 800)
      Valid pixels: 96081/640000 (15.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=194, max=301972, num_faces=301978
      Valid probs shape: (37, 96081)
    ✓ Random_1 (pose=(2.697601159576771, 0.9676289645557823, 1.8254739579684847)): shape (37, 800, 800)
      Valid pixels: 77958/640000 (12.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=429, max=301977, num_faces=301978
      Valid probs shape: (37, 77958)
    ✓ Random_2 (pose=(2.5900701763150504, 3.0949857890937293, 1.144695359722589)): shape (37, 800, 800)
      Valid pixels: 58656/640000 (9.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=301340, num_faces=301978
      Valid probs shape: (37, 58656)
    ✓ Random_3 (pose=(0.2433799161115191, -1.767351218833504, 2.294534866811251)): shape (37, 800, 800)
      Valid pixels: 79118/640000 (12.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=148, max=301970, num_faces=301978
      Valid probs shape: (37, 79118)
    ✓ Random_4 (pose=(-2.3367136221280247, -3.09432120995488, 0.9353844441093484)): shape (37, 800, 800)
      Valid pixels: 69002/640000 (10.8%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=3, max=301337, num_faces=301978
      Valid probs shape: (37, 69002)
    ✓ Random_5 (pose=(1.7751715431459472, 0.8618441151668632, 3.120524417590847)): shape (37, 800, 800)
      Valid pixels: 99322/640000 (15.5%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=48, max=301972, num_faces=301978
      Valid probs shape: (37, 99322)
    ✓ Random_6 (pose=(-0.026204128100216106, -0.6219017431363065, -1.5033205677885566)): shape (37, 800, 800)
      Valid pixels: 73550/640000 (11.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=300913, num_faces=301978
      Valid probs shape: (37, 73550)
    ✓ Random_7 (pose=(3.061471058867771, 1.6318105596885601, -1.2162556809675484)): shape (37, 800, 800)
      Valid pixels: 84128/640000 (13.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8, max=301976, num_faces=301978
      Valid probs shape: (37, 84128)
    ✓ Random_8 (pose=(-1.3263703009883372, 0.5173785763375753, -2.2390109927935)): shape (37, 800, 800)
      Valid pixels: 80260/640000 (12.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=301976, num_faces=301978
      Valid probs shape: (37, 80260)
    ✓ Random_9 (pose=(0.004127268328569578, -3.1003125565406715, 1.2041392738337295)): shape (37, 800, 800)
      Valid pixels: 47388/640000 (7.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2359, max=301976, num_faces=301978
      Valid probs shape: (37, 47388)
    ✓ Random_10 (pose=(0.9215907356501205, -0.6494723002633087, -2.693820669075335)): shape (37, 800, 800)
      Valid pixels: 88102/640000 (13.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=301889, num_faces=301978
      Valid probs shape: (37, 88102)
    ✓ Random_11 (pose=(0.6456871164525313, -0.34369225787164526, 0.26447993996374164)): shape (37, 800, 800)
      Valid pixels: 77065/640000 (12.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=301958, num_faces=301978
      Valid probs shape: (37, 77065)
    ✓ Random_12 (pose=(-1.6048498949715369, 1.6494212980902567, -1.3388118435167264)): shape (37, 800, 800)
      Valid pixels: 78031/640000 (12.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8, max=301910, num_faces=301978
      Valid probs shape: (37, 78031)
    ✓ Random_13 (pose=(-1.8352586786422969, 0.8282018082176164, -2.4342804316428728)): shape (37, 800, 800)
      Valid pixels: 79934/640000 (12.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=73, max=301975, num_faces=301978
      Valid probs shape: (37, 79934)
    ✓ Random_14 (pose=(-0.9817091910025666, -1.4032988855280055, -1.8420595926850492)): shape (37, 800, 800)
      Valid pixels: 79585/640000 (12.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=301910, num_faces=301978
      Valid probs shape: (37, 79585)
    ✓ Random_15 (pose=(3.0632849910040596, -0.6248191607035736, 0.9708454547529719)): shape (37, 800, 800)
      Valid pixels: 76741/640000 (12.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=21348, max=301976, num_faces=301978
      Valid probs shape: (37, 76741)
    ✓ Random_16 (pose=(3.1362204249103964, -0.8551536930501631, -1.9937721401033166)): shape (37, 800, 800)
      Valid pixels: 88714/640000 (13.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=217, max=301976, num_faces=301978
      Valid probs shape: (37, 88714)
    ✓ Random_17 (pose=(0.5406396591548179, -2.576036823921359, 1.1391547707345016)): shape (37, 800, 800)
      Valid pixels: 74577/640000 (11.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=925, max=301977, num_faces=301978
      Valid probs shape: (37, 74577)
    ✓ Random_18 (pose=(-2.171397521852624, 1.1047851872178907, -3.073986670145856)): shape (37, 800, 800)
      Valid pixels: 84190/640000 (13.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=72, max=301974, num_faces=301978
      Valid probs shape: (37, 84190)
    ✓ Random_19 (pose=(-0.03995994407868819, -1.3764565122480357, 1.7233602765701406)): shape (37, 800, 800)
      Valid pixels: 99129/640000 (15.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7, max=301976, num_faces=301978
      Valid probs shape: (37, 99129)
    ✓ Random_20 (pose=(-0.3000993339802642, 2.054098972416276, -2.288750363482519)): shape (37, 800, 800)
      Valid pixels: 100521/640000 (15.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=147, max=301977, num_faces=301978
      Valid probs shape: (37, 100521)
    ✓ Random_21 (pose=(-1.6710724646046757, -0.7251179748082182, -1.0559000169318922)): shape (37, 800, 800)
      Valid pixels: 85648/640000 (13.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=301904, num_faces=301978
      Valid probs shape: (37, 85648)
    ✓ Random_22 (pose=(-0.8754949931569023, 1.9371109365286268, 0.5107330087946731)): shape (37, 800, 800)
      Valid pixels: 98093/640000 (15.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=49, max=301976, num_faces=301978
      Valid probs shape: (37, 98093)
    ✓ Random_23 (pose=(-1.1912699855120972, 1.1568959710492699, 2.4271831454885273)): shape (37, 800, 800)
      Valid pixels: 88089/640000 (13.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=301976, num_faces=301978
      Valid probs shape: (37, 88089)
    ✓ Random_24 (pose=(2.564314356536582, -2.179565364845046, 2.0490206158710143)): shape (37, 800, 800)
      Valid pixels: 92105/640000 (14.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=6, max=301885, num_faces=301978
      Valid probs shape: (37, 92105)
    ✓ Random_25 (pose=(0.45943455810153777, -0.13868349593167606, -2.2758095923441837)): shape (37, 800, 800)
      Valid pixels: 64803/640000 (10.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=301042, num_faces=301978
      Valid probs shape: (37, 64803)
    ✓ Random_26 (pose=(1.0628526597454684, 0.41746885033181735, -0.12885895669574632)): shape (37, 800, 800)
      Valid pixels: 92678/640000 (14.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=301965, num_faces=301978
      Valid probs shape: (37, 92678)
    ✓ Random_27 (pose=(1.0219358428305076, -2.737803918674673, -0.09551464407890853)): shape (37, 800, 800)
      Valid pixels: 98763/640000 (15.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=142, max=301977, num_faces=301978
      Valid probs shape: (37, 98763)
    ✓ Random_28 (pose=(-1.622961214337336, 0.8475988251373683, -0.298782434133571)): shape (37, 800, 800)
      Valid pixels: 100768/640000 (15.7%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=25, max=301904, num_faces=301978
      Valid probs shape: (37, 100768)
    ✓ Random_29 (pose=(-0.5787085260661913, 2.8004160234605022, 2.19738943622884)): shape (37, 800, 800)
      Valid pixels: 60370/640000 (9.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1321, max=301976, num_faces=301978
      Valid probs shape: (37, 60370)
    ✓ Random_30 (pose=(2.756393577928616, -1.7770471394129121, -0.0513548840411473)): shape (37, 800, 800)
      Valid pixels: 75051/640000 (11.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=301976, num_faces=301978
      Valid probs shape: (37, 75051)
    ✓ Random_31 (pose=(-0.17990736633480253, 2.7266485505599807, -2.7536740703623988)): shape (37, 800, 800)
      Valid pixels: 60901/640000 (9.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1587, max=301976, num_faces=301978
      Valid probs shape: (37, 60901)
    ✓ Random_32 (pose=(2.16417176351521, -0.5055271782098161, 2.522908357076094)): shape (37, 800, 800)
      Valid pixels: 93851/640000 (14.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=4009, max=301973, num_faces=301978
      Valid probs shape: (37, 93851)
    ✓ Random_33 (pose=(2.8014611370726827, 0.46118250114359993, 2.0927822856628895)): shape (37, 800, 800)
      Valid pixels: 60224/640000 (9.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=65, max=301976, num_faces=301978
      Valid probs shape: (37, 60224)
    ✓ Random_34 (pose=(1.4302654480592798, -2.193492464799587, -0.7725034497784948)): shape (37, 800, 800)
      Valid pixels: 97427/640000 (15.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=71, max=301976, num_faces=301978
      Valid probs shape: (37, 97427)
    ✓ Random_35 (pose=(-0.8590000055693023, 3.132618548587554, -1.1039544621653277)): shape (37, 800, 800)
      Valid pixels: 77330/640000 (12.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=17617, max=301973, num_faces=301978
      Valid probs shape: (37, 77330)
    ✓ Random_36 (pose=(-2.708444478738056, 2.9693057916623653, -0.17461869936120689)): shape (37, 800, 800)
      Valid pixels: 66382/640000 (10.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=0, max=300913, num_faces=301978
      Valid probs shape: (37, 66382)
    ✓ Random_37 (pose=(-1.6064442418509841, 2.4903205461909668, -0.21384582527606444)): shape (37, 800, 800)
      Valid pixels: 99766/640000 (15.6%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=0, max=301904, num_faces=301978
      Valid probs shape: (37, 99766)
    ✓ Random_38 (pose=(-0.7222115932728093, -0.41051338035414364, 1.833600979491643)): shape (37, 800, 800)
      Valid pixels: 73855/640000 (11.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=301977, num_faces=301978
      Valid probs shape: (37, 73855)
    ✓ Random_39 (pose=(0.49828649680417625, -0.35157331341401843, 0.67017257221926)): shape (37, 800, 800)
      Valid pixels: 70219/640000 (11.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=301970, num_faces=301978
      Valid probs shape: (37, 70219)
    P stats: min=0.0000, max=1.0000, mean=0.0253
    Non-zero vertices: 141437/150991
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 9554 1221 1222 3133    0 2420 1240 4793 7877]
  Ground Truth Stats:
    Labels shape: (150991,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/HLN-12-3/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7648
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8214
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8219

  RESULTS:
  RAW:         median(top-10)=0.9152, mean(top-10)=0.9102, median(all)=0.8405, mean(all)=0.7648
  + SMOOTHING: median(top-10)=0.9272, mean(top-10)=0.9302, median(all)=0.8684, mean(all)=0.8214 [+0.0120]
  + MRF:       median(top-10)=0.9275, mean(top-10)=0.9305, median(all)=0.8686, mean(all)=0.8219 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0124

================================================================================
Subject: HLN-12-4
================================================================================
  Step 0: Generating predictions with V2 model (40 random views)...
  Mesh: 137751 vertices, 275498 faces
  Generating 40 random views...
  Generating predictions for 40 views (continuous camera pose)...
    ✓ Random_0 (pose=(-0.13072427288013921, -0.5456953251386438, 1.8937378650017278)): shape (37, 800, 800)
      Valid pixels: 65116/640000 (10.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=275496, num_faces=275498
      Valid probs shape: (37, 65116)
    ✓ Random_1 (pose=(2.348136633236532, -0.6064748138463472, 2.8766295655847642)): shape (37, 800, 800)
      Valid pixels: 82493/640000 (12.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1898, max=275494, num_faces=275498
      Valid probs shape: (37, 82493)
    ✓ Random_2 (pose=(2.2099206852629765, -2.6653441762782366, 1.2622430079526055)): shape (37, 800, 800)
      Valid pixels: 59353/640000 (9.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=275406, num_faces=275498
      Valid probs shape: (37, 59353)
    ✓ Random_3 (pose=(-2.599833568711399, -1.3958753510634434, -2.683607460604121)): shape (37, 800, 800)
      Valid pixels: 103060/640000 (16.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=48, max=275496, num_faces=275498
      Valid probs shape: (37, 103060)
    ✓ Random_4 (pose=(-1.9788862650913166, 3.1075894809034095, 1.5075157409814652)): shape (37, 800, 800)
      Valid pixels: 60542/640000 (9.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=12, max=275497, num_faces=275498
      Valid probs shape: (37, 60542)
    ✓ Random_5 (pose=(-1.9392763277845964, 0.4292642512251592, 1.805625729820207)): shape (37, 800, 800)
      Valid pixels: 81453/640000 (12.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=525, max=275497, num_faces=275498
      Valid probs shape: (37, 81453)
    ✓ Random_6 (pose=(1.1908547300414565, -0.9034073494583246, 1.3508856767734052)): shape (37, 800, 800)
      Valid pixels: 70416/640000 (11.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=275497, num_faces=275498
      Valid probs shape: (37, 70416)
    ✓ Random_7 (pose=(-2.65629590876159, -0.15393512615151783, -0.8505605132328755)): shape (37, 800, 800)
      Valid pixels: 59688/640000 (9.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=60753, max=275448, num_faces=275498
      Valid probs shape: (37, 59688)
    ✓ Random_8 (pose=(-0.5827178372589996, 1.8981902901073475, -0.6331272702767095)): shape (37, 800, 800)
      Valid pixels: 60160/640000 (9.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=122, max=275412, num_faces=275498
      Valid probs shape: (37, 60160)
    ✓ Random_9 (pose=(0.3683669818221693, 0.5624060755017202, -1.162325135067618)): shape (37, 800, 800)
      Valid pixels: 69616/640000 (10.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=275492, num_faces=275498
      Valid probs shape: (37, 69616)
    ✓ Random_10 (pose=(0.35308512139760406, 1.019184421996406, 0.5092652299452061)): shape (37, 800, 800)
      Valid pixels: 62423/640000 (9.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=275406, num_faces=275498
      Valid probs shape: (37, 62423)
    ✓ Random_11 (pose=(0.5921803978308198, 1.7404201446046894, -0.3161277894818073)): shape (37, 800, 800)
      Valid pixels: 81736/640000 (12.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=49, max=275497, num_faces=275498
      Valid probs shape: (37, 81736)
    ✓ Random_12 (pose=(2.039768563411692, -1.0835706122058357, -0.955906740034012)): shape (37, 800, 800)
      Valid pixels: 102905/640000 (16.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=48, max=275495, num_faces=275498
      Valid probs shape: (37, 102905)
    ✓ Random_13 (pose=(-3.085496204962365, 1.2299709866365731, -3.1377945801054765)): shape (37, 800, 800)
      Valid pixels: 59832/640000 (9.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=133, max=275491, num_faces=275498
      Valid probs shape: (37, 59832)
    ✓ Random_14 (pose=(2.1502534697486437, -0.7637314729778426, 1.6832650486222986)): shape (37, 800, 800)
      Valid pixels: 82719/640000 (12.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3166, max=275424, num_faces=275498
      Valid probs shape: (37, 82719)
    ✓ Random_15 (pose=(0.6657198997003437, 0.8170906629895698, -0.9414831326669)): shape (37, 800, 800)
      Valid pixels: 87366/640000 (13.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=275495, num_faces=275498
      Valid probs shape: (37, 87366)
    ✓ Random_16 (pose=(2.238129621326136, 0.9599458927894879, -2.900863047850149)): shape (37, 800, 800)
      Valid pixels: 95111/640000 (14.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=936, max=275449, num_faces=275498
      Valid probs shape: (37, 95111)
    ✓ Random_17 (pose=(1.6236801431536874, -0.20339857708855513, 2.3948025833655118)): shape (37, 800, 800)
      Valid pixels: 95576/640000 (14.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=90, max=275424, num_faces=275498
      Valid probs shape: (37, 95576)
    ✓ Random_18 (pose=(2.565656500996311, -3.111843681319156, -2.173744511945508)): shape (37, 800, 800)
      Valid pixels: 56082/640000 (8.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=275472, num_faces=275498
      Valid probs shape: (37, 56082)
    ✓ Random_19 (pose=(-2.4266011424401563, 0.3891412360093529, 1.4959752325684006)): shape (37, 800, 800)
      Valid pixels: 66294/640000 (10.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=869, max=275497, num_faces=275498
      Valid probs shape: (37, 66294)
    ✓ Random_20 (pose=(2.2458316951309962, 2.9317614873856552, -2.638600400904791)): shape (37, 800, 800)
      Valid pixels: 74632/640000 (11.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=275424, num_faces=275498
      Valid probs shape: (37, 74632)
    ✓ Random_21 (pose=(-1.630033314963964, -1.7652699252103712, 1.0788136493594882)): shape (37, 800, 800)
      Valid pixels: 72585/640000 (11.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=275495, num_faces=275498
      Valid probs shape: (37, 72585)
    ✓ Random_22 (pose=(2.404840995119904, -0.63968664180062, 0.5983960216584778)): shape (37, 800, 800)
      Valid pixels: 63200/640000 (9.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=210, max=275492, num_faces=275498
      Valid probs shape: (37, 63200)
    ✓ Random_23 (pose=(0.488177458722864, 2.57062190308167, 1.4078544174158232)): shape (37, 800, 800)
      Valid pixels: 74038/640000 (11.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=26974, max=275424, num_faces=275498
      Valid probs shape: (37, 74038)
    ✓ Random_24 (pose=(-2.0219171159773905, -2.9313114805896063, -1.7372037174867352)): shape (37, 800, 800)
      Valid pixels: 62263/640000 (9.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=275493, num_faces=275498
      Valid probs shape: (37, 62263)
    ✓ Random_25 (pose=(0.4999567082502585, -2.7742882058191363, -0.7467714478812919)): shape (37, 800, 800)
      Valid pixels: 55788/640000 (8.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2363, max=275497, num_faces=275498
      Valid probs shape: (37, 55788)
    ✓ Random_26 (pose=(3.0379606095559506, -0.17120311116225873, 1.7081722282097695)): shape (37, 800, 800)
      Valid pixels: 51204/640000 (8.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=84980, max=275495, num_faces=275498
      Valid probs shape: (37, 51204)
    ✓ Random_27 (pose=(0.3779953523865349, 0.13413908222555104, 2.6206079327667657)): shape (37, 800, 800)
      Valid pixels: 61270/640000 (9.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=275407, num_faces=275498
      Valid probs shape: (37, 61270)
    ✓ Random_28 (pose=(-0.4337714496403886, -0.7674122178075624, 3.0558376428803777)): shape (37, 800, 800)
      Valid pixels: 66011/640000 (10.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=275492, num_faces=275498
      Valid probs shape: (37, 66011)
    ✓ Random_29 (pose=(-1.7230607817018204, 1.6367048920526317, 1.8816798655925684)): shape (37, 800, 800)
      Valid pixels: 85842/640000 (13.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=21, max=275497, num_faces=275498
      Valid probs shape: (37, 85842)
    ✓ Random_30 (pose=(2.766184925931464, -1.2895370429866326, 0.42418601256790023)): shape (37, 800, 800)
      Valid pixels: 60716/640000 (9.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=130, max=275433, num_faces=275498
      Valid probs shape: (37, 60716)
    ✓ Random_31 (pose=(0.008853242087048407, 1.7335368675481986, -0.24487361928941587)): shape (37, 800, 800)
      Valid pixels: 64658/640000 (10.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=92, max=275496, num_faces=275498
      Valid probs shape: (37, 64658)
    ✓ Random_32 (pose=(1.2430425307636108, 3.1073097506718295, -1.5829847671346646)): shape (37, 800, 800)
      Valid pixels: 65352/640000 (10.2%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=863, max=275497, num_faces=275498
      Valid probs shape: (37, 65352)
    ✓ Random_33 (pose=(2.396482333974638, 1.7117519001754102, 2.022795586298833)): shape (37, 800, 800)
      Valid pixels: 67173/640000 (10.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=275496, num_faces=275498
      Valid probs shape: (37, 67173)
    ✓ Random_34 (pose=(-2.65449327667369, 2.1732983358131683, -1.3248116406515353)): shape (37, 800, 800)
      Valid pixels: 89625/640000 (14.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=275424, num_faces=275498
      Valid probs shape: (37, 89625)
    ✓ Random_35 (pose=(-0.116660752561482, -1.782204089613297, -1.5331546756446255)): shape (37, 800, 800)
      Valid pixels: 94612/640000 (14.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=444, max=275450, num_faces=275498
      Valid probs shape: (37, 94612)
    ✓ Random_36 (pose=(-2.1883020668792312, 2.9547384341482417, -0.3842823233595771)): shape (37, 800, 800)
      Valid pixels: 86630/640000 (13.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=7, max=275422, num_faces=275498
      Valid probs shape: (37, 86630)
    ✓ Random_37 (pose=(-0.2355204617854305, 0.8010902768555557, 2.4671937630996608)): shape (37, 800, 800)
      Valid pixels: 58199/640000 (9.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=10, max=275494, num_faces=275498
      Valid probs shape: (37, 58199)
    ✓ Random_38 (pose=(-1.791968907134851, 3.080236372280935, 0.17736264546116898)): shape (37, 800, 800)
      Valid pixels: 86958/640000 (13.6%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=2, max=275449, num_faces=275498
      Valid probs shape: (37, 86958)
    ✓ Random_39 (pose=(-1.9219012319316504, -1.3738015766732612, -1.7737125726235499)): shape (37, 800, 800)
      Valid pixels: 72350/640000 (11.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=94, max=275497, num_faces=275498
      Valid probs shape: (37, 72350)
    P stats: min=0.0000, max=0.9999, mean=0.0259
    Non-zero vertices: 131779/137751
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 5972 1379 1136 3887    0 2455  729 4138 7329]
  Ground Truth Stats:
    Labels shape: (137751,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/HLN-12-4/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7735
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8119
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8122

  RESULTS:
  RAW:         median(top-10)=0.9046, mean(top-10)=0.9097, median(all)=0.8473, mean(all)=0.7735
  + SMOOTHING: median(top-10)=0.9230, mean(top-10)=0.9200, median(all)=0.8599, mean(all)=0.8119 [+0.0184]
  + MRF:       median(top-10)=0.9232, mean(top-10)=0.9201, median(all)=0.8600, mean(all)=0.8122 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0186

================================================================================
Subject: HLN-12-5
================================================================================
  Step 0: Generating predictions with V2 model (40 random views)...
  Mesh: 167182 vertices, 334360 faces
  Generating 40 random views...
  Generating predictions for 40 views (continuous camera pose)...
    ✓ Random_0 (pose=(0.8866900500766093, -2.5014721409375045, -2.6007114307681616)): shape (37, 800, 800)
      Valid pixels: 103410/640000 (16.2%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=3899, max=334358, num_faces=334360
      Valid probs shape: (37, 103410)
    ✓ Random_1 (pose=(-1.662358902150945, -0.2890513360298379, -2.9541372775989063)): shape (37, 800, 800)
      Valid pixels: 113888/640000 (17.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=8, max=334330, num_faces=334360
      Valid probs shape: (37, 113888)
    ✓ Random_2 (pose=(-0.8935168224882171, 2.9192516617424387, 2.661306783054078)): shape (37, 800, 800)
      Valid pixels: 105304/640000 (16.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=43, max=334357, num_faces=334360
      Valid probs shape: (37, 105304)
    ✓ Random_3 (pose=(-1.3480063779838263, 0.11882698353379473, -0.9405627267059855)): shape (37, 800, 800)
      Valid pixels: 105005/640000 (16.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=333055, num_faces=334360
      Valid probs shape: (37, 105005)
    ✓ Random_4 (pose=(-1.5854714136505792, 1.622715731023944, -2.2994310970912153)): shape (37, 800, 800)
      Valid pixels: 93196/640000 (14.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=333737, num_faces=334360
      Valid probs shape: (37, 93196)
    ✓ Random_5 (pose=(-3.1056189028215724, -2.897362825601448, 0.3902820850703601)): shape (37, 800, 800)
      Valid pixels: 66824/640000 (10.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=0, max=332079, num_faces=334360
      Valid probs shape: (37, 66824)
    ✓ Random_6 (pose=(1.820523978169974, -1.7428679784494816, -1.6742596321310104)): shape (37, 800, 800)
      Valid pixels: 81982/640000 (12.8%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=97, max=334358, num_faces=334360
      Valid probs shape: (37, 81982)
    ✓ Random_7 (pose=(2.144834970949238, 1.1424385082192403, -2.7829854419257973)): shape (37, 800, 800)
      Valid pixels: 112072/640000 (17.5%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=15, max=334359, num_faces=334360
      Valid probs shape: (37, 112072)
    ✓ Random_8 (pose=(0.35857001300035174, -2.44955392298035, 0.7672761934276058)): shape (37, 800, 800)
      Valid pixels: 96261/640000 (15.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=14, max=334359, num_faces=334360
      Valid probs shape: (37, 96261)
    ✓ Random_9 (pose=(2.1895986422136415, -1.6611288106477762, -1.5475204057466587)): shape (37, 800, 800)
      Valid pixels: 109028/640000 (17.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=10, max=334357, num_faces=334360
      Valid probs shape: (37, 109028)
    ✓ Random_10 (pose=(-0.870940260598386, 2.1060116681876577, -2.668312454011671)): shape (37, 800, 800)
      Valid pixels: 117491/640000 (18.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=10, max=334358, num_faces=334360
      Valid probs shape: (37, 117491)
    ✓ Random_11 (pose=(-2.6919657377624193, 0.21771305227259452, 2.904797179084462)): shape (37, 800, 800)
      Valid pixels: 72032/640000 (11.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=364, max=334351, num_faces=334360
      Valid probs shape: (37, 72032)
    ✓ Random_12 (pose=(-2.9691079121355934, 2.5756473982407657, 1.1950996791556188)): shape (37, 800, 800)
      Valid pixels: 78647/640000 (12.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=334330, num_faces=334360
      Valid probs shape: (37, 78647)
    ✓ Random_13 (pose=(1.9568677593732664, -2.4865303733927964, 1.2945176941265526)): shape (37, 800, 800)
      Valid pixels: 75707/640000 (11.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=333109, num_faces=334360
      Valid probs shape: (37, 75707)
    ✓ Random_14 (pose=(-0.048979867775206465, 0.0768917311195394, 1.6450907586775259)): shape (37, 800, 800)
      Valid pixels: 60768/640000 (9.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=0, max=333803, num_faces=334360
      Valid probs shape: (37, 60768)
    ✓ Random_15 (pose=(-2.315636056029328, -2.9681625617597533, 1.832786437178756)): shape (37, 800, 800)
      Valid pixels: 68650/640000 (10.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=334356, num_faces=334360
      Valid probs shape: (37, 68650)
    ✓ Random_16 (pose=(-0.6753619196112322, 1.2622092489091186, 1.7968528356860096)): shape (37, 800, 800)
      Valid pixels: 85859/640000 (13.4%)
      Probs stats: min=0.0000, max=0.9991, mean=0.0270
      Face IDs: min=15, max=334356, num_faces=334360
      Valid probs shape: (37, 85859)
    ✓ Random_17 (pose=(1.9007253445795307, -1.5617401947899603, 0.3005113069244265)): shape (37, 800, 800)
      Valid pixels: 98883/640000 (15.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8, max=333935, num_faces=334360
      Valid probs shape: (37, 98883)
    ✓ Random_18 (pose=(0.2885984570122768, 0.19381889028772203, -1.091156283707385)): shape (37, 800, 800)
      Valid pixels: 66963/640000 (10.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=334321, num_faces=334360
      Valid probs shape: (37, 66963)
    ✓ Random_19 (pose=(2.9931022451188234, -0.6918568435456938, -0.7396123976986155)): shape (37, 800, 800)
      Valid pixels: 75905/640000 (11.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=111, max=334359, num_faces=334360
      Valid probs shape: (37, 75905)
    ✓ Random_20 (pose=(-2.6394588216001793, 2.521348974031289, 1.5854735935873885)): shape (37, 800, 800)
      Valid pixels: 87134/640000 (13.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=334330, num_faces=334360
      Valid probs shape: (37, 87134)
    ✓ Random_21 (pose=(-0.5437584917773157, -0.8617748347385787, 0.31872762899910345)): shape (37, 800, 800)
      Valid pixels: 75514/640000 (11.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=334356, num_faces=334360
      Valid probs shape: (37, 75514)
    ✓ Random_22 (pose=(-0.09633982342499658, 2.5283603948129985, -1.7743437632086654)): shape (37, 800, 800)
      Valid pixels: 83700/640000 (13.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=59, max=334359, num_faces=334360
      Valid probs shape: (37, 83700)
    ✓ Random_23 (pose=(2.8969733639378363, -0.6527740592938254, 2.558940319176722)): shape (37, 800, 800)
      Valid pixels: 86675/640000 (13.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=5596, max=334358, num_faces=334360
      Valid probs shape: (37, 86675)
    ✓ Random_24 (pose=(2.300107342020441, 3.0821615509643214, -1.4255478279578848)): shape (37, 800, 800)
      Valid pixels: 69005/640000 (10.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=9, max=334356, num_faces=334360
      Valid probs shape: (37, 69005)
    ✓ Random_25 (pose=(-0.06484034720357768, -1.4507155715173239, -3.015225376352125)): shape (37, 800, 800)
      Valid pixels: 77672/640000 (12.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=333055, num_faces=334360
      Valid probs shape: (37, 77672)
    ✓ Random_26 (pose=(-0.1979830408222063, 1.460088652579814, -0.022915827931107913)): shape (37, 800, 800)
      Valid pixels: 84361/640000 (13.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=333055, num_faces=334360
      Valid probs shape: (37, 84361)
    ✓ Random_27 (pose=(0.9337295916328108, -0.16016593486758124, -0.7733385264162842)): shape (37, 800, 800)
      Valid pixels: 90682/640000 (14.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8, max=334355, num_faces=334360
      Valid probs shape: (37, 90682)
    ✓ Random_28 (pose=(-2.4355318642063977, -1.321279269396055, -2.3401687161615268)): shape (37, 800, 800)
      Valid pixels: 118870/640000 (18.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=10, max=334351, num_faces=334360
      Valid probs shape: (37, 118870)
    ✓ Random_29 (pose=(0.742203046036078, -1.107986494351668, -0.7526422769164349)): shape (37, 800, 800)
      Valid pixels: 75539/640000 (11.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=17, max=334356, num_faces=334360
      Valid probs shape: (37, 75539)
    ✓ Random_30 (pose=(-1.2126201174192686, -1.845411535528306, -0.020864886813538597)): shape (37, 800, 800)
      Valid pixels: 99582/640000 (15.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=17, max=334358, num_faces=334360
      Valid probs shape: (37, 99582)
    ✓ Random_31 (pose=(-3.0560571991205245, -2.3114358895790916, 0.5180781425507157)): shape (37, 800, 800)
      Valid pixels: 92702/640000 (14.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=333055, num_faces=334360
      Valid probs shape: (37, 92702)
    ✓ Random_32 (pose=(1.5490710055016796, 0.3157852777658756, -2.584964912591242)): shape (37, 800, 800)
      Valid pixels: 94038/640000 (14.7%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=16, max=334358, num_faces=334360
      Valid probs shape: (37, 94038)
    ✓ Random_33 (pose=(-2.879247256892564, 2.605409042744161, -1.612172593505466)): shape (37, 800, 800)
      Valid pixels: 85208/640000 (13.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=333055, num_faces=334360
      Valid probs shape: (37, 85208)
    ✓ Random_34 (pose=(-0.4462470183721665, -2.394053288028196, -2.9250549713605736)): shape (37, 800, 800)
      Valid pixels: 73152/640000 (11.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=97, max=334358, num_faces=334360
      Valid probs shape: (37, 73152)
    ✓ Random_35 (pose=(2.1597070411394297, 3.041584430014689, -0.22144128187402323)): shape (37, 800, 800)
      Valid pixels: 104116/640000 (16.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8, max=334330, num_faces=334360
      Valid probs shape: (37, 104116)
    ✓ Random_36 (pose=(-2.281679593509163, 2.2660991010630065, 2.217914116157141)): shape (37, 800, 800)
      Valid pixels: 110463/640000 (17.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=8, max=334330, num_faces=334360
      Valid probs shape: (37, 110463)
    ✓ Random_37 (pose=(-0.5321402228542205, 0.15464662041331412, -2.740084602386761)): shape (37, 800, 800)
      Valid pixels: 81979/640000 (12.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=334321, num_faces=334360
      Valid probs shape: (37, 81979)
    ✓ Random_38 (pose=(-1.1688363696562174, 0.3360631609401872, 1.5378970723539034)): shape (37, 800, 800)
      Valid pixels: 77108/640000 (12.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=21, max=334356, num_faces=334360
      Valid probs shape: (37, 77108)
    ✓ Random_39 (pose=(2.010255389330161, 1.8760247473122442, -2.0791131958401925)): shape (37, 800, 800)
      Valid pixels: 91300/640000 (14.3%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=34, max=334359, num_faces=334360
      Valid probs shape: (37, 91300)
    P stats: min=0.0000, max=0.9997, mean=0.0253
    Non-zero vertices: 156377/167182
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 10805  1545  1684  3493     0  2508  1497  5818  8432]
  Ground Truth Stats:
    Labels shape: (167182,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/HLN-12-5/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7630
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8167
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8169

  RESULTS:
  RAW:         median(top-10)=0.9007, mean(top-10)=0.9005, median(all)=0.8260, mean(all)=0.7630
  + SMOOTHING: median(top-10)=0.9234, mean(top-10)=0.9252, median(all)=0.8579, mean(all)=0.8167 [+0.0227]
  + MRF:       median(top-10)=0.9240, mean(top-10)=0.9255, median(all)=0.8585, mean(all)=0.8169 [+0.0006]
  TOTAL IMPROVEMENT (median top-10): +0.0233

================================================================================
Subject: HLN-12-6
================================================================================
  Step 0: Generating predictions with V2 model (40 random views)...
  Mesh: 149409 vertices, 298814 faces
  Generating 40 random views...
  Generating predictions for 40 views (continuous camera pose)...
    ✓ Random_0 (pose=(-1.7134311158938913, -2.0851013555955618, -0.44938718354388385)): shape (37, 800, 800)
      Valid pixels: 102636/640000 (16.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=11, max=298813, num_faces=298814
      Valid probs shape: (37, 102636)
    ✓ Random_1 (pose=(-2.613798197425375, 0.32408274147776917, 1.3791136005131088)): shape (37, 800, 800)
      Valid pixels: 61015/640000 (9.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1253, max=298813, num_faces=298814
      Valid probs shape: (37, 61015)
    ✓ Random_2 (pose=(-2.5615131278885928, 2.1079525102181575, 2.073409800185326)): shape (37, 800, 800)
      Valid pixels: 98195/640000 (15.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=298709, num_faces=298814
      Valid probs shape: (37, 98195)
    ✓ Random_3 (pose=(-0.4200977796258929, -0.9372568696379915, 0.8608507218747485)): shape (37, 800, 800)
      Valid pixels: 69263/640000 (10.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=298711, num_faces=298814
      Valid probs shape: (37, 69263)
    ✓ Random_4 (pose=(2.0394332951555976, -3.103460133950762, 1.7833427653204668)): shape (37, 800, 800)
      Valid pixels: 72892/640000 (11.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=298662, num_faces=298814
      Valid probs shape: (37, 72892)
    ✓ Random_5 (pose=(2.159093035333723, -1.7501599418096583, 2.9863387261763927)): shape (37, 800, 800)
      Valid pixels: 85343/640000 (13.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=298813, num_faces=298814
      Valid probs shape: (37, 85343)
    ✓ Random_6 (pose=(2.7179109496276643, -2.1708442930908523, -1.2350650022530414)): shape (37, 800, 800)
      Valid pixels: 94439/640000 (14.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=298709, num_faces=298814
      Valid probs shape: (37, 94439)
    ✓ Random_7 (pose=(2.808658734720768, 1.4624086986885771, -2.8169181753740564)): shape (37, 800, 800)
      Valid pixels: 95342/640000 (14.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=12, max=298813, num_faces=298814
      Valid probs shape: (37, 95342)
    ✓ Random_8 (pose=(1.1646811142244555, -1.0152291398231177, 1.5502690024090597)): shape (37, 800, 800)
      Valid pixels: 68181/640000 (10.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=298787, num_faces=298814
      Valid probs shape: (37, 68181)
    ✓ Random_9 (pose=(0.5261214809625083, -0.844646313299493, 0.027201856330124397)): shape (37, 800, 800)
      Valid pixels: 80578/640000 (12.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=298711, num_faces=298814
      Valid probs shape: (37, 80578)
    ✓ Random_10 (pose=(2.3484635430005874, 0.9681785184256197, -2.434192309595925)): shape (37, 800, 800)
      Valid pixels: 93931/640000 (14.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=153, max=298813, num_faces=298814
      Valid probs shape: (37, 93931)
    ✓ Random_11 (pose=(-0.14608534430245035, -0.8442980060982332, -2.805843209223965)): shape (37, 800, 800)
      Valid pixels: 64425/640000 (10.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=298654, num_faces=298814
      Valid probs shape: (37, 64425)
    ✓ Random_12 (pose=(-1.650026846902189, -1.9287351548066292, 0.9249381327998236)): shape (37, 800, 800)
      Valid pixels: 75869/640000 (11.9%)
      Probs stats: min=0.0000, max=0.9995, mean=0.0270
      Face IDs: min=1, max=298813, num_faces=298814
      Valid probs shape: (37, 75869)
    ✓ Random_13 (pose=(-1.3390787876097225, 2.3562370043921055, 2.172051761035436)): shape (37, 800, 800)
      Valid pixels: 87766/640000 (13.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=10, max=298812, num_faces=298814
      Valid probs shape: (37, 87766)
    ✓ Random_14 (pose=(-0.5397211963827999, -0.9669990060992544, 0.6869515539199353)): shape (37, 800, 800)
      Valid pixels: 60571/640000 (9.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7, max=298753, num_faces=298814
      Valid probs shape: (37, 60571)
    ✓ Random_15 (pose=(-0.6907247834115893, -2.422875125282446, -0.5969946456267934)): shape (37, 800, 800)
      Valid pixels: 87931/640000 (13.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=743, max=298813, num_faces=298814
      Valid probs shape: (37, 87931)
    ✓ Random_16 (pose=(2.388972085852484, -2.1971966958943088, 2.0062521899774453)): shape (37, 800, 800)
      Valid pixels: 98555/640000 (15.4%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=6, max=298798, num_faces=298814
      Valid probs shape: (37, 98555)
    ✓ Random_17 (pose=(0.8490288653825631, -2.753265139002436, -1.0086385267853375)): shape (37, 800, 800)
      Valid pixels: 68789/640000 (10.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=248, max=298812, num_faces=298814
      Valid probs shape: (37, 68789)
    ✓ Random_18 (pose=(-1.708022017003682, 1.164484662080743, -2.4277957738240823)): shape (37, 800, 800)
      Valid pixels: 78317/640000 (12.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=298812, num_faces=298814
      Valid probs shape: (37, 78317)
    ✓ Random_19 (pose=(1.4404937211521922, 1.8909594061437476, 1.4052834418403437)): shape (37, 800, 800)
      Valid pixels: 62784/640000 (9.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=298812, num_faces=298814
      Valid probs shape: (37, 62784)
    ✓ Random_20 (pose=(0.43926339352931576, 0.290185550887903, 1.1526652254306589)): shape (37, 800, 800)
      Valid pixels: 57292/640000 (9.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=296725, num_faces=298814
      Valid probs shape: (37, 57292)
    ✓ Random_21 (pose=(-0.20146301085254237, 2.912242301011686, 2.919963633804546)): shape (37, 800, 800)
      Valid pixels: 51852/640000 (8.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3320, max=298813, num_faces=298814
      Valid probs shape: (37, 51852)
    ✓ Random_22 (pose=(1.44197874785893, -0.7798576087350311, 2.740650390447364)): shape (37, 800, 800)
      Valid pixels: 103260/640000 (16.1%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=11, max=298813, num_faces=298814
      Valid probs shape: (37, 103260)
    ✓ Random_23 (pose=(0.27055082638685013, 1.128856994584055, 2.69224651019804)): shape (37, 800, 800)
      Valid pixels: 72836/640000 (11.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=7, max=298587, num_faces=298814
      Valid probs shape: (37, 72836)
    ✓ Random_24 (pose=(-2.7310570194187083, 2.820302300564963, -2.576256570801039)): shape (37, 800, 800)
      Valid pixels: 54500/640000 (8.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=298694, num_faces=298814
      Valid probs shape: (37, 54500)
    ✓ Random_25 (pose=(1.8904972491558336, -2.684734521164893, 3.0534056759552)): shape (37, 800, 800)
      Valid pixels: 94249/640000 (14.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=298785, num_faces=298814
      Valid probs shape: (37, 94249)
    ✓ Random_26 (pose=(1.5634522847229206, -2.5688749393538997, 0.7873008997115418)): shape (37, 800, 800)
      Valid pixels: 79889/640000 (12.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=298813, num_faces=298814
      Valid probs shape: (37, 79889)
    ✓ Random_27 (pose=(2.934809589231798, -2.0307565917495034, -1.1894337079972341)): shape (37, 800, 800)
      Valid pixels: 93066/640000 (14.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=298811, num_faces=298814
      Valid probs shape: (37, 93066)
    ✓ Random_28 (pose=(1.9402493328197972, -0.3614666938861637, -1.0524607318802772)): shape (37, 800, 800)
      Valid pixels: 93984/640000 (14.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=298810, num_faces=298814
      Valid probs shape: (37, 93984)
    ✓ Random_29 (pose=(-0.9500739155700644, -1.2840909546300054, 0.2580062593855086)): shape (37, 800, 800)
      Valid pixels: 75149/640000 (11.7%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=1, max=298813, num_faces=298814
      Valid probs shape: (37, 75149)
    ✓ Random_30 (pose=(-1.8402925242572286, 1.4815729540360731, 2.3716321554270516)): shape (37, 800, 800)
      Valid pixels: 107984/640000 (16.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=298813, num_faces=298814
      Valid probs shape: (37, 107984)
    ✓ Random_31 (pose=(-2.690135445044117, -0.714954532186256, 1.0670263497307495)): shape (37, 800, 800)
      Valid pixels: 82444/640000 (12.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6645, max=298812, num_faces=298814
      Valid probs shape: (37, 82444)
    ✓ Random_32 (pose=(-2.3356282668356028, -1.189731435322454, -1.4533964036140945)): shape (37, 800, 800)
      Valid pixels: 74949/640000 (11.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=298812, num_faces=298814
      Valid probs shape: (37, 74949)
    ✓ Random_33 (pose=(-3.1265070107015567, -0.9300349736547178, -0.42657228666270797)): shape (37, 800, 800)
      Valid pixels: 64839/640000 (10.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1292, max=298813, num_faces=298814
      Valid probs shape: (37, 64839)
    ✓ Random_34 (pose=(-2.703373518242052, 1.086862607996494, -0.008274564562292142)): shape (37, 800, 800)
      Valid pixels: 70154/640000 (11.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=241, max=298813, num_faces=298814
      Valid probs shape: (37, 70154)
    ✓ Random_35 (pose=(-0.18514665656804086, -0.9592865913729152, 0.8394707971527495)): shape (37, 800, 800)
      Valid pixels: 78829/640000 (12.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=298709, num_faces=298814
      Valid probs shape: (37, 78829)
    ✓ Random_36 (pose=(2.770762039818135, -0.8285935990211284, -1.6385781070811571)): shape (37, 800, 800)
      Valid pixels: 90480/640000 (14.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=18, max=298812, num_faces=298814
      Valid probs shape: (37, 90480)
    ✓ Random_37 (pose=(2.7433384361036293, -1.089736437792085, -1.1786340836564737)): shape (37, 800, 800)
      Valid pixels: 99070/640000 (15.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=298813, num_faces=298814
      Valid probs shape: (37, 99070)
    ✓ Random_38 (pose=(-1.6564853993129225, 0.9094249757304764, -0.35425244739260453)): shape (37, 800, 800)
      Valid pixels: 102822/640000 (16.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=5, max=298813, num_faces=298814
      Valid probs shape: (37, 102822)
    ✓ Random_39 (pose=(2.0146408082241978, -1.9886117603033293, -2.2508250461329977)): shape (37, 800, 800)
      Valid pixels: 67263/640000 (10.5%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=1, max=298812, num_faces=298814
      Valid probs shape: (37, 67263)
    P stats: min=0.0000, max=0.9999, mean=0.0253
    Non-zero vertices: 140066/149409
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 9343 1377 1362 4015    0 2073 1109 5993 7757]
  Ground Truth Stats:
    Labels shape: (149409,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/HLN-12-6/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7728
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8265
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8269

  RESULTS:
  RAW:         median(top-10)=0.9007, mean(top-10)=0.9086, median(all)=0.8378, mean(all)=0.7728
  + SMOOTHING: median(top-10)=0.9335, mean(top-10)=0.9329, median(all)=0.8825, mean(all)=0.8265 [+0.0328]
  + MRF:       median(top-10)=0.9341, mean(top-10)=0.9332, median(all)=0.8824, mean(all)=0.8269 [+0.0005]
  TOTAL IMPROVEMENT (median top-10): +0.0334

================================================================================
Subject: HLN-12-7
================================================================================
  Step 0: Generating predictions with V2 model (40 random views)...
  Mesh: 122042 vertices, 244080 faces
  Generating 40 random views...
  Generating predictions for 40 views (continuous camera pose)...
    ✓ Random_0 (pose=(0.025914863351065076, 1.386929362738659, -1.1641429583487828)): shape (37, 800, 800)
      Valid pixels: 86821/640000 (13.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=243897, num_faces=244080
      Valid probs shape: (37, 86821)
    ✓ Random_1 (pose=(-1.0292149027731416, 0.5084191820723323, 1.343975037418148)): shape (37, 800, 800)
      Valid pixels: 70789/640000 (11.1%)
      Probs stats: min=0.0000, max=0.9995, mean=0.0270
      Face IDs: min=2, max=244079, num_faces=244080
      Valid probs shape: (37, 70789)
    ✓ Random_2 (pose=(-0.5312505075772864, -2.693462015473023, 1.247373707770949)): shape (37, 800, 800)
      Valid pixels: 61840/640000 (9.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=244, max=244079, num_faces=244080
      Valid probs shape: (37, 61840)
    ✓ Random_3 (pose=(0.32538162928330605, -0.334821201368416, -0.09105980308830874)): shape (37, 800, 800)
      Valid pixels: 59178/640000 (9.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=243895, num_faces=244080
      Valid probs shape: (37, 59178)
    ✓ Random_4 (pose=(1.338830668639801, 0.8899682672002145, -0.6517854941557766)): shape (37, 800, 800)
      Valid pixels: 99125/640000 (15.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=11, max=244000, num_faces=244080
      Valid probs shape: (37, 99125)
    ✓ Random_5 (pose=(1.2472587802838717, -0.30052751316945603, 2.375834272656493)): shape (37, 800, 800)
      Valid pixels: 88246/640000 (13.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=244060, num_faces=244080
      Valid probs shape: (37, 88246)
    ✓ Random_6 (pose=(-2.9652201945997874, 0.8693733047385237, -1.4960841653872474)): shape (37, 800, 800)
      Valid pixels: 82661/640000 (12.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4003, max=244079, num_faces=244080
      Valid probs shape: (37, 82661)
    ✓ Random_7 (pose=(1.3199843224673655, -2.6988638052650646, -1.990958904376161)): shape (37, 800, 800)
      Valid pixels: 75861/640000 (11.9%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=163, max=244079, num_faces=244080
      Valid probs shape: (37, 75861)
    ✓ Random_8 (pose=(-2.3432387213970856, 2.835817389915233, 0.490280182214911)): shape (37, 800, 800)
      Valid pixels: 69204/640000 (10.8%)
      Probs stats: min=0.0000, max=0.9995, mean=0.0270
      Face IDs: min=0, max=243708, num_faces=244080
      Valid probs shape: (37, 69204)
    ✓ Random_9 (pose=(-1.82998664902439, -3.002742737405161, -3.039818555133115)): shape (37, 800, 800)
      Valid pixels: 93347/640000 (14.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=243977, num_faces=244080
      Valid probs shape: (37, 93347)
    ✓ Random_10 (pose=(0.5626411022167668, 0.09760718046575967, 0.14294404691701557)): shape (37, 800, 800)
      Valid pixels: 64745/640000 (10.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=243897, num_faces=244080
      Valid probs shape: (37, 64745)
    ✓ Random_11 (pose=(-0.3217216108787322, 0.6184079454542344, 1.140835326379574)): shape (37, 800, 800)
      Valid pixels: 73588/640000 (11.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=243668, num_faces=244080
      Valid probs shape: (37, 73588)
    ✓ Random_12 (pose=(2.729404559004922, 2.3631369452151416, -0.41696882613548425)): shape (37, 800, 800)
      Valid pixels: 61860/640000 (9.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=3, max=244077, num_faces=244080
      Valid probs shape: (37, 61860)
    ✓ Random_13 (pose=(-0.6653192170749027, 2.333939461715322, 2.754246946457857)): shape (37, 800, 800)
      Valid pixels: 76522/640000 (12.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=243, max=244079, num_faces=244080
      Valid probs shape: (37, 76522)
    ✓ Random_14 (pose=(1.273931101485065, -2.704120806651115, 2.0183089408150536)): shape (37, 800, 800)
      Valid pixels: 77688/640000 (12.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1854, max=244076, num_faces=244080
      Valid probs shape: (37, 77688)
    ✓ Random_15 (pose=(1.0030424761891048, -1.4433954949824312, -1.8098675951302534)): shape (37, 800, 800)
      Valid pixels: 77162/640000 (12.1%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=10, max=244078, num_faces=244080
      Valid probs shape: (37, 77162)
    ✓ Random_16 (pose=(2.055777505201406, -1.0079562319315927, -1.6522637041757233)): shape (37, 800, 800)
      Valid pixels: 79164/640000 (12.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=261, max=244079, num_faces=244080
      Valid probs shape: (37, 79164)
    ✓ Random_17 (pose=(2.4123656189760503, -2.6583140434125707, -2.2874500013174393)): shape (37, 800, 800)
      Valid pixels: 63650/640000 (9.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=243999, num_faces=244080
      Valid probs shape: (37, 63650)
    ✓ Random_18 (pose=(1.0184114458249942, 2.1790361515391057, -0.62515775846231)): shape (37, 800, 800)
      Valid pixels: 97402/640000 (15.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=243995, num_faces=244080
      Valid probs shape: (37, 97402)
    ✓ Random_19 (pose=(-0.039043099587781516, 0.8289683163554207, 0.44634017720312524)): shape (37, 800, 800)
      Valid pixels: 72351/640000 (11.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=243810, num_faces=244080
      Valid probs shape: (37, 72351)
    ✓ Random_20 (pose=(-0.10248315828365362, -2.7524974028958322, -3.1215922410730386)): shape (37, 800, 800)
      Valid pixels: 53615/640000 (8.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=20, max=244079, num_faces=244080
      Valid probs shape: (37, 53615)
    ✓ Random_21 (pose=(1.853410592557287, -1.304552122281498, 1.0968352155673413)): shape (37, 800, 800)
      Valid pixels: 69990/640000 (10.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=244079, num_faces=244080
      Valid probs shape: (37, 69990)
    ✓ Random_22 (pose=(-2.2460843292001127, 0.5842523092820757, 1.4874511825629098)): shape (37, 800, 800)
      Valid pixels: 73365/640000 (11.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=96, max=244079, num_faces=244080
      Valid probs shape: (37, 73365)
    ✓ Random_23 (pose=(-0.04101208216610752, 0.6358629330197929, 0.7034536422098383)): shape (37, 800, 800)
      Valid pixels: 70023/640000 (10.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=243809, num_faces=244080
      Valid probs shape: (37, 70023)
    ✓ Random_24 (pose=(1.6246581782200415, 0.5095382311964851, -1.3594654959248782)): shape (37, 800, 800)
      Valid pixels: 73701/640000 (11.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=30, max=244078, num_faces=244080
      Valid probs shape: (37, 73701)
    ✓ Random_25 (pose=(-0.5341813745149757, 0.5903117230093735, 3.035104069366147)): shape (37, 800, 800)
      Valid pixels: 71658/640000 (11.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6, max=244000, num_faces=244080
      Valid probs shape: (37, 71658)
    ✓ Random_26 (pose=(-2.9828723252844465, -1.7617993114476045, -1.1802923498307014)): shape (37, 800, 800)
      Valid pixels: 83080/640000 (13.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=243897, num_faces=244080
      Valid probs shape: (37, 83080)
    ✓ Random_27 (pose=(0.6683197739418731, 0.05079516344569246, 2.8434202103948234)): shape (37, 800, 800)
      Valid pixels: 74692/640000 (11.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=243668, num_faces=244080
      Valid probs shape: (37, 74692)
    ✓ Random_28 (pose=(0.4759689747561313, 1.328852696033005, 0.2252013031572715)): shape (37, 800, 800)
      Valid pixels: 70093/640000 (11.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=243889, num_faces=244080
      Valid probs shape: (37, 70093)
    ✓ Random_29 (pose=(0.01874434477526421, -1.483541696474044, 2.937265594286284)): shape (37, 800, 800)
      Valid pixels: 69574/640000 (10.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=243870, num_faces=244080
      Valid probs shape: (37, 69574)
    ✓ Random_30 (pose=(1.9291093448882455, 1.4241473126939619, 1.8558610240391777)): shape (37, 800, 800)
      Valid pixels: 67427/640000 (10.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=244059, num_faces=244080
      Valid probs shape: (37, 67427)
    ✓ Random_31 (pose=(-2.245827920546804, -1.4174267721029437, 2.9069219620826576)): shape (37, 800, 800)
      Valid pixels: 92460/640000 (14.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=244078, num_faces=244080
      Valid probs shape: (37, 92460)
    ✓ Random_32 (pose=(-0.6510332906485781, -2.1063327951603785, -0.7716487212683805)): shape (37, 800, 800)
      Valid pixels: 85773/640000 (13.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=102, max=244079, num_faces=244080
      Valid probs shape: (37, 85773)
    ✓ Random_33 (pose=(-2.8684100849287106, 0.1252880788287669, -1.1584592798796676)): shape (37, 800, 800)
      Valid pixels: 60168/640000 (9.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=31278, max=244079, num_faces=244080
      Valid probs shape: (37, 60168)
    ✓ Random_34 (pose=(-1.5045295287320963, -2.688874296157555, -1.1364372187869423)): shape (37, 800, 800)
      Valid pixels: 84281/640000 (13.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=17, max=244079, num_faces=244080
      Valid probs shape: (37, 84281)
    ✓ Random_35 (pose=(2.119059023860652, 2.0785725906650683, -0.8539335511442925)): shape (37, 800, 800)
      Valid pixels: 72381/640000 (11.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=244078, num_faces=244080
      Valid probs shape: (37, 72381)
    ✓ Random_36 (pose=(-1.0851670750108209, -2.8872432559137367, -1.8466457382123058)): shape (37, 800, 800)
      Valid pixels: 66389/640000 (10.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=34, max=244076, num_faces=244080
      Valid probs shape: (37, 66389)
    ✓ Random_37 (pose=(-1.8833332648566692, -2.803125461941424, -2.2905437203513745)): shape (37, 800, 800)
      Valid pixels: 78503/640000 (12.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=243897, num_faces=244080
      Valid probs shape: (37, 78503)
    ✓ Random_38 (pose=(-1.77586125484144, 3.0690910968506797, 1.3514807994788685)): shape (37, 800, 800)
      Valid pixels: 70762/640000 (11.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=11, max=244079, num_faces=244080
      Valid probs shape: (37, 70762)
    ✓ Random_39 (pose=(1.7993448781434571, 0.4614236729443624, 1.9200212804249421)): shape (37, 800, 800)
      Valid pixels: 75210/640000 (11.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=23, max=244076, num_faces=244080
      Valid probs shape: (37, 75210)
    P stats: min=0.0000, max=0.9998, mean=0.0257
    Non-zero vertices: 116167/122042
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 5875 1078 1178 3233    0 1903  962 4437 4919]
  Ground Truth Stats:
    Labels shape: (122042,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/HLN-12-7/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7899
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8364
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8368

  RESULTS:
  RAW:         median(top-10)=0.9027, mean(top-10)=0.9077, median(all)=0.8560, mean(all)=0.7899
  + SMOOTHING: median(top-10)=0.9174, mean(top-10)=0.9219, median(all)=0.8813, mean(all)=0.8364 [+0.0148]
  + MRF:       median(top-10)=0.9174, mean(top-10)=0.9221, median(all)=0.8825, mean(all)=0.8368 [-0.0000]
  TOTAL IMPROVEMENT (median top-10): +0.0147

================================================================================
Subject: HLN-12-8
================================================================================
  Step 0: Generating predictions with V2 model (40 random views)...
  Mesh: 163705 vertices, 327406 faces
  Generating 40 random views...
  Generating predictions for 40 views (continuous camera pose)...
    ✓ Random_0 (pose=(-2.8202963846534685, -2.3005684883379343, -2.6943294270225158)): shape (37, 800, 800)
      Valid pixels: 79474/640000 (12.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=327222, num_faces=327406
      Valid probs shape: (37, 79474)
    ✓ Random_1 (pose=(2.592696429077443, -1.7881115800278018, -0.7570399468741296)): shape (37, 800, 800)
      Valid pixels: 92227/640000 (14.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=16, max=327197, num_faces=327406
      Valid probs shape: (37, 92227)
    ✓ Random_2 (pose=(-1.7338347121745115, 0.5563804543824951, -0.798353000127098)): shape (37, 800, 800)
      Valid pixels: 94400/640000 (14.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=23, max=327392, num_faces=327406
      Valid probs shape: (37, 94400)
    ✓ Random_3 (pose=(2.76821635507108, -1.5683484812867232, 0.9789501890208729)): shape (37, 800, 800)
      Valid pixels: 87680/640000 (13.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=16, max=327393, num_faces=327406
      Valid probs shape: (37, 87680)
    ✓ Random_4 (pose=(-1.2846574803064632, -1.2395192908088764, 2.067583020384891)): shape (37, 800, 800)
      Valid pixels: 94713/640000 (14.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=327267, num_faces=327406
      Valid probs shape: (37, 94713)
    ✓ Random_5 (pose=(0.6877977571500709, -0.645430144031411, -2.150006942528181)): shape (37, 800, 800)
      Valid pixels: 69602/640000 (10.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=327245, num_faces=327406
      Valid probs shape: (37, 69602)
    ✓ Random_6 (pose=(1.12574645461011, -2.055611363167925, 1.7569266903203786)): shape (37, 800, 800)
      Valid pixels: 63529/640000 (9.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=327404, num_faces=327406
      Valid probs shape: (37, 63529)
    ✓ Random_7 (pose=(-2.8302386236595614, -0.03690645151520888, 1.7333055490883105)): shape (37, 800, 800)
      Valid pixels: 43780/640000 (6.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4375, max=327405, num_faces=327406
      Valid probs shape: (37, 43780)
    ✓ Random_8 (pose=(1.2042496714956439, 2.659833031827411, 1.5318041954181716)): shape (37, 800, 800)
      Valid pixels: 66078/640000 (10.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=618, max=327403, num_faces=327406
      Valid probs shape: (37, 66078)
    ✓ Random_9 (pose=(-0.4502504912512175, 2.705610629253564, 2.0747461885139407)): shape (37, 800, 800)
      Valid pixels: 55105/640000 (8.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1998, max=327404, num_faces=327406
      Valid probs shape: (37, 55105)
    ✓ Random_10 (pose=(-0.8649530427768619, 0.1960463354311459, 1.7608857665336632)): shape (37, 800, 800)
      Valid pixels: 54234/640000 (8.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=327190, num_faces=327406
      Valid probs shape: (37, 54234)
    ✓ Random_11 (pose=(-1.5482593500948698, -0.15788761845125077, -3.1342537464179796)): shape (37, 800, 800)
      Valid pixels: 100224/640000 (15.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=12, max=327264, num_faces=327406
      Valid probs shape: (37, 100224)
    ✓ Random_12 (pose=(0.42551803108296893, 3.021819817819531, -1.8722537889950306)): shape (37, 800, 800)
      Valid pixels: 47842/640000 (7.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4364, max=327405, num_faces=327406
      Valid probs shape: (37, 47842)
    ✓ Random_13 (pose=(2.843452744793953, 2.612152059576567, -2.742702565771291)): shape (37, 800, 800)
      Valid pixels: 64411/640000 (10.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=2, max=325274, num_faces=327406
      Valid probs shape: (37, 64411)
    ✓ Random_14 (pose=(-2.2097001946361874, -1.4159806940947322, 1.3734052594518635)): shape (37, 800, 800)
      Valid pixels: 75342/640000 (11.8%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=17, max=327402, num_faces=327406
      Valid probs shape: (37, 75342)
    ✓ Random_15 (pose=(-2.5538297654763156, -2.134798285898716, -1.0331097312765478)): shape (37, 800, 800)
      Valid pixels: 63886/640000 (10.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=14, max=326479, num_faces=327406
      Valid probs shape: (37, 63886)
    ✓ Random_16 (pose=(1.4107250433025245, -2.5518203020275125, 2.346326530168456)): shape (37, 800, 800)
      Valid pixels: 90158/640000 (14.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=23, max=327404, num_faces=327406
      Valid probs shape: (37, 90158)
    ✓ Random_17 (pose=(-0.1782674191820739, 2.5255966140207597, 2.4217030201829335)): shape (37, 800, 800)
      Valid pixels: 58806/640000 (9.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4366, max=327405, num_faces=327406
      Valid probs shape: (37, 58806)
    ✓ Random_18 (pose=(0.9995159286215767, 1.6832860931190874, -1.2238094198479699)): shape (37, 800, 800)
      Valid pixels: 99163/640000 (15.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=15, max=327191, num_faces=327406
      Valid probs shape: (37, 99163)
    ✓ Random_19 (pose=(-2.9526012678846842, -1.8305673708871222, -1.1155257393780107)): shape (37, 800, 800)
      Valid pixels: 77844/640000 (12.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=16, max=326997, num_faces=327406
      Valid probs shape: (37, 77844)
    ✓ Random_20 (pose=(-2.3274628380094557, 2.535643298544607, 1.9528989125645184)): shape (37, 800, 800)
      Valid pixels: 83308/640000 (13.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=327191, num_faces=327406
      Valid probs shape: (37, 83308)
    ✓ Random_21 (pose=(3.0524636583771807, -0.310633563498933, 1.6784296454764727)): shape (37, 800, 800)
      Valid pixels: 59747/640000 (9.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=48556, max=327405, num_faces=327406
      Valid probs shape: (37, 59747)
    ✓ Random_22 (pose=(-1.4893828808306009, -0.062330299243542164, 2.66238345642181)): shape (37, 800, 800)
      Valid pixels: 101901/640000 (15.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=327267, num_faces=327406
      Valid probs shape: (37, 101901)
    ✓ Random_23 (pose=(0.4520374940731413, 0.78156000935773, 2.098820672293445)): shape (37, 800, 800)
      Valid pixels: 76473/640000 (11.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=6, max=327304, num_faces=327406
      Valid probs shape: (37, 76473)
    ✓ Random_24 (pose=(2.6963504749779474, -0.8593679384392332, -3.0903686081262993)): shape (37, 800, 800)
      Valid pixels: 67454/640000 (10.5%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=3483, max=327404, num_faces=327406
      Valid probs shape: (37, 67454)
    ✓ Random_25 (pose=(-2.185246522382135, 2.554293070689841, 2.0361448029339844)): shape (37, 800, 800)
      Valid pixels: 86412/640000 (13.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=327191, num_faces=327406
      Valid probs shape: (37, 86412)
    ✓ Random_26 (pose=(3.0264287059600763, 2.922029301762299, 2.431470716066478)): shape (37, 800, 800)
      Valid pixels: 44500/640000 (7.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=326403, num_faces=327406
      Valid probs shape: (37, 44500)
    ✓ Random_27 (pose=(-2.7248693547410703, -2.157078694347527, -1.6980477868645278)): shape (37, 800, 800)
      Valid pixels: 81691/640000 (12.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=14, max=327249, num_faces=327406
      Valid probs shape: (37, 81691)
    ✓ Random_28 (pose=(0.07318106489392351, 1.0339160968962835, 0.9958626322835258)): shape (37, 800, 800)
      Valid pixels: 84417/640000 (13.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=327388, num_faces=327406
      Valid probs shape: (37, 84417)
    ✓ Random_29 (pose=(-2.423512396993011, 1.6792661513747502, 3.013835437828644)): shape (37, 800, 800)
      Valid pixels: 76909/640000 (12.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=327001, num_faces=327406
      Valid probs shape: (37, 76909)
    ✓ Random_30 (pose=(-0.8648809755388025, 1.5104257118128368, -2.0595916711576105)): shape (37, 800, 800)
      Valid pixels: 88095/640000 (13.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=12, max=327002, num_faces=327406
      Valid probs shape: (37, 88095)
    ✓ Random_31 (pose=(-1.2708130989429194, 2.0997466278304815, 1.4892991807082607)): shape (37, 800, 800)
      Valid pixels: 69293/640000 (10.8%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=21, max=327390, num_faces=327406
      Valid probs shape: (37, 69293)
    ✓ Random_32 (pose=(0.18667785178410323, -1.4558325741352722, -2.1500503834053744)): shape (37, 800, 800)
      Valid pixels: 96466/640000 (15.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=5, max=327402, num_faces=327406
      Valid probs shape: (37, 96466)
    ✓ Random_33 (pose=(-2.2844671981756832, -3.118257268799962, -1.8460012847303346)): shape (37, 800, 800)
      Valid pixels: 58359/640000 (9.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=326418, num_faces=327406
      Valid probs shape: (37, 58359)
    ✓ Random_34 (pose=(0.6993717177336753, -0.17849551109842698, 0.18196453867130913)): shape (37, 800, 800)
      Valid pixels: 74945/640000 (11.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=327271, num_faces=327406
      Valid probs shape: (37, 74945)
    ✓ Random_35 (pose=(2.3094191645132227, 2.1276346949906992, -2.261872199510652)): shape (37, 800, 800)
      Valid pixels: 81496/640000 (12.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=9, max=327402, num_faces=327406
      Valid probs shape: (37, 81496)
    ✓ Random_36 (pose=(-0.35472047736846335, -2.7056387795627033, -1.2739170077672293)): shape (37, 800, 800)
      Valid pixels: 72530/640000 (11.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5272, max=327405, num_faces=327406
      Valid probs shape: (37, 72530)
    ✓ Random_37 (pose=(0.7200136122837066, -0.8936467107753794, 1.4667664990302898)): shape (37, 800, 800)
      Valid pixels: 72415/640000 (11.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=14, max=326999, num_faces=327406
      Valid probs shape: (37, 72415)
    ✓ Random_38 (pose=(0.8373271523409098, -1.86381111422217, 3.0951197670422443)): shape (37, 800, 800)
      Valid pixels: 93032/640000 (14.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=18, max=327393, num_faces=327406
      Valid probs shape: (37, 93032)
    ✓ Random_39 (pose=(0.6470883982583997, -1.1734345144241256, -1.2764668865542712)): shape (37, 800, 800)
      Valid pixels: 67642/640000 (10.6%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=15, max=327390, num_faces=327406
      Valid probs shape: (37, 67642)
    P stats: min=0.0000, max=1.0000, mean=0.0259
    Non-zero vertices: 156944/163705
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 6761 1126 1395 3914    0 2963 1326 5502 7865]
  Ground Truth Stats:
    Labels shape: (163705,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/HLN-12-8/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
    MRF iteration 5/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7702
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8224
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8224

  RESULTS:
  RAW:         median(top-10)=0.8966, mean(top-10)=0.8983, median(all)=0.8062, mean(all)=0.7702
  + SMOOTHING: median(top-10)=0.9136, mean(top-10)=0.9190, median(all)=0.8617, mean(all)=0.8224 [+0.0170]
  + MRF:       median(top-10)=0.9136, mean(top-10)=0.9191, median(all)=0.8620, mean(all)=0.8224 [+0.0000]
  TOTAL IMPROVEMENT (median top-10): +0.0170

================================================================================
Subject: HLN-12-9
================================================================================
  Step 0: Generating predictions with V2 model (40 random views)...
  Mesh: 137393 vertices, 274782 faces
  Generating 40 random views...
  Generating predictions for 40 views (continuous camera pose)...
    ✓ Random_0 (pose=(-1.1701576948664683, 0.2810191819310339, 2.72026759309861)): shape (37, 800, 800)
      Valid pixels: 100003/640000 (15.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=274781, num_faces=274782
      Valid probs shape: (37, 100003)
    ✓ Random_1 (pose=(0.5345735642020122, 1.0661840367043398, -2.8959207477213327)): shape (37, 800, 800)
      Valid pixels: 66111/640000 (10.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=274780, num_faces=274782
      Valid probs shape: (37, 66111)
    ✓ Random_2 (pose=(0.22840769311916942, -1.5970796620040977, -1.8895278292088582)): shape (37, 800, 800)
      Valid pixels: 99477/640000 (15.5%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=0, max=274781, num_faces=274782
      Valid probs shape: (37, 99477)
    ✓ Random_3 (pose=(0.9815783798859785, -0.2272366806035313, -1.5666159785122695)): shape (37, 800, 800)
      Valid pixels: 60458/640000 (9.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=274778, num_faces=274782
      Valid probs shape: (37, 60458)
    ✓ Random_4 (pose=(0.9075948582256439, -1.1795351905335267, 0.5258100947599456)): shape (37, 800, 800)
      Valid pixels: 104245/640000 (16.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=274781, num_faces=274782
      Valid probs shape: (37, 104245)
    ✓ Random_5 (pose=(1.8693766817285713, -1.4607664970509513, -0.9131811757177117)): shape (37, 800, 800)
      Valid pixels: 107146/640000 (16.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=33, max=274780, num_faces=274782
      Valid probs shape: (37, 107146)
    ✓ Random_6 (pose=(3.012694989758974, -0.885677703410868, 3.0269441591322455)): shape (37, 800, 800)
      Valid pixels: 69463/640000 (10.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=306, max=274780, num_faces=274782
      Valid probs shape: (37, 69463)
    ✓ Random_7 (pose=(-1.047093870573712, 0.6314541813222743, -0.6238458383660919)): shape (37, 800, 800)
      Valid pixels: 92075/640000 (14.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=0, max=274760, num_faces=274782
      Valid probs shape: (37, 92075)
    ✓ Random_8 (pose=(1.0432423013971635, -2.1671722692481636, -2.8476871105143062)): shape (37, 800, 800)
      Valid pixels: 99805/640000 (15.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=46, max=274776, num_faces=274782
      Valid probs shape: (37, 99805)
    ✓ Random_9 (pose=(-0.7398377174180926, 0.19374322600068083, -2.436203359132675)): shape (37, 800, 800)
      Valid pixels: 73553/640000 (11.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=274781, num_faces=274782
      Valid probs shape: (37, 73553)
    ✓ Random_10 (pose=(0.5761831538692186, 2.891172634460575, -2.105718518192263)): shape (37, 800, 800)
      Valid pixels: 61283/640000 (9.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1646, max=274780, num_faces=274782
      Valid probs shape: (37, 61283)
    ✓ Random_11 (pose=(1.311644568695277, 1.97365063067104, -0.46245348210330395)): shape (37, 800, 800)
      Valid pixels: 108229/640000 (16.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=274781, num_faces=274782
      Valid probs shape: (37, 108229)
    ✓ Random_12 (pose=(-0.6549883418739206, 1.4992744912711435, 2.6146529719422498)): shape (37, 800, 800)
      Valid pixels: 73529/640000 (11.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=274778, num_faces=274782
      Valid probs shape: (37, 73529)
    ✓ Random_13 (pose=(-2.8155701149240286, -2.183514461384472, -2.438665461037987)): shape (37, 800, 800)
      Valid pixels: 92201/640000 (14.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=274780, num_faces=274782
      Valid probs shape: (37, 92201)
    ✓ Random_14 (pose=(-0.31999451903822385, -1.1695160621774394, -3.093682123846227)): shape (37, 800, 800)
      Valid pixels: 68942/640000 (10.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=274781, num_faces=274782
      Valid probs shape: (37, 68942)
    ✓ Random_15 (pose=(-2.1101226521557526, -1.9504289781098472, 2.1494142601855577)): shape (37, 800, 800)
      Valid pixels: 69260/640000 (10.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=274778, num_faces=274782
      Valid probs shape: (37, 69260)
    ✓ Random_16 (pose=(2.0629119142905212, 2.1933463213252153, -0.06930013728217377)): shape (37, 800, 800)
      Valid pixels: 103905/640000 (16.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=13, max=274779, num_faces=274782
      Valid probs shape: (37, 103905)
    ✓ Random_17 (pose=(2.8317431202043766, 2.411997314945131, -3.0930940895485923)): shape (37, 800, 800)
      Valid pixels: 76287/640000 (11.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=274760, num_faces=274782
      Valid probs shape: (37, 76287)
    ✓ Random_18 (pose=(-2.252122312024451, -1.1943756533295633, -1.3260970022660679)): shape (37, 800, 800)
      Valid pixels: 71306/640000 (11.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=186, max=274781, num_faces=274782
      Valid probs shape: (37, 71306)
    ✓ Random_19 (pose=(-2.0088254575540088, 2.022406675579953, -0.11568558117386196)): shape (37, 800, 800)
      Valid pixels: 86117/640000 (13.5%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=2, max=274781, num_faces=274782
      Valid probs shape: (37, 86117)
    ✓ Random_20 (pose=(1.064232681512884, 2.554855310141181, -0.9054227911826347)): shape (37, 800, 800)
      Valid pixels: 101618/640000 (15.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=110, max=274779, num_faces=274782
      Valid probs shape: (37, 101618)
    ✓ Random_21 (pose=(0.10528441271624711, -1.7857102197605068, -0.18672027358309107)): shape (37, 800, 800)
      Valid pixels: 72510/640000 (11.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=304, max=274781, num_faces=274782
      Valid probs shape: (37, 72510)
    ✓ Random_22 (pose=(-2.078957521238099, 0.4683834360404342, 0.7695725920709715)): shape (37, 800, 800)
      Valid pixels: 75071/640000 (11.7%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=602, max=274780, num_faces=274782
      Valid probs shape: (37, 75071)
    ✓ Random_23 (pose=(-0.6491073207741809, -1.503449797188285, 0.06555112375132666)): shape (37, 800, 800)
      Valid pixels: 75456/640000 (11.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=10, max=274778, num_faces=274782
      Valid probs shape: (37, 75456)
    ✓ Random_24 (pose=(3.1114755581288653, -2.7213163125311177, -0.5977852899815592)): shape (37, 800, 800)
      Valid pixels: 58368/640000 (9.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=274781, num_faces=274782
      Valid probs shape: (37, 58368)
    ✓ Random_25 (pose=(0.5753997649767522, -1.789503429095464, -2.954582837437848)): shape (37, 800, 800)
      Valid pixels: 100240/640000 (15.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=125, max=274759, num_faces=274782
      Valid probs shape: (37, 100240)
    ✓ Random_26 (pose=(1.80529838863123, -1.1893212224767495, -2.3930046199014736)): shape (37, 800, 800)
      Valid pixels: 76430/640000 (11.9%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=7, max=274781, num_faces=274782
      Valid probs shape: (37, 76430)
    ✓ Random_27 (pose=(0.27659052966468956, -0.9391786504090547, -1.4887452619179222)): shape (37, 800, 800)
      Valid pixels: 74309/640000 (11.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=274781, num_faces=274782
      Valid probs shape: (37, 74309)
    ✓ Random_28 (pose=(2.966050451840056, -0.1454233620970693, -1.9733953943471008)): shape (37, 800, 800)
      Valid pixels: 47590/640000 (7.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3788, max=274780, num_faces=274782
      Valid probs shape: (37, 47590)
    ✓ Random_29 (pose=(0.21427310999041094, -2.4382091049209356, 2.6923813270286034)): shape (37, 800, 800)
      Valid pixels: 55001/640000 (8.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4502, max=274781, num_faces=274782
      Valid probs shape: (37, 55001)
    ✓ Random_30 (pose=(-1.9388611428341305, -1.062758469987163, 2.9197610979408255)): shape (37, 800, 800)
      Valid pixels: 107491/640000 (16.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=105, max=274780, num_faces=274782
      Valid probs shape: (37, 107491)
    ✓ Random_31 (pose=(2.9848575994859923, -1.4731361201121345, 0.2126253698293814)): shape (37, 800, 800)
      Valid pixels: 69024/640000 (10.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=274759, num_faces=274782
      Valid probs shape: (37, 69024)
    ✓ Random_32 (pose=(-0.9524447346717855, 2.647711147762127, 2.649337667408229)): shape (37, 800, 800)
      Valid pixels: 94406/640000 (14.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=201, max=274778, num_faces=274782
      Valid probs shape: (37, 94406)
    ✓ Random_33 (pose=(2.716022383770478, -0.9510074247748164, 1.4910453484805215)): shape (37, 800, 800)
      Valid pixels: 95179/640000 (14.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5520, max=274781, num_faces=274782
      Valid probs shape: (37, 95179)
    ✓ Random_34 (pose=(-2.133321886469581, 2.6882821315598635, -2.0676045926298983)): shape (37, 800, 800)
      Valid pixels: 66383/640000 (10.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=274781, num_faces=274782
      Valid probs shape: (37, 66383)
    ✓ Random_35 (pose=(-1.5061298018694431, -0.06952403165922538, -2.5741315893733447)): shape (37, 800, 800)
      Valid pixels: 85244/640000 (13.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=274781, num_faces=274782
      Valid probs shape: (37, 85244)
    ✓ Random_36 (pose=(0.821848860423779, -2.786166686518614, -1.3891320953975301)): shape (37, 800, 800)
      Valid pixels: 67561/640000 (10.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1093, max=274780, num_faces=274782
      Valid probs shape: (37, 67561)
    ✓ Random_37 (pose=(-1.7307804753558165, -2.2087506214719443, 0.7371351331451579)): shape (37, 800, 800)
      Valid pixels: 79193/640000 (12.4%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=1, max=274781, num_faces=274782
      Valid probs shape: (37, 79193)
    ✓ Random_38 (pose=(-1.7783133573350323, 2.7473623606263464, 0.7292984254918924)): shape (37, 800, 800)
      Valid pixels: 74709/640000 (11.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=274781, num_faces=274782
      Valid probs shape: (37, 74709)
    ✓ Random_39 (pose=(-0.07851613264753254, 2.024728886175555, -2.627923709510978)): shape (37, 800, 800)
      Valid pixels: 93265/640000 (14.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=201, max=274780, num_faces=274782
      Valid probs shape: (37, 93265)
    P stats: min=0.0000, max=0.9999, mean=0.0260
    Non-zero vertices: 132314/137393
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 5079 1185 1172 3302    0 2414 1105 4540 6834]
  Ground Truth Stats:
    Labels shape: (137393,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/HLN-12-9/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7915
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8333
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8333

  RESULTS:
  RAW:         median(top-10)=0.9254, mean(top-10)=0.9243, median(all)=0.8704, mean(all)=0.7915
  + SMOOTHING: median(top-10)=0.9437, mean(top-10)=0.9383, median(all)=0.8927, mean(all)=0.8333 [+0.0183]
  + MRF:       median(top-10)=0.9436, mean(top-10)=0.9384, median(all)=0.8935, mean(all)=0.8333 [-0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0181

================================================================================
Subject: MMRR-21-1
================================================================================
  Step 0: Generating predictions with V2 model (40 random views)...
  Mesh: 130631 vertices, 261258 faces
  Generating 40 random views...
  Generating predictions for 40 views (continuous camera pose)...
    ✓ Random_0 (pose=(1.0341073759135861, -1.9796988147330943, 2.936126949871273)): shape (37, 800, 800)
      Valid pixels: 92472/640000 (14.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8, max=261257, num_faces=261258
      Valid probs shape: (37, 92472)
    ✓ Random_1 (pose=(-2.6520884846683157, -2.011058705348373, -1.5896227161320318)): shape (37, 800, 800)
      Valid pixels: 80448/640000 (12.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=261198, num_faces=261258
      Valid probs shape: (37, 80448)
    ✓ Random_2 (pose=(-2.9935509172304595, 2.3503744512961298, -0.5801537414929552)): shape (37, 800, 800)
      Valid pixels: 59027/640000 (9.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=261247, num_faces=261258
      Valid probs shape: (37, 59027)
    ✓ Random_3 (pose=(0.2738192506563393, -1.0439213621521937, 1.536073635840701)): shape (37, 800, 800)
      Valid pixels: 83909/640000 (13.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=261198, num_faces=261258
      Valid probs shape: (37, 83909)
    ✓ Random_4 (pose=(3.0993366482425184, -2.544101086363213, -2.130606298518926)): shape (37, 800, 800)
      Valid pixels: 61126/640000 (9.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=261182, num_faces=261258
      Valid probs shape: (37, 61126)
    ✓ Random_5 (pose=(-1.9689597414453548, -2.216005869906874, -2.68641010061388)): shape (37, 800, 800)
      Valid pixels: 94503/640000 (14.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=261199, num_faces=261258
      Valid probs shape: (37, 94503)
    ✓ Random_6 (pose=(1.560729621879779, -2.63332468077874, 2.901076069766776)): shape (37, 800, 800)
      Valid pixels: 96533/640000 (15.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=3, max=261257, num_faces=261258
      Valid probs shape: (37, 96533)
    ✓ Random_7 (pose=(2.0568452419430976, -1.9750343609507226, 0.23821276393997604)): shape (37, 800, 800)
      Valid pixels: 76859/640000 (12.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=261192, num_faces=261258
      Valid probs shape: (37, 76859)
    ✓ Random_8 (pose=(0.37031564694414953, 1.7702267831320704, 1.3476903102547828)): shape (37, 800, 800)
      Valid pixels: 94833/640000 (14.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=261257, num_faces=261258
      Valid probs shape: (37, 94833)
    ✓ Random_9 (pose=(-1.3793333743020393, 0.5770794133352881, -1.3309739948827146)): shape (37, 800, 800)
      Valid pixels: 62703/640000 (9.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=261251, num_faces=261258
      Valid probs shape: (37, 62703)
    ✓ Random_10 (pose=(1.0901688116704866, -1.8886088219687382, -2.4046223463779115)): shape (37, 800, 800)
      Valid pixels: 86294/640000 (13.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=261257, num_faces=261258
      Valid probs shape: (37, 86294)
    ✓ Random_11 (pose=(-1.791814582722359, 0.20536437605061542, -2.3381976407994385)): shape (37, 800, 800)
      Valid pixels: 71462/640000 (11.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=20, max=261197, num_faces=261258
      Valid probs shape: (37, 71462)
    ✓ Random_12 (pose=(-2.0914694504744817, -1.1452157591900842, 1.262273064675285)): shape (37, 800, 800)
      Valid pixels: 72674/640000 (11.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=180, max=261257, num_faces=261258
      Valid probs shape: (37, 72674)
    ✓ Random_13 (pose=(-1.8920446346685367, 0.25693633552682327, 2.6045442381478505)): shape (37, 800, 800)
      Valid pixels: 99067/640000 (15.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=56, max=261192, num_faces=261258
      Valid probs shape: (37, 99067)
    ✓ Random_14 (pose=(-2.619084246281024, -0.5445595872133486, 1.9606551673097927)): shape (37, 800, 800)
      Valid pixels: 58030/640000 (9.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1983, max=261255, num_faces=261258
      Valid probs shape: (37, 58030)
    ✓ Random_15 (pose=(-0.7588021125302573, 1.0116893299055665, 2.186483647918134)): shape (37, 800, 800)
      Valid pixels: 56922/640000 (8.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=261129, num_faces=261258
      Valid probs shape: (37, 56922)
    ✓ Random_16 (pose=(-1.1376547759349251, 2.9935010449151616, -0.5321559409843832)): shape (37, 800, 800)
      Valid pixels: 90104/640000 (14.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=393, max=261257, num_faces=261258
      Valid probs shape: (37, 90104)
    ✓ Random_17 (pose=(2.90266645994265, -1.3314954273132007, 1.2934081384847769)): shape (37, 800, 800)
      Valid pixels: 94690/640000 (14.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=11, max=261257, num_faces=261258
      Valid probs shape: (37, 94690)
    ✓ Random_18 (pose=(1.3978775317710177, -1.1975526179078329, -1.1317969388595865)): shape (37, 800, 800)
      Valid pixels: 70203/640000 (11.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=58, max=261179, num_faces=261258
      Valid probs shape: (37, 70203)
    ✓ Random_19 (pose=(-2.6689643551811697, -2.3674049958780863, 2.3009379377883814)): shape (37, 800, 800)
      Valid pixels: 52364/640000 (8.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=261118, num_faces=261258
      Valid probs shape: (37, 52364)
    ✓ Random_20 (pose=(1.0045789381124273, -1.4688562137267502, -0.09971102517005814)): shape (37, 800, 800)
      Valid pixels: 96857/640000 (15.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=261196, num_faces=261258
      Valid probs shape: (37, 96857)
    ✓ Random_21 (pose=(0.6528817082547387, 0.33053280851785694, -0.20189548967611515)): shape (37, 800, 800)
      Valid pixels: 70128/640000 (11.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=261192, num_faces=261258
      Valid probs shape: (37, 70128)
    ✓ Random_22 (pose=(1.240129437520907, 0.039240474740090736, 2.693469952629246)): shape (37, 800, 800)
      Valid pixels: 93561/640000 (14.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=261257, num_faces=261258
      Valid probs shape: (37, 93561)
    ✓ Random_23 (pose=(-2.038429466195531, 1.4112527433018585, 1.1624585721428744)): shape (37, 800, 800)
      Valid pixels: 62303/640000 (9.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=155, max=261128, num_faces=261258
      Valid probs shape: (37, 62303)
    ✓ Random_24 (pose=(0.11470192920694133, -3.1255182735786504, 1.4917180018125835)): shape (37, 800, 800)
      Valid pixels: 38416/640000 (6.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=8410, max=261254, num_faces=261258
      Valid probs shape: (37, 38416)
    ✓ Random_25 (pose=(-2.0804041878502417, -1.9604896858563987, 2.169698617160277)): shape (37, 800, 800)
      Valid pixels: 61102/640000 (9.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=24, max=261128, num_faces=261258
      Valid probs shape: (37, 61102)
    ✓ Random_26 (pose=(-0.8280783360427821, -0.5625580789043889, 2.5864445966237826)): shape (37, 800, 800)
      Valid pixels: 84024/640000 (13.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=261196, num_faces=261258
      Valid probs shape: (37, 84024)
    ✓ Random_27 (pose=(2.6354336236254756, 1.1791374601899056, -0.6264903544415406)): shape (37, 800, 800)
      Valid pixels: 62487/640000 (9.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=266, max=261250, num_faces=261258
      Valid probs shape: (37, 62487)
    ✓ Random_28 (pose=(-0.7581785288216718, 1.7478607777740915, 1.0401115909918017)): shape (37, 800, 800)
      Valid pixels: 87277/640000 (13.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=8, max=261257, num_faces=261258
      Valid probs shape: (37, 87277)
    ✓ Random_29 (pose=(2.0479944612673657, 2.1398775612647896, 2.0613010722770504)): shape (37, 800, 800)
      Valid pixels: 59913/640000 (9.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=261251, num_faces=261258
      Valid probs shape: (37, 59913)
    ✓ Random_30 (pose=(-1.403316967312053, 2.0970574759300167, 2.495972601890573)): shape (37, 800, 800)
      Valid pixels: 94559/640000 (14.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=58, max=261199, num_faces=261258
      Valid probs shape: (37, 94559)
    ✓ Random_31 (pose=(-0.3636015423003043, 2.890869985388628, 1.45938753491692)): shape (37, 800, 800)
      Valid pixels: 54650/640000 (8.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3801, max=261255, num_faces=261258
      Valid probs shape: (37, 54650)
    ✓ Random_32 (pose=(1.2300236253234118, -2.7483995643221593, -1.6065970385357056)): shape (37, 800, 800)
      Valid pixels: 63100/640000 (9.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=267, max=261251, num_faces=261258
      Valid probs shape: (37, 63100)
    ✓ Random_33 (pose=(2.742230616013676, -0.8672730592469424, -1.1910421636343826)): shape (37, 800, 800)
      Valid pixels: 86435/640000 (13.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=14, max=261254, num_faces=261258
      Valid probs shape: (37, 86435)
    ✓ Random_34 (pose=(0.5389840803439183, -1.3901659887406423, -0.7884591380412775)): shape (37, 800, 800)
      Valid pixels: 62450/640000 (9.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=35, max=261255, num_faces=261258
      Valid probs shape: (37, 62450)
    ✓ Random_35 (pose=(0.984648628647899, -0.6113136598270419, 1.9754052326639577)): shape (37, 800, 800)
      Valid pixels: 57030/640000 (8.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=261191, num_faces=261258
      Valid probs shape: (37, 57030)
    ✓ Random_36 (pose=(-0.4672416331879954, 1.9392104304694575, 1.4204215308600263)): shape (37, 800, 800)
      Valid pixels: 83240/640000 (13.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=177, max=261257, num_faces=261258
      Valid probs shape: (37, 83240)
    ✓ Random_37 (pose=(1.8699698323552356, -2.914576374003507, 0.626328693834258)): shape (37, 800, 800)
      Valid pixels: 75559/640000 (11.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=261198, num_faces=261258
      Valid probs shape: (37, 75559)
    ✓ Random_38 (pose=(-0.8445525829047953, 0.770774055888249, -2.8027974492598844)): shape (37, 800, 800)
      Valid pixels: 88835/640000 (13.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=261192, num_faces=261258
      Valid probs shape: (37, 88835)
    ✓ Random_39 (pose=(-3.0389612206722214, 3.082798387247635, 0.4541806481686854)): shape (37, 800, 800)
      Valid pixels: 42576/640000 (6.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=260520, num_faces=261258
      Valid probs shape: (37, 42576)
    P stats: min=0.0000, max=1.0000, mean=0.0257
    Non-zero vertices: 124039/130631
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 6592 1275 1124 3061    0 1676  848 5023 5086]
  Ground Truth Stats:
    Labels shape: (130631,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-1/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7978
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8522
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8524

  RESULTS:
  RAW:         median(top-10)=0.9095, mean(top-10)=0.9169, median(all)=0.8537, mean(all)=0.7978
  + SMOOTHING: median(top-10)=0.9389, mean(top-10)=0.9402, median(all)=0.8835, mean(all)=0.8522 [+0.0294]
  + MRF:       median(top-10)=0.9391, mean(top-10)=0.9403, median(all)=0.8841, mean(all)=0.8524 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0295

================================================================================
Subject: MMRR-21-10
================================================================================
  Step 0: Generating predictions with V2 model (40 random views)...
  Mesh: 148162 vertices, 296320 faces
  Generating 40 random views...
  Generating predictions for 40 views (continuous camera pose)...
    ✓ Random_0 (pose=(-0.9126716441056328, 0.8195318487165788, -1.7414368137977312)): shape (37, 800, 800)
      Valid pixels: 71124/640000 (11.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=296186, num_faces=296320
      Valid probs shape: (37, 71124)
    ✓ Random_1 (pose=(-1.4375081920163364, -2.9758772694840334, 2.836815558468329)): shape (37, 800, 800)
      Valid pixels: 99584/640000 (15.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=296319, num_faces=296320
      Valid probs shape: (37, 99584)
    ✓ Random_2 (pose=(1.3062207007176605, -0.2908434575144243, 0.2828429901658649)): shape (37, 800, 800)
      Valid pixels: 91261/640000 (14.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=296319, num_faces=296320
      Valid probs shape: (37, 91261)
    ✓ Random_3 (pose=(-2.4099027168349987, -0.36706565443924344, 2.150821975877234)): shape (37, 800, 800)
      Valid pixels: 58774/640000 (9.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=103, max=296319, num_faces=296320
      Valid probs shape: (37, 58774)
    ✓ Random_4 (pose=(0.7401341415151017, -2.4429214619680715, -1.6456641309620585)): shape (37, 800, 800)
      Valid pixels: 70092/640000 (11.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=222, max=296319, num_faces=296320
      Valid probs shape: (37, 70092)
    ✓ Random_5 (pose=(-0.2635138343031178, -2.4711619975241246, 1.6135489306208628)): shape (37, 800, 800)
      Valid pixels: 73598/640000 (11.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=141, max=296319, num_faces=296320
      Valid probs shape: (37, 73598)
    ✓ Random_6 (pose=(1.8343309653696354, 2.8431197454847688, 3.0594861139118086)): shape (37, 800, 800)
      Valid pixels: 91893/640000 (14.4%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=4, max=296312, num_faces=296320
      Valid probs shape: (37, 91893)
    ✓ Random_7 (pose=(-1.35359690102287, -0.966679370392777, -2.9624291763413595)): shape (37, 800, 800)
      Valid pixels: 88715/640000 (13.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=296316, num_faces=296320
      Valid probs shape: (37, 88715)
    ✓ Random_8 (pose=(0.6015492574653973, 1.9679989467401793, -1.4340299800124665)): shape (37, 800, 800)
      Valid pixels: 95692/640000 (15.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=30, max=296319, num_faces=296320
      Valid probs shape: (37, 95692)
    ✓ Random_9 (pose=(1.0185574736085412, 1.219117619893436, 2.052200896860481)): shape (37, 800, 800)
      Valid pixels: 93913/640000 (14.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=296313, num_faces=296320
      Valid probs shape: (37, 93913)
    ✓ Random_10 (pose=(-1.6376709855727398, 1.6558131679514103, -0.6281853003812037)): shape (37, 800, 800)
      Valid pixels: 95169/640000 (14.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=10, max=296313, num_faces=296320
      Valid probs shape: (37, 95169)
    ✓ Random_11 (pose=(0.16623907140571514, 0.7171193056675964, -2.5726481198336484)): shape (37, 800, 800)
      Valid pixels: 55078/640000 (8.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=296096, num_faces=296320
      Valid probs shape: (37, 55078)
    ✓ Random_12 (pose=(-2.733514431703032, 0.6013874568634399, 2.3749604951021333)): shape (37, 800, 800)
      Valid pixels: 68797/640000 (10.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=136, max=296319, num_faces=296320
      Valid probs shape: (37, 68797)
    ✓ Random_13 (pose=(-1.9491884623113114, 2.8266327937040145, -1.2487581104576868)): shape (37, 800, 800)
      Valid pixels: 74998/640000 (11.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=296303, num_faces=296320
      Valid probs shape: (37, 74998)
    ✓ Random_14 (pose=(1.3333744796035818, -2.8637583612553095, -1.308059768887549)): shape (37, 800, 800)
      Valid pixels: 67211/640000 (10.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=14, max=296096, num_faces=296320
      Valid probs shape: (37, 67211)
    ✓ Random_15 (pose=(-2.2124519835505323, -1.1574592455448178, -0.13056668719624565)): shape (37, 800, 800)
      Valid pixels: 91153/640000 (14.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=296313, num_faces=296320
      Valid probs shape: (37, 91153)
    ✓ Random_16 (pose=(-0.3367932239320397, -2.4542751671335656, -1.3835616970092026)): shape (37, 800, 800)
      Valid pixels: 78877/640000 (12.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=18729, max=296318, num_faces=296320
      Valid probs shape: (37, 78877)
    ✓ Random_17 (pose=(2.7507291894482027, -1.90618575449079, -3.1274033469032414)): shape (37, 800, 800)
      Valid pixels: 66309/640000 (10.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=27, max=296097, num_faces=296320
      Valid probs shape: (37, 66309)
    ✓ Random_18 (pose=(-2.884857651756553, -1.8086740998252548, 0.45055647217338457)): shape (37, 800, 800)
      Valid pixels: 87545/640000 (13.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=296312, num_faces=296320
      Valid probs shape: (37, 87545)
    ✓ Random_19 (pose=(2.6763621762601, -1.0520789020838492, 1.3352578328344853)): shape (37, 800, 800)
      Valid pixels: 85668/640000 (13.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1574, max=296313, num_faces=296320
      Valid probs shape: (37, 85668)
    ✓ Random_20 (pose=(-2.4769153375612603, -1.1628707553416533, 2.6639548095610808)): shape (37, 800, 800)
      Valid pixels: 67709/640000 (10.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=12, max=296097, num_faces=296320
      Valid probs shape: (37, 67709)
    ✓ Random_21 (pose=(-0.2144371516443737, -2.336081129585862, 2.9715182240037015)): shape (37, 800, 800)
      Valid pixels: 60057/640000 (9.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1581, max=296313, num_faces=296320
      Valid probs shape: (37, 60057)
    ✓ Random_22 (pose=(-1.3877619803604606, 2.615024304934181, -0.328070801195826)): shape (37, 800, 800)
      Valid pixels: 95140/640000 (14.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=23, max=296313, num_faces=296320
      Valid probs shape: (37, 95140)
    ✓ Random_23 (pose=(2.705046867672733, 1.4694063712430214, 0.1770025755217528)): shape (37, 800, 800)
      Valid pixels: 87749/640000 (13.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=13, max=296318, num_faces=296320
      Valid probs shape: (37, 87749)
    ✓ Random_24 (pose=(-1.717011711385289, 2.4342064972927657, 3.0012371085382377)): shape (37, 800, 800)
      Valid pixels: 98103/640000 (15.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=296319, num_faces=296320
      Valid probs shape: (37, 98103)
    ✓ Random_25 (pose=(-2.0456347161754573, 2.3311633537916014, 0.6396376784669315)): shape (37, 800, 800)
      Valid pixels: 68231/640000 (10.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=0, max=296097, num_faces=296320
      Valid probs shape: (37, 68231)
    ✓ Random_26 (pose=(-2.0840931887847116, 0.7671487298767117, -0.403445166469413)): shape (37, 800, 800)
      Valid pixels: 90118/640000 (14.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=331, max=296318, num_faces=296320
      Valid probs shape: (37, 90118)
    ✓ Random_27 (pose=(1.5626577886761934, 1.1749281912839322, 2.1647722823034314)): shape (37, 800, 800)
      Valid pixels: 85435/640000 (13.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=296312, num_faces=296320
      Valid probs shape: (37, 85435)
    ✓ Random_28 (pose=(-0.9528510548755018, 2.1405207376797666, 0.1879915435986521)): shape (37, 800, 800)
      Valid pixels: 92955/640000 (14.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=11, max=296313, num_faces=296320
      Valid probs shape: (37, 92955)
    ✓ Random_29 (pose=(-0.022002203373535423, -1.1221963701614883, 2.6949926197297502)): shape (37, 800, 800)
      Valid pixels: 67413/640000 (10.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=296186, num_faces=296320
      Valid probs shape: (37, 67413)
    ✓ Random_30 (pose=(-2.303963950879603, -1.2549323574314952, 1.9819205997530887)): shape (37, 800, 800)
      Valid pixels: 69337/640000 (10.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=13, max=296259, num_faces=296320
      Valid probs shape: (37, 69337)
    ✓ Random_31 (pose=(-3.1100889251595234, 1.1782853582237047, -0.04548072187674901)): shape (37, 800, 800)
      Valid pixels: 65458/640000 (10.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=13, max=296264, num_faces=296320
      Valid probs shape: (37, 65458)
    ✓ Random_32 (pose=(-0.3812138378627261, -1.52423164794655, 1.1712284585002113)): shape (37, 800, 800)
      Valid pixels: 93162/640000 (14.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=13, max=296304, num_faces=296320
      Valid probs shape: (37, 93162)
    ✓ Random_33 (pose=(-0.9638255526844319, -1.236780841336214, 1.2724300976803722)): shape (37, 800, 800)
      Valid pixels: 68272/640000 (10.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=296092, num_faces=296320
      Valid probs shape: (37, 68272)
    ✓ Random_34 (pose=(-1.9668228540866406, 1.0466249667913976, 2.201353932131399)): shape (37, 800, 800)
      Valid pixels: 96643/640000 (15.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=19, max=296319, num_faces=296320
      Valid probs shape: (37, 96643)
    ✓ Random_35 (pose=(-1.8889764028113858, -1.6516976369941114, -2.551611815354919)): shape (37, 800, 800)
      Valid pixels: 92203/640000 (14.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=296319, num_faces=296320
      Valid probs shape: (37, 92203)
    ✓ Random_36 (pose=(1.3341968591722946, 2.0127451056888264, 0.6567870084759369)): shape (37, 800, 800)
      Valid pixels: 74456/640000 (11.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=296315, num_faces=296320
      Valid probs shape: (37, 74456)
    ✓ Random_37 (pose=(3.136034369080531, -2.4890595113528478, 1.8449544914283473)): shape (37, 800, 800)
      Valid pixels: 64205/640000 (10.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=295446, num_faces=296320
      Valid probs shape: (37, 64205)
    ✓ Random_38 (pose=(0.464630087189831, 1.0738074843578262, -2.0327629147213115)): shape (37, 800, 800)
      Valid pixels: 76869/640000 (12.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=19, max=296095, num_faces=296320
      Valid probs shape: (37, 76869)
    ✓ Random_39 (pose=(-2.184180838507491, -2.511447508976511, 2.674327098562425)): shape (37, 800, 800)
      Valid pixels: 79672/640000 (12.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=18, max=296093, num_faces=296320
      Valid probs shape: (37, 79672)
    P stats: min=0.0000, max=0.9999, mean=0.0254
    Non-zero vertices: 139346/148162
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 8816 1591  924 3855    0 2674 1500 5419 7585]
  Ground Truth Stats:
    Labels shape: (148162,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-10/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7860
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8379
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8381

  RESULTS:
  RAW:         median(top-10)=0.9006, mean(top-10)=0.9048, median(all)=0.8495, mean(all)=0.7860
  + SMOOTHING: median(top-10)=0.9260, mean(top-10)=0.9287, median(all)=0.8759, mean(all)=0.8379 [+0.0254]
  + MRF:       median(top-10)=0.9263, mean(top-10)=0.9288, median(all)=0.8760, mean(all)=0.8381 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0256

================================================================================
Subject: MMRR-21-11
================================================================================
  Step 0: Generating predictions with V2 model (40 random views)...
  Mesh: 136982 vertices, 273960 faces
  Generating 40 random views...
  Generating predictions for 40 views (continuous camera pose)...
    ✓ Random_0 (pose=(1.4714516913140345, 1.0206632391679547, 0.5732255383953446)): shape (37, 800, 800)
      Valid pixels: 87978/640000 (13.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=273959, num_faces=273960
      Valid probs shape: (37, 87978)
    ✓ Random_1 (pose=(-3.047710604948322, 1.4423711342718404, 0.612079444375631)): shape (37, 800, 800)
      Valid pixels: 97577/640000 (15.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=16, max=273956, num_faces=273960
      Valid probs shape: (37, 97577)
    ✓ Random_2 (pose=(-2.5734929899967156, 1.611130903731838, -1.3240764224888042)): shape (37, 800, 800)
      Valid pixels: 108496/640000 (17.0%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=5, max=273953, num_faces=273960
      Valid probs shape: (37, 108496)
    ✓ Random_3 (pose=(-0.27748365972147937, -0.3478655470050329, 0.8791696842064454)): shape (37, 800, 800)
      Valid pixels: 51765/640000 (8.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=273841, num_faces=273960
      Valid probs shape: (37, 51765)
    ✓ Random_4 (pose=(-2.562371036866397, 1.7329128626057777, -1.0691038549826515)): shape (37, 800, 800)
      Valid pixels: 103306/640000 (16.1%)
      Probs stats: min=0.0000, max=0.9995, mean=0.0270
      Face IDs: min=10, max=273953, num_faces=273960
      Valid probs shape: (37, 103306)
    ✓ Random_5 (pose=(3.098191932150457, 2.7725369356757747, -1.271392539665218)): shape (37, 800, 800)
      Valid pixels: 62655/640000 (9.8%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=0, max=273087, num_faces=273960
      Valid probs shape: (37, 62655)
    ✓ Random_6 (pose=(-2.285808187040758, 3.1375959454426976, 2.4104124624868897)): shape (37, 800, 800)
      Valid pixels: 81650/640000 (12.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=273959, num_faces=273960
      Valid probs shape: (37, 81650)
    ✓ Random_7 (pose=(1.096397238816821, 2.3667752547360577, 0.6692723124655262)): shape (37, 800, 800)
      Valid pixels: 75256/640000 (11.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=273959, num_faces=273960
      Valid probs shape: (37, 75256)
    ✓ Random_8 (pose=(-0.07435743628072311, -1.7124324531035024, -1.7997004532191387)): shape (37, 800, 800)
      Valid pixels: 107267/640000 (16.8%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=5, max=273957, num_faces=273960
      Valid probs shape: (37, 107267)
    ✓ Random_9 (pose=(-0.9419284912065486, 2.8425621342569913, -1.793093556206013)): shape (37, 800, 800)
      Valid pixels: 67109/640000 (10.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=781, max=273955, num_faces=273960
      Valid probs shape: (37, 67109)
    ✓ Random_10 (pose=(-1.9104671046289894, -2.2329050413219713, -1.2843710876695786)): shape (37, 800, 800)
      Valid pixels: 70609/640000 (11.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=273203, num_faces=273960
      Valid probs shape: (37, 70609)
    ✓ Random_11 (pose=(-0.16239865053214242, -1.4616307774437503, -1.8688764081257727)): shape (37, 800, 800)
      Valid pixels: 109112/640000 (17.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=5, max=273953, num_faces=273960
      Valid probs shape: (37, 109112)
    ✓ Random_12 (pose=(1.1383721920568055, -0.4531599766005989, 0.35005061158979656)): shape (37, 800, 800)
      Valid pixels: 98311/640000 (15.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=273958, num_faces=273960
      Valid probs shape: (37, 98311)
    ✓ Random_13 (pose=(0.7683656173894651, -2.3061314616706436, 1.0859695688993423)): shape (37, 800, 800)
      Valid pixels: 86493/640000 (13.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=85, max=273956, num_faces=273960
      Valid probs shape: (37, 86493)
    ✓ Random_14 (pose=(-1.090190484051671, 0.8876824668916417, 0.7639918422773779)): shape (37, 800, 800)
      Valid pixels: 85857/640000 (13.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=2, max=273951, num_faces=273960
      Valid probs shape: (37, 85857)
    ✓ Random_15 (pose=(-2.9617356448446417, 1.5819012926217129, 2.75571530395706)): shape (37, 800, 800)
      Valid pixels: 79836/640000 (12.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=273643, num_faces=273960
      Valid probs shape: (37, 79836)
    ✓ Random_16 (pose=(-2.5538012823233216, -1.2965871325431957, 1.541214488042801)): shape (37, 800, 800)
      Valid pixels: 85967/640000 (13.4%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=75, max=273955, num_faces=273960
      Valid probs shape: (37, 85967)
    ✓ Random_17 (pose=(2.619278359700483, -2.2453624464475053, -0.32436329266887043)): shape (37, 800, 800)
      Valid pixels: 81896/640000 (12.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=273636, num_faces=273960
      Valid probs shape: (37, 81896)
    ✓ Random_18 (pose=(-0.3226752084794571, -1.2153995707150211, 1.4575278692240197)): shape (37, 800, 800)
      Valid pixels: 104514/640000 (16.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=273959, num_faces=273960
      Valid probs shape: (37, 104514)
    ✓ Random_19 (pose=(0.26555964320720005, -2.1400677275963846, -2.9851309758053883)): shape (37, 800, 800)
      Valid pixels: 83161/640000 (13.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=16817, max=273957, num_faces=273960
      Valid probs shape: (37, 83161)
    ✓ Random_20 (pose=(-2.122482138062995, -0.6680007953011451, -0.6630129428109734)): shape (37, 800, 800)
      Valid pixels: 89696/640000 (14.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=2962, max=273957, num_faces=273960
      Valid probs shape: (37, 89696)
    ✓ Random_21 (pose=(-2.203137535353351, -0.9936969907500948, -1.6333099053760654)): shape (37, 800, 800)
      Valid pixels: 76826/640000 (12.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=273956, num_faces=273960
      Valid probs shape: (37, 76826)
    ✓ Random_22 (pose=(-1.7935839856862235, 2.2368759778028204, 1.2377134928476936)): shape (37, 800, 800)
      Valid pixels: 70527/640000 (11.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=273951, num_faces=273960
      Valid probs shape: (37, 70527)
    ✓ Random_23 (pose=(-2.717058393606918, -0.27547883447920984, 2.902284599979942)): shape (37, 800, 800)
      Valid pixels: 72610/640000 (11.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1025, max=273955, num_faces=273960
      Valid probs shape: (37, 72610)
    ✓ Random_24 (pose=(1.1393821473709762, -2.3026012953493646, 1.8795564977333195)): shape (37, 800, 800)
      Valid pixels: 66609/640000 (10.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=834, max=273956, num_faces=273960
      Valid probs shape: (37, 66609)
    ✓ Random_25 (pose=(-1.329797630638278, -1.23666736126455, -2.722978789685984)): shape (37, 800, 800)
      Valid pixels: 88535/640000 (13.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=273959, num_faces=273960
      Valid probs shape: (37, 88535)
    ✓ Random_26 (pose=(2.976939718770655, -1.1849022094885575, 0.4096435193190482)): shape (37, 800, 800)
      Valid pixels: 74943/640000 (11.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3991, max=273957, num_faces=273960
      Valid probs shape: (37, 74943)
    ✓ Random_27 (pose=(-0.6449740414363934, 0.1700491680791658, -2.4190500879317387)): shape (37, 800, 800)
      Valid pixels: 73511/640000 (11.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=273953, num_faces=273960
      Valid probs shape: (37, 73511)
    ✓ Random_28 (pose=(3.0023395616027306, -2.1793657697929896, -1.9468817301737975)): shape (37, 800, 800)
      Valid pixels: 91131/640000 (14.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=273959, num_faces=273960
      Valid probs shape: (37, 91131)
    ✓ Random_29 (pose=(-2.017223066200164, 2.280776127657095, 3.1372373754944407)): shape (37, 800, 800)
      Valid pixels: 94937/640000 (14.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=273959, num_faces=273960
      Valid probs shape: (37, 94937)
    ✓ Random_30 (pose=(-2.3360453512018156, 0.8898861975746399, 2.483548901154177)): shape (37, 800, 800)
      Valid pixels: 103467/640000 (16.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=63, max=273958, num_faces=273960
      Valid probs shape: (37, 103467)
    ✓ Random_31 (pose=(0.9620917825290434, 2.6079080380907396, 2.0067318896084805)): shape (37, 800, 800)
      Valid pixels: 94993/640000 (14.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=6560, max=273957, num_faces=273960
      Valid probs shape: (37, 94993)
    ✓ Random_32 (pose=(2.279567876730299, 1.1560303720091287, -0.5426845251343067)): shape (37, 800, 800)
      Valid pixels: 89750/640000 (14.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=36, max=273956, num_faces=273960
      Valid probs shape: (37, 89750)
    ✓ Random_33 (pose=(-1.5089761606510272, 2.5792739447020194, 2.6217808663821085)): shape (37, 800, 800)
      Valid pixels: 112815/640000 (17.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=65, max=273959, num_faces=273960
      Valid probs shape: (37, 112815)
    ✓ Random_34 (pose=(1.661161239268301, -0.5608324369321158, -1.5386714866812572)): shape (37, 800, 800)
      Valid pixels: 75465/640000 (11.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=273951, num_faces=273960
      Valid probs shape: (37, 75465)
    ✓ Random_35 (pose=(0.6091743433126848, 1.6953015131517644, -1.5577709551931955)): shape (37, 800, 800)
      Valid pixels: 112547/640000 (17.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=60, max=273956, num_faces=273960
      Valid probs shape: (37, 112547)
    ✓ Random_36 (pose=(-0.4770692156185854, 0.7742429847948911, 0.8237445892612523)): shape (37, 800, 800)
      Valid pixels: 92169/640000 (14.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=273951, num_faces=273960
      Valid probs shape: (37, 92169)
    ✓ Random_37 (pose=(1.598841466205343, -3.0333740061470555, 3.0837003944320687)): shape (37, 800, 800)
      Valid pixels: 103267/640000 (16.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=5, max=273955, num_faces=273960
      Valid probs shape: (37, 103267)
    ✓ Random_38 (pose=(1.384708995312283, -1.2597728999604578, 1.9798882060676402)): shape (37, 800, 800)
      Valid pixels: 80218/640000 (12.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8, max=273917, num_faces=273960
      Valid probs shape: (37, 80218)
    ✓ Random_39 (pose=(-1.2705258284634136, -0.03372297107493338, 2.3527894823340585)): shape (37, 800, 800)
      Valid pixels: 99090/640000 (15.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=273955, num_faces=273960
      Valid probs shape: (37, 99090)
    P stats: min=0.0000, max=0.9998, mean=0.0255
    Non-zero vertices: 129456/136982
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 7526 1562  797 2397    0 2146 1015 4599 6989]
  Ground Truth Stats:
    Labels shape: (136982,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-11/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7016
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7435
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7436

  RESULTS:
  RAW:         median(top-10)=0.8958, mean(top-10)=0.8932, median(all)=0.7781, mean(all)=0.7016
  + SMOOTHING: median(top-10)=0.9145, mean(top-10)=0.9120, median(all)=0.8056, mean(all)=0.7435 [+0.0187]
  + MRF:       median(top-10)=0.9148, mean(top-10)=0.9120, median(all)=0.8063, mean(all)=0.7436 [+0.0004]
  TOTAL IMPROVEMENT (median top-10): +0.0190

================================================================================
Subject: MMRR-21-12
================================================================================
  Step 0: Generating predictions with V2 model (40 random views)...
  Mesh: 102602 vertices, 205200 faces
  Generating 40 random views...
  Generating predictions for 40 views (continuous camera pose)...
    ✓ Random_0 (pose=(2.944196159438752, 1.5883064651544023, 1.4782625264162625)): shape (37, 800, 800)
      Valid pixels: 97322/640000 (15.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=205196, num_faces=205200
      Valid probs shape: (37, 97322)
    ✓ Random_1 (pose=(0.581192563658949, 1.8480434431365467, 0.7606433442753331)): shape (37, 800, 800)
      Valid pixels: 68010/640000 (10.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=58, max=205180, num_faces=205200
      Valid probs shape: (37, 68010)
    ✓ Random_2 (pose=(-1.9751971009388818, 1.2295061052841172, -2.3943254342372158)): shape (37, 800, 800)
      Valid pixels: 70181/640000 (11.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=205195, num_faces=205200
      Valid probs shape: (37, 70181)
    ✓ Random_3 (pose=(2.7504066024114433, 0.09338717447646872, 0.8124227793000833)): shape (37, 800, 800)
      Valid pixels: 55977/640000 (8.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=331, max=205198, num_faces=205200
      Valid probs shape: (37, 55977)
    ✓ Random_4 (pose=(2.965693790990831, 2.214591051893718, 2.8710580853651066)): shape (37, 800, 800)
      Valid pixels: 58075/640000 (9.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=205183, num_faces=205200
      Valid probs shape: (37, 58075)
    ✓ Random_5 (pose=(1.8309320352565308, 2.9478875260715185, 2.5293925985551873)): shape (37, 800, 800)
      Valid pixels: 92895/640000 (14.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=205109, num_faces=205200
      Valid probs shape: (37, 92895)
    ✓ Random_6 (pose=(-0.6071832499740459, 0.08282909469379751, -1.4896199515908914)): shape (37, 800, 800)
      Valid pixels: 52855/640000 (8.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=204267, num_faces=205200
      Valid probs shape: (37, 52855)
    ✓ Random_7 (pose=(1.079053165243974, 0.39371395380849483, -1.3981133622666047)): shape (37, 800, 800)
      Valid pixels: 73878/640000 (11.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=6, max=205196, num_faces=205200
      Valid probs shape: (37, 73878)
    ✓ Random_8 (pose=(-1.6701442390846706, 2.1335692328101414, -1.8465490201645436)): shape (37, 800, 800)
      Valid pixels: 64810/640000 (10.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=205195, num_faces=205200
      Valid probs shape: (37, 64810)
    ✓ Random_9 (pose=(2.4635127822832743, -1.9392831296441733, -0.7604481765536488)): shape (37, 800, 800)
      Valid pixels: 95394/640000 (14.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=205196, num_faces=205200
      Valid probs shape: (37, 95394)
    ✓ Random_10 (pose=(-2.263207915694479, 0.7441948525854754, 1.5804190822867916)): shape (37, 800, 800)
      Valid pixels: 78185/640000 (12.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=27, max=205199, num_faces=205200
      Valid probs shape: (37, 78185)
    ✓ Random_11 (pose=(0.4838600688374397, 2.5224758965893352, 2.1991833939138177)): shape (37, 800, 800)
      Valid pixels: 82591/640000 (12.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=9728, max=205199, num_faces=205200
      Valid probs shape: (37, 82591)
    ✓ Random_12 (pose=(-1.9217684891008915, 2.071011164561855, -1.2779032784646487)): shape (37, 800, 800)
      Valid pixels: 87386/640000 (13.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=205110, num_faces=205200
      Valid probs shape: (37, 87386)
    ✓ Random_13 (pose=(-2.585886443090441, -2.5261476567274825, 0.12126152753456143)): shape (37, 800, 800)
      Valid pixels: 74975/640000 (11.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=0, max=204616, num_faces=205200
      Valid probs shape: (37, 74975)
    ✓ Random_14 (pose=(-0.36577514647176246, 1.6073222893427435, -2.2125611113371724)): shape (37, 800, 800)
      Valid pixels: 101772/640000 (15.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=9, max=205196, num_faces=205200
      Valid probs shape: (37, 101772)
    ✓ Random_15 (pose=(-2.5956199590384195, -0.19907703685555145, 2.17579482454546)): shape (37, 800, 800)
      Valid pixels: 51355/640000 (8.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=418, max=205199, num_faces=205200
      Valid probs shape: (37, 51355)
    ✓ Random_16 (pose=(2.2732377162076425, 0.4705788323671496, 0.03370051296176957)): shape (37, 800, 800)
      Valid pixels: 85683/640000 (13.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=36, max=205196, num_faces=205200
      Valid probs shape: (37, 85683)
    ✓ Random_17 (pose=(0.17834999895571446, -0.9574242781685185, 0.7155671913677906)): shape (37, 800, 800)
      Valid pixels: 86156/640000 (13.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=205196, num_faces=205200
      Valid probs shape: (37, 86156)
    ✓ Random_18 (pose=(-1.5041010815338816, 2.5321501015749606, 0.04115256022644642)): shape (37, 800, 800)
      Valid pixels: 92288/640000 (14.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=5, max=205115, num_faces=205200
      Valid probs shape: (37, 92288)
    ✓ Random_19 (pose=(-2.01773164401348, 3.010920897860033, 1.0618278710116913)): shape (37, 800, 800)
      Valid pixels: 67428/640000 (10.5%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=1, max=205020, num_faces=205200
      Valid probs shape: (37, 67428)
    ✓ Random_20 (pose=(-0.4596763468974836, 0.21666447241794096, -0.6863353075101215)): shape (37, 800, 800)
      Valid pixels: 56751/640000 (8.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=204268, num_faces=205200
      Valid probs shape: (37, 56751)
    ✓ Random_21 (pose=(2.9203478567582, -2.033941765801801, -1.5230137791053875)): shape (37, 800, 800)
      Valid pixels: 94897/640000 (14.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=205196, num_faces=205200
      Valid probs shape: (37, 94897)
    ✓ Random_22 (pose=(2.2564476110792553, 1.0231754019205823, 0.02360536758549303)): shape (37, 800, 800)
      Valid pixels: 95514/640000 (14.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=27, max=205196, num_faces=205200
      Valid probs shape: (37, 95514)
    ✓ Random_23 (pose=(-2.871395142765983, -3.1229583892436645, 0.20519528432087375)): shape (37, 800, 800)
      Valid pixels: 55053/640000 (8.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=204773, num_faces=205200
      Valid probs shape: (37, 55053)
    ✓ Random_24 (pose=(-2.455957927219055, -1.886587733756787, -0.6290045392330241)): shape (37, 800, 800)
      Valid pixels: 63998/640000 (10.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=205095, num_faces=205200
      Valid probs shape: (37, 63998)
    ✓ Random_25 (pose=(-2.958527505909797, -2.526255913523685, 1.5983481457078543)): shape (37, 800, 800)
      Valid pixels: 65955/640000 (10.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=0, max=204711, num_faces=205200
      Valid probs shape: (37, 65955)
    ✓ Random_26 (pose=(2.2641443119851283, 0.6462343262019887, 0.5099408349013816)): shape (37, 800, 800)
      Valid pixels: 85131/640000 (13.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=107, max=205196, num_faces=205200
      Valid probs shape: (37, 85131)
    ✓ Random_27 (pose=(-0.25869037784855475, -2.003259575985548, -1.5489165577553896)): shape (37, 800, 800)
      Valid pixels: 93818/640000 (14.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=60, max=205198, num_faces=205200
      Valid probs shape: (37, 93818)
    ✓ Random_28 (pose=(-3.0468867331520233, 0.7074325399491164, -2.322788366478616)): shape (37, 800, 800)
      Valid pixels: 76739/640000 (12.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5854, max=205198, num_faces=205200
      Valid probs shape: (37, 76739)
    ✓ Random_29 (pose=(1.1171201484003905, 1.0126284787738546, 2.411654788896109)): shape (37, 800, 800)
      Valid pixels: 94150/640000 (14.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=3, max=205114, num_faces=205200
      Valid probs shape: (37, 94150)
    ✓ Random_30 (pose=(-1.2930527189741534, 0.024378341008195914, 0.09649886598554236)): shape (37, 800, 800)
      Valid pixels: 86442/640000 (13.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=3, max=205023, num_faces=205200
      Valid probs shape: (37, 86442)
    ✓ Random_31 (pose=(0.8695681343311348, -2.122885796455825, 2.382058704929597)): shape (37, 800, 800)
      Valid pixels: 68415/640000 (10.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2145, max=205180, num_faces=205200
      Valid probs shape: (37, 68415)
    ✓ Random_32 (pose=(2.0140158537839055, 1.6931123941258255, -2.232330043383085)): shape (37, 800, 800)
      Valid pixels: 80332/640000 (12.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=205023, num_faces=205200
      Valid probs shape: (37, 80332)
    ✓ Random_33 (pose=(-2.420128620489847, 0.38102189920154705, -0.12827063326848354)): shape (37, 800, 800)
      Valid pixels: 78329/640000 (12.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=505, max=205199, num_faces=205200
      Valid probs shape: (37, 78329)
    ✓ Random_34 (pose=(0.4336217190435665, -0.3373966398462733, 3.110499499592022)): shape (37, 800, 800)
      Valid pixels: 62727/640000 (9.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=204614, num_faces=205200
      Valid probs shape: (37, 62727)
    ✓ Random_35 (pose=(-2.315197587759633, 3.09945725673591, -2.0529539277603375)): shape (37, 800, 800)
      Valid pixels: 60537/640000 (9.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=205191, num_faces=205200
      Valid probs shape: (37, 60537)
    ✓ Random_36 (pose=(-0.9380486727326871, -2.235844790954378, 2.5396131523433993)): shape (37, 800, 800)
      Valid pixels: 93820/640000 (14.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=112, max=205196, num_faces=205200
      Valid probs shape: (37, 93820)
    ✓ Random_37 (pose=(1.9239415128519788, -0.35976355677638283, -1.0734450030888696)): shape (37, 800, 800)
      Valid pixels: 87040/640000 (13.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=26, max=205196, num_faces=205200
      Valid probs shape: (37, 87040)
    ✓ Random_38 (pose=(-0.4535964861740349, 0.6396848150585202, 0.8882391662549729)): shape (37, 800, 800)
      Valid pixels: 72681/640000 (11.4%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=0, max=204721, num_faces=205200
      Valid probs shape: (37, 72681)
    ✓ Random_39 (pose=(-1.2730438467366785, -2.9849497277391372, -1.9395482695224298)): shape (37, 800, 800)
      Valid pixels: 67311/640000 (10.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=129, max=205195, num_faces=205200
      Valid probs shape: (37, 67311)
    P stats: min=0.0000, max=0.9999, mean=0.0264
    Non-zero vertices: 100293/102602
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 2309 1191  831 2170    0 1750  966 3395 4524]
  Ground Truth Stats:
    Labels shape: (102602,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-12/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7855
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8255
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8262

  RESULTS:
  RAW:         median(top-10)=0.9284, mean(top-10)=0.9243, median(all)=0.8580, mean(all)=0.7855
  + SMOOTHING: median(top-10)=0.9373, mean(top-10)=0.9362, median(all)=0.8834, mean(all)=0.8255 [+0.0089]
  + MRF:       median(top-10)=0.9380, mean(top-10)=0.9366, median(all)=0.8840, mean(all)=0.8262 [+0.0007]
  TOTAL IMPROVEMENT (median top-10): +0.0095

================================================================================
Subject: MMRR-21-13
================================================================================
  Step 0: Generating predictions with V2 model (40 random views)...
  Mesh: 128887 vertices, 257770 faces
  Generating 40 random views...
  Generating predictions for 40 views (continuous camera pose)...
    ✓ Random_0 (pose=(0.5362148256888521, -0.6134898679982808, 1.1865692439069466)): shape (37, 800, 800)
      Valid pixels: 93749/640000 (14.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=257769, num_faces=257770
      Valid probs shape: (37, 93749)
    ✓ Random_1 (pose=(1.1049944953124857, 2.973209154862425, -1.8564250704520255)): shape (37, 800, 800)
      Valid pixels: 91303/640000 (14.3%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=1606, max=257767, num_faces=257770
      Valid probs shape: (37, 91303)
    ✓ Random_2 (pose=(0.869871278263739, -0.8887647729100512, 1.3842600385978336)): shape (37, 800, 800)
      Valid pixels: 95622/640000 (14.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=5, max=257769, num_faces=257770
      Valid probs shape: (37, 95622)
    ✓ Random_3 (pose=(-2.566691698374186, 2.3780693725995263, -2.803264287034764)): shape (37, 800, 800)
      Valid pixels: 85921/640000 (13.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=257769, num_faces=257770
      Valid probs shape: (37, 85921)
    ✓ Random_4 (pose=(-2.256704844668721, -0.8356094474388631, -0.726759704864433)): shape (37, 800, 800)
      Valid pixels: 91681/640000 (14.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=3429, max=257740, num_faces=257770
      Valid probs shape: (37, 91681)
    ✓ Random_5 (pose=(-1.5788817109877087, 0.9062524994630223, -1.4765119607275803)): shape (37, 800, 800)
      Valid pixels: 84152/640000 (13.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=257709, num_faces=257770
      Valid probs shape: (37, 84152)
    ✓ Random_6 (pose=(-1.424578839680003, -0.7852041449622749, -1.4925343561669933)): shape (37, 800, 800)
      Valid pixels: 89122/640000 (13.9%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=1, max=257701, num_faces=257770
      Valid probs shape: (37, 89122)
    ✓ Random_7 (pose=(0.9631676935180131, -1.7073863846916086, -0.9158830164766987)): shape (37, 800, 800)
      Valid pixels: 88282/640000 (13.8%)
      Probs stats: min=0.0000, max=0.9993, mean=0.0270
      Face IDs: min=102, max=257765, num_faces=257770
      Valid probs shape: (37, 88282)
    ✓ Random_8 (pose=(-0.6421611019626998, -1.0784495519077324, 1.522707471500687)): shape (37, 800, 800)
      Valid pixels: 109520/640000 (17.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=257766, num_faces=257770
      Valid probs shape: (37, 109520)
    ✓ Random_9 (pose=(0.842390534735828, 1.880421840704094, 1.1952905503376234)): shape (37, 800, 800)
      Valid pixels: 97280/640000 (15.2%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=384, max=257709, num_faces=257770
      Valid probs shape: (37, 97280)
    ✓ Random_10 (pose=(-1.8967829237315357, 1.6598945633909663, -1.9863634706186213)): shape (37, 800, 800)
      Valid pixels: 81769/640000 (12.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=257709, num_faces=257770
      Valid probs shape: (37, 81769)
    ✓ Random_11 (pose=(2.3280054882391017, -0.5076589711626744, 1.8858990894539822)): shape (37, 800, 800)
      Valid pixels: 103990/640000 (16.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=10338, max=257767, num_faces=257770
      Valid probs shape: (37, 103990)
    ✓ Random_12 (pose=(1.5797996572857587, -0.901635013361735, 2.5890566786469593)): shape (37, 800, 800)
      Valid pixels: 123755/640000 (19.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=0, max=257574, num_faces=257770
      Valid probs shape: (37, 123755)
    ✓ Random_13 (pose=(1.3232833456562263, 3.070015282583519, 2.9569050935916668)): shape (37, 800, 800)
      Valid pixels: 118968/640000 (18.6%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=4, max=257767, num_faces=257770
      Valid probs shape: (37, 118968)
    ✓ Random_14 (pose=(-0.35530857728961696, -3.0450253686666313, -0.8294886747476684)): shape (37, 800, 800)
      Valid pixels: 80050/640000 (12.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=50594, max=257767, num_faces=257770
      Valid probs shape: (37, 80050)
    ✓ Random_15 (pose=(0.07619230287637357, 1.5570937172034824, -2.105805315609443)): shape (37, 800, 800)
      Valid pixels: 126787/640000 (19.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=257769, num_faces=257770
      Valid probs shape: (37, 126787)
    ✓ Random_16 (pose=(1.5281999588516513, -2.1757709159376644, -2.245111678053987)): shape (37, 800, 800)
      Valid pixels: 93276/640000 (14.6%)
      Probs stats: min=0.0000, max=0.9995, mean=0.0270
      Face IDs: min=14, max=257765, num_faces=257770
      Valid probs shape: (37, 93276)
    ✓ Random_17 (pose=(-2.6308112549340903, -1.5112375155720452, 0.8654946083179773)): shape (37, 800, 800)
      Valid pixels: 121443/640000 (19.0%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=5, max=257765, num_faces=257770
      Valid probs shape: (37, 121443)
    ✓ Random_18 (pose=(-0.41112194993090734, -2.5990335604493575, 3.098818064851498)): shape (37, 800, 800)
      Valid pixels: 76107/640000 (11.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=149, max=257769, num_faces=257770
      Valid probs shape: (37, 76107)
    ✓ Random_19 (pose=(-2.4188204112311764, 1.8926833091362605, 3.0849499668499245)): shape (37, 800, 800)
      Valid pixels: 98244/640000 (15.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=9, max=257769, num_faces=257770
      Valid probs shape: (37, 98244)
    ✓ Random_20 (pose=(-0.7561888749015395, -0.6170718800929822, -0.0038258991483823834)): shape (37, 800, 800)
      Valid pixels: 90230/640000 (14.1%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=0, max=257158, num_faces=257770
      Valid probs shape: (37, 90230)
    ✓ Random_21 (pose=(-0.192943760380345, 1.5740350462360002, 0.5524282675594558)): shape (37, 800, 800)
      Valid pixels: 118582/640000 (18.5%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=4, max=257731, num_faces=257770
      Valid probs shape: (37, 118582)
    ✓ Random_22 (pose=(-2.6134060537318065, 0.9813421056549219, -0.6337665393639336)): shape (37, 800, 800)
      Valid pixels: 103592/640000 (16.2%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=2077, max=257767, num_faces=257770
      Valid probs shape: (37, 103592)
    ✓ Random_23 (pose=(0.8462496241910693, -1.6331972009752322, 0.3005321942641719)): shape (37, 800, 800)
      Valid pixels: 131477/640000 (20.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=257769, num_faces=257770
      Valid probs shape: (37, 131477)
    ✓ Random_24 (pose=(2.1197740907902567, 1.713931937479316, 2.543472429606762)): shape (37, 800, 800)
      Valid pixels: 105742/640000 (16.5%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=5, max=257688, num_faces=257770
      Valid probs shape: (37, 105742)
    ✓ Random_25 (pose=(1.9540296904891443, -1.3385627206088533, 0.018472559041329717)): shape (37, 800, 800)
      Valid pixels: 114535/640000 (17.9%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=0, max=257769, num_faces=257770
      Valid probs shape: (37, 114535)
    ✓ Random_26 (pose=(2.427577801639127, 2.1467869643331072, -1.6242906633329421)): shape (37, 800, 800)
      Valid pixels: 87947/640000 (13.7%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=5, max=257636, num_faces=257770
      Valid probs shape: (37, 87947)
    ✓ Random_27 (pose=(0.959882033775501, 1.7118394011504847, 0.9121284272397068)): shape (37, 800, 800)
      Valid pixels: 80565/640000 (12.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=358, max=257709, num_faces=257770
      Valid probs shape: (37, 80565)
    ✓ Random_28 (pose=(-2.766973250318545, -2.475145961229254, 0.7638157910930192)): shape (37, 800, 800)
      Valid pixels: 105190/640000 (16.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=257114, num_faces=257770
      Valid probs shape: (37, 105190)
    ✓ Random_29 (pose=(1.5006893862433488, -1.6931028134171247, -2.4836002932238226)): shape (37, 800, 800)
      Valid pixels: 98192/640000 (15.3%)
      Probs stats: min=0.0000, max=0.9992, mean=0.0270
      Face IDs: min=18, max=257765, num_faces=257770
      Valid probs shape: (37, 98192)
    ✓ Random_30 (pose=(1.8544588670728865, 2.9366724133702737, 2.2839778960158545)): shape (37, 800, 800)
      Valid pixels: 115516/640000 (18.0%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=5, max=257574, num_faces=257770
      Valid probs shape: (37, 115516)
    ✓ Random_31 (pose=(-1.616540820884373, 2.4058928031922804, -0.6003741965062717)): shape (37, 800, 800)
      Valid pixels: 123917/640000 (19.4%)
      Probs stats: min=0.0000, max=0.9995, mean=0.0270
      Face IDs: min=4, max=257574, num_faces=257770
      Valid probs shape: (37, 123917)
    ✓ Random_32 (pose=(-2.5811022755832154, 1.4861493883499408, -2.6655033630026876)): shape (37, 800, 800)
      Valid pixels: 81079/640000 (12.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=135, max=257709, num_faces=257770
      Valid probs shape: (37, 81079)
    ✓ Random_33 (pose=(1.1116402742468328, -0.9984878697429758, -2.7997685513141515)): shape (37, 800, 800)
      Valid pixels: 117362/640000 (18.3%)
      Probs stats: min=0.0000, max=0.9995, mean=0.0270
      Face IDs: min=5, max=257633, num_faces=257770
      Valid probs shape: (37, 117362)
    ✓ Random_34 (pose=(0.7458289766535984, -0.04316104109574814, -0.9789149546844773)): shape (37, 800, 800)
      Valid pixels: 80006/640000 (12.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=257759, num_faces=257770
      Valid probs shape: (37, 80006)
    ✓ Random_35 (pose=(2.5956599837190266, 1.9282641953118684, -2.5079904386673353)): shape (37, 800, 800)
      Valid pixels: 123376/640000 (19.3%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=3, max=257574, num_faces=257770
      Valid probs shape: (37, 123376)
    ✓ Random_36 (pose=(0.32181512852762273, 2.422240974545576, 0.17540094175554444)): shape (37, 800, 800)
      Valid pixels: 70790/640000 (11.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=168, max=257767, num_faces=257770
      Valid probs shape: (37, 70790)
    ✓ Random_37 (pose=(-2.1692627396198407, -1.7952306143401633, -1.2007901508248544)): shape (37, 800, 800)
      Valid pixels: 84754/640000 (13.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=257709, num_faces=257770
      Valid probs shape: (37, 84754)
    ✓ Random_38 (pose=(2.6599855874033134, -0.5875377833282789, 3.022888678179876)): shape (37, 800, 800)
      Valid pixels: 92347/640000 (14.4%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=2418, max=257767, num_faces=257770
      Valid probs shape: (37, 92347)
    ✓ Random_39 (pose=(-2.863719173586457, 0.22740040954847673, -0.8628811513949306)): shape (37, 800, 800)
      Valid pixels: 80033/640000 (12.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=13740, max=257767, num_faces=257770
      Valid probs shape: (37, 80033)
    P stats: min=0.0000, max=0.9996, mean=0.0256
    Non-zero vertices: 122273/128887
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 6614 1138 1086 2851    0 1796  684 4852 5905]
  Ground Truth Stats:
    Labels shape: (128887,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-13/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7839
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8297
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8302

  RESULTS:
  RAW:         median(top-10)=0.9046, mean(top-10)=0.9098, median(all)=0.8373, mean(all)=0.7839
  + SMOOTHING: median(top-10)=0.9177, mean(top-10)=0.9235, median(all)=0.8774, mean(all)=0.8297 [+0.0131]
  + MRF:       median(top-10)=0.9183, mean(top-10)=0.9239, median(all)=0.8784, mean(all)=0.8302 [+0.0006]
  TOTAL IMPROVEMENT (median top-10): +0.0137

================================================================================
Subject: MMRR-21-14
================================================================================
  Step 0: Generating predictions with V2 model (40 random views)...
  Mesh: 127387 vertices, 254770 faces
  Generating 40 random views...
  Generating predictions for 40 views (continuous camera pose)...
    ✓ Random_0 (pose=(1.2165314745486757, 2.0137888237805885, 0.08207107194334373)): shape (37, 800, 800)
      Valid pixels: 88698/640000 (13.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=38, max=254638, num_faces=254770
      Valid probs shape: (37, 88698)
    ✓ Random_1 (pose=(1.1617713581953515, -0.3047384154771908, -2.700407505971584)): shape (37, 800, 800)
      Valid pixels: 80798/640000 (12.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=3, max=254769, num_faces=254770
      Valid probs shape: (37, 80798)
    ✓ Random_2 (pose=(-1.462220629944684, 0.0814492574366632, -1.3377174567438317)): shape (37, 800, 800)
      Valid pixels: 76011/640000 (11.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=10, max=252424, num_faces=254770
      Valid probs shape: (37, 76011)
    ✓ Random_3 (pose=(1.7473188507154136, 1.6383541157914054, -1.5345306704007502)): shape (37, 800, 800)
      Valid pixels: 67750/640000 (10.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=254769, num_faces=254770
      Valid probs shape: (37, 67750)
    ✓ Random_4 (pose=(0.6194311982773377, -0.1543865323247191, 2.3307238938861783)): shape (37, 800, 800)
      Valid pixels: 68969/640000 (10.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=252424, num_faces=254770
      Valid probs shape: (37, 68969)
    ✓ Random_5 (pose=(3.1100071563590816, 2.4852784922047055, 0.913122690121658)): shape (37, 800, 800)
      Valid pixels: 69580/640000 (10.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=254679, num_faces=254770
      Valid probs shape: (37, 69580)
    ✓ Random_6 (pose=(-1.3682809602133381, 0.23284556556688196, -0.10840956820370273)): shape (37, 800, 800)
      Valid pixels: 95401/640000 (14.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=12, max=254683, num_faces=254770
      Valid probs shape: (37, 95401)
    ✓ Random_7 (pose=(-0.8320664165341514, -2.905833471720502, 2.6502959372003323)): shape (37, 800, 800)
      Valid pixels: 86730/640000 (13.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=79, max=254767, num_faces=254770
      Valid probs shape: (37, 86730)
    ✓ Random_8 (pose=(1.4738718274073186, -0.4124000795901308, -1.6232132916493704)): shape (37, 800, 800)
      Valid pixels: 66620/640000 (10.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=254768, num_faces=254770
      Valid probs shape: (37, 66620)
    ✓ Random_9 (pose=(2.3049073183769195, 1.7161618023045806, -2.6267162670487894)): shape (37, 800, 800)
      Valid pixels: 97489/640000 (15.2%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=0, max=254680, num_faces=254770
      Valid probs shape: (37, 97489)
    ✓ Random_10 (pose=(1.4177534309519064, -1.7699649675214684, 0.7519947242145419)): shape (37, 800, 800)
      Valid pixels: 83062/640000 (13.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=36, max=254638, num_faces=254770
      Valid probs shape: (37, 83062)
    ✓ Random_11 (pose=(2.199201754276518, -2.900029879479859, 1.5564528343940367)): shape (37, 800, 800)
      Valid pixels: 68024/640000 (10.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=252502, num_faces=254770
      Valid probs shape: (37, 68024)
    ✓ Random_12 (pose=(-1.5450376880914025, -0.9516848672783973, 0.6906143954646939)): shape (37, 800, 800)
      Valid pixels: 76356/640000 (11.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=18, max=254769, num_faces=254770
      Valid probs shape: (37, 76356)
    ✓ Random_13 (pose=(2.0337015285557047, 2.812002587233736, -2.4092960377879686)): shape (37, 800, 800)
      Valid pixels: 73284/640000 (11.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=254769, num_faces=254770
      Valid probs shape: (37, 73284)
    ✓ Random_14 (pose=(2.089771754894006, 0.9448058145973111, 0.5111754665443939)): shape (37, 800, 800)
      Valid pixels: 96558/640000 (15.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=40, max=254767, num_faces=254770
      Valid probs shape: (37, 96558)
    ✓ Random_15 (pose=(0.763100608066269, 2.7695294195400004, 2.313834924857635)): shape (37, 800, 800)
      Valid pixels: 84563/640000 (13.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3408, max=254769, num_faces=254770
      Valid probs shape: (37, 84563)
    ✓ Random_16 (pose=(-1.7791249747637525, -0.46806080970774655, 3.025181748528686)): shape (37, 800, 800)
      Valid pixels: 103519/640000 (16.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=38, max=254768, num_faces=254770
      Valid probs shape: (37, 103519)
    ✓ Random_17 (pose=(-3.0936181805130345, 1.9962916860065647, -2.2206996093539493)): shape (37, 800, 800)
      Valid pixels: 93564/640000 (14.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=252424, num_faces=254770
      Valid probs shape: (37, 93564)
    ✓ Random_18 (pose=(-2.928664133637654, 0.6695167776039308, 1.9711275779183568)): shape (37, 800, 800)
      Valid pixels: 72396/640000 (11.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=39, max=254751, num_faces=254770
      Valid probs shape: (37, 72396)
    ✓ Random_19 (pose=(0.707876476365862, -1.0740417614790347, 1.8954075509857011)): shape (37, 800, 800)
      Valid pixels: 69381/640000 (10.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=254638, num_faces=254770
      Valid probs shape: (37, 69381)
    ✓ Random_20 (pose=(0.4888310394621036, 1.5612236067061973, -1.5426667210692608)): shape (37, 800, 800)
      Valid pixels: 104643/640000 (16.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=23, max=254767, num_faces=254770
      Valid probs shape: (37, 104643)
    ✓ Random_21 (pose=(-0.09318689782748546, 1.3416330208914484, 1.3378770958311375)): shape (37, 800, 800)
      Valid pixels: 94455/640000 (14.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=6, max=254686, num_faces=254770
      Valid probs shape: (37, 94455)
    ✓ Random_22 (pose=(2.194400059727906, -2.205048084259516, 1.8211149273605445)): shape (37, 800, 800)
      Valid pixels: 93859/640000 (14.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=252424, num_faces=254770
      Valid probs shape: (37, 93859)
    ✓ Random_23 (pose=(-1.8064568822696283, -2.4669206374538555, -2.392756536264496)): shape (37, 800, 800)
      Valid pixels: 81946/640000 (12.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=254638, num_faces=254770
      Valid probs shape: (37, 81946)
    ✓ Random_24 (pose=(2.906953499040876, 2.345483327485786, -1.750204399298085)): shape (37, 800, 800)
      Valid pixels: 75765/640000 (11.8%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=1, max=252419, num_faces=254770
      Valid probs shape: (37, 75765)
    ✓ Random_25 (pose=(2.4905081624609986, 0.8711577509053745, -3.117678263760186)): shape (37, 800, 800)
      Valid pixels: 89665/640000 (14.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=4635, max=253694, num_faces=254770
      Valid probs shape: (37, 89665)
    ✓ Random_26 (pose=(0.041420255737389056, 1.5672926651761774, 0.954448652228292)): shape (37, 800, 800)
      Valid pixels: 99219/640000 (15.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=12, max=252424, num_faces=254770
      Valid probs shape: (37, 99219)
    ✓ Random_27 (pose=(0.8115771854404352, 1.2102105089146304, 1.2786364024700134)): shape (37, 800, 800)
      Valid pixels: 85522/640000 (13.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=252424, num_faces=254770
      Valid probs shape: (37, 85522)
    ✓ Random_28 (pose=(1.7167732206208433, 0.8649174488665698, -1.0038849251704716)): shape (37, 800, 800)
      Valid pixels: 88687/640000 (13.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=254767, num_faces=254770
      Valid probs shape: (37, 88687)
    ✓ Random_29 (pose=(1.3273520798004226, -2.032059585018682, -2.916195354722281)): shape (37, 800, 800)
      Valid pixels: 93760/640000 (14.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=13, max=254769, num_faces=254770
      Valid probs shape: (37, 93760)
    ✓ Random_30 (pose=(-1.3173501272891661, -2.2068981121590805, -0.30207181010294404)): shape (37, 800, 800)
      Valid pixels: 95817/640000 (15.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=12, max=254769, num_faces=254770
      Valid probs shape: (37, 95817)
    ✓ Random_31 (pose=(2.080458127475686, 1.7295571403291072, 0.9813810584673224)): shape (37, 800, 800)
      Valid pixels: 86529/640000 (13.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=254638, num_faces=254770
      Valid probs shape: (37, 86529)
    ✓ Random_32 (pose=(-0.40816875087260396, -2.9270739006624336, 1.1244333645262925)): shape (37, 800, 800)
      Valid pixels: 52820/640000 (8.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1565, max=254769, num_faces=254770
      Valid probs shape: (37, 52820)
    ✓ Random_33 (pose=(2.2697365994759986, 1.8305472537445455, 1.5598246103126572)): shape (37, 800, 800)
      Valid pixels: 75045/640000 (11.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=254638, num_faces=254770
      Valid probs shape: (37, 75045)
    ✓ Random_34 (pose=(-1.7355269506208681, -0.42129917019267404, 2.4829058687005032)): shape (37, 800, 800)
      Valid pixels: 100439/640000 (15.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=254767, num_faces=254770
      Valid probs shape: (37, 100439)
    ✓ Random_35 (pose=(0.955750167800538, 2.285147388785685, 2.7797515820480605)): shape (37, 800, 800)
      Valid pixels: 88255/640000 (13.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=116, max=254769, num_faces=254770
      Valid probs shape: (37, 88255)
    ✓ Random_36 (pose=(-1.809266421233543, 1.8954427751614542, 1.1838319668241217)): shape (37, 800, 800)
      Valid pixels: 66930/640000 (10.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=254768, num_faces=254770
      Valid probs shape: (37, 66930)
    ✓ Random_37 (pose=(-0.05369425510088943, -2.815928515621597, -0.1925581423138336)): shape (37, 800, 800)
      Valid pixels: 51277/640000 (8.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=917, max=254769, num_faces=254770
      Valid probs shape: (37, 51277)
    ✓ Random_38 (pose=(2.7188768629467495, -0.5687196114956925, 1.0281555117288539)): shape (37, 800, 800)
      Valid pixels: 64492/640000 (10.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=19255, max=252422, num_faces=254770
      Valid probs shape: (37, 64492)
    ✓ Random_39 (pose=(-1.5656692916623964, -2.306139775487969, 1.5379102153304256)): shape (37, 800, 800)
      Valid pixels: 68145/640000 (10.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=254769, num_faces=254770
      Valid probs shape: (37, 68145)
    P stats: min=0.0000, max=0.9999, mean=0.0260
    Non-zero vertices: 122504/127387
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 4883  968 1029 3321    0 1876 1369 4891 5453]
  Ground Truth Stats:
    Labels shape: (127387,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-14/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7652
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8071
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8073

  RESULTS:
  RAW:         median(top-10)=0.9267, mean(top-10)=0.9234, median(all)=0.8191, mean(all)=0.7652
  + SMOOTHING: median(top-10)=0.9363, mean(top-10)=0.9387, median(all)=0.8404, mean(all)=0.8071 [+0.0096]
  + MRF:       median(top-10)=0.9368, mean(top-10)=0.9389, median(all)=0.8403, mean(all)=0.8073 [+0.0005]
  TOTAL IMPROVEMENT (median top-10): +0.0101

================================================================================
Subject: MMRR-21-15
================================================================================
  Step 0: Generating predictions with V2 model (40 random views)...
  Mesh: 137028 vertices, 274052 faces
  Generating 40 random views...
  Generating predictions for 40 views (continuous camera pose)...
    ✓ Random_0 (pose=(-0.31539452937976975, -1.3607903680215674, -2.022572217079465)): shape (37, 800, 800)
      Valid pixels: 83559/640000 (13.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=272903, num_faces=274052
      Valid probs shape: (37, 83559)
    ✓ Random_1 (pose=(-2.7708364563388876, 3.109139360731989, 2.0602912619524307)): shape (37, 800, 800)
      Valid pixels: 44494/640000 (7.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=273960, num_faces=274052
      Valid probs shape: (37, 44494)
    ✓ Random_2 (pose=(2.7932746103876953, -1.6680321373138847, -1.8069748790062958)): shape (37, 800, 800)
      Valid pixels: 90277/640000 (14.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=273971, num_faces=274052
      Valid probs shape: (37, 90277)
    ✓ Random_3 (pose=(0.22648195103993896, -0.5212758249272844, 0.5219737003944838)): shape (37, 800, 800)
      Valid pixels: 57053/640000 (8.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=273971, num_faces=274052
      Valid probs shape: (37, 57053)
    ✓ Random_4 (pose=(-0.19039304131132662, -2.662710672798533, 1.3841959898159786)): shape (37, 800, 800)
      Valid pixels: 52485/640000 (8.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=579, max=274051, num_faces=274052
      Valid probs shape: (37, 52485)
    ✓ Random_5 (pose=(1.596318757073921, 1.2723562653827445, -2.5330393924986225)): shape (37, 800, 800)
      Valid pixels: 71986/640000 (11.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=58, max=274045, num_faces=274052
      Valid probs shape: (37, 71986)
    ✓ Random_6 (pose=(2.5012588478915667, -0.6593708261055586, -2.7480456309528534)): shape (37, 800, 800)
      Valid pixels: 58299/640000 (9.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1536, max=274051, num_faces=274052
      Valid probs shape: (37, 58299)
    ✓ Random_7 (pose=(-0.42222096197281234, -1.508905918553001, -0.2527218182827653)): shape (37, 800, 800)
      Valid pixels: 67815/640000 (10.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=11, max=274044, num_faces=274052
      Valid probs shape: (37, 67815)
    ✓ Random_8 (pose=(-0.2195646288374693, 1.5343446878168505, 1.2987824458344006)): shape (37, 800, 800)
      Valid pixels: 84026/640000 (13.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=17, max=274047, num_faces=274052
      Valid probs shape: (37, 84026)
    ✓ Random_9 (pose=(-0.21137772510219355, -2.84917439448547, -2.756928378524922)): shape (37, 800, 800)
      Valid pixels: 41558/640000 (6.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7961, max=274051, num_faces=274052
      Valid probs shape: (37, 41558)
    ✓ Random_10 (pose=(-0.7099698392735765, -2.920861104096575, -0.6723402891044974)): shape (37, 800, 800)
      Valid pixels: 72617/640000 (11.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=11870, max=274051, num_faces=274052
      Valid probs shape: (37, 72617)
    ✓ Random_11 (pose=(-0.04513801663990469, 1.0001210307723998, 0.7743248341140525)): shape (37, 800, 800)
      Valid pixels: 74217/640000 (11.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=272910, num_faces=274052
      Valid probs shape: (37, 74217)
    ✓ Random_12 (pose=(3.0473338797970326, 0.7180018999669899, 0.10429574930527696)): shape (37, 800, 800)
      Valid pixels: 51128/640000 (8.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2188, max=274051, num_faces=274052
      Valid probs shape: (37, 51128)
    ✓ Random_13 (pose=(1.8946324062012456, 0.004512839117259304, -1.8710262326051803)): shape (37, 800, 800)
      Valid pixels: 62150/640000 (9.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1510, max=274051, num_faces=274052
      Valid probs shape: (37, 62150)
    ✓ Random_14 (pose=(2.4803292365579157, 2.473707487421146, -0.07683625509739134)): shape (37, 800, 800)
      Valid pixels: 71904/640000 (11.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=273971, num_faces=274052
      Valid probs shape: (37, 71904)
    ✓ Random_15 (pose=(-0.6891323600681147, 0.7325023457474931, 0.017382391031049327)): shape (37, 800, 800)
      Valid pixels: 74058/640000 (11.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=272910, num_faces=274052
      Valid probs shape: (37, 74058)
    ✓ Random_16 (pose=(0.9984178853700953, -0.9735066743430587, -1.5509505764152267)): shape (37, 800, 800)
      Valid pixels: 63646/640000 (9.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=9, max=274047, num_faces=274052
      Valid probs shape: (37, 63646)
    ✓ Random_17 (pose=(0.39818481771754755, 1.7843897914730382, -1.8532467258828846)): shape (37, 800, 800)
      Valid pixels: 88301/640000 (13.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=25, max=273971, num_faces=274052
      Valid probs shape: (37, 88301)
    ✓ Random_18 (pose=(-3.124352387735561, 2.4849598273307674, -2.7978646966022658)): shape (37, 800, 800)
      Valid pixels: 51478/640000 (8.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=272670, num_faces=274052
      Valid probs shape: (37, 51478)
    ✓ Random_19 (pose=(-2.564071978511934, 0.8415218591947609, 0.24280402355769137)): shape (37, 800, 800)
      Valid pixels: 59852/640000 (9.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1529, max=274051, num_faces=274052
      Valid probs shape: (37, 59852)
    ✓ Random_20 (pose=(2.885664255452096, 1.5530413176302469, 1.8263025253058078)): shape (37, 800, 800)
      Valid pixels: 76879/640000 (12.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=8, max=273971, num_faces=274052
      Valid probs shape: (37, 76879)
    ✓ Random_21 (pose=(2.2921074454993366, 0.877684104462026, -1.9805354485895679)): shape (37, 800, 800)
      Valid pixels: 70553/640000 (11.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1308, max=274051, num_faces=274052
      Valid probs shape: (37, 70553)
    ✓ Random_22 (pose=(0.3694623383599773, 2.3942228586231025, 0.5906968829660846)): shape (37, 800, 800)
      Valid pixels: 53310/640000 (8.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=20914, max=274050, num_faces=274052
      Valid probs shape: (37, 53310)
    ✓ Random_23 (pose=(-0.9195908591426325, -2.4021440224183888, 1.4465453307437643)): shape (37, 800, 800)
      Valid pixels: 65616/640000 (10.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=142, max=274051, num_faces=274052
      Valid probs shape: (37, 65616)
    ✓ Random_24 (pose=(-2.684659869781796, 2.095619160011183, -2.1170657595090576)): shape (37, 800, 800)
      Valid pixels: 70214/640000 (11.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=272670, num_faces=274052
      Valid probs shape: (37, 70214)
    ✓ Random_25 (pose=(2.5831554957854976, -3.034862838959081, 0.1529700024252829)): shape (37, 800, 800)
      Valid pixels: 57680/640000 (9.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=273971, num_faces=274052
      Valid probs shape: (37, 57680)
    ✓ Random_26 (pose=(-1.6963654222258369, -2.63255882195779, 1.3197945808840386)): shape (37, 800, 800)
      Valid pixels: 63240/640000 (9.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=274044, num_faces=274052
      Valid probs shape: (37, 63240)
    ✓ Random_27 (pose=(-2.146001264455409, -2.806508354404547, 2.67907201125357)): shape (37, 800, 800)
      Valid pixels: 78228/640000 (12.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=273971, num_faces=274052
      Valid probs shape: (37, 78228)
    ✓ Random_28 (pose=(-0.1152784818938799, -1.084514908282598, 1.2645121525092033)): shape (37, 800, 800)
      Valid pixels: 82403/640000 (12.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=273971, num_faces=274052
      Valid probs shape: (37, 82403)
    ✓ Random_29 (pose=(0.43683880183969315, 0.79182132988366, 2.447999522060787)): shape (37, 800, 800)
      Valid pixels: 64676/640000 (10.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=0, max=273896, num_faces=274052
      Valid probs shape: (37, 64676)
    ✓ Random_30 (pose=(-0.06922966071704062, -0.4933844100624247, -2.393763586237224)): shape (37, 800, 800)
      Valid pixels: 50695/640000 (7.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=272860, num_faces=274052
      Valid probs shape: (37, 50695)
    ✓ Random_31 (pose=(-1.5347336274152448, -1.4199002281845101, 0.40186397058579715)): shape (37, 800, 800)
      Valid pixels: 74514/640000 (11.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=59, max=274044, num_faces=274052
      Valid probs shape: (37, 74514)
    ✓ Random_32 (pose=(0.9183054731414293, -1.6159938330203225, -0.4329116531196462)): shape (37, 800, 800)
      Valid pixels: 78181/640000 (12.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=14, max=274011, num_faces=274052
      Valid probs shape: (37, 78181)
    ✓ Random_33 (pose=(-2.9013579600687414, 1.914368879955827, 0.6520807110123803)): shape (37, 800, 800)
      Valid pixels: 71086/640000 (11.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=9, max=274044, num_faces=274052
      Valid probs shape: (37, 71086)
    ✓ Random_34 (pose=(-1.7565784647047948, -1.4804343108240565, 0.8249396995935157)): shape (37, 800, 800)
      Valid pixels: 71373/640000 (11.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=58, max=274044, num_faces=274052
      Valid probs shape: (37, 71373)
    ✓ Random_35 (pose=(-1.9892085245705777, 0.798928707929929, 2.5929930133883303)): shape (37, 800, 800)
      Valid pixels: 88848/640000 (13.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=29, max=273971, num_faces=274052
      Valid probs shape: (37, 88848)
    ✓ Random_36 (pose=(-1.9190443424371022, -2.8988305957649563, -2.2219815200397868)): shape (37, 800, 800)
      Valid pixels: 66620/640000 (10.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=273971, num_faces=274052
      Valid probs shape: (37, 66620)
    ✓ Random_37 (pose=(-1.1174195052007274, 2.4852332696778854, -0.6171600895763287)): shape (37, 800, 800)
      Valid pixels: 81201/640000 (12.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=58, max=274050, num_faces=274052
      Valid probs shape: (37, 81201)
    ✓ Random_38 (pose=(-0.09163078594400931, 1.2741558234320154, -2.5596501482118303)): shape (37, 800, 800)
      Valid pixels: 81731/640000 (12.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=273971, num_faces=274052
      Valid probs shape: (37, 81731)
    ✓ Random_39 (pose=(1.7025385227889487, 2.053978275563188, 3.066102910630619)): shape (37, 800, 800)
      Valid pixels: 85938/640000 (13.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=19, max=274044, num_faces=274052
      Valid probs shape: (37, 85938)
    P stats: min=0.0000, max=1.0000, mean=0.0256
    Non-zero vertices: 129985/137028
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 7043 1187 1274 3304    0 2127  911 4121 5953]
  Ground Truth Stats:
    Labels shape: (137028,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-15/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7927
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8395
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8400

  RESULTS:
  RAW:         median(top-10)=0.9109, mean(top-10)=0.9086, median(all)=0.8485, mean(all)=0.7927
  + SMOOTHING: median(top-10)=0.9257, mean(top-10)=0.9244, median(all)=0.8792, mean(all)=0.8395 [+0.0148]
  + MRF:       median(top-10)=0.9263, mean(top-10)=0.9247, median(all)=0.8794, mean(all)=0.8400 [+0.0006]
  TOTAL IMPROVEMENT (median top-10): +0.0154

================================================================================
Subject: MMRR-21-16
================================================================================
  Step 0: Generating predictions with V2 model (40 random views)...
  Mesh: 147500 vertices, 294996 faces
  Generating 40 random views...
  Generating predictions for 40 views (continuous camera pose)...
    ✓ Random_0 (pose=(2.5376073328580793, 0.2525908099158882, -0.6498947523207304)): shape (37, 800, 800)
      Valid pixels: 60981/640000 (9.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=788, max=294995, num_faces=294996
      Valid probs shape: (37, 60981)
    ✓ Random_1 (pose=(-1.4649837041033702, -3.119193532481737, -2.8875180474548445)): shape (37, 800, 800)
      Valid pixels: 87018/640000 (13.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=9, max=294925, num_faces=294996
      Valid probs shape: (37, 87018)
    ✓ Random_2 (pose=(2.6600193914559975, -2.009826248386781, 2.652183923874958)): shape (37, 800, 800)
      Valid pixels: 69551/640000 (10.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=294903, num_faces=294996
      Valid probs shape: (37, 69551)
    ✓ Random_3 (pose=(-2.7074746962197125, 1.0087067774741731, -2.488871138313865)): shape (37, 800, 800)
      Valid pixels: 60878/640000 (9.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1780, max=294995, num_faces=294996
      Valid probs shape: (37, 60878)
    ✓ Random_4 (pose=(2.83793813566019, -0.5046666197279843, 0.7319121726910689)): shape (37, 800, 800)
      Valid pixels: 50468/640000 (7.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=38009, max=294995, num_faces=294996
      Valid probs shape: (37, 50468)
    ✓ Random_5 (pose=(-2.101882860235907, -0.5448047318775604, -0.12266399229142833)): shape (37, 800, 800)
      Valid pixels: 86428/640000 (13.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=280, max=294995, num_faces=294996
      Valid probs shape: (37, 86428)
    ✓ Random_6 (pose=(1.305585217886776, -0.4485628615099633, 2.3946509840110384)): shape (37, 800, 800)
      Valid pixels: 85700/640000 (13.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6, max=294983, num_faces=294996
      Valid probs shape: (37, 85700)
    ✓ Random_7 (pose=(-2.2907398343309042, -1.168146320740358, -0.4869171107666892)): shape (37, 800, 800)
      Valid pixels: 75019/640000 (11.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=87, max=294995, num_faces=294996
      Valid probs shape: (37, 75019)
    ✓ Random_8 (pose=(0.04240488509364182, 0.8425868429817509, -1.4183832187350751)): shape (37, 800, 800)
      Valid pixels: 72900/640000 (11.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=294925, num_faces=294996
      Valid probs shape: (37, 72900)
    ✓ Random_9 (pose=(-2.594236533738684, -1.532839200101619, 1.679520024122989)): shape (37, 800, 800)
      Valid pixels: 72001/640000 (11.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=41, max=294995, num_faces=294996
      Valid probs shape: (37, 72001)
    ✓ Random_10 (pose=(0.49011593799492337, 1.0257553256190768, -1.2570072018547471)): shape (37, 800, 800)
      Valid pixels: 85481/640000 (13.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=294925, num_faces=294996
      Valid probs shape: (37, 85481)
    ✓ Random_11 (pose=(-0.3309161632154467, -1.9074731096557633, -2.5734975088545147)): shape (37, 800, 800)
      Valid pixels: 65702/640000 (10.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=294995, num_faces=294996
      Valid probs shape: (37, 65702)
    ✓ Random_12 (pose=(-3.017264045897711, -0.965828603847279, 2.464055044518118)): shape (37, 800, 800)
      Valid pixels: 61688/640000 (9.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=225, max=294995, num_faces=294996
      Valid probs shape: (37, 61688)
    ✓ Random_13 (pose=(-0.7758490155297673, -0.6472241559937517, 0.35853140264645056)): shape (37, 800, 800)
      Valid pixels: 60425/640000 (9.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=294925, num_faces=294996
      Valid probs shape: (37, 60425)
    ✓ Random_14 (pose=(-1.4996683265651656, 1.0752880074981412, -2.647917246649533)): shape (37, 800, 800)
      Valid pixels: 81072/640000 (12.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=294925, num_faces=294996
      Valid probs shape: (37, 81072)
    ✓ Random_15 (pose=(0.48887586156803886, -0.26335809504081675, 0.8428958920589529)): shape (37, 800, 800)
      Valid pixels: 57249/640000 (8.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=294923, num_faces=294996
      Valid probs shape: (37, 57249)
    ✓ Random_16 (pose=(1.0383643020186462, 0.34462986192503875, 3.049334362859514)): shape (37, 800, 800)
      Valid pixels: 76770/640000 (12.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=294995, num_faces=294996
      Valid probs shape: (37, 76770)
    ✓ Random_17 (pose=(-0.2741369740742945, -2.1590178741281703, 0.2569371434312644)): shape (37, 800, 800)
      Valid pixels: 58609/640000 (9.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=224, max=294991, num_faces=294996
      Valid probs shape: (37, 58609)
    ✓ Random_18 (pose=(2.982780599319378, -0.2791724193722125, 0.9828767923627808)): shape (37, 800, 800)
      Valid pixels: 48628/640000 (7.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=54907, max=294995, num_faces=294996
      Valid probs shape: (37, 48628)
    ✓ Random_19 (pose=(2.8630567047989812, 2.2411678767002385, -1.8003649014209562)): shape (37, 800, 800)
      Valid pixels: 72850/640000 (11.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=294982, num_faces=294996
      Valid probs shape: (37, 72850)
    ✓ Random_20 (pose=(-0.46006223727622597, 0.8140995400939572, -2.9163509849402787)): shape (37, 800, 800)
      Valid pixels: 74710/640000 (11.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=294924, num_faces=294996
      Valid probs shape: (37, 74710)
    ✓ Random_21 (pose=(-1.9142944530587502, -1.2774557168058613, 2.6943135580969333)): shape (37, 800, 800)
      Valid pixels: 91577/640000 (14.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=17, max=294925, num_faces=294996
      Valid probs shape: (37, 91577)
    ✓ Random_22 (pose=(-0.6049409668558008, 2.5321113735311673, -2.4191050179203115)): shape (37, 800, 800)
      Valid pixels: 73155/640000 (11.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=294995, num_faces=294996
      Valid probs shape: (37, 73155)
    ✓ Random_23 (pose=(-0.6616529266713655, 2.715066768371818, 2.4934046792952156)): shape (37, 800, 800)
      Valid pixels: 63276/640000 (9.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=790, max=294984, num_faces=294996
      Valid probs shape: (37, 63276)
    ✓ Random_24 (pose=(-1.2442192729075519, 2.582598968578327, -0.2966870523595664)): shape (37, 800, 800)
      Valid pixels: 90205/640000 (14.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=273, max=294991, num_faces=294996
      Valid probs shape: (37, 90205)
    ✓ Random_25 (pose=(-1.047514631792886, -0.8345573377134468, 2.4569962036661135)): shape (37, 800, 800)
      Valid pixels: 90282/640000 (14.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=294924, num_faces=294996
      Valid probs shape: (37, 90282)
    ✓ Random_26 (pose=(-0.2946332730559238, 2.9696973423869055, 1.549303438742439)): shape (37, 800, 800)
      Valid pixels: 45333/640000 (7.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1742, max=294995, num_faces=294996
      Valid probs shape: (37, 45333)
    ✓ Random_27 (pose=(-0.04989783639647083, -0.9167229389487299, -2.7811768282678018)): shape (37, 800, 800)
      Valid pixels: 64370/640000 (10.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=294788, num_faces=294996
      Valid probs shape: (37, 64370)
    ✓ Random_28 (pose=(-2.242888254203492, -1.1984680547806696, -2.213284136144225)): shape (37, 800, 800)
      Valid pixels: 84641/640000 (13.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=294925, num_faces=294996
      Valid probs shape: (37, 84641)
    ✓ Random_29 (pose=(-1.4837677880870153, 0.07510700765710743, -0.2144348010594994)): shape (37, 800, 800)
      Valid pixels: 90360/640000 (14.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=294991, num_faces=294996
      Valid probs shape: (37, 90360)
    ✓ Random_30 (pose=(-0.525754980698157, -2.328707432746574, -0.5785352465545994)): shape (37, 800, 800)
      Valid pixels: 74374/640000 (11.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2444, max=294995, num_faces=294996
      Valid probs shape: (37, 74374)
    ✓ Random_31 (pose=(-1.1331094786429632, 2.799844631306968, 2.7732222850125767)): shape (37, 800, 800)
      Valid pixels: 90844/640000 (14.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=294925, num_faces=294996
      Valid probs shape: (37, 90844)
    ✓ Random_32 (pose=(-2.020305378372327, -2.4786118037785076, -2.611640875006194)): shape (37, 800, 800)
      Valid pixels: 83420/640000 (13.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=294925, num_faces=294996
      Valid probs shape: (37, 83420)
    ✓ Random_33 (pose=(-0.4692013321781623, -1.3735757690813601, 1.9444510943148439)): shape (37, 800, 800)
      Valid pixels: 93465/640000 (14.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=294925, num_faces=294996
      Valid probs shape: (37, 93465)
    ✓ Random_34 (pose=(2.5672294077981777, 0.5931149586513924, 1.456266751006229)): shape (37, 800, 800)
      Valid pixels: 60358/640000 (9.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=294995, num_faces=294996
      Valid probs shape: (37, 60358)
    ✓ Random_35 (pose=(-2.1866000743951375, -2.1980175993047153, 0.6112979050627216)): shape (37, 800, 800)
      Valid pixels: 80625/640000 (12.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=9, max=294821, num_faces=294996
      Valid probs shape: (37, 80625)
    ✓ Random_36 (pose=(-0.04950291030163889, -1.4555053068055377, -3.034762682322107)): shape (37, 800, 800)
      Valid pixels: 60238/640000 (9.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=294994, num_faces=294996
      Valid probs shape: (37, 60238)
    ✓ Random_37 (pose=(1.4034201878234294, -0.2137717207950387, 1.4304073786245404)): shape (37, 800, 800)
      Valid pixels: 58407/640000 (9.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=294924, num_faces=294996
      Valid probs shape: (37, 58407)
    ✓ Random_38 (pose=(1.684746144856117, -1.9932309559163153, -1.531103090965199)): shape (37, 800, 800)
      Valid pixels: 65164/640000 (10.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=61, max=294924, num_faces=294996
      Valid probs shape: (37, 65164)
    ✓ Random_39 (pose=(1.0111918683825483, -2.9875100669120984, 0.1606253028775484)): shape (37, 800, 800)
      Valid pixels: 80529/640000 (12.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=294925, num_faces=294996
      Valid probs shape: (37, 80529)
    P stats: min=0.0000, max=0.9999, mean=0.0261
    Non-zero vertices: 142212/147500
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 5288 1353 1382 3255    0 2413 1174 4849 6579]
  Ground Truth Stats:
    Labels shape: (147500,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-16/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7897
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8328
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8329

  RESULTS:
  RAW:         median(top-10)=0.9259, mean(top-10)=0.9193, median(all)=0.8517, mean(all)=0.7897
  + SMOOTHING: median(top-10)=0.9395, mean(top-10)=0.9368, median(all)=0.8804, mean(all)=0.8328 [+0.0136]
  + MRF:       median(top-10)=0.9403, mean(top-10)=0.9370, median(all)=0.8806, mean(all)=0.8329 [+0.0008]
  TOTAL IMPROVEMENT (median top-10): +0.0143

================================================================================
Subject: MMRR-21-17
================================================================================
  Step 0: Generating predictions with V2 model (40 random views)...
  Mesh: 126138 vertices, 252272 faces
  Generating 40 random views...
  Generating predictions for 40 views (continuous camera pose)...
    ✓ Random_0 (pose=(-0.34455996415032475, 2.7169451405697718, -0.5015256111868953)): shape (37, 800, 800)
      Valid pixels: 55791/640000 (8.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=24279, max=252268, num_faces=252272
      Valid probs shape: (37, 55791)
    ✓ Random_1 (pose=(0.6371814913891312, -0.9547355138338327, -0.6191491436110961)): shape (37, 800, 800)
      Valid pixels: 60968/640000 (9.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8, max=252204, num_faces=252272
      Valid probs shape: (37, 60968)
    ✓ Random_2 (pose=(1.597803841060263, -2.4525132647577115, -1.3313131815499863)): shape (37, 800, 800)
      Valid pixels: 77413/640000 (12.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=252204, num_faces=252272
      Valid probs shape: (37, 77413)
    ✓ Random_3 (pose=(0.6188029773917196, 0.7882116600054494, -2.1013015017465984)): shape (37, 800, 800)
      Valid pixels: 63220/640000 (9.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=252203, num_faces=252272
      Valid probs shape: (37, 63220)
    ✓ Random_4 (pose=(2.408125990543941, 2.3164949052273442, 2.406076617766815)): shape (37, 800, 800)
      Valid pixels: 68421/640000 (10.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=252270, num_faces=252272
      Valid probs shape: (37, 68421)
    ✓ Random_5 (pose=(2.106788262057572, -3.03891852089385, -1.4159691097445801)): shape (37, 800, 800)
      Valid pixels: 64485/640000 (10.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=16, max=252203, num_faces=252272
      Valid probs shape: (37, 64485)
    ✓ Random_6 (pose=(0.8440853559246815, 2.815876177256132, -0.8957463482089749)): shape (37, 800, 800)
      Valid pixels: 89004/640000 (13.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=184, max=252204, num_faces=252272
      Valid probs shape: (37, 89004)
    ✓ Random_7 (pose=(0.6911006900090522, -2.611036309124019, 0.160138643627739)): shape (37, 800, 800)
      Valid pixels: 86621/640000 (13.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=169, max=252204, num_faces=252272
      Valid probs shape: (37, 86621)
    ✓ Random_8 (pose=(-1.5219398702423075, -1.3320893761405386, 2.0134434806291486)): shape (37, 800, 800)
      Valid pixels: 89765/640000 (14.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=252204, num_faces=252272
      Valid probs shape: (37, 89765)
    ✓ Random_9 (pose=(-1.289572973494439, -0.06472830480710146, 2.1154996035389866)): shape (37, 800, 800)
      Valid pixels: 88643/640000 (13.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=252204, num_faces=252272
      Valid probs shape: (37, 88643)
    ✓ Random_10 (pose=(0.2587784965274924, 1.0455889759720511, -2.1097048897897936)): shape (37, 800, 800)
      Valid pixels: 86238/640000 (13.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=252204, num_faces=252272
      Valid probs shape: (37, 86238)
    ✓ Random_11 (pose=(-0.2290517037182025, 0.5411089213450255, -1.6885953313856539)): shape (37, 800, 800)
      Valid pixels: 67430/640000 (10.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=252204, num_faces=252272
      Valid probs shape: (37, 67430)
    ✓ Random_12 (pose=(3.0697185826814195, 3.1387916425218725, 1.6348124059150155)): shape (37, 800, 800)
      Valid pixels: 47067/640000 (7.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=251586, num_faces=252272
      Valid probs shape: (37, 47067)
    ✓ Random_13 (pose=(1.923960324357493, 3.0456142098080674, -0.3025135904512002)): shape (37, 800, 800)
      Valid pixels: 100198/640000 (15.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=252204, num_faces=252272
      Valid probs shape: (37, 100198)
    ✓ Random_14 (pose=(-1.2332395041275126, -1.4244111927620753, -0.3078828413592225)): shape (37, 800, 800)
      Valid pixels: 93988/640000 (14.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=4, max=252271, num_faces=252272
      Valid probs shape: (37, 93988)
    ✓ Random_15 (pose=(2.084368531186918, 3.11508839732642, 2.4030433516506218)): shape (37, 800, 800)
      Valid pixels: 93574/640000 (14.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=252271, num_faces=252272
      Valid probs shape: (37, 93574)
    ✓ Random_16 (pose=(0.2926722301656439, 2.9513242945703198, 2.6652516669873423)): shape (37, 800, 800)
      Valid pixels: 59724/640000 (9.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=37672, max=252271, num_faces=252272
      Valid probs shape: (37, 59724)
    ✓ Random_17 (pose=(-2.778896363052939, 0.14555262084480036, -2.7717616022859715)): shape (37, 800, 800)
      Valid pixels: 52236/640000 (8.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=780, max=252268, num_faces=252272
      Valid probs shape: (37, 52236)
    ✓ Random_18 (pose=(-1.8735315438947098, -0.029119317503082165, -0.21902959796588917)): shape (37, 800, 800)
      Valid pixels: 98078/640000 (15.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=35, max=252271, num_faces=252272
      Valid probs shape: (37, 98078)
    ✓ Random_19 (pose=(2.749023072714002, -2.569422975390041, -2.043537823676375)): shape (37, 800, 800)
      Valid pixels: 61077/640000 (9.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=252204, num_faces=252272
      Valid probs shape: (37, 61077)
    ✓ Random_20 (pose=(-1.4995622119694683, 2.4706147647816126, 1.736596059757983)): shape (37, 800, 800)
      Valid pixels: 71288/640000 (11.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=252204, num_faces=252272
      Valid probs shape: (37, 71288)
    ✓ Random_21 (pose=(0.31298771173959183, 1.4369008960824718, 1.0151898097323047)): shape (37, 800, 800)
      Valid pixels: 97080/640000 (15.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=252270, num_faces=252272
      Valid probs shape: (37, 97080)
    ✓ Random_22 (pose=(-1.1049420267750798, -2.490721554259434, -1.551787153954205)): shape (37, 800, 800)
      Valid pixels: 74684/640000 (11.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3173, max=252269, num_faces=252272
      Valid probs shape: (37, 74684)
    ✓ Random_23 (pose=(0.3999214025021396, 2.967766464434657, -2.0462704102932987)): shape (37, 800, 800)
      Valid pixels: 52771/640000 (8.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3907, max=252271, num_faces=252272
      Valid probs shape: (37, 52771)
    ✓ Random_24 (pose=(0.5785221367910656, -0.580484542225177, -1.6967406478597256)): shape (37, 800, 800)
      Valid pixels: 63324/640000 (9.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=252200, num_faces=252272
      Valid probs shape: (37, 63324)
    ✓ Random_25 (pose=(0.13499188903451964, 2.685011011107771, 0.7274105465824965)): shape (37, 800, 800)
      Valid pixels: 59880/640000 (9.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=32107, max=252268, num_faces=252272
      Valid probs shape: (37, 59880)
    ✓ Random_26 (pose=(-3.0801800309908733, -0.06189462663907985, 1.5832123013790342)): shape (37, 800, 800)
      Valid pixels: 45594/640000 (7.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3751, max=252264, num_faces=252272
      Valid probs shape: (37, 45594)
    ✓ Random_27 (pose=(2.064312513565291, -1.5801213729739616, -0.41396738379539455)): shape (37, 800, 800)
      Valid pixels: 100595/640000 (15.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=13, max=252204, num_faces=252272
      Valid probs shape: (37, 100595)
    ✓ Random_28 (pose=(-2.5961752072262883, -2.0241971529194043, -0.08981280957225835)): shape (37, 800, 800)
      Valid pixels: 86810/640000 (13.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=252270, num_faces=252272
      Valid probs shape: (37, 86810)
    ✓ Random_29 (pose=(-2.1014123221043626, -2.915444298069668, -2.859122635214658)): shape (37, 800, 800)
      Valid pixels: 88405/640000 (13.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=252204, num_faces=252272
      Valid probs shape: (37, 88405)
    ✓ Random_30 (pose=(2.6029011779707503, -2.553164669110356, -1.8526073619198389)): shape (37, 800, 800)
      Valid pixels: 65550/640000 (10.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=252203, num_faces=252272
      Valid probs shape: (37, 65550)
    ✓ Random_31 (pose=(-1.2899481252844405, 0.941669887093501, 2.466667004758942)): shape (37, 800, 800)
      Valid pixels: 95308/640000 (14.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=14, max=252204, num_faces=252272
      Valid probs shape: (37, 95308)
    ✓ Random_32 (pose=(-0.6121908684694808, 0.958459355069678, -3.0075202774977394)): shape (37, 800, 800)
      Valid pixels: 89910/640000 (14.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=252204, num_faces=252272
      Valid probs shape: (37, 89910)
    ✓ Random_33 (pose=(-0.056299400879693984, -0.40446135885176426, -1.9206493710640917)): shape (37, 800, 800)
      Valid pixels: 66026/640000 (10.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=251586, num_faces=252272
      Valid probs shape: (37, 66026)
    ✓ Random_34 (pose=(-1.2930712282751338, 2.0669873110706547, 2.2381219410351187)): shape (37, 800, 800)
      Valid pixels: 87388/640000 (13.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=36, max=252204, num_faces=252272
      Valid probs shape: (37, 87388)
    ✓ Random_35 (pose=(3.0158628332407647, 2.545604383352221, -1.4071727756674401)): shape (37, 800, 800)
      Valid pixels: 65527/640000 (10.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=252200, num_faces=252272
      Valid probs shape: (37, 65527)
    ✓ Random_36 (pose=(-1.9520514408478493, -2.277884519255365, -2.213482118501915)): shape (37, 800, 800)
      Valid pixels: 80099/640000 (12.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=252204, num_faces=252272
      Valid probs shape: (37, 80099)
    ✓ Random_37 (pose=(2.577878785463972, 3.0201892217097273, 3.1358596413386834)): shape (37, 800, 800)
      Valid pixels: 73329/640000 (11.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=252259, num_faces=252272
      Valid probs shape: (37, 73329)
    ✓ Random_38 (pose=(1.9529909124639264, -0.9596646201559351, 0.12634310315961716)): shape (37, 800, 800)
      Valid pixels: 86460/640000 (13.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=28, max=252270, num_faces=252272
      Valid probs shape: (37, 86460)
    ✓ Random_39 (pose=(0.08810738542763907, 1.265791740549325, 2.6807418579297613)): shape (37, 800, 800)
      Valid pixels: 64914/640000 (10.1%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=12, max=252200, num_faces=252272
      Valid probs shape: (37, 64914)
    P stats: min=0.0000, max=0.9999, mean=0.0262
    Non-zero vertices: 122057/126138
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 4081 1142 1271 2828    0 2673  926 4873 5521]
  Ground Truth Stats:
    Labels shape: (126138,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-17/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7843
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8249
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8249

  RESULTS:
  RAW:         median(top-10)=0.9216, mean(top-10)=0.9230, median(all)=0.8590, mean(all)=0.7843
  + SMOOTHING: median(top-10)=0.9321, mean(top-10)=0.9334, median(all)=0.8909, mean(all)=0.8249 [+0.0105]
  + MRF:       median(top-10)=0.9320, mean(top-10)=0.9336, median(all)=0.8916, mean(all)=0.8249 [-0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0104

================================================================================
Subject: MMRR-21-18
================================================================================
  Step 0: Generating predictions with V2 model (40 random views)...
  Mesh: 131379 vertices, 262754 faces
  Generating 40 random views...
  Generating predictions for 40 views (continuous camera pose)...
    ✓ Random_0 (pose=(-1.5177767057221434, -1.7805330933966383, 2.452730086146386)): shape (37, 800, 800)
      Valid pixels: 93848/640000 (14.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=262753, num_faces=262754
      Valid probs shape: (37, 93848)
    ✓ Random_1 (pose=(0.6852821554305231, -0.9486460956744946, 0.9404566125783145)): shape (37, 800, 800)
      Valid pixels: 80740/640000 (12.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=262753, num_faces=262754
      Valid probs shape: (37, 80740)
    ✓ Random_2 (pose=(-0.43486382360171083, 2.264101370611712, -2.438594544553994)): shape (37, 800, 800)
      Valid pixels: 82218/640000 (12.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=262753, num_faces=262754
      Valid probs shape: (37, 82218)
    ✓ Random_3 (pose=(-0.7766349917021689, -0.3551037670057777, -1.6898874325656308)): shape (37, 800, 800)
      Valid pixels: 61213/640000 (9.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=260882, num_faces=262754
      Valid probs shape: (37, 61213)
    ✓ Random_4 (pose=(0.25762750579721816, 0.5522825375171747, -2.7891006366301214)): shape (37, 800, 800)
      Valid pixels: 51523/640000 (8.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=262643, num_faces=262754
      Valid probs shape: (37, 51523)
    ✓ Random_5 (pose=(0.6567093670289572, 0.9297967137780949, 1.267156935696586)): shape (37, 800, 800)
      Valid pixels: 75843/640000 (11.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=260873, num_faces=262754
      Valid probs shape: (37, 75843)
    ✓ Random_6 (pose=(2.9515032911807877, -0.1048840639671158, -2.950867592799877)): shape (37, 800, 800)
      Valid pixels: 47026/640000 (7.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=15608, max=262753, num_faces=262754
      Valid probs shape: (37, 47026)
    ✓ Random_7 (pose=(2.9308900066180366, -0.9261149554580732, -1.464449398814697)): shape (37, 800, 800)
      Valid pixels: 79900/640000 (12.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=262753, num_faces=262754
      Valid probs shape: (37, 79900)
    ✓ Random_8 (pose=(-1.4595299241005217, 0.11275652912983869, 1.6564218421746464)): shape (37, 800, 800)
      Valid pixels: 66231/640000 (10.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=63, max=262643, num_faces=262754
      Valid probs shape: (37, 66231)
    ✓ Random_9 (pose=(1.826530370401156, 1.5946204677552798, 1.2698818268492031)): shape (37, 800, 800)
      Valid pixels: 70419/640000 (11.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=262753, num_faces=262754
      Valid probs shape: (37, 70419)
    ✓ Random_10 (pose=(1.041461083753152, 2.1985630511374685, -2.5574544686502616)): shape (37, 800, 800)
      Valid pixels: 69297/640000 (10.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=257, max=262741, num_faces=262754
      Valid probs shape: (37, 69297)
    ✓ Random_11 (pose=(-1.8019418611069244, 0.5298750341415035, -2.644547510077396)): shape (37, 800, 800)
      Valid pixels: 76074/640000 (11.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=262753, num_faces=262754
      Valid probs shape: (37, 76074)
    ✓ Random_12 (pose=(0.13985766996998583, 3.105865727038039, 1.0604343947432948)): shape (37, 800, 800)
      Valid pixels: 42345/640000 (6.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=16813, max=262751, num_faces=262754
      Valid probs shape: (37, 42345)
    ✓ Random_13 (pose=(0.08337977838608612, -2.102841981964943, -0.3724537316227621)): shape (37, 800, 800)
      Valid pixels: 63966/640000 (10.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=642, max=262751, num_faces=262754
      Valid probs shape: (37, 63966)
    ✓ Random_14 (pose=(-2.590110800813897, -1.7446987561830531, 1.3819495669053667)): shape (37, 800, 800)
      Valid pixels: 76210/640000 (11.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=16, max=262750, num_faces=262754
      Valid probs shape: (37, 76210)
    ✓ Random_15 (pose=(0.38353579123512915, -1.7763049473273063, -1.4710901375567982)): shape (37, 800, 800)
      Valid pixels: 75303/640000 (11.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=20, max=262751, num_faces=262754
      Valid probs shape: (37, 75303)
    ✓ Random_16 (pose=(1.1099604326090322, -0.6687177031437241, 3.028951658877503)): shape (37, 800, 800)
      Valid pixels: 87064/640000 (13.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=260878, num_faces=262754
      Valid probs shape: (37, 87064)
    ✓ Random_17 (pose=(-1.401428675465836, 1.7526331223170146, 2.3657043517603764)): shape (37, 800, 800)
      Valid pixels: 88314/640000 (13.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=262747, num_faces=262754
      Valid probs shape: (37, 88314)
    ✓ Random_18 (pose=(-0.3704280599682499, -0.5773213603030309, 1.575104151809974)): shape (37, 800, 800)
      Valid pixels: 66536/640000 (10.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=262753, num_faces=262754
      Valid probs shape: (37, 66536)
    ✓ Random_19 (pose=(-2.617189419053016, -1.2728744396163811, 2.419814721476877)): shape (37, 800, 800)
      Valid pixels: 66595/640000 (10.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=231, max=262741, num_faces=262754
      Valid probs shape: (37, 66595)
    ✓ Random_20 (pose=(-2.3748283887723387, -2.3011610680378896, 1.4131213386524717)): shape (37, 800, 800)
      Valid pixels: 67132/640000 (10.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=4, max=262640, num_faces=262754
      Valid probs shape: (37, 67132)
    ✓ Random_21 (pose=(1.8838186671265724, 1.7245891139195226, 2.2149324522877336)): shape (37, 800, 800)
      Valid pixels: 76259/640000 (11.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6, max=262751, num_faces=262754
      Valid probs shape: (37, 76259)
    ✓ Random_22 (pose=(-1.9593532676518228, -2.223995930544371, -0.25363668562505826)): shape (37, 800, 800)
      Valid pixels: 89253/640000 (13.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=262751, num_faces=262754
      Valid probs shape: (37, 89253)
    ✓ Random_23 (pose=(0.11778857711991764, -0.49509941393894286, 0.393111819644552)): shape (37, 800, 800)
      Valid pixels: 55532/640000 (8.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=262659, num_faces=262754
      Valid probs shape: (37, 55532)
    ✓ Random_24 (pose=(-1.7724978560495557, -1.1948283717085888, 1.7811654206812113)): shape (37, 800, 800)
      Valid pixels: 66994/640000 (10.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=231, max=262643, num_faces=262754
      Valid probs shape: (37, 66994)
    ✓ Random_25 (pose=(0.0463287747086798, 1.4116380410126972, -2.197613544586454)): shape (37, 800, 800)
      Valid pixels: 91530/640000 (14.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=262753, num_faces=262754
      Valid probs shape: (37, 91530)
    ✓ Random_26 (pose=(2.660190794145196, -0.5779009859419579, -0.6481062213977977)): shape (37, 800, 800)
      Valid pixels: 66761/640000 (10.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=44, max=262753, num_faces=262754
      Valid probs shape: (37, 66761)
    ✓ Random_27 (pose=(2.5214702002139093, 0.21406496828075294, -1.554397471887786)): shape (37, 800, 800)
      Valid pixels: 54096/640000 (8.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1043, max=262748, num_faces=262754
      Valid probs shape: (37, 54096)
    ✓ Random_28 (pose=(-2.506660846768847, -0.58431499058275, -1.4234499311515327)): shape (37, 800, 800)
      Valid pixels: 61035/640000 (9.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=465, max=262753, num_faces=262754
      Valid probs shape: (37, 61035)
    ✓ Random_29 (pose=(0.3664615731663141, 2.655663502899176, 0.40953838088073224)): shape (37, 800, 800)
      Valid pixels: 51964/640000 (8.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1507, max=262752, num_faces=262754
      Valid probs shape: (37, 51964)
    ✓ Random_30 (pose=(-0.41254813276830005, 1.6001586964801717, -1.4766363536654483)): shape (37, 800, 800)
      Valid pixels: 79160/640000 (12.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=262753, num_faces=262754
      Valid probs shape: (37, 79160)
    ✓ Random_31 (pose=(-2.3123927363204233, 0.17690832229700781, 2.1655587426654197)): shape (37, 800, 800)
      Valid pixels: 74186/640000 (11.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=262753, num_faces=262754
      Valid probs shape: (37, 74186)
    ✓ Random_32 (pose=(0.7645068235807448, 1.4563388348111959, -1.8751847285636982)): shape (37, 800, 800)
      Valid pixels: 83194/640000 (13.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=262660, num_faces=262754
      Valid probs shape: (37, 83194)
    ✓ Random_33 (pose=(-1.487120260214718, 1.573552948258822, -0.06710718876194832)): shape (37, 800, 800)
      Valid pixels: 87719/640000 (13.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8, max=262751, num_faces=262754
      Valid probs shape: (37, 87719)
    ✓ Random_34 (pose=(-2.0642904692535713, -1.2644459553546872, -1.4116135562170835)): shape (37, 800, 800)
      Valid pixels: 66546/640000 (10.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7, max=262753, num_faces=262754
      Valid probs shape: (37, 66546)
    ✓ Random_35 (pose=(1.0976919481128, 1.1427998180251464, 0.9681065142727929)): shape (37, 800, 800)
      Valid pixels: 62847/640000 (9.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=262751, num_faces=262754
      Valid probs shape: (37, 62847)
    ✓ Random_36 (pose=(-1.3409880151031732, -2.0555550207975672, 2.571356357091074)): shape (37, 800, 800)
      Valid pixels: 95537/640000 (14.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=30, max=262753, num_faces=262754
      Valid probs shape: (37, 95537)
    ✓ Random_37 (pose=(-2.347647196865958, 1.2527319615461616, 2.079967822014302)): shape (37, 800, 800)
      Valid pixels: 93836/640000 (14.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=262753, num_faces=262754
      Valid probs shape: (37, 93836)
    ✓ Random_38 (pose=(-2.094057454786797, -2.6914330905107913, -1.618635141607687)): shape (37, 800, 800)
      Valid pixels: 61622/640000 (9.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=262708, num_faces=262754
      Valid probs shape: (37, 61622)
    ✓ Random_39 (pose=(-2.3346583098395546, -2.26985303422125, -0.03896871925661216)): shape (37, 800, 800)
      Valid pixels: 83807/640000 (13.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=260878, num_faces=262754
      Valid probs shape: (37, 83807)
    P stats: min=0.0000, max=0.9999, mean=0.0256
    Non-zero vertices: 124310/131379
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 7069  852 1430 2956    0 2024  976 4042 5951]
  Ground Truth Stats:
    Labels shape: (131379,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-18/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7588
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8037
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8036

  RESULTS:
  RAW:         median(top-10)=0.9073, mean(top-10)=0.9114, median(all)=0.7987, mean(all)=0.7588
  + SMOOTHING: median(top-10)=0.9319, mean(top-10)=0.9333, median(all)=0.8455, mean(all)=0.8037 [+0.0246]
  + MRF:       median(top-10)=0.9320, mean(top-10)=0.9334, median(all)=0.8458, mean(all)=0.8036 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0247

================================================================================
Subject: MMRR-21-19
================================================================================
  Step 0: Generating predictions with V2 model (40 random views)...
  Mesh: 145253 vertices, 290502 faces
  Generating 40 random views...
  Generating predictions for 40 views (continuous camera pose)...
    ✓ Random_0 (pose=(-1.0887605619352012, -0.004024778799487372, -0.45514890639471606)): shape (37, 800, 800)
      Valid pixels: 102396/640000 (16.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=288277, num_faces=290502
      Valid probs shape: (37, 102396)
    ✓ Random_1 (pose=(-0.4950023178117462, 1.5813775853193288, -2.221122959384735)): shape (37, 800, 800)
      Valid pixels: 108082/640000 (16.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=290501, num_faces=290502
      Valid probs shape: (37, 108082)
    ✓ Random_2 (pose=(2.260902173915471, 2.286474969201259, 3.1231434252323496)): shape (37, 800, 800)
      Valid pixels: 103280/640000 (16.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=290091, num_faces=290502
      Valid probs shape: (37, 103280)
    ✓ Random_3 (pose=(0.17109966093350248, -0.23269830184130935, 0.38138986524913365)): shape (37, 800, 800)
      Valid pixels: 52009/640000 (8.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=290438, num_faces=290502
      Valid probs shape: (37, 52009)
    ✓ Random_4 (pose=(-0.6263964184043309, -2.6844545104066873, -0.3983406370033218)): shape (37, 800, 800)
      Valid pixels: 77572/640000 (12.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5216, max=290501, num_faces=290502
      Valid probs shape: (37, 77572)
    ✓ Random_5 (pose=(2.388643714090586, -1.5038167632983308, 1.6698459449942389)): shape (37, 800, 800)
      Valid pixels: 103677/640000 (16.2%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=9, max=290136, num_faces=290502
      Valid probs shape: (37, 103677)
    ✓ Random_6 (pose=(-1.6129100528760378, -3.04514084247249, 0.8410552249595593)): shape (37, 800, 800)
      Valid pixels: 74852/640000 (11.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=290500, num_faces=290502
      Valid probs shape: (37, 74852)
    ✓ Random_7 (pose=(0.16371029536998982, -1.7093583552496612, 0.30101525969271714)): shape (37, 800, 800)
      Valid pixels: 94827/640000 (14.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=34, max=290501, num_faces=290502
      Valid probs shape: (37, 94827)
    ✓ Random_8 (pose=(0.4784087149332792, -1.5444914617139267, -1.2891051208138624)): shape (37, 800, 800)
      Valid pixels: 76254/640000 (11.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=2, max=290499, num_faces=290502
      Valid probs shape: (37, 76254)
    ✓ Random_9 (pose=(0.5785185454195112, -0.9462208160788381, 3.1334411327456717)): shape (37, 800, 800)
      Valid pixels: 96707/640000 (15.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=290124, num_faces=290502
      Valid probs shape: (37, 96707)
    ✓ Random_10 (pose=(1.2148983663886677, -2.571820052480483, 0.9063710836010852)): shape (37, 800, 800)
      Valid pixels: 78682/640000 (12.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=12, max=290498, num_faces=290502
      Valid probs shape: (37, 78682)
    ✓ Random_11 (pose=(0.6813430782932968, 0.9583196599534922, -0.20954391632945457)): shape (37, 800, 800)
      Valid pixels: 79719/640000 (12.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=290438, num_faces=290502
      Valid probs shape: (37, 79719)
    ✓ Random_12 (pose=(-0.5795202666233417, 0.4831348131435478, 1.4496683967332018)): shape (37, 800, 800)
      Valid pixels: 61242/640000 (9.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=0, max=290062, num_faces=290502
      Valid probs shape: (37, 61242)
    ✓ Random_13 (pose=(-2.6205803078706738, -0.793988095780267, 1.047890883120722)): shape (37, 800, 800)
      Valid pixels: 82367/640000 (12.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1243, max=290500, num_faces=290502
      Valid probs shape: (37, 82367)
    ✓ Random_14 (pose=(-1.8464924674763337, 0.15107585392790845, 1.6885787904861047)): shape (37, 800, 800)
      Valid pixels: 80584/640000 (12.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=41, max=290501, num_faces=290502
      Valid probs shape: (37, 80584)
    ✓ Random_15 (pose=(-0.5010427731575566, 2.539019544995724, -0.6905598280956697)): shape (37, 800, 800)
      Valid pixels: 55718/640000 (8.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=36406, max=290500, num_faces=290502
      Valid probs shape: (37, 55718)
    ✓ Random_16 (pose=(3.0777689886492263, -0.5752705798398532, -0.9850591658048975)): shape (37, 800, 800)
      Valid pixels: 64183/640000 (10.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=390, max=290501, num_faces=290502
      Valid probs shape: (37, 64183)
    ✓ Random_17 (pose=(3.0070464774090926, -1.0817461565982498, -1.2918847911850477)): shape (37, 800, 800)
      Valid pixels: 95065/640000 (14.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=41, max=290501, num_faces=290502
      Valid probs shape: (37, 95065)
    ✓ Random_18 (pose=(-0.3729983955228544, 0.3401446146016789, 2.1721118569665947)): shape (37, 800, 800)
      Valid pixels: 46984/640000 (7.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=290501, num_faces=290502
      Valid probs shape: (37, 46984)
    ✓ Random_19 (pose=(-0.026687319640944285, -2.8413198592169384, -1.1120694697859559)): shape (37, 800, 800)
      Valid pixels: 60223/640000 (9.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5394, max=290501, num_faces=290502
      Valid probs shape: (37, 60223)
    ✓ Random_20 (pose=(-2.4063402416652404, 0.8191675420282598, 1.9638558558322288)): shape (37, 800, 800)
      Valid pixels: 104400/640000 (16.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=53, max=290501, num_faces=290502
      Valid probs shape: (37, 104400)
    ✓ Random_21 (pose=(1.9253029659980792, 0.01790366447988534, -2.4273484720677336)): shape (37, 800, 800)
      Valid pixels: 78059/640000 (12.2%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=127, max=290501, num_faces=290502
      Valid probs shape: (37, 78059)
    ✓ Random_22 (pose=(-0.14296485296505734, -2.563873002230459, -0.3838131635930617)): shape (37, 800, 800)
      Valid pixels: 68676/640000 (10.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4471, max=290501, num_faces=290502
      Valid probs shape: (37, 68676)
    ✓ Random_23 (pose=(-2.928781347822781, 1.8969367087232278, 2.644207806852818)): shape (37, 800, 800)
      Valid pixels: 76832/640000 (12.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=290437, num_faces=290502
      Valid probs shape: (37, 76832)
    ✓ Random_24 (pose=(1.6301763452926297, 0.5882524949817669, -1.2206243521503768)): shape (37, 800, 800)
      Valid pixels: 86535/640000 (13.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=31, max=290501, num_faces=290502
      Valid probs shape: (37, 86535)
    ✓ Random_25 (pose=(-1.9437451030671657, 2.567738067031738, -1.4462361231664813)): shape (37, 800, 800)
      Valid pixels: 87563/640000 (13.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=0, max=290077, num_faces=290502
      Valid probs shape: (37, 87563)
    ✓ Random_26 (pose=(2.0950506489089937, 0.2448878717951315, 2.671707721536884)): shape (37, 800, 800)
      Valid pixels: 91977/640000 (14.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=921, max=290501, num_faces=290502
      Valid probs shape: (37, 91977)
    ✓ Random_27 (pose=(-2.687697815064192, -0.09908027637159966, 0.3392095883558617)): shape (37, 800, 800)
      Valid pixels: 66414/640000 (10.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7752, max=290501, num_faces=290502
      Valid probs shape: (37, 66414)
    ✓ Random_28 (pose=(2.0398656409757585, -2.2225729468678352, -0.08865012851602616)): shape (37, 800, 800)
      Valid pixels: 92066/640000 (14.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=290498, num_faces=290502
      Valid probs shape: (37, 92066)
    ✓ Random_29 (pose=(-1.0601548114861736, 0.1417249858441103, -0.38585704511925556)): shape (37, 800, 800)
      Valid pixels: 101890/640000 (15.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=289592, num_faces=290502
      Valid probs shape: (37, 101890)
    ✓ Random_30 (pose=(-0.22943426358663999, -3.132375737542151, -2.4608815222001383)): shape (37, 800, 800)
      Valid pixels: 46678/640000 (7.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2998, max=290501, num_faces=290502
      Valid probs shape: (37, 46678)
    ✓ Random_31 (pose=(-0.11515346029671925, -2.890375409676452, 0.4489079168559207)): shape (37, 800, 800)
      Valid pixels: 56870/640000 (8.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3591, max=290501, num_faces=290502
      Valid probs shape: (37, 56870)
    ✓ Random_32 (pose=(-2.079328790969796, -2.3969986889611175, 1.9983889266638393)): shape (37, 800, 800)
      Valid pixels: 61826/640000 (9.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=290501, num_faces=290502
      Valid probs shape: (37, 61826)
    ✓ Random_33 (pose=(-2.7415363688157104, 1.6278090214872902, 2.573653205213815)): shape (37, 800, 800)
      Valid pixels: 83901/640000 (13.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=290438, num_faces=290502
      Valid probs shape: (37, 83901)
    ✓ Random_34 (pose=(-2.303504959467902, -2.3584004919802672, 0.1417672409027042)): shape (37, 800, 800)
      Valid pixels: 101742/640000 (15.9%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=1, max=288277, num_faces=290502
      Valid probs shape: (37, 101742)
    ✓ Random_35 (pose=(-3.0516225622234696, 1.3272082492572874, 2.052595367318662)): shape (37, 800, 800)
      Valid pixels: 90406/640000 (14.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=290500, num_faces=290502
      Valid probs shape: (37, 90406)
    ✓ Random_36 (pose=(-0.9674307577615764, -2.7238126137021337, -1.283221610643078)): shape (37, 800, 800)
      Valid pixels: 83168/640000 (13.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=10349, max=290501, num_faces=290502
      Valid probs shape: (37, 83168)
    ✓ Random_37 (pose=(2.682630075763724, 2.505941521854079, 1.9903834959795006)): shape (37, 800, 800)
      Valid pixels: 68004/640000 (10.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=290438, num_faces=290502
      Valid probs shape: (37, 68004)
    ✓ Random_38 (pose=(-0.21259585654575774, -2.8170067497668816, 0.6916048898388136)): shape (37, 800, 800)
      Valid pixels: 60670/640000 (9.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4472, max=290501, num_faces=290502
      Valid probs shape: (37, 60670)
    ✓ Random_39 (pose=(1.2457833031043437, 0.06792328161831662, 2.9464514832127326)): shape (37, 800, 800)
      Valid pixels: 101160/640000 (15.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=3, max=290139, num_faces=290502
      Valid probs shape: (37, 101160)
    P stats: min=0.0000, max=1.0000, mean=0.0258
    Non-zero vertices: 138832/145253
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 6421 1135 1020 3510    0 1988 1259 5338 7691]
  Ground Truth Stats:
    Labels shape: (145253,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-19/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7646
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8103
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8104

  RESULTS:
  RAW:         median(top-10)=0.9055, mean(top-10)=0.9097, median(all)=0.8307, mean(all)=0.7646
  + SMOOTHING: median(top-10)=0.9312, mean(top-10)=0.9309, median(all)=0.8687, mean(all)=0.8103 [+0.0256]
  + MRF:       median(top-10)=0.9313, mean(top-10)=0.9311, median(all)=0.8687, mean(all)=0.8104 [+0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0257

================================================================================
Subject: MMRR-21-2
================================================================================
  Step 0: Generating predictions with V2 model (40 random views)...
  Mesh: 148593 vertices, 297182 faces
  Generating 40 random views...
  Generating predictions for 40 views (continuous camera pose)...
    ✓ Random_0 (pose=(0.8410475300612257, -0.47472290690937946, -2.580586157054439)): shape (37, 800, 800)
      Valid pixels: 78759/640000 (12.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=6, max=297129, num_faces=297182
      Valid probs shape: (37, 78759)
    ✓ Random_1 (pose=(-0.025514574605149054, 0.870662735196098, -1.292206395121702)): shape (37, 800, 800)
      Valid pixels: 76215/640000 (11.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=297140, num_faces=297182
      Valid probs shape: (37, 76215)
    ✓ Random_2 (pose=(-1.4706121072338045, 2.3044295069893117, -2.8708098868289693)): shape (37, 800, 800)
      Valid pixels: 97407/640000 (15.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=297147, num_faces=297182
      Valid probs shape: (37, 97407)
    ✓ Random_3 (pose=(-0.5670491442406549, -0.018636351615377578, -3.0193332917782634)): shape (37, 800, 800)
      Valid pixels: 64819/640000 (10.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=296921, num_faces=297182
      Valid probs shape: (37, 64819)
    ✓ Random_4 (pose=(1.8628094303762381, 1.9851128355730765, 0.8840784684958471)): shape (37, 800, 800)
      Valid pixels: 82390/640000 (12.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=297145, num_faces=297182
      Valid probs shape: (37, 82390)
    ✓ Random_5 (pose=(-2.2070898498067577, 0.7665717614822483, 2.4729602608654186)): shape (37, 800, 800)
      Valid pixels: 96067/640000 (15.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=10, max=297181, num_faces=297182
      Valid probs shape: (37, 96067)
    ✓ Random_6 (pose=(-0.969413124829773, -0.4291993834323242, 2.2520271954331736)): shape (37, 800, 800)
      Valid pixels: 88714/640000 (13.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=297181, num_faces=297182
      Valid probs shape: (37, 88714)
    ✓ Random_7 (pose=(3.0666475109133016, 2.1875844862551883, 2.421350109660617)): shape (37, 800, 800)
      Valid pixels: 65922/640000 (10.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=296937, num_faces=297182
      Valid probs shape: (37, 65922)
    ✓ Random_8 (pose=(2.9328810067547053, -1.0900405137026397, -2.6649077481899393)): shape (37, 800, 800)
      Valid pixels: 69024/640000 (10.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=561, max=297181, num_faces=297182
      Valid probs shape: (37, 69024)
    ✓ Random_9 (pose=(1.6154716033879444, -0.8610157334939714, -1.3508267764181705)): shape (37, 800, 800)
      Valid pixels: 73982/640000 (11.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=297181, num_faces=297182
      Valid probs shape: (37, 73982)
    ✓ Random_10 (pose=(-2.987297069610108, -0.7413618508692066, -1.4787794422798959)): shape (37, 800, 800)
      Valid pixels: 71450/640000 (11.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=591, max=297178, num_faces=297182
      Valid probs shape: (37, 71450)
    ✓ Random_11 (pose=(0.9560997659502783, -1.4875309582196197, -2.954743924517243)): shape (37, 800, 800)
      Valid pixels: 98899/640000 (15.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=17, max=297178, num_faces=297182
      Valid probs shape: (37, 98899)
    ✓ Random_12 (pose=(-1.042608907018988, 2.931217648304405, -0.17633172178971712)): shape (37, 800, 800)
      Valid pixels: 92115/640000 (14.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=324, max=297178, num_faces=297182
      Valid probs shape: (37, 92115)
    ✓ Random_13 (pose=(2.1734580471941154, -2.6996347000348924, 2.701235395612551)): shape (37, 800, 800)
      Valid pixels: 87522/640000 (13.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=297132, num_faces=297182
      Valid probs shape: (37, 87522)
    ✓ Random_14 (pose=(0.660796886494786, 2.6258659303343572, -2.9972632411412805)): shape (37, 800, 800)
      Valid pixels: 69462/640000 (10.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1043, max=297181, num_faces=297182
      Valid probs shape: (37, 69462)
    ✓ Random_15 (pose=(-0.2653443066827048, -0.19477114136989382, -0.31321207154462005)): shape (37, 800, 800)
      Valid pixels: 53597/640000 (8.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=295796, num_faces=297182
      Valid probs shape: (37, 53597)
    ✓ Random_16 (pose=(2.689292975005219, -0.9106874936619622, 1.4319641988732794)): shape (37, 800, 800)
      Valid pixels: 88207/640000 (13.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7397, max=297178, num_faces=297182
      Valid probs shape: (37, 88207)
    ✓ Random_17 (pose=(0.35474212838146935, 2.695571304184048, -0.6850886447904219)): shape (37, 800, 800)
      Valid pixels: 63077/640000 (9.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=737, max=297178, num_faces=297182
      Valid probs shape: (37, 63077)
    ✓ Random_18 (pose=(2.180053838488135, 0.07351888427767417, 1.4278793122015783)): shape (37, 800, 800)
      Valid pixels: 60794/640000 (9.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4342, max=297178, num_faces=297182
      Valid probs shape: (37, 60794)
    ✓ Random_19 (pose=(0.8492017560701464, -2.6503287280023606, 0.21252643330333276)): shape (37, 800, 800)
      Valid pixels: 87660/640000 (13.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=553, max=297164, num_faces=297182
      Valid probs shape: (37, 87660)
    ✓ Random_20 (pose=(1.3071956872058204, 1.8640375169660466, -0.540634628881139)): shape (37, 800, 800)
      Valid pixels: 104132/640000 (16.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=297181, num_faces=297182
      Valid probs shape: (37, 104132)
    ✓ Random_21 (pose=(-2.9559788351575134, 0.43940496365687265, 1.095261624055282)): shape (37, 800, 800)
      Valid pixels: 55540/640000 (8.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1369, max=297181, num_faces=297182
      Valid probs shape: (37, 55540)
    ✓ Random_22 (pose=(-2.8118444723694367, 2.9727947072714134, 2.971866558355466)): shape (37, 800, 800)
      Valid pixels: 53371/640000 (8.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=296937, num_faces=297182
      Valid probs shape: (37, 53371)
    ✓ Random_23 (pose=(-2.9207963389644704, 0.5739869109544276, -1.2663739981493372)): shape (37, 800, 800)
      Valid pixels: 74078/640000 (11.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=14161, max=297178, num_faces=297182
      Valid probs shape: (37, 74078)
    ✓ Random_24 (pose=(-0.4976146210380006, 1.4900140417406647, -0.41966446107030286)): shape (37, 800, 800)
      Valid pixels: 64311/640000 (10.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=16, max=297130, num_faces=297182
      Valid probs shape: (37, 64311)
    ✓ Random_25 (pose=(-0.7357091079827063, -0.8588863999285454, 0.7984288490750915)): shape (37, 800, 800)
      Valid pixels: 60105/640000 (9.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=297180, num_faces=297182
      Valid probs shape: (37, 60105)
    ✓ Random_26 (pose=(-1.9972746375883534, 3.0771800654148134, -0.86265740528223)): shape (37, 800, 800)
      Valid pixels: 87617/640000 (13.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=297132, num_faces=297182
      Valid probs shape: (37, 87617)
    ✓ Random_27 (pose=(2.08431474622188, 2.891023463962969, 0.34209464283016455)): shape (37, 800, 800)
      Valid pixels: 86321/640000 (13.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=297142, num_faces=297182
      Valid probs shape: (37, 86321)
    ✓ Random_28 (pose=(-1.40591994933764, -0.5725321862270589, -3.0854140146609557)): shape (37, 800, 800)
      Valid pixels: 97643/640000 (15.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=297146, num_faces=297182
      Valid probs shape: (37, 97643)
    ✓ Random_29 (pose=(-2.771827290162286, -2.2020690547488, -2.512577559739936)): shape (37, 800, 800)
      Valid pixels: 88136/640000 (13.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=297181, num_faces=297182
      Valid probs shape: (37, 88136)
    ✓ Random_30 (pose=(-0.5172888915520102, 2.127795709088889, -1.4349721210615234)): shape (37, 800, 800)
      Valid pixels: 75626/640000 (11.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=57, max=297178, num_faces=297182
      Valid probs shape: (37, 75626)
    ✓ Random_31 (pose=(-0.5482266032294425, -0.6219997561532917, 0.570993043115195)): shape (37, 800, 800)
      Valid pixels: 56499/640000 (8.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=297058, num_faces=297182
      Valid probs shape: (37, 56499)
    ✓ Random_32 (pose=(-0.5969566326240616, 1.0733016100584711, 2.972695726098734)): shape (37, 800, 800)
      Valid pixels: 79355/640000 (12.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=297181, num_faces=297182
      Valid probs shape: (37, 79355)
    ✓ Random_33 (pose=(-0.18215297463210156, 0.21887531503440538, 1.926232744575998)): shape (37, 800, 800)
      Valid pixels: 48545/640000 (7.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=296844, num_faces=297182
      Valid probs shape: (37, 48545)
    ✓ Random_34 (pose=(0.2915272991547093, 2.9749004161136776, -2.5684134355510913)): shape (37, 800, 800)
      Valid pixels: 48067/640000 (7.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4857, max=297181, num_faces=297182
      Valid probs shape: (37, 48067)
    ✓ Random_35 (pose=(-1.4626950671935879, 0.14429778976075225, -0.7068834594668019)): shape (37, 800, 800)
      Valid pixels: 95544/640000 (14.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=4, max=297178, num_faces=297182
      Valid probs shape: (37, 95544)
    ✓ Random_36 (pose=(-2.6651654684792607, -2.5930474814710913, -0.13555091611600822)): shape (37, 800, 800)
      Valid pixels: 69571/640000 (10.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=297129, num_faces=297182
      Valid probs shape: (37, 69571)
    ✓ Random_37 (pose=(2.9770964140377494, -1.8259413385964671, 1.9210397689814611)): shape (37, 800, 800)
      Valid pixels: 88767/640000 (13.9%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=2, max=297168, num_faces=297182
      Valid probs shape: (37, 88767)
    ✓ Random_38 (pose=(2.173908773507616, -0.31157721952960005, 2.4009154932989833)): shape (37, 800, 800)
      Valid pixels: 90119/640000 (14.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=4556, max=297178, num_faces=297182
      Valid probs shape: (37, 90119)
    ✓ Random_39 (pose=(-0.02606460836875213, -1.3590063851717442, 1.2458437732939638)): shape (37, 800, 800)
      Valid pixels: 101761/640000 (15.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=297181, num_faces=297182
      Valid probs shape: (37, 101761)
    P stats: min=0.0000, max=1.0000, mean=0.0257
    Non-zero vertices: 141439/148593
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 7154 1470 1056 3901    0 2259 1087 4983 6508]
  Ground Truth Stats:
    Labels shape: (148593,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-2/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7827
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8308
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8311

  RESULTS:
  RAW:         median(top-10)=0.9079, mean(top-10)=0.9128, median(all)=0.8439, mean(all)=0.7827
  + SMOOTHING: median(top-10)=0.9282, mean(top-10)=0.9329, median(all)=0.8746, mean(all)=0.8308 [+0.0202]
  + MRF:       median(top-10)=0.9287, mean(top-10)=0.9334, median(all)=0.8751, mean(all)=0.8311 [+0.0005]
  TOTAL IMPROVEMENT (median top-10): +0.0208

================================================================================
Subject: MMRR-21-20
================================================================================
  Step 0: Generating predictions with V2 model (40 random views)...
  Mesh: 149927 vertices, 299850 faces
  Generating 40 random views...
  Generating predictions for 40 views (continuous camera pose)...
    ✓ Random_0 (pose=(-0.7092800059810722, -0.8593367630734936, -3.0101322668061603)): shape (37, 800, 800)
      Valid pixels: 63947/640000 (10.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=299607, num_faces=299850
      Valid probs shape: (37, 63947)
    ✓ Random_1 (pose=(-1.4359607366187688, -2.0100282103081515, 2.8719242209502793)): shape (37, 800, 800)
      Valid pixels: 96136/640000 (15.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=299849, num_faces=299850
      Valid probs shape: (37, 96136)
    ✓ Random_2 (pose=(1.100259512446426, 1.8236635413977664, -0.43513550578911353)): shape (37, 800, 800)
      Valid pixels: 93465/640000 (14.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6, max=299849, num_faces=299850
      Valid probs shape: (37, 93465)
    ✓ Random_3 (pose=(-0.3874605480666342, 1.964561472068965, -2.1454213544201153)): shape (37, 800, 800)
      Valid pixels: 88520/640000 (13.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=22, max=299849, num_faces=299850
      Valid probs shape: (37, 88520)
    ✓ Random_4 (pose=(-1.41830812685626, 0.45574995508661154, -1.1641819987309039)): shape (37, 800, 800)
      Valid pixels: 68062/640000 (10.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=299799, num_faces=299850
      Valid probs shape: (37, 68062)
    ✓ Random_5 (pose=(1.118235144702033, -1.4712182189732244, 0.3891380411531946)): shape (37, 800, 800)
      Valid pixels: 96055/640000 (15.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=10, max=299849, num_faces=299850
      Valid probs shape: (37, 96055)
    ✓ Random_6 (pose=(1.199587784826325, 1.2770606098184247, 1.7666305825549724)): shape (37, 800, 800)
      Valid pixels: 77775/640000 (12.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=13, max=299582, num_faces=299850
      Valid probs shape: (37, 77775)
    ✓ Random_7 (pose=(-0.2901391324887883, 0.7783501808052193, -1.450575900595462)): shape (37, 800, 800)
      Valid pixels: 66520/640000 (10.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=299608, num_faces=299850
      Valid probs shape: (37, 66520)
    ✓ Random_8 (pose=(-0.038347509975902305, 2.198081365769479, 1.0861071780957836)): shape (37, 800, 800)
      Valid pixels: 82943/640000 (13.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=423, max=299845, num_faces=299850
      Valid probs shape: (37, 82943)
    ✓ Random_9 (pose=(-0.37558130676548274, 0.4058702746423939, -1.0225691784402788)): shape (37, 800, 800)
      Valid pixels: 43116/640000 (6.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=299590, num_faces=299850
      Valid probs shape: (37, 43116)
    ✓ Random_10 (pose=(-3.0558768766909656, -1.3025771831680208, -2.2412272061000453)): shape (37, 800, 800)
      Valid pixels: 88681/640000 (13.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=299849, num_faces=299850
      Valid probs shape: (37, 88681)
    ✓ Random_11 (pose=(0.6777012524168153, 0.6167598040127475, 0.893828876307527)): shape (37, 800, 800)
      Valid pixels: 46671/640000 (7.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=299604, num_faces=299850
      Valid probs shape: (37, 46671)
    ✓ Random_12 (pose=(-0.07806533463817633, -0.2059183623130183, -1.880447998122533)): shape (37, 800, 800)
      Valid pixels: 41460/640000 (6.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=298455, num_faces=299850
      Valid probs shape: (37, 41460)
    ✓ Random_13 (pose=(0.014149202526335003, -1.4212537864475723, -2.8708334682020356)): shape (37, 800, 800)
      Valid pixels: 64972/640000 (10.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6, max=299434, num_faces=299850
      Valid probs shape: (37, 64972)
    ✓ Random_14 (pose=(2.932547629736036, -0.40414798081103687, 2.9540784416748798)): shape (37, 800, 800)
      Valid pixels: 49920/640000 (7.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7011, max=299846, num_faces=299850
      Valid probs shape: (37, 49920)
    ✓ Random_15 (pose=(2.0227427701168947, -1.2310788657814726, 3.048795882170812)): shape (37, 800, 800)
      Valid pixels: 81559/640000 (12.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=17, max=299847, num_faces=299850
      Valid probs shape: (37, 81559)
    ✓ Random_16 (pose=(-0.30472457667166886, -0.2076774705264688, 1.4907152948324676)): shape (37, 800, 800)
      Valid pixels: 46104/640000 (7.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=299847, num_faces=299850
      Valid probs shape: (37, 46104)
    ✓ Random_17 (pose=(-0.2676659905376808, 1.103836751838175, -0.22783690071109897)): shape (37, 800, 800)
      Valid pixels: 52053/640000 (8.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=299434, num_faces=299850
      Valid probs shape: (37, 52053)
    ✓ Random_18 (pose=(2.4994908510066383, 1.4668593781891612, 1.5082871538331677)): shape (37, 800, 800)
      Valid pixels: 77756/640000 (12.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7, max=299608, num_faces=299850
      Valid probs shape: (37, 77756)
    ✓ Random_19 (pose=(-1.2774078187565872, 0.6796331255848234, 1.8547413746024182)): shape (37, 800, 800)
      Valid pixels: 58488/640000 (9.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=299849, num_faces=299850
      Valid probs shape: (37, 58488)
    ✓ Random_20 (pose=(2.2646248986477566, -1.4742299046613363, -2.663599298001177)): shape (37, 800, 800)
      Valid pixels: 63341/640000 (9.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=345, max=299848, num_faces=299850
      Valid probs shape: (37, 63341)
    ✓ Random_21 (pose=(-3.108224614688936, -0.07894719974159736, 3.120315030488052)): shape (37, 800, 800)
      Valid pixels: 36404/640000 (5.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=46371, max=299842, num_faces=299850
      Valid probs shape: (37, 36404)
    ✓ Random_22 (pose=(2.9010816963404347, -2.653712856656384, 2.1190717016903458)): shape (37, 800, 800)
      Valid pixels: 55118/640000 (8.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=299664, num_faces=299850
      Valid probs shape: (37, 55118)
    ✓ Random_23 (pose=(0.5276865910924555, 1.7477533473197466, -0.3086304042318475)): shape (37, 800, 800)
      Valid pixels: 73079/640000 (11.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7, max=299608, num_faces=299850
      Valid probs shape: (37, 73079)
    ✓ Random_24 (pose=(-0.055023253094405256, -2.236334577186074, -1.9178033275233273)): shape (37, 800, 800)
      Valid pixels: 81816/640000 (12.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4453, max=299845, num_faces=299850
      Valid probs shape: (37, 81816)
    ✓ Random_25 (pose=(0.8307978318974025, -0.6902065623653466, 2.75168856850887)): shape (37, 800, 800)
      Valid pixels: 70292/640000 (11.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=299582, num_faces=299850
      Valid probs shape: (37, 70292)
    ✓ Random_26 (pose=(0.08473790905653988, 2.134086699822703, -0.38233915755425585)): shape (37, 800, 800)
      Valid pixels: 59546/640000 (9.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=11, max=299608, num_faces=299850
      Valid probs shape: (37, 59546)
    ✓ Random_27 (pose=(0.3298777423051247, 2.6546695633946307, -1.255650791117779)): shape (37, 800, 800)
      Valid pixels: 56540/640000 (8.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=13, max=299849, num_faces=299850
      Valid probs shape: (37, 56540)
    ✓ Random_28 (pose=(-1.14222677459201, -2.2761395196774474, 2.3417207442800887)): shape (37, 800, 800)
      Valid pixels: 90230/640000 (14.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=299849, num_faces=299850
      Valid probs shape: (37, 90230)
    ✓ Random_29 (pose=(-0.8552466840903605, -1.2410674000864226, 0.8033626121179509)): shape (37, 800, 800)
      Valid pixels: 57573/640000 (9.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=299846, num_faces=299850
      Valid probs shape: (37, 57573)
    ✓ Random_30 (pose=(-3.039453688474381, -0.22082272584201545, 0.8490309057243972)): shape (37, 800, 800)
      Valid pixels: 50910/640000 (8.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=67521, max=299843, num_faces=299850
      Valid probs shape: (37, 50910)
    ✓ Random_31 (pose=(-2.991153904935221, -2.185351078746112, 2.019053087654017)): shape (37, 800, 800)
      Valid pixels: 64065/640000 (10.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6, max=299848, num_faces=299850
      Valid probs shape: (37, 64065)
    ✓ Random_32 (pose=(-1.9869062142166036, 1.127229118482525, -1.1932247967772573)): shape (37, 800, 800)
      Valid pixels: 85486/640000 (13.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=10, max=299824, num_faces=299850
      Valid probs shape: (37, 85486)
    ✓ Random_33 (pose=(2.468552902432614, 0.8849080766359458, -2.5409934738754827)): shape (37, 800, 800)
      Valid pixels: 85283/640000 (13.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=412, max=299847, num_faces=299850
      Valid probs shape: (37, 85283)
    ✓ Random_34 (pose=(-1.6533853769318565, 0.6961242709572231, 2.069708016175438)): shape (37, 800, 800)
      Valid pixels: 79525/640000 (12.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=299849, num_faces=299850
      Valid probs shape: (37, 79525)
    ✓ Random_35 (pose=(0.25319452456042546, -1.2044155541339345, 2.341510007519008)): shape (37, 800, 800)
      Valid pixels: 61503/640000 (9.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=299608, num_faces=299850
      Valid probs shape: (37, 61503)
    ✓ Random_36 (pose=(0.45390742572405873, -3.044979130364985, -1.44185342466768)): shape (37, 800, 800)
      Valid pixels: 39469/640000 (6.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5731, max=299846, num_faces=299850
      Valid probs shape: (37, 39469)
    ✓ Random_37 (pose=(-1.6467111289895477, -2.928647600719293, -0.5252536909850165)): shape (37, 800, 800)
      Valid pixels: 89711/640000 (14.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=299824, num_faces=299850
      Valid probs shape: (37, 89711)
    ✓ Random_38 (pose=(-2.563660086991342, 2.357255194585581, 2.578505984856185)): shape (37, 800, 800)
      Valid pixels: 76033/640000 (11.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=299849, num_faces=299850
      Valid probs shape: (37, 76033)
    ✓ Random_39 (pose=(2.1197410755012713, -1.050961196811952, -0.4031051114481783)): shape (37, 800, 800)
      Valid pixels: 89173/640000 (13.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=299849, num_faces=299850
      Valid probs shape: (37, 89173)
    P stats: min=0.0000, max=1.0000, mean=0.0255
    Non-zero vertices: 141608/149927
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 8319 1182 1333 3289    0 2551 1079 5433 6722]
  Ground Truth Stats:
    Labels shape: (149927,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-20/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7781
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8304
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8309

  RESULTS:
  RAW:         median(top-10)=0.9055, mean(top-10)=0.9068, median(all)=0.8486, mean(all)=0.7781
  + SMOOTHING: median(top-10)=0.9298, mean(top-10)=0.9325, median(all)=0.8771, mean(all)=0.8304 [+0.0244]
  + MRF:       median(top-10)=0.9302, mean(top-10)=0.9327, median(all)=0.8772, mean(all)=0.8309 [+0.0004]
  TOTAL IMPROVEMENT (median top-10): +0.0247

================================================================================
Subject: MMRR-21-21
================================================================================
  Step 0: Generating predictions with V2 model (40 random views)...
  Mesh: 137496 vertices, 274988 faces
  Generating 40 random views...
  Generating predictions for 40 views (continuous camera pose)...
    ✓ Random_0 (pose=(-0.6442686524060472, 2.500451447671529, -0.8236300129579237)): shape (37, 800, 800)
      Valid pixels: 58550/640000 (9.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=12584, max=274985, num_faces=274988
      Valid probs shape: (37, 58550)
    ✓ Random_1 (pose=(2.7232626198087218, 2.0406209334516463, 2.5250043066900822)): shape (37, 800, 800)
      Valid pixels: 61726/640000 (9.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=274713, num_faces=274988
      Valid probs shape: (37, 61726)
    ✓ Random_2 (pose=(2.7913175529401295, 0.3917294199939856, 2.7697171119978057)): shape (37, 800, 800)
      Valid pixels: 59370/640000 (9.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=35266, max=274985, num_faces=274988
      Valid probs shape: (37, 59370)
    ✓ Random_3 (pose=(0.3096461173648688, 1.7033051649369586, -0.4880152338766557)): shape (37, 800, 800)
      Valid pixels: 76298/640000 (11.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=274985, num_faces=274988
      Valid probs shape: (37, 76298)
    ✓ Random_4 (pose=(0.8883121090343931, 2.488736506925444, 0.2506816916368475)): shape (37, 800, 800)
      Valid pixels: 72827/640000 (11.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=10, max=274985, num_faces=274988
      Valid probs shape: (37, 72827)
    ✓ Random_5 (pose=(-2.151135466474241, 2.4879996747339606, 0.08315033683201722)): shape (37, 800, 800)
      Valid pixels: 75855/640000 (11.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=7, max=274986, num_faces=274988
      Valid probs shape: (37, 75855)
    ✓ Random_6 (pose=(1.2452634211621643, -0.8587060796941288, 1.5420976297339157)): shape (37, 800, 800)
      Valid pixels: 65229/640000 (10.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=274985, num_faces=274988
      Valid probs shape: (37, 65229)
    ✓ Random_7 (pose=(-0.5221623098547794, 2.6970749758057195, -1.0527762210959963)): shape (37, 800, 800)
      Valid pixels: 52257/640000 (8.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5141, max=274985, num_faces=274988
      Valid probs shape: (37, 52257)
    ✓ Random_8 (pose=(0.5767353541817548, -1.9898674506306389, -0.41699837055189404)): shape (37, 800, 800)
      Valid pixels: 70775/640000 (11.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=32, max=274985, num_faces=274988
      Valid probs shape: (37, 70775)
    ✓ Random_9 (pose=(1.4772974693756842, 1.8125846111870665, -0.28011645598452617)): shape (37, 800, 800)
      Valid pixels: 101080/640000 (15.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=274987, num_faces=274988
      Valid probs shape: (37, 101080)
    ✓ Random_10 (pose=(2.987963922406986, -0.12388918833760787, 0.820695074544012)): shape (37, 800, 800)
      Valid pixels: 47512/640000 (7.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=67694, max=274983, num_faces=274988
      Valid probs shape: (37, 47512)
    ✓ Random_11 (pose=(-1.4303462179795832, 3.0730690578878592, -2.746615190500187)): shape (37, 800, 800)
      Valid pixels: 86349/640000 (13.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=274983, num_faces=274988
      Valid probs shape: (37, 86349)
    ✓ Random_12 (pose=(-2.182439914645591, 1.9513607330562426, 1.1439348476573885)): shape (37, 800, 800)
      Valid pixels: 66023/640000 (10.3%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=2, max=274985, num_faces=274988
      Valid probs shape: (37, 66023)
    ✓ Random_13 (pose=(1.8007721129025098, 0.3439526774726329, -0.6728914711099345)): shape (37, 800, 800)
      Valid pixels: 95883/640000 (15.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=28, max=274985, num_faces=274988
      Valid probs shape: (37, 95883)
    ✓ Random_14 (pose=(-2.342555386561649, 3.0600789144905303, -1.5284880967814756)): shape (37, 800, 800)
      Valid pixels: 61485/640000 (9.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=273294, num_faces=274988
      Valid probs shape: (37, 61485)
    ✓ Random_15 (pose=(-1.2703815528261964, 0.49026990844749774, -1.6948290694061479)): shape (37, 800, 800)
      Valid pixels: 64663/640000 (10.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=274985, num_faces=274988
      Valid probs shape: (37, 64663)
    ✓ Random_16 (pose=(2.2916455236894704, 1.583665458876915, -2.0304545853262823)): shape (37, 800, 800)
      Valid pixels: 80878/640000 (12.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=18, max=274979, num_faces=274988
      Valid probs shape: (37, 80878)
    ✓ Random_17 (pose=(-1.6652126630456698, 0.16955233145528092, -1.1059811617568012)): shape (37, 800, 800)
      Valid pixels: 82703/640000 (12.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=12, max=274959, num_faces=274988
      Valid probs shape: (37, 82703)
    ✓ Random_18 (pose=(0.29485173797293207, -2.986450279914451, -3.0712129391535727)): shape (37, 800, 800)
      Valid pixels: 60453/640000 (9.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=24440, max=274981, num_faces=274988
      Valid probs shape: (37, 60453)
    ✓ Random_19 (pose=(-0.30627370005281573, 0.49109104250974234, -1.6920387794416811)): shape (37, 800, 800)
      Valid pixels: 61917/640000 (9.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=274985, num_faces=274988
      Valid probs shape: (37, 61917)
    ✓ Random_20 (pose=(3.0129418952236326, 2.7915787354558255, 1.8457399673369705)): shape (37, 800, 800)
      Valid pixels: 53739/640000 (8.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=274987, num_faces=274988
      Valid probs shape: (37, 53739)
    ✓ Random_21 (pose=(1.1098795353300366, -0.04176349105381716, -1.4713751606004306)): shape (37, 800, 800)
      Valid pixels: 58850/640000 (9.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=274984, num_faces=274988
      Valid probs shape: (37, 58850)
    ✓ Random_22 (pose=(-1.3518999280769657, -2.693951913407203, 2.7119658271821585)): shape (37, 800, 800)
      Valid pixels: 100763/640000 (15.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=274987, num_faces=274988
      Valid probs shape: (37, 100763)
    ✓ Random_23 (pose=(0.5541127661190224, 2.8959450598404297, -2.140813787384193)): shape (37, 800, 800)
      Valid pixels: 56021/640000 (8.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1237, max=274985, num_faces=274988
      Valid probs shape: (37, 56021)
    ✓ Random_24 (pose=(1.1000297038601836, 1.6043018924452515, 1.6449238863920987)): shape (37, 800, 800)
      Valid pixels: 85940/640000 (13.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=12, max=274959, num_faces=274988
      Valid probs shape: (37, 85940)
    ✓ Random_25 (pose=(1.7004064451050418, 1.7108170130962614, -1.222543831763688)): shape (37, 800, 800)
      Valid pixels: 72104/640000 (11.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=41, max=274985, num_faces=274988
      Valid probs shape: (37, 72104)
    ✓ Random_26 (pose=(-1.2991985384293285, -2.206301337208209, 1.3508769718530793)): shape (37, 800, 800)
      Valid pixels: 66716/640000 (10.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=43, max=274985, num_faces=274988
      Valid probs shape: (37, 66716)
    ✓ Random_27 (pose=(1.501869805687031, 1.795491316883469, 0.4275574525721142)): shape (37, 800, 800)
      Valid pixels: 83379/640000 (13.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=8, max=274983, num_faces=274988
      Valid probs shape: (37, 83379)
    ✓ Random_28 (pose=(-1.015508526218328, -1.6120037826343947, 1.2954812267646618)): shape (37, 800, 800)
      Valid pixels: 74814/640000 (11.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=29, max=274985, num_faces=274988
      Valid probs shape: (37, 74814)
    ✓ Random_29 (pose=(-2.165042260430866, 0.04472135055266824, -2.5272937972232024)): shape (37, 800, 800)
      Valid pixels: 72386/640000 (11.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=274984, num_faces=274988
      Valid probs shape: (37, 72386)
    ✓ Random_30 (pose=(0.7563459116465929, 0.944678654364, 1.5871116044097127)): shape (37, 800, 800)
      Valid pixels: 87053/640000 (13.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=274756, num_faces=274988
      Valid probs shape: (37, 87053)
    ✓ Random_31 (pose=(-0.15940707641395457, 0.6311040447137644, 1.6454513185432154)): shape (37, 800, 800)
      Valid pixels: 68002/640000 (10.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=2, max=274909, num_faces=274988
      Valid probs shape: (37, 68002)
    ✓ Random_32 (pose=(0.7893030821956617, -1.4920934314772496, 3.0596614219780554)): shape (37, 800, 800)
      Valid pixels: 90468/640000 (14.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=274959, num_faces=274988
      Valid probs shape: (37, 90468)
    ✓ Random_33 (pose=(2.1835669881118305, 1.5470890274076252, -0.6316460312044896)): shape (37, 800, 800)
      Valid pixels: 77787/640000 (12.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=31, max=274985, num_faces=274988
      Valid probs shape: (37, 77787)
    ✓ Random_34 (pose=(0.46229013413673936, 2.2795240784644433, -1.8619874649047048)): shape (37, 800, 800)
      Valid pixels: 82084/640000 (12.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=30, max=274987, num_faces=274988
      Valid probs shape: (37, 82084)
    ✓ Random_35 (pose=(0.16890737804763178, -0.5760434063594344, 1.4981237345556426)): shape (37, 800, 800)
      Valid pixels: 64505/640000 (10.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=274987, num_faces=274988
      Valid probs shape: (37, 64505)
    ✓ Random_36 (pose=(-0.010957291643643785, -3.076188450750732, 1.5302515280382751)): shape (37, 800, 800)
      Valid pixels: 46000/640000 (7.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4028, max=274987, num_faces=274988
      Valid probs shape: (37, 46000)
    ✓ Random_37 (pose=(-0.019259333879620755, -0.062063551726472266, -1.6132552831473184)): shape (37, 800, 800)
      Valid pixels: 49129/640000 (7.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=274023, num_faces=274988
      Valid probs shape: (37, 49129)
    ✓ Random_38 (pose=(1.1611234641143042, 1.605369569484533, 0.9192972564097657)): shape (37, 800, 800)
      Valid pixels: 64998/640000 (10.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=274986, num_faces=274988
      Valid probs shape: (37, 64998)
    ✓ Random_39 (pose=(0.2774485273602667, -2.392058502418397, 1.914316933651775)): shape (37, 800, 800)
      Valid pixels: 65115/640000 (10.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=292, max=274984, num_faces=274988
      Valid probs shape: (37, 65115)
    P stats: min=0.0000, max=0.9999, mean=0.0249
    Non-zero vertices: 126454/137496
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 11042  1111  1122  2955     0  2450  1066  5351  7472]
  Ground Truth Stats:
    Labels shape: (137496,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-21/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
    MRF iteration 5/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7467
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8095
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8098

  RESULTS:
  RAW:         median(top-10)=0.8863, mean(top-10)=0.8976, median(all)=0.8225, mean(all)=0.7467
  + SMOOTHING: median(top-10)=0.9126, mean(top-10)=0.9191, median(all)=0.8599, mean(all)=0.8095 [+0.0263]
  + MRF:       median(top-10)=0.9129, mean(top-10)=0.9194, median(all)=0.8605, mean(all)=0.8098 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0266

================================================================================
Subject: MMRR-21-3
================================================================================
  Step 0: Generating predictions with V2 model (40 random views)...
  Mesh: 144159 vertices, 288314 faces
  Generating 40 random views...
  Generating predictions for 40 views (continuous camera pose)...
    ✓ Random_0 (pose=(0.7810781549032741, -2.2035028036039805, -0.4418103716759547)): shape (37, 800, 800)
      Valid pixels: 78371/640000 (12.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=52, max=288311, num_faces=288314
      Valid probs shape: (37, 78371)
    ✓ Random_1 (pose=(-0.8121748740509083, -2.4971731002369157, 2.4586229428387547)): shape (37, 800, 800)
      Valid pixels: 85156/640000 (13.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=110, max=288313, num_faces=288314
      Valid probs shape: (37, 85156)
    ✓ Random_2 (pose=(1.2949101441214212, -1.147959544750825, 1.6990202249116146)): shape (37, 800, 800)
      Valid pixels: 59085/640000 (9.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=288277, num_faces=288314
      Valid probs shape: (37, 59085)
    ✓ Random_3 (pose=(0.1000722450691649, -0.26621386930856605, -0.319952117454128)): shape (37, 800, 800)
      Valid pixels: 40150/640000 (6.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=288276, num_faces=288314
      Valid probs shape: (37, 40150)
    ✓ Random_4 (pose=(-3.0094771304967285, 2.857699334701679, -2.061885515028381)): shape (37, 800, 800)
      Valid pixels: 53226/640000 (8.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=287561, num_faces=288314
      Valid probs shape: (37, 53226)
    ✓ Random_5 (pose=(-0.6228922442094427, -0.3919893178890095, 1.0316440931572455)): shape (37, 800, 800)
      Valid pixels: 48773/640000 (7.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=288308, num_faces=288314
      Valid probs shape: (37, 48773)
    ✓ Random_6 (pose=(-0.8772523458220309, 3.03415683746684, 0.268570420040426)): shape (37, 800, 800)
      Valid pixels: 75368/640000 (11.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=940, max=288307, num_faces=288314
      Valid probs shape: (37, 75368)
    ✓ Random_7 (pose=(-0.08327842178401434, 0.1398525937731372, 0.9726169420334436)): shape (37, 800, 800)
      Valid pixels: 46719/640000 (7.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=287561, num_faces=288314
      Valid probs shape: (37, 46719)
    ✓ Random_8 (pose=(0.40847209802049944, -1.601227185449255, -2.0669654670590996)): shape (37, 800, 800)
      Valid pixels: 90703/640000 (14.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=44, max=288307, num_faces=288314
      Valid probs shape: (37, 90703)
    ✓ Random_9 (pose=(1.1642906248713647, -2.2537735041929845, 0.5008084420979908)): shape (37, 800, 800)
      Valid pixels: 88259/640000 (13.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=288313, num_faces=288314
      Valid probs shape: (37, 88259)
    ✓ Random_10 (pose=(-2.4819457033516263, -2.346737403110915, 1.318982982777741)): shape (37, 800, 800)
      Valid pixels: 65967/640000 (10.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=7, max=288307, num_faces=288314
      Valid probs shape: (37, 65967)
    ✓ Random_11 (pose=(0.8944873727889711, 2.833567410467248, -1.4154487564675453)): shape (37, 800, 800)
      Valid pixels: 71329/640000 (11.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=435, max=288311, num_faces=288314
      Valid probs shape: (37, 71329)
    ✓ Random_12 (pose=(0.430484928792104, 2.2052927919047542, 1.0936935783621928)): shape (37, 800, 800)
      Valid pixels: 77658/640000 (12.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=10855, max=287559, num_faces=288314
      Valid probs shape: (37, 77658)
    ✓ Random_13 (pose=(-1.288279898948997, 1.6520814906370571, -1.162698632152035)): shape (37, 800, 800)
      Valid pixels: 63398/640000 (9.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=16, max=287560, num_faces=288314
      Valid probs shape: (37, 63398)
    ✓ Random_14 (pose=(-1.2285465029013383, 0.7638094252480001, -1.3212954814547875)): shape (37, 800, 800)
      Valid pixels: 59419/640000 (9.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=287560, num_faces=288314
      Valid probs shape: (37, 59419)
    ✓ Random_15 (pose=(2.4059801200578557, -1.962293122738967, -2.6454059407129495)): shape (37, 800, 800)
      Valid pixels: 60694/640000 (9.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=24, max=288309, num_faces=288314
      Valid probs shape: (37, 60694)
    ✓ Random_16 (pose=(-3.069504089211691, 1.211663678763868, 1.4758326448363945)): shape (37, 800, 800)
      Valid pixels: 93183/640000 (14.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=12, max=288313, num_faces=288314
      Valid probs shape: (37, 93183)
    ✓ Random_17 (pose=(0.11329175539313407, -2.4274571220460257, -2.5040323396713116)): shape (37, 800, 800)
      Valid pixels: 72583/640000 (11.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=32816, max=288304, num_faces=288314
      Valid probs shape: (37, 72583)
    ✓ Random_18 (pose=(-0.05952229262121156, 2.5241913418799387, -0.9054023910564486)): shape (37, 800, 800)
      Valid pixels: 52542/640000 (8.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=621, max=288278, num_faces=288314
      Valid probs shape: (37, 52542)
    ✓ Random_19 (pose=(0.2672987200336623, -1.2060419908931073, -1.4124153382997822)): shape (37, 800, 800)
      Valid pixels: 73516/640000 (11.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=288312, num_faces=288314
      Valid probs shape: (37, 73516)
    ✓ Random_20 (pose=(0.6393687954663201, -0.3462599407567697, -2.548754478764383)): shape (37, 800, 800)
      Valid pixels: 67250/640000 (10.5%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=1, max=287875, num_faces=288314
      Valid probs shape: (37, 67250)
    ✓ Random_21 (pose=(0.815490574944775, -1.4404732799534865, 0.3843454504599406)): shape (37, 800, 800)
      Valid pixels: 98259/640000 (15.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=288313, num_faces=288314
      Valid probs shape: (37, 98259)
    ✓ Random_22 (pose=(-0.7106897122941969, -1.8537642806636843, -1.7213606187911086)): shape (37, 800, 800)
      Valid pixels: 87967/640000 (13.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=144, max=288266, num_faces=288314
      Valid probs shape: (37, 87967)
    ✓ Random_23 (pose=(0.4400776399944881, -2.93127899676491, -0.6460501308817683)): shape (37, 800, 800)
      Valid pixels: 54827/640000 (8.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1135, max=288313, num_faces=288314
      Valid probs shape: (37, 54827)
    ✓ Random_24 (pose=(-2.4263711175138076, -0.2076633028694994, 2.4689639093888163)): shape (37, 800, 800)
      Valid pixels: 70444/640000 (11.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=424, max=288313, num_faces=288314
      Valid probs shape: (37, 70444)
    ✓ Random_25 (pose=(-2.5394079639666822, -2.247712486724477, -2.9739809763608176)): shape (37, 800, 800)
      Valid pixels: 82449/640000 (12.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=288313, num_faces=288314
      Valid probs shape: (37, 82449)
    ✓ Random_26 (pose=(-1.4338710765873277, 1.0722138282790628, 1.4808073518392417)): shape (37, 800, 800)
      Valid pixels: 62586/640000 (9.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=38, max=288309, num_faces=288314
      Valid probs shape: (37, 62586)
    ✓ Random_27 (pose=(0.885114664908702, -1.0440216760528331, 0.8614357406364643)): shape (37, 800, 800)
      Valid pixels: 85630/640000 (13.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=288313, num_faces=288314
      Valid probs shape: (37, 85630)
    ✓ Random_28 (pose=(-1.3953635245270894, 2.8691454441667545, -0.11270918813264963)): shape (37, 800, 800)
      Valid pixels: 91323/640000 (14.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=88, max=288305, num_faces=288314
      Valid probs shape: (37, 91323)
    ✓ Random_29 (pose=(-3.076470302889627, -0.013731844857202802, -0.4091305124700466)): shape (37, 800, 800)
      Valid pixels: 42915/640000 (6.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3232, max=288305, num_faces=288314
      Valid probs shape: (37, 42915)
    ✓ Random_30 (pose=(0.8241920568638958, 1.4844467773506222, -2.9155544228754673)): shape (37, 800, 800)
      Valid pixels: 66941/640000 (10.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=68, max=288307, num_faces=288314
      Valid probs shape: (37, 66941)
    ✓ Random_31 (pose=(-3.0606923969357975, 0.8087223715510494, 0.391642825084364)): shape (37, 800, 800)
      Valid pixels: 63824/640000 (10.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=137, max=288311, num_faces=288314
      Valid probs shape: (37, 63824)
    ✓ Random_32 (pose=(-1.9289126512805184, 2.8133765048891224, -3.095574696735659)): shape (37, 800, 800)
      Valid pixels: 86982/640000 (13.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=288313, num_faces=288314
      Valid probs shape: (37, 86982)
    ✓ Random_33 (pose=(-2.802391638683555, -0.1334842960889766, -0.16222317400226993)): shape (37, 800, 800)
      Valid pixels: 57057/640000 (8.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=30603, max=288307, num_faces=288314
      Valid probs shape: (37, 57057)
    ✓ Random_34 (pose=(-0.36651313990485335, 2.634955970562678, 0.7418331332194779)): shape (37, 800, 800)
      Valid pixels: 69711/640000 (10.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=22337, max=288305, num_faces=288314
      Valid probs shape: (37, 69711)
    ✓ Random_35 (pose=(0.13645465340806995, -0.3371232494240535, 0.461092366664388)): shape (37, 800, 800)
      Valid pixels: 48975/640000 (7.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=288308, num_faces=288314
      Valid probs shape: (37, 48975)
    ✓ Random_36 (pose=(0.032953329801798326, 1.9567586867270688, -0.6931423291602266)): shape (37, 800, 800)
      Valid pixels: 67353/640000 (10.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=288275, num_faces=288314
      Valid probs shape: (37, 67353)
    ✓ Random_37 (pose=(2.218497045935292, 1.7103790546052302, 0.9739124501567034)): shape (37, 800, 800)
      Valid pixels: 86086/640000 (13.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=12, max=288312, num_faces=288314
      Valid probs shape: (37, 86086)
    ✓ Random_38 (pose=(-2.00408872764055, -1.055730503779769, -2.029576833846847)): shape (37, 800, 800)
      Valid pixels: 72457/640000 (11.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=288277, num_faces=288314
      Valid probs shape: (37, 72457)
    ✓ Random_39 (pose=(0.44189037350834326, 3.098285588090965, 2.402179729412162)): shape (37, 800, 800)
      Valid pixels: 60650/640000 (9.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=37963, max=288305, num_faces=288314
      Valid probs shape: (37, 60650)
    P stats: min=0.0000, max=1.0000, mean=0.0258
    Non-zero vertices: 137419/144159
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 6740 1464 1049 3898    0 2181 1288 4482 6609]
  Ground Truth Stats:
    Labels shape: (144159,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-3/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7990
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8472
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8477

  RESULTS:
  RAW:         median(top-10)=0.9049, mean(top-10)=0.9157, median(all)=0.8553, mean(all)=0.7990
  + SMOOTHING: median(top-10)=0.9312, mean(top-10)=0.9359, median(all)=0.8840, mean(all)=0.8472 [+0.0263]
  + MRF:       median(top-10)=0.9316, mean(top-10)=0.9363, median(all)=0.8839, mean(all)=0.8477 [+0.0004]
  TOTAL IMPROVEMENT (median top-10): +0.0267

================================================================================
Subject: MMRR-21-4
================================================================================
  Step 0: Generating predictions with V2 model (40 random views)...
  Mesh: 118034 vertices, 236064 faces
  Generating 40 random views...
  Generating predictions for 40 views (continuous camera pose)...
    ✓ Random_0 (pose=(1.1058553399117068, 0.5889021045007259, 2.0998781506026445)): shape (37, 800, 800)
      Valid pixels: 87673/640000 (13.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=236062, num_faces=236064
      Valid probs shape: (37, 87673)
    ✓ Random_1 (pose=(-1.924488492301882, 2.5122874791763303, 1.3571142430455776)): shape (37, 800, 800)
      Valid pixels: 59431/640000 (9.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=236010, num_faces=236064
      Valid probs shape: (37, 59431)
    ✓ Random_2 (pose=(-2.802821637643964, 0.8388874968707931, 0.01688191528478855)): shape (37, 800, 800)
      Valid pixels: 63017/640000 (9.8%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=2444, max=235904, num_faces=236064
      Valid probs shape: (37, 63017)
    ✓ Random_3 (pose=(-2.189125929437735, -1.4804092535518698, -0.9893352776024007)): shape (37, 800, 800)
      Valid pixels: 59543/640000 (9.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=9, max=236062, num_faces=236064
      Valid probs shape: (37, 59543)
    ✓ Random_4 (pose=(-2.6436132547430082, -2.582206186955674, -0.5819602315412569)): shape (37, 800, 800)
      Valid pixels: 60608/640000 (9.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=235056, num_faces=236064
      Valid probs shape: (37, 60608)
    ✓ Random_5 (pose=(-2.767243055691431, 0.3873884414146751, -0.43796031259221113)): shape (37, 800, 800)
      Valid pixels: 62151/640000 (9.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7320, max=236058, num_faces=236064
      Valid probs shape: (37, 62151)
    ✓ Random_6 (pose=(-2.3905622505306536, -0.5062991225100859, -0.4216898048404363)): shape (37, 800, 800)
      Valid pixels: 72172/640000 (11.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=9769, max=236063, num_faces=236064
      Valid probs shape: (37, 72172)
    ✓ Random_7 (pose=(2.617298246629592, -1.376635804419813, 2.0183134579725905)): shape (37, 800, 800)
      Valid pixels: 90690/640000 (14.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=110, max=236061, num_faces=236064
      Valid probs shape: (37, 90690)
    ✓ Random_8 (pose=(-0.1630053339610793, -1.7513358877026497, -1.1988830184022699)): shape (37, 800, 800)
      Valid pixels: 85165/640000 (13.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=116, max=236061, num_faces=236064
      Valid probs shape: (37, 85165)
    ✓ Random_9 (pose=(-1.9464119486329723, -2.7796580078185724, -0.5403832084822424)): shape (37, 800, 800)
      Valid pixels: 89629/640000 (14.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=236054, num_faces=236064
      Valid probs shape: (37, 89629)
    ✓ Random_10 (pose=(-1.5065292046190601, 0.9182085197195207, -1.7121086912889854)): shape (37, 800, 800)
      Valid pixels: 62067/640000 (9.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=236063, num_faces=236064
      Valid probs shape: (37, 62067)
    ✓ Random_11 (pose=(1.8914566264923396, -1.2985562504247254, -1.5621632552441331)): shape (37, 800, 800)
      Valid pixels: 75098/640000 (11.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=118, max=236010, num_faces=236064
      Valid probs shape: (37, 75098)
    ✓ Random_12 (pose=(0.015743146590752044, -1.3530852059373952, -3.1255685272789004)): shape (37, 800, 800)
      Valid pixels: 61001/640000 (9.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=236062, num_faces=236064
      Valid probs shape: (37, 61001)
    ✓ Random_13 (pose=(-0.9928542694565601, -1.1960977442115328, -1.0452020600614267)): shape (37, 800, 800)
      Valid pixels: 93727/640000 (14.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=5, max=236062, num_faces=236064
      Valid probs shape: (37, 93727)
    ✓ Random_14 (pose=(-0.9439787431163809, -1.6913390125033325, 1.6818062606354562)): shape (37, 800, 800)
      Valid pixels: 91288/640000 (14.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=20, max=236016, num_faces=236064
      Valid probs shape: (37, 91288)
    ✓ Random_15 (pose=(-3.0960733111751577, 1.8660056341005768, 0.41937016761715107)): shape (37, 800, 800)
      Valid pixels: 70352/640000 (11.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=236010, num_faces=236064
      Valid probs shape: (37, 70352)
    ✓ Random_16 (pose=(-1.8408921755616956, -1.8646610367966356, 0.29079990592427096)): shape (37, 800, 800)
      Valid pixels: 89797/640000 (14.0%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=0, max=236061, num_faces=236064
      Valid probs shape: (37, 89797)
    ✓ Random_17 (pose=(-2.954803928782781, -0.7934547458728054, 1.7409674188154955)): shape (37, 800, 800)
      Valid pixels: 70346/640000 (11.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2574, max=236061, num_faces=236064
      Valid probs shape: (37, 70346)
    ✓ Random_18 (pose=(2.3292148492260383, 1.847654512796895, -2.298061767462764)): shape (37, 800, 800)
      Valid pixels: 87481/640000 (13.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=2, max=236061, num_faces=236064
      Valid probs shape: (37, 87481)
    ✓ Random_19 (pose=(-0.18519935246772778, 2.075421453010855, 1.6929790762201815)): shape (37, 800, 800)
      Valid pixels: 78079/640000 (12.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=117, max=236061, num_faces=236064
      Valid probs shape: (37, 78079)
    ✓ Random_20 (pose=(2.840259012978554, 3.0467837092177588, 1.6606949228718912)): shape (37, 800, 800)
      Valid pixels: 47884/640000 (7.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=235272, num_faces=236064
      Valid probs shape: (37, 47884)
    ✓ Random_21 (pose=(0.34495132759308644, -2.907509461505435, -2.1905461778698263)): shape (37, 800, 800)
      Valid pixels: 56361/640000 (8.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=8403, max=236062, num_faces=236064
      Valid probs shape: (37, 56361)
    ✓ Random_22 (pose=(-0.020600905951563497, 0.9064199037136804, -0.8765411956028122)): shape (37, 800, 800)
      Valid pixels: 67132/640000 (10.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=236015, num_faces=236064
      Valid probs shape: (37, 67132)
    ✓ Random_23 (pose=(0.6184405464172391, 0.2919371035205125, -1.2647799086145433)): shape (37, 800, 800)
      Valid pixels: 56694/640000 (8.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=236015, num_faces=236064
      Valid probs shape: (37, 56694)
    ✓ Random_24 (pose=(-0.5898537688041094, -0.7692223166601586, 0.30987523300302966)): shape (37, 800, 800)
      Valid pixels: 58437/640000 (9.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=2, max=235947, num_faces=236064
      Valid probs shape: (37, 58437)
    ✓ Random_25 (pose=(-2.733990852307065, 0.15931628771849304, -0.6444816048702027)): shape (37, 800, 800)
      Valid pixels: 58375/640000 (9.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=34957, max=236063, num_faces=236064
      Valid probs shape: (37, 58375)
    ✓ Random_26 (pose=(1.6990706792616779, -0.046507968989141446, -0.33007917129636377)): shape (37, 800, 800)
      Valid pixels: 99710/640000 (15.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=236016, num_faces=236064
      Valid probs shape: (37, 99710)
    ✓ Random_27 (pose=(-1.2642430985962525, -1.6972840416511548, 2.2481259131483364)): shape (37, 800, 800)
      Valid pixels: 96596/640000 (15.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=236016, num_faces=236064
      Valid probs shape: (37, 96596)
    ✓ Random_28 (pose=(2.300546071356586, -0.8545822824680385, -1.6608034584060334)): shape (37, 800, 800)
      Valid pixels: 80720/640000 (12.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=142, max=236016, num_faces=236064
      Valid probs shape: (37, 80720)
    ✓ Random_29 (pose=(-1.6991803011735918, 0.1733388751623104, 1.400635185420776)): shape (37, 800, 800)
      Valid pixels: 64603/640000 (10.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=124, max=236008, num_faces=236064
      Valid probs shape: (37, 64603)
    ✓ Random_30 (pose=(-0.6273979433716441, -3.1335482386665108, 0.8684665344471956)): shape (37, 800, 800)
      Valid pixels: 60261/640000 (9.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5082, max=236058, num_faces=236064
      Valid probs shape: (37, 60261)
    ✓ Random_31 (pose=(3.1358155128982608, 0.09637099968234342, 1.7168655927431011)): shape (37, 800, 800)
      Valid pixels: 41502/640000 (6.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3688, max=236062, num_faces=236064
      Valid probs shape: (37, 41502)
    ✓ Random_32 (pose=(-1.280627474831162, -1.3349736060781288, 0.08164934673236068)): shape (37, 800, 800)
      Valid pixels: 81845/640000 (12.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=17, max=236061, num_faces=236064
      Valid probs shape: (37, 81845)
    ✓ Random_33 (pose=(-1.6526254084404761, -1.5732654017313898, 2.440844326303325)): shape (37, 800, 800)
      Valid pixels: 92124/640000 (14.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=236016, num_faces=236064
      Valid probs shape: (37, 92124)
    ✓ Random_34 (pose=(1.461988360391972, -2.3688185820181378, -1.4985961048050618)): shape (37, 800, 800)
      Valid pixels: 64140/640000 (10.0%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=20, max=236010, num_faces=236064
      Valid probs shape: (37, 64140)
    ✓ Random_35 (pose=(2.442210143595773, 0.08034430633768253, -2.7264469896820085)): shape (37, 800, 800)
      Valid pixels: 68842/640000 (10.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7279, max=236061, num_faces=236064
      Valid probs shape: (37, 68842)
    ✓ Random_36 (pose=(-2.78057638978726, 0.35364554607423315, 0.9922012331649706)): shape (37, 800, 800)
      Valid pixels: 52212/640000 (8.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4170, max=236057, num_faces=236064
      Valid probs shape: (37, 52212)
    ✓ Random_37 (pose=(-0.7764320068960946, -0.13452093326922032, 2.03372785640508)): shape (37, 800, 800)
      Valid pixels: 59909/640000 (9.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=236015, num_faces=236064
      Valid probs shape: (37, 59909)
    ✓ Random_38 (pose=(-2.790475828456376, -2.6724761078218178, -1.1189909307466719)): shape (37, 800, 800)
      Valid pixels: 53918/640000 (8.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=236015, num_faces=236064
      Valid probs shape: (37, 53918)
    ✓ Random_39 (pose=(-2.202220597476341, 2.6108953188848547, 3.032132828437696)): shape (37, 800, 800)
      Valid pixels: 79283/640000 (12.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=236016, num_faces=236064
      Valid probs shape: (37, 79283)
    P stats: min=0.0000, max=1.0000, mean=0.0260
    Non-zero vertices: 113610/118034
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 4424 1061 1106 2999    0 1870  990 4043 4732]
  Ground Truth Stats:
    Labels shape: (118034,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-4/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7819
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8162
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8161

  RESULTS:
  RAW:         median(top-10)=0.9257, mean(top-10)=0.9245, median(all)=0.8441, mean(all)=0.7819
  + SMOOTHING: median(top-10)=0.9396, mean(top-10)=0.9390, median(all)=0.8663, mean(all)=0.8162 [+0.0139]
  + MRF:       median(top-10)=0.9396, mean(top-10)=0.9391, median(all)=0.8669, mean(all)=0.8161 [-0.0000]
  TOTAL IMPROVEMENT (median top-10): +0.0139

================================================================================
Subject: MMRR-21-5
================================================================================
  Step 0: Generating predictions with V2 model (40 random views)...
  Mesh: 145215 vertices, 290426 faces
  Generating 40 random views...
  Generating predictions for 40 views (continuous camera pose)...
    ✓ Random_0 (pose=(0.7053563276808683, -3.1104371114549507, 2.8639544958283443)): shape (37, 800, 800)
      Valid pixels: 82593/640000 (12.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=21395, max=290385, num_faces=290426
      Valid probs shape: (37, 82593)
    ✓ Random_1 (pose=(-1.9730538409190084, -0.8958858648807726, -2.04334945468153)): shape (37, 800, 800)
      Valid pixels: 79107/640000 (12.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=12, max=290415, num_faces=290426
      Valid probs shape: (37, 79107)
    ✓ Random_2 (pose=(0.27574042256004905, 1.2038583481552907, -2.223498906220984)): shape (37, 800, 800)
      Valid pixels: 90410/640000 (14.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=290425, num_faces=290426
      Valid probs shape: (37, 90410)
    ✓ Random_3 (pose=(0.11132247085238056, 0.07373017411415628, -0.954424975172599)): shape (37, 800, 800)
      Valid pixels: 46791/640000 (7.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=290421, num_faces=290426
      Valid probs shape: (37, 46791)
    ✓ Random_4 (pose=(-0.5953119472281028, -3.078058100364443, -2.774023785464609)): shape (37, 800, 800)
      Valid pixels: 65683/640000 (10.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=280, max=290419, num_faces=290426
      Valid probs shape: (37, 65683)
    ✓ Random_5 (pose=(-0.7340651765362582, 0.664770600798918, 1.2253212587313316)): shape (37, 800, 800)
      Valid pixels: 71841/640000 (11.2%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=6, max=290346, num_faces=290426
      Valid probs shape: (37, 71841)
    ✓ Random_6 (pose=(1.7593032636989276, 2.5211295710982284, 2.8820553552125245)): shape (37, 800, 800)
      Valid pixels: 104416/640000 (16.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=4, max=288853, num_faces=290426
      Valid probs shape: (37, 104416)
    ✓ Random_7 (pose=(2.6881282391496892, -0.7842754033365003, -0.7517774201203777)): shape (37, 800, 800)
      Valid pixels: 83558/640000 (13.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=281, max=290421, num_faces=290426
      Valid probs shape: (37, 83558)
    ✓ Random_8 (pose=(2.3946473649141398, 1.8820078769594204, 0.10774362271392013)): shape (37, 800, 800)
      Valid pixels: 102165/640000 (16.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=10, max=290425, num_faces=290426
      Valid probs shape: (37, 102165)
    ✓ Random_9 (pose=(2.2583847896919584, -2.071388228860436, 1.4018191848924326)): shape (37, 800, 800)
      Valid pixels: 88154/640000 (13.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=288855, num_faces=290426
      Valid probs shape: (37, 88154)
    ✓ Random_10 (pose=(-0.8040318618082982, -1.6346050061128434, -0.14025092413772278)): shape (37, 800, 800)
      Valid pixels: 80776/640000 (12.6%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=6, max=290313, num_faces=290426
      Valid probs shape: (37, 80776)
    ✓ Random_11 (pose=(-0.7131661600484573, 0.7584216012526332, 2.174510796510525)): shape (37, 800, 800)
      Valid pixels: 61522/640000 (9.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=5, max=290351, num_faces=290426
      Valid probs shape: (37, 61522)
    ✓ Random_12 (pose=(2.2705641049614815, 2.285366735959278, -2.7531746741986094)): shape (37, 800, 800)
      Valid pixels: 96070/640000 (15.0%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=2, max=288850, num_faces=290426
      Valid probs shape: (37, 96070)
    ✓ Random_13 (pose=(-1.957203995382957, -0.5631581946296644, 0.5465755164201136)): shape (37, 800, 800)
      Valid pixels: 88220/640000 (13.8%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=25, max=290289, num_faces=290426
      Valid probs shape: (37, 88220)
    ✓ Random_14 (pose=(1.1074154583299878, 0.2543526271636285, -2.714576147516228)): shape (37, 800, 800)
      Valid pixels: 76762/640000 (12.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=288562, num_faces=290426
      Valid probs shape: (37, 76762)
    ✓ Random_15 (pose=(-1.119246476179152, 0.8604835805097215, 0.7177165940514176)): shape (37, 800, 800)
      Valid pixels: 83569/640000 (13.1%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=5, max=288564, num_faces=290426
      Valid probs shape: (37, 83569)
    ✓ Random_16 (pose=(-1.9288385152162986, -2.932945972707415, 0.2055588639961008)): shape (37, 800, 800)
      Valid pixels: 89542/640000 (14.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=288853, num_faces=290426
      Valid probs shape: (37, 89542)
    ✓ Random_17 (pose=(-0.9331591207931038, -0.8247802317369115, 2.1448752626660195)): shape (37, 800, 800)
      Valid pixels: 98469/640000 (15.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=290425, num_faces=290426
      Valid probs shape: (37, 98469)
    ✓ Random_18 (pose=(-1.4835478016111445, -1.0950340865641621, -1.9838393847551268)): shape (37, 800, 800)
      Valid pixels: 70780/640000 (11.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=290415, num_faces=290426
      Valid probs shape: (37, 70780)
    ✓ Random_19 (pose=(1.01159726261763, -1.0385735485735, 1.9722335913037101)): shape (37, 800, 800)
      Valid pixels: 65905/640000 (10.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=288855, num_faces=290426
      Valid probs shape: (37, 65905)
    ✓ Random_20 (pose=(-1.876049661946107, -0.7566882589248749, 2.3832794416633183)): shape (37, 800, 800)
      Valid pixels: 97667/640000 (15.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=31, max=290425, num_faces=290426
      Valid probs shape: (37, 97667)
    ✓ Random_21 (pose=(0.8328385167932537, 1.2859892396625998, -0.6606702624598118)): shape (37, 800, 800)
      Valid pixels: 102616/640000 (16.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=290422, num_faces=290426
      Valid probs shape: (37, 102616)
    ✓ Random_22 (pose=(-1.2427602133377864, -2.339965432173239, 2.914882031915077)): shape (37, 800, 800)
      Valid pixels: 105180/640000 (16.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=167, max=290425, num_faces=290426
      Valid probs shape: (37, 105180)
    ✓ Random_23 (pose=(-1.6172733771598335, -1.0672679553913937, -1.6350202761379768)): shape (37, 800, 800)
      Valid pixels: 66352/640000 (10.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=290404, num_faces=290426
      Valid probs shape: (37, 66352)
    ✓ Random_24 (pose=(1.6568690120844902, 3.1257194109737023, 1.0970524085618791)): shape (37, 800, 800)
      Valid pixels: 73211/640000 (11.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=290417, num_faces=290426
      Valid probs shape: (37, 73211)
    ✓ Random_25 (pose=(-3.107872218922348, 0.7775249916262976, -1.808497457939919)): shape (37, 800, 800)
      Valid pixels: 86309/640000 (13.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8367, max=290385, num_faces=290426
      Valid probs shape: (37, 86309)
    ✓ Random_26 (pose=(0.7955255214399326, -2.08231695458808, 1.4730202971005655)): shape (37, 800, 800)
      Valid pixels: 78128/640000 (12.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=283, max=290414, num_faces=290426
      Valid probs shape: (37, 78128)
    ✓ Random_27 (pose=(-0.4752749449203577, -0.09525219922795758, 0.4804451831624852)): shape (37, 800, 800)
      Valid pixels: 59990/640000 (9.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=290351, num_faces=290426
      Valid probs shape: (37, 59990)
    ✓ Random_28 (pose=(-1.465994581367313, 1.912987192405807, 0.09925947901228493)): shape (37, 800, 800)
      Valid pixels: 98299/640000 (15.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=50, max=290284, num_faces=290426
      Valid probs shape: (37, 98299)
    ✓ Random_29 (pose=(1.225942426544262, 0.7594595535021003, -0.4601042770490107)): shape (37, 800, 800)
      Valid pixels: 105397/640000 (16.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=290425, num_faces=290426
      Valid probs shape: (37, 105397)
    ✓ Random_30 (pose=(-2.0790719478866215, -0.6025166229130572, -0.8410926001237509)): shape (37, 800, 800)
      Valid pixels: 83673/640000 (13.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=8658, max=288564, num_faces=290426
      Valid probs shape: (37, 83673)
    ✓ Random_31 (pose=(2.321864662564037, -0.47381722206965193, 0.6898696085806559)): shape (37, 800, 800)
      Valid pixels: 66365/640000 (10.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=284, max=290415, num_faces=290426
      Valid probs shape: (37, 66365)
    ✓ Random_32 (pose=(1.7962423437673225, 1.0778669999623895, 0.7109106368959432)): shape (37, 800, 800)
      Valid pixels: 88166/640000 (13.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=11, max=290421, num_faces=290426
      Valid probs shape: (37, 88166)
    ✓ Random_33 (pose=(-2.820813416547232, 1.9904028964234861, -2.7409928226814877)): shape (37, 800, 800)
      Valid pixels: 68006/640000 (10.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=288849, num_faces=290426
      Valid probs shape: (37, 68006)
    ✓ Random_34 (pose=(-0.8227129304701855, -1.186639342526197, 0.0958291252158121)): shape (37, 800, 800)
      Valid pixels: 75027/640000 (11.7%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=1, max=290351, num_faces=290426
      Valid probs shape: (37, 75027)
    ✓ Random_35 (pose=(-1.0800980156493858, -0.71866261840945, -2.9288533446553173)): shape (37, 800, 800)
      Valid pixels: 83376/640000 (13.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=290423, num_faces=290426
      Valid probs shape: (37, 83376)
    ✓ Random_36 (pose=(-3.0095704915534474, -0.3436005447800379, 0.5305996695979411)): shape (37, 800, 800)
      Valid pixels: 62738/640000 (9.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=61978, max=290390, num_faces=290426
      Valid probs shape: (37, 62738)
    ✓ Random_37 (pose=(-0.42960865000819437, -1.8766616456590925, -0.2349987553042716)): shape (37, 800, 800)
      Valid pixels: 76505/640000 (12.0%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=179, max=290346, num_faces=290426
      Valid probs shape: (37, 76505)
    ✓ Random_38 (pose=(-1.5417790588492448, -1.1209776697528366, -1.4955186524517217)): shape (37, 800, 800)
      Valid pixels: 70279/640000 (11.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=288856, num_faces=290426
      Valid probs shape: (37, 70279)
    ✓ Random_39 (pose=(-1.4273812147662266, -0.5816199210385689, -2.877153858613078)): shape (37, 800, 800)
      Valid pixels: 94426/640000 (14.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=290423, num_faces=290426
      Valid probs shape: (37, 94426)
    P stats: min=0.0000, max=0.9998, mean=0.0258
    Non-zero vertices: 138483/145215
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 6732 1227 1147 4363    0 1897 1228 4044 6058]
  Ground Truth Stats:
    Labels shape: (145215,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-5/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7982
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8454
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8456

  RESULTS:
  RAW:         median(top-10)=0.9120, mean(top-10)=0.9137, median(all)=0.8630, mean(all)=0.7982
  + SMOOTHING: median(top-10)=0.9355, mean(top-10)=0.9344, median(all)=0.8818, mean(all)=0.8454 [+0.0236]
  + MRF:       median(top-10)=0.9359, mean(top-10)=0.9347, median(all)=0.8817, mean(all)=0.8456 [+0.0004]
  TOTAL IMPROVEMENT (median top-10): +0.0239

================================================================================
Subject: MMRR-21-6
================================================================================
  Step 0: Generating predictions with V2 model (40 random views)...
  Mesh: 128994 vertices, 257984 faces
  Generating 40 random views...
  Generating predictions for 40 views (continuous camera pose)...
    ✓ Random_0 (pose=(-1.4819466268587818, -0.7980839787347209, 1.3636579525373005)): shape (37, 800, 800)
      Valid pixels: 65984/640000 (10.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=257983, num_faces=257984
      Valid probs shape: (37, 65984)
    ✓ Random_1 (pose=(2.283256434507469, 1.989795818383989, -2.930366434988293)): shape (37, 800, 800)
      Valid pixels: 95120/640000 (14.9%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=0, max=257774, num_faces=257984
      Valid probs shape: (37, 95120)
    ✓ Random_2 (pose=(2.5687191112496306, 2.3789630077092694, 0.9496329395646139)): shape (37, 800, 800)
      Valid pixels: 84211/640000 (13.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=257975, num_faces=257984
      Valid probs shape: (37, 84211)
    ✓ Random_3 (pose=(2.9605454789712624, -2.063171249893672, -2.06882507776068)): shape (37, 800, 800)
      Valid pixels: 90794/640000 (14.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=257982, num_faces=257984
      Valid probs shape: (37, 90794)
    ✓ Random_4 (pose=(-2.8212764783613613, 1.4840358809611862, 1.441925631991781)): shape (37, 800, 800)
      Valid pixels: 102379/640000 (16.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=34, max=257982, num_faces=257984
      Valid probs shape: (37, 102379)
    ✓ Random_5 (pose=(-1.2750607956049789, -1.3631955904750064, 1.6071574644855655)): shape (37, 800, 800)
      Valid pixels: 77189/640000 (12.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=257983, num_faces=257984
      Valid probs shape: (37, 77189)
    ✓ Random_6 (pose=(-1.683505180653423, 2.891978110107055, 0.06682800138843348)): shape (37, 800, 800)
      Valid pixels: 90545/640000 (14.1%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=8, max=257961, num_faces=257984
      Valid probs shape: (37, 90545)
    ✓ Random_7 (pose=(-1.6139379111790981, 1.4168718892004861, 0.27147198721535704)): shape (37, 800, 800)
      Valid pixels: 85319/640000 (13.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=10, max=257980, num_faces=257984
      Valid probs shape: (37, 85319)
    ✓ Random_8 (pose=(0.48532324541250516, -2.3696713296794436, 0.41787198589803465)): shape (37, 800, 800)
      Valid pixels: 80790/640000 (12.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=182, max=257982, num_faces=257984
      Valid probs shape: (37, 80790)
    ✓ Random_9 (pose=(-2.248575190734483, 0.8026911164924075, 0.4582866401056065)): shape (37, 800, 800)
      Valid pixels: 69001/640000 (10.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=201, max=257983, num_faces=257984
      Valid probs shape: (37, 69001)
    ✓ Random_10 (pose=(-1.4007565813891818, -0.7527209506860273, 1.3538384078332797)): shape (37, 800, 800)
      Valid pixels: 65271/640000 (10.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=257982, num_faces=257984
      Valid probs shape: (37, 65271)
    ✓ Random_11 (pose=(2.075590326879791, 2.7239180880525478, 1.9871159863943602)): shape (37, 800, 800)
      Valid pixels: 65349/640000 (10.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=256956, num_faces=257984
      Valid probs shape: (37, 65349)
    ✓ Random_12 (pose=(-0.3215572983650765, -0.33064358610764666, 2.2506688871783487)): shape (37, 800, 800)
      Valid pixels: 64027/640000 (10.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=257962, num_faces=257984
      Valid probs shape: (37, 64027)
    ✓ Random_13 (pose=(-0.9313651757569228, -2.1836499079084097, 1.227984072977816)): shape (37, 800, 800)
      Valid pixels: 67313/640000 (10.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=126, max=257982, num_faces=257984
      Valid probs shape: (37, 67313)
    ✓ Random_14 (pose=(-1.995699646628557, 3.0926837426109968, 1.0682278382755763)): shape (37, 800, 800)
      Valid pixels: 65332/640000 (10.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=257982, num_faces=257984
      Valid probs shape: (37, 65332)
    ✓ Random_15 (pose=(-1.0753432828524843, 1.312708874181328, 1.8493256435076875)): shape (37, 800, 800)
      Valid pixels: 66061/640000 (10.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=257982, num_faces=257984
      Valid probs shape: (37, 66061)
    ✓ Random_16 (pose=(1.3300512289494666, 0.7458848831266018, -0.8958784807219677)): shape (37, 800, 800)
      Valid pixels: 96958/640000 (15.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=257982, num_faces=257984
      Valid probs shape: (37, 96958)
    ✓ Random_17 (pose=(-0.5858991408308807, -1.0558516315458801, 2.51560188193001)): shape (37, 800, 800)
      Valid pixels: 88107/640000 (13.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=257975, num_faces=257984
      Valid probs shape: (37, 88107)
    ✓ Random_18 (pose=(0.007276468175846151, -3.079248754870135, -2.8662567441145597)): shape (37, 800, 800)
      Valid pixels: 47496/640000 (7.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=83467, max=257983, num_faces=257984
      Valid probs shape: (37, 47496)
    ✓ Random_19 (pose=(1.1485975408079785, -0.8732485967954209, 1.5988681770188604)): shape (37, 800, 800)
      Valid pixels: 63752/640000 (10.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=257652, num_faces=257984
      Valid probs shape: (37, 63752)
    ✓ Random_20 (pose=(1.8604882693382354, -1.1712765849224218, -0.1316232407353497)): shape (37, 800, 800)
      Valid pixels: 97731/640000 (15.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=86, max=257978, num_faces=257984
      Valid probs shape: (37, 97731)
    ✓ Random_21 (pose=(-1.3524059400361688, -1.3748428155040857, 1.7813919438985266)): shape (37, 800, 800)
      Valid pixels: 82405/640000 (12.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=257982, num_faces=257984
      Valid probs shape: (37, 82405)
    ✓ Random_22 (pose=(2.121540952371393, 1.607430513879203, -0.12324411940192492)): shape (37, 800, 800)
      Valid pixels: 99339/640000 (15.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8, max=257982, num_faces=257984
      Valid probs shape: (37, 99339)
    ✓ Random_23 (pose=(0.8323376090919359, -2.1400030535521726, -2.371261522284266)): shape (37, 800, 800)
      Valid pixels: 91091/640000 (14.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=61, max=257980, num_faces=257984
      Valid probs shape: (37, 91091)
    ✓ Random_24 (pose=(0.8382606494565734, -1.1954721803228476, 0.3789765107981333)): shape (37, 800, 800)
      Valid pixels: 101410/640000 (15.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=257982, num_faces=257984
      Valid probs shape: (37, 101410)
    ✓ Random_25 (pose=(-1.126363950008476, 2.763802755856699, -1.234166327806183)): shape (37, 800, 800)
      Valid pixels: 65838/640000 (10.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2733, max=257771, num_faces=257984
      Valid probs shape: (37, 65838)
    ✓ Random_26 (pose=(2.823482212169182, 0.8495841847879806, 2.0980019875432943)): shape (37, 800, 800)
      Valid pixels: 65716/640000 (10.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=929, max=257980, num_faces=257984
      Valid probs shape: (37, 65716)
    ✓ Random_27 (pose=(-0.6094502841580143, -1.0002263882064892, 0.14808652545342849)): shape (37, 800, 800)
      Valid pixels: 65675/640000 (10.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=3, max=257982, num_faces=257984
      Valid probs shape: (37, 65675)
    ✓ Random_28 (pose=(2.9843621895139574, 2.283020987451091, 1.5799570854477967)): shape (37, 800, 800)
      Valid pixels: 80475/640000 (12.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=257975, num_faces=257984
      Valid probs shape: (37, 80475)
    ✓ Random_29 (pose=(-0.5720941044910477, 0.24191255383168597, -0.4591702547057439)): shape (37, 800, 800)
      Valid pixels: 64219/640000 (10.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=0, max=256956, num_faces=257984
      Valid probs shape: (37, 64219)
    ✓ Random_30 (pose=(1.15283952792828, 2.094203592331265, -0.013738443905011)): shape (37, 800, 800)
      Valid pixels: 89111/640000 (13.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=118, max=257979, num_faces=257984
      Valid probs shape: (37, 89111)
    ✓ Random_31 (pose=(2.884288639053862, 0.9633081981958052, 1.7662039914506753)): shape (37, 800, 800)
      Valid pixels: 75271/640000 (11.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=307, max=257983, num_faces=257984
      Valid probs shape: (37, 75271)
    ✓ Random_32 (pose=(2.2474219028059395, -1.3443661892754557, -1.3289390545246873)): shape (37, 800, 800)
      Valid pixels: 98099/640000 (15.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=257982, num_faces=257984
      Valid probs shape: (37, 98099)
    ✓ Random_33 (pose=(0.9615597685158486, -2.5201648924458833, -2.681591321589503)): shape (37, 800, 800)
      Valid pixels: 90241/640000 (14.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=776, max=257980, num_faces=257984
      Valid probs shape: (37, 90241)
    ✓ Random_34 (pose=(0.5849646161224107, 1.306752171182012, -0.3031127944815206)): shape (37, 800, 800)
      Valid pixels: 78080/640000 (12.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=257943, num_faces=257984
      Valid probs shape: (37, 78080)
    ✓ Random_35 (pose=(0.4307115885087138, 1.4055180081270002, 2.713891905581473)): shape (37, 800, 800)
      Valid pixels: 73553/640000 (11.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=257981, num_faces=257984
      Valid probs shape: (37, 73553)
    ✓ Random_36 (pose=(0.904787438482689, -2.401078974749301, -2.117319016757019)): shape (37, 800, 800)
      Valid pixels: 78524/640000 (12.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1826, max=257980, num_faces=257984
      Valid probs shape: (37, 78524)
    ✓ Random_37 (pose=(-0.08381352686439758, 0.4780182493460181, 2.887031496868839)): shape (37, 800, 800)
      Valid pixels: 51510/640000 (8.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=257975, num_faces=257984
      Valid probs shape: (37, 51510)
    ✓ Random_38 (pose=(-1.4495491091805903, -1.1297055245702396, -0.8775060849545384)): shape (37, 800, 800)
      Valid pixels: 94681/640000 (14.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=257774, num_faces=257984
      Valid probs shape: (37, 94681)
    ✓ Random_39 (pose=(-0.8762294847001701, -2.3569691631948873, -1.2859787884906835)): shape (37, 800, 800)
      Valid pixels: 91629/640000 (14.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1152, max=257983, num_faces=257984
      Valid probs shape: (37, 91629)
    P stats: min=0.0000, max=0.9999, mean=0.0260
    Non-zero vertices: 123994/128994
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 5000 1693 1162 3635    0 2201  982 5270 5351]
  Ground Truth Stats:
    Labels shape: (128994,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-6/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7946
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8407
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8414

  RESULTS:
  RAW:         median(top-10)=0.9194, mean(top-10)=0.9197, median(all)=0.8531, mean(all)=0.7946
  + SMOOTHING: median(top-10)=0.9476, mean(top-10)=0.9393, median(all)=0.8740, mean(all)=0.8407 [+0.0282]
  + MRF:       median(top-10)=0.9477, mean(top-10)=0.9396, median(all)=0.8746, mean(all)=0.8414 [+0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0283

================================================================================
Subject: MMRR-21-7
================================================================================
  Step 0: Generating predictions with V2 model (40 random views)...
  Mesh: 148998 vertices, 297992 faces
  Generating 40 random views...
  Generating predictions for 40 views (continuous camera pose)...
    ✓ Random_0 (pose=(-1.2837508775310273, -0.010509589920322693, -1.4410976938256355)): shape (37, 800, 800)
      Valid pixels: 58149/640000 (9.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=9, max=297878, num_faces=297992
      Valid probs shape: (37, 58149)
    ✓ Random_1 (pose=(2.450268780694417, -1.7344568274014485, -0.3907456287083635)): shape (37, 800, 800)
      Valid pixels: 78382/640000 (12.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=297820, num_faces=297992
      Valid probs shape: (37, 78382)
    ✓ Random_2 (pose=(0.9442503215901938, -1.3077682408228741, 0.063354343713244)): shape (37, 800, 800)
      Valid pixels: 90875/640000 (14.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=297955, num_faces=297992
      Valid probs shape: (37, 90875)
    ✓ Random_3 (pose=(2.207762965836615, -2.853079451905197, 0.300955847660056)): shape (37, 800, 800)
      Valid pixels: 69668/640000 (10.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=297824, num_faces=297992
      Valid probs shape: (37, 69668)
    ✓ Random_4 (pose=(2.2028347415103067, -0.07980702065519774, 3.014660262114818)): shape (37, 800, 800)
      Valid pixels: 79267/640000 (12.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2067, max=297991, num_faces=297992
      Valid probs shape: (37, 79267)
    ✓ Random_5 (pose=(0.26365387275210406, 0.1404376687846285, -1.8886750803893042)): shape (37, 800, 800)
      Valid pixels: 40352/640000 (6.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=297824, num_faces=297992
      Valid probs shape: (37, 40352)
    ✓ Random_6 (pose=(-1.581301901482532, -0.7955748121619983, 1.7930929946602614)): shape (37, 800, 800)
      Valid pixels: 64381/640000 (10.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=297956, num_faces=297992
      Valid probs shape: (37, 64381)
    ✓ Random_7 (pose=(0.709804898724093, 1.7707071176118614, -0.12974501733286825)): shape (37, 800, 800)
      Valid pixels: 70069/640000 (10.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=16, max=297721, num_faces=297992
      Valid probs shape: (37, 70069)
    ✓ Random_8 (pose=(-0.7578891155648457, -1.1705410708706163, -1.942117816156411)): shape (37, 800, 800)
      Valid pixels: 70351/640000 (11.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=297878, num_faces=297992
      Valid probs shape: (37, 70351)
    ✓ Random_9 (pose=(-1.7350968366962534, 1.7052456077005402, -0.6669735142733821)): shape (37, 800, 800)
      Valid pixels: 89152/640000 (13.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=32, max=297991, num_faces=297992
      Valid probs shape: (37, 89152)
    ✓ Random_10 (pose=(2.043837841387081, 3.038582412814102, -3.1402832492969766)): shape (37, 800, 800)
      Valid pixels: 78827/640000 (12.3%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=9, max=297954, num_faces=297992
      Valid probs shape: (37, 78827)
    ✓ Random_11 (pose=(-1.817880166080184, -0.3876784236220683, -1.0442924268073002)): shape (37, 800, 800)
      Valid pixels: 72516/640000 (11.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=41, max=297934, num_faces=297992
      Valid probs shape: (37, 72516)
    ✓ Random_12 (pose=(-0.015555095786782047, 1.1899990821413553, 1.2085947527442507)): shape (37, 800, 800)
      Valid pixels: 84735/640000 (13.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=297954, num_faces=297992
      Valid probs shape: (37, 84735)
    ✓ Random_13 (pose=(-1.380169419654772, -1.2431277653297506, -1.6679904649610782)): shape (37, 800, 800)
      Valid pixels: 56469/640000 (8.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=297878, num_faces=297992
      Valid probs shape: (37, 56469)
    ✓ Random_14 (pose=(-0.18467915626260245, 3.070579951794218, 0.08582180715806498)): shape (37, 800, 800)
      Valid pixels: 48153/640000 (7.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=79426, max=297991, num_faces=297992
      Valid probs shape: (37, 48153)
    ✓ Random_15 (pose=(-1.4735438190062742, -1.7359510667134677, -0.6640045387825793)): shape (37, 800, 800)
      Valid pixels: 88685/640000 (13.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=297979, num_faces=297992
      Valid probs shape: (37, 88685)
    ✓ Random_16 (pose=(2.9642497505128924, -0.7546186116748013, 2.098170619656548)): shape (37, 800, 800)
      Valid pixels: 70360/640000 (11.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4094, max=297991, num_faces=297992
      Valid probs shape: (37, 70360)
    ✓ Random_17 (pose=(-2.9652054261914076, -1.7584476061598544, -2.706524834866433)): shape (37, 800, 800)
      Valid pixels: 81159/640000 (12.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=297956, num_faces=297992
      Valid probs shape: (37, 81159)
    ✓ Random_18 (pose=(-2.3639891660326535, -2.9706364772379583, 2.7232924341007685)): shape (37, 800, 800)
      Valid pixels: 69565/640000 (10.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=297893, num_faces=297992
      Valid probs shape: (37, 69565)
    ✓ Random_19 (pose=(0.7612967886487931, 2.920543094719335, -3.0191637221631757)): shape (37, 800, 800)
      Valid pixels: 69321/640000 (10.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3226, max=297991, num_faces=297992
      Valid probs shape: (37, 69321)
    ✓ Random_20 (pose=(0.00023961950108208896, 1.6374642497444816, 0.21003157634686165)): shape (37, 800, 800)
      Valid pixels: 62971/640000 (9.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=23, max=297877, num_faces=297992
      Valid probs shape: (37, 62971)
    ✓ Random_21 (pose=(1.9433649869027771, -2.366866309111445, 2.763504710322226)): shape (37, 800, 800)
      Valid pixels: 83922/640000 (13.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=297979, num_faces=297992
      Valid probs shape: (37, 83922)
    ✓ Random_22 (pose=(2.2080833096011796, 0.8127398057591337, 2.3515724454511133)): shape (37, 800, 800)
      Valid pixels: 63563/640000 (9.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=750, max=297982, num_faces=297992
      Valid probs shape: (37, 63563)
    ✓ Random_23 (pose=(1.2160763289533056, 1.7251434223351696, 1.1874462351797446)): shape (37, 800, 800)
      Valid pixels: 53847/640000 (8.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=9, max=297878, num_faces=297992
      Valid probs shape: (37, 53847)
    ✓ Random_24 (pose=(-0.756768047831935, 1.3343116435694693, -0.3421774192593725)): shape (37, 800, 800)
      Valid pixels: 73249/640000 (11.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=297878, num_faces=297992
      Valid probs shape: (37, 73249)
    ✓ Random_25 (pose=(0.3397456123974245, 3.0743915213498756, -1.653349128963026)): shape (37, 800, 800)
      Valid pixels: 40026/640000 (6.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=401, max=297991, num_faces=297992
      Valid probs shape: (37, 40026)
    ✓ Random_26 (pose=(1.3366886663043438, 0.3681305319215076, -0.24981607709167752)): shape (37, 800, 800)
      Valid pixels: 91529/640000 (14.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=297815, num_faces=297992
      Valid probs shape: (37, 91529)
    ✓ Random_27 (pose=(-1.6795734237306958, -0.3714943762091849, 2.3519433365253652)): shape (37, 800, 800)
      Valid pixels: 86369/640000 (13.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=32, max=297956, num_faces=297992
      Valid probs shape: (37, 86369)
    ✓ Random_28 (pose=(-2.8178364882859133, -0.3701869269446538, 1.668507775556443)): shape (37, 800, 800)
      Valid pixels: 52730/640000 (8.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3834, max=297991, num_faces=297992
      Valid probs shape: (37, 52730)
    ✓ Random_29 (pose=(1.7131403173384605, 1.9330842207214927, 2.7552179592630743)): shape (37, 800, 800)
      Valid pixels: 88995/640000 (13.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=20, max=297980, num_faces=297992
      Valid probs shape: (37, 88995)
    ✓ Random_30 (pose=(-0.7221813030300055, -0.8181761733659827, -2.411412671927473)): shape (37, 800, 800)
      Valid pixels: 52538/640000 (8.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=297878, num_faces=297992
      Valid probs shape: (37, 52538)
    ✓ Random_31 (pose=(-1.0417663459742528, -1.647612089879849, -1.0156427375279318)): shape (37, 800, 800)
      Valid pixels: 89232/640000 (13.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=31, max=297991, num_faces=297992
      Valid probs shape: (37, 89232)
    ✓ Random_32 (pose=(-2.001381650086245, 1.151215818501223, 0.36449268211270747)): shape (37, 800, 800)
      Valid pixels: 67388/640000 (10.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=39, max=297956, num_faces=297992
      Valid probs shape: (37, 67388)
    ✓ Random_33 (pose=(0.1507001936722605, 0.8627887567515522, -2.1295244424558613)): shape (37, 800, 800)
      Valid pixels: 70862/640000 (11.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=297952, num_faces=297992
      Valid probs shape: (37, 70862)
    ✓ Random_34 (pose=(-0.2723943909511277, 2.154003787811236, -0.6582832885202481)): shape (37, 800, 800)
      Valid pixels: 54099/640000 (8.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=57, max=297986, num_faces=297992
      Valid probs shape: (37, 54099)
    ✓ Random_35 (pose=(0.9222799454621518, -2.6603048814939996, 0.7674662934759415)): shape (37, 800, 800)
      Valid pixels: 70557/640000 (11.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=54, max=297722, num_faces=297992
      Valid probs shape: (37, 70557)
    ✓ Random_36 (pose=(-0.35351195222330567, 0.4259123867695016, -0.7884999618396975)): shape (37, 800, 800)
      Valid pixels: 46417/640000 (7.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=291912, num_faces=297992
      Valid probs shape: (37, 46417)
    ✓ Random_37 (pose=(1.7864970157271136, -1.7518551611211541, 2.667458538208816)): shape (37, 800, 800)
      Valid pixels: 88530/640000 (13.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=43, max=297991, num_faces=297992
      Valid probs shape: (37, 88530)
    ✓ Random_38 (pose=(2.630104606186591, 2.891578631355432, -0.017455847603609076)): shape (37, 800, 800)
      Valid pixels: 60132/640000 (9.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=297823, num_faces=297992
      Valid probs shape: (37, 60132)
    ✓ Random_39 (pose=(-2.3462108771753476, -1.3885987563034434, 0.18818171716130783)): shape (37, 800, 800)
      Valid pixels: 88289/640000 (13.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=79, max=297991, num_faces=297992
      Valid probs shape: (37, 88289)
    P stats: min=0.0000, max=1.0000, mean=0.0256
    Non-zero vertices: 140961/148998
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 8037 1041 1416 3490    0 2210 1097 5183 6373]
  Ground Truth Stats:
    Labels shape: (148998,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-7/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7946
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8422
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8423

  RESULTS:
  RAW:         median(top-10)=0.9197, mean(top-10)=0.9198, median(all)=0.8495, mean(all)=0.7946
  + SMOOTHING: median(top-10)=0.9332, mean(top-10)=0.9351, median(all)=0.8969, mean(all)=0.8422 [+0.0135]
  + MRF:       median(top-10)=0.9333, mean(top-10)=0.9352, median(all)=0.8976, mean(all)=0.8423 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0137

================================================================================
Subject: MMRR-21-8
================================================================================
  Step 0: Generating predictions with V2 model (40 random views)...
  Mesh: 124399 vertices, 248794 faces
  Generating 40 random views...
  Generating predictions for 40 views (continuous camera pose)...
    ✓ Random_0 (pose=(0.10519203364913299, -1.8357068551339195, -3.025202305402202)): shape (37, 800, 800)
      Valid pixels: 66524/640000 (10.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1067, max=248570, num_faces=248794
      Valid probs shape: (37, 66524)
    ✓ Random_1 (pose=(-0.02450391687909903, -0.479262922642798, 3.074810608094219)): shape (37, 800, 800)
      Valid pixels: 48717/640000 (7.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=247416, num_faces=248794
      Valid probs shape: (37, 48717)
    ✓ Random_2 (pose=(-0.28639641606515065, -1.295152296410498, 0.07414169337837073)): shape (37, 800, 800)
      Valid pixels: 61746/640000 (9.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=248790, num_faces=248794
      Valid probs shape: (37, 61746)
    ✓ Random_3 (pose=(2.4193635753356, 1.190601310436393, 2.091619964598614)): shape (37, 800, 800)
      Valid pixels: 61577/640000 (9.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=10, max=248776, num_faces=248794
      Valid probs shape: (37, 61577)
    ✓ Random_4 (pose=(2.6439621598291465, -0.4651911331698808, -0.14104392535403631)): shape (37, 800, 800)
      Valid pixels: 61956/640000 (9.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=39, max=248787, num_faces=248794
      Valid probs shape: (37, 61956)
    ✓ Random_5 (pose=(-1.5326562890636597, 0.9692907021132804, -2.301218053849943)): shape (37, 800, 800)
      Valid pixels: 74387/640000 (11.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=248777, num_faces=248794
      Valid probs shape: (37, 74387)
    ✓ Random_6 (pose=(1.6838152611594817, 2.7630555130434686, 1.9611004893359079)): shape (37, 800, 800)
      Valid pixels: 74817/640000 (11.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=248569, num_faces=248794
      Valid probs shape: (37, 74817)
    ✓ Random_7 (pose=(1.4070738649932446, 0.7429336389884873, 2.8724332187649324)): shape (37, 800, 800)
      Valid pixels: 95071/640000 (14.9%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=6, max=248790, num_faces=248794
      Valid probs shape: (37, 95071)
    ✓ Random_8 (pose=(-1.7803562418848076, -1.6104623892221799, -1.8017090195528678)): shape (37, 800, 800)
      Valid pixels: 66396/640000 (10.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=248778, num_faces=248794
      Valid probs shape: (37, 66396)
    ✓ Random_9 (pose=(-0.2659771284844936, 0.02054592885672335, -0.8213431968025922)): shape (37, 800, 800)
      Valid pixels: 51425/640000 (8.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=248560, num_faces=248794
      Valid probs shape: (37, 51425)
    ✓ Random_10 (pose=(2.389418653079093, 2.1318112899374206, -3.122429123188425)): shape (37, 800, 800)
      Valid pixels: 90026/640000 (14.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=248568, num_faces=248794
      Valid probs shape: (37, 90026)
    ✓ Random_11 (pose=(-0.8870044699669974, 0.6725085607215351, 2.6909809387223094)): shape (37, 800, 800)
      Valid pixels: 79265/640000 (12.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=9, max=248793, num_faces=248794
      Valid probs shape: (37, 79265)
    ✓ Random_12 (pose=(-1.759372405807189, 2.4443725355769885, -1.8735960931175064)): shape (37, 800, 800)
      Valid pixels: 59533/640000 (9.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=248768, num_faces=248794
      Valid probs shape: (37, 59533)
    ✓ Random_13 (pose=(1.4221405402784226, -3.0272137510779067, 1.1338104651612815)): shape (37, 800, 800)
      Valid pixels: 66412/640000 (10.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=248777, num_faces=248794
      Valid probs shape: (37, 66412)
    ✓ Random_14 (pose=(0.5642619798845905, 2.8348827890480477, 0.2909139865145085)): shape (37, 800, 800)
      Valid pixels: 58130/640000 (9.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=39, max=248782, num_faces=248794
      Valid probs shape: (37, 58130)
    ✓ Random_15 (pose=(2.255738026684406, -1.5920056222408014, 2.170332302130473)): shape (37, 800, 800)
      Valid pixels: 97510/640000 (15.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=4, max=248570, num_faces=248794
      Valid probs shape: (37, 97510)
    ✓ Random_16 (pose=(0.34389526298883943, 0.18109281393354415, -2.4544541361747565)): shape (37, 800, 800)
      Valid pixels: 48952/640000 (7.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=248785, num_faces=248794
      Valid probs shape: (37, 48952)
    ✓ Random_17 (pose=(1.5266138280775827, 0.4941264946746098, -2.350749624762256)): shape (37, 800, 800)
      Valid pixels: 72552/640000 (11.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=17, max=248793, num_faces=248794
      Valid probs shape: (37, 72552)
    ✓ Random_18 (pose=(-2.7553807067035057, 0.4591621837462734, 1.7739919129906587)): shape (37, 800, 800)
      Valid pixels: 66390/640000 (10.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=56, max=248793, num_faces=248794
      Valid probs shape: (37, 66390)
    ✓ Random_19 (pose=(-2.9005692208828475, -2.0272728740743386, -0.7688049764717655)): shape (37, 800, 800)
      Valid pixels: 64363/640000 (10.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=248777, num_faces=248794
      Valid probs shape: (37, 64363)
    ✓ Random_20 (pose=(-1.5726842606837603, 1.604419614820749, 3.000470575329474)): shape (37, 800, 800)
      Valid pixels: 102958/640000 (16.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=14, max=248793, num_faces=248794
      Valid probs shape: (37, 102958)
    ✓ Random_21 (pose=(2.577327092562548, 2.940490196448253, 3.0853895950258607)): shape (37, 800, 800)
      Valid pixels: 69511/640000 (10.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=248570, num_faces=248794
      Valid probs shape: (37, 69511)
    ✓ Random_22 (pose=(2.7782316847226634, -0.6486280411240464, 2.568124844193296)): shape (37, 800, 800)
      Valid pixels: 71828/640000 (11.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4138, max=248788, num_faces=248794
      Valid probs shape: (37, 71828)
    ✓ Random_23 (pose=(1.8558639032287862, 2.6279059877605473, -2.8265891414514934)): shape (37, 800, 800)
      Valid pixels: 85882/640000 (13.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=248788, num_faces=248794
      Valid probs shape: (37, 85882)
    ✓ Random_24 (pose=(-1.5428118542672637, -0.8262414797062476, -2.780082843019057)): shape (37, 800, 800)
      Valid pixels: 89681/640000 (14.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=248777, num_faces=248794
      Valid probs shape: (37, 89681)
    ✓ Random_25 (pose=(-1.2716333760115959, 1.8021760963056668, -0.12233916679915957)): shape (37, 800, 800)
      Valid pixels: 98106/640000 (15.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=4, max=248573, num_faces=248794
      Valid probs shape: (37, 98106)
    ✓ Random_26 (pose=(3.1322792593360838, -1.3565993063504276, -1.8245904729837874)): shape (37, 800, 800)
      Valid pixels: 101900/640000 (15.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=35, max=248793, num_faces=248794
      Valid probs shape: (37, 101900)
    ✓ Random_27 (pose=(1.9461478439647406, -0.9016067787333917, 2.5253467731758548)): shape (37, 800, 800)
      Valid pixels: 96410/640000 (15.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=32, max=248573, num_faces=248794
      Valid probs shape: (37, 96410)
    ✓ Random_28 (pose=(0.04165322014792627, -1.3722629057917546, -0.9466118933362972)): shape (37, 800, 800)
      Valid pixels: 74339/640000 (11.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=248789, num_faces=248794
      Valid probs shape: (37, 74339)
    ✓ Random_29 (pose=(2.6810708037360538, -1.3423722656280666, 1.2983651001197218)): shape (37, 800, 800)
      Valid pixels: 92770/640000 (14.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=355, max=248573, num_faces=248794
      Valid probs shape: (37, 92770)
    ✓ Random_30 (pose=(2.0869201384330154, 0.9110356029766367, -0.9732092546822462)): shape (37, 800, 800)
      Valid pixels: 66419/640000 (10.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=110, max=248793, num_faces=248794
      Valid probs shape: (37, 66419)
    ✓ Random_31 (pose=(-2.7539253280563187, -1.061843942632113, 2.636127017255058)): shape (37, 800, 800)
      Valid pixels: 60432/640000 (9.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=296, max=248790, num_faces=248794
      Valid probs shape: (37, 60432)
    ✓ Random_32 (pose=(-2.4767861326062217, -0.5793855016805316, -2.8051473907672557)): shape (37, 800, 800)
      Valid pixels: 82318/640000 (12.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=39, max=248793, num_faces=248794
      Valid probs shape: (37, 82318)
    ✓ Random_33 (pose=(-1.0238471403520184, -2.2478672204147507, 0.9006407962636702)): shape (37, 800, 800)
      Valid pixels: 63893/640000 (10.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=221, max=248790, num_faces=248794
      Valid probs shape: (37, 63893)
    ✓ Random_34 (pose=(0.9304532282663898, -1.2165309917030458, -1.1345612275746855)): shape (37, 800, 800)
      Valid pixels: 61412/640000 (9.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=248791, num_faces=248794
      Valid probs shape: (37, 61412)
    ✓ Random_35 (pose=(-0.11682328475878423, -0.282554578212487, -3.032844435301127)): shape (37, 800, 800)
      Valid pixels: 46290/640000 (7.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=247416, num_faces=248794
      Valid probs shape: (37, 46290)
    ✓ Random_36 (pose=(2.8090895575509833, -0.3222199643776169, -2.3985618658112884)): shape (37, 800, 800)
      Valid pixels: 48477/640000 (7.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=499, max=248790, num_faces=248794
      Valid probs shape: (37, 48477)
    ✓ Random_37 (pose=(-2.4409909783163184, -0.6379369579326282, -1.5812043325217846)): shape (37, 800, 800)
      Valid pixels: 63793/640000 (10.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=54, max=248777, num_faces=248794
      Valid probs shape: (37, 63793)
    ✓ Random_38 (pose=(0.42828021948540584, -0.4535964675073605, 1.934800210280775)): shape (37, 800, 800)
      Valid pixels: 54000/640000 (8.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=248776, num_faces=248794
      Valid probs shape: (37, 54000)
    ✓ Random_39 (pose=(0.03745588178543535, -0.8250897172058651, 2.0250330125152356)): shape (37, 800, 800)
      Valid pixels: 70968/640000 (11.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=248778, num_faces=248794
      Valid probs shape: (37, 70968)
    P stats: min=0.0000, max=0.9999, mean=0.0260
    Non-zero vertices: 119493/124399
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 4906 1074 1099 3284    0 2149 1208 3991 6614]
  Ground Truth Stats:
    Labels shape: (124399,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-8/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7851
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8280
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8280

  RESULTS:
  RAW:         median(top-10)=0.9145, mean(top-10)=0.9177, median(all)=0.8572, mean(all)=0.7851
  + SMOOTHING: median(top-10)=0.9302, mean(top-10)=0.9305, median(all)=0.8781, mean(all)=0.8280 [+0.0157]
  + MRF:       median(top-10)=0.9304, mean(top-10)=0.9305, median(all)=0.8780, mean(all)=0.8280 [+0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0158

================================================================================
Subject: MMRR-21-9
================================================================================
  Step 0: Generating predictions with V2 model (40 random views)...
  Mesh: 131827 vertices, 263650 faces
  Generating 40 random views...
  Generating predictions for 40 views (continuous camera pose)...
    ✓ Random_0 (pose=(0.9190532182914533, -0.5321945658159639, -0.9247709443103536)): shape (37, 800, 800)
      Valid pixels: 66104/640000 (10.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=263545, num_faces=263650
      Valid probs shape: (37, 66104)
    ✓ Random_1 (pose=(-0.872378753548273, 1.4311714110589895, 1.9522824578092335)): shape (37, 800, 800)
      Valid pixels: 68623/640000 (10.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=12, max=263646, num_faces=263650
      Valid probs shape: (37, 68623)
    ✓ Random_2 (pose=(-1.275818524364419, 1.662580602357381, -2.9607855410487485)): shape (37, 800, 800)
      Valid pixels: 104331/640000 (16.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=27, max=263642, num_faces=263650
      Valid probs shape: (37, 104331)
    ✓ Random_3 (pose=(-2.7054009559884986, 2.748538951754754, -1.9250940057005128)): shape (37, 800, 800)
      Valid pixels: 62157/640000 (9.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=261559, num_faces=263650
      Valid probs shape: (37, 62157)
    ✓ Random_4 (pose=(2.368620759913499, 1.3573664709056485, -1.0566367305265203)): shape (37, 800, 800)
      Valid pixels: 69662/640000 (10.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=15, max=263646, num_faces=263650
      Valid probs shape: (37, 69662)
    ✓ Random_5 (pose=(-2.670509020870405, -2.387186744937448, 0.3379537449834835)): shape (37, 800, 800)
      Valid pixels: 83889/640000 (13.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=263639, num_faces=263650
      Valid probs shape: (37, 83889)
    ✓ Random_6 (pose=(-0.3169867188791424, -1.1292959830390354, 1.2679950069367614)): shape (37, 800, 800)
      Valid pixels: 93575/640000 (14.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=263649, num_faces=263650
      Valid probs shape: (37, 93575)
    ✓ Random_7 (pose=(-2.6476506265263002, -1.9262903183767035, -1.2934514225164486)): shape (37, 800, 800)
      Valid pixels: 75061/640000 (11.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=263648, num_faces=263650
      Valid probs shape: (37, 75061)
    ✓ Random_8 (pose=(-3.0038385892116453, 1.0495061595597077, -1.3876567957128618)): shape (37, 800, 800)
      Valid pixels: 89026/640000 (13.9%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=3140, max=263647, num_faces=263650
      Valid probs shape: (37, 89026)
    ✓ Random_9 (pose=(-0.6445864741015366, -0.4296347601460391, -1.3193617216634979)): shape (37, 800, 800)
      Valid pixels: 76776/640000 (12.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=263639, num_faces=263650
      Valid probs shape: (37, 76776)
    ✓ Random_10 (pose=(2.608071929175992, 0.3405589485190448, 2.831959441968527)): shape (37, 800, 800)
      Valid pixels: 74046/640000 (11.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=29205, max=263648, num_faces=263650
      Valid probs shape: (37, 74046)
    ✓ Random_11 (pose=(2.716350635114811, -1.810953174016224, -0.3532367636895173)): shape (37, 800, 800)
      Valid pixels: 76529/640000 (12.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=263642, num_faces=263650
      Valid probs shape: (37, 76529)
    ✓ Random_12 (pose=(0.8407686559661691, -0.6251458762254289, 1.3915126938789415)): shape (37, 800, 800)
      Valid pixels: 68949/640000 (10.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=263649, num_faces=263650
      Valid probs shape: (37, 68949)
    ✓ Random_13 (pose=(0.4881403632284962, 0.4916633771684329, 3.044327753510365)): shape (37, 800, 800)
      Valid pixels: 63532/640000 (9.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=263455, num_faces=263650
      Valid probs shape: (37, 63532)
    ✓ Random_14 (pose=(-0.19108519075065988, 2.478246365938946, 1.8989983952788636)): shape (37, 800, 800)
      Valid pixels: 70263/640000 (11.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2559, max=263649, num_faces=263650
      Valid probs shape: (37, 70263)
    ✓ Random_15 (pose=(-1.1479972809216872, 0.4473602682570954, -2.694966732355625)): shape (37, 800, 800)
      Valid pixels: 90144/640000 (14.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=263645, num_faces=263650
      Valid probs shape: (37, 90144)
    ✓ Random_16 (pose=(-0.6153809375939905, 0.6944552201304788, -1.8092879565929125)): shape (37, 800, 800)
      Valid pixels: 73129/640000 (11.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=263648, num_faces=263650
      Valid probs shape: (37, 73129)
    ✓ Random_17 (pose=(2.6277843093089954, -0.3616853939554625, 0.9058052480075203)): shape (37, 800, 800)
      Valid pixels: 52329/640000 (8.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=746, max=263648, num_faces=263650
      Valid probs shape: (37, 52329)
    ✓ Random_18 (pose=(-0.6867810976662438, -2.0290361102452064, 2.5405640189306977)): shape (37, 800, 800)
      Valid pixels: 91853/640000 (14.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=284, max=263648, num_faces=263650
      Valid probs shape: (37, 91853)
    ✓ Random_19 (pose=(3.107704590823867, -1.2282196635621951, 1.515281488304745)): shape (37, 800, 800)
      Valid pixels: 94368/640000 (14.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=133, max=263646, num_faces=263650
      Valid probs shape: (37, 94368)
    ✓ Random_20 (pose=(0.7802322836907485, 0.5865826790530666, -2.1262581688934032)): shape (37, 800, 800)
      Valid pixels: 57071/640000 (8.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=2, max=263534, num_faces=263650
      Valid probs shape: (37, 57071)
    ✓ Random_21 (pose=(1.1579953380057901, -2.7998321188269113, -1.656393158619866)): shape (37, 800, 800)
      Valid pixels: 68466/640000 (10.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=225, max=263645, num_faces=263650
      Valid probs shape: (37, 68466)
    ✓ Random_22 (pose=(-0.7065948078587434, 1.9339205717123695, -2.9940091648882365)): shape (37, 800, 800)
      Valid pixels: 101604/640000 (15.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=21, max=263649, num_faces=263650
      Valid probs shape: (37, 101604)
    ✓ Random_23 (pose=(-2.4440487077920583, 1.1710490791652362, -2.326924853531568)): shape (37, 800, 800)
      Valid pixels: 64913/640000 (10.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2723, max=263646, num_faces=263650
      Valid probs shape: (37, 64913)
    ✓ Random_24 (pose=(-1.0125548213667748, -0.09114525165135534, -2.9623982462553107)): shape (37, 800, 800)
      Valid pixels: 85229/640000 (13.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=263645, num_faces=263650
      Valid probs shape: (37, 85229)
    ✓ Random_25 (pose=(2.7276519638469976, 0.6165751106480055, -0.9436505925271419)): shape (37, 800, 800)
      Valid pixels: 61400/640000 (9.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1719, max=263648, num_faces=263650
      Valid probs shape: (37, 61400)
    ✓ Random_26 (pose=(-1.7240604343328627, -3.0083452295785165, -2.599578892711915)): shape (37, 800, 800)
      Valid pixels: 85161/640000 (13.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=263643, num_faces=263650
      Valid probs shape: (37, 85161)
    ✓ Random_27 (pose=(-1.103719482586334, -2.750510581309622, -3.0076398817968464)): shape (37, 800, 800)
      Valid pixels: 86596/640000 (13.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=303, max=263648, num_faces=263650
      Valid probs shape: (37, 86596)
    ✓ Random_28 (pose=(1.9165755695158175, 2.26978092177114, 1.489663107170176)): shape (37, 800, 800)
      Valid pixels: 66594/640000 (10.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=263646, num_faces=263650
      Valid probs shape: (37, 66594)
    ✓ Random_29 (pose=(-0.8748068381490448, -1.5220537233723228, -1.1365752453878657)): shape (37, 800, 800)
      Valid pixels: 101107/640000 (15.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=263647, num_faces=263650
      Valid probs shape: (37, 101107)
    ✓ Random_30 (pose=(-1.7515762072558059, -0.2269995961317126, 2.691682893695482)): shape (37, 800, 800)
      Valid pixels: 105464/640000 (16.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=26, max=263644, num_faces=263650
      Valid probs shape: (37, 105464)
    ✓ Random_31 (pose=(2.282743696309712, 1.5416347988358048, -1.5958378782455043)): shape (37, 800, 800)
      Valid pixels: 74478/640000 (11.6%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=1, max=263645, num_faces=263650
      Valid probs shape: (37, 74478)
    ✓ Random_32 (pose=(1.0879825764701785, 0.0005052581945683698, 2.934795196208036)): shape (37, 800, 800)
      Valid pixels: 90867/640000 (14.2%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=1, max=263639, num_faces=263650
      Valid probs shape: (37, 90867)
    ✓ Random_33 (pose=(-1.106877075093191, -0.6190777473649383, -1.095626024228069)): shape (37, 800, 800)
      Valid pixels: 91827/640000 (14.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=263639, num_faces=263650
      Valid probs shape: (37, 91827)
    ✓ Random_34 (pose=(-0.5261498275238274, 0.7786160470094448, 0.9642562183993002)): shape (37, 800, 800)
      Valid pixels: 79823/640000 (12.5%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=1, max=263639, num_faces=263650
      Valid probs shape: (37, 79823)
    ✓ Random_35 (pose=(0.6600426776117105, 0.19145111582171515, -2.1112657908252466)): shape (37, 800, 800)
      Valid pixels: 55350/640000 (8.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=263518, num_faces=263650
      Valid probs shape: (37, 55350)
    ✓ Random_36 (pose=(1.3588784532454428, 2.3716854288722136, 0.35266026917958193)): shape (37, 800, 800)
      Valid pixels: 85746/640000 (13.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=60, max=263647, num_faces=263650
      Valid probs shape: (37, 85746)
    ✓ Random_37 (pose=(0.5106059326866088, 2.6995839826414025, -0.5710416332866233)): shape (37, 800, 800)
      Valid pixels: 70277/640000 (11.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=805, max=263649, num_faces=263650
      Valid probs shape: (37, 70277)
    ✓ Random_38 (pose=(0.40854386881320304, 3.1017446596470943, -1.3561194079307195)): shape (37, 800, 800)
      Valid pixels: 50479/640000 (7.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=620, max=263649, num_faces=263650
      Valid probs shape: (37, 50479)
    ✓ Random_39 (pose=(3.0914984133741026, -1.3641260525243124, -1.6998154131034575)): shape (37, 800, 800)
      Valid pixels: 103867/640000 (16.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=64, max=263649, num_faces=263650
      Valid probs shape: (37, 103867)
    P stats: min=0.0000, max=1.0000, mean=0.0259
    Non-zero vertices: 126322/131827
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 5505 1261 1163 3408    0 1633 1091 4715 6071]
  Ground Truth Stats:
    Labels shape: (131827,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-9/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7949
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8426
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8429

  RESULTS:
  RAW:         median(top-10)=0.9111, mean(top-10)=0.9200, median(all)=0.8531, mean(all)=0.7949
  + SMOOTHING: median(top-10)=0.9297, mean(top-10)=0.9338, median(all)=0.8896, mean(all)=0.8426 [+0.0186]
  + MRF:       median(top-10)=0.9298, mean(top-10)=0.9341, median(all)=0.8900, mean(all)=0.8429 [+0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0187

================================================================================
Subject: MMRR-3T7T-2-1
================================================================================
  Step 0: Generating predictions with V2 model (40 random views)...
  Mesh: 150156 vertices, 300308 faces
  Generating 40 random views...
  Generating predictions for 40 views (continuous camera pose)...
    ✓ Random_0 (pose=(-0.6352001092556319, -0.3129865834875001, 1.908811653182375)): shape (37, 800, 800)
      Valid pixels: 73195/640000 (11.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=300100, num_faces=300308
      Valid probs shape: (37, 73195)
    ✓ Random_1 (pose=(1.6236019974126012, -1.1004085979162421, 0.6864902495134819)): shape (37, 800, 800)
      Valid pixels: 86080/640000 (13.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=300307, num_faces=300308
      Valid probs shape: (37, 86080)
    ✓ Random_2 (pose=(2.7664598588963143, -1.7576169527310717, 2.1497315528807626)): shape (37, 800, 800)
      Valid pixels: 96658/640000 (15.1%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=2, max=300279, num_faces=300308
      Valid probs shape: (37, 96658)
    ✓ Random_3 (pose=(-2.4110154978129077, 1.3326962853881543, -0.11587601472675724)): shape (37, 800, 800)
      Valid pixels: 81696/640000 (12.8%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=7, max=300279, num_faces=300308
      Valid probs shape: (37, 81696)
    ✓ Random_4 (pose=(2.274655748454858, 3.0485251573026746, -0.16167242613719957)): shape (37, 800, 800)
      Valid pixels: 90693/640000 (14.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=300300, num_faces=300308
      Valid probs shape: (37, 90693)
    ✓ Random_5 (pose=(0.8775540087832692, -3.090015062615979, 0.44727727438407605)): shape (37, 800, 800)
      Valid pixels: 82110/640000 (12.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=38, max=300307, num_faces=300308
      Valid probs shape: (37, 82110)
    ✓ Random_6 (pose=(2.26456584177612, 0.6531840473320165, -0.9257127181344651)): shape (37, 800, 800)
      Valid pixels: 77245/640000 (12.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=205, max=300307, num_faces=300308
      Valid probs shape: (37, 77245)
    ✓ Random_7 (pose=(1.156491114732824, 1.7278373222875771, -1.3862367697614069)): shape (37, 800, 800)
      Valid pixels: 102326/640000 (16.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=42, max=300305, num_faces=300308
      Valid probs shape: (37, 102326)
    ✓ Random_8 (pose=(0.5570514262323019, -0.08847840854325639, -2.147092982560857)): shape (37, 800, 800)
      Valid pixels: 61968/640000 (9.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=300045, num_faces=300308
      Valid probs shape: (37, 61968)
    ✓ Random_9 (pose=(1.535620022169586, -3.133113311749813, -3.054024940025594)): shape (37, 800, 800)
      Valid pixels: 100816/640000 (15.8%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=1, max=300279, num_faces=300308
      Valid probs shape: (37, 100816)
    ✓ Random_10 (pose=(0.8587230138035524, -0.5815562600608772, -0.5549589000889465)): shape (37, 800, 800)
      Valid pixels: 81098/640000 (12.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=300100, num_faces=300308
      Valid probs shape: (37, 81098)
    ✓ Random_11 (pose=(-2.3347798284059875, -1.939058634620929, 1.212692516228123)): shape (37, 800, 800)
      Valid pixels: 86211/640000 (13.5%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=1, max=300279, num_faces=300308
      Valid probs shape: (37, 86211)
    ✓ Random_12 (pose=(1.3623343766207343, 0.9988238685454611, -2.908034340164707)): shape (37, 800, 800)
      Valid pixels: 89453/640000 (14.0%)
      Probs stats: min=0.0000, max=0.9994, mean=0.0270
      Face IDs: min=6, max=300280, num_faces=300308
      Valid probs shape: (37, 89453)
    ✓ Random_13 (pose=(-2.4064596458493708, 1.4569062253612923, -3.1378291104888363)): shape (37, 800, 800)
      Valid pixels: 81204/640000 (12.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=300307, num_faces=300308
      Valid probs shape: (37, 81204)
    ✓ Random_14 (pose=(-2.5411715796342578, 1.4291724121487324, -1.9577254848874994)): shape (37, 800, 800)
      Valid pixels: 99295/640000 (15.5%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=1, max=300280, num_faces=300308
      Valid probs shape: (37, 99295)
    ✓ Random_15 (pose=(-1.7345782333461042, -2.127848984608825, -0.5645251121441417)): shape (37, 800, 800)
      Valid pixels: 109075/640000 (17.0%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=47, max=300280, num_faces=300308
      Valid probs shape: (37, 109075)
    ✓ Random_16 (pose=(0.4034832185517172, 2.5025921621614433, -0.46880612696258517)): shape (37, 800, 800)
      Valid pixels: 74025/640000 (11.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=42, max=300307, num_faces=300308
      Valid probs shape: (37, 74025)
    ✓ Random_17 (pose=(0.9342964733073762, -1.135430739789058, 1.6740409580745839)): shape (37, 800, 800)
      Valid pixels: 74021/640000 (11.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=300304, num_faces=300308
      Valid probs shape: (37, 74021)
    ✓ Random_18 (pose=(-2.7677511232857523, 2.2786138130224645, -2.3290403897608303)): shape (37, 800, 800)
      Valid pixels: 80956/640000 (12.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=299514, num_faces=300308
      Valid probs shape: (37, 80956)
    ✓ Random_19 (pose=(-0.8224669418301986, 2.201657880050977, 0.7924656594745234)): shape (37, 800, 800)
      Valid pixels: 95745/640000 (15.0%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=315, max=300280, num_faces=300308
      Valid probs shape: (37, 95745)
    ✓ Random_20 (pose=(-2.09038727764586, 1.4138274883608482, 1.3669374124431535)): shape (37, 800, 800)
      Valid pixels: 86401/640000 (13.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=43, max=300299, num_faces=300308
      Valid probs shape: (37, 86401)
    ✓ Random_21 (pose=(1.809300399971094, -1.9782311013796456, 1.6682960188485643)): shape (37, 800, 800)
      Valid pixels: 85673/640000 (13.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=33, max=300280, num_faces=300308
      Valid probs shape: (37, 85673)
    ✓ Random_22 (pose=(-2.51892852280516, 1.9986398644971235, 2.057497297557987)): shape (37, 800, 800)
      Valid pixels: 108032/640000 (16.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=300301, num_faces=300308
      Valid probs shape: (37, 108032)
    ✓ Random_23 (pose=(2.068340231223453, 1.3725852893100212, -0.015554126570329174)): shape (37, 800, 800)
      Valid pixels: 115740/640000 (18.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=39, max=300307, num_faces=300308
      Valid probs shape: (37, 115740)
    ✓ Random_24 (pose=(1.4079056448948934, -1.7079516587406354, 1.1769705550933374)): shape (37, 800, 800)
      Valid pixels: 76081/640000 (11.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=300307, num_faces=300308
      Valid probs shape: (37, 76081)
    ✓ Random_25 (pose=(0.6058018232929099, 1.444820837953534, -1.0362631729453007)): shape (37, 800, 800)
      Valid pixels: 113261/640000 (17.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=300307, num_faces=300308
      Valid probs shape: (37, 113261)
    ✓ Random_26 (pose=(1.6042976922339482, -2.2717650959209967, -0.7948360448544007)): shape (37, 800, 800)
      Valid pixels: 109018/640000 (17.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=42, max=300307, num_faces=300308
      Valid probs shape: (37, 109018)
    ✓ Random_27 (pose=(-2.581281712488133, -2.797031810419945, -1.992669801224661)): shape (37, 800, 800)
      Valid pixels: 70314/640000 (11.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=300303, num_faces=300308
      Valid probs shape: (37, 70314)
    ✓ Random_28 (pose=(-3.0512535355111834, 2.9981209294275546, -0.19948370566426776)): shape (37, 800, 800)
      Valid pixels: 52973/640000 (8.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=0, max=299529, num_faces=300308
      Valid probs shape: (37, 52973)
    ✓ Random_29 (pose=(0.1958719040346053, -2.2974119959566495, 2.9749193475539304)): shape (37, 800, 800)
      Valid pixels: 60593/640000 (9.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=22094, max=299514, num_faces=300308
      Valid probs shape: (37, 60593)
    ✓ Random_30 (pose=(1.1098478969314947, -3.0344957530593537, -1.8627383634011923)): shape (37, 800, 800)
      Valid pixels: 72558/640000 (11.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2905, max=300279, num_faces=300308
      Valid probs shape: (37, 72558)
    ✓ Random_31 (pose=(-1.0224564428413285, 1.532132904704003, 2.4721211077375838)): shape (37, 800, 800)
      Valid pixels: 87660/640000 (13.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=43, max=300299, num_faces=300308
      Valid probs shape: (37, 87660)
    ✓ Random_32 (pose=(-1.4873987656215535, -1.4569497641967326, 1.5877289554133052)): shape (37, 800, 800)
      Valid pixels: 71769/640000 (11.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=76, max=300307, num_faces=300308
      Valid probs shape: (37, 71769)
    ✓ Random_33 (pose=(-2.5942574734944617, -1.2699666153059566, -1.4161728909532663)): shape (37, 800, 800)
      Valid pixels: 84161/640000 (13.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=14, max=300307, num_faces=300308
      Valid probs shape: (37, 84161)
    ✓ Random_34 (pose=(-1.053847281236115, 2.169524388802441, -0.5876640304980887)): shape (37, 800, 800)
      Valid pixels: 95388/640000 (14.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=634, max=300280, num_faces=300308
      Valid probs shape: (37, 95388)
    ✓ Random_35 (pose=(2.8788980104540522, 1.0417711866916406, 2.5461500977171427)): shape (37, 800, 800)
      Valid pixels: 63574/640000 (9.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=77, max=300307, num_faces=300308
      Valid probs shape: (37, 63574)
    ✓ Random_36 (pose=(-1.1004112301815785, -1.2036919272326532, -3.09873015803108)): shape (37, 800, 800)
      Valid pixels: 94867/640000 (14.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=300307, num_faces=300308
      Valid probs shape: (37, 94867)
    ✓ Random_37 (pose=(1.1630092774367542, 2.4270147810474505, 2.9906981212868144)): shape (37, 800, 800)
      Valid pixels: 97768/640000 (15.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=70, max=300280, num_faces=300308
      Valid probs shape: (37, 97768)
    ✓ Random_38 (pose=(0.18129456700557522, 2.0238089864749043, -2.153898571204184)): shape (37, 800, 800)
      Valid pixels: 105765/640000 (16.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=43, max=300307, num_faces=300308
      Valid probs shape: (37, 105765)
    ✓ Random_39 (pose=(-1.3934533236127593, 2.058369364538624, 1.6049336751786125)): shape (37, 800, 800)
      Valid pixels: 70200/640000 (11.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=113, max=300223, num_faces=300308
      Valid probs shape: (37, 70200)
    P stats: min=0.0000, max=0.9999, mean=0.0256
    Non-zero vertices: 142211/150156
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 7945 1335 1044 4128    0 1786  763 5938 7458]
  Ground Truth Stats:
    Labels shape: (150156,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-3T7T-2-1/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7604
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8060
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8063

  RESULTS:
  RAW:         median(top-10)=0.9194, mean(top-10)=0.9199, median(all)=0.8335, mean(all)=0.7604
  + SMOOTHING: median(top-10)=0.9379, mean(top-10)=0.9396, median(all)=0.8527, mean(all)=0.8060 [+0.0185]
  + MRF:       median(top-10)=0.9381, mean(top-10)=0.9398, median(all)=0.8532, mean(all)=0.8063 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0187

================================================================================
Subject: MMRR-3T7T-2-2
================================================================================
  Step 0: Generating predictions with V2 model (40 random views)...
  Mesh: 135252 vertices, 270500 faces
  Generating 40 random views...
  Generating predictions for 40 views (continuous camera pose)...
    ✓ Random_0 (pose=(-2.5022769932779054, -2.818643328530078, 1.766551808909404)): shape (37, 800, 800)
      Valid pixels: 59094/640000 (9.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=270231, num_faces=270500
      Valid probs shape: (37, 59094)
    ✓ Random_1 (pose=(0.12611217206350833, 0.051810701033685014, -2.6025130737292477)): shape (37, 800, 800)
      Valid pixels: 53553/640000 (8.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=270211, num_faces=270500
      Valid probs shape: (37, 53553)
    ✓ Random_2 (pose=(1.2196883396929055, 0.6776428193404769, -0.05959955099370884)): shape (37, 800, 800)
      Valid pixels: 91128/640000 (14.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=270404, num_faces=270500
      Valid probs shape: (37, 91128)
    ✓ Random_3 (pose=(-1.9250951374752492, -1.8509937406568504, -0.38380191288965904)): shape (37, 800, 800)
      Valid pixels: 94338/640000 (14.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=270498, num_faces=270500
      Valid probs shape: (37, 94338)
    ✓ Random_4 (pose=(2.4368209448868408, 2.663695935678846, -2.339710336488888)): shape (37, 800, 800)
      Valid pixels: 74721/640000 (11.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=270434, num_faces=270500
      Valid probs shape: (37, 74721)
    ✓ Random_5 (pose=(1.905727776460104, 1.147739913358472, -0.03294199719783242)): shape (37, 800, 800)
      Valid pixels: 102990/640000 (16.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=270436, num_faces=270500
      Valid probs shape: (37, 102990)
    ✓ Random_6 (pose=(-3.0173208254451027, 2.4914851721373843, 1.76621001084892)): shape (37, 800, 800)
      Valid pixels: 67806/640000 (10.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=270404, num_faces=270500
      Valid probs shape: (37, 67806)
    ✓ Random_7 (pose=(1.4009269655800027, -0.9378787387144651, 0.7017678538648839)): shape (37, 800, 800)
      Valid pixels: 81352/640000 (12.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=270404, num_faces=270500
      Valid probs shape: (37, 81352)
    ✓ Random_8 (pose=(-2.399257443482101, 0.7465249673772174, -2.729548248188102)): shape (37, 800, 800)
      Valid pixels: 67942/640000 (10.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=371, max=270498, num_faces=270500
      Valid probs shape: (37, 67942)
    ✓ Random_9 (pose=(2.771681598939936, -2.5297680905536284, 2.280327669545449)): shape (37, 800, 800)
      Valid pixels: 74592/640000 (11.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=3, max=269940, num_faces=270500
      Valid probs shape: (37, 74592)
    ✓ Random_10 (pose=(-2.4281112509294926, 1.010807097382715, 0.32411775060437886)): shape (37, 800, 800)
      Valid pixels: 67013/640000 (10.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1179, max=270498, num_faces=270500
      Valid probs shape: (37, 67013)
    ✓ Random_11 (pose=(0.32368371828758224, 0.20429383542553303, 2.208041760308636)): shape (37, 800, 800)
      Valid pixels: 64278/640000 (10.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=270222, num_faces=270500
      Valid probs shape: (37, 64278)
    ✓ Random_12 (pose=(0.9844955380301403, -2.5934796859817633, 1.51714742028277)): shape (37, 800, 800)
      Valid pixels: 66741/640000 (10.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=121, max=270498, num_faces=270500
      Valid probs shape: (37, 66741)
    ✓ Random_13 (pose=(1.7062285195728748, -2.6618793610960307, -3.117117029815427)): shape (37, 800, 800)
      Valid pixels: 89129/640000 (13.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=8, max=270498, num_faces=270500
      Valid probs shape: (37, 89129)
    ✓ Random_14 (pose=(1.9305445694856855, 0.3496114840486224, 0.35701485965172264)): shape (37, 800, 800)
      Valid pixels: 90498/640000 (14.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=270429, num_faces=270500
      Valid probs shape: (37, 90498)
    ✓ Random_15 (pose=(-1.3523216939851697, 1.4223189681386552, -2.5332258723196164)): shape (37, 800, 800)
      Valid pixels: 87691/640000 (13.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=270404, num_faces=270500
      Valid probs shape: (37, 87691)
    ✓ Random_16 (pose=(0.08318028546306744, -0.6120611708993855, -1.5202416783488506)): shape (37, 800, 800)
      Valid pixels: 70859/640000 (11.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=0, max=269940, num_faces=270500
      Valid probs shape: (37, 70859)
    ✓ Random_17 (pose=(0.6921009374652081, 2.3854642813802505, 0.6075257574804169)): shape (37, 800, 800)
      Valid pixels: 63535/640000 (9.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=392, max=270496, num_faces=270500
      Valid probs shape: (37, 63535)
    ✓ Random_18 (pose=(-0.2936851275632604, 2.864658731886566, -1.6165108396582208)): shape (37, 800, 800)
      Valid pixels: 57281/640000 (9.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=366, max=270491, num_faces=270500
      Valid probs shape: (37, 57281)
    ✓ Random_19 (pose=(-0.7067471167550887, 0.7825936319472504, -0.5131426719132741)): shape (37, 800, 800)
      Valid pixels: 73767/640000 (11.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=270481, num_faces=270500
      Valid probs shape: (37, 73767)
    ✓ Random_20 (pose=(1.2553840551430362, -0.19885810355588163, 2.341269902524962)): shape (37, 800, 800)
      Valid pixels: 89577/640000 (14.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=270498, num_faces=270500
      Valid probs shape: (37, 89577)
    ✓ Random_21 (pose=(2.6365901186604583, 1.2132482226684616, 2.869147385338036)): shape (37, 800, 800)
      Valid pixels: 70773/640000 (11.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=270499, num_faces=270500
      Valid probs shape: (37, 70773)
    ✓ Random_22 (pose=(-1.4673545287860974, -1.8271952478156772, 1.0215399969038144)): shape (37, 800, 800)
      Valid pixels: 69428/640000 (10.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=45, max=270446, num_faces=270500
      Valid probs shape: (37, 69428)
    ✓ Random_23 (pose=(2.7238105601253544, 0.7118916318043889, -1.8108382826672267)): shape (37, 800, 800)
      Valid pixels: 72741/640000 (11.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3463, max=270499, num_faces=270500
      Valid probs shape: (37, 72741)
    ✓ Random_24 (pose=(-1.1032760959963386, 2.18341271623253, -1.1606445812466213)): shape (37, 800, 800)
      Valid pixels: 62360/640000 (9.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=270499, num_faces=270500
      Valid probs shape: (37, 62360)
    ✓ Random_25 (pose=(-1.822903518342222, -2.8973588579697878, 0.5027378444046695)): shape (37, 800, 800)
      Valid pixels: 79796/640000 (12.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=270498, num_faces=270500
      Valid probs shape: (37, 79796)
    ✓ Random_26 (pose=(0.00926965123390966, -1.8692723595032201, 0.6832130321914418)): shape (37, 800, 800)
      Valid pixels: 92160/640000 (14.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=12, max=270491, num_faces=270500
      Valid probs shape: (37, 92160)
    ✓ Random_27 (pose=(-1.4985004255141288, 0.4697673731343799, -1.0262941265339731)): shape (37, 800, 800)
      Valid pixels: 85103/640000 (13.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=10, max=270499, num_faces=270500
      Valid probs shape: (37, 85103)
    ✓ Random_28 (pose=(2.5035394360409935, -2.1921795547178746, 1.7006667346682782)): shape (37, 800, 800)
      Valid pixels: 90059/640000 (14.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=270498, num_faces=270500
      Valid probs shape: (37, 90059)
    ✓ Random_29 (pose=(-1.8764289104336076, 0.7776046959340248, 2.8512274638510506)): shape (37, 800, 800)
      Valid pixels: 99818/640000 (15.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=10, max=270440, num_faces=270500
      Valid probs shape: (37, 99818)
    ✓ Random_30 (pose=(-2.519715901601769, 2.373901036711544, -0.5713141189067055)): shape (37, 800, 800)
      Valid pixels: 79173/640000 (12.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=270497, num_faces=270500
      Valid probs shape: (37, 79173)
    ✓ Random_31 (pose=(-0.362072300769654, -0.5096837025325827, 2.148249467780043)): shape (37, 800, 800)
      Valid pixels: 66167/640000 (10.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=270404, num_faces=270500
      Valid probs shape: (37, 66167)
    ✓ Random_32 (pose=(1.2977853757516176, -0.41183512978252645, -2.6494937123580184)): shape (37, 800, 800)
      Valid pixels: 80953/640000 (12.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=270498, num_faces=270500
      Valid probs shape: (37, 80953)
    ✓ Random_33 (pose=(-1.8101733974926806, -2.402520520863987, 2.99207330723769)): shape (37, 800, 800)
      Valid pixels: 100327/640000 (15.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=270404, num_faces=270500
      Valid probs shape: (37, 100327)
    ✓ Random_34 (pose=(-1.7872618397397915, -0.30587637781831667, -1.7113411228981208)): shape (37, 800, 800)
      Valid pixels: 64532/640000 (10.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=18, max=270498, num_faces=270500
      Valid probs shape: (37, 64532)
    ✓ Random_35 (pose=(2.772363020012307, 0.6132424373549945, -1.376114829401666)): shape (37, 800, 800)
      Valid pixels: 64024/640000 (10.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2017, max=270499, num_faces=270500
      Valid probs shape: (37, 64024)
    ✓ Random_36 (pose=(-2.265587193808728, 2.873414542614939, -2.5456890451653447)): shape (37, 800, 800)
      Valid pixels: 64494/640000 (10.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=270404, num_faces=270500
      Valid probs shape: (37, 64494)
    ✓ Random_37 (pose=(-1.599745052799707, -2.0358704962860434, -0.15179669417804975)): shape (37, 800, 800)
      Valid pixels: 94960/640000 (14.8%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=8, max=270499, num_faces=270500
      Valid probs shape: (37, 94960)
    ✓ Random_38 (pose=(0.43244062134813444, -2.0201716501197464, 2.0349503073109068)): shape (37, 800, 800)
      Valid pixels: 71918/640000 (11.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=366, max=270491, num_faces=270500
      Valid probs shape: (37, 71918)
    ✓ Random_39 (pose=(0.6476253132282523, -2.9513966802777394, -2.0428156246118103)): shape (37, 800, 800)
      Valid pixels: 62351/640000 (9.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2749, max=270499, num_faces=270500
      Valid probs shape: (37, 62351)
    P stats: min=0.0000, max=0.9999, mean=0.0259
    Non-zero vertices: 129441/135252
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 5811 1148  977 2925    0 1730 1146 4609 7189]
  Ground Truth Stats:
    Labels shape: (135252,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-3T7T-2-2/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7629
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8058
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8057

  RESULTS:
  RAW:         median(top-10)=0.9030, mean(top-10)=0.9109, median(all)=0.8384, mean(all)=0.7629
  + SMOOTHING: median(top-10)=0.9265, mean(top-10)=0.9307, median(all)=0.8597, mean(all)=0.8058 [+0.0235]
  + MRF:       median(top-10)=0.9270, mean(top-10)=0.9308, median(all)=0.8594, mean(all)=0.8057 [+0.0006]
  TOTAL IMPROVEMENT (median top-10): +0.0240

================================================================================
Subject: NKI-RS-22-1
================================================================================
  Step 0: Generating predictions with V2 model (40 random views)...
  Mesh: 137338 vertices, 274672 faces
  Generating 40 random views...
  Generating predictions for 40 views (continuous camera pose)...
    ✓ Random_0 (pose=(0.4918010721193653, -1.658778678555563, -1.454634398605008)): shape (37, 800, 800)
      Valid pixels: 79700/640000 (12.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=91, max=274670, num_faces=274672
      Valid probs shape: (37, 79700)
    ✓ Random_1 (pose=(-1.6741711645724575, -0.3722201962004168, -1.8133360928322626)): shape (37, 800, 800)
      Valid pixels: 65708/640000 (10.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=16, max=274116, num_faces=274672
      Valid probs shape: (37, 65708)
    ✓ Random_2 (pose=(-1.5586260554935643, -1.8528909835907745, -3.1196100895094903)): shape (37, 800, 800)
      Valid pixels: 102867/640000 (16.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=274671, num_faces=274672
      Valid probs shape: (37, 102867)
    ✓ Random_3 (pose=(-2.9608136374907374, -2.1229426456337563, 0.37652380351306425)): shape (37, 800, 800)
      Valid pixels: 83697/640000 (13.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=273779, num_faces=274672
      Valid probs shape: (37, 83697)
    ✓ Random_4 (pose=(1.800983066371602, 0.14824651479608164, 0.0635048052583671)): shape (37, 800, 800)
      Valid pixels: 101889/640000 (15.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=274665, num_faces=274672
      Valid probs shape: (37, 101889)
    ✓ Random_5 (pose=(1.510585776501686, 0.9697200958265881, 0.3540763103954099)): shape (37, 800, 800)
      Valid pixels: 92017/640000 (14.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=274289, num_faces=274672
      Valid probs shape: (37, 92017)
    ✓ Random_6 (pose=(-1.3333587337100223, 2.7630240938634563, 0.8252168536426212)): shape (37, 800, 800)
      Valid pixels: 77904/640000 (12.2%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=310, max=274670, num_faces=274672
      Valid probs shape: (37, 77904)
    ✓ Random_7 (pose=(-1.9584276914370604, 1.4962195270972884, -1.072421778839149)): shape (37, 800, 800)
      Valid pixels: 99078/640000 (15.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=39, max=274666, num_faces=274672
      Valid probs shape: (37, 99078)
    ✓ Random_8 (pose=(-2.4718200220033286, 0.35927221190516967, 2.3822740921339305)): shape (37, 800, 800)
      Valid pixels: 82379/640000 (12.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=548, max=274670, num_faces=274672
      Valid probs shape: (37, 82379)
    ✓ Random_9 (pose=(0.20005903669571, -0.9012303869081792, 0.8675241615594018)): shape (37, 800, 800)
      Valid pixels: 83241/640000 (13.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=274603, num_faces=274672
      Valid probs shape: (37, 83241)
    ✓ Random_10 (pose=(2.785715781486436, -0.24945923937697767, 1.3891833517218686)): shape (37, 800, 800)
      Valid pixels: 54993/640000 (8.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=65736, max=274671, num_faces=274672
      Valid probs shape: (37, 54993)
    ✓ Random_11 (pose=(1.0473777561330975, -3.0490154881848204, 1.5973225365086483)): shape (37, 800, 800)
      Valid pixels: 56405/640000 (8.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4249, max=274671, num_faces=274672
      Valid probs shape: (37, 56405)
    ✓ Random_12 (pose=(0.7228420712206107, 1.6997737289492703, -2.329736465801096)): shape (37, 800, 800)
      Valid pixels: 68879/640000 (10.8%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=213, max=274671, num_faces=274672
      Valid probs shape: (37, 68879)
    ✓ Random_13 (pose=(1.9126416975488034, -0.7330636096320502, -0.34422354942548594)): shape (37, 800, 800)
      Valid pixels: 103530/640000 (16.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=274669, num_faces=274672
      Valid probs shape: (37, 103530)
    ✓ Random_14 (pose=(0.09623188865896948, 1.2481930424137957, 1.873574252043566)): shape (37, 800, 800)
      Valid pixels: 86611/640000 (13.5%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=3, max=274665, num_faces=274672
      Valid probs shape: (37, 86611)
    ✓ Random_15 (pose=(2.4613065614079614, 1.8075192994095453, 2.245909597102412)): shape (37, 800, 800)
      Valid pixels: 65076/640000 (10.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=274115, num_faces=274672
      Valid probs shape: (37, 65076)
    ✓ Random_16 (pose=(-0.40894345043212743, -1.256094784097636, -2.518101084571739)): shape (37, 800, 800)
      Valid pixels: 70607/640000 (11.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=273780, num_faces=274672
      Valid probs shape: (37, 70607)
    ✓ Random_17 (pose=(0.3664696285693667, 0.7051700423582754, -0.8163369236788536)): shape (37, 800, 800)
      Valid pixels: 76439/640000 (11.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=274502, num_faces=274672
      Valid probs shape: (37, 76439)
    ✓ Random_18 (pose=(-1.14863434193857, -2.521703504856305, 0.7972038245260618)): shape (37, 800, 800)
      Valid pixels: 73759/640000 (11.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=390, max=274670, num_faces=274672
      Valid probs shape: (37, 73759)
    ✓ Random_19 (pose=(1.2603840460319349, 2.1485629996037643, -1.1393000128727215)): shape (37, 800, 800)
      Valid pixels: 96531/640000 (15.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=53, max=274670, num_faces=274672
      Valid probs shape: (37, 96531)
    ✓ Random_20 (pose=(-1.511964514557903, -0.7302890117678089, 0.34808321443678025)): shape (37, 800, 800)
      Valid pixels: 84359/640000 (13.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=61, max=274669, num_faces=274672
      Valid probs shape: (37, 84359)
    ✓ Random_21 (pose=(-0.4800354653641281, -0.39508253057118337, 3.073888398063511)): shape (37, 800, 800)
      Valid pixels: 67042/640000 (10.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=274054, num_faces=274672
      Valid probs shape: (37, 67042)
    ✓ Random_22 (pose=(2.922093499008451, 0.20507148480974813, -3.1111755469737172)): shape (37, 800, 800)
      Valid pixels: 56892/640000 (8.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=52375, max=274671, num_faces=274672
      Valid probs shape: (37, 56892)
    ✓ Random_23 (pose=(0.3492561054939025, 3.079545431789394, -1.0557791920876038)): shape (37, 800, 800)
      Valid pixels: 54616/640000 (8.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2818, max=274671, num_faces=274672
      Valid probs shape: (37, 54616)
    ✓ Random_24 (pose=(-1.6366218468461187, -0.7913025206200794, 3.00776809743366)): shape (37, 800, 800)
      Valid pixels: 105451/640000 (16.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=20, max=274669, num_faces=274672
      Valid probs shape: (37, 105451)
    ✓ Random_25 (pose=(2.7764156711769132, -0.738707037467254, 0.7884995974709623)): shape (37, 800, 800)
      Valid pixels: 62444/640000 (9.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=26509, max=274671, num_faces=274672
      Valid probs shape: (37, 62444)
    ✓ Random_26 (pose=(-1.361383065171636, 2.534974515760215, 2.688027275778703)): shape (37, 800, 800)
      Valid pixels: 103758/640000 (16.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=17, max=274669, num_faces=274672
      Valid probs shape: (37, 103758)
    ✓ Random_27 (pose=(2.0314900007754115, 1.887303497796152, -0.0065799953306799885)): shape (37, 800, 800)
      Valid pixels: 102402/640000 (16.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=274669, num_faces=274672
      Valid probs shape: (37, 102402)
    ✓ Random_28 (pose=(-3.0302918470167484, -1.8908933466705509, 1.639309350083181)): shape (37, 800, 800)
      Valid pixels: 87626/640000 (13.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=274662, num_faces=274672
      Valid probs shape: (37, 87626)
    ✓ Random_29 (pose=(1.9553476904560618, 2.5602030852291016, 1.8621864641825887)): shape (37, 800, 800)
      Valid pixels: 65481/640000 (10.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=273780, num_faces=274672
      Valid probs shape: (37, 65481)
    ✓ Random_30 (pose=(1.474671082430321, 2.7936568030952573, -2.3798713932663804)): shape (37, 800, 800)
      Valid pixels: 76271/640000 (11.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=216, max=274671, num_faces=274672
      Valid probs shape: (37, 76271)
    ✓ Random_31 (pose=(2.3434646064680527, -3.079080551482208, -1.2910165640148767)): shape (37, 800, 800)
      Valid pixels: 58561/640000 (9.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=274669, num_faces=274672
      Valid probs shape: (37, 58561)
    ✓ Random_32 (pose=(1.9963939164483788, 0.6072723367677444, 0.7734905693986196)): shape (37, 800, 800)
      Valid pixels: 84216/640000 (13.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=20, max=274660, num_faces=274672
      Valid probs shape: (37, 84216)
    ✓ Random_33 (pose=(-0.2489839158881897, 2.575165489072438, -1.8009320706277876)): shape (37, 800, 800)
      Valid pixels: 68855/640000 (10.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=595, max=274667, num_faces=274672
      Valid probs shape: (37, 68855)
    ✓ Random_34 (pose=(0.675908710849888, 2.5872451610001344, -0.4207119983337715)): shape (37, 800, 800)
      Valid pixels: 80161/640000 (12.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=99, max=274665, num_faces=274672
      Valid probs shape: (37, 80161)
    ✓ Random_35 (pose=(-2.1084598968346757, 2.8195729351905303, 0.7799382267973489)): shape (37, 800, 800)
      Valid pixels: 65660/640000 (10.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=274669, num_faces=274672
      Valid probs shape: (37, 65660)
    ✓ Random_36 (pose=(1.9049314501074592, 2.6879032605166335, 1.1778580298999062)): shape (37, 800, 800)
      Valid pixels: 72110/640000 (11.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=274115, num_faces=274672
      Valid probs shape: (37, 72110)
    ✓ Random_37 (pose=(2.685315529185022, -1.706540241598372, 2.814639919330949)): shape (37, 800, 800)
      Valid pixels: 74814/640000 (11.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=65, max=274670, num_faces=274672
      Valid probs shape: (37, 74814)
    ✓ Random_38 (pose=(-2.6535484456536658, 1.9536860864428274, -1.7743415590969822)): shape (37, 800, 800)
      Valid pixels: 95572/640000 (14.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=274347, num_faces=274672
      Valid probs shape: (37, 95572)
    ✓ Random_39 (pose=(1.4538249942470243, -0.4926434344035946, 0.002449614348772222)): shape (37, 800, 800)
      Valid pixels: 103057/640000 (16.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=274667, num_faces=274672
      Valid probs shape: (37, 103057)
    P stats: min=0.0000, max=0.9999, mean=0.0253
    Non-zero vertices: 128692/137338
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 8646  839  924 3311    0 2328 1357 4593 6061]
  Ground Truth Stats:
    Labels shape: (137338,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-1/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7565
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8070
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8071

  RESULTS:
  RAW:         median(top-10)=0.9164, mean(top-10)=0.9161, median(all)=0.8281, mean(all)=0.7565
  + SMOOTHING: median(top-10)=0.9321, mean(top-10)=0.9337, median(all)=0.8544, mean(all)=0.8070 [+0.0157]
  + MRF:       median(top-10)=0.9324, mean(top-10)=0.9338, median(all)=0.8547, mean(all)=0.8071 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0159

================================================================================
Subject: NKI-RS-22-10
================================================================================
  Step 0: Generating predictions with V2 model (40 random views)...
  Mesh: 130448 vertices, 260892 faces
  Generating 40 random views...
  Generating predictions for 40 views (continuous camera pose)...
    ✓ Random_0 (pose=(0.3698985254631886, 0.5801731870511495, -0.9289478452612339)): shape (37, 800, 800)
      Valid pixels: 77740/640000 (12.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=260882, num_faces=260892
      Valid probs shape: (37, 77740)
    ✓ Random_1 (pose=(0.6251932704906031, 0.8447777886113714, 0.9877347835024288)): shape (37, 800, 800)
      Valid pixels: 72951/640000 (11.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=260733, num_faces=260892
      Valid probs shape: (37, 72951)
    ✓ Random_2 (pose=(0.12616106032467966, 2.0109797575359885, 1.293457482025703)): shape (37, 800, 800)
      Valid pixels: 100366/640000 (15.7%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=496, max=260805, num_faces=260892
      Valid probs shape: (37, 100366)
    ✓ Random_3 (pose=(0.48050890018364, -2.044055058858786, 1.8821293231635554)): shape (37, 800, 800)
      Valid pixels: 77519/640000 (12.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=967, max=260885, num_faces=260892
      Valid probs shape: (37, 77519)
    ✓ Random_4 (pose=(2.3649206870352772, -1.247040434730936, -2.95356354110127)): shape (37, 800, 800)
      Valid pixels: 78225/640000 (12.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=127, max=260891, num_faces=260892
      Valid probs shape: (37, 78225)
    ✓ Random_5 (pose=(-0.3154371788312065, -1.9137941704696313, 1.6074364259443028)): shape (37, 800, 800)
      Valid pixels: 109544/640000 (17.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=214, max=260891, num_faces=260892
      Valid probs shape: (37, 109544)
    ✓ Random_6 (pose=(-0.6554910747030971, -2.7069968214328615, 2.842489391717529)): shape (37, 800, 800)
      Valid pixels: 80865/640000 (12.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1688, max=260885, num_faces=260892
      Valid probs shape: (37, 80865)
    ✓ Random_7 (pose=(-1.1788655788242535, -2.3846747506028554, 2.3756950596850643)): shape (37, 800, 800)
      Valid pixels: 109565/640000 (17.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=53, max=260891, num_faces=260892
      Valid probs shape: (37, 109565)
    ✓ Random_8 (pose=(-2.994142163431629, 2.186211646750034, 1.4209751461228448)): shape (37, 800, 800)
      Valid pixels: 93193/640000 (14.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=260885, num_faces=260892
      Valid probs shape: (37, 93193)
    ✓ Random_9 (pose=(1.757340416380634, 3.06654172434704, 2.748748419912034)): shape (37, 800, 800)
      Valid pixels: 105749/640000 (16.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=5, max=260804, num_faces=260892
      Valid probs shape: (37, 105749)
    ✓ Random_10 (pose=(0.22567311428644388, 0.4628630049490883, -1.0177523238634936)): shape (37, 800, 800)
      Valid pixels: 69321/640000 (10.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=260884, num_faces=260892
      Valid probs shape: (37, 69321)
    ✓ Random_11 (pose=(-2.9957244478153293, -2.70120660065708, 1.6771841832882552)): shape (37, 800, 800)
      Valid pixels: 64109/640000 (10.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=260269, num_faces=260892
      Valid probs shape: (37, 64109)
    ✓ Random_12 (pose=(1.1236344454442815, 2.727657779604119, 3.002310485926092)): shape (37, 800, 800)
      Valid pixels: 97866/640000 (15.3%)
      Probs stats: min=0.0000, max=0.9995, mean=0.0270
      Face IDs: min=350, max=260805, num_faces=260892
      Valid probs shape: (37, 97866)
    ✓ Random_13 (pose=(1.737361222612133, 2.0465164537294553, 3.0003472652118317)): shape (37, 800, 800)
      Valid pixels: 106111/640000 (16.6%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=5, max=260804, num_faces=260892
      Valid probs shape: (37, 106111)
    ✓ Random_14 (pose=(-2.5435871429207424, 2.446915346450191, 1.3927714343852662)): shape (37, 800, 800)
      Valid pixels: 75186/640000 (11.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=260883, num_faces=260892
      Valid probs shape: (37, 75186)
    ✓ Random_15 (pose=(-1.7707804167580732, -2.3826985938713205, -1.194983400520617)): shape (37, 800, 800)
      Valid pixels: 76800/640000 (12.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=260798, num_faces=260892
      Valid probs shape: (37, 76800)
    ✓ Random_16 (pose=(-0.7963419348598748, -1.639569981644269, 0.5834953882235308)): shape (37, 800, 800)
      Valid pixels: 71133/640000 (11.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=132, max=260891, num_faces=260892
      Valid probs shape: (37, 71133)
    ✓ Random_17 (pose=(-0.7948554487721218, -0.2539551235596038, -3.07667860373525)): shape (37, 800, 800)
      Valid pixels: 82306/640000 (12.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=260885, num_faces=260892
      Valid probs shape: (37, 82306)
    ✓ Random_18 (pose=(3.088637287795433, 2.3930485104129433, -0.7382149297087026)): shape (37, 800, 800)
      Valid pixels: 62885/640000 (9.8%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=1, max=260377, num_faces=260892
      Valid probs shape: (37, 62885)
    ✓ Random_19 (pose=(0.050969254135889486, -0.2412716612549035, -3.1236955007057303)): shape (37, 800, 800)
      Valid pixels: 54734/640000 (8.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=259348, num_faces=260892
      Valid probs shape: (37, 54734)
    ✓ Random_20 (pose=(-0.7099665859563697, -0.04637949967814281, 0.22916714665218008)): shape (37, 800, 800)
      Valid pixels: 76205/640000 (11.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=260720, num_faces=260892
      Valid probs shape: (37, 76205)
    ✓ Random_21 (pose=(1.8179648047908552, -0.7896082839228717, 2.676885189571731)): shape (37, 800, 800)
      Valid pixels: 105468/640000 (16.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=61, max=260804, num_faces=260892
      Valid probs shape: (37, 105468)
    ✓ Random_22 (pose=(-2.2629922843561108, 0.4647895345900399, -2.626771623608179)): shape (37, 800, 800)
      Valid pixels: 71639/640000 (11.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1689, max=260885, num_faces=260892
      Valid probs shape: (37, 71639)
    ✓ Random_23 (pose=(1.683942376212122, -2.2874192960282524, -2.947293373902852)): shape (37, 800, 800)
      Valid pixels: 94633/640000 (14.8%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=13, max=260805, num_faces=260892
      Valid probs shape: (37, 94633)
    ✓ Random_24 (pose=(-3.1094721190252907, 0.018631187595030685, 1.145031508765272)): shape (37, 800, 800)
      Valid pixels: 47206/640000 (7.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5855, max=260891, num_faces=260892
      Valid probs shape: (37, 47206)
    ✓ Random_25 (pose=(0.3880020964670243, 2.181518191336128, -1.184242332149208)): shape (37, 800, 800)
      Valid pixels: 98384/640000 (15.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=883, max=260885, num_faces=260892
      Valid probs shape: (37, 98384)
    ✓ Random_26 (pose=(-0.100375217626683, -2.8413902579914128, 1.260540948818785)): shape (37, 800, 800)
      Valid pixels: 56639/640000 (8.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3632, max=260891, num_faces=260892
      Valid probs shape: (37, 56639)
    ✓ Random_27 (pose=(2.3105457756342247, 2.6909437393260296, 2.6887742413040208)): shape (37, 800, 800)
      Valid pixels: 88264/640000 (13.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=260801, num_faces=260892
      Valid probs shape: (37, 88264)
    ✓ Random_28 (pose=(0.009515363495016249, 1.4665314819460766, -0.6221980880214915)): shape (37, 800, 800)
      Valid pixels: 78058/640000 (12.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=260885, num_faces=260892
      Valid probs shape: (37, 78058)
    ✓ Random_29 (pose=(-1.1728465977354872, -2.0194625470495193, 2.7700170304548717)): shape (37, 800, 800)
      Valid pixels: 109736/640000 (17.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=53, max=260891, num_faces=260892
      Valid probs shape: (37, 109736)
    ✓ Random_30 (pose=(0.17125656317409188, 2.9901409017907543, 1.1959062596296182)): shape (37, 800, 800)
      Valid pixels: 53941/640000 (8.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=75245, max=260876, num_faces=260892
      Valid probs shape: (37, 53941)
    ✓ Random_31 (pose=(0.5057665389440591, 2.8533347731578846, -1.8758725479004772)): shape (37, 800, 800)
      Valid pixels: 60508/640000 (9.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2924, max=260890, num_faces=260892
      Valid probs shape: (37, 60508)
    ✓ Random_32 (pose=(-0.3839453306032299, 1.939294189090342, -2.296652109343996)): shape (37, 800, 800)
      Valid pixels: 109176/640000 (17.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=215, max=260891, num_faces=260892
      Valid probs shape: (37, 109176)
    ✓ Random_33 (pose=(-3.0100018934366894, 0.5822370174222513, 0.5690986562941243)): shape (37, 800, 800)
      Valid pixels: 64309/640000 (10.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=560, max=260890, num_faces=260892
      Valid probs shape: (37, 64309)
    ✓ Random_34 (pose=(2.0894413941686087, -0.1779304400469348, -0.4100984736355926)): shape (37, 800, 800)
      Valid pixels: 103490/640000 (16.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=509, max=260885, num_faces=260892
      Valid probs shape: (37, 103490)
    ✓ Random_35 (pose=(0.9074091187938036, -0.7236588293894903, -2.154705208708948)): shape (37, 800, 800)
      Valid pixels: 81229/640000 (12.7%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=5, max=260804, num_faces=260892
      Valid probs shape: (37, 81229)
    ✓ Random_36 (pose=(2.152588023363408, -0.30417686676583733, 0.4517678060907353)): shape (37, 800, 800)
      Valid pixels: 79820/640000 (12.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1013, max=260885, num_faces=260892
      Valid probs shape: (37, 79820)
    ✓ Random_37 (pose=(-0.2000412707368877, -2.927421983723759, 2.419383231405792)): shape (37, 800, 800)
      Valid pixels: 55736/640000 (8.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3650, max=260885, num_faces=260892
      Valid probs shape: (37, 55736)
    ✓ Random_38 (pose=(1.2170097840835021, 0.9996660121764211, -0.5111772362144458)): shape (37, 800, 800)
      Valid pixels: 109664/640000 (17.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=260885, num_faces=260892
      Valid probs shape: (37, 109664)
    ✓ Random_39 (pose=(-1.7597786406300728, 1.95265593296733, -0.23740592788416492)): shape (37, 800, 800)
      Valid pixels: 102969/640000 (16.1%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=12, max=260804, num_faces=260892
      Valid probs shape: (37, 102969)
    P stats: min=0.0000, max=0.9999, mean=0.0264
    Non-zero vertices: 127358/130448
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 3090 1386  924 2879    0 1903 1002 4456 7113]
  Ground Truth Stats:
    Labels shape: (130448,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-10/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7984
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8433
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8433

  RESULTS:
  RAW:         median(top-10)=0.9155, mean(top-10)=0.9190, median(all)=0.8721, mean(all)=0.7984
  + SMOOTHING: median(top-10)=0.9346, mean(top-10)=0.9339, median(all)=0.8945, mean(all)=0.8433 [+0.0191]
  + MRF:       median(top-10)=0.9348, mean(top-10)=0.9340, median(all)=0.8953, mean(all)=0.8433 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0193

================================================================================
Subject: NKI-RS-22-11
================================================================================
  Step 0: Generating predictions with V2 model (40 random views)...
  Mesh: 138161 vertices, 276318 faces
  Generating 40 random views...
  Generating predictions for 40 views (continuous camera pose)...
    ✓ Random_0 (pose=(-0.755382792047476, 0.08208348250103947, -3.0808188059461243)): shape (37, 800, 800)
      Valid pixels: 77132/640000 (12.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=276231, num_faces=276318
      Valid probs shape: (37, 77132)
    ✓ Random_1 (pose=(2.7274895697679957, -0.016623440933996925, -2.7236396877625277)): shape (37, 800, 800)
      Valid pixels: 61501/640000 (9.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=11231, max=276313, num_faces=276318
      Valid probs shape: (37, 61501)
    ✓ Random_2 (pose=(0.8558592813253396, 2.4723705657051047, -0.4053529584921147)): shape (37, 800, 800)
      Valid pixels: 85553/640000 (13.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=118, max=276235, num_faces=276318
      Valid probs shape: (37, 85553)
    ✓ Random_3 (pose=(-1.4266380277622732, -0.7567666365180434, -2.692319753487491)): shape (37, 800, 800)
      Valid pixels: 85546/640000 (13.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6, max=276234, num_faces=276318
      Valid probs shape: (37, 85546)
    ✓ Random_4 (pose=(0.9637251458521625, -1.2814815137263638, 0.03255082579341728)): shape (37, 800, 800)
      Valid pixels: 98296/640000 (15.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=33, max=276308, num_faces=276318
      Valid probs shape: (37, 98296)
    ✓ Random_5 (pose=(-2.6073762619908, 1.9729676586538742, -2.178212384295096)): shape (37, 800, 800)
      Valid pixels: 73868/640000 (11.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=273260, num_faces=276318
      Valid probs shape: (37, 73868)
    ✓ Random_6 (pose=(1.1782668930071196, 1.0354484481442041, 1.7825712296577478)): shape (37, 800, 800)
      Valid pixels: 82578/640000 (12.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=9, max=276176, num_faces=276318
      Valid probs shape: (37, 82578)
    ✓ Random_7 (pose=(1.2684717285218623, 1.7503452317656478, 1.4923325557849987)): shape (37, 800, 800)
      Valid pixels: 68018/640000 (10.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=273260, num_faces=276318
      Valid probs shape: (37, 68018)
    ✓ Random_8 (pose=(-0.6013250823824929, 2.8946263905736123, -0.5083857560569256)): shape (37, 800, 800)
      Valid pixels: 71389/640000 (11.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=29581, max=276199, num_faces=276318
      Valid probs shape: (37, 71389)
    ✓ Random_9 (pose=(2.6110097039956957, -2.360885840590926, -1.38346761665232)): shape (37, 800, 800)
      Valid pixels: 83241/640000 (13.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=276315, num_faces=276318
      Valid probs shape: (37, 83241)
    ✓ Random_10 (pose=(2.264695561964679, -2.9900857509024514, -1.5875669505840782)): shape (37, 800, 800)
      Valid pixels: 54633/640000 (8.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=276235, num_faces=276318
      Valid probs shape: (37, 54633)
    ✓ Random_11 (pose=(3.037187426626934, 1.5019675212920207, 0.5520998240573203)): shape (37, 800, 800)
      Valid pixels: 90052/640000 (14.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=32, max=276313, num_faces=276318
      Valid probs shape: (37, 90052)
    ✓ Random_12 (pose=(1.101462406367256, 0.1739002693584064, -1.4182906692178308)): shape (37, 800, 800)
      Valid pixels: 63160/640000 (9.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=276242, num_faces=276318
      Valid probs shape: (37, 63160)
    ✓ Random_13 (pose=(-1.0336197286587185, 2.2390426777288086, -0.9361436422168086)): shape (37, 800, 800)
      Valid pixels: 65706/640000 (10.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1704, max=273832, num_faces=276318
      Valid probs shape: (37, 65706)
    ✓ Random_14 (pose=(-2.5710762084357524, -2.8327410698869064, 1.951779662004422)): shape (37, 800, 800)
      Valid pixels: 49977/640000 (7.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=276242, num_faces=276318
      Valid probs shape: (37, 49977)
    ✓ Random_15 (pose=(-0.41400881282305946, 2.712956315566445, -1.7914862594408005)): shape (37, 800, 800)
      Valid pixels: 58761/640000 (9.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=118, max=276235, num_faces=276318
      Valid probs shape: (37, 58761)
    ✓ Random_16 (pose=(2.405380281740321, -0.7465386812315211, -2.9647777853517927)): shape (37, 800, 800)
      Valid pixels: 71706/640000 (11.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1611, max=276313, num_faces=276318
      Valid probs shape: (37, 71706)
    ✓ Random_17 (pose=(0.8513326520842832, 2.9542721345937446, 2.2622020425507827)): shape (37, 800, 800)
      Valid pixels: 81970/640000 (12.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5100, max=276199, num_faces=276318
      Valid probs shape: (37, 81970)
    ✓ Random_18 (pose=(2.0899653732807213, -0.29408625458275806, -0.024445702388170343)): shape (37, 800, 800)
      Valid pixels: 87050/640000 (13.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=81, max=276234, num_faces=276318
      Valid probs shape: (37, 87050)
    ✓ Random_19 (pose=(-1.4860702487991253, -1.5553383196740314, -2.8516838792006935)): shape (37, 800, 800)
      Valid pixels: 91452/640000 (14.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8, max=276235, num_faces=276318
      Valid probs shape: (37, 91452)
    ✓ Random_20 (pose=(1.24317788142499, -2.8884350637813148, -1.147807280555588)): shape (37, 800, 800)
      Valid pixels: 73244/640000 (11.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=174, max=276313, num_faces=276318
      Valid probs shape: (37, 73244)
    ✓ Random_21 (pose=(1.1594478642346147, 2.825435758768524, -2.0558945161635647)): shape (37, 800, 800)
      Valid pixels: 66739/640000 (10.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=48, max=276313, num_faces=276318
      Valid probs shape: (37, 66739)
    ✓ Random_22 (pose=(0.3532219738027824, 0.19221968839736148, -1.1738382883789822)): shape (37, 800, 800)
      Valid pixels: 54681/640000 (8.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=276301, num_faces=276318
      Valid probs shape: (37, 54681)
    ✓ Random_23 (pose=(1.7856134029296085, -1.9596303094846395, -0.6264669852922715)): shape (37, 800, 800)
      Valid pixels: 101194/640000 (15.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=276303, num_faces=276318
      Valid probs shape: (37, 101194)
    ✓ Random_24 (pose=(-0.2956201059217305, -0.37232845889510413, -1.3988214812065378)): shape (37, 800, 800)
      Valid pixels: 60343/640000 (9.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=275208, num_faces=276318
      Valid probs shape: (37, 60343)
    ✓ Random_25 (pose=(2.4054212402935935, 1.6168103112786296, -2.7816930117025676)): shape (37, 800, 800)
      Valid pixels: 97204/640000 (15.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=30, max=276315, num_faces=276318
      Valid probs shape: (37, 97204)
    ✓ Random_26 (pose=(1.112466404287975, 0.09898572736725164, -0.23629009405933887)): shape (37, 800, 800)
      Valid pixels: 93108/640000 (14.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=276229, num_faces=276318
      Valid probs shape: (37, 93108)
    ✓ Random_27 (pose=(-0.8077846655330312, -2.0968219170429983, 2.144280448580985)): shape (37, 800, 800)
      Valid pixels: 96606/640000 (15.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=121, max=276312, num_faces=276318
      Valid probs shape: (37, 96606)
    ✓ Random_28 (pose=(-2.924901709390851, 0.47949839151232254, 2.3031267002146514)): shape (37, 800, 800)
      Valid pixels: 58868/640000 (9.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=118, max=276235, num_faces=276318
      Valid probs shape: (37, 58868)
    ✓ Random_29 (pose=(-0.05692835995489531, 1.3378354175230136, -0.4920093064817057)): shape (37, 800, 800)
      Valid pixels: 66821/640000 (10.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=9, max=276239, num_faces=276318
      Valid probs shape: (37, 66821)
    ✓ Random_30 (pose=(0.9923277605600536, -0.4580540216375826, 0.616652248893125)): shape (37, 800, 800)
      Valid pixels: 84132/640000 (13.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=276238, num_faces=276318
      Valid probs shape: (37, 84132)
    ✓ Random_31 (pose=(1.0004894239101123, -0.6771828609547623, 1.4413744624504137)): shape (37, 800, 800)
      Valid pixels: 66424/640000 (10.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=276240, num_faces=276318
      Valid probs shape: (37, 66424)
    ✓ Random_32 (pose=(-1.149222760484444, 2.9278213616951696, -0.019852513061676458)): shape (37, 800, 800)
      Valid pixels: 92880/640000 (14.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=406, max=276313, num_faces=276318
      Valid probs shape: (37, 92880)
    ✓ Random_33 (pose=(-2.040243168466235, -2.8751459348274264, -3.0532244114107634)): shape (37, 800, 800)
      Valid pixels: 92535/640000 (14.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=276236, num_faces=276318
      Valid probs shape: (37, 92535)
    ✓ Random_34 (pose=(-1.7467778929697428, 0.897937997897138, -1.8591442807033582)): shape (37, 800, 800)
      Valid pixels: 60746/640000 (9.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=276235, num_faces=276318
      Valid probs shape: (37, 60746)
    ✓ Random_35 (pose=(0.45896596634150466, -2.292298524483842, 0.3972827101262535)): shape (37, 800, 800)
      Valid pixels: 83688/640000 (13.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=171, max=276313, num_faces=276318
      Valid probs shape: (37, 83688)
    ✓ Random_36 (pose=(-2.7654142419748724, -3.112627350806814, 0.13877859515753244)): shape (37, 800, 800)
      Valid pixels: 55446/640000 (8.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=275826, num_faces=276318
      Valid probs shape: (37, 55446)
    ✓ Random_37 (pose=(2.5349366500202155, 2.2548969428051633, 0.9385057842014222)): shape (37, 800, 800)
      Valid pixels: 87492/640000 (13.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=276242, num_faces=276318
      Valid probs shape: (37, 87492)
    ✓ Random_38 (pose=(0.10101497788980929, -2.400300122221454, -1.948596304564495)): shape (37, 800, 800)
      Valid pixels: 81445/640000 (12.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8983, max=276313, num_faces=276318
      Valid probs shape: (37, 81445)
    ✓ Random_39 (pose=(2.7066546501519175, -0.8347945106034329, 2.7990685990459596)): shape (37, 800, 800)
      Valid pixels: 73636/640000 (11.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1630, max=276313, num_faces=276318
      Valid probs shape: (37, 73636)
    P stats: min=0.0000, max=0.9999, mean=0.0253
    Non-zero vertices: 129310/138161
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 8851 1221 1184 3524    0 2594 1145 4078 5497]
  Ground Truth Stats:
    Labels shape: (138161,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-11/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7806
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8373
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8376

  RESULTS:
  RAW:         median(top-10)=0.9138, mean(top-10)=0.9120, median(all)=0.8448, mean(all)=0.7806
  + SMOOTHING: median(top-10)=0.9296, mean(top-10)=0.9314, median(all)=0.8837, mean(all)=0.8373 [+0.0157]
  + MRF:       median(top-10)=0.9296, mean(top-10)=0.9315, median(all)=0.8832, mean(all)=0.8376 [+0.0000]
  TOTAL IMPROVEMENT (median top-10): +0.0158

================================================================================
Subject: NKI-RS-22-12
================================================================================
  Step 0: Generating predictions with V2 model (40 random views)...
  Mesh: 144832 vertices, 289660 faces
  Generating 40 random views...
  Generating predictions for 40 views (continuous camera pose)...
    ✓ Random_0 (pose=(-2.2055345627618315, -0.2919698429177475, -3.0918393410797327)): shape (37, 800, 800)
      Valid pixels: 79779/640000 (12.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=157, max=289648, num_faces=289660
      Valid probs shape: (37, 79779)
    ✓ Random_1 (pose=(-2.0555328578440593, -2.21566194018197, 2.5684705414535296)): shape (37, 800, 800)
      Valid pixels: 85522/640000 (13.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=12, max=289646, num_faces=289660
      Valid probs shape: (37, 85522)
    ✓ Random_2 (pose=(-2.091631694382751, 2.845108307006461, -2.723463846806803)): shape (37, 800, 800)
      Valid pixels: 68319/640000 (10.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=289648, num_faces=289660
      Valid probs shape: (37, 68319)
    ✓ Random_3 (pose=(2.644549712107657, -2.134401182266095, 0.5019702402157877)): shape (37, 800, 800)
      Valid pixels: 58896/640000 (9.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=289621, num_faces=289660
      Valid probs shape: (37, 58896)
    ✓ Random_4 (pose=(0.7345825811630236, 2.551357063677795, -0.1158690457405096)): shape (37, 800, 800)
      Valid pixels: 66318/640000 (10.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=221, max=289648, num_faces=289660
      Valid probs shape: (37, 66318)
    ✓ Random_5 (pose=(0.43107801622577124, 0.4133865001844135, -0.6091413158573906)): shape (37, 800, 800)
      Valid pixels: 61295/640000 (9.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=289646, num_faces=289660
      Valid probs shape: (37, 61295)
    ✓ Random_6 (pose=(0.43589861213761383, 2.190122739358297, 2.1485913194994035)): shape (37, 800, 800)
      Valid pixels: 79468/640000 (12.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=321, max=289650, num_faces=289660
      Valid probs shape: (37, 79468)
    ✓ Random_7 (pose=(1.6196860120473247, -2.616439182617956, -0.5310454125755295)): shape (37, 800, 800)
      Valid pixels: 96955/640000 (15.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=9, max=289648, num_faces=289660
      Valid probs shape: (37, 96955)
    ✓ Random_8 (pose=(0.6337024337721759, 2.201750391897268, 2.074155606330317)): shape (37, 800, 800)
      Valid pixels: 85075/640000 (13.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=673, max=289650, num_faces=289660
      Valid probs shape: (37, 85075)
    ✓ Random_9 (pose=(0.4340347962121833, 2.7150605630598568, -0.19012050173222184)): shape (37, 800, 800)
      Valid pixels: 54064/640000 (8.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=725, max=289657, num_faces=289660
      Valid probs shape: (37, 54064)
    ✓ Random_10 (pose=(-0.9637746638189664, -0.1917055789279294, 2.1973450653077533)): shape (37, 800, 800)
      Valid pixels: 79211/640000 (12.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=289646, num_faces=289660
      Valid probs shape: (37, 79211)
    ✓ Random_11 (pose=(0.7867278116263452, 0.8775060623656463, -2.555904485497032)): shape (37, 800, 800)
      Valid pixels: 58971/640000 (9.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=289547, num_faces=289660
      Valid probs shape: (37, 58971)
    ✓ Random_12 (pose=(-2.2398118522926245, -1.1361728974930507, 0.15317745932997884)): shape (37, 800, 800)
      Valid pixels: 90846/640000 (14.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=24, max=289650, num_faces=289660
      Valid probs shape: (37, 90846)
    ✓ Random_13 (pose=(-0.01545817640036029, -3.088706356844012, 0.841932638135185)): shape (37, 800, 800)
      Valid pixels: 40441/640000 (6.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=8647, max=289657, num_faces=289660
      Valid probs shape: (37, 40441)
    ✓ Random_14 (pose=(1.4621264824408131, 2.980578716315015, 2.318857308861298)): shape (37, 800, 800)
      Valid pixels: 91123/640000 (14.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=289650, num_faces=289660
      Valid probs shape: (37, 91123)
    ✓ Random_15 (pose=(1.7876132690823594, -0.2743221528966022, -0.24946330927709948)): shape (37, 800, 800)
      Valid pixels: 94058/640000 (14.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=83, max=289648, num_faces=289660
      Valid probs shape: (37, 94058)
    ✓ Random_16 (pose=(-2.9317043392986886, 2.9326150160133455, -1.6064384820261501)): shape (37, 800, 800)
      Valid pixels: 49753/640000 (7.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=287505, num_faces=289660
      Valid probs shape: (37, 49753)
    ✓ Random_17 (pose=(3.094175833580552, 0.6091017879260874, -2.904538538644802)): shape (37, 800, 800)
      Valid pixels: 60314/640000 (9.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=20036, max=289650, num_faces=289660
      Valid probs shape: (37, 60314)
    ✓ Random_18 (pose=(-2.1763248636151795, -0.3554808555390596, 1.5782889565517308)): shape (37, 800, 800)
      Valid pixels: 62055/640000 (9.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1768, max=289647, num_faces=289660
      Valid probs shape: (37, 62055)
    ✓ Random_19 (pose=(0.5571567866143177, -1.6399806536823094, 2.1312053427673474)): shape (37, 800, 800)
      Valid pixels: 65023/640000 (10.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=289649, num_faces=289660
      Valid probs shape: (37, 65023)
    ✓ Random_20 (pose=(1.6560875582150514, 0.9446041818132871, -0.09107720934506869)): shape (37, 800, 800)
      Valid pixels: 95344/640000 (14.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=34, max=289648, num_faces=289660
      Valid probs shape: (37, 95344)
    ✓ Random_21 (pose=(3.1407323836653296, -0.13830975929639422, -0.9538995204435836)): shape (37, 800, 800)
      Valid pixels: 41108/640000 (6.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=8456, max=289650, num_faces=289660
      Valid probs shape: (37, 41108)
    ✓ Random_22 (pose=(-1.8132990370529036, -1.194943858172335, -3.1321663951281176)): shape (37, 800, 800)
      Valid pixels: 96137/640000 (15.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=34, max=289648, num_faces=289660
      Valid probs shape: (37, 96137)
    ✓ Random_23 (pose=(0.48170809128209946, -0.6097136219410486, 2.9097416426332305)): shape (37, 800, 800)
      Valid pixels: 67519/640000 (10.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=287505, num_faces=289660
      Valid probs shape: (37, 67519)
    ✓ Random_24 (pose=(-0.9213082736076625, 0.8549360608820429, -1.2099693062119365)): shape (37, 800, 800)
      Valid pixels: 59443/640000 (9.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=289636, num_faces=289660
      Valid probs shape: (37, 59443)
    ✓ Random_25 (pose=(0.8872483385768044, 1.1015898834272555, 1.1889386141966947)): shape (37, 800, 800)
      Valid pixels: 73065/640000 (11.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=289655, num_faces=289660
      Valid probs shape: (37, 73065)
    ✓ Random_26 (pose=(-0.5534477064231429, 2.2572335227291784, 2.1497397414208343)): shape (37, 800, 800)
      Valid pixels: 62522/640000 (9.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2321, max=289658, num_faces=289660
      Valid probs shape: (37, 62522)
    ✓ Random_27 (pose=(-0.24508832434896322, 0.5595419950728413, 1.122577243598145)): shape (37, 800, 800)
      Valid pixels: 62027/640000 (9.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=287505, num_faces=289660
      Valid probs shape: (37, 62027)
    ✓ Random_28 (pose=(1.3410037563334747, -0.08869461878256901, 2.7226834872505528)): shape (37, 800, 800)
      Valid pixels: 90819/640000 (14.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=2, max=289649, num_faces=289660
      Valid probs shape: (37, 90819)
    ✓ Random_29 (pose=(-0.7172964205830659, -1.9223465395712187, -0.7014680091667231)): shape (37, 800, 800)
      Valid pixels: 82028/640000 (12.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=296, max=289655, num_faces=289660
      Valid probs shape: (37, 82028)
    ✓ Random_30 (pose=(1.3406786737820031, -0.38677481890602516, -0.9631646746033131)): shape (37, 800, 800)
      Valid pixels: 84388/640000 (13.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=34, max=289646, num_faces=289660
      Valid probs shape: (37, 84388)
    ✓ Random_31 (pose=(-1.9337893975667853, 0.48069388244154077, -2.802214160563391)): shape (37, 800, 800)
      Valid pixels: 73222/640000 (11.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=120, max=289648, num_faces=289660
      Valid probs shape: (37, 73222)
    ✓ Random_32 (pose=(-2.8079435926215996, 0.8733214260428692, 1.9712055353727198)): shape (37, 800, 800)
      Valid pixels: 75421/640000 (11.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=182, max=289657, num_faces=289660
      Valid probs shape: (37, 75421)
    ✓ Random_33 (pose=(-0.6818840472215135, 2.492720544592985, -0.8399030619730028)): shape (37, 800, 800)
      Valid pixels: 60131/640000 (9.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=18308, max=289650, num_faces=289660
      Valid probs shape: (37, 60131)
    ✓ Random_34 (pose=(1.5194336323647866, -2.901448509580402, -0.2923568739150295)): shape (37, 800, 800)
      Valid pixels: 97095/640000 (15.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=19, max=289648, num_faces=289660
      Valid probs shape: (37, 97095)
    ✓ Random_35 (pose=(0.13706073688897735, 2.2607055793434263, -0.4747181880459266)): shape (37, 800, 800)
      Valid pixels: 59537/640000 (9.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1306, max=289651, num_faces=289660
      Valid probs shape: (37, 59537)
    ✓ Random_36 (pose=(1.0549718000991462, 1.353285736261018, -1.6124684844761377)): shape (37, 800, 800)
      Valid pixels: 84498/640000 (13.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=20, max=289646, num_faces=289660
      Valid probs shape: (37, 84498)
    ✓ Random_37 (pose=(2.870769017247685, 2.006227023449533, 0.12891754481024265)): shape (37, 800, 800)
      Valid pixels: 76007/640000 (11.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=30, max=289646, num_faces=289660
      Valid probs shape: (37, 76007)
    ✓ Random_38 (pose=(-3.0904935773563187, 0.37123129093513496, 0.09720072391326262)): shape (37, 800, 800)
      Valid pixels: 44977/640000 (7.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2158, max=289657, num_faces=289660
      Valid probs shape: (37, 44977)
    ✓ Random_39 (pose=(1.8661240670107118, 0.7517847095460866, -2.3004391796420016)): shape (37, 800, 800)
      Valid pixels: 69882/640000 (10.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=39, max=289658, num_faces=289660
      Valid probs shape: (37, 69882)
    P stats: min=0.0000, max=1.0000, mean=0.0260
    Non-zero vertices: 139505/144832
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 5327 1428 1207 2775    0 2922 1162 4466 5633]
  Ground Truth Stats:
    Labels shape: (144832,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-12/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.8065
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8461
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8463

  RESULTS:
  RAW:         median(top-10)=0.9129, mean(top-10)=0.9193, median(all)=0.8696, mean(all)=0.8065
  + SMOOTHING: median(top-10)=0.9310, mean(top-10)=0.9348, median(all)=0.8900, mean(all)=0.8461 [+0.0182]
  + MRF:       median(top-10)=0.9314, mean(top-10)=0.9350, median(all)=0.8900, mean(all)=0.8463 [+0.0004]
  TOTAL IMPROVEMENT (median top-10): +0.0186

================================================================================
Subject: NKI-RS-22-13
================================================================================
  Step 0: Generating predictions with V2 model (40 random views)...
  Mesh: 121451 vertices, 242898 faces
  Generating 40 random views...
  Generating predictions for 40 views (continuous camera pose)...
    ✓ Random_0 (pose=(2.4788230614549533, -0.728009525580235, 2.692476322061699)): shape (37, 800, 800)
      Valid pixels: 73969/640000 (11.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1470, max=242897, num_faces=242898
      Valid probs shape: (37, 73969)
    ✓ Random_1 (pose=(2.957145371791145, -1.1471461691749687, -2.7267628336390235)): shape (37, 800, 800)
      Valid pixels: 61485/640000 (9.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=311, max=242895, num_faces=242898
      Valid probs shape: (37, 61485)
    ✓ Random_2 (pose=(2.173693918868511, -2.177770947257185, -0.43784167384272354)): shape (37, 800, 800)
      Valid pixels: 86481/640000 (13.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7, max=242707, num_faces=242898
      Valid probs shape: (37, 86481)
    ✓ Random_3 (pose=(-1.4348829745212883, -2.3521546842180747, 2.791298434158496)): shape (37, 800, 800)
      Valid pixels: 94427/640000 (14.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=60, max=242887, num_faces=242898
      Valid probs shape: (37, 94427)
    ✓ Random_4 (pose=(0.6108182220016198, -0.6964467660881, 0.13565263523408477)): shape (37, 800, 800)
      Valid pixels: 72372/640000 (11.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=242887, num_faces=242898
      Valid probs shape: (37, 72372)
    ✓ Random_5 (pose=(0.41794789290085, 0.533595145604715, -1.1672425453528399)): shape (37, 800, 800)
      Valid pixels: 62840/640000 (9.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=242799, num_faces=242898
      Valid probs shape: (37, 62840)
    ✓ Random_6 (pose=(-2.0475655985166843, -0.3437231524966804, 1.916654565190182)): shape (37, 800, 800)
      Valid pixels: 59669/640000 (9.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1020, max=242894, num_faces=242898
      Valid probs shape: (37, 59669)
    ✓ Random_7 (pose=(-1.200665374554493, -2.9855903007516273, 1.4455509845911383)): shape (37, 800, 800)
      Valid pixels: 57995/640000 (9.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=723, max=242894, num_faces=242898
      Valid probs shape: (37, 57995)
    ✓ Random_8 (pose=(0.31037808880719986, -1.646745362085096, -2.281491046360464)): shape (37, 800, 800)
      Valid pixels: 90999/640000 (14.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=242459, num_faces=242898
      Valid probs shape: (37, 90999)
    ✓ Random_9 (pose=(1.7698640286809324, -0.8081668516948772, -0.7411435291132911)): shape (37, 800, 800)
      Valid pixels: 92519/640000 (14.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=242887, num_faces=242898
      Valid probs shape: (37, 92519)
    ✓ Random_10 (pose=(-2.752158106374748, -2.3149770923471515, -0.5976957441726358)): shape (37, 800, 800)
      Valid pixels: 50543/640000 (7.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=241704, num_faces=242898
      Valid probs shape: (37, 50543)
    ✓ Random_11 (pose=(-1.0637898537019947, -1.4549608099260678, -0.6352997440577446)): shape (37, 800, 800)
      Valid pixels: 88412/640000 (13.8%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=33, max=242891, num_faces=242898
      Valid probs shape: (37, 88412)
    ✓ Random_12 (pose=(1.0610480016613941, -0.580967273216507, 0.3577009298502811)): shape (37, 800, 800)
      Valid pixels: 83912/640000 (13.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=33, max=242707, num_faces=242898
      Valid probs shape: (37, 83912)
    ✓ Random_13 (pose=(0.669121595239178, 0.012296134469582665, -1.527003705104158)): shape (37, 800, 800)
      Valid pixels: 43982/640000 (6.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=242887, num_faces=242898
      Valid probs shape: (37, 43982)
    ✓ Random_14 (pose=(-1.0904138246682904, 0.971704565535271, 0.6310762711802349)): shape (37, 800, 800)
      Valid pixels: 78161/640000 (12.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=11, max=242895, num_faces=242898
      Valid probs shape: (37, 78161)
    ✓ Random_15 (pose=(1.5151336050090416, -2.3384930535096276, 1.527651777738713)): shape (37, 800, 800)
      Valid pixels: 54764/640000 (8.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7, max=241714, num_faces=242898
      Valid probs shape: (37, 54764)
    ✓ Random_16 (pose=(-1.190925682442313, -2.038818226872973, 0.14288787914266177)): shape (37, 800, 800)
      Valid pixels: 74829/640000 (11.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=33, max=242897, num_faces=242898
      Valid probs shape: (37, 74829)
    ✓ Random_17 (pose=(0.80315001268885, -2.1895178215422364, 0.3355136838979913)): shape (37, 800, 800)
      Valid pixels: 88771/640000 (13.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=73, max=242887, num_faces=242898
      Valid probs shape: (37, 88771)
    ✓ Random_18 (pose=(2.79636458500182, 2.111344805516528, -1.2848846094512756)): shape (37, 800, 800)
      Valid pixels: 63211/640000 (9.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=11, max=242895, num_faces=242898
      Valid probs shape: (37, 63211)
    ✓ Random_19 (pose=(2.3719517869507563, 3.031716081468379, -2.396181854202828)): shape (37, 800, 800)
      Valid pixels: 56889/640000 (8.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=242735, num_faces=242898
      Valid probs shape: (37, 56889)
    ✓ Random_20 (pose=(2.6180039727719757, -0.12880424976745752, 0.795162412473641)): shape (37, 800, 800)
      Valid pixels: 46221/640000 (7.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1276, max=242203, num_faces=242898
      Valid probs shape: (37, 46221)
    ✓ Random_21 (pose=(0.19201449497498713, 0.4957239057051246, 1.7523291060139412)): shape (37, 800, 800)
      Valid pixels: 58049/640000 (9.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=241626, num_faces=242898
      Valid probs shape: (37, 58049)
    ✓ Random_22 (pose=(-0.44836472987594433, -0.8987441130965577, 0.9545933242659377)): shape (37, 800, 800)
      Valid pixels: 61271/640000 (9.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=242887, num_faces=242898
      Valid probs shape: (37, 61271)
    ✓ Random_23 (pose=(1.0506076351366227, 0.10067978805351441, 1.6212239016329235)): shape (37, 800, 800)
      Valid pixels: 54980/640000 (8.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=241469, num_faces=242898
      Valid probs shape: (37, 54980)
    ✓ Random_24 (pose=(1.4001878367202911, 0.16367632712790625, 3.0406850333688187)): shape (37, 800, 800)
      Valid pixels: 86180/640000 (13.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=35, max=242891, num_faces=242898
      Valid probs shape: (37, 86180)
    ✓ Random_25 (pose=(0.40163529652421737, -2.795095731148199, -3.0670674518722927)): shape (37, 800, 800)
      Valid pixels: 60631/640000 (9.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=35003, max=242896, num_faces=242898
      Valid probs shape: (37, 60631)
    ✓ Random_26 (pose=(-1.76702495463086, 2.0119833927509516, 1.426259866932467)): shape (37, 800, 800)
      Valid pixels: 58783/640000 (9.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=242889, num_faces=242898
      Valid probs shape: (37, 58783)
    ✓ Random_27 (pose=(-0.8389175162117906, 3.105824478799116, 3.0189068745234646)): shape (37, 800, 800)
      Valid pixels: 74856/640000 (11.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=312, max=242887, num_faces=242898
      Valid probs shape: (37, 74856)
    ✓ Random_28 (pose=(-0.7340942292187096, 1.9764733170976285, 1.5852420698684622)): shape (37, 800, 800)
      Valid pixels: 68129/640000 (10.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=47, max=242896, num_faces=242898
      Valid probs shape: (37, 68129)
    ✓ Random_29 (pose=(2.630224072753937, -2.3717803301735376, -1.3505868570694926)): shape (37, 800, 800)
      Valid pixels: 74569/640000 (11.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=242887, num_faces=242898
      Valid probs shape: (37, 74569)
    ✓ Random_30 (pose=(-0.01881291082187042, -1.1173647664153465, 2.5832214296758913)): shape (37, 800, 800)
      Valid pixels: 61865/640000 (9.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=242199, num_faces=242898
      Valid probs shape: (37, 61865)
    ✓ Random_31 (pose=(-2.2987930431999555, -2.3448909556967186, 1.1338615307079882)): shape (37, 800, 800)
      Valid pixels: 66086/640000 (10.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=9, max=242895, num_faces=242898
      Valid probs shape: (37, 66086)
    ✓ Random_32 (pose=(-1.4199266019784877, -1.611980040046001, -0.7162323980527412)): shape (37, 800, 800)
      Valid pixels: 90229/640000 (14.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=50, max=241824, num_faces=242898
      Valid probs shape: (37, 90229)
    ✓ Random_33 (pose=(0.4705856748412707, -2.386587231444872, -1.5787517207031472)): shape (37, 800, 800)
      Valid pixels: 65047/640000 (10.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=686, max=242896, num_faces=242898
      Valid probs shape: (37, 65047)
    ✓ Random_34 (pose=(-0.5390447217191481, -0.6907797525723915, 0.7643438153993718)): shape (37, 800, 800)
      Valid pixels: 47695/640000 (7.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=242886, num_faces=242898
      Valid probs shape: (37, 47695)
    ✓ Random_35 (pose=(2.2995186348020145, -1.1974262033717031, -1.7387090825242553)): shape (37, 800, 800)
      Valid pixels: 78054/640000 (12.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=73, max=242887, num_faces=242898
      Valid probs shape: (37, 78054)
    ✓ Random_36 (pose=(-2.1367133886753535, 0.5462794062280727, -2.8510896382848023)): shape (37, 800, 800)
      Valid pixels: 68968/640000 (10.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=329, max=242360, num_faces=242898
      Valid probs shape: (37, 68968)
    ✓ Random_37 (pose=(1.525764274692678, -1.3834888846183926, -1.3064007485368971)): shape (37, 800, 800)
      Valid pixels: 64917/640000 (10.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=242890, num_faces=242898
      Valid probs shape: (37, 64917)
    ✓ Random_38 (pose=(0.39751089141306073, 1.116780798873691, -0.08194709527342248)): shape (37, 800, 800)
      Valid pixels: 60748/640000 (9.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=242200, num_faces=242898
      Valid probs shape: (37, 60748)
    ✓ Random_39 (pose=(2.554747913406345, 1.8842225780817454, 0.8451460983158716)): shape (37, 800, 800)
      Valid pixels: 90162/640000 (14.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=37, max=242887, num_faces=242898
      Valid probs shape: (37, 90162)
    P stats: min=0.0000, max=1.0000, mean=0.0261
    Non-zero vertices: 117288/121451
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 4163 1117  962 2690    0 2291  955 4192 5542]
  Ground Truth Stats:
    Labels shape: (121451,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-13/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7883
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8296
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8297

  RESULTS:
  RAW:         median(top-10)=0.9147, mean(top-10)=0.9189, median(all)=0.8602, mean(all)=0.7883
  + SMOOTHING: median(top-10)=0.9420, mean(top-10)=0.9370, median(all)=0.8890, mean(all)=0.8296 [+0.0273]
  + MRF:       median(top-10)=0.9421, mean(top-10)=0.9373, median(all)=0.8892, mean(all)=0.8297 [+0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0274

================================================================================
Subject: NKI-RS-22-14
================================================================================
  Step 0: Generating predictions with V2 model (40 random views)...
  Mesh: 142823 vertices, 285642 faces
  Generating 40 random views...
  Generating predictions for 40 views (continuous camera pose)...
    ✓ Random_0 (pose=(0.2442435137278367, 2.790639695088486, 2.6505048489155847)): shape (37, 800, 800)
      Valid pixels: 53089/640000 (8.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=62513, max=285631, num_faces=285642
      Valid probs shape: (37, 53089)
    ✓ Random_1 (pose=(0.5854418233685856, 0.4689274351923576, 2.06057717959951)): shape (37, 800, 800)
      Valid pixels: 64504/640000 (10.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=284915, num_faces=285642
      Valid probs shape: (37, 64504)
    ✓ Random_2 (pose=(1.1291924102560795, 1.9907808569647356, 0.352793403619855)): shape (37, 800, 800)
      Valid pixels: 70202/640000 (11.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=285638, num_faces=285642
      Valid probs shape: (37, 70202)
    ✓ Random_3 (pose=(-2.7865705095422237, 0.2781438875562352, -0.9888702954815409)): shape (37, 800, 800)
      Valid pixels: 59165/640000 (9.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=23698, max=285592, num_faces=285642
      Valid probs shape: (37, 59165)
    ✓ Random_4 (pose=(-2.9166451590181186, 2.856298675281244, -3.0010076627452578)): shape (37, 800, 800)
      Valid pixels: 40031/640000 (6.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=285617, num_faces=285642
      Valid probs shape: (37, 40031)
    ✓ Random_5 (pose=(-2.809414499887558, -2.85996309786344, 2.584938926291473)): shape (37, 800, 800)
      Valid pixels: 45435/640000 (7.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=285641, num_faces=285642
      Valid probs shape: (37, 45435)
    ✓ Random_6 (pose=(-0.8331182431597592, 0.47439649398040995, 1.0147029657817743)): shape (37, 800, 800)
      Valid pixels: 61975/640000 (9.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=9, max=285641, num_faces=285642
      Valid probs shape: (37, 61975)
    ✓ Random_7 (pose=(0.5001982640299829, 0.32084156666822716, -2.2900147806492)): shape (37, 800, 800)
      Valid pixels: 48902/640000 (7.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=285641, num_faces=285642
      Valid probs shape: (37, 48902)
    ✓ Random_8 (pose=(-0.7921959201425048, -0.3020862058296214, -1.7356631402158416)): shape (37, 800, 800)
      Valid pixels: 49671/640000 (7.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=284208, num_faces=285642
      Valid probs shape: (37, 49671)
    ✓ Random_9 (pose=(2.6298491855947574, -2.83162524135975, -0.9525481127881745)): shape (37, 800, 800)
      Valid pixels: 60389/640000 (9.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=285641, num_faces=285642
      Valid probs shape: (37, 60389)
    ✓ Random_10 (pose=(-2.8919541667308586, 1.877432300590029, -2.817852672837243)): shape (37, 800, 800)
      Valid pixels: 55619/640000 (8.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=284208, num_faces=285642
      Valid probs shape: (37, 55619)
    ✓ Random_11 (pose=(2.1903484987261184, 1.9928752868959743, 1.0009839343531173)): shape (37, 800, 800)
      Valid pixels: 76226/640000 (11.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=285638, num_faces=285642
      Valid probs shape: (37, 76226)
    ✓ Random_12 (pose=(1.1833990067945157, 2.0018769994071617, 2.0795782980200066)): shape (37, 800, 800)
      Valid pixels: 86287/640000 (13.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=285212, num_faces=285642
      Valid probs shape: (37, 86287)
    ✓ Random_13 (pose=(-0.3137023284850238, -0.0327117581968448, -1.847057896300835)): shape (37, 800, 800)
      Valid pixels: 37170/640000 (5.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=285292, num_faces=285642
      Valid probs shape: (37, 37170)
    ✓ Random_14 (pose=(0.5851766256461048, -1.0252727713481407, 0.27493274849978233)): shape (37, 800, 800)
      Valid pixels: 81578/640000 (12.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=285641, num_faces=285642
      Valid probs shape: (37, 81578)
    ✓ Random_15 (pose=(-1.8425140185636746, 0.681977269744594, 0.10025215529811593)): shape (37, 800, 800)
      Valid pixels: 76571/640000 (12.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=65, max=285641, num_faces=285642
      Valid probs shape: (37, 76571)
    ✓ Random_16 (pose=(-2.1406778902248695, 0.5555120755225671, -2.424311975302664)): shape (37, 800, 800)
      Valid pixels: 64065/640000 (10.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=8, max=285638, num_faces=285642
      Valid probs shape: (37, 64065)
    ✓ Random_17 (pose=(0.2259951873173245, -0.2843829450754778, 2.287346921224116)): shape (37, 800, 800)
      Valid pixels: 37774/640000 (5.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=285293, num_faces=285642
      Valid probs shape: (37, 37774)
    ✓ Random_18 (pose=(-1.52896631430145, -0.6322745125611613, -2.574798272091096)): shape (37, 800, 800)
      Valid pixels: 73863/640000 (11.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6, max=285638, num_faces=285642
      Valid probs shape: (37, 73863)
    ✓ Random_19 (pose=(2.142515233889447, 1.8768839270612325, 1.8093298395345538)): shape (37, 800, 800)
      Valid pixels: 60622/640000 (9.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=8, max=285637, num_faces=285642
      Valid probs shape: (37, 60622)
    ✓ Random_20 (pose=(1.1893482132511766, 2.822337134441069, 0.20437646853686342)): shape (37, 800, 800)
      Valid pixels: 77065/640000 (12.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=179, max=285638, num_faces=285642
      Valid probs shape: (37, 77065)
    ✓ Random_21 (pose=(0.6655401616704792, -2.204803253987505, -0.303284272436239)): shape (37, 800, 800)
      Valid pixels: 68135/640000 (10.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=483, max=285641, num_faces=285642
      Valid probs shape: (37, 68135)
    ✓ Random_22 (pose=(1.4702257951254731, -2.910063134315569, 1.2931713765347927)): shape (37, 800, 800)
      Valid pixels: 62760/640000 (9.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=9, max=285638, num_faces=285642
      Valid probs shape: (37, 62760)
    ✓ Random_23 (pose=(-1.2131069309989606, -0.377266246357836, -3.062043120352629)): shape (37, 800, 800)
      Valid pixels: 80441/640000 (12.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=285638, num_faces=285642
      Valid probs shape: (37, 80441)
    ✓ Random_24 (pose=(2.8218582896812574, -2.6758627022028536, 0.1989356074950206)): shape (37, 800, 800)
      Valid pixels: 44687/640000 (7.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=285637, num_faces=285642
      Valid probs shape: (37, 44687)
    ✓ Random_25 (pose=(-0.16927484538869786, -0.14489005921653764, 0.4159782859010699)): shape (37, 800, 800)
      Valid pixels: 43398/640000 (6.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=285631, num_faces=285642
      Valid probs shape: (37, 43398)
    ✓ Random_26 (pose=(-0.9889221754926352, 0.5255010895287149, 2.369614805661329)): shape (37, 800, 800)
      Valid pixels: 69035/640000 (10.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=285641, num_faces=285642
      Valid probs shape: (37, 69035)
    ✓ Random_27 (pose=(1.6771504615318493, 0.3732183895005097, -0.7260108842897459)): shape (37, 800, 800)
      Valid pixels: 86606/640000 (13.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=285641, num_faces=285642
      Valid probs shape: (37, 86606)
    ✓ Random_28 (pose=(-1.8220237947209321, -2.277128770379886, 3.0978044759360204)): shape (37, 800, 800)
      Valid pixels: 90339/640000 (14.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=285638, num_faces=285642
      Valid probs shape: (37, 90339)
    ✓ Random_29 (pose=(1.6550067719117934, -2.1869474896655254, -0.9998417454862008)): shape (37, 800, 800)
      Valid pixels: 82413/640000 (12.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7, max=285641, num_faces=285642
      Valid probs shape: (37, 82413)
    ✓ Random_30 (pose=(1.562912328527486, 1.4216370533063287, -2.7183481593037646)): shape (37, 800, 800)
      Valid pixels: 72807/640000 (11.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=15, max=285641, num_faces=285642
      Valid probs shape: (37, 72807)
    ✓ Random_31 (pose=(0.8341165071788939, 2.747004006815737, 0.1472171014040784)): shape (37, 800, 800)
      Valid pixels: 65448/640000 (10.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=181, max=285638, num_faces=285642
      Valid probs shape: (37, 65448)
    ✓ Random_32 (pose=(0.6679570161677302, 0.37382745625464375, 3.061412321535748)): shape (37, 800, 800)
      Valid pixels: 60142/640000 (9.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=285245, num_faces=285642
      Valid probs shape: (37, 60142)
    ✓ Random_33 (pose=(-0.4482083376090431, 2.970572575176506, -2.221765813672263)): shape (37, 800, 800)
      Valid pixels: 51068/640000 (8.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=492, max=285638, num_faces=285642
      Valid probs shape: (37, 51068)
    ✓ Random_34 (pose=(-2.838487147371844, 2.5282035121055184, -1.8357808690858548)): shape (37, 800, 800)
      Valid pixels: 59544/640000 (9.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=285097, num_faces=285642
      Valid probs shape: (37, 59544)
    ✓ Random_35 (pose=(-0.13802836121591344, -1.0065535903488656, -0.057636724032820386)): shape (37, 800, 800)
      Valid pixels: 58100/640000 (9.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=285641, num_faces=285642
      Valid probs shape: (37, 58100)
    ✓ Random_36 (pose=(0.8420725204751593, -2.4702301866024015, 2.288308814253182)): shape (37, 800, 800)
      Valid pixels: 59793/640000 (9.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=548, max=285117, num_faces=285642
      Valid probs shape: (37, 59793)
    ✓ Random_37 (pose=(-1.384115733262081, 2.381980747127347, 2.663607762249132)): shape (37, 800, 800)
      Valid pixels: 89282/640000 (14.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=285641, num_faces=285642
      Valid probs shape: (37, 89282)
    ✓ Random_38 (pose=(-1.871650703910009, 1.176036716485009, -1.084793407573696)): shape (37, 800, 800)
      Valid pixels: 84935/640000 (13.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=285204, num_faces=285642
      Valid probs shape: (37, 84935)
    ✓ Random_39 (pose=(-0.07166896622556163, -2.113538256973366, -1.148792642192889)): shape (37, 800, 800)
      Valid pixels: 72442/640000 (11.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=548, max=285641, num_faces=285642
      Valid probs shape: (37, 72442)
    P stats: min=0.0000, max=1.0000, mean=0.0256
    Non-zero vertices: 135470/142823
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 7353 1307 1150 2775    0 2454  965 4871 6749]
  Ground Truth Stats:
    Labels shape: (142823,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-14/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
    MRF iteration 5/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7773
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8227
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8233

  RESULTS:
  RAW:         median(top-10)=0.9144, mean(top-10)=0.9154, median(all)=0.8501, mean(all)=0.7773
  + SMOOTHING: median(top-10)=0.9270, mean(top-10)=0.9335, median(all)=0.8820, mean(all)=0.8227 [+0.0127]
  + MRF:       median(top-10)=0.9272, mean(top-10)=0.9339, median(all)=0.8828, mean(all)=0.8233 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0128

================================================================================
Subject: NKI-RS-22-15
================================================================================
  Step 0: Generating predictions with V2 model (40 random views)...
  Mesh: 158740 vertices, 317476 faces
  Generating 40 random views...
  Generating predictions for 40 views (continuous camera pose)...
    ✓ Random_0 (pose=(-3.0044618934632688, -0.5441647068312658, 1.0689726139772997)): shape (37, 800, 800)
      Valid pixels: 76506/640000 (12.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=34987, max=317473, num_faces=317476
      Valid probs shape: (37, 76506)
    ✓ Random_1 (pose=(1.25002403478062, -0.5374807985625139, -0.10510314992700964)): shape (37, 800, 800)
      Valid pixels: 104885/640000 (16.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=317474, num_faces=317476
      Valid probs shape: (37, 104885)
    ✓ Random_2 (pose=(-2.114434395553136, 2.850098998685863, -2.886262783297116)): shape (37, 800, 800)
      Valid pixels: 85637/640000 (13.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=8, max=317474, num_faces=317476
      Valid probs shape: (37, 85637)
    ✓ Random_3 (pose=(-2.0906119105809147, -0.21619190028202917, 0.7713799365301521)): shape (37, 800, 800)
      Valid pixels: 81452/640000 (12.7%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=11, max=317474, num_faces=317476
      Valid probs shape: (37, 81452)
    ✓ Random_4 (pose=(-2.430812624822962, 0.34995722998453926, 2.892678760585417)): shape (37, 800, 800)
      Valid pixels: 83076/640000 (13.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=56, max=317474, num_faces=317476
      Valid probs shape: (37, 83076)
    ✓ Random_5 (pose=(1.030924694975174, -1.9247155480631903, -0.7606405731365276)): shape (37, 800, 800)
      Valid pixels: 86381/640000 (13.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=80, max=317475, num_faces=317476
      Valid probs shape: (37, 86381)
    ✓ Random_6 (pose=(-2.260958358012624, -2.6355507982122997, 0.8496583297670259)): shape (37, 800, 800)
      Valid pixels: 76998/640000 (12.0%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=10, max=317357, num_faces=317476
      Valid probs shape: (37, 76998)
    ✓ Random_7 (pose=(-2.1365838962272696, -1.7567757940863382, -2.5767466775659176)): shape (37, 800, 800)
      Valid pixels: 106301/640000 (16.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=30, max=317474, num_faces=317476
      Valid probs shape: (37, 106301)
    ✓ Random_8 (pose=(-1.1348016199504398, 2.662259017808884, 2.469388550603637)): shape (37, 800, 800)
      Valid pixels: 102014/640000 (15.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=290, max=317475, num_faces=317476
      Valid probs shape: (37, 102014)
    ✓ Random_9 (pose=(1.1054536904729364, -0.14023580038238803, 1.242078068232904)): shape (37, 800, 800)
      Valid pixels: 73464/640000 (11.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=317471, num_faces=317476
      Valid probs shape: (37, 73464)
    ✓ Random_10 (pose=(1.12315440832249, -0.2981919928851755, -2.0869432559150836)): shape (37, 800, 800)
      Valid pixels: 68773/640000 (10.7%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=5, max=317473, num_faces=317476
      Valid probs shape: (37, 68773)
    ✓ Random_11 (pose=(2.814033502444633, 1.3441451695479616, -0.14952279057804763)): shape (37, 800, 800)
      Valid pixels: 81042/640000 (12.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=81, max=317475, num_faces=317476
      Valid probs shape: (37, 81042)
    ✓ Random_12 (pose=(0.9974726203394564, -0.9234138870051982, 2.6525206085592554)): shape (37, 800, 800)
      Valid pixels: 96440/640000 (15.1%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=8, max=316356, num_faces=317476
      Valid probs shape: (37, 96440)
    ✓ Random_13 (pose=(1.0891668836768318, -2.0694126164363507, 0.3260431284955607)): shape (37, 800, 800)
      Valid pixels: 109326/640000 (17.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=243, max=317474, num_faces=317476
      Valid probs shape: (37, 109326)
    ✓ Random_14 (pose=(-1.3604760767621933, 0.29316406441353715, -2.363545968648088)): shape (37, 800, 800)
      Valid pixels: 83332/640000 (13.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=21, max=317471, num_faces=317476
      Valid probs shape: (37, 83332)
    ✓ Random_15 (pose=(-1.4951624689000182, -2.280894087469453, -0.38092732324554435)): shape (37, 800, 800)
      Valid pixels: 104642/640000 (16.4%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=23, max=317406, num_faces=317476
      Valid probs shape: (37, 104642)
    ✓ Random_16 (pose=(-2.0217796311602587, -0.8092810651115339, 1.9910820332034938)): shape (37, 800, 800)
      Valid pixels: 76213/640000 (11.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=331, max=317475, num_faces=317476
      Valid probs shape: (37, 76213)
    ✓ Random_17 (pose=(0.21097682319450062, 2.480819671503368, -1.0821487605588453)): shape (37, 800, 800)
      Valid pixels: 77968/640000 (12.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1222, max=317475, num_faces=317476
      Valid probs shape: (37, 77968)
    ✓ Random_18 (pose=(-1.4213323770586406, 0.284658062900192, -0.06425482775902669)): shape (37, 800, 800)
      Valid pixels: 100736/640000 (15.7%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=0, max=317475, num_faces=317476
      Valid probs shape: (37, 100736)
    ✓ Random_19 (pose=(-2.9324624838272886, -0.9638551777343447, -1.5081987950559397)): shape (37, 800, 800)
      Valid pixels: 87072/640000 (13.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=273, max=317474, num_faces=317476
      Valid probs shape: (37, 87072)
    ✓ Random_20 (pose=(2.420149840730658, 0.6594428875104694, -2.447054232806741)): shape (37, 800, 800)
      Valid pixels: 89732/640000 (14.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4742, max=317474, num_faces=317476
      Valid probs shape: (37, 89732)
    ✓ Random_21 (pose=(-0.9389480670764949, 0.8005267058571977, 0.42217428484008046)): shape (37, 800, 800)
      Valid pixels: 96433/640000 (15.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=30, max=317429, num_faces=317476
      Valid probs shape: (37, 96433)
    ✓ Random_22 (pose=(-2.3559984597616515, -0.1713700377881131, -2.451298502937914)): shape (37, 800, 800)
      Valid pixels: 73121/640000 (11.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=785, max=317475, num_faces=317476
      Valid probs shape: (37, 73121)
    ✓ Random_23 (pose=(0.07042173653837391, 1.4645905019596421, -2.937747864955859)): shape (37, 800, 800)
      Valid pixels: 74285/640000 (11.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=317475, num_faces=317476
      Valid probs shape: (37, 74285)
    ✓ Random_24 (pose=(-0.8802337777899507, -3.0618714690495725, -0.05515047993316324)): shape (37, 800, 800)
      Valid pixels: 89353/640000 (14.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3788, max=317475, num_faces=317476
      Valid probs shape: (37, 89353)
    ✓ Random_25 (pose=(-2.7611178538647896, 2.150900084884796, 2.206067644094463)): shape (37, 800, 800)
      Valid pixels: 90139/640000 (14.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=317472, num_faces=317476
      Valid probs shape: (37, 90139)
    ✓ Random_26 (pose=(2.9394711128589224, 0.4018974475796018, 1.2262973842862435)): shape (37, 800, 800)
      Valid pixels: 65752/640000 (10.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3084, max=317473, num_faces=317476
      Valid probs shape: (37, 65752)
    ✓ Random_27 (pose=(-2.540304549782281, -1.6795158080279635, -1.3778738634380787)): shape (37, 800, 800)
      Valid pixels: 82053/640000 (12.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=9, max=317474, num_faces=317476
      Valid probs shape: (37, 82053)
    ✓ Random_28 (pose=(1.810843382563725, -2.1977155793372516, -1.2282064188611077)): shape (37, 800, 800)
      Valid pixels: 93904/640000 (14.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7, max=317475, num_faces=317476
      Valid probs shape: (37, 93904)
    ✓ Random_29 (pose=(0.3627959985404936, 0.4334531142159679, 1.8064191976278199)): shape (37, 800, 800)
      Valid pixels: 79325/640000 (12.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=316354, num_faces=317476
      Valid probs shape: (37, 79325)
    ✓ Random_30 (pose=(2.9458804552581164, -1.8446210112830677, 1.023649945536624)): shape (37, 800, 800)
      Valid pixels: 102830/640000 (16.1%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=31, max=317397, num_faces=317476
      Valid probs shape: (37, 102830)
    ✓ Random_31 (pose=(-2.617335248273327, -1.5187399735409108, 2.1925986192229487)): shape (37, 800, 800)
      Valid pixels: 75982/640000 (11.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=317474, num_faces=317476
      Valid probs shape: (37, 75982)
    ✓ Random_32 (pose=(-0.6989094193217742, -1.4301901978266949, 3.0741296352128655)): shape (37, 800, 800)
      Valid pixels: 82015/640000 (12.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=27, max=317471, num_faces=317476
      Valid probs shape: (37, 82015)
    ✓ Random_33 (pose=(-0.6378096969617877, -0.7365243585954828, 1.6182504847803)): shape (37, 800, 800)
      Valid pixels: 82272/640000 (12.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6, max=317475, num_faces=317476
      Valid probs shape: (37, 82272)
    ✓ Random_34 (pose=(2.8180570931158417, 2.047586756054784, -1.0599901562743983)): shape (37, 800, 800)
      Valid pixels: 68749/640000 (10.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=317473, num_faces=317476
      Valid probs shape: (37, 68749)
    ✓ Random_35 (pose=(-3.0145881565156007, 1.5410085539229117, 0.18837904943360329)): shape (37, 800, 800)
      Valid pixels: 74550/640000 (11.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=317475, num_faces=317476
      Valid probs shape: (37, 74550)
    ✓ Random_36 (pose=(2.8694037217951953, 1.8330221161564193, -0.24896712766736728)): shape (37, 800, 800)
      Valid pixels: 68337/640000 (10.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=317475, num_faces=317476
      Valid probs shape: (37, 68337)
    ✓ Random_37 (pose=(2.1709289449938316, 0.7692303561770841, -1.4057667598331882)): shape (37, 800, 800)
      Valid pixels: 75597/640000 (11.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=39, max=317475, num_faces=317476
      Valid probs shape: (37, 75597)
    ✓ Random_38 (pose=(2.4003717895466687, 2.0786788300922563, 1.879382838730157)): shape (37, 800, 800)
      Valid pixels: 75175/640000 (11.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=317470, num_faces=317476
      Valid probs shape: (37, 75175)
    ✓ Random_39 (pose=(-2.8775216531347287, -2.993125442006061, 1.5646035916272263)): shape (37, 800, 800)
      Valid pixels: 53594/640000 (8.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=0, max=317328, num_faces=317476
      Valid probs shape: (37, 53594)
    P stats: min=0.0000, max=0.9998, mean=0.0256
    Non-zero vertices: 150221/158740
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 8519 1076 1378 4193    0 2598 1219 5677 7416]
  Ground Truth Stats:
    Labels shape: (158740,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-15/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7862
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8316
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8318

  RESULTS:
  RAW:         median(top-10)=0.9010, mean(top-10)=0.9070, median(all)=0.8433, mean(all)=0.7862
  + SMOOTHING: median(top-10)=0.9240, mean(top-10)=0.9257, median(all)=0.8740, mean(all)=0.8316 [+0.0230]
  + MRF:       median(top-10)=0.9244, mean(top-10)=0.9261, median(all)=0.8741, mean(all)=0.8318 [+0.0004]
  TOTAL IMPROVEMENT (median top-10): +0.0234

================================================================================
Subject: NKI-RS-22-16
================================================================================
  Step 0: Generating predictions with V2 model (40 random views)...
  Mesh: 137370 vertices, 274736 faces
  Generating 40 random views...
  Generating predictions for 40 views (continuous camera pose)...
    ✓ Random_0 (pose=(-0.40501547605020427, -3.121952852753367, -2.7464400397661786)): shape (37, 800, 800)
      Valid pixels: 67076/640000 (10.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2319, max=274735, num_faces=274736
      Valid probs shape: (37, 67076)
    ✓ Random_1 (pose=(-1.8676498497200922, -3.023914839075387, -1.9332759319919124)): shape (37, 800, 800)
      Valid pixels: 78645/640000 (12.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=274709, num_faces=274736
      Valid probs shape: (37, 78645)
    ✓ Random_2 (pose=(-2.8670037650005993, 3.094023772838808, 2.778530998808858)): shape (37, 800, 800)
      Valid pixels: 66443/640000 (10.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=274733, num_faces=274736
      Valid probs shape: (37, 66443)
    ✓ Random_3 (pose=(2.8899493728472603, -2.4609637218415004, -2.5638471290407425)): shape (37, 800, 800)
      Valid pixels: 67162/640000 (10.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=274708, num_faces=274736
      Valid probs shape: (37, 67162)
    ✓ Random_4 (pose=(1.1097023104753365, 0.11598438345400597, 1.176642720079121)): shape (37, 800, 800)
      Valid pixels: 75120/640000 (11.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=274711, num_faces=274736
      Valid probs shape: (37, 75120)
    ✓ Random_5 (pose=(0.2704471285571368, -1.1423520518092523, -0.41786760235121)): shape (37, 800, 800)
      Valid pixels: 72605/640000 (11.3%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=2, max=274689, num_faces=274736
      Valid probs shape: (37, 72605)
    ✓ Random_6 (pose=(-0.5276884508294355, -2.215290929800656, -1.8077101038913683)): shape (37, 800, 800)
      Valid pixels: 103675/640000 (16.2%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=15776, max=274735, num_faces=274736
      Valid probs shape: (37, 103675)
    ✓ Random_7 (pose=(0.1977020483723897, -0.2439599525903362, 1.2215854559821562)): shape (37, 800, 800)
      Valid pixels: 66282/640000 (10.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=274718, num_faces=274736
      Valid probs shape: (37, 66282)
    ✓ Random_8 (pose=(-1.477207157566475, -0.35021829628476864, -2.962665976607361)): shape (37, 800, 800)
      Valid pixels: 114032/640000 (17.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=274733, num_faces=274736
      Valid probs shape: (37, 114032)
    ✓ Random_9 (pose=(2.427866485485282, -1.1988810331369788, 0.914696081982342)): shape (37, 800, 800)
      Valid pixels: 81527/640000 (12.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=152, max=274659, num_faces=274736
      Valid probs shape: (37, 81527)
    ✓ Random_10 (pose=(0.28158152291011707, -1.6075078489043435, -0.9117522089015369)): shape (37, 800, 800)
      Valid pixels: 87712/640000 (13.7%)
      Probs stats: min=0.0000, max=0.9995, mean=0.0270
      Face IDs: min=25, max=274452, num_faces=274736
      Valid probs shape: (37, 87712)
    ✓ Random_11 (pose=(-3.045473533709768, 3.0263189289823975, 2.547234809034851)): shape (37, 800, 800)
      Valid pixels: 60171/640000 (9.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=274711, num_faces=274736
      Valid probs shape: (37, 60171)
    ✓ Random_12 (pose=(-0.5914756231216289, 1.623817330926168, 0.6798532946055023)): shape (37, 800, 800)
      Valid pixels: 116612/640000 (18.2%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=7, max=274731, num_faces=274736
      Valid probs shape: (37, 116612)
    ✓ Random_13 (pose=(1.038889670222491, 3.0811140792270573, 2.1057551580805995)): shape (37, 800, 800)
      Valid pixels: 99133/640000 (15.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=10266, max=274735, num_faces=274736
      Valid probs shape: (37, 99133)
    ✓ Random_14 (pose=(-0.723515072654318, 2.4665851070930085, -1.9390074863668827)): shape (37, 800, 800)
      Valid pixels: 89480/640000 (14.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=753, max=274735, num_faces=274736
      Valid probs shape: (37, 89480)
    ✓ Random_15 (pose=(-2.793204070251345, -1.6560160033809, -1.023275254347122)): shape (37, 800, 800)
      Valid pixels: 88026/640000 (13.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=274711, num_faces=274736
      Valid probs shape: (37, 88026)
    ✓ Random_16 (pose=(2.354861334417822, -2.657664761967997, -1.2331188500606423)): shape (37, 800, 800)
      Valid pixels: 93941/640000 (14.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=274725, num_faces=274736
      Valid probs shape: (37, 93941)
    ✓ Random_17 (pose=(1.225309547274021, 1.3293350226184488, 3.0807086161491535)): shape (37, 800, 800)
      Valid pixels: 102375/640000 (16.0%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=24, max=274664, num_faces=274736
      Valid probs shape: (37, 102375)
    ✓ Random_18 (pose=(0.5177443675052649, 1.761277664793445, -1.127450240536557)): shape (37, 800, 800)
      Valid pixels: 121986/640000 (19.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=274733, num_faces=274736
      Valid probs shape: (37, 121986)
    ✓ Random_19 (pose=(0.7837684067232629, -0.656870973333787, 2.851547406268886)): shape (37, 800, 800)
      Valid pixels: 97768/640000 (15.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=274537, num_faces=274736
      Valid probs shape: (37, 97768)
    ✓ Random_20 (pose=(-0.851619604431237, -0.976554093280777, 0.06590581696669773)): shape (37, 800, 800)
      Valid pixels: 87877/640000 (13.7%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=11, max=274463, num_faces=274736
      Valid probs shape: (37, 87877)
    ✓ Random_21 (pose=(1.4620125998590279, -0.048671061073603195, -2.3454466592448355)): shape (37, 800, 800)
      Valid pixels: 89562/640000 (14.0%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=19, max=274452, num_faces=274736
      Valid probs shape: (37, 89562)
    ✓ Random_22 (pose=(2.708528645634985, 1.4233448264465771, -0.9525262800499155)): shape (37, 800, 800)
      Valid pixels: 85298/640000 (13.3%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=82, max=274711, num_faces=274736
      Valid probs shape: (37, 85298)
    ✓ Random_23 (pose=(2.119536509323974, -2.237940994616832, 1.0839918664084713)): shape (37, 800, 800)
      Valid pixels: 71603/640000 (11.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=274537, num_faces=274736
      Valid probs shape: (37, 71603)
    ✓ Random_24 (pose=(-2.8478848743004566, -1.7843143453920747, 1.8227662612538245)): shape (37, 800, 800)
      Valid pixels: 93578/640000 (14.6%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=11, max=274452, num_faces=274736
      Valid probs shape: (37, 93578)
    ✓ Random_25 (pose=(-1.4949054857766972, 0.9695826517694934, -2.772365253255099)): shape (37, 800, 800)
      Valid pixels: 110153/640000 (17.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=274733, num_faces=274736
      Valid probs shape: (37, 110153)
    ✓ Random_26 (pose=(0.7237630179730665, 1.0723643177390692, 3.0231984038559085)): shape (37, 800, 800)
      Valid pixels: 88389/640000 (13.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=7, max=274452, num_faces=274736
      Valid probs shape: (37, 88389)
    ✓ Random_27 (pose=(-2.146096084219809, 0.13694550621324542, -2.1441369811693947)): shape (37, 800, 800)
      Valid pixels: 79302/640000 (12.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1040, max=274722, num_faces=274736
      Valid probs shape: (37, 79302)
    ✓ Random_28 (pose=(-0.8509601856405875, 2.5464634270956594, 1.1423529714595144)): shape (37, 800, 800)
      Valid pixels: 91611/640000 (14.3%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=2908, max=274731, num_faces=274736
      Valid probs shape: (37, 91611)
    ✓ Random_29 (pose=(0.6441467472410247, 1.5118145550518731, 2.780165199208793)): shape (37, 800, 800)
      Valid pixels: 94775/640000 (14.8%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=25, max=274664, num_faces=274736
      Valid probs shape: (37, 94775)
    ✓ Random_30 (pose=(-0.7238378257198028, -1.5414472279296767, -0.6139072862503232)): shape (37, 800, 800)
      Valid pixels: 104497/640000 (16.3%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=11, max=274663, num_faces=274736
      Valid probs shape: (37, 104497)
    ✓ Random_31 (pose=(-1.563714402990091, 2.5470089409977357, -0.9527470733817038)): shape (37, 800, 800)
      Valid pixels: 106405/640000 (16.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=7, max=274536, num_faces=274736
      Valid probs shape: (37, 106405)
    ✓ Random_32 (pose=(2.8277012589902206, 2.764357378070647, -1.0858753452900998)): shape (37, 800, 800)
      Valid pixels: 66297/640000 (10.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=274440, num_faces=274736
      Valid probs shape: (37, 66297)
    ✓ Random_33 (pose=(1.8495579702805687, 1.1857756524480267, 3.0554056392433617)): shape (37, 800, 800)
      Valid pixels: 116528/640000 (18.2%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=10, max=274731, num_faces=274736
      Valid probs shape: (37, 116528)
    ✓ Random_34 (pose=(-1.2259174291190826, -1.5975806041644294, 1.7101723956102877)): shape (37, 800, 800)
      Valid pixels: 102963/640000 (16.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=6, max=274733, num_faces=274736
      Valid probs shape: (37, 102963)
    ✓ Random_35 (pose=(-1.8515902279501928, 2.435398491290573, 0.48444477027947963)): shape (37, 800, 800)
      Valid pixels: 90518/640000 (14.1%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=15, max=274452, num_faces=274736
      Valid probs shape: (37, 90518)
    ✓ Random_36 (pose=(-1.2307404754264148, -2.7536961843671763, -1.4092878239394733)): shape (37, 800, 800)
      Valid pixels: 88931/640000 (13.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=7329, max=274663, num_faces=274736
      Valid probs shape: (37, 88931)
    ✓ Random_37 (pose=(-1.6902995247611956, 2.8120811010596807, -2.4473584116816864)): shape (37, 800, 800)
      Valid pixels: 92824/640000 (14.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=274733, num_faces=274736
      Valid probs shape: (37, 92824)
    ✓ Random_38 (pose=(-1.4805826131540234, -0.20981071183553768, 1.585042338032352)): shape (37, 800, 800)
      Valid pixels: 76525/640000 (12.0%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=17, max=274733, num_faces=274736
      Valid probs shape: (37, 76525)
    ✓ Random_39 (pose=(-2.337549967719843, 0.9543831689574365, 2.735716974574756)): shape (37, 800, 800)
      Valid pixels: 104966/640000 (16.4%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=38, max=274735, num_faces=274736
      Valid probs shape: (37, 104966)
    P stats: min=0.0000, max=0.9998, mean=0.0255
    Non-zero vertices: 129409/137370
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 7961 1083 1085 3077    0 2227  966 4879 5716]
  Ground Truth Stats:
    Labels shape: (137370,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-16/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7627
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8133
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8139

  RESULTS:
  RAW:         median(top-10)=0.9028, mean(top-10)=0.9032, median(all)=0.8224, mean(all)=0.7627
  + SMOOTHING: median(top-10)=0.9203, mean(top-10)=0.9218, median(all)=0.8483, mean(all)=0.8133 [+0.0175]
  + MRF:       median(top-10)=0.9207, mean(top-10)=0.9221, median(all)=0.8484, mean(all)=0.8139 [+0.0004]
  TOTAL IMPROVEMENT (median top-10): +0.0179

================================================================================
Subject: NKI-RS-22-17
================================================================================
  Step 0: Generating predictions with V2 model (40 random views)...
  Mesh: 161773 vertices, 323542 faces
  Generating 40 random views...
  Generating predictions for 40 views (continuous camera pose)...
    ✓ Random_0 (pose=(-0.3523746147829274, 0.7867205541256062, 2.5546009111279977)): shape (37, 800, 800)
      Valid pixels: 59100/640000 (9.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=323338, num_faces=323542
      Valid probs shape: (37, 59100)
    ✓ Random_1 (pose=(-1.7352264156502584, 0.1632448099606627, -0.3383592643879547)): shape (37, 800, 800)
      Valid pixels: 101748/640000 (15.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=103, max=323493, num_faces=323542
      Valid probs shape: (37, 101748)
    ✓ Random_2 (pose=(1.5573710960056122, 2.795513311490903, 1.369260290899228)): shape (37, 800, 800)
      Valid pixels: 63305/640000 (9.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=16, max=322951, num_faces=323542
      Valid probs shape: (37, 63305)
    ✓ Random_3 (pose=(-1.8087379375045296, 0.4607778007202974, -3.067530401377138)): shape (37, 800, 800)
      Valid pixels: 98125/640000 (15.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=323478, num_faces=323542
      Valid probs shape: (37, 98125)
    ✓ Random_4 (pose=(-1.8985187210202232, 0.6760822668796234, -0.5261129848444233)): shape (37, 800, 800)
      Valid pixels: 100699/640000 (15.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=112, max=323493, num_faces=323542
      Valid probs shape: (37, 100699)
    ✓ Random_5 (pose=(-2.982369762953887, -0.43978924707554157, 2.590760892669066)): shape (37, 800, 800)
      Valid pixels: 52777/640000 (8.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5672, max=323535, num_faces=323542
      Valid probs shape: (37, 52777)
    ✓ Random_6 (pose=(-0.8890812030790043, -0.7824331284211787, -2.7379156654600676)): shape (37, 800, 800)
      Valid pixels: 69192/640000 (10.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=322971, num_faces=323542
      Valid probs shape: (37, 69192)
    ✓ Random_7 (pose=(1.8493347415689207, 1.3694210479196567, -2.6461921040479086)): shape (37, 800, 800)
      Valid pixels: 90156/640000 (14.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=10, max=323503, num_faces=323542
      Valid probs shape: (37, 90156)
    ✓ Random_8 (pose=(-1.8093473006681553, -2.7058421817423026, -0.17271203411850555)): shape (37, 800, 800)
      Valid pixels: 99799/640000 (15.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=19, max=323498, num_faces=323542
      Valid probs shape: (37, 99799)
    ✓ Random_9 (pose=(0.16003154041144763, -2.0625684617057845, 1.492331177562428)): shape (37, 800, 800)
      Valid pixels: 93464/640000 (14.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=361, max=323478, num_faces=323542
      Valid probs shape: (37, 93464)
    ✓ Random_10 (pose=(2.913101086074003, 2.977999374115986, -2.1993573207345958)): shape (37, 800, 800)
      Valid pixels: 58322/640000 (9.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=323111, num_faces=323542
      Valid probs shape: (37, 58322)
    ✓ Random_11 (pose=(3.048079417517746, 2.6152496351578156, 2.1849005708601608)): shape (37, 800, 800)
      Valid pixels: 59372/640000 (9.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=323217, num_faces=323542
      Valid probs shape: (37, 59372)
    ✓ Random_12 (pose=(0.07724348912186096, -3.036129608990763, 1.107011392310226)): shape (37, 800, 800)
      Valid pixels: 47500/640000 (7.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4634, max=323534, num_faces=323542
      Valid probs shape: (37, 47500)
    ✓ Random_13 (pose=(-0.8187898518786136, 1.552905035112544, 1.817420167698324)): shape (37, 800, 800)
      Valid pixels: 70918/640000 (11.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=323541, num_faces=323542
      Valid probs shape: (37, 70918)
    ✓ Random_14 (pose=(-2.402232131131493, 1.3910178327231435, 2.8126257696311265)): shape (37, 800, 800)
      Valid pixels: 87110/640000 (13.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=323333, num_faces=323542
      Valid probs shape: (37, 87110)
    ✓ Random_15 (pose=(-2.4525201150941394, 0.09095792698337224, -1.3282530473950136)): shape (37, 800, 800)
      Valid pixels: 70501/640000 (11.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=25295, max=323477, num_faces=323542
      Valid probs shape: (37, 70501)
    ✓ Random_16 (pose=(1.33560844888909, 0.4650728103615087, 2.068025818039854)): shape (37, 800, 800)
      Valid pixels: 92302/640000 (14.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=13, max=323476, num_faces=323542
      Valid probs shape: (37, 92302)
    ✓ Random_17 (pose=(1.784164680349333, -0.753235447856353, -1.3020512756872678)): shape (37, 800, 800)
      Valid pixels: 88247/640000 (13.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=60, max=323541, num_faces=323542
      Valid probs shape: (37, 88247)
    ✓ Random_18 (pose=(2.357148864571071, -1.6441292257017257, -2.226945915809582)): shape (37, 800, 800)
      Valid pixels: 71538/640000 (11.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=323541, num_faces=323542
      Valid probs shape: (37, 71538)
    ✓ Random_19 (pose=(1.9137902904350526, -2.122497441274735, -0.0739508092704031)): shape (37, 800, 800)
      Valid pixels: 96638/640000 (15.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=20, max=323478, num_faces=323542
      Valid probs shape: (37, 96638)
    ✓ Random_20 (pose=(2.76988288501684, -0.8927326342562885, -0.41731146004924824)): shape (37, 800, 800)
      Valid pixels: 74142/640000 (11.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1801, max=323486, num_faces=323542
      Valid probs shape: (37, 74142)
    ✓ Random_21 (pose=(-1.237204088693159, 0.35184703149723573, -1.3677826735484335)): shape (37, 800, 800)
      Valid pixels: 66967/640000 (10.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=17, max=321660, num_faces=323542
      Valid probs shape: (37, 66967)
    ✓ Random_22 (pose=(-1.9677488944778145, -2.889880632142161, -0.9961858714391325)): shape (37, 800, 800)
      Valid pixels: 83998/640000 (13.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=321662, num_faces=323542
      Valid probs shape: (37, 83998)
    ✓ Random_23 (pose=(-0.5673820717151346, 2.9754864892800503, 2.0427933375234195)): shape (37, 800, 800)
      Valid pixels: 56741/640000 (8.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3082, max=323541, num_faces=323542
      Valid probs shape: (37, 56741)
    ✓ Random_24 (pose=(2.3277962558080043, 1.588001539206977, -2.448578402576839)): shape (37, 800, 800)
      Valid pixels: 98043/640000 (15.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=323501, num_faces=323542
      Valid probs shape: (37, 98043)
    ✓ Random_25 (pose=(-3.060756672593759, 1.0693072148519436, 0.03815001937935225)): shape (37, 800, 800)
      Valid pixels: 65036/640000 (10.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=95, max=323537, num_faces=323542
      Valid probs shape: (37, 65036)
    ✓ Random_26 (pose=(-2.936577592900387, -2.178119027014529, 0.4997516447694106)): shape (37, 800, 800)
      Valid pixels: 87280/640000 (13.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=321669, num_faces=323542
      Valid probs shape: (37, 87280)
    ✓ Random_27 (pose=(1.5328649718819012, -2.3812330660763, -0.5626186152916741)): shape (37, 800, 800)
      Valid pixels: 107270/640000 (16.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=40, max=323540, num_faces=323542
      Valid probs shape: (37, 107270)
    ✓ Random_28 (pose=(2.736434854640473, 1.65105405490754, -0.456479677000845)): shape (37, 800, 800)
      Valid pixels: 67378/640000 (10.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=11, max=323541, num_faces=323542
      Valid probs shape: (37, 67378)
    ✓ Random_29 (pose=(-0.09345050728956217, -1.1938879141452545, -0.6275238323485728)): shape (37, 800, 800)
      Valid pixels: 71472/640000 (11.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=7, max=323541, num_faces=323542
      Valid probs shape: (37, 71472)
    ✓ Random_30 (pose=(0.8997622999011368, 2.331197044584182, 0.8073110581628735)): shape (37, 800, 800)
      Valid pixels: 64098/640000 (10.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1814, max=322962, num_faces=323542
      Valid probs shape: (37, 64098)
    ✓ Random_31 (pose=(-1.8741933554813326, -2.6018392621662803, 1.48950799071926)): shape (37, 800, 800)
      Valid pixels: 66167/640000 (10.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=323541, num_faces=323542
      Valid probs shape: (37, 66167)
    ✓ Random_32 (pose=(1.2184695983225984, -2.493618724168095, 1.7290910014468288)): shape (37, 800, 800)
      Valid pixels: 62179/640000 (9.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=323, max=321664, num_faces=323542
      Valid probs shape: (37, 62179)
    ✓ Random_33 (pose=(1.9549096490488056, 0.7986428735890323, -3.0470672046389318)): shape (37, 800, 800)
      Valid pixels: 99707/640000 (15.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=102, max=323501, num_faces=323542
      Valid probs shape: (37, 99707)
    ✓ Random_34 (pose=(1.897274789259881, 0.3370693170639898, 0.4634836897292436)): shape (37, 800, 800)
      Valid pixels: 90788/640000 (14.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=112, max=323337, num_faces=323542
      Valid probs shape: (37, 90788)
    ✓ Random_35 (pose=(2.9654477763206444, -3.0070834885371447, 1.4608440512305485)): shape (37, 800, 800)
      Valid pixels: 54700/640000 (8.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=320683, num_faces=323542
      Valid probs shape: (37, 54700)
    ✓ Random_36 (pose=(0.5295915844152375, -2.378438338168665, -2.97626726760833)): shape (37, 800, 800)
      Valid pixels: 89079/640000 (13.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=22093, max=323504, num_faces=323542
      Valid probs shape: (37, 89079)
    ✓ Random_37 (pose=(-2.064627481831188, -1.3257992390590012, -1.7834052968009626)): shape (37, 800, 800)
      Valid pixels: 74920/640000 (11.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=15, max=322968, num_faces=323542
      Valid probs shape: (37, 74920)
    ✓ Random_38 (pose=(-2.184162840171648, 2.562236858187962, 1.1503066527599959)): shape (37, 800, 800)
      Valid pixels: 61691/640000 (9.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=323337, num_faces=323542
      Valid probs shape: (37, 61691)
    ✓ Random_39 (pose=(0.4881790179654053, 0.08911897264542734, -1.234146325073443)): shape (37, 800, 800)
      Valid pixels: 57830/640000 (9.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=323451, num_faces=323542
      Valid probs shape: (37, 57830)
    P stats: min=0.0000, max=1.0000, mean=0.0257
    Non-zero vertices: 154097/161773
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 7676 1457  981 4863    0 2953 1227 5054 8504]
  Ground Truth Stats:
    Labels shape: (161773,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-17/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7815
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8244
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8247

  RESULTS:
  RAW:         median(top-10)=0.9141, mean(top-10)=0.9199, median(all)=0.8549, mean(all)=0.7815
  + SMOOTHING: median(top-10)=0.9296, mean(top-10)=0.9327, median(all)=0.8836, mean(all)=0.8244 [+0.0155]
  + MRF:       median(top-10)=0.9298, mean(top-10)=0.9329, median(all)=0.8837, mean(all)=0.8247 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0157

================================================================================
Subject: NKI-RS-22-18
================================================================================
  Step 0: Generating predictions with V2 model (40 random views)...
  Mesh: 147633 vertices, 295262 faces
  Generating 40 random views...
  Generating predictions for 40 views (continuous camera pose)...
    ✓ Random_0 (pose=(0.6712665359295227, 0.11457626046578939, -2.519940447667345)): shape (37, 800, 800)
      Valid pixels: 57531/640000 (9.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=294974, num_faces=295262
      Valid probs shape: (37, 57531)
    ✓ Random_1 (pose=(3.082773783091201, -1.1684182324724324, 1.7094217020562077)): shape (37, 800, 800)
      Valid pixels: 87491/640000 (13.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=25, max=295258, num_faces=295262
      Valid probs shape: (37, 87491)
    ✓ Random_2 (pose=(-0.6482257133529443, 2.9727783788354616, -1.5853358822597292)): shape (37, 800, 800)
      Valid pixels: 49330/640000 (7.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5257, max=295260, num_faces=295262
      Valid probs shape: (37, 49330)
    ✓ Random_3 (pose=(2.609930431725842, -1.5824574090487429, 2.22644883831285)): shape (37, 800, 800)
      Valid pixels: 89926/640000 (14.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=6, max=295220, num_faces=295262
      Valid probs shape: (37, 89926)
    ✓ Random_4 (pose=(1.4259733568464164, 3.1119317644281894, -2.2744652192925208)): shape (37, 800, 800)
      Valid pixels: 69749/640000 (10.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=70, max=295218, num_faces=295262
      Valid probs shape: (37, 69749)
    ✓ Random_5 (pose=(1.2208244598855797, -0.7720793113054722, -2.8385968667445334)): shape (37, 800, 800)
      Valid pixels: 89655/640000 (14.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8, max=295219, num_faces=295262
      Valid probs shape: (37, 89655)
    ✓ Random_6 (pose=(-2.849479427339149, 1.0087176517323222, 1.2887773892545855)): shape (37, 800, 800)
      Valid pixels: 89645/640000 (14.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=128, max=295261, num_faces=295262
      Valid probs shape: (37, 89645)
    ✓ Random_7 (pose=(-1.2073063641937813, 0.33507351771056904, -2.6858377965517155)): shape (37, 800, 800)
      Valid pixels: 84974/640000 (13.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=295261, num_faces=295262
      Valid probs shape: (37, 84974)
    ✓ Random_8 (pose=(2.7073301926387074, -1.1981368580699456, 2.6079636291942307)): shape (37, 800, 800)
      Valid pixels: 75186/640000 (11.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=92, max=295248, num_faces=295262
      Valid probs shape: (37, 75186)
    ✓ Random_9 (pose=(-3.0627676807613717, -0.5314254742217619, 0.5461554553773982)): shape (37, 800, 800)
      Valid pixels: 62968/640000 (9.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=9907, max=295260, num_faces=295262
      Valid probs shape: (37, 62968)
    ✓ Random_10 (pose=(0.7202935512872339, -1.7286571512477036, 2.9511683400972375)): shape (37, 800, 800)
      Valid pixels: 83809/640000 (13.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=28, max=295201, num_faces=295262
      Valid probs shape: (37, 83809)
    ✓ Random_11 (pose=(-0.9603724238285491, -2.551508767702109, -2.8318264320397866)): shape (37, 800, 800)
      Valid pixels: 71382/640000 (11.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=126, max=295259, num_faces=295262
      Valid probs shape: (37, 71382)
    ✓ Random_12 (pose=(1.620924806610148, 1.3244775280722667, -0.07141525467181742)): shape (37, 800, 800)
      Valid pixels: 101358/640000 (15.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=295261, num_faces=295262
      Valid probs shape: (37, 101358)
    ✓ Random_13 (pose=(-2.7108640580891876, 0.027344371263553935, -3.0954056642563583)): shape (37, 800, 800)
      Valid pixels: 54588/640000 (8.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=858, max=295261, num_faces=295262
      Valid probs shape: (37, 54588)
    ✓ Random_14 (pose=(1.166825996453281, -1.0067910142197505, -2.6548789397566743)): shape (37, 800, 800)
      Valid pixels: 87754/640000 (13.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=295219, num_faces=295262
      Valid probs shape: (37, 87754)
    ✓ Random_15 (pose=(2.070552491069831, -0.48397095015896996, 0.13419588348939504)): shape (37, 800, 800)
      Valid pixels: 81325/640000 (12.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=295261, num_faces=295262
      Valid probs shape: (37, 81325)
    ✓ Random_16 (pose=(-2.970211503955253, -2.118993559563772, 1.1101055768745258)): shape (37, 800, 800)
      Valid pixels: 88078/640000 (13.8%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=1, max=295142, num_faces=295262
      Valid probs shape: (37, 88078)
    ✓ Random_17 (pose=(0.8916096391203974, 0.4580466157134975, 2.069016299340312)): shape (37, 800, 800)
      Valid pixels: 83176/640000 (13.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=294689, num_faces=295262
      Valid probs shape: (37, 83176)
    ✓ Random_18 (pose=(-2.938094011641821, -0.28969017170477995, -2.871281586297605)): shape (37, 800, 800)
      Valid pixels: 50168/640000 (7.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2998, max=295260, num_faces=295262
      Valid probs shape: (37, 50168)
    ✓ Random_19 (pose=(-1.5160770822475367, 2.708986607083644, 0.3048842805176295)): shape (37, 800, 800)
      Valid pixels: 84926/640000 (13.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=6, max=295221, num_faces=295262
      Valid probs shape: (37, 84926)
    ✓ Random_20 (pose=(-1.0412894684871672, 3.133780896880272, -0.5728352114331328)): shape (37, 800, 800)
      Valid pixels: 87580/640000 (13.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=42, max=295259, num_faces=295262
      Valid probs shape: (37, 87580)
    ✓ Random_21 (pose=(-1.5986264172906954, 1.7989669029465736, 0.0655188676517966)): shape (37, 800, 800)
      Valid pixels: 90601/640000 (14.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=13, max=295219, num_faces=295262
      Valid probs shape: (37, 90601)
    ✓ Random_22 (pose=(-2.980234000987434, -0.7485862309151723, -2.1414653781152118)): shape (37, 800, 800)
      Valid pixels: 77422/640000 (12.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=448, max=295261, num_faces=295262
      Valid probs shape: (37, 77422)
    ✓ Random_23 (pose=(1.2557653717981525, -2.0220045129847763, 0.035046639440615035)): shape (37, 800, 800)
      Valid pixels: 101831/640000 (15.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=295261, num_faces=295262
      Valid probs shape: (37, 101831)
    ✓ Random_24 (pose=(-2.0452350116792744, 2.301015746050524, -0.31927220184425975)): shape (37, 800, 800)
      Valid pixels: 88547/640000 (13.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=6, max=295219, num_faces=295262
      Valid probs shape: (37, 88547)
    ✓ Random_25 (pose=(-0.9165433452694054, -2.108920520783631, -0.18001882638223954)): shape (37, 800, 800)
      Valid pixels: 80117/640000 (12.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=10, max=295249, num_faces=295262
      Valid probs shape: (37, 80117)
    ✓ Random_26 (pose=(2.8216840329197295, -1.5794848794855902, 0.7776944973759488)): shape (37, 800, 800)
      Valid pixels: 80525/640000 (12.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=12, max=295195, num_faces=295262
      Valid probs shape: (37, 80525)
    ✓ Random_27 (pose=(0.5212126851908003, 0.4049398680980145, -2.951312700225728)): shape (37, 800, 800)
      Valid pixels: 56233/640000 (8.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=294980, num_faces=295262
      Valid probs shape: (37, 56233)
    ✓ Random_28 (pose=(-2.0417919906842354, 1.4063858116503987, 2.779681490593142)): shape (37, 800, 800)
      Valid pixels: 96190/640000 (15.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7, max=295261, num_faces=295262
      Valid probs shape: (37, 96190)
    ✓ Random_29 (pose=(0.7964147338268233, -1.2804693396116624, -0.6592075177985484)): shape (37, 800, 800)
      Valid pixels: 62346/640000 (9.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=295260, num_faces=295262
      Valid probs shape: (37, 62346)
    ✓ Random_30 (pose=(1.504472242506691, -1.0230013659323283, 1.9658471680210736)): shape (37, 800, 800)
      Valid pixels: 74328/640000 (11.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6, max=295199, num_faces=295262
      Valid probs shape: (37, 74328)
    ✓ Random_31 (pose=(2.18843546903953, -1.259831621674813, 2.824901638665014)): shape (37, 800, 800)
      Valid pixels: 84878/640000 (13.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=10, max=295215, num_faces=295262
      Valid probs shape: (37, 84878)
    ✓ Random_32 (pose=(-1.8169804930365494, 0.9174086299914634, -0.8951401157991214)): shape (37, 800, 800)
      Valid pixels: 94265/640000 (14.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=13, max=295253, num_faces=295262
      Valid probs shape: (37, 94265)
    ✓ Random_33 (pose=(-0.5029144116898481, -0.9040256356334568, -0.8216906496868215)): shape (37, 800, 800)
      Valid pixels: 80207/640000 (12.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=7, max=295220, num_faces=295262
      Valid probs shape: (37, 80207)
    ✓ Random_34 (pose=(2.2674196699895175, 0.8900318269806933, -1.3234893454956034)): shape (37, 800, 800)
      Valid pixels: 63143/640000 (9.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=704, max=295257, num_faces=295262
      Valid probs shape: (37, 63143)
    ✓ Random_35 (pose=(-1.098660507759888, -0.4629797933244597, -1.0321183656079307)): shape (37, 800, 800)
      Valid pixels: 87389/640000 (13.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=295207, num_faces=295262
      Valid probs shape: (37, 87389)
    ✓ Random_36 (pose=(1.1826832242106704, -2.5605794811250644, -1.5484910786726978)): shape (37, 800, 800)
      Valid pixels: 62773/640000 (9.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=692, max=295257, num_faces=295262
      Valid probs shape: (37, 62773)
    ✓ Random_37 (pose=(-2.550926376639811, -1.0342006597564084, 2.886215971888781)): shape (37, 800, 800)
      Valid pixels: 75179/640000 (11.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=131, max=295261, num_faces=295262
      Valid probs shape: (37, 75179)
    ✓ Random_38 (pose=(-2.510630380740068, -2.231031576332474, 2.042132195225941)): shape (37, 800, 800)
      Valid pixels: 58417/640000 (9.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=295115, num_faces=295262
      Valid probs shape: (37, 58417)
    ✓ Random_39 (pose=(1.5407560454108467, -0.419276939161084, 2.433170294168141)): shape (37, 800, 800)
      Valid pixels: 94595/640000 (14.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=17, max=295208, num_faces=295262
      Valid probs shape: (37, 94595)
    P stats: min=0.0000, max=0.9998, mean=0.0255
    Non-zero vertices: 139054/147633
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 8579 1932 1050 3641    0 2138 1269 5402 7270]
  Ground Truth Stats:
    Labels shape: (147633,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-18/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7622
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8098
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8097

  RESULTS:
  RAW:         median(top-10)=0.9056, mean(top-10)=0.9108, median(all)=0.8061, mean(all)=0.7622
  + SMOOTHING: median(top-10)=0.9225, mean(top-10)=0.9246, median(all)=0.8520, mean(all)=0.8098 [+0.0169]
  + MRF:       median(top-10)=0.9227, mean(top-10)=0.9244, median(all)=0.8526, mean(all)=0.8097 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0171

================================================================================
Subject: NKI-RS-22-19
================================================================================
  Step 0: Generating predictions with V2 model (40 random views)...
  Mesh: 141397 vertices, 282790 faces
  Generating 40 random views...
  Generating predictions for 40 views (continuous camera pose)...
    ✓ Random_0 (pose=(-0.8781855542020804, -2.6949406473882016, 1.6646786687206125)): shape (37, 800, 800)
      Valid pixels: 61728/640000 (9.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=552, max=282789, num_faces=282790
      Valid probs shape: (37, 61728)
    ✓ Random_1 (pose=(0.08965262003584273, 1.0293976859966403, 1.790689141262777)): shape (37, 800, 800)
      Valid pixels: 71479/640000 (11.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=282742, num_faces=282790
      Valid probs shape: (37, 71479)
    ✓ Random_2 (pose=(1.6231803944383012, -2.4038882877323857, 2.2506607934829086)): shape (37, 800, 800)
      Valid pixels: 81738/640000 (12.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=282747, num_faces=282790
      Valid probs shape: (37, 81738)
    ✓ Random_3 (pose=(-2.3717049351425477, -1.5820271801401442, -2.9075167529750496)): shape (37, 800, 800)
      Valid pixels: 90682/640000 (14.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=30, max=282781, num_faces=282790
      Valid probs shape: (37, 90682)
    ✓ Random_4 (pose=(-0.6121355743408876, 0.20770261338106444, -1.8596614817117867)): shape (37, 800, 800)
      Valid pixels: 50871/640000 (7.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=282685, num_faces=282790
      Valid probs shape: (37, 50871)
    ✓ Random_5 (pose=(-2.232995539053031, -1.7576230778178794, 2.6141371527612343)): shape (37, 800, 800)
      Valid pixels: 72248/640000 (11.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=100, max=282776, num_faces=282790
      Valid probs shape: (37, 72248)
    ✓ Random_6 (pose=(-1.773489223515354, -0.5116937007098468, 2.273422320342206)): shape (37, 800, 800)
      Valid pixels: 78901/640000 (12.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=145, max=282781, num_faces=282790
      Valid probs shape: (37, 78901)
    ✓ Random_7 (pose=(1.026196779198144, -2.9238008046824633, -3.1005907943855977)): shape (37, 800, 800)
      Valid pixels: 82578/640000 (12.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=713, max=282789, num_faces=282790
      Valid probs shape: (37, 82578)
    ✓ Random_8 (pose=(-1.276026645490093, -1.6559001149770658, -2.8154346401945776)): shape (37, 800, 800)
      Valid pixels: 74074/640000 (11.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7, max=282774, num_faces=282790
      Valid probs shape: (37, 74074)
    ✓ Random_9 (pose=(-2.215900909728503, 1.3577175789127018, 2.5772650452242285)): shape (37, 800, 800)
      Valid pixels: 87827/640000 (13.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=148, max=282781, num_faces=282790
      Valid probs shape: (37, 87827)
    ✓ Random_10 (pose=(-1.110983316775617, -2.4998283679031745, -0.534447223671096)): shape (37, 800, 800)
      Valid pixels: 86573/640000 (13.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=298, max=282789, num_faces=282790
      Valid probs shape: (37, 86573)
    ✓ Random_11 (pose=(-2.0580728317404366, -2.914093579376767, -1.2402889570860731)): shape (37, 800, 800)
      Valid pixels: 57665/640000 (9.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=281832, num_faces=282790
      Valid probs shape: (37, 57665)
    ✓ Random_12 (pose=(-0.6551697600755606, 2.4580003983743985, 2.318196596872993)): shape (37, 800, 800)
      Valid pixels: 49596/640000 (7.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=198, max=282787, num_faces=282790
      Valid probs shape: (37, 49596)
    ✓ Random_13 (pose=(0.9572899952880025, -1.2197141637267483, 0.8377162443144872)): shape (37, 800, 800)
      Valid pixels: 83961/640000 (13.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=282781, num_faces=282790
      Valid probs shape: (37, 83961)
    ✓ Random_14 (pose=(0.33443036042713636, 1.8167895797861036, 2.9067339823586913)): shape (37, 800, 800)
      Valid pixels: 64996/640000 (10.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=824, max=282787, num_faces=282790
      Valid probs shape: (37, 64996)
    ✓ Random_15 (pose=(1.4672681949948485, -0.44385574519670357, 0.6749966889040442)): shape (37, 800, 800)
      Valid pixels: 73505/640000 (11.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=8, max=282775, num_faces=282790
      Valid probs shape: (37, 73505)
    ✓ Random_16 (pose=(1.6298347127375168, 2.9256736844947557, -1.4423809318028746)): shape (37, 800, 800)
      Valid pixels: 60068/640000 (9.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=76, max=282781, num_faces=282790
      Valid probs shape: (37, 60068)
    ✓ Random_17 (pose=(-0.26566373364430973, -1.3430835004198654, -0.933758793802824)): shape (37, 800, 800)
      Valid pixels: 74211/640000 (11.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=282770, num_faces=282790
      Valid probs shape: (37, 74211)
    ✓ Random_18 (pose=(2.1670180501587337, 2.281556023473132, 1.4612219064242655)): shape (37, 800, 800)
      Valid pixels: 61549/640000 (9.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=282685, num_faces=282790
      Valid probs shape: (37, 61549)
    ✓ Random_19 (pose=(-0.9025966991283334, 0.5038565420940757, -0.8734155104016157)): shape (37, 800, 800)
      Valid pixels: 59946/640000 (9.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=282483, num_faces=282790
      Valid probs shape: (37, 59946)
    ✓ Random_20 (pose=(-2.3256813386897557, -2.208445051689151, -1.2908440199892957)): shape (37, 800, 800)
      Valid pixels: 56442/640000 (8.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=282685, num_faces=282790
      Valid probs shape: (37, 56442)
    ✓ Random_21 (pose=(2.775090550743619, -2.9730139809882634, -0.28086041795444094)): shape (37, 800, 800)
      Valid pixels: 53357/640000 (8.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=282685, num_faces=282790
      Valid probs shape: (37, 53357)
    ✓ Random_22 (pose=(2.9431109848732016, -0.9526194697588046, 0.5642347929317553)): shape (37, 800, 800)
      Valid pixels: 64075/640000 (10.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=289, max=282789, num_faces=282790
      Valid probs shape: (37, 64075)
    ✓ Random_23 (pose=(2.0937392588194523, 1.749831549700854, -0.9747389186236046)): shape (37, 800, 800)
      Valid pixels: 59503/640000 (9.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=47, max=282781, num_faces=282790
      Valid probs shape: (37, 59503)
    ✓ Random_24 (pose=(0.02280574969662652, 0.3316983342228368, 1.341192111171333)): shape (37, 800, 800)
      Valid pixels: 47708/640000 (7.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=281828, num_faces=282790
      Valid probs shape: (37, 47708)
    ✓ Random_25 (pose=(-1.9578923826427108, 0.7546921632541985, 0.894226311518902)): shape (37, 800, 800)
      Valid pixels: 61803/640000 (9.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=592, max=282788, num_faces=282790
      Valid probs shape: (37, 61803)
    ✓ Random_26 (pose=(1.1023616554840938, -0.683864477340526, -1.5870535163799715)): shape (37, 800, 800)
      Valid pixels: 60179/640000 (9.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=282773, num_faces=282790
      Valid probs shape: (37, 60179)
    ✓ Random_27 (pose=(2.929070855012988, 1.5328089695721339, 1.7861337319995778)): shape (37, 800, 800)
      Valid pixels: 79002/640000 (12.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=25, max=282779, num_faces=282790
      Valid probs shape: (37, 79002)
    ✓ Random_28 (pose=(-0.1296582903659278, -1.85972519782507, -1.2085653462918378)): shape (37, 800, 800)
      Valid pixels: 80624/640000 (12.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=199, max=282789, num_faces=282790
      Valid probs shape: (37, 80624)
    ✓ Random_29 (pose=(-0.12501858133034593, -1.4783673246444922, -2.3406671393814005)): shape (37, 800, 800)
      Valid pixels: 80160/640000 (12.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=282742, num_faces=282790
      Valid probs shape: (37, 80160)
    ✓ Random_30 (pose=(0.8839305675712428, 3.0868573466508753, 2.844896225357499)): shape (37, 800, 800)
      Valid pixels: 79219/640000 (12.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2732, max=282789, num_faces=282790
      Valid probs shape: (37, 79219)
    ✓ Random_31 (pose=(2.9908776983239296, 0.5396115469525724, 0.20550932293579383)): shape (37, 800, 800)
      Valid pixels: 46161/640000 (7.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=597, max=282781, num_faces=282790
      Valid probs shape: (37, 46161)
    ✓ Random_32 (pose=(2.8114176528915946, 1.3850160497106412, 1.7880516429497133)): shape (37, 800, 800)
      Valid pixels: 74672/640000 (11.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=24, max=282776, num_faces=282790
      Valid probs shape: (37, 74672)
    ✓ Random_33 (pose=(2.620326382231714, -3.099716867474571, 2.6504013663362977)): shape (37, 800, 800)
      Valid pixels: 55052/640000 (8.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=282543, num_faces=282790
      Valid probs shape: (37, 55052)
    ✓ Random_34 (pose=(0.05165754913534615, 0.6541253623270697, 1.663425299570343)): shape (37, 800, 800)
      Valid pixels: 60217/640000 (9.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=282543, num_faces=282790
      Valid probs shape: (37, 60217)
    ✓ Random_35 (pose=(0.7727148815745286, 1.763697961078602, 1.1336091462478617)): shape (37, 800, 800)
      Valid pixels: 69690/640000 (10.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=282771, num_faces=282790
      Valid probs shape: (37, 69690)
    ✓ Random_36 (pose=(0.7151416998445721, 0.809403145992805, 1.532516576510301)): shape (37, 800, 800)
      Valid pixels: 70016/640000 (10.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=282543, num_faces=282790
      Valid probs shape: (37, 70016)
    ✓ Random_37 (pose=(-0.29880249533518466, -2.1777671504454963, 0.2449650519533635)): shape (37, 800, 800)
      Valid pixels: 52898/640000 (8.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1056, max=282787, num_faces=282790
      Valid probs shape: (37, 52898)
    ✓ Random_38 (pose=(1.9685939532818129, 0.5151836665723541, -2.07634698289868)): shape (37, 800, 800)
      Valid pixels: 65925/640000 (10.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=515, max=282789, num_faces=282790
      Valid probs shape: (37, 65925)
    ✓ Random_39 (pose=(-1.8679275211324398, -1.7464615305043096, -0.07441968631833884)): shape (37, 800, 800)
      Valid pixels: 87589/640000 (13.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=23, max=282788, num_faces=282790
      Valid probs shape: (37, 87589)
    P stats: min=0.0000, max=1.0000, mean=0.0260
    Non-zero vertices: 136057/141397
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 5340 1633 1224 3412    0 1930 1179 4940 6263]
  Ground Truth Stats:
    Labels shape: (141397,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-19/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7876
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8373
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8373

  RESULTS:
  RAW:         median(top-10)=0.9144, mean(top-10)=0.9151, median(all)=0.8523, mean(all)=0.7876
  + SMOOTHING: median(top-10)=0.9327, mean(top-10)=0.9335, median(all)=0.8840, mean(all)=0.8373 [+0.0183]
  + MRF:       median(top-10)=0.9331, mean(top-10)=0.9338, median(all)=0.8842, mean(all)=0.8373 [+0.0004]
  TOTAL IMPROVEMENT (median top-10): +0.0186

================================================================================
Subject: NKI-RS-22-2
================================================================================
  Step 0: Generating predictions with V2 model (40 random views)...
  Mesh: 137791 vertices, 275578 faces
  Generating 40 random views...
  Generating predictions for 40 views (continuous camera pose)...
    ✓ Random_0 (pose=(0.4564204268447969, -2.7112787311337345, -2.148645542705351)): shape (37, 800, 800)
      Valid pixels: 68467/640000 (10.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3244, max=275576, num_faces=275578
      Valid probs shape: (37, 68467)
    ✓ Random_1 (pose=(-1.6714977061570049, -2.325727584826957, -0.30467298189191716)): shape (37, 800, 800)
      Valid pixels: 96860/640000 (15.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=275577, num_faces=275578
      Valid probs shape: (37, 96860)
    ✓ Random_2 (pose=(-1.4296946585429842, 2.1071136199675493, -1.081785241960636)): shape (37, 800, 800)
      Valid pixels: 79053/640000 (12.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=125, max=275577, num_faces=275578
      Valid probs shape: (37, 79053)
    ✓ Random_3 (pose=(-0.8427279181272067, -2.2232363322438413, 1.1979082304782223)): shape (37, 800, 800)
      Valid pixels: 69611/640000 (10.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=602, max=275485, num_faces=275578
      Valid probs shape: (37, 69611)
    ✓ Random_4 (pose=(1.0099300137254703, -1.3066848041445742, -2.423172155682718)): shape (37, 800, 800)
      Valid pixels: 84535/640000 (13.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=3, max=275577, num_faces=275578
      Valid probs shape: (37, 84535)
    ✓ Random_5 (pose=(-2.3206073219715124, 1.9726532065830336, -1.7603426765277488)): shape (37, 800, 800)
      Valid pixels: 83499/640000 (13.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=275577, num_faces=275578
      Valid probs shape: (37, 83499)
    ✓ Random_6 (pose=(0.15571931228632874, -2.2237053070829393, 0.14002646494064885)): shape (37, 800, 800)
      Valid pixels: 66738/640000 (10.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=667, max=275476, num_faces=275578
      Valid probs shape: (37, 66738)
    ✓ Random_7 (pose=(0.5132238719239468, -1.9263123367116262, 1.8613184829531448)): shape (37, 800, 800)
      Valid pixels: 71097/640000 (11.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=9, max=275577, num_faces=275578
      Valid probs shape: (37, 71097)
    ✓ Random_8 (pose=(-0.3118058194127009, -3.0780641387892036, 1.384740222791251)): shape (37, 800, 800)
      Valid pixels: 42110/640000 (6.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1341, max=275575, num_faces=275578
      Valid probs shape: (37, 42110)
    ✓ Random_9 (pose=(-2.8663475524794104, 1.324135488558139, 1.8218446386206848)): shape (37, 800, 800)
      Valid pixels: 95561/640000 (14.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=10, max=275473, num_faces=275578
      Valid probs shape: (37, 95561)
    ✓ Random_10 (pose=(-0.4700014573887912, -0.3102129484523535, 2.8170763179799483)): shape (37, 800, 800)
      Valid pixels: 62883/640000 (9.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=275323, num_faces=275578
      Valid probs shape: (37, 62883)
    ✓ Random_11 (pose=(0.13933639914161589, -0.34999703187286, 1.5407463030008302)): shape (37, 800, 800)
      Valid pixels: 52279/640000 (8.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=275356, num_faces=275578
      Valid probs shape: (37, 52279)
    ✓ Random_12 (pose=(-0.6361161555302459, 1.0124501703325706, 2.993480758181396)): shape (37, 800, 800)
      Valid pixels: 81742/640000 (12.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=275496, num_faces=275578
      Valid probs shape: (37, 81742)
    ✓ Random_13 (pose=(-2.508539371742958, -1.4146184134531574, -2.315850585790424)): shape (37, 800, 800)
      Valid pixels: 99569/640000 (15.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=9, max=275500, num_faces=275578
      Valid probs shape: (37, 99569)
    ✓ Random_14 (pose=(-3.0742505283528985, -0.6310184138287651, -1.3321609117716617)): shape (37, 800, 800)
      Valid pixels: 61936/640000 (9.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=26, max=275575, num_faces=275578
      Valid probs shape: (37, 61936)
    ✓ Random_15 (pose=(-0.40974986926255363, -2.6949537506178376, 2.364413507450233)): shape (37, 800, 800)
      Valid pixels: 64368/640000 (10.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=888, max=275575, num_faces=275578
      Valid probs shape: (37, 64368)
    ✓ Random_16 (pose=(1.5521813172801044, 2.161916074363554, -2.8285444045080657)): shape (37, 800, 800)
      Valid pixels: 80828/640000 (12.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=16, max=275577, num_faces=275578
      Valid probs shape: (37, 80828)
    ✓ Random_17 (pose=(1.1719082384505306, -1.9363598003419862, 1.3922364425218978)): shape (37, 800, 800)
      Valid pixels: 68259/640000 (10.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=275577, num_faces=275578
      Valid probs shape: (37, 68259)
    ✓ Random_18 (pose=(-0.3151508828169276, -0.42185222812954226, 2.30243346094145)): shape (37, 800, 800)
      Valid pixels: 62305/640000 (9.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=275320, num_faces=275578
      Valid probs shape: (37, 62305)
    ✓ Random_19 (pose=(1.553227334237807, -1.597402350139246, 2.6772519836849007)): shape (37, 800, 800)
      Valid pixels: 97258/640000 (15.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=275577, num_faces=275578
      Valid probs shape: (37, 97258)
    ✓ Random_20 (pose=(-0.3051077788991212, 2.500707495067429, 0.2320052159147057)): shape (37, 800, 800)
      Valid pixels: 73797/640000 (11.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=17469, max=275577, num_faces=275578
      Valid probs shape: (37, 73797)
    ✓ Random_21 (pose=(0.18307176063189923, -1.578787910096929, 1.4767528083088184)): shape (37, 800, 800)
      Valid pixels: 96183/640000 (15.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8, max=275479, num_faces=275578
      Valid probs shape: (37, 96183)
    ✓ Random_22 (pose=(0.9502680871239502, 0.4867215282936308, 2.2775580992965123)): shape (37, 800, 800)
      Valid pixels: 86913/640000 (13.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=275577, num_faces=275578
      Valid probs shape: (37, 86913)
    ✓ Random_23 (pose=(-0.8385565636297616, -1.7892097693817308, -0.4088531296518392)): shape (37, 800, 800)
      Valid pixels: 82066/640000 (12.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=112, max=275577, num_faces=275578
      Valid probs shape: (37, 82066)
    ✓ Random_24 (pose=(2.9916551760690195, 0.7110325728608426, 1.1809828718614988)): shape (37, 800, 800)
      Valid pixels: 71961/640000 (11.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=397, max=275566, num_faces=275578
      Valid probs shape: (37, 71961)
    ✓ Random_25 (pose=(0.128518228733149, -3.1035534992797142, 1.2392963462840472)): shape (37, 800, 800)
      Valid pixels: 42804/640000 (6.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=16330, max=275577, num_faces=275578
      Valid probs shape: (37, 42804)
    ✓ Random_26 (pose=(2.370896174013499, 1.394915137962636, 0.1524825494066988)): shape (37, 800, 800)
      Valid pixels: 99418/640000 (15.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=58, max=275496, num_faces=275578
      Valid probs shape: (37, 99418)
    ✓ Random_27 (pose=(-3.075076725570462, -1.9653876098332286, -2.1516269607411864)): shape (37, 800, 800)
      Valid pixels: 94350/640000 (14.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=275500, num_faces=275578
      Valid probs shape: (37, 94350)
    ✓ Random_28 (pose=(-1.5809085254441526, -1.6774300534863225, -0.5993384117730738)): shape (37, 800, 800)
      Valid pixels: 96447/640000 (15.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=275577, num_faces=275578
      Valid probs shape: (37, 96447)
    ✓ Random_29 (pose=(1.2402707860283222, 1.4944183276832792, -0.9278279336483011)): shape (37, 800, 800)
      Valid pixels: 100699/640000 (15.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=11, max=275500, num_faces=275578
      Valid probs shape: (37, 100699)
    ✓ Random_30 (pose=(-2.6945965213827905, -2.1336138415533368, -1.129849150878838)): shape (37, 800, 800)
      Valid pixels: 63289/640000 (9.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=275273, num_faces=275578
      Valid probs shape: (37, 63289)
    ✓ Random_31 (pose=(-0.6133597023610768, -2.4444903745700524, -1.6261835543307057)): shape (37, 800, 800)
      Valid pixels: 80173/640000 (12.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=13029, max=275576, num_faces=275578
      Valid probs shape: (37, 80173)
    ✓ Random_32 (pose=(-1.0426728850300484, -0.061256066653879504, -0.07108232937040171)): shape (37, 800, 800)
      Valid pixels: 82463/640000 (12.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=0, max=275577, num_faces=275578
      Valid probs shape: (37, 82463)
    ✓ Random_33 (pose=(-0.10917563094901928, 2.6856926797368956, -1.81459475470965)): shape (37, 800, 800)
      Valid pixels: 57465/640000 (9.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1053, max=275575, num_faces=275578
      Valid probs shape: (37, 57465)
    ✓ Random_34 (pose=(-2.7761358503024303, -2.196447520557118, -0.04820584628320379)): shape (37, 800, 800)
      Valid pixels: 71065/640000 (11.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=275577, num_faces=275578
      Valid probs shape: (37, 71065)
    ✓ Random_35 (pose=(-0.5949854504276249, -2.318705757349891, -3.054178615805536)): shape (37, 800, 800)
      Valid pixels: 65332/640000 (10.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=351, max=275577, num_faces=275578
      Valid probs shape: (37, 65332)
    ✓ Random_36 (pose=(-1.9449885676815675, -0.6022939487042263, 1.0509018342524277)): shape (37, 800, 800)
      Valid pixels: 69550/640000 (10.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=735, max=275577, num_faces=275578
      Valid probs shape: (37, 69550)
    ✓ Random_37 (pose=(0.707534958045251, -2.0073964810955456, -1.9926971456799398)): shape (37, 800, 800)
      Valid pixels: 80934/640000 (12.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=258, max=275577, num_faces=275578
      Valid probs shape: (37, 80934)
    ✓ Random_38 (pose=(2.869821841818248, -0.07911346820051968, -1.3801555505070338)): shape (37, 800, 800)
      Valid pixels: 43216/640000 (6.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1321, max=275572, num_faces=275578
      Valid probs shape: (37, 43216)
    ✓ Random_39 (pose=(-1.330114468267942, 1.552509926920317, 3.0868352039398976)): shape (37, 800, 800)
      Valid pixels: 102491/640000 (16.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=10, max=275500, num_faces=275578
      Valid probs shape: (37, 102491)
    P stats: min=0.0000, max=0.9999, mean=0.0258
    Non-zero vertices: 131385/137791
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 6406 1427 1008 3491    0 1517 1143 4532 6491]
  Ground Truth Stats:
    Labels shape: (137791,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-2/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7755
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8214
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8214

  RESULTS:
  RAW:         median(top-10)=0.9055, mean(top-10)=0.9081, median(all)=0.8461, mean(all)=0.7755
  + SMOOTHING: median(top-10)=0.9216, mean(top-10)=0.9244, median(all)=0.8764, mean(all)=0.8214 [+0.0161]
  + MRF:       median(top-10)=0.9224, mean(top-10)=0.9248, median(all)=0.8769, mean(all)=0.8214 [+0.0008]
  TOTAL IMPROVEMENT (median top-10): +0.0169

================================================================================
Subject: NKI-RS-22-20
================================================================================
  Step 0: Generating predictions with V2 model (40 random views)...
  Mesh: 140825 vertices, 281646 faces
  Generating 40 random views...
  Generating predictions for 40 views (continuous camera pose)...
    ✓ Random_0 (pose=(-0.9115929415971737, -1.9913946582226905, 0.24639343840579198)): shape (37, 800, 800)
      Valid pixels: 73815/640000 (11.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=259, max=281644, num_faces=281646
      Valid probs shape: (37, 73815)
    ✓ Random_1 (pose=(-1.354104448973816, -1.5855162223510355, 1.1529729223552732)): shape (37, 800, 800)
      Valid pixels: 69090/640000 (10.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=7, max=281645, num_faces=281646
      Valid probs shape: (37, 69090)
    ✓ Random_2 (pose=(-1.8996401950637558, -1.3808283546756153, -2.049322241954553)): shape (37, 800, 800)
      Valid pixels: 76270/640000 (11.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=10, max=281535, num_faces=281646
      Valid probs shape: (37, 76270)
    ✓ Random_3 (pose=(-0.4560557369610718, -1.0047967692302748, 0.6134048851412324)): shape (37, 800, 800)
      Valid pixels: 60630/640000 (9.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=281644, num_faces=281646
      Valid probs shape: (37, 60630)
    ✓ Random_4 (pose=(2.964934577884484, 0.08314953103531586, -2.5717449844451945)): shape (37, 800, 800)
      Valid pixels: 53123/640000 (8.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=15466, max=281645, num_faces=281646
      Valid probs shape: (37, 53123)
    ✓ Random_5 (pose=(2.6611567283475344, -2.05743464119203, 1.2461061294531541)): shape (37, 800, 800)
      Valid pixels: 89152/640000 (13.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=281477, num_faces=281646
      Valid probs shape: (37, 89152)
    ✓ Random_6 (pose=(2.03965865589178, 1.6456584187040288, -0.6384416083959348)): shape (37, 800, 800)
      Valid pixels: 89611/640000 (14.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=281644, num_faces=281646
      Valid probs shape: (37, 89611)
    ✓ Random_7 (pose=(-0.8733566297125139, -1.8012011754641126, -2.9071390651279554)): shape (37, 800, 800)
      Valid pixels: 73213/640000 (11.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7, max=281535, num_faces=281646
      Valid probs shape: (37, 73213)
    ✓ Random_8 (pose=(2.7393443485439866, 2.1713077658053015, 2.9800754905995985)): shape (37, 800, 800)
      Valid pixels: 74965/640000 (11.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=281477, num_faces=281646
      Valid probs shape: (37, 74965)
    ✓ Random_9 (pose=(-2.710192289914219, -1.3990799778297829, -1.7683430009181218)): shape (37, 800, 800)
      Valid pixels: 91058/640000 (14.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=8, max=281558, num_faces=281646
      Valid probs shape: (37, 91058)
    ✓ Random_10 (pose=(1.170752408904315, 1.3966655767745655, -0.09536793012320022)): shape (37, 800, 800)
      Valid pixels: 89191/640000 (13.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=281537, num_faces=281646
      Valid probs shape: (37, 89191)
    ✓ Random_11 (pose=(-2.5807850690568306, 2.4695615071240606, -0.6487532691138083)): shape (37, 800, 800)
      Valid pixels: 74531/640000 (11.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=281473, num_faces=281646
      Valid probs shape: (37, 74531)
    ✓ Random_12 (pose=(-0.23681468699106611, 2.1954321302661315, 1.880013673464627)): shape (37, 800, 800)
      Valid pixels: 74773/640000 (11.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2628, max=281645, num_faces=281646
      Valid probs shape: (37, 74773)
    ✓ Random_13 (pose=(1.5946826779097307, 0.6199893229805258, -0.22085491524684553)): shape (37, 800, 800)
      Valid pixels: 103378/640000 (16.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=281594, num_faces=281646
      Valid probs shape: (37, 103378)
    ✓ Random_14 (pose=(2.553270817599058, -2.732087949583646, 0.47939077605438163)): shape (37, 800, 800)
      Valid pixels: 60267/640000 (9.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=281533, num_faces=281646
      Valid probs shape: (37, 60267)
    ✓ Random_15 (pose=(2.9292688342090702, -1.093840975199933, -1.7147236699788708)): shape (37, 800, 800)
      Valid pixels: 97071/640000 (15.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=31, max=281636, num_faces=281646
      Valid probs shape: (37, 97071)
    ✓ Random_16 (pose=(0.8669841792586332, -2.2827036742965894, 1.5801447934281372)): shape (37, 800, 800)
      Valid pixels: 69682/640000 (10.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=596, max=281636, num_faces=281646
      Valid probs shape: (37, 69682)
    ✓ Random_17 (pose=(-1.170252928127831, -2.782383663432869, 2.5831518623805554)): shape (37, 800, 800)
      Valid pixels: 100313/640000 (15.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=281635, num_faces=281646
      Valid probs shape: (37, 100313)
    ✓ Random_18 (pose=(-1.478154421578174, 2.8286293636977557, 1.4624177979393025)): shape (37, 800, 800)
      Valid pixels: 69206/640000 (10.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=37, max=281645, num_faces=281646
      Valid probs shape: (37, 69206)
    ✓ Random_19 (pose=(-3.095988991204612, 1.6051747025148329, -2.964382432839902)): shape (37, 800, 800)
      Valid pixels: 70767/640000 (11.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=281478, num_faces=281646
      Valid probs shape: (37, 70767)
    ✓ Random_20 (pose=(2.230879847271204, -2.4237521633175483, 2.9026150800994035)): shape (37, 800, 800)
      Valid pixels: 78867/640000 (12.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=5, max=281472, num_faces=281646
      Valid probs shape: (37, 78867)
    ✓ Random_21 (pose=(2.2006079178416345, 1.598518506471649, -2.482775545422597)): shape (37, 800, 800)
      Valid pixels: 90780/640000 (14.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=20, max=281470, num_faces=281646
      Valid probs shape: (37, 90780)
    ✓ Random_22 (pose=(0.054303336998274165, 2.4418894698209117, 1.9215460287285309)): shape (37, 800, 800)
      Valid pixels: 73612/640000 (11.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3492, max=281645, num_faces=281646
      Valid probs shape: (37, 73612)
    ✓ Random_23 (pose=(1.9433488635161424, -0.16750827803184398, 2.755243550819074)): shape (37, 800, 800)
      Valid pixels: 94543/640000 (14.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=74, max=281630, num_faces=281646
      Valid probs shape: (37, 94543)
    ✓ Random_24 (pose=(1.0618362044490492, -0.1737349996436479, -1.563956616728722)): shape (37, 800, 800)
      Valid pixels: 60753/640000 (9.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=281643, num_faces=281646
      Valid probs shape: (37, 60753)
    ✓ Random_25 (pose=(1.211624713547229, -3.062370982817422, 2.4368914766647434)): shape (37, 800, 800)
      Valid pixels: 93110/640000 (14.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=79, max=281634, num_faces=281646
      Valid probs shape: (37, 93110)
    ✓ Random_26 (pose=(1.0534075939849474, 2.801945541759914, -0.7471336409714189)): shape (37, 800, 800)
      Valid pixels: 95801/640000 (15.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=54, max=281645, num_faces=281646
      Valid probs shape: (37, 95801)
    ✓ Random_27 (pose=(1.1552029050506203, -0.3200174767800079, -2.8165987632576064)): shape (37, 800, 800)
      Valid pixels: 81440/640000 (12.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=281582, num_faces=281646
      Valid probs shape: (37, 81440)
    ✓ Random_28 (pose=(-1.0556599075449715, 2.78015492778494, 2.353047531217255)): shape (37, 800, 800)
      Valid pixels: 87412/640000 (13.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=281645, num_faces=281646
      Valid probs shape: (37, 87412)
    ✓ Random_29 (pose=(-0.7868357225419822, -2.3832189823677643, -0.4853781655487239)): shape (37, 800, 800)
      Valid pixels: 85871/640000 (13.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1091, max=281645, num_faces=281646
      Valid probs shape: (37, 85871)
    ✓ Random_30 (pose=(2.7648908000863095, -2.974399291818059, 2.1830300883486995)): shape (37, 800, 800)
      Valid pixels: 61969/640000 (9.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=281476, num_faces=281646
      Valid probs shape: (37, 61969)
    ✓ Random_31 (pose=(2.260089893374313, -1.892753193824838, -1.1755218340823643)): shape (37, 800, 800)
      Valid pixels: 100519/640000 (15.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=281594, num_faces=281646
      Valid probs shape: (37, 100519)
    ✓ Random_32 (pose=(2.982016638499646, -2.0290244089179796, -2.3770146165962918)): shape (37, 800, 800)
      Valid pixels: 82539/640000 (12.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=281540, num_faces=281646
      Valid probs shape: (37, 82539)
    ✓ Random_33 (pose=(-0.9912138779456225, -2.0565999760521065, 0.6940727894513357)): shape (37, 800, 800)
      Valid pixels: 70645/640000 (11.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=264, max=281644, num_faces=281646
      Valid probs shape: (37, 70645)
    ✓ Random_34 (pose=(-2.217476802438174, -2.3034460710460425, -1.1895185795192469)): shape (37, 800, 800)
      Valid pixels: 61545/640000 (9.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=281460, num_faces=281646
      Valid probs shape: (37, 61545)
    ✓ Random_35 (pose=(-2.68708829987648, 2.4349353660407704, -0.8394667469146393)): shape (37, 800, 800)
      Valid pixels: 74625/640000 (11.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=281473, num_faces=281646
      Valid probs shape: (37, 74625)
    ✓ Random_36 (pose=(2.244007225237623, -1.0597557313142212, -0.047905745060124794)): shape (37, 800, 800)
      Valid pixels: 79726/640000 (12.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=37, max=281535, num_faces=281646
      Valid probs shape: (37, 79726)
    ✓ Random_37 (pose=(-0.9547872923312419, 2.854028114256658, 1.3687751490270124)): shape (37, 800, 800)
      Valid pixels: 67250/640000 (10.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=294, max=281644, num_faces=281646
      Valid probs shape: (37, 67250)
    ✓ Random_38 (pose=(-2.693688583172663, -2.06443234139981, -0.44989070918994045)): shape (37, 800, 800)
      Valid pixels: 64599/640000 (10.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=281476, num_faces=281646
      Valid probs shape: (37, 64599)
    ✓ Random_39 (pose=(0.8365228199324903, 0.392523999022945, 0.26234084335683194)): shape (37, 800, 800)
      Valid pixels: 71633/640000 (11.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=281535, num_faces=281646
      Valid probs shape: (37, 71633)
    P stats: min=0.0000, max=0.9999, mean=0.0263
    Non-zero vertices: 136912/140825
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 3913 1550  831 3422    0 2852 1263 4774 7086]
  Ground Truth Stats:
    Labels shape: (140825,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-20/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7785
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8254
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8257

  RESULTS:
  RAW:         median(top-10)=0.8957, mean(top-10)=0.9062, median(all)=0.8284, mean(all)=0.7785
  + SMOOTHING: median(top-10)=0.9251, mean(top-10)=0.9234, median(all)=0.8462, mean(all)=0.8254 [+0.0294]
  + MRF:       median(top-10)=0.9256, mean(top-10)=0.9237, median(all)=0.8464, mean(all)=0.8257 [+0.0005]
  TOTAL IMPROVEMENT (median top-10): +0.0299

================================================================================
Subject: NKI-RS-22-21
================================================================================
  Step 0: Generating predictions with V2 model (40 random views)...
  Mesh: 138920 vertices, 277836 faces
  Generating 40 random views...
  Generating predictions for 40 views (continuous camera pose)...
    ✓ Random_0 (pose=(-1.0149130599541656, -0.8925345231630062, 1.2625085829358165)): shape (37, 800, 800)
      Valid pixels: 61228/640000 (9.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=13, max=277835, num_faces=277836
      Valid probs shape: (37, 61228)
    ✓ Random_1 (pose=(-1.5721702565541276, 0.20822217144523902, -1.195473689758765)): shape (37, 800, 800)
      Valid pixels: 74196/640000 (11.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=14, max=277103, num_faces=277836
      Valid probs shape: (37, 74196)
    ✓ Random_2 (pose=(-1.1291953484320727, 2.819305762663678, 1.2847431296998089)): shape (37, 800, 800)
      Valid pixels: 61734/640000 (9.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=937, max=277835, num_faces=277836
      Valid probs shape: (37, 61734)
    ✓ Random_3 (pose=(-0.27330427077853336, 1.0460535002114248, -0.5288130563276767)): shape (37, 800, 800)
      Valid pixels: 53599/640000 (8.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=277831, num_faces=277836
      Valid probs shape: (37, 53599)
    ✓ Random_4 (pose=(1.1837014498185212, -0.5519429131098899, 2.6550518820816826)): shape (37, 800, 800)
      Valid pixels: 84209/640000 (13.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=21, max=277103, num_faces=277836
      Valid probs shape: (37, 84209)
    ✓ Random_5 (pose=(1.0610049729819488, 1.2255852836780416, -2.192917430469503)): shape (37, 800, 800)
      Valid pixels: 60607/640000 (9.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=98, max=277824, num_faces=277836
      Valid probs shape: (37, 60607)
    ✓ Random_6 (pose=(2.667594012220869, -1.8616851686723286, 0.27348295402485423)): shape (37, 800, 800)
      Valid pixels: 56315/640000 (8.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=8, max=277831, num_faces=277836
      Valid probs shape: (37, 56315)
    ✓ Random_7 (pose=(-2.710992142196096, 3.0615845101389096, -2.092950517215497)): shape (37, 800, 800)
      Valid pixels: 42767/640000 (6.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=277826, num_faces=277836
      Valid probs shape: (37, 42767)
    ✓ Random_8 (pose=(-0.10269125325805994, 0.8239299469111256, -2.189849794776115)): shape (37, 800, 800)
      Valid pixels: 75903/640000 (11.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=277835, num_faces=277836
      Valid probs shape: (37, 75903)
    ✓ Random_9 (pose=(-1.8655246471229097, -1.9962151155867893, 2.792193643825529)): shape (37, 800, 800)
      Valid pixels: 92744/640000 (14.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=58, max=277830, num_faces=277836
      Valid probs shape: (37, 92744)
    ✓ Random_10 (pose=(2.7691512263580886, -0.0394138996972746, -0.432924865625262)): shape (37, 800, 800)
      Valid pixels: 45757/640000 (7.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=117, max=277835, num_faces=277836
      Valid probs shape: (37, 45757)
    ✓ Random_11 (pose=(-2.535754408317665, -0.8558857890897635, 2.765997701550395)): shape (37, 800, 800)
      Valid pixels: 65384/640000 (10.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=117, max=277835, num_faces=277836
      Valid probs shape: (37, 65384)
    ✓ Random_12 (pose=(-0.7145895294929927, -1.6296974687686134, 1.4896180779675392)): shape (37, 800, 800)
      Valid pixels: 89855/640000 (14.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=71, max=277829, num_faces=277836
      Valid probs shape: (37, 89855)
    ✓ Random_13 (pose=(-1.0294035703808144, -3.0232818147111495, 2.5373287206584365)): shape (37, 800, 800)
      Valid pixels: 82687/640000 (12.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=277834, num_faces=277836
      Valid probs shape: (37, 82687)
    ✓ Random_14 (pose=(-1.1879896629023874, -2.880474493916877, -0.06950613286644902)): shape (37, 800, 800)
      Valid pixels: 84342/640000 (13.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=648, max=277835, num_faces=277836
      Valid probs shape: (37, 84342)
    ✓ Random_15 (pose=(-0.8356333392255579, -1.2338328996488748, -0.24525304997632658)): shape (37, 800, 800)
      Valid pixels: 70267/640000 (11.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=8, max=277830, num_faces=277836
      Valid probs shape: (37, 70267)
    ✓ Random_16 (pose=(0.3995868036557102, -2.446997043731475, -1.512700595868078)): shape (37, 800, 800)
      Valid pixels: 64381/640000 (10.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=944, max=277835, num_faces=277836
      Valid probs shape: (37, 64381)
    ✓ Random_17 (pose=(-2.2635983350153017, 1.1592479290237492, -0.4240993328213607)): shape (37, 800, 800)
      Valid pixels: 79792/640000 (12.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=504, max=277835, num_faces=277836
      Valid probs shape: (37, 79792)
    ✓ Random_18 (pose=(-2.544622174261554, -3.086046177716835, -2.0119446251329487)): shape (37, 800, 800)
      Valid pixels: 48851/640000 (7.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=277831, num_faces=277836
      Valid probs shape: (37, 48851)
    ✓ Random_19 (pose=(-1.5714799455473678, -0.26644552728581106, -2.454167903743695)): shape (37, 800, 800)
      Valid pixels: 71334/640000 (11.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=277831, num_faces=277836
      Valid probs shape: (37, 71334)
    ✓ Random_20 (pose=(-1.3661649378466725, -1.4871133044348737, -2.7946088288505098)): shape (37, 800, 800)
      Valid pixels: 75082/640000 (11.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=8, max=277833, num_faces=277836
      Valid probs shape: (37, 75082)
    ✓ Random_21 (pose=(-0.4131884040947549, 0.8669701893880468, 2.4536500789907825)): shape (37, 800, 800)
      Valid pixels: 53945/640000 (8.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=277835, num_faces=277836
      Valid probs shape: (37, 53945)
    ✓ Random_22 (pose=(-2.704241683505728, -0.40514144793107887, -2.737598115304051)): shape (37, 800, 800)
      Valid pixels: 57324/640000 (9.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=117, max=277835, num_faces=277836
      Valid probs shape: (37, 57324)
    ✓ Random_23 (pose=(0.6905115223570362, 0.8476195011373262, -0.8065210106700653)): shape (37, 800, 800)
      Valid pixels: 82988/640000 (13.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=277829, num_faces=277836
      Valid probs shape: (37, 82988)
    ✓ Random_24 (pose=(-2.77294075828811, -0.07245830796113717, -2.8076933164010707)): shape (37, 800, 800)
      Valid pixels: 45842/640000 (7.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=117, max=277835, num_faces=277836
      Valid probs shape: (37, 45842)
    ✓ Random_25 (pose=(-2.930821560142589, -1.1000419182968937, 0.8903905720601042)): shape (37, 800, 800)
      Valid pixels: 87062/640000 (13.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1678, max=277834, num_faces=277836
      Valid probs shape: (37, 87062)
    ✓ Random_26 (pose=(1.2578044096668908, 2.6996680978585106, -0.9462880657648776)): shape (37, 800, 800)
      Valid pixels: 86361/640000 (13.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=277831, num_faces=277836
      Valid probs shape: (37, 86361)
    ✓ Random_27 (pose=(1.8985229387604363, -1.668947279976181, 0.9892118978980715)): shape (37, 800, 800)
      Valid pixels: 58294/640000 (9.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=11, max=277830, num_faces=277836
      Valid probs shape: (37, 58294)
    ✓ Random_28 (pose=(-2.793398291205134, -0.3078666141949902, -2.1044216493928145)): shape (37, 800, 800)
      Valid pixels: 48987/640000 (7.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=508, max=277835, num_faces=277836
      Valid probs shape: (37, 48987)
    ✓ Random_29 (pose=(1.9331181786014007, 2.2771769741813808, 2.900430321384081)): shape (37, 800, 800)
      Valid pixels: 88121/640000 (13.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=20, max=277103, num_faces=277836
      Valid probs shape: (37, 88121)
    ✓ Random_30 (pose=(2.528432878997866, -1.4913277186724714, 1.2440619669232218)): shape (37, 800, 800)
      Valid pixels: 83704/640000 (13.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=277591, num_faces=277836
      Valid probs shape: (37, 83704)
    ✓ Random_31 (pose=(-1.3278202283389542, -0.315151917388111, 1.2375003074716258)): shape (37, 800, 800)
      Valid pixels: 60659/640000 (9.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=39, max=277824, num_faces=277836
      Valid probs shape: (37, 60659)
    ✓ Random_32 (pose=(2.9161346609705427, -0.5750350985391601, 1.3883256554556356)): shape (37, 800, 800)
      Valid pixels: 70945/640000 (11.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=29736, max=277835, num_faces=277836
      Valid probs shape: (37, 70945)
    ✓ Random_33 (pose=(-1.1356179064282665, -2.496668637762325, 2.9942386123979183)): shape (37, 800, 800)
      Valid pixels: 82713/640000 (12.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=277833, num_faces=277836
      Valid probs shape: (37, 82713)
    ✓ Random_34 (pose=(-2.5980723290399728, 2.187048858211803, 3.070986548719244)): shape (37, 800, 800)
      Valid pixels: 61843/640000 (9.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=15, max=277830, num_faces=277836
      Valid probs shape: (37, 61843)
    ✓ Random_35 (pose=(-2.273735349953241, -1.6539316500330679, 0.6020244953513849)): shape (37, 800, 800)
      Valid pixels: 86254/640000 (13.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=18, max=277831, num_faces=277836
      Valid probs shape: (37, 86254)
    ✓ Random_36 (pose=(2.458580756245139, 1.1621910858261817, -1.3341909276870536)): shape (37, 800, 800)
      Valid pixels: 64646/640000 (10.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=937, max=277834, num_faces=277836
      Valid probs shape: (37, 64646)
    ✓ Random_37 (pose=(-0.6540059192903676, -2.6765155630768787, 2.8907929600653715)): shape (37, 800, 800)
      Valid pixels: 63636/640000 (9.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=153, max=277834, num_faces=277836
      Valid probs shape: (37, 63636)
    ✓ Random_38 (pose=(-2.9049094955472103, 2.5293693125016743, 0.7201621998809968)): shape (37, 800, 800)
      Valid pixels: 54172/640000 (8.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=277835, num_faces=277836
      Valid probs shape: (37, 54172)
    ✓ Random_39 (pose=(0.15359089336915766, -0.5784849883187557, -1.035952916158084)): shape (37, 800, 800)
      Valid pixels: 51271/640000 (8.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=277703, num_faces=277836
      Valid probs shape: (37, 51271)
    P stats: min=0.0000, max=1.0000, mean=0.0259
    Non-zero vertices: 132886/138920
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 6034 1371 1193 3447    0 2542 1155 5090 5990]
  Ground Truth Stats:
    Labels shape: (138920,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-21/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7944
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8416
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8416

  RESULTS:
  RAW:         median(top-10)=0.8972, mean(top-10)=0.9025, median(all)=0.8513, mean(all)=0.7944
  + SMOOTHING: median(top-10)=0.9156, mean(top-10)=0.9194, median(all)=0.8809, mean(all)=0.8416 [+0.0184]
  + MRF:       median(top-10)=0.9154, mean(top-10)=0.9196, median(all)=0.8808, mean(all)=0.8416 [-0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0182

================================================================================
Subject: NKI-RS-22-22
================================================================================
  Step 0: Generating predictions with V2 model (40 random views)...
  Mesh: 129976 vertices, 259948 faces
  Generating 40 random views...
  Generating predictions for 40 views (continuous camera pose)...
    ✓ Random_0 (pose=(0.15672647939741324, 0.8514596443913911, -0.03320456505937175)): shape (37, 800, 800)
      Valid pixels: 54005/640000 (8.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=259850, num_faces=259948
      Valid probs shape: (37, 54005)
    ✓ Random_1 (pose=(-2.832280493527533, 2.6740846317857487, 1.2486257926737396)): shape (37, 800, 800)
      Valid pixels: 57187/640000 (8.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=259945, num_faces=259948
      Valid probs shape: (37, 57187)
    ✓ Random_2 (pose=(3.1008199859260674, 1.713902171005703, 1.8915935029771802)): shape (37, 800, 800)
      Valid pixels: 79147/640000 (12.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=16, max=259946, num_faces=259948
      Valid probs shape: (37, 79147)
    ✓ Random_3 (pose=(-0.23427572424314258, 0.9398758681896142, -1.7882973340150383)): shape (37, 800, 800)
      Valid pixels: 76293/640000 (11.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=259946, num_faces=259948
      Valid probs shape: (37, 76293)
    ✓ Random_4 (pose=(2.2819111994711374, 2.130996233361939, -3.0340030672248113)): shape (37, 800, 800)
      Valid pixels: 85702/640000 (13.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=259027, num_faces=259948
      Valid probs shape: (37, 85702)
    ✓ Random_5 (pose=(0.554580421498601, -2.8330865789370097, -0.5823784241209591)): shape (37, 800, 800)
      Valid pixels: 56628/640000 (8.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1063, max=259947, num_faces=259948
      Valid probs shape: (37, 56628)
    ✓ Random_6 (pose=(-1.7689760234144702, -2.8916887827488464, -1.794892961092631)): shape (37, 800, 800)
      Valid pixels: 61332/640000 (9.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=23, max=259924, num_faces=259948
      Valid probs shape: (37, 61332)
    ✓ Random_7 (pose=(-2.973917199069482, -2.2376651530959304, 0.07890304525040426)): shape (37, 800, 800)
      Valid pixels: 63146/640000 (9.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=258568, num_faces=259948
      Valid probs shape: (37, 63146)
    ✓ Random_8 (pose=(1.0516117825471838, 0.5125484161440013, 2.056434683394805)): shape (37, 800, 800)
      Valid pixels: 81046/640000 (12.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=0, max=258568, num_faces=259948
      Valid probs shape: (37, 81046)
    ✓ Random_9 (pose=(1.6246625466904865, -2.6007860729740235, 1.1743291923632038)): shape (37, 800, 800)
      Valid pixels: 63840/640000 (10.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=23, max=259850, num_faces=259948
      Valid probs shape: (37, 63840)
    ✓ Random_10 (pose=(2.9222476136205877, -3.1357881126335303, 2.2762417569797186)): shape (37, 800, 800)
      Valid pixels: 45891/640000 (7.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=259074, num_faces=259948
      Valid probs shape: (37, 45891)
    ✓ Random_11 (pose=(0.6943346843536333, -1.4924986799401687, -0.3118909638270684)): shape (37, 800, 800)
      Valid pixels: 77072/640000 (12.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7, max=259946, num_faces=259948
      Valid probs shape: (37, 77072)
    ✓ Random_12 (pose=(-2.6834395156853965, -2.156736776920662, 0.36808586944458366)): shape (37, 800, 800)
      Valid pixels: 80555/640000 (12.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=258568, num_faces=259948
      Valid probs shape: (37, 80555)
    ✓ Random_13 (pose=(2.064876211215103, -0.4302352202455424, -2.300928217063896)): shape (37, 800, 800)
      Valid pixels: 64896/640000 (10.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=541, max=259947, num_faces=259948
      Valid probs shape: (37, 64896)
    ✓ Random_14 (pose=(-2.8175842611015858, 2.7906250591654773, 2.6578188308298074)): shape (37, 800, 800)
      Valid pixels: 54317/640000 (8.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=259934, num_faces=259948
      Valid probs shape: (37, 54317)
    ✓ Random_15 (pose=(1.2122235599938422, -1.086183389044379, -1.1320052478103841)): shape (37, 800, 800)
      Valid pixels: 64326/640000 (10.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=259946, num_faces=259948
      Valid probs shape: (37, 64326)
    ✓ Random_16 (pose=(0.4943544141755143, -2.8395491165007063, 0.6849669737647299)): shape (37, 800, 800)
      Valid pixels: 56911/640000 (8.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=458, max=259940, num_faces=259948
      Valid probs shape: (37, 56911)
    ✓ Random_17 (pose=(3.1267781070388905, 2.5386180297981955, 2.4007525850194016)): shape (37, 800, 800)
      Valid pixels: 53875/640000 (8.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=259850, num_faces=259948
      Valid probs shape: (37, 53875)
    ✓ Random_18 (pose=(1.6612874652402807, -2.8048655098458632, -1.0501691797790138)): shape (37, 800, 800)
      Valid pixels: 83763/640000 (13.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=259946, num_faces=259948
      Valid probs shape: (37, 83763)
    ✓ Random_19 (pose=(1.1638197005997952, 0.3121411358371189, 3.10791394848434)): shape (37, 800, 800)
      Valid pixels: 74892/640000 (11.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=259885, num_faces=259948
      Valid probs shape: (37, 74892)
    ✓ Random_20 (pose=(-2.483490035637562, -0.008093617117246321, -1.342484397902553)): shape (37, 800, 800)
      Valid pixels: 56688/640000 (8.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=13466, max=259946, num_faces=259948
      Valid probs shape: (37, 56688)
    ✓ Random_21 (pose=(-0.0022193546704611933, 2.3214676732000283, -1.079432565484412)): shape (37, 800, 800)
      Valid pixels: 63252/640000 (9.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=282, max=259944, num_faces=259948
      Valid probs shape: (37, 63252)
    ✓ Random_22 (pose=(-2.826473230530559, 0.047055441463585534, 1.557024858254331)): shape (37, 800, 800)
      Valid pixels: 40923/640000 (6.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1950, max=259947, num_faces=259948
      Valid probs shape: (37, 40923)
    ✓ Random_23 (pose=(1.6326453544301405, 2.6228959008448536, -0.8946289475031155)): shape (37, 800, 800)
      Valid pixels: 86920/640000 (13.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=259946, num_faces=259948
      Valid probs shape: (37, 86920)
    ✓ Random_24 (pose=(-1.9750501729147332, 2.9416728392197777, -2.811864095741076)): shape (37, 800, 800)
      Valid pixels: 74098/640000 (11.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=259946, num_faces=259948
      Valid probs shape: (37, 74098)
    ✓ Random_25 (pose=(-2.985178071955494, 2.3752258596154014, 2.3970802728644456)): shape (37, 800, 800)
      Valid pixels: 61135/640000 (9.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=259943, num_faces=259948
      Valid probs shape: (37, 61135)
    ✓ Random_26 (pose=(0.9830955336614329, 1.9081057097470007, -1.3575652545933607)): shape (37, 800, 800)
      Valid pixels: 88844/640000 (13.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=14, max=259946, num_faces=259948
      Valid probs shape: (37, 88844)
    ✓ Random_27 (pose=(0.9290471615207787, -2.9832091052027105, 2.9395322158103356)): shape (37, 800, 800)
      Valid pixels: 80063/640000 (12.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2606, max=259944, num_faces=259948
      Valid probs shape: (37, 80063)
    ✓ Random_28 (pose=(0.1030944155876421, 0.8445455942058686, 2.4269021750520157)): shape (37, 800, 800)
      Valid pixels: 59044/640000 (9.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=259738, num_faces=259948
      Valid probs shape: (37, 59044)
    ✓ Random_29 (pose=(-1.5366554576811962, 2.021681546338802, -1.8240558748471818)): shape (37, 800, 800)
      Valid pixels: 62181/640000 (9.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=54, max=259849, num_faces=259948
      Valid probs shape: (37, 62181)
    ✓ Random_30 (pose=(0.9048047401321195, 2.7619598362287237, -1.847132288702322)): shape (37, 800, 800)
      Valid pixels: 57992/640000 (9.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=855, max=259946, num_faces=259948
      Valid probs shape: (37, 57992)
    ✓ Random_31 (pose=(-1.7059484969789014, 1.7800044740699708, -1.6669127389485234)): shape (37, 800, 800)
      Valid pixels: 61418/640000 (9.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=20, max=258567, num_faces=259948
      Valid probs shape: (37, 61418)
    ✓ Random_32 (pose=(-2.426581477740004, -2.1486341441973806, 2.540857095444294)): shape (37, 800, 800)
      Valid pixels: 63186/640000 (9.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=259946, num_faces=259948
      Valid probs shape: (37, 63186)
    ✓ Random_33 (pose=(-0.6701208219538395, -1.5557222080676476, -2.933444402081527)): shape (37, 800, 800)
      Valid pixels: 65501/640000 (10.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=10, max=259850, num_faces=259948
      Valid probs shape: (37, 65501)
    ✓ Random_34 (pose=(-0.4735796795288638, -1.9611695973670698, -1.9493224011610821)): shape (37, 800, 800)
      Valid pixels: 83390/640000 (13.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=949, max=259947, num_faces=259948
      Valid probs shape: (37, 83390)
    ✓ Random_35 (pose=(0.831803209193803, -1.9673947650174946, -0.35649890864550704)): shape (37, 800, 800)
      Valid pixels: 80531/640000 (12.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=56, max=259946, num_faces=259948
      Valid probs shape: (37, 80531)
    ✓ Random_36 (pose=(0.5155341535418061, 2.582452437313856, 1.0992547064060512)): shape (37, 800, 800)
      Valid pixels: 61155/640000 (9.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=28383, max=259947, num_faces=259948
      Valid probs shape: (37, 61155)
    ✓ Random_37 (pose=(1.0170345460854593, 2.5706818167939325, 0.2592547998148609)): shape (37, 800, 800)
      Valid pixels: 69676/640000 (10.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=53, max=259944, num_faces=259948
      Valid probs shape: (37, 69676)
    ✓ Random_38 (pose=(-2.602662820264185, 1.9430665564215621, -0.8120873698505027)): shape (37, 800, 800)
      Valid pixels: 74038/640000 (11.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8, max=259885, num_faces=259948
      Valid probs shape: (37, 74038)
    ✓ Random_39 (pose=(1.0631375385332458, 2.4753178506850446, -3.131286146065434)): shape (37, 800, 800)
      Valid pixels: 73821/640000 (11.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=116, max=259946, num_faces=259948
      Valid probs shape: (37, 73821)
    P stats: min=0.0000, max=0.9999, mean=0.0257
    Non-zero vertices: 123822/129976
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 6154 1065  914 3096    0 1805  992 4570 5903]
  Ground Truth Stats:
    Labels shape: (129976,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-22/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7783
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8268
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8272

  RESULTS:
  RAW:         median(top-10)=0.9064, mean(top-10)=0.9134, median(all)=0.8607, mean(all)=0.7783
  + SMOOTHING: median(top-10)=0.9312, mean(top-10)=0.9309, median(all)=0.8832, mean(all)=0.8268 [+0.0248]
  + MRF:       median(top-10)=0.9313, mean(top-10)=0.9311, median(all)=0.8835, mean(all)=0.8272 [+0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0249

================================================================================
Subject: NKI-RS-22-3
================================================================================
  Step 0: Generating predictions with V2 model (40 random views)...
  Mesh: 136714 vertices, 273424 faces
  Generating 40 random views...
  Generating predictions for 40 views (continuous camera pose)...
    ✓ Random_0 (pose=(-2.5252524745414955, -1.5626831453531775, 2.624109367155371)): shape (37, 800, 800)
      Valid pixels: 69577/640000 (10.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=71, max=273386, num_faces=273424
      Valid probs shape: (37, 69577)
    ✓ Random_1 (pose=(0.9769519866582428, 2.6432098229864565, -0.04329470613623565)): shape (37, 800, 800)
      Valid pixels: 86733/640000 (13.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=71, max=273423, num_faces=273424
      Valid probs shape: (37, 86733)
    ✓ Random_2 (pose=(-3.1031581039400216, 0.21247643650416181, -2.2231495119499907)): shape (37, 800, 800)
      Valid pixels: 56199/640000 (8.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=71957, max=273373, num_faces=273424
      Valid probs shape: (37, 56199)
    ✓ Random_3 (pose=(-0.05805919053729269, 0.5369591855797271, -2.932317809798924)): shape (37, 800, 800)
      Valid pixels: 56801/640000 (8.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=273411, num_faces=273424
      Valid probs shape: (37, 56801)
    ✓ Random_4 (pose=(0.5296292614945401, 2.013997516441897, 2.6760099483094413)): shape (37, 800, 800)
      Valid pixels: 83098/640000 (13.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=616, max=273372, num_faces=273424
      Valid probs shape: (37, 83098)
    ✓ Random_5 (pose=(-2.7193571005253663, 0.9103587187748658, 1.120098740877249)): shape (37, 800, 800)
      Valid pixels: 80074/640000 (12.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=751, max=273423, num_faces=273424
      Valid probs shape: (37, 80074)
    ✓ Random_6 (pose=(1.9641492549583743, -2.637374298753381, 0.5565501021199473)): shape (37, 800, 800)
      Valid pixels: 77512/640000 (12.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=273419, num_faces=273424
      Valid probs shape: (37, 77512)
    ✓ Random_7 (pose=(2.5765859948101193, 2.2534703810621766, 1.011265470762)): shape (37, 800, 800)
      Valid pixels: 89364/640000 (14.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=273419, num_faces=273424
      Valid probs shape: (37, 89364)
    ✓ Random_8 (pose=(2.3147943447483597, 0.8099709907607662, 2.7180546697735517)): shape (37, 800, 800)
      Valid pixels: 84728/640000 (13.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5164, max=273373, num_faces=273424
      Valid probs shape: (37, 84728)
    ✓ Random_9 (pose=(2.136328340504517, 2.147758931930804, 0.037499856055862146)): shape (37, 800, 800)
      Valid pixels: 102253/640000 (16.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=273419, num_faces=273424
      Valid probs shape: (37, 102253)
    ✓ Random_10 (pose=(1.9368943085495385, -2.7470218287442045, 1.8131588784110706)): shape (37, 800, 800)
      Valid pixels: 77421/640000 (12.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6, max=272263, num_faces=273424
      Valid probs shape: (37, 77421)
    ✓ Random_11 (pose=(0.7219691591888329, -1.3200350451935603, -2.6797017489623407)): shape (37, 800, 800)
      Valid pixels: 99434/640000 (15.5%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=0, max=273373, num_faces=273424
      Valid probs shape: (37, 99434)
    ✓ Random_12 (pose=(1.3908438126918004, 1.845651812250992, 2.5970258045113503)): shape (37, 800, 800)
      Valid pixels: 100854/640000 (15.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=11, max=273373, num_faces=273424
      Valid probs shape: (37, 100854)
    ✓ Random_13 (pose=(-1.0499809410817398, -2.3174158845150856, -0.36246543834565736)): shape (37, 800, 800)
      Valid pixels: 95257/640000 (14.9%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=261, max=273373, num_faces=273424
      Valid probs shape: (37, 95257)
    ✓ Random_14 (pose=(1.93068668746562, -1.1659865800064582, -2.7658920388702564)): shape (37, 800, 800)
      Valid pixels: 80998/640000 (12.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=129, max=273372, num_faces=273424
      Valid probs shape: (37, 80998)
    ✓ Random_15 (pose=(-1.944465270655296, 0.9626756880797798, -0.40240098231929133)): shape (37, 800, 800)
      Valid pixels: 98303/640000 (15.4%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=7, max=273373, num_faces=273424
      Valid probs shape: (37, 98303)
    ✓ Random_16 (pose=(1.1444429971099819, -1.6524065039053046, -1.775100695599307)): shape (37, 800, 800)
      Valid pixels: 77520/640000 (12.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=107, max=273373, num_faces=273424
      Valid probs shape: (37, 77520)
    ✓ Random_17 (pose=(2.8992602817193776, -1.6234395646147515, 2.3806497709417123)): shape (37, 800, 800)
      Valid pixels: 83120/640000 (13.0%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=6, max=273373, num_faces=273424
      Valid probs shape: (37, 83120)
    ✓ Random_18 (pose=(2.7951472257179777, 1.5844206176035316, 2.6313688753594047)): shape (37, 800, 800)
      Valid pixels: 67220/640000 (10.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=15, max=273418, num_faces=273424
      Valid probs shape: (37, 67220)
    ✓ Random_19 (pose=(-2.7330318607231887, -2.4417156902221713, -2.2694349145300095)): shape (37, 800, 800)
      Valid pixels: 82436/640000 (12.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=273419, num_faces=273424
      Valid probs shape: (37, 82436)
    ✓ Random_20 (pose=(-3.0822431872536615, -2.7089348763071293, 0.4937238951413745)): shape (37, 800, 800)
      Valid pixels: 57246/640000 (8.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=0, max=272570, num_faces=273424
      Valid probs shape: (37, 57246)
    ✓ Random_21 (pose=(1.837556832351777, 2.2593365683725795, -2.728823025775922)): shape (37, 800, 800)
      Valid pixels: 89899/640000 (14.0%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=3, max=273373, num_faces=273424
      Valid probs shape: (37, 89899)
    ✓ Random_22 (pose=(2.936371476300163, 1.370919548534201, -1.9555161839022681)): shape (37, 800, 800)
      Valid pixels: 99212/640000 (15.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=10, max=273373, num_faces=273424
      Valid probs shape: (37, 99212)
    ✓ Random_23 (pose=(0.14750763376416565, 3.034464141253311, 1.7333504188435045)): shape (37, 800, 800)
      Valid pixels: 54626/640000 (8.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=22352, max=273373, num_faces=273424
      Valid probs shape: (37, 54626)
    ✓ Random_24 (pose=(0.040613398136109424, -2.873304860870851, 2.108975950304675)): shape (37, 800, 800)
      Valid pixels: 52026/640000 (8.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5382, max=273422, num_faces=273424
      Valid probs shape: (37, 52026)
    ✓ Random_25 (pose=(1.7166040584973343, 2.4364130491829084, -1.6483495287281205)): shape (37, 800, 800)
      Valid pixels: 70854/640000 (11.1%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=13, max=273373, num_faces=273424
      Valid probs shape: (37, 70854)
    ✓ Random_26 (pose=(2.4601296202638387, -1.8670508730197406, -1.0745351579041102)): shape (37, 800, 800)
      Valid pixels: 104705/640000 (16.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=273419, num_faces=273424
      Valid probs shape: (37, 104705)
    ✓ Random_27 (pose=(2.0432988694902443, -1.115914326240841, 0.8257035069184502)): shape (37, 800, 800)
      Valid pixels: 71538/640000 (11.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=310, max=273419, num_faces=273424
      Valid probs shape: (37, 71538)
    ✓ Random_28 (pose=(-1.3496888475294897, 2.7643868269748983, -0.9665008475696952)): shape (37, 800, 800)
      Valid pixels: 87279/640000 (13.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=251, max=273373, num_faces=273424
      Valid probs shape: (37, 87279)
    ✓ Random_29 (pose=(-2.8861540361887785, 0.7365385470414223, -1.8727328691916405)): shape (37, 800, 800)
      Valid pixels: 83720/640000 (13.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=22181, max=273373, num_faces=273424
      Valid probs shape: (37, 83720)
    ✓ Random_30 (pose=(-0.07387937056521654, 2.9065386439896788, 2.097543986040363)): shape (37, 800, 800)
      Valid pixels: 53493/640000 (8.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=8848, max=273373, num_faces=273424
      Valid probs shape: (37, 53493)
    ✓ Random_31 (pose=(-1.5615364749199738, -2.645169157263945, 3.06741490043001)): shape (37, 800, 800)
      Valid pixels: 105602/640000 (16.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=18, max=273421, num_faces=273424
      Valid probs shape: (37, 105602)
    ✓ Random_32 (pose=(-1.2524173300257662, 2.600104540847589, -0.1444114215200476)): shape (37, 800, 800)
      Valid pixels: 99279/640000 (15.5%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=32, max=273373, num_faces=273424
      Valid probs shape: (37, 99279)
    ✓ Random_33 (pose=(-1.0159737291427136, -2.3615928706554783, 0.16381078177784314)): shape (37, 800, 800)
      Valid pixels: 82363/640000 (12.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=183, max=273373, num_faces=273424
      Valid probs shape: (37, 82363)
    ✓ Random_34 (pose=(1.668378186481438, 2.383763399102291, 0.5962888236015926)): shape (37, 800, 800)
      Valid pixels: 87106/640000 (13.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=15, max=273422, num_faces=273424
      Valid probs shape: (37, 87106)
    ✓ Random_35 (pose=(1.1497137999386338, -1.7701623569857272, -1.403218080851197)): shape (37, 800, 800)
      Valid pixels: 72727/640000 (11.4%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=88, max=273373, num_faces=273424
      Valid probs shape: (37, 72727)
    ✓ Random_36 (pose=(2.881661800871284, 0.8084395577884282, 2.2830917784923566)): shape (37, 800, 800)
      Valid pixels: 68251/640000 (10.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1364, max=273423, num_faces=273424
      Valid probs shape: (37, 68251)
    ✓ Random_37 (pose=(0.5005004477248267, -0.5561409800481232, 3.0352943228484808)): shape (37, 800, 800)
      Valid pixels: 70910/640000 (11.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=272264, num_faces=273424
      Valid probs shape: (37, 70910)
    ✓ Random_38 (pose=(1.5090293910269024, -0.9285155470011639, 0.6253096372704614)): shape (37, 800, 800)
      Valid pixels: 85858/640000 (13.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=17, max=273421, num_faces=273424
      Valid probs shape: (37, 85858)
    ✓ Random_39 (pose=(-1.368743297737409, 0.39691063395677917, 0.18368735611115117)): shape (37, 800, 800)
      Valid pixels: 92117/640000 (14.4%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=1, max=273373, num_faces=273424
      Valid probs shape: (37, 92117)
    P stats: min=0.0000, max=1.0000, mean=0.0258
    Non-zero vertices: 130696/136714
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 6018 1748 1209 3468    0 2656  883 4679 7115]
  Ground Truth Stats:
    Labels shape: (136714,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-3/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7904
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8320
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8320

  RESULTS:
  RAW:         median(top-10)=0.9133, mean(top-10)=0.9102, median(all)=0.8416, mean(all)=0.7904
  + SMOOTHING: median(top-10)=0.9292, mean(top-10)=0.9275, median(all)=0.8763, mean(all)=0.8320 [+0.0158]
  + MRF:       median(top-10)=0.9292, mean(top-10)=0.9276, median(all)=0.8764, mean(all)=0.8320 [+0.0000]
  TOTAL IMPROVEMENT (median top-10): +0.0158

================================================================================
Subject: NKI-RS-22-4
================================================================================
  Step 0: Generating predictions with V2 model (40 random views)...
  Mesh: 169171 vertices, 338338 faces
  Generating 40 random views...
  Generating predictions for 40 views (continuous camera pose)...
    ✓ Random_0 (pose=(2.6773267906497367, -2.561344084707001, -2.403302510560873)): shape (37, 800, 800)
      Valid pixels: 53486/640000 (8.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=338150, num_faces=338338
      Valid probs shape: (37, 53486)
    ✓ Random_1 (pose=(2.652400118118284, -1.8496066122650874, 0.9088296463773569)): shape (37, 800, 800)
      Valid pixels: 74388/640000 (11.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=338294, num_faces=338338
      Valid probs shape: (37, 74388)
    ✓ Random_2 (pose=(1.5910366231368531, 1.937054264837295, 0.20892200618885148)): shape (37, 800, 800)
      Valid pixels: 91136/640000 (14.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=14, max=338337, num_faces=338338
      Valid probs shape: (37, 91136)
    ✓ Random_3 (pose=(-1.6346174130505706, 1.2521160689164148, 0.36146469257369107)): shape (37, 800, 800)
      Valid pixels: 79166/640000 (12.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=28, max=338334, num_faces=338338
      Valid probs shape: (37, 79166)
    ✓ Random_4 (pose=(-1.6123865326776754, 2.4880939966363345, -1.8730933693828151)): shape (37, 800, 800)
      Valid pixels: 58950/640000 (9.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=338268, num_faces=338338
      Valid probs shape: (37, 58950)
    ✓ Random_5 (pose=(-1.3959936071953387, 0.572097027220118, -1.6962923229639735)): shape (37, 800, 800)
      Valid pixels: 57334/640000 (9.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=338269, num_faces=338338
      Valid probs shape: (37, 57334)
    ✓ Random_6 (pose=(0.7309217211385319, 3.08082624301965, -2.357037910198027)): shape (37, 800, 800)
      Valid pixels: 61909/640000 (9.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=616, max=338336, num_faces=338338
      Valid probs shape: (37, 61909)
    ✓ Random_7 (pose=(1.1351195572109951, -0.458813905586128, -1.8796260354133876)): shape (37, 800, 800)
      Valid pixels: 64345/640000 (10.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=338152, num_faces=338338
      Valid probs shape: (37, 64345)
    ✓ Random_8 (pose=(-0.5956269783041064, 2.3886618691881107, -3.059867495507259)): shape (37, 800, 800)
      Valid pixels: 75817/640000 (11.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=539, max=338337, num_faces=338338
      Valid probs shape: (37, 75817)
    ✓ Random_9 (pose=(-1.1658622869775976, -1.2907099849419756, 0.5193984686501221)): shape (37, 800, 800)
      Valid pixels: 69621/640000 (10.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=13, max=338334, num_faces=338338
      Valid probs shape: (37, 69621)
    ✓ Random_10 (pose=(2.466064839166558, 2.26862684692383, -0.34017284067769094)): shape (37, 800, 800)
      Valid pixels: 77241/640000 (12.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=16, max=338207, num_faces=338338
      Valid probs shape: (37, 77241)
    ✓ Random_11 (pose=(1.1823092389628913, 2.3044797853192707, 0.3258458657434615)): shape (37, 800, 800)
      Valid pixels: 75517/640000 (11.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=40, max=338337, num_faces=338338
      Valid probs shape: (37, 75517)
    ✓ Random_12 (pose=(3.1338889729217048, 0.8733826146834742, 2.302863654689702)): shape (37, 800, 800)
      Valid pixels: 64303/640000 (10.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=901, max=338337, num_faces=338338
      Valid probs shape: (37, 64303)
    ✓ Random_13 (pose=(0.6501216975467226, -2.77702084897462, 0.41247732251392355)): shape (37, 800, 800)
      Valid pixels: 67710/640000 (10.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=355, max=338337, num_faces=338338
      Valid probs shape: (37, 67710)
    ✓ Random_14 (pose=(-2.7610336256122983, -0.5796777840112104, -0.42590058145216725)): shape (37, 800, 800)
      Valid pixels: 61486/640000 (9.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=25576, max=338337, num_faces=338338
      Valid probs shape: (37, 61486)
    ✓ Random_15 (pose=(-2.848952784560857, -0.728464897501139, 2.97688301548759)): shape (37, 800, 800)
      Valid pixels: 51826/640000 (8.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=603, max=338337, num_faces=338338
      Valid probs shape: (37, 51826)
    ✓ Random_16 (pose=(-2.712413973117224, -2.4771956995985827, 2.9322375673888814)): shape (37, 800, 800)
      Valid pixels: 66173/640000 (10.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=338207, num_faces=338338
      Valid probs shape: (37, 66173)
    ✓ Random_17 (pose=(0.8278743711876597, -0.5618066485367414, -1.4511748177207602)): shape (37, 800, 800)
      Valid pixels: 58184/640000 (9.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=338152, num_faces=338338
      Valid probs shape: (37, 58184)
    ✓ Random_18 (pose=(-2.6522303390218362, -2.796740184514923, -2.7260140649331204)): shape (37, 800, 800)
      Valid pixels: 68331/640000 (10.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=338207, num_faces=338338
      Valid probs shape: (37, 68331)
    ✓ Random_19 (pose=(-1.6163914558951595, -1.2988943570775564, 0.8529260118700441)): shape (37, 800, 800)
      Valid pixels: 71839/640000 (11.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=26, max=338334, num_faces=338338
      Valid probs shape: (37, 71839)
    ✓ Random_20 (pose=(-3.101255685626589, -1.7529353056201007, 0.46260369792858835)): shape (37, 800, 800)
      Valid pixels: 79677/640000 (12.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=338294, num_faces=338338
      Valid probs shape: (37, 79677)
    ✓ Random_21 (pose=(0.12393416304546534, 2.545192024265557, 2.3022280620179654)): shape (37, 800, 800)
      Valid pixels: 66057/640000 (10.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=37824, max=338336, num_faces=338338
      Valid probs shape: (37, 66057)
    ✓ Random_22 (pose=(-0.5364172171611892, 0.11727512593132028, -1.587384146237247)): shape (37, 800, 800)
      Valid pixels: 44316/640000 (6.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=338205, num_faces=338338
      Valid probs shape: (37, 44316)
    ✓ Random_23 (pose=(-2.793720042153235, -2.8619631494736435, 1.778482262654375)): shape (37, 800, 800)
      Valid pixels: 49742/640000 (7.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=338148, num_faces=338338
      Valid probs shape: (37, 49742)
    ✓ Random_24 (pose=(2.303397051641535, 1.7849177788463235, -1.5438500771776842)): shape (37, 800, 800)
      Valid pixels: 69723/640000 (10.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=13, max=338334, num_faces=338338
      Valid probs shape: (37, 69723)
    ✓ Random_25 (pose=(-1.0543615252474372, 0.7405189518559445, 2.0625572309257665)): shape (37, 800, 800)
      Valid pixels: 64543/640000 (10.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=338201, num_faces=338338
      Valid probs shape: (37, 64543)
    ✓ Random_26 (pose=(-1.4980508329101663, 2.42834166698825, 1.2357201958056008)): shape (37, 800, 800)
      Valid pixels: 64588/640000 (10.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=26, max=338322, num_faces=338338
      Valid probs shape: (37, 64588)
    ✓ Random_27 (pose=(-1.1030769886360807, -2.311100322944893, -0.5353201502811702)): shape (37, 800, 800)
      Valid pixels: 92888/640000 (14.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=319, max=338334, num_faces=338338
      Valid probs shape: (37, 92888)
    ✓ Random_28 (pose=(-2.150500889810134, -1.331678377891854, 2.3644387628669126)): shape (37, 800, 800)
      Valid pixels: 69722/640000 (10.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=26, max=338311, num_faces=338338
      Valid probs shape: (37, 69722)
    ✓ Random_29 (pose=(0.7102991891293038, 2.3013541763100367, 0.15886044067479554)): shape (37, 800, 800)
      Valid pixels: 65685/640000 (10.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1263, max=338337, num_faces=338338
      Valid probs shape: (37, 65685)
    ✓ Random_30 (pose=(-1.4704917486516094, 2.032551675034001, 0.34917108754055715)): shape (37, 800, 800)
      Valid pixels: 82957/640000 (13.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=14, max=338334, num_faces=338338
      Valid probs shape: (37, 82957)
    ✓ Random_31 (pose=(0.6047767414467726, 0.3830261938396524, 0.20988836899959917)): shape (37, 800, 800)
      Valid pixels: 59883/640000 (9.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=338207, num_faces=338338
      Valid probs shape: (37, 59883)
    ✓ Random_32 (pose=(1.0300905561492266, -1.8863118329370032, -0.9235863086949769)): shape (37, 800, 800)
      Valid pixels: 64340/640000 (10.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=101, max=338308, num_faces=338338
      Valid probs shape: (37, 64340)
    ✓ Random_33 (pose=(2.287507537215909, 0.7436388935089635, -1.4258689509251166)): shape (37, 800, 800)
      Valid pixels: 60169/640000 (9.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=201, max=338334, num_faces=338338
      Valid probs shape: (37, 60169)
    ✓ Random_34 (pose=(1.4442641881689582, 1.0646196070970078, 1.9800111049002656)): shape (37, 800, 800)
      Valid pixels: 82918/640000 (13.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=338294, num_faces=338338
      Valid probs shape: (37, 82918)
    ✓ Random_35 (pose=(2.375164759686271, 1.4522813123871519, -1.526035617163394)): shape (37, 800, 800)
      Valid pixels: 71549/640000 (11.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=59, max=338334, num_faces=338338
      Valid probs shape: (37, 71549)
    ✓ Random_36 (pose=(-1.7690443739366102, 2.845370453012518, -0.458941463483733)): shape (37, 800, 800)
      Valid pixels: 91072/640000 (14.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=16, max=338294, num_faces=338338
      Valid probs shape: (37, 91072)
    ✓ Random_37 (pose=(-0.6045211171309424, 0.9956339869906152, -1.3778836349700785)): shape (37, 800, 800)
      Valid pixels: 65643/640000 (10.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=338207, num_faces=338338
      Valid probs shape: (37, 65643)
    ✓ Random_38 (pose=(-1.8120943629341717, 0.5974494887572708, -1.0062481264112737)): shape (37, 800, 800)
      Valid pixels: 89593/640000 (14.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=58, max=338334, num_faces=338338
      Valid probs shape: (37, 89593)
    ✓ Random_39 (pose=(-1.1911746311985243, 0.7854373704167061, -2.2611218549939114)): shape (37, 800, 800)
      Valid pixels: 75942/640000 (11.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=338335, num_faces=338338
      Valid probs shape: (37, 75942)
    P stats: min=0.0000, max=1.0000, mean=0.0257
    Non-zero vertices: 160762/169171
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 8409 1284 1191 4294    0 3024 1282 5120 7771]
  Ground Truth Stats:
    Labels shape: (169171,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-4/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7624
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8105
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8109

  RESULTS:
  RAW:         median(top-10)=0.8947, mean(top-10)=0.8976, median(all)=0.8200, mean(all)=0.7624
  + SMOOTHING: median(top-10)=0.9156, mean(top-10)=0.9193, median(all)=0.8468, mean(all)=0.8105 [+0.0209]
  + MRF:       median(top-10)=0.9159, mean(top-10)=0.9197, median(all)=0.8472, mean(all)=0.8109 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0212

================================================================================
Subject: NKI-RS-22-5
================================================================================
  Step 0: Generating predictions with V2 model (40 random views)...
  Mesh: 138967 vertices, 277930 faces
  Generating 40 random views...
  Generating predictions for 40 views (continuous camera pose)...
    ✓ Random_0 (pose=(0.6075114482733439, -0.29978779712943515, -0.25693837984511125)): shape (37, 800, 800)
      Valid pixels: 71562/640000 (11.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=277917, num_faces=277930
      Valid probs shape: (37, 71562)
    ✓ Random_1 (pose=(-0.21416336795696278, 0.39677744056733477, 0.7175321277501738)): shape (37, 800, 800)
      Valid pixels: 52406/640000 (8.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=277587, num_faces=277930
      Valid probs shape: (37, 52406)
    ✓ Random_2 (pose=(2.2948649213123735, -1.0897103938743284, 1.238461750289793)): shape (37, 800, 800)
      Valid pixels: 77829/640000 (12.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=210, max=277859, num_faces=277930
      Valid probs shape: (37, 77829)
    ✓ Random_3 (pose=(-2.2561747536557406, -0.9994715743996583, 0.87608684454207)): shape (37, 800, 800)
      Valid pixels: 81451/640000 (12.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=68, max=277929, num_faces=277930
      Valid probs shape: (37, 81451)
    ✓ Random_4 (pose=(1.330596779884936, 2.8684828825189017, 0.10464998924630464)): shape (37, 800, 800)
      Valid pixels: 86352/640000 (13.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=277929, num_faces=277930
      Valid probs shape: (37, 86352)
    ✓ Random_5 (pose=(2.295168182356944, -2.103803576871396, 0.1630101029619393)): shape (37, 800, 800)
      Valid pixels: 67631/640000 (10.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=12, max=277754, num_faces=277930
      Valid probs shape: (37, 67631)
    ✓ Random_6 (pose=(2.406798320208538, -0.5065217212124451, -1.4214874164742912)): shape (37, 800, 800)
      Valid pixels: 68860/640000 (10.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2193, max=277924, num_faces=277930
      Valid probs shape: (37, 68860)
    ✓ Random_7 (pose=(-1.142471894527863, -0.45168044507714145, 1.284199230185485)): shape (37, 800, 800)
      Valid pixels: 61509/640000 (9.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=19, max=277927, num_faces=277930
      Valid probs shape: (37, 61509)
    ✓ Random_8 (pose=(-1.4117051667540157, -0.3227126844433226, -2.49405824437188)): shape (37, 800, 800)
      Valid pixels: 72163/640000 (11.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=13, max=277904, num_faces=277930
      Valid probs shape: (37, 72163)
    ✓ Random_9 (pose=(-1.0571320571215361, -1.0328826801471682, -0.36374525238529065)): shape (37, 800, 800)
      Valid pixels: 80535/640000 (12.6%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=7, max=277925, num_faces=277930
      Valid probs shape: (37, 80535)
    ✓ Random_10 (pose=(2.7029207964035447, 0.8130497453073224, 1.4698212702666655)): shape (37, 800, 800)
      Valid pixels: 66084/640000 (10.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=609, max=277917, num_faces=277930
      Valid probs shape: (37, 66084)
    ✓ Random_11 (pose=(-1.123491588220634, -1.830243070768314, 2.726402680678463)): shape (37, 800, 800)
      Valid pixels: 93095/640000 (14.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=9, max=277917, num_faces=277930
      Valid probs shape: (37, 93095)
    ✓ Random_12 (pose=(-2.2431587817893783, -2.431130686674788, 0.29187079066046806)): shape (37, 800, 800)
      Valid pixels: 78091/640000 (12.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=277925, num_faces=277930
      Valid probs shape: (37, 78091)
    ✓ Random_13 (pose=(-3.0259795468333976, 2.337049101451986, -1.7034767571134937)): shape (37, 800, 800)
      Valid pixels: 69148/640000 (10.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=277691, num_faces=277930
      Valid probs shape: (37, 69148)
    ✓ Random_14 (pose=(1.410446993293335, 2.090988719348159, 2.331161706640289)): shape (37, 800, 800)
      Valid pixels: 92636/640000 (14.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=50, max=277861, num_faces=277930
      Valid probs shape: (37, 92636)
    ✓ Random_15 (pose=(-1.2000888653333803, -0.597707440310971, -1.1896690048468967)): shape (37, 800, 800)
      Valid pixels: 81625/640000 (12.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7, max=277690, num_faces=277930
      Valid probs shape: (37, 81625)
    ✓ Random_16 (pose=(-0.13634035771194286, 1.9532779715444217, -2.1920656295957737)): shape (37, 800, 800)
      Valid pixels: 88966/640000 (13.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=81, max=277926, num_faces=277930
      Valid probs shape: (37, 88966)
    ✓ Random_17 (pose=(-0.9254343674049714, -2.245562791696572, 1.0526416386545794)): shape (37, 800, 800)
      Valid pixels: 60917/640000 (9.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1380, max=277928, num_faces=277930
      Valid probs shape: (37, 60917)
    ✓ Random_18 (pose=(0.2597547861509435, 1.929199358165401, 0.43654337003948696)): shape (37, 800, 800)
      Valid pixels: 69758/640000 (10.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=509, max=277688, num_faces=277930
      Valid probs shape: (37, 69758)
    ✓ Random_19 (pose=(2.266552537627062, 1.6484072744279432, -2.661181656817953)): shape (37, 800, 800)
      Valid pixels: 90197/640000 (14.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=13, max=277921, num_faces=277930
      Valid probs shape: (37, 90197)
    ✓ Random_20 (pose=(2.9316004893597993, 1.1746365460329375, 0.15005276953424485)): shape (37, 800, 800)
      Valid pixels: 73686/640000 (11.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=825, max=277925, num_faces=277930
      Valid probs shape: (37, 73686)
    ✓ Random_21 (pose=(-0.47335796672548014, -2.178386247949757, 1.6239279619801748)): shape (37, 800, 800)
      Valid pixels: 82957/640000 (13.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=129, max=277927, num_faces=277930
      Valid probs shape: (37, 82957)
    ✓ Random_22 (pose=(-0.7954425864264727, -1.872498881459437, 3.025053090609556)): shape (37, 800, 800)
      Valid pixels: 73002/640000 (11.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=277917, num_faces=277930
      Valid probs shape: (37, 73002)
    ✓ Random_23 (pose=(-2.981658953417223, 0.10017054032683115, -0.8541066670681969)): shape (37, 800, 800)
      Valid pixels: 53313/640000 (8.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=58962, max=277925, num_faces=277930
      Valid probs shape: (37, 53313)
    ✓ Random_24 (pose=(-0.3787654140145049, -1.2927259387743653, 0.694353815472609)): shape (37, 800, 800)
      Valid pixels: 76249/640000 (11.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=21, max=277927, num_faces=277930
      Valid probs shape: (37, 76249)
    ✓ Random_25 (pose=(0.09125693560349601, -1.2247687473561797, 0.7240255380116936)): shape (37, 800, 800)
      Valid pixels: 90763/640000 (14.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=9, max=277916, num_faces=277930
      Valid probs shape: (37, 90763)
    ✓ Random_26 (pose=(-0.978094212078096, 1.9572219339940382, -2.673760727592602)): shape (37, 800, 800)
      Valid pixels: 92728/640000 (14.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=277924, num_faces=277930
      Valid probs shape: (37, 92728)
    ✓ Random_27 (pose=(-0.05370913813994793, 1.1648271877840362, 1.7561561180698675)): shape (37, 800, 800)
      Valid pixels: 73177/640000 (11.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=6, max=277927, num_faces=277930
      Valid probs shape: (37, 73177)
    ✓ Random_28 (pose=(-0.5777362981019949, 2.7185366616683586, 1.06843477226717)): shape (37, 800, 800)
      Valid pixels: 68288/640000 (10.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3322, max=277929, num_faces=277930
      Valid probs shape: (37, 68288)
    ✓ Random_29 (pose=(0.753166250017324, 1.6476528727190365, -1.8292101388810904)): shape (37, 800, 800)
      Valid pixels: 87206/640000 (13.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=277915, num_faces=277930
      Valid probs shape: (37, 87206)
    ✓ Random_30 (pose=(2.9595998906241805, -0.8393565417812208, 2.3097298321884105)): shape (37, 800, 800)
      Valid pixels: 72205/640000 (11.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3310, max=277927, num_faces=277930
      Valid probs shape: (37, 72205)
    ✓ Random_31 (pose=(2.044948591864298, -2.7078693358555315, -0.7802788972926398)): shape (37, 800, 800)
      Valid pixels: 91259/640000 (14.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=9, max=277917, num_faces=277930
      Valid probs shape: (37, 91259)
    ✓ Random_32 (pose=(1.5482383606278836, -2.733756261271896, 1.5191481904889654)): shape (37, 800, 800)
      Valid pixels: 59695/640000 (9.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=277576, num_faces=277930
      Valid probs shape: (37, 59695)
    ✓ Random_33 (pose=(-2.4911903929524115, 0.6959419481993079, 1.2852261247462566)): shape (37, 800, 800)
      Valid pixels: 65454/640000 (10.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1343, max=277925, num_faces=277930
      Valid probs shape: (37, 65454)
    ✓ Random_34 (pose=(2.7328633835129663, 0.7999932464025057, 0.05110325989061204)): shape (37, 800, 800)
      Valid pixels: 68389/640000 (10.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1499, max=277914, num_faces=277930
      Valid probs shape: (37, 68389)
    ✓ Random_35 (pose=(2.9075818910965507, -0.3256851190690133, -1.7220929415393809)): shape (37, 800, 800)
      Valid pixels: 45529/640000 (7.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3294, max=277913, num_faces=277930
      Valid probs shape: (37, 45529)
    ✓ Random_36 (pose=(-0.2192018828862996, 1.4686707843194773, 1.3692031248578802)): shape (37, 800, 800)
      Valid pixels: 85071/640000 (13.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=10, max=277925, num_faces=277930
      Valid probs shape: (37, 85071)
    ✓ Random_37 (pose=(-1.0540915929159964, 1.8879225634960184, -2.0140911225525135)): shape (37, 800, 800)
      Valid pixels: 73250/640000 (11.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=277917, num_faces=277930
      Valid probs shape: (37, 73250)
    ✓ Random_38 (pose=(1.723001211035995, -2.7216416416811224, 1.9998655365829432)): shape (37, 800, 800)
      Valid pixels: 81718/640000 (12.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=10, max=277836, num_faces=277930
      Valid probs shape: (37, 81718)
    ✓ Random_39 (pose=(-0.6666957846300781, 2.3370705692435347, -0.9397033780261275)): shape (37, 800, 800)
      Valid pixels: 56834/640000 (8.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4251, max=277058, num_faces=277930
      Valid probs shape: (37, 56834)
    P stats: min=0.0000, max=1.0000, mean=0.0259
    Non-zero vertices: 133228/138967
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 5739 1443 1020 4284    0 2180 1341 4318 4988]
  Ground Truth Stats:
    Labels shape: (138967,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-5/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7867
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8329
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8332

  RESULTS:
  RAW:         median(top-10)=0.9120, mean(top-10)=0.9190, median(all)=0.8420, mean(all)=0.7867
  + SMOOTHING: median(top-10)=0.9257, mean(top-10)=0.9330, median(all)=0.8745, mean(all)=0.8329 [+0.0137]
  + MRF:       median(top-10)=0.9260, mean(top-10)=0.9333, median(all)=0.8747, mean(all)=0.8332 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0140

================================================================================
Subject: NKI-RS-22-6
================================================================================
  Step 0: Generating predictions with V2 model (40 random views)...
  Mesh: 185380 vertices, 370756 faces
  Generating 40 random views...
  Generating predictions for 40 views (continuous camera pose)...
    ✓ Random_0 (pose=(2.968276100069586, 1.0574555199211888, 2.389317832615257)): shape (37, 800, 800)
      Valid pixels: 61968/640000 (9.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=54, max=370752, num_faces=370756
      Valid probs shape: (37, 61968)
    ✓ Random_1 (pose=(2.465275936642752, -0.440893382004909, 0.22383762322835965)): shape (37, 800, 800)
      Valid pixels: 59910/640000 (9.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=49, max=370752, num_faces=370756
      Valid probs shape: (37, 59910)
    ✓ Random_2 (pose=(2.222989996191825, 2.2356720373495627, 1.027443319678703)): shape (37, 800, 800)
      Valid pixels: 78092/640000 (12.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=11, max=370715, num_faces=370756
      Valid probs shape: (37, 78092)
    ✓ Random_3 (pose=(-2.3903736657269405, 3.076612886068328, -0.6394776865580822)): shape (37, 800, 800)
      Valid pixels: 70713/640000 (11.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=370554, num_faces=370756
      Valid probs shape: (37, 70713)
    ✓ Random_4 (pose=(1.352120695888254, -1.0428522207536988, 1.3031136043971774)): shape (37, 800, 800)
      Valid pixels: 65739/640000 (10.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=15, max=370715, num_faces=370756
      Valid probs shape: (37, 65739)
    ✓ Random_5 (pose=(-2.199143535052766, 1.138259082972307, 2.103814791152848)): shape (37, 800, 800)
      Valid pixels: 95453/640000 (14.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=79, max=370715, num_faces=370756
      Valid probs shape: (37, 95453)
    ✓ Random_6 (pose=(-2.7950567152118135, 2.6736310998077704, 2.008435127039003)): shape (37, 800, 800)
      Valid pixels: 62222/640000 (9.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=370715, num_faces=370756
      Valid probs shape: (37, 62222)
    ✓ Random_7 (pose=(0.6294629168138841, -1.1802025675480157, -0.3948790656862027)): shape (37, 800, 800)
      Valid pixels: 65409/640000 (10.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=19, max=370714, num_faces=370756
      Valid probs shape: (37, 65409)
    ✓ Random_8 (pose=(-0.4379547947859339, 2.511533749156639, -0.30808385982243136)): shape (37, 800, 800)
      Valid pixels: 61739/640000 (9.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=32862, max=370750, num_faces=370756
      Valid probs shape: (37, 61739)
    ✓ Random_9 (pose=(1.326805326364104, 1.5929571659470048, -0.5728680394212753)): shape (37, 800, 800)
      Valid pixels: 97247/640000 (15.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=370715, num_faces=370756
      Valid probs shape: (37, 97247)
    ✓ Random_10 (pose=(-0.1993289943327463, 1.34777585034728, 1.255678348745768)): shape (37, 800, 800)
      Valid pixels: 87588/640000 (13.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=52, max=370743, num_faces=370756
      Valid probs shape: (37, 87588)
    ✓ Random_11 (pose=(3.1225183216876475, 2.968834446365598, 0.8131118985659849)): shape (37, 800, 800)
      Valid pixels: 40090/640000 (6.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=370693, num_faces=370756
      Valid probs shape: (37, 40090)
    ✓ Random_12 (pose=(0.1616305900124302, 1.632285666284906, 0.08376639993723778)): shape (37, 800, 800)
      Valid pixels: 57953/640000 (9.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=28, max=370750, num_faces=370756
      Valid probs shape: (37, 57953)
    ✓ Random_13 (pose=(-0.32235624305071964, -2.8207532443956636, -1.3383331066698048)): shape (37, 800, 800)
      Valid pixels: 60367/640000 (9.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=65027, max=370752, num_faces=370756
      Valid probs shape: (37, 60367)
    ✓ Random_14 (pose=(0.46119694163951097, -2.021946575130017, 0.5429165539491616)): shape (37, 800, 800)
      Valid pixels: 91387/640000 (14.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=76, max=370715, num_faces=370756
      Valid probs shape: (37, 91387)
    ✓ Random_15 (pose=(-1.7794388611994567, 1.4235959281289317, -2.9772128913583167)): shape (37, 800, 800)
      Valid pixels: 84243/640000 (13.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=11, max=370715, num_faces=370756
      Valid probs shape: (37, 84243)
    ✓ Random_16 (pose=(1.4327813085299388, 3.0679333098396278, 2.2460432453950103)): shape (37, 800, 800)
      Valid pixels: 86558/640000 (13.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=32, max=370740, num_faces=370756
      Valid probs shape: (37, 86558)
    ✓ Random_17 (pose=(-0.1813920929739572, -3.0153188464493943, 1.8315100220237444)): shape (37, 800, 800)
      Valid pixels: 40495/640000 (6.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=686, max=370754, num_faces=370756
      Valid probs shape: (37, 40495)
    ✓ Random_18 (pose=(-0.846336150743729, 0.9917269825308885, 1.2697372387772425)): shape (37, 800, 800)
      Valid pixels: 69025/640000 (10.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=11, max=370749, num_faces=370756
      Valid probs shape: (37, 69025)
    ✓ Random_19 (pose=(-2.3804171955996334, -2.112791925138685, -1.744323441438538)): shape (37, 800, 800)
      Valid pixels: 73348/640000 (11.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=21, max=370715, num_faces=370756
      Valid probs shape: (37, 73348)
    ✓ Random_20 (pose=(2.5845081006576978, -0.2751963634129977, 2.059808610370533)): shape (37, 800, 800)
      Valid pixels: 67721/640000 (10.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=44401, max=370749, num_faces=370756
      Valid probs shape: (37, 67721)
    ✓ Random_21 (pose=(-0.6181381516071291, -2.5398958730301127, -1.4614050816487418)): shape (37, 800, 800)
      Valid pixels: 75276/640000 (11.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=22983, max=370752, num_faces=370756
      Valid probs shape: (37, 75276)
    ✓ Random_22 (pose=(1.9186146461357776, -0.8508819168593176, 2.3430928851520294)): shape (37, 800, 800)
      Valid pixels: 91241/640000 (14.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=57, max=370754, num_faces=370756
      Valid probs shape: (37, 91241)
    ✓ Random_23 (pose=(2.3048815923546107, -2.1497472719628625, 2.357788920681468)): shape (37, 800, 800)
      Valid pixels: 85434/640000 (13.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=10, max=370741, num_faces=370756
      Valid probs shape: (37, 85434)
    ✓ Random_24 (pose=(2.942894966795077, 2.4874767208742554, -0.434239656434543)): shape (37, 800, 800)
      Valid pixels: 46310/640000 (7.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=370714, num_faces=370756
      Valid probs shape: (37, 46310)
    ✓ Random_25 (pose=(-0.11094565071501972, 2.7360119849439464, 2.713408541992787)): shape (37, 800, 800)
      Valid pixels: 44334/640000 (6.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3376, max=370755, num_faces=370756
      Valid probs shape: (37, 44334)
    ✓ Random_26 (pose=(0.030019466208587087, -2.030488115322531, -1.3266005575269895)): shape (37, 800, 800)
      Valid pixels: 80612/640000 (12.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=585, max=370754, num_faces=370756
      Valid probs shape: (37, 80612)
    ✓ Random_27 (pose=(2.4436981220061655, 3.0527547380754774, 1.2527068704623963)): shape (37, 800, 800)
      Valid pixels: 54260/640000 (8.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=370715, num_faces=370756
      Valid probs shape: (37, 54260)
    ✓ Random_28 (pose=(-1.8033242099875662, -0.7442226222890338, 1.7640630591203248)): shape (37, 800, 800)
      Valid pixels: 62250/640000 (9.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=254, max=370715, num_faces=370756
      Valid probs shape: (37, 62250)
    ✓ Random_29 (pose=(0.6319350936847745, -2.1433335746902937, -1.9223476597741136)): shape (37, 800, 800)
      Valid pixels: 79071/640000 (12.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=502, max=370755, num_faces=370756
      Valid probs shape: (37, 79071)
    ✓ Random_30 (pose=(-1.9820883657782526, 3.0832938667761507, 1.8617298767080293)): shape (37, 800, 800)
      Valid pixels: 65265/640000 (10.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=18, max=370715, num_faces=370756
      Valid probs shape: (37, 65265)
    ✓ Random_31 (pose=(0.8728100923258086, -1.7110418842138502, 0.36771040146713574)): shape (37, 800, 800)
      Valid pixels: 97193/640000 (15.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=78, max=370715, num_faces=370756
      Valid probs shape: (37, 97193)
    ✓ Random_32 (pose=(1.7014558961881994, -2.27456070185813, -1.8048660977223407)): shape (37, 800, 800)
      Valid pixels: 62248/640000 (9.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=34, max=370715, num_faces=370756
      Valid probs shape: (37, 62248)
    ✓ Random_33 (pose=(-2.817592437825094, -0.3330177200220028, -1.8379982922523883)): shape (37, 800, 800)
      Valid pixels: 49279/640000 (7.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=76, max=370751, num_faces=370756
      Valid probs shape: (37, 49279)
    ✓ Random_34 (pose=(1.804512050189337, 0.7080180827453235, -2.2757230657692284)): shape (37, 800, 800)
      Valid pixels: 73490/640000 (11.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=43, max=370755, num_faces=370756
      Valid probs shape: (37, 73490)
    ✓ Random_35 (pose=(2.5309205109663777, -1.7500697787704755, -1.4636088235862543)): shape (37, 800, 800)
      Valid pixels: 94323/640000 (14.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7, max=370715, num_faces=370756
      Valid probs shape: (37, 94323)
    ✓ Random_36 (pose=(0.14290537023585248, 1.4487960442093932, 1.967476366127297)): shape (37, 800, 800)
      Valid pixels: 80650/640000 (12.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=19, max=370751, num_faces=370756
      Valid probs shape: (37, 80650)
    ✓ Random_37 (pose=(0.43278836681749633, -1.3219157830982908, -0.9085160925331581)): shape (37, 800, 800)
      Valid pixels: 65280/640000 (10.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=26, max=370715, num_faces=370756
      Valid probs shape: (37, 65280)
    ✓ Random_38 (pose=(1.117428242239936, -2.0997897824648604, 2.3328804219636003)): shape (37, 800, 800)
      Valid pixels: 73090/640000 (11.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=342, max=370746, num_faces=370756
      Valid probs shape: (37, 73090)
    ✓ Random_39 (pose=(0.03570481247523638, -1.118523563622217, -0.6924163048529297)): shape (37, 800, 800)
      Valid pixels: 63469/640000 (9.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=370738, num_faces=370756
      Valid probs shape: (37, 63469)
    P stats: min=0.0000, max=1.0000, mean=0.0254
    Non-zero vertices: 174000/185380
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 11380  1626  1734  3999     0  3014  1181  6714  9129]
  Ground Truth Stats:
    Labels shape: (185380,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-6/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7743
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8212
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8216

  RESULTS:
  RAW:         median(top-10)=0.9143, mean(top-10)=0.9167, median(all)=0.8468, mean(all)=0.7743
  + SMOOTHING: median(top-10)=0.9405, mean(top-10)=0.9378, median(all)=0.8750, mean(all)=0.8212 [+0.0262]
  + MRF:       median(top-10)=0.9409, mean(top-10)=0.9381, median(all)=0.8755, mean(all)=0.8216 [+0.0004]
  TOTAL IMPROVEMENT (median top-10): +0.0266

================================================================================
Subject: NKI-RS-22-7
================================================================================
  Step 0: Generating predictions with V2 model (40 random views)...
  Mesh: 153181 vertices, 306358 faces
  Generating 40 random views...
  Generating predictions for 40 views (continuous camera pose)...
    ✓ Random_0 (pose=(0.5339523064199461, 0.09069583008468207, -0.4413493977960794)): shape (37, 800, 800)
      Valid pixels: 69123/640000 (10.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=306250, num_faces=306358
      Valid probs shape: (37, 69123)
    ✓ Random_1 (pose=(1.3609565433214552, 1.9183028226872718, 0.2605454628954442)): shape (37, 800, 800)
      Valid pixels: 97788/640000 (15.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=28, max=306250, num_faces=306358
      Valid probs shape: (37, 97788)
    ✓ Random_2 (pose=(-0.04336283949692055, 1.2119272641424415, -3.030663669402703)): shape (37, 800, 800)
      Valid pixels: 64370/640000 (10.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=12, max=306158, num_faces=306358
      Valid probs shape: (37, 64370)
    ✓ Random_3 (pose=(-1.0874605215759487, -2.341731416454462, -2.074604899033495)): shape (37, 800, 800)
      Valid pixels: 63361/640000 (9.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2230, max=306357, num_faces=306358
      Valid probs shape: (37, 63361)
    ✓ Random_4 (pose=(0.4545886229471199, 2.916605628290446, 0.12540862716751233)): shape (37, 800, 800)
      Valid pixels: 58525/640000 (9.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4181, max=306357, num_faces=306358
      Valid probs shape: (37, 58525)
    ✓ Random_5 (pose=(1.2379210671378944, 2.4684901210434447, -2.60276478140979)): shape (37, 800, 800)
      Valid pixels: 84919/640000 (13.3%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=65, max=306349, num_faces=306358
      Valid probs shape: (37, 84919)
    ✓ Random_6 (pose=(1.9965913307892986, 1.7868921284554338, -2.790472006534869)): shape (37, 800, 800)
      Valid pixels: 105382/640000 (16.5%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=15, max=306353, num_faces=306358
      Valid probs shape: (37, 105382)
    ✓ Random_7 (pose=(2.0693542076544, 0.8382010731340768, -2.067403727321982)): shape (37, 800, 800)
      Valid pixels: 86427/640000 (13.5%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=63, max=306353, num_faces=306358
      Valid probs shape: (37, 86427)
    ✓ Random_8 (pose=(0.5662827994160726, -0.4050127416405074, 3.12990779791377)): shape (37, 800, 800)
      Valid pixels: 79584/640000 (12.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=306249, num_faces=306358
      Valid probs shape: (37, 79584)
    ✓ Random_9 (pose=(-0.3102939724742204, -2.596965285555408, 3.0590026714662963)): shape (37, 800, 800)
      Valid pixels: 56720/640000 (8.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4201, max=306357, num_faces=306358
      Valid probs shape: (37, 56720)
    ✓ Random_10 (pose=(-2.9891272400520945, -0.396594995673031, -2.382486496040509)): shape (37, 800, 800)
      Valid pixels: 62952/640000 (9.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2174, max=306357, num_faces=306358
      Valid probs shape: (37, 62952)
    ✓ Random_11 (pose=(2.917179486257915, 2.2935546377835925, 2.417583449232464)): shape (37, 800, 800)
      Valid pixels: 69125/640000 (10.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=306246, num_faces=306358
      Valid probs shape: (37, 69125)
    ✓ Random_12 (pose=(1.9950358702577455, -1.2244397668578535, 2.146805819826029)): shape (37, 800, 800)
      Valid pixels: 105679/640000 (16.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=15, max=306355, num_faces=306358
      Valid probs shape: (37, 105679)
    ✓ Random_13 (pose=(-1.7876314758869638, 1.5714475773436307, 0.9496921648913217)): shape (37, 800, 800)
      Valid pixels: 74737/640000 (11.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=33, max=306158, num_faces=306358
      Valid probs shape: (37, 74737)
    ✓ Random_14 (pose=(1.2395230204422045, 2.6202702758750176, -0.6738867832780375)): shape (37, 800, 800)
      Valid pixels: 109655/640000 (17.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=6, max=306250, num_faces=306358
      Valid probs shape: (37, 109655)
    ✓ Random_15 (pose=(3.0071124122647594, 0.18979172082450546, -1.0477627759958086)): shape (37, 800, 800)
      Valid pixels: 53481/640000 (8.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7888, max=306350, num_faces=306358
      Valid probs shape: (37, 53481)
    ✓ Random_16 (pose=(0.4327423829399861, 0.8678754732907628, -1.4136248018081432)): shape (37, 800, 800)
      Valid pixels: 93019/640000 (14.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=306250, num_faces=306358
      Valid probs shape: (37, 93019)
    ✓ Random_17 (pose=(-0.7408226987884423, 0.5758288232582482, -2.3176647589688715)): shape (37, 800, 800)
      Valid pixels: 87990/640000 (13.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=306250, num_faces=306358
      Valid probs shape: (37, 87990)
    ✓ Random_18 (pose=(2.6236089480141116, -0.34777660615078565, 2.5193506588679817)): shape (37, 800, 800)
      Valid pixels: 81973/640000 (12.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=9135, max=306357, num_faces=306358
      Valid probs shape: (37, 81973)
    ✓ Random_19 (pose=(0.688079306199036, -1.1044760303801064, 3.03122263078573)): shape (37, 800, 800)
      Valid pixels: 92979/640000 (14.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=10, max=306347, num_faces=306358
      Valid probs shape: (37, 92979)
    ✓ Random_20 (pose=(1.9360333686464068, 0.09794318671259017, -0.2835341120055914)): shape (37, 800, 800)
      Valid pixels: 109263/640000 (17.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=306339, num_faces=306358
      Valid probs shape: (37, 109263)
    ✓ Random_21 (pose=(3.1029181436063658, -2.453868849683382, 3.015960660506626)): shape (37, 800, 800)
      Valid pixels: 53210/640000 (8.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=306135, num_faces=306358
      Valid probs shape: (37, 53210)
    ✓ Random_22 (pose=(0.7371335483637527, 1.210823089643684, -2.9938071507490207)): shape (37, 800, 800)
      Valid pixels: 74284/640000 (11.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=306158, num_faces=306358
      Valid probs shape: (37, 74284)
    ✓ Random_23 (pose=(-0.42178732359965254, -2.5220497076612904, 2.482270223064096)): shape (37, 800, 800)
      Valid pixels: 77382/640000 (12.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=261, max=306357, num_faces=306358
      Valid probs shape: (37, 77382)
    ✓ Random_24 (pose=(-1.7835743361924254, 1.9725542772068092, -1.6511902530400688)): shape (37, 800, 800)
      Valid pixels: 69826/640000 (10.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=13, max=306357, num_faces=306358
      Valid probs shape: (37, 69826)
    ✓ Random_25 (pose=(-2.882524210896709, -1.6756247363848202, 0.3854902910526832)): shape (37, 800, 800)
      Valid pixels: 96943/640000 (15.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=17, max=306348, num_faces=306358
      Valid probs shape: (37, 96943)
    ✓ Random_26 (pose=(0.32331423940905113, -1.9892253249832095, -2.6738008201624996)): shape (37, 800, 800)
      Valid pixels: 97991/640000 (15.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=973, max=306355, num_faces=306358
      Valid probs shape: (37, 97991)
    ✓ Random_27 (pose=(-2.3461241662227765, -2.251763511962325, -2.7445449631734395)): shape (37, 800, 800)
      Valid pixels: 103273/640000 (16.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=10, max=306250, num_faces=306358
      Valid probs shape: (37, 103273)
    ✓ Random_28 (pose=(-1.45940512130994, 2.5962678187092125, 1.3280906379542117)): shape (37, 800, 800)
      Valid pixels: 73932/640000 (11.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=299, max=306335, num_faces=306358
      Valid probs shape: (37, 73932)
    ✓ Random_29 (pose=(-0.6828688538325447, 1.2019206019035131, 1.4595552688550129)): shape (37, 800, 800)
      Valid pixels: 83103/640000 (13.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=0, max=306295, num_faces=306358
      Valid probs shape: (37, 83103)
    ✓ Random_30 (pose=(2.575273195301566, -2.504636725508618, 2.425332314580257)): shape (37, 800, 800)
      Valid pixels: 84629/640000 (13.2%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=2, max=306069, num_faces=306358
      Valid probs shape: (37, 84629)
    ✓ Random_31 (pose=(2.9251088385198916, -0.14738191540882406, -2.5476174891970533)): shape (37, 800, 800)
      Valid pixels: 54444/640000 (8.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7863, max=306357, num_faces=306358
      Valid probs shape: (37, 54444)
    ✓ Random_32 (pose=(-0.7029627637808429, 1.2185565024165603, 0.40221951704938697)): shape (37, 800, 800)
      Valid pixels: 105355/640000 (16.5%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=10, max=306348, num_faces=306358
      Valid probs shape: (37, 105355)
    ✓ Random_33 (pose=(-0.321640588556519, 2.4904888446071753, 0.018724438200247384)): shape (37, 800, 800)
      Valid pixels: 74628/640000 (11.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=33279, max=306357, num_faces=306358
      Valid probs shape: (37, 74628)
    ✓ Random_34 (pose=(-1.4209234077964663, -0.5997730663876593, 0.970573465406976)): shape (37, 800, 800)
      Valid pixels: 75292/640000 (11.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=0, max=306157, num_faces=306358
      Valid probs shape: (37, 75292)
    ✓ Random_35 (pose=(-1.0947910272271502, 0.22853424595986382, -0.5104532301349543)): shape (37, 800, 800)
      Valid pixels: 98598/640000 (15.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=7, max=306328, num_faces=306358
      Valid probs shape: (37, 98598)
    ✓ Random_36 (pose=(-2.581190257908095, -0.8755675119127004, 2.5298275854923817)): shape (37, 800, 800)
      Valid pixels: 68835/640000 (10.8%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=1447, max=306353, num_faces=306358
      Valid probs shape: (37, 68835)
    ✓ Random_37 (pose=(-2.1815151935971127, -0.8249614292224225, 0.4126882002398671)): shape (37, 800, 800)
      Valid pixels: 103097/640000 (16.1%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=633, max=306353, num_faces=306358
      Valid probs shape: (37, 103097)
    ✓ Random_38 (pose=(-1.7476036076157093, 0.23157672673895613, -1.2233272724886441)): shape (37, 800, 800)
      Valid pixels: 84050/640000 (13.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=13, max=306357, num_faces=306358
      Valid probs shape: (37, 84050)
    ✓ Random_39 (pose=(-2.040788668116246, -2.978121767393958, -1.3094298017464674)): shape (37, 800, 800)
      Valid pixels: 70400/640000 (11.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=306357, num_faces=306358
      Valid probs shape: (37, 70400)
    P stats: min=0.0000, max=0.9999, mean=0.0260
    Non-zero vertices: 147412/153181
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 5769 1231 1199 4213    0 3333 1263 4756 6173]
  Ground Truth Stats:
    Labels shape: (153181,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-7/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7786
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8234
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8238

  RESULTS:
  RAW:         median(top-10)=0.9153, mean(top-10)=0.9209, median(all)=0.8591, mean(all)=0.7786
  + SMOOTHING: median(top-10)=0.9310, mean(top-10)=0.9346, median(all)=0.8722, mean(all)=0.8234 [+0.0156]
  + MRF:       median(top-10)=0.9319, mean(top-10)=0.9350, median(all)=0.8739, mean(all)=0.8238 [+0.0009]
  TOTAL IMPROVEMENT (median top-10): +0.0166

================================================================================
Subject: NKI-RS-22-8
================================================================================
  Step 0: Generating predictions with V2 model (40 random views)...
  Mesh: 158049 vertices, 316094 faces
  Generating 40 random views...
  Generating predictions for 40 views (continuous camera pose)...
    ✓ Random_0 (pose=(2.156167948396429, 0.17238026609365598, 2.0061576915232235)): shape (37, 800, 800)
      Valid pixels: 67508/640000 (10.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8454, max=314937, num_faces=316094
      Valid probs shape: (37, 67508)
    ✓ Random_1 (pose=(1.5590253222229693, 1.0350776448279921, 1.3370723292633047)): shape (37, 800, 800)
      Valid pixels: 64072/640000 (10.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=13, max=315774, num_faces=316094
      Valid probs shape: (37, 64072)
    ✓ Random_2 (pose=(2.9562177176113122, -0.8140003679610261, 2.63519407481699)): shape (37, 800, 800)
      Valid pixels: 71003/640000 (11.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5768, max=316093, num_faces=316094
      Valid probs shape: (37, 71003)
    ✓ Random_3 (pose=(1.6630021005487547, 1.6081910820512961, -2.8684050489430803)): shape (37, 800, 800)
      Valid pixels: 91116/640000 (14.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=7, max=316092, num_faces=316094
      Valid probs shape: (37, 91116)
    ✓ Random_4 (pose=(-0.0841866192177747, 1.5422575639581302, 0.29772364798871775)): shape (37, 800, 800)
      Valid pixels: 78372/640000 (12.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=9, max=314930, num_faces=316094
      Valid probs shape: (37, 78372)
    ✓ Random_5 (pose=(3.0561387810335026, 2.7224236247921736, 2.4924180642523375)): shape (37, 800, 800)
      Valid pixels: 53624/640000 (8.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=315776, num_faces=316094
      Valid probs shape: (37, 53624)
    ✓ Random_6 (pose=(-3.0832524402250963, -1.5330017445558444, -0.2090022196216923)): shape (37, 800, 800)
      Valid pixels: 62223/640000 (9.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=315774, num_faces=316094
      Valid probs shape: (37, 62223)
    ✓ Random_7 (pose=(1.525225525919672, -1.6213640409241623, 0.8771969391758336)): shape (37, 800, 800)
      Valid pixels: 77991/640000 (12.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=315775, num_faces=316094
      Valid probs shape: (37, 77991)
    ✓ Random_8 (pose=(0.43581519725801465, 1.0278599779374291, 1.624165464448966)): shape (37, 800, 800)
      Valid pixels: 91842/640000 (14.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=15, max=315481, num_faces=316094
      Valid probs shape: (37, 91842)
    ✓ Random_9 (pose=(-3.0099553110335115, -0.6117744913647649, 0.6499535919964092)): shape (37, 800, 800)
      Valid pixels: 69785/640000 (10.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=39319, max=316092, num_faces=316094
      Valid probs shape: (37, 69785)
    ✓ Random_10 (pose=(-1.6510805083621465, 0.5064937186695486, -1.0454941252771213)): shape (37, 800, 800)
      Valid pixels: 85888/640000 (13.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8, max=315585, num_faces=316094
      Valid probs shape: (37, 85888)
    ✓ Random_11 (pose=(2.231066185088734, -2.0366746814620162, -0.6395157287784121)): shape (37, 800, 800)
      Valid pixels: 98754/640000 (15.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=315959, num_faces=316094
      Valid probs shape: (37, 98754)
    ✓ Random_12 (pose=(2.5909952373839635, 1.477792875182537, -2.5046517564415245)): shape (37, 800, 800)
      Valid pixels: 98024/640000 (15.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=2, max=315467, num_faces=316094
      Valid probs shape: (37, 98024)
    ✓ Random_13 (pose=(-1.1169947928697401, -1.4828649983963367, 0.027462773741778523)): shape (37, 800, 800)
      Valid pixels: 83635/640000 (13.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=13, max=316093, num_faces=316094
      Valid probs shape: (37, 83635)
    ✓ Random_14 (pose=(2.5659454162431157, -0.41621718218833914, 2.065937324822774)): shape (37, 800, 800)
      Valid pixels: 75247/640000 (11.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=39284, max=316092, num_faces=316094
      Valid probs shape: (37, 75247)
    ✓ Random_15 (pose=(2.530618343841267, 1.6671800219389823, 0.578521918467831)): shape (37, 800, 800)
      Valid pixels: 102702/640000 (16.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=9, max=316049, num_faces=316094
      Valid probs shape: (37, 102702)
    ✓ Random_16 (pose=(-2.460329893422868, 2.7906773014897057, 3.127051075478775)): shape (37, 800, 800)
      Valid pixels: 72845/640000 (11.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=315830, num_faces=316094
      Valid probs shape: (37, 72845)
    ✓ Random_17 (pose=(-2.605967445464125, -0.12821631536157785, 2.673562461050417)): shape (37, 800, 800)
      Valid pixels: 67553/640000 (10.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2561, max=316093, num_faces=316094
      Valid probs shape: (37, 67553)
    ✓ Random_18 (pose=(-0.47327185928048765, 1.1936901262814246, -2.5955999513884764)): shape (37, 800, 800)
      Valid pixels: 93722/640000 (14.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=316049, num_faces=316094
      Valid probs shape: (37, 93722)
    ✓ Random_19 (pose=(2.67037481295812, -2.169744225837716, -1.6957748540099666)): shape (37, 800, 800)
      Valid pixels: 82110/640000 (12.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=316087, num_faces=316094
      Valid probs shape: (37, 82110)
    ✓ Random_20 (pose=(-1.685912804762412, 2.540410547395873, -1.3628394630301985)): shape (37, 800, 800)
      Valid pixels: 73070/640000 (11.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=15, max=314945, num_faces=316094
      Valid probs shape: (37, 73070)
    ✓ Random_21 (pose=(1.8962095594444612, -0.6829766502191061, 1.7289799235827985)): shape (37, 800, 800)
      Valid pixels: 75100/640000 (11.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1736, max=314945, num_faces=316094
      Valid probs shape: (37, 75100)
    ✓ Random_22 (pose=(1.0783212085709613, -1.446646718994869, 1.279767348899278)): shape (37, 800, 800)
      Valid pixels: 79182/640000 (12.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=315843, num_faces=316094
      Valid probs shape: (37, 79182)
    ✓ Random_23 (pose=(-0.2506133304282696, 0.230457280560723, -2.0095142296804247)): shape (37, 800, 800)
      Valid pixels: 55739/640000 (8.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=315777, num_faces=316094
      Valid probs shape: (37, 55739)
    ✓ Random_24 (pose=(0.8028170732285593, 1.3419090213162805, 2.246501106585221)): shape (37, 800, 800)
      Valid pixels: 95914/640000 (15.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=316087, num_faces=316094
      Valid probs shape: (37, 95914)
    ✓ Random_25 (pose=(-2.588391767754316, -0.5233600612564557, 1.6895804628006603)): shape (37, 800, 800)
      Valid pixels: 66023/640000 (10.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=9831, max=316093, num_faces=316094
      Valid probs shape: (37, 66023)
    ✓ Random_26 (pose=(-1.7994207670475664, -3.0048349112185218, -0.36980824986856264)): shape (37, 800, 800)
      Valid pixels: 97009/640000 (15.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=314970, num_faces=316094
      Valid probs shape: (37, 97009)
    ✓ Random_27 (pose=(-0.7220189296352322, 0.7826078342816798, -2.1949374330588283)): shape (37, 800, 800)
      Valid pixels: 84867/640000 (13.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=315776, num_faces=316094
      Valid probs shape: (37, 84867)
    ✓ Random_28 (pose=(-2.6998711914418334, -0.5385294376968321, 2.893432709883392)): shape (37, 800, 800)
      Valid pixels: 67453/640000 (10.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2162, max=316093, num_faces=316094
      Valid probs shape: (37, 67453)
    ✓ Random_29 (pose=(1.6079867589284351, -0.5702849010919855, 2.156911040955265)): shape (37, 800, 800)
      Valid pixels: 87736/640000 (13.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=315576, num_faces=316094
      Valid probs shape: (37, 87736)
    ✓ Random_30 (pose=(1.0688908713619476, -2.989433713637664, 2.4788244610423824)): shape (37, 800, 800)
      Valid pixels: 86085/640000 (13.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3295, max=315744, num_faces=316094
      Valid probs shape: (37, 86085)
    ✓ Random_31 (pose=(2.030948238228981, 0.24663706496727889, 0.4803698301858601)): shape (37, 800, 800)
      Valid pixels: 87601/640000 (13.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=315843, num_faces=316094
      Valid probs shape: (37, 87601)
    ✓ Random_32 (pose=(1.1963559558631616, -1.4381135028173033, -0.737944269495165)): shape (37, 800, 800)
      Valid pixels: 81384/640000 (12.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7, max=316093, num_faces=316094
      Valid probs shape: (37, 81384)
    ✓ Random_33 (pose=(-0.7384869756828634, -0.43115742699871396, -1.118787651932795)): shape (37, 800, 800)
      Valid pixels: 80594/640000 (12.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=315109, num_faces=316094
      Valid probs shape: (37, 80594)
    ✓ Random_34 (pose=(-0.14001799573473006, -0.20291731545435576, 0.12800595630676348)): shape (37, 800, 800)
      Valid pixels: 47967/640000 (7.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=315759, num_faces=316094
      Valid probs shape: (37, 47967)
    ✓ Random_35 (pose=(1.4468535010514518, 2.3513241815872323, -2.4214426777971925)): shape (37, 800, 800)
      Valid pixels: 77197/640000 (12.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=32, max=316093, num_faces=316094
      Valid probs shape: (37, 77197)
    ✓ Random_36 (pose=(-0.6374952747839999, -2.9100077053781384, -2.763787805444432)): shape (37, 800, 800)
      Valid pixels: 62914/640000 (9.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=493, max=315773, num_faces=316094
      Valid probs shape: (37, 62914)
    ✓ Random_37 (pose=(-2.7151966026936294, -0.5515277689396356, -1.5476245404128655)): shape (37, 800, 800)
      Valid pixels: 62154/640000 (9.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=455, max=315771, num_faces=316094
      Valid probs shape: (37, 62154)
    ✓ Random_38 (pose=(-2.505595196119346, -2.455034364637473, -0.53611812013308)): shape (37, 800, 800)
      Valid pixels: 68257/640000 (10.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=314944, num_faces=316094
      Valid probs shape: (37, 68257)
    ✓ Random_39 (pose=(0.3500395706031636, -0.7795451981438557, -0.11370500891303115)): shape (37, 800, 800)
      Valid pixels: 56788/640000 (8.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=316093, num_faces=316094
      Valid probs shape: (37, 56788)
    P stats: min=0.0000, max=0.9999, mean=0.0261
    Non-zero vertices: 152677/158049
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 5372 1403 1215 3654    0 2726 1247 5278 6472]
  Ground Truth Stats:
    Labels shape: (158049,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-8/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
    MRF iteration 5/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7900
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8353
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8357

  RESULTS:
  RAW:         median(top-10)=0.9145, mean(top-10)=0.9191, median(all)=0.8477, mean(all)=0.7900
  + SMOOTHING: median(top-10)=0.9321, mean(top-10)=0.9318, median(all)=0.8737, mean(all)=0.8353 [+0.0175]
  + MRF:       median(top-10)=0.9323, mean(top-10)=0.9320, median(all)=0.8744, mean(all)=0.8357 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0178

================================================================================
Subject: NKI-RS-22-9
================================================================================
  Step 0: Generating predictions with V2 model (40 random views)...
  Mesh: 129746 vertices, 259488 faces
  Generating 40 random views...
  Generating predictions for 40 views (continuous camera pose)...
    ✓ Random_0 (pose=(-0.11663995535940819, 1.3858512616459011, -1.3296231449416762)): shape (37, 800, 800)
      Valid pixels: 83031/640000 (13.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=259417, num_faces=259488
      Valid probs shape: (37, 83031)
    ✓ Random_1 (pose=(-2.1919091657095473, 1.1332404477530655, 1.9547789926895396)): shape (37, 800, 800)
      Valid pixels: 94244/640000 (14.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=84, max=259432, num_faces=259488
      Valid probs shape: (37, 94244)
    ✓ Random_2 (pose=(-0.8167822028860527, -2.1851654023788445, 3.0759284404095073)): shape (37, 800, 800)
      Valid pixels: 71574/640000 (11.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=259485, num_faces=259488
      Valid probs shape: (37, 71574)
    ✓ Random_3 (pose=(0.270667989253214, 2.873791099818252, 2.8628865219340494)): shape (37, 800, 800)
      Valid pixels: 54181/640000 (8.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5974, max=259486, num_faces=259488
      Valid probs shape: (37, 54181)
    ✓ Random_4 (pose=(1.9866948049437205, 0.8216622269227138, -0.9688223232633852)): shape (37, 800, 800)
      Valid pixels: 70367/640000 (11.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=285, max=259438, num_faces=259488
      Valid probs shape: (37, 70367)
    ✓ Random_5 (pose=(-1.3437780090433633, -0.47088715370306744, 0.5434959919876108)): shape (37, 800, 800)
      Valid pixels: 69114/640000 (10.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=8, max=259484, num_faces=259488
      Valid probs shape: (37, 69114)
    ✓ Random_6 (pose=(1.6791485027002038, 2.167384223549929, 0.30406408731010837)): shape (37, 800, 800)
      Valid pixels: 88863/640000 (13.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=10, max=259422, num_faces=259488
      Valid probs shape: (37, 88863)
    ✓ Random_7 (pose=(2.077234532438651, -0.9730197944904373, 1.019022945878219)): shape (37, 800, 800)
      Valid pixels: 56090/640000 (8.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=235, max=259485, num_faces=259488
      Valid probs shape: (37, 56090)
    ✓ Random_8 (pose=(-0.8596619056033807, 1.2909177861326482, 0.9167743128364219)): shape (37, 800, 800)
      Valid pixels: 79633/640000 (12.4%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=2, max=259487, num_faces=259488
      Valid probs shape: (37, 79633)
    ✓ Random_9 (pose=(-1.10242852316397, -0.15185659156591846, -1.1040781417698433)): shape (37, 800, 800)
      Valid pixels: 76123/640000 (11.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=259486, num_faces=259488
      Valid probs shape: (37, 76123)
    ✓ Random_10 (pose=(-2.69510807438808, -0.034215893320524327, -1.9043518198235299)): shape (37, 800, 800)
      Valid pixels: 43391/640000 (6.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2731, max=259487, num_faces=259488
      Valid probs shape: (37, 43391)
    ✓ Random_11 (pose=(0.9966846238835698, 2.724118497212894, 2.441271481323862)): shape (37, 800, 800)
      Valid pixels: 87291/640000 (13.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=509, max=259486, num_faces=259488
      Valid probs shape: (37, 87291)
    ✓ Random_12 (pose=(0.8874297374274818, -2.0426434869858996, 0.2766304328206304)): shape (37, 800, 800)
      Valid pixels: 95077/640000 (14.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=115, max=259426, num_faces=259488
      Valid probs shape: (37, 95077)
    ✓ Random_13 (pose=(1.506370811441669, -2.0994311286070664, -0.5235011978724589)): shape (37, 800, 800)
      Valid pixels: 96730/640000 (15.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=21, max=259432, num_faces=259488
      Valid probs shape: (37, 96730)
    ✓ Random_14 (pose=(-0.09277988903688339, 0.9240134737399668, 1.6782098084614656)): shape (37, 800, 800)
      Valid pixels: 69869/640000 (10.9%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=3, max=259438, num_faces=259488
      Valid probs shape: (37, 69869)
    ✓ Random_15 (pose=(0.9989835196431667, 2.199525084016382, -2.6504412408416806)): shape (37, 800, 800)
      Valid pixels: 65574/640000 (10.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=653, max=259485, num_faces=259488
      Valid probs shape: (37, 65574)
    ✓ Random_16 (pose=(-2.278792004578228, -0.8149116755785912, -0.569896690780094)): shape (37, 800, 800)
      Valid pixels: 74231/640000 (11.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=426, max=259486, num_faces=259488
      Valid probs shape: (37, 74231)
    ✓ Random_17 (pose=(0.4969206069721368, -1.5162918030468164, 0.713563518940973)): shape (37, 800, 800)
      Valid pixels: 98302/640000 (15.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=24, max=259426, num_faces=259488
      Valid probs shape: (37, 98302)
    ✓ Random_18 (pose=(2.518388821554427, -0.17723774978276907, -0.14000409186613316)): shape (37, 800, 800)
      Valid pixels: 62091/640000 (9.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=259, max=259487, num_faces=259488
      Valid probs shape: (37, 62091)
    ✓ Random_19 (pose=(2.319023592062859, -2.07413052443104, -2.5698144548716946)): shape (37, 800, 800)
      Valid pixels: 59638/640000 (9.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=29, max=259438, num_faces=259488
      Valid probs shape: (37, 59638)
    ✓ Random_20 (pose=(1.2618764989705662, 0.11108276697108277, 1.3615829444353684)): shape (37, 800, 800)
      Valid pixels: 56479/640000 (8.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=259363, num_faces=259488
      Valid probs shape: (37, 56479)
    ✓ Random_21 (pose=(0.6411885909953194, -2.1836551946541736, 0.9287866867600725)): shape (37, 800, 800)
      Valid pixels: 82677/640000 (12.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=199, max=259487, num_faces=259488
      Valid probs shape: (37, 82677)
    ✓ Random_22 (pose=(-1.9420349509651325, 0.5051757731290234, -0.5769679568869046)): shape (37, 800, 800)
      Valid pixels: 91340/640000 (14.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=76, max=259487, num_faces=259488
      Valid probs shape: (37, 91340)
    ✓ Random_23 (pose=(2.8463359427086994, 0.934853904651674, -2.171602059634676)): shape (37, 800, 800)
      Valid pixels: 84569/640000 (13.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1078, max=259486, num_faces=259488
      Valid probs shape: (37, 84569)
    ✓ Random_24 (pose=(0.9101445798705914, 1.1792472710353818, 1.110948947515646)): shape (37, 800, 800)
      Valid pixels: 63790/640000 (10.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=259486, num_faces=259488
      Valid probs shape: (37, 63790)
    ✓ Random_25 (pose=(1.5634045649143848, 1.650763347035177, -1.6688851057765302)): shape (37, 800, 800)
      Valid pixels: 60638/640000 (9.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=80, max=259438, num_faces=259488
      Valid probs shape: (37, 60638)
    ✓ Random_26 (pose=(-1.7408240842296228, -1.0407908519112814, -2.556135045823509)): shape (37, 800, 800)
      Valid pixels: 80807/640000 (12.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7, max=259417, num_faces=259488
      Valid probs shape: (37, 80807)
    ✓ Random_27 (pose=(-0.040215897263533584, -2.6088953294338255, 2.8774882018972967)): shape (37, 800, 800)
      Valid pixels: 45290/640000 (7.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2731, max=259487, num_faces=259488
      Valid probs shape: (37, 45290)
    ✓ Random_28 (pose=(-2.3296936309295475, 0.7718160294892762, -1.2310844491591844)): shape (37, 800, 800)
      Valid pixels: 86371/640000 (13.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2356, max=259486, num_faces=259488
      Valid probs shape: (37, 86371)
    ✓ Random_29 (pose=(-1.7071255622889123, -1.563679986068366, 2.735494189052077)): shape (37, 800, 800)
      Valid pixels: 97249/640000 (15.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=259432, num_faces=259488
      Valid probs shape: (37, 97249)
    ✓ Random_30 (pose=(1.424787896685448, -1.3272068711682883, -1.6664582268372992)): shape (37, 800, 800)
      Valid pixels: 61676/640000 (9.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=75, max=259438, num_faces=259488
      Valid probs shape: (37, 61676)
    ✓ Random_31 (pose=(0.7518922563742323, -1.1244525511688526, -1.3375441566749762)): shape (37, 800, 800)
      Valid pixels: 62657/640000 (9.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=45, max=259438, num_faces=259488
      Valid probs shape: (37, 62657)
    ✓ Random_32 (pose=(2.5287779272673623, -0.13159836931444868, 0.4659191750959133)): shape (37, 800, 800)
      Valid pixels: 54148/640000 (8.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=265, max=259486, num_faces=259488
      Valid probs shape: (37, 54148)
    ✓ Random_33 (pose=(-0.5983108711590068, 2.5364295579173968, 1.7044748451749374)): shape (37, 800, 800)
      Valid pixels: 59936/640000 (9.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3478, max=259486, num_faces=259488
      Valid probs shape: (37, 59936)
    ✓ Random_34 (pose=(-2.7778250873818475, -1.3043159911690207, 0.7748720609603219)): shape (37, 800, 800)
      Valid pixels: 92505/640000 (14.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=12, max=259485, num_faces=259488
      Valid probs shape: (37, 92505)
    ✓ Random_35 (pose=(-0.9099835242353693, 1.36011632918677, -1.1314204640493233)): shape (37, 800, 800)
      Valid pixels: 57795/640000 (9.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=259484, num_faces=259488
      Valid probs shape: (37, 57795)
    ✓ Random_36 (pose=(1.112556389240419, -0.39210722709648094, 0.06701960211616331)): shape (37, 800, 800)
      Valid pixels: 90006/640000 (14.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=259426, num_faces=259488
      Valid probs shape: (37, 90006)
    ✓ Random_37 (pose=(0.23361894707234798, 2.2522236434703675, -2.1242007876330478)): shape (37, 800, 800)
      Valid pixels: 75600/640000 (11.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=259, max=259485, num_faces=259488
      Valid probs shape: (37, 75600)
    ✓ Random_38 (pose=(-0.156739032537486, -0.4264688597592001, -0.8568929088007873)): shape (37, 800, 800)
      Valid pixels: 53137/640000 (8.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=259004, num_faces=259488
      Valid probs shape: (37, 53137)
    ✓ Random_39 (pose=(-2.1025206117172335, 1.345977605492675, -1.2875876840786304)): shape (37, 800, 800)
      Valid pixels: 90598/640000 (14.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=259485, num_faces=259488
      Valid probs shape: (37, 90598)
    P stats: min=0.0000, max=1.0000, mean=0.0259
    Non-zero vertices: 124463/129746
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 5283 1366 1005 3458    0 2213 1073 4551 5922]
  Ground Truth Stats:
    Labels shape: (129746,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-9/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7898
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8389
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8392

  RESULTS:
  RAW:         median(top-10)=0.9195, mean(top-10)=0.9229, median(all)=0.8424, mean(all)=0.7898
  + SMOOTHING: median(top-10)=0.9292, mean(top-10)=0.9377, median(all)=0.8727, mean(all)=0.8389 [+0.0098]
  + MRF:       median(top-10)=0.9295, mean(top-10)=0.9379, median(all)=0.8728, mean(all)=0.8392 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0100

================================================================================
Subject: NKI-TRT-20-1
================================================================================
  Step 0: Generating predictions with V2 model (40 random views)...
  Mesh: 143932 vertices, 287860 faces
  Generating 40 random views...
  Generating predictions for 40 views (continuous camera pose)...
    ✓ Random_0 (pose=(-1.6619600329894646, 0.7027728706499645, -2.6204953494230354)): shape (37, 800, 800)
      Valid pixels: 113441/640000 (17.7%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=1, max=287846, num_faces=287860
      Valid probs shape: (37, 113441)
    ✓ Random_1 (pose=(0.3406288769599213, 2.7292140152060087, -2.590164450907404)): shape (37, 800, 800)
      Valid pixels: 81616/640000 (12.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2730, max=287859, num_faces=287860
      Valid probs shape: (37, 81616)
    ✓ Random_2 (pose=(-0.08588039051624818, 2.76291123028635, -0.48555975628387893)): shape (37, 800, 800)
      Valid pixels: 59872/640000 (9.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3000, max=287857, num_faces=287860
      Valid probs shape: (37, 59872)
    ✓ Random_3 (pose=(1.080603653081572, -1.3335357331605229, 2.782558144184831)): shape (37, 800, 800)
      Valid pixels: 119896/640000 (18.7%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=14, max=287855, num_faces=287860
      Valid probs shape: (37, 119896)
    ✓ Random_4 (pose=(1.5778139293776432, -0.27735204259668667, 2.5352494124676443)): shape (37, 800, 800)
      Valid pixels: 127009/640000 (19.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=17, max=287855, num_faces=287860
      Valid probs shape: (37, 127009)
    ✓ Random_5 (pose=(-0.7330714550477069, 0.6244824804334339, 0.35714536020957643)): shape (37, 800, 800)
      Valid pixels: 118650/640000 (18.5%)
      Probs stats: min=0.0000, max=0.9995, mean=0.0270
      Face IDs: min=7, max=287857, num_faces=287860
      Valid probs shape: (37, 118650)
    ✓ Random_6 (pose=(-2.6227330294818048, -0.8039416738849097, -3.1182204939139853)): shape (37, 800, 800)
      Valid pixels: 114270/640000 (17.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=600, max=287859, num_faces=287860
      Valid probs shape: (37, 114270)
    ✓ Random_7 (pose=(-2.588257097417623, 2.951116069212757, 1.366529974189687)): shape (37, 800, 800)
      Valid pixels: 63793/640000 (10.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=287849, num_faces=287860
      Valid probs shape: (37, 63793)
    ✓ Random_8 (pose=(0.33244215141923616, -0.27102950394064695, 2.4184580332504275)): shape (37, 800, 800)
      Valid pixels: 77451/640000 (12.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=287664, num_faces=287860
      Valid probs shape: (37, 77451)
    ✓ Random_9 (pose=(-2.635681192451318, 2.1413809886414565, -0.5292272954585191)): shape (37, 800, 800)
      Valid pixels: 104240/640000 (16.3%)
      Probs stats: min=0.0000, max=0.9993, mean=0.0270
      Face IDs: min=10, max=287856, num_faces=287860
      Valid probs shape: (37, 104240)
    ✓ Random_10 (pose=(-1.5189459584567215, -1.771455029881593, -0.711388039128686)): shape (37, 800, 800)
      Valid pixels: 125352/640000 (19.6%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=5, max=287855, num_faces=287860
      Valid probs shape: (37, 125352)
    ✓ Random_11 (pose=(-0.7231352471072485, 1.413351243614084, 0.4981412857354286)): shape (37, 800, 800)
      Valid pixels: 130710/640000 (20.4%)
      Probs stats: min=0.0000, max=0.9994, mean=0.0270
      Face IDs: min=2, max=287856, num_faces=287860
      Valid probs shape: (37, 130710)
    ✓ Random_12 (pose=(1.3167633635131315, -0.3696092066427452, -1.9364521368089351)): shape (37, 800, 800)
      Valid pixels: 88166/640000 (13.8%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=8, max=287858, num_faces=287860
      Valid probs shape: (37, 88166)
    ✓ Random_13 (pose=(0.8254177663750899, 0.6262958898142239, -0.6146746954233686)): shape (37, 800, 800)
      Valid pixels: 114788/640000 (17.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=287850, num_faces=287860
      Valid probs shape: (37, 114788)
    ✓ Random_14 (pose=(-2.020404506815111, -2.0605471437469154, 3.1031206708938344)): shape (37, 800, 800)
      Valid pixels: 130712/640000 (20.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=287850, num_faces=287860
      Valid probs shape: (37, 130712)
    ✓ Random_15 (pose=(-3.1285002765620527, 0.4795766082806465, -2.3505793979877674)): shape (37, 800, 800)
      Valid pixels: 84863/640000 (13.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=49318, max=287850, num_faces=287860
      Valid probs shape: (37, 84863)
    ✓ Random_16 (pose=(1.6554820891782018, 0.6865758179091075, 0.6853796711599718)): shape (37, 800, 800)
      Valid pixels: 110752/640000 (17.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=287846, num_faces=287860
      Valid probs shape: (37, 110752)
    ✓ Random_17 (pose=(-1.6139248802783535, 1.8668897961136848, -1.615141928148843)): shape (37, 800, 800)
      Valid pixels: 80221/640000 (12.5%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=27, max=287856, num_faces=287860
      Valid probs shape: (37, 80221)
    ✓ Random_18 (pose=(2.477552473068548, -1.3641165514027762, 1.347994374971079)): shape (37, 800, 800)
      Valid pixels: 115810/640000 (18.1%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=80, max=287853, num_faces=287860
      Valid probs shape: (37, 115810)
    ✓ Random_19 (pose=(1.4097653670422856, 0.9309085196984626, 3.0951780594668756)): shape (37, 800, 800)
      Valid pixels: 123656/640000 (19.3%)
      Probs stats: min=0.0000, max=0.9985, mean=0.0270
      Face IDs: min=11, max=287856, num_faces=287860
      Valid probs shape: (37, 123656)
    ✓ Random_20 (pose=(-2.098727407930146, 2.3132705686748105, -1.2130069331897408)): shape (37, 800, 800)
      Valid pixels: 119670/640000 (18.7%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=6, max=287855, num_faces=287860
      Valid probs shape: (37, 119670)
    ✓ Random_21 (pose=(-2.444528590863942, -0.5534313261471011, -1.4396874979468226)): shape (37, 800, 800)
      Valid pixels: 78004/640000 (12.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1177, max=287840, num_faces=287860
      Valid probs shape: (37, 78004)
    ✓ Random_22 (pose=(-2.8711775893015377, -0.2877247596500032, -0.7641154036123416)): shape (37, 800, 800)
      Valid pixels: 61531/640000 (9.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=55141, max=287849, num_faces=287860
      Valid probs shape: (37, 61531)
    ✓ Random_23 (pose=(1.215325399266864, -1.0283764202191308, -2.601307280603438)): shape (37, 800, 800)
      Valid pixels: 118132/640000 (18.5%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=10, max=287859, num_faces=287860
      Valid probs shape: (37, 118132)
    ✓ Random_24 (pose=(1.0440696529268063, 0.3752684899076817, 2.3247478116162785)): shape (37, 800, 800)
      Valid pixels: 122029/640000 (19.1%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=9, max=287855, num_faces=287860
      Valid probs shape: (37, 122029)
    ✓ Random_25 (pose=(-1.0737048144886874, -0.6149519980616707, -2.1665018423711033)): shape (37, 800, 800)
      Valid pixels: 86971/640000 (13.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=5, max=287808, num_faces=287860
      Valid probs shape: (37, 86971)
    ✓ Random_26 (pose=(1.984532826930347, -0.5992225739106125, -3.108709656179215)): shape (37, 800, 800)
      Valid pixels: 115391/640000 (18.0%)
      Probs stats: min=0.0000, max=0.9994, mean=0.0270
      Face IDs: min=475, max=287859, num_faces=287860
      Valid probs shape: (37, 115391)
    ✓ Random_27 (pose=(-2.8550938617123673, 0.18041591428851556, -2.567199865962081)): shape (37, 800, 800)
      Valid pixels: 61017/640000 (9.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1176, max=287847, num_faces=287860
      Valid probs shape: (37, 61017)
    ✓ Random_28 (pose=(0.2096487465618111, -1.178513046528658, -2.2287821828626595)): shape (37, 800, 800)
      Valid pixels: 126639/640000 (19.8%)
      Probs stats: min=0.0000, max=0.9995, mean=0.0270
      Face IDs: min=10, max=287856, num_faces=287860
      Valid probs shape: (37, 126639)
    ✓ Random_29 (pose=(-0.6339008356527724, 2.1683023286812597, 0.6850324002281707)): shape (37, 800, 800)
      Valid pixels: 120700/640000 (18.9%)
      Probs stats: min=0.0000, max=0.9995, mean=0.0270
      Face IDs: min=6446, max=287856, num_faces=287860
      Valid probs shape: (37, 120700)
    ✓ Random_30 (pose=(-2.5756134814557083, -1.0203839838346722, 0.1662916433629147)): shape (37, 800, 800)
      Valid pixels: 114830/640000 (17.9%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=3986, max=287853, num_faces=287860
      Valid probs shape: (37, 114830)
    ✓ Random_31 (pose=(0.3040410104618414, -1.761736229559035, 0.867994335091276)): shape (37, 800, 800)
      Valid pixels: 139063/640000 (21.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=50, max=287858, num_faces=287860
      Valid probs shape: (37, 139063)
    ✓ Random_32 (pose=(-2.1408550988661372, -1.537269102027152, -0.1304813163538534)): shape (37, 800, 800)
      Valid pixels: 124110/640000 (19.4%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=26, max=287857, num_faces=287860
      Valid probs shape: (37, 124110)
    ✓ Random_33 (pose=(-0.30781699872560786, -0.48128414963537036, -0.12752111498353802)): shape (37, 800, 800)
      Valid pixels: 80016/640000 (12.5%)
      Probs stats: min=0.0000, max=0.9995, mean=0.0270
      Face IDs: min=6, max=287294, num_faces=287860
      Valid probs shape: (37, 80016)
    ✓ Random_34 (pose=(1.4353089318173051, 2.079888210760007, 1.4937081779674255)): shape (37, 800, 800)
      Valid pixels: 80307/640000 (12.5%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=348, max=287852, num_faces=287860
      Valid probs shape: (37, 80307)
    ✓ Random_35 (pose=(3.0331625046648236, 2.8442527095355787, -0.06955248576815176)): shape (37, 800, 800)
      Valid pixels: 61345/640000 (9.6%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=0, max=287289, num_faces=287860
      Valid probs shape: (37, 61345)
    ✓ Random_36 (pose=(1.4244150261221078, 0.8575337560469389, 1.251011766629663)): shape (37, 800, 800)
      Valid pixels: 85165/640000 (13.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=7, max=287851, num_faces=287860
      Valid probs shape: (37, 85165)
    ✓ Random_37 (pose=(-0.3692102593397091, -2.169041374491101, -1.1235822384687522)): shape (37, 800, 800)
      Valid pixels: 116783/640000 (18.2%)
      Probs stats: min=0.0000, max=0.9995, mean=0.0270
      Face IDs: min=8179, max=287856, num_faces=287860
      Valid probs shape: (37, 116783)
    ✓ Random_38 (pose=(-0.6394555616317379, -2.3364034825403484, -2.8062371540879396)): shape (37, 800, 800)
      Valid pixels: 83481/640000 (13.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1144, max=287852, num_faces=287860
      Valid probs shape: (37, 83481)
    ✓ Random_39 (pose=(1.3640797209781947, 2.5002845304675976, 0.5247490041665812)): shape (37, 800, 800)
      Valid pixels: 109066/640000 (17.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=287808, num_faces=287860
      Valid probs shape: (37, 109066)
    P stats: min=0.0000, max=0.9999, mean=0.0258
    Non-zero vertices: 137297/143932
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 6635 1332 1003 3552    0 1819  833 4756 8117]
  Ground Truth Stats:
    Labels shape: (143932,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-1/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7841
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8329
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8334

  RESULTS:
  RAW:         median(top-10)=0.9119, mean(top-10)=0.9063, median(all)=0.8447, mean(all)=0.7841
  + SMOOTHING: median(top-10)=0.9307, mean(top-10)=0.9289, median(all)=0.8776, mean(all)=0.8329 [+0.0188]
  + MRF:       median(top-10)=0.9307, mean(top-10)=0.9289, median(all)=0.8783, mean(all)=0.8334 [+0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0189

================================================================================
Subject: NKI-TRT-20-10
================================================================================
  Step 0: Generating predictions with V2 model (40 random views)...
  Mesh: 122978 vertices, 245952 faces
  Generating 40 random views...
  Generating predictions for 40 views (continuous camera pose)...
    ✓ Random_0 (pose=(-1.8110827584011546, 0.6564939355456318, -1.8824052955798871)): shape (37, 800, 800)
      Valid pixels: 54141/640000 (8.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=245950, num_faces=245952
      Valid probs shape: (37, 54141)
    ✓ Random_1 (pose=(-1.715269611086112, -2.63880977154016, 2.7547468760901435)): shape (37, 800, 800)
      Valid pixels: 85273/640000 (13.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7, max=245941, num_faces=245952
      Valid probs shape: (37, 85273)
    ✓ Random_2 (pose=(0.22308859067522535, -2.8620297394444796, 2.265237135749672)): shape (37, 800, 800)
      Valid pixels: 38091/640000 (6.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=14908, max=245951, num_faces=245952
      Valid probs shape: (37, 38091)
    ✓ Random_3 (pose=(0.9069190991957612, 3.0647005714257496, 1.8500696598561666)): shape (37, 800, 800)
      Valid pixels: 57273/640000 (8.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=14867, max=245621, num_faces=245952
      Valid probs shape: (37, 57273)
    ✓ Random_4 (pose=(-1.2222407598507854, 1.338288905694693, 2.5459230552379974)): shape (37, 800, 800)
      Valid pixels: 76232/640000 (11.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=46, max=245943, num_faces=245952
      Valid probs shape: (37, 76232)
    ✓ Random_5 (pose=(0.8385696320706728, 2.8095990380365423, 1.144403339642551)): shape (37, 800, 800)
      Valid pixels: 47498/640000 (7.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=48, max=245943, num_faces=245952
      Valid probs shape: (37, 47498)
    ✓ Random_6 (pose=(0.4767561755816958, 2.3993675279429203, 2.2161539492733144)): shape (37, 800, 800)
      Valid pixels: 71359/640000 (11.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3501, max=245951, num_faces=245952
      Valid probs shape: (37, 71359)
    ✓ Random_7 (pose=(2.701520605110269, -2.7631074482669105, -1.6772570234770572)): shape (37, 800, 800)
      Valid pixels: 48644/640000 (7.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=245942, num_faces=245952
      Valid probs shape: (37, 48644)
    ✓ Random_8 (pose=(-1.3592700808093099, 0.3280609771581955, 1.3857537923740093)): shape (37, 800, 800)
      Valid pixels: 56744/640000 (8.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=47, max=245951, num_faces=245952
      Valid probs shape: (37, 56744)
    ✓ Random_9 (pose=(-0.01834459115847986, 0.9073668511844284, 1.6084079498002364)): shape (37, 800, 800)
      Valid pixels: 66820/640000 (10.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=245950, num_faces=245952
      Valid probs shape: (37, 66820)
    ✓ Random_10 (pose=(2.7198912486258964, -2.7009057455809877, 1.7184707080060386)): shape (37, 800, 800)
      Valid pixels: 56625/640000 (8.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=245626, num_faces=245952
      Valid probs shape: (37, 56625)
    ✓ Random_11 (pose=(-1.2994217096314957, -1.3392250798173095, 1.5920254614214464)): shape (37, 800, 800)
      Valid pixels: 63864/640000 (10.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=33, max=245904, num_faces=245952
      Valid probs shape: (37, 63864)
    ✓ Random_12 (pose=(1.5568850616839054, 0.9033024279844923, 0.34912597836919756)): shape (37, 800, 800)
      Valid pixels: 77862/640000 (12.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6, max=245944, num_faces=245952
      Valid probs shape: (37, 77862)
    ✓ Random_13 (pose=(-2.676907911448577, -1.3978997988705377, -2.855922792504632)): shape (37, 800, 800)
      Valid pixels: 79592/640000 (12.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=33, max=245942, num_faces=245952
      Valid probs shape: (37, 79592)
    ✓ Random_14 (pose=(-1.7373160562798142, -2.8246058139345402, -2.9025733110748977)): shape (37, 800, 800)
      Valid pixels: 81342/640000 (12.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7, max=245944, num_faces=245952
      Valid probs shape: (37, 81342)
    ✓ Random_15 (pose=(-2.9603601827949726, -1.7228269660860434, 1.2846019918104243)): shape (37, 800, 800)
      Valid pixels: 80544/640000 (12.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=9, max=245904, num_faces=245952
      Valid probs shape: (37, 80544)
    ✓ Random_16 (pose=(-2.456060517157459, -0.6826341820392412, 0.15860122814186806)): shape (37, 800, 800)
      Valid pixels: 72810/640000 (11.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3579, max=245951, num_faces=245952
      Valid probs shape: (37, 72810)
    ✓ Random_17 (pose=(-1.6020847412885175, -1.039404268767123, 2.260878867991795)): shape (37, 800, 800)
      Valid pixels: 77266/640000 (12.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=13, max=245942, num_faces=245952
      Valid probs shape: (37, 77266)
    ✓ Random_18 (pose=(1.9887122356617857, 0.696712801616278, 2.6587822921396853)): shape (37, 800, 800)
      Valid pixels: 76914/640000 (12.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=22, max=245624, num_faces=245952
      Valid probs shape: (37, 76914)
    ✓ Random_19 (pose=(-2.829494740283814, 0.9496247822474038, -0.023157529738057736)): shape (37, 800, 800)
      Valid pixels: 57028/640000 (8.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2097, max=245949, num_faces=245952
      Valid probs shape: (37, 57028)
    ✓ Random_20 (pose=(-0.2144114743365666, 1.11786298731856, 0.727453398973354)): shape (37, 800, 800)
      Valid pixels: 76232/640000 (11.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7, max=245626, num_faces=245952
      Valid probs shape: (37, 76232)
    ✓ Random_21 (pose=(-1.3131163056545507, -1.0066487918253642, -1.6550825873470782)): shape (37, 800, 800)
      Valid pixels: 56565/640000 (8.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=19, max=245946, num_faces=245952
      Valid probs shape: (37, 56565)
    ✓ Random_22 (pose=(2.0286934981566827, -2.1197563823578234, 1.3667876932254162)): shape (37, 800, 800)
      Valid pixels: 58703/640000 (9.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=245950, num_faces=245952
      Valid probs shape: (37, 58703)
    ✓ Random_23 (pose=(1.9450307537776519, -2.3953309030831584, -0.0032654096975472946)): shape (37, 800, 800)
      Valid pixels: 78450/640000 (12.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7, max=245944, num_faces=245952
      Valid probs shape: (37, 78450)
    ✓ Random_24 (pose=(-2.0234118740878295, 1.8404538682384741, 0.7071331607395588)): shape (37, 800, 800)
      Valid pixels: 59637/640000 (9.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=61, max=245903, num_faces=245952
      Valid probs shape: (37, 59637)
    ✓ Random_25 (pose=(0.8042725994139857, -3.0370147120913438, 2.4896513695934974)): shape (37, 800, 800)
      Valid pixels: 66239/640000 (10.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7053, max=245951, num_faces=245952
      Valid probs shape: (37, 66239)
    ✓ Random_26 (pose=(-0.5372618421146931, -2.5813773879666275, -1.915497846167555)): shape (37, 800, 800)
      Valid pixels: 55606/640000 (8.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=27743, max=245951, num_faces=245952
      Valid probs shape: (37, 55606)
    ✓ Random_27 (pose=(-1.355497480663929, -1.6455797032593975, -1.2538871130822407)): shape (37, 800, 800)
      Valid pixels: 72319/640000 (11.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=245625, num_faces=245952
      Valid probs shape: (37, 72319)
    ✓ Random_28 (pose=(2.1025122909923413, -1.2484209286103385, -2.765760402634367)): shape (37, 800, 800)
      Valid pixels: 64127/640000 (10.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=77, max=245949, num_faces=245952
      Valid probs shape: (37, 64127)
    ✓ Random_29 (pose=(-1.8819605640364416, -1.4881470824273966, 0.3888380632131123)): shape (37, 800, 800)
      Valid pixels: 79467/640000 (12.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=68, max=245872, num_faces=245952
      Valid probs shape: (37, 79467)
    ✓ Random_30 (pose=(0.6717796070951536, -1.5392960560024258, -0.03942840804318681)): shape (37, 800, 800)
      Valid pixels: 76257/640000 (11.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=25, max=245943, num_faces=245952
      Valid probs shape: (37, 76257)
    ✓ Random_31 (pose=(1.724147554994711, -1.8446889609889436, 0.6609615515688825)): shape (37, 800, 800)
      Valid pixels: 67166/640000 (10.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=21, max=245944, num_faces=245952
      Valid probs shape: (37, 67166)
    ✓ Random_32 (pose=(-0.9041237762322001, 2.594391025446394, -2.748466950691724)): shape (37, 800, 800)
      Valid pixels: 74427/640000 (11.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=245943, num_faces=245952
      Valid probs shape: (37, 74427)
    ✓ Random_33 (pose=(-3.0057078650732345, -0.6943690947167416, -1.3105324330744244)): shape (37, 800, 800)
      Valid pixels: 56437/640000 (8.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=10, max=245944, num_faces=245952
      Valid probs shape: (37, 56437)
    ✓ Random_34 (pose=(0.7555314207111405, 0.5678760338809834, 3.0474191971332187)): shape (37, 800, 800)
      Valid pixels: 61286/640000 (9.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=245622, num_faces=245952
      Valid probs shape: (37, 61286)
    ✓ Random_35 (pose=(-0.03741618869272045, -3.049201742358292, -1.7255802642854003)): shape (37, 800, 800)
      Valid pixels: 38349/640000 (6.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=61441, max=245951, num_faces=245952
      Valid probs shape: (37, 38349)
    ✓ Random_36 (pose=(-0.5832173742869338, 2.6580938462149364, -1.6524987479690707)): shape (37, 800, 800)
      Valid pixels: 51585/640000 (8.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=24, max=245944, num_faces=245952
      Valid probs shape: (37, 51585)
    ✓ Random_37 (pose=(-1.9995350648661836, 2.822971560256055, -0.28394093733218506)): shape (37, 800, 800)
      Valid pixels: 75886/640000 (11.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=245871, num_faces=245952
      Valid probs shape: (37, 75886)
    ✓ Random_38 (pose=(-1.710110954754597, 3.0862726236681937, 0.6315150693937941)): shape (37, 800, 800)
      Valid pixels: 66589/640000 (10.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=245626, num_faces=245952
      Valid probs shape: (37, 66589)
    ✓ Random_39 (pose=(0.00656816166161045, 1.095329314829268, -0.1268413583436252)): shape (37, 800, 800)
      Valid pixels: 52042/640000 (8.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=244842, num_faces=245952
      Valid probs shape: (37, 52042)
    P stats: min=0.0000, max=1.0000, mean=0.0260
    Non-zero vertices: 118293/122978
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 4685 1544  749 2485    0 2228  961 4093 6168]
  Ground Truth Stats:
    Labels shape: (122978,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-10/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7938
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8356
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8357

  RESULTS:
  RAW:         median(top-10)=0.9279, mean(top-10)=0.9230, median(all)=0.8631, mean(all)=0.7938
  + SMOOTHING: median(top-10)=0.9412, mean(top-10)=0.9349, median(all)=0.8827, mean(all)=0.8356 [+0.0133]
  + MRF:       median(top-10)=0.9410, mean(top-10)=0.9350, median(all)=0.8839, mean(all)=0.8357 [-0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0131

================================================================================
Subject: NKI-TRT-20-11
================================================================================
  Step 0: Generating predictions with V2 model (40 random views)...
  Mesh: 146103 vertices, 292202 faces
  Generating 40 random views...
  Generating predictions for 40 views (continuous camera pose)...
    ✓ Random_0 (pose=(2.9372596887274804, 2.6515221403116938, -2.7801405880125807)): shape (37, 800, 800)
      Valid pixels: 83485/640000 (13.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=291064, num_faces=292202
      Valid probs shape: (37, 83485)
    ✓ Random_1 (pose=(-2.96731934729319, 2.7798885722951088, -1.419763984154017)): shape (37, 800, 800)
      Valid pixels: 76956/640000 (12.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=291848, num_faces=292202
      Valid probs shape: (37, 76956)
    ✓ Random_2 (pose=(0.4614493361585881, -0.8171050563541264, 0.1471007050587363)): shape (37, 800, 800)
      Valid pixels: 78321/640000 (12.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=292097, num_faces=292202
      Valid probs shape: (37, 78321)
    ✓ Random_3 (pose=(0.017833906250342757, -0.7991059061792556, -1.7106310740589812)): shape (37, 800, 800)
      Valid pixels: 95731/640000 (15.0%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=0, max=291877, num_faces=292202
      Valid probs shape: (37, 95731)
    ✓ Random_4 (pose=(2.8812405138400976, -0.6777859034246001, -0.41973161756022703)): shape (37, 800, 800)
      Valid pixels: 72410/640000 (11.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=403, max=292201, num_faces=292202
      Valid probs shape: (37, 72410)
    ✓ Random_5 (pose=(0.3203240481896632, -1.1390175163149356, -2.9623016990369355)): shape (37, 800, 800)
      Valid pixels: 98368/640000 (15.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=291201, num_faces=292202
      Valid probs shape: (37, 98368)
    ✓ Random_6 (pose=(2.291635893526937, -0.21729552818060593, -2.8256742939882447)): shape (37, 800, 800)
      Valid pixels: 84790/640000 (13.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=7033, max=292201, num_faces=292202
      Valid probs shape: (37, 84790)
    ✓ Random_7 (pose=(-0.3373882896025293, -2.6634155234834003, -1.8986370850094452)): shape (37, 800, 800)
      Valid pixels: 68238/640000 (10.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=41998, max=292198, num_faces=292202
      Valid probs shape: (37, 68238)
    ✓ Random_8 (pose=(2.2898124978556575, -2.670814467685248, 1.2389974907255557)): shape (37, 800, 800)
      Valid pixels: 73918/640000 (11.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=290659, num_faces=292202
      Valid probs shape: (37, 73918)
    ✓ Random_9 (pose=(0.740908140374664, -1.1859522991723022, -1.5928641924013707)): shape (37, 800, 800)
      Valid pixels: 81246/640000 (12.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=26, max=292138, num_faces=292202
      Valid probs shape: (37, 81246)
    ✓ Random_10 (pose=(0.08963599324086058, -0.04191130347474337, -1.1908859701013077)): shape (37, 800, 800)
      Valid pixels: 54039/640000 (8.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=289510, num_faces=292202
      Valid probs shape: (37, 54039)
    ✓ Random_11 (pose=(0.5111529663190302, 2.9270468905030205, 0.4355689817353938)): shape (37, 800, 800)
      Valid pixels: 65130/640000 (10.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2960, max=292200, num_faces=292202
      Valid probs shape: (37, 65130)
    ✓ Random_12 (pose=(-2.140161088883099, -1.6645939690774092, -3.053473255424304)): shape (37, 800, 800)
      Valid pixels: 113745/640000 (17.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=25, max=292199, num_faces=292202
      Valid probs shape: (37, 113745)
    ✓ Random_13 (pose=(-2.4417489107346313, 2.9088448209898763, 2.9616487594824887)): shape (37, 800, 800)
      Valid pixels: 77745/640000 (12.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=292004, num_faces=292202
      Valid probs shape: (37, 77745)
    ✓ Random_14 (pose=(2.898310245408628, -0.6828205334978779, -2.6435521473956585)): shape (37, 800, 800)
      Valid pixels: 75818/640000 (11.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=697, max=292201, num_faces=292202
      Valid probs shape: (37, 75818)
    ✓ Random_15 (pose=(2.3976396246452376, -0.1135052740835687, 0.27170251286767266)): shape (37, 800, 800)
      Valid pixels: 83869/640000 (13.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=161, max=292201, num_faces=292202
      Valid probs shape: (37, 83869)
    ✓ Random_16 (pose=(2.411600279778054, 1.771584245724962, -1.3410346311606858)): shape (37, 800, 800)
      Valid pixels: 78824/640000 (12.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=10, max=292138, num_faces=292202
      Valid probs shape: (37, 78824)
    ✓ Random_17 (pose=(1.8710580103056085, -2.102516802448103, -0.9881466567013693)): shape (37, 800, 800)
      Valid pixels: 105477/640000 (16.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=21, max=292131, num_faces=292202
      Valid probs shape: (37, 105477)
    ✓ Random_18 (pose=(0.15633062813279608, -2.0910450000177585, 0.12147851713677271)): shape (37, 800, 800)
      Valid pixels: 88280/640000 (13.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=441, max=292201, num_faces=292202
      Valid probs shape: (37, 88280)
    ✓ Random_19 (pose=(1.4947130214461453, -3.087866825918539, -0.4007690824211205)): shape (37, 800, 800)
      Valid pixels: 117021/640000 (18.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=55, max=292199, num_faces=292202
      Valid probs shape: (37, 117021)
    ✓ Random_20 (pose=(2.551500018210673, -2.176775866355292, -2.2062455637273413)): shape (37, 800, 800)
      Valid pixels: 67486/640000 (10.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=292138, num_faces=292202
      Valid probs shape: (37, 67486)
    ✓ Random_21 (pose=(1.8599155114925754, -2.078002284441932, 0.31271825049394053)): shape (37, 800, 800)
      Valid pixels: 94015/640000 (14.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=67, max=292121, num_faces=292202
      Valid probs shape: (37, 94015)
    ✓ Random_22 (pose=(2.4515502318018934, 1.0854866778342256, -0.27888918861929834)): shape (37, 800, 800)
      Valid pixels: 99159/640000 (15.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=63, max=292201, num_faces=292202
      Valid probs shape: (37, 99159)
    ✓ Random_23 (pose=(-2.5810363740498876, -2.2411569492515997, 1.6830913426766703)): shape (37, 800, 800)
      Valid pixels: 75674/640000 (11.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=291939, num_faces=292202
      Valid probs shape: (37, 75674)
    ✓ Random_24 (pose=(-2.772338239253677, 2.265051716371408, -1.2821403510020188)): shape (37, 800, 800)
      Valid pixels: 101104/640000 (15.8%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=3, max=291877, num_faces=292202
      Valid probs shape: (37, 101104)
    ✓ Random_25 (pose=(1.753315415049574, 0.11182258004941126, 0.02385159175686713)): shape (37, 800, 800)
      Valid pixels: 115108/640000 (18.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=68, max=292199, num_faces=292202
      Valid probs shape: (37, 115108)
    ✓ Random_26 (pose=(2.693818194689137, -2.3324280070125605, -3.014269279344212)): shape (37, 800, 800)
      Valid pixels: 65237/640000 (10.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=291880, num_faces=292202
      Valid probs shape: (37, 65237)
    ✓ Random_27 (pose=(-1.0053056634954793, -2.443432829254882, 1.5658444342520577)): shape (37, 800, 800)
      Valid pixels: 93491/640000 (14.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=62, max=292201, num_faces=292202
      Valid probs shape: (37, 93491)
    ✓ Random_28 (pose=(2.4720226803387417, 0.4269811685803764, 0.3057736598253542)): shape (37, 800, 800)
      Valid pixels: 99457/640000 (15.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=163, max=292200, num_faces=292202
      Valid probs shape: (37, 99457)
    ✓ Random_29 (pose=(-1.4393960414761677, -2.384951761718654, -2.4281639972405706)): shape (37, 800, 800)
      Valid pixels: 87603/640000 (13.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=3, max=292002, num_faces=292202
      Valid probs shape: (37, 87603)
    ✓ Random_30 (pose=(-1.0730468391465204, -1.307763992020822, -2.2714791819340716)): shape (37, 800, 800)
      Valid pixels: 75991/640000 (11.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=29, max=292004, num_faces=292202
      Valid probs shape: (37, 75991)
    ✓ Random_31 (pose=(-2.9624673708993976, 2.9900154479631587, 2.3310323552399606)): shape (37, 800, 800)
      Valid pixels: 55193/640000 (8.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=291983, num_faces=292202
      Valid probs shape: (37, 55193)
    ✓ Random_32 (pose=(-2.721903987182548, -0.8631353310652403, 2.9729362279770344)): shape (37, 800, 800)
      Valid pixels: 88564/640000 (13.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=679, max=292201, num_faces=292202
      Valid probs shape: (37, 88564)
    ✓ Random_33 (pose=(0.7964002773725141, -1.4634696178525033, -2.6753932324498244)): shape (37, 800, 800)
      Valid pixels: 111255/640000 (17.4%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=0, max=292198, num_faces=292202
      Valid probs shape: (37, 111255)
    ✓ Random_34 (pose=(2.075727856535045, 0.31684730363538716, 1.8458438409683815)): shape (37, 800, 800)
      Valid pixels: 66586/640000 (10.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=16927, max=292197, num_faces=292202
      Valid probs shape: (37, 66586)
    ✓ Random_35 (pose=(2.2516569382679013, -1.344370770746937, -0.4833438132955967)): shape (37, 800, 800)
      Valid pixels: 110714/640000 (17.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=66, max=292199, num_faces=292202
      Valid probs shape: (37, 110714)
    ✓ Random_36 (pose=(-0.16221023982144134, -1.092281242419468, 1.6252729784201199)): shape (37, 800, 800)
      Valid pixels: 98685/640000 (15.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=292004, num_faces=292202
      Valid probs shape: (37, 98685)
    ✓ Random_37 (pose=(1.1319630587686262, 1.5720330494481605, -1.747819489949607)): shape (37, 800, 800)
      Valid pixels: 84285/640000 (13.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=44, max=292138, num_faces=292202
      Valid probs shape: (37, 84285)
    ✓ Random_38 (pose=(2.7818669498667052, 2.6591167910201463, 0.4450882308248305)): shape (37, 800, 800)
      Valid pixels: 66838/640000 (10.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=292191, num_faces=292202
      Valid probs shape: (37, 66838)
    ✓ Random_39 (pose=(-2.8303896570510347, 2.5455841444746863, 2.614169507232176)): shape (37, 800, 800)
      Valid pixels: 74251/640000 (11.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=292004, num_faces=292202
      Valid probs shape: (37, 74251)
    P stats: min=0.0000, max=0.9998, mean=0.0257
    Non-zero vertices: 138903/146103
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 7200  478 1050 3905    0 2576 1098 4613 5477]
  Ground Truth Stats:
    Labels shape: (146103,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-11/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
    MRF iteration 5/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7457
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7951
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7957

  RESULTS:
  RAW:         median(top-10)=0.8922, mean(top-10)=0.9017, median(all)=0.7951, mean(all)=0.7457
  + SMOOTHING: median(top-10)=0.9203, mean(top-10)=0.9204, median(all)=0.8225, mean(all)=0.7951 [+0.0281]
  + MRF:       median(top-10)=0.9207, mean(top-10)=0.9207, median(all)=0.8233, mean(all)=0.7957 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0284

================================================================================
Subject: NKI-TRT-20-12
================================================================================
  Step 0: Generating predictions with V2 model (40 random views)...
  Mesh: 117868 vertices, 235732 faces
  Generating 40 random views...
  Generating predictions for 40 views (continuous camera pose)...
    ✓ Random_0 (pose=(-0.11313152764795253, -2.997434564729629, -2.420557255029803)): shape (37, 800, 800)
      Valid pixels: 53492/640000 (8.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=66482, max=235731, num_faces=235732
      Valid probs shape: (37, 53492)
    ✓ Random_1 (pose=(-2.5410421935227347, -0.3470910130758935, -1.3261651512812447)): shape (37, 800, 800)
      Valid pixels: 60822/640000 (9.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=2210, max=235730, num_faces=235732
      Valid probs shape: (37, 60822)
    ✓ Random_2 (pose=(-1.1990783889228374, 2.8116272070752553, -0.5108014537495085)): shape (37, 800, 800)
      Valid pixels: 103028/640000 (16.1%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=252, max=235729, num_faces=235732
      Valid probs shape: (37, 103028)
    ✓ Random_3 (pose=(1.7294583334301246, -0.9424452850771567, 1.0982073247060846)): shape (37, 800, 800)
      Valid pixels: 73136/640000 (11.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=11, max=235592, num_faces=235732
      Valid probs shape: (37, 73136)
    ✓ Random_4 (pose=(-2.5349801271670653, -2.0125331197435896, 2.8821988588570333)): shape (37, 800, 800)
      Valid pixels: 83791/640000 (13.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=235726, num_faces=235732
      Valid probs shape: (37, 83791)
    ✓ Random_5 (pose=(-2.819231143947269, 3.0271722524740685, 2.286952448926151)): shape (37, 800, 800)
      Valid pixels: 60698/640000 (9.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=235531, num_faces=235732
      Valid probs shape: (37, 60698)
    ✓ Random_6 (pose=(2.679591538881337, -0.5377820696090985, -2.7268538418025536)): shape (37, 800, 800)
      Valid pixels: 67528/640000 (10.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=479, max=235731, num_faces=235732
      Valid probs shape: (37, 67528)
    ✓ Random_7 (pose=(2.403875824502819, -1.494614214092435, -1.6930182700960024)): shape (37, 800, 800)
      Valid pixels: 106028/640000 (16.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=11, max=235729, num_faces=235732
      Valid probs shape: (37, 106028)
    ✓ Random_8 (pose=(1.1708503720063383, -1.6845666346493895, 2.3735403137937574)): shape (37, 800, 800)
      Valid pixels: 89363/640000 (14.0%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=56, max=235729, num_faces=235732
      Valid probs shape: (37, 89363)
    ✓ Random_9 (pose=(1.4308276886120144, -0.21152837542662395, 0.4533931747131086)): shape (37, 800, 800)
      Valid pixels: 94110/640000 (14.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=14, max=235583, num_faces=235732
      Valid probs shape: (37, 94110)
    ✓ Random_10 (pose=(1.7569216885836552, -1.1897844892638885, -0.5217986477427643)): shape (37, 800, 800)
      Valid pixels: 115131/640000 (18.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=235687, num_faces=235732
      Valid probs shape: (37, 115131)
    ✓ Random_11 (pose=(0.2895557131262767, 1.9547693545314306, 0.6591331742971986)): shape (37, 800, 800)
      Valid pixels: 83185/640000 (13.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=579, max=235729, num_faces=235732
      Valid probs shape: (37, 83185)
    ✓ Random_12 (pose=(1.0191064496384428, -3.0473757270247326, 3.000623726563692)): shape (37, 800, 800)
      Valid pixels: 98256/640000 (15.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=896, max=235731, num_faces=235732
      Valid probs shape: (37, 98256)
    ✓ Random_13 (pose=(-1.3429060468263458, -2.213385293715214, -2.0441247345265294)): shape (37, 800, 800)
      Valid pixels: 71807/640000 (11.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=8, max=235592, num_faces=235732
      Valid probs shape: (37, 71807)
    ✓ Random_14 (pose=(-2.2771631174596667, 2.8131626519768806, 1.2297104131878394)): shape (37, 800, 800)
      Valid pixels: 61761/640000 (9.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=235731, num_faces=235732
      Valid probs shape: (37, 61761)
    ✓ Random_15 (pose=(0.7020639364889725, -2.4707949074002484, 1.4742524779664787)): shape (37, 800, 800)
      Valid pixels: 75827/640000 (11.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=33, max=235730, num_faces=235732
      Valid probs shape: (37, 75827)
    ✓ Random_16 (pose=(0.20150699073154676, 1.446063023621602, -2.2729053025618904)): shape (37, 800, 800)
      Valid pixels: 103260/640000 (16.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=235729, num_faces=235732
      Valid probs shape: (37, 103260)
    ✓ Random_17 (pose=(-3.0616914038227474, -2.8971795693001736, -0.9221293315382972)): shape (37, 800, 800)
      Valid pixels: 55281/640000 (8.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=235451, num_faces=235732
      Valid probs shape: (37, 55281)
    ✓ Random_18 (pose=(-1.553795321151713, -2.9674914972970217, -1.8865354817230438)): shape (37, 800, 800)
      Valid pixels: 72152/640000 (11.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=58, max=235592, num_faces=235732
      Valid probs shape: (37, 72152)
    ✓ Random_19 (pose=(-1.1687563330830153, -1.693123011013596, 0.9367306921134109)): shape (37, 800, 800)
      Valid pixels: 74299/640000 (11.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=288, max=235731, num_faces=235732
      Valid probs shape: (37, 74299)
    ✓ Random_20 (pose=(1.5011552610906778, 1.6290680963510464, -1.3502742554010458)): shape (37, 800, 800)
      Valid pixels: 85883/640000 (13.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=235731, num_faces=235732
      Valid probs shape: (37, 85883)
    ✓ Random_21 (pose=(0.4215737352645541, -0.8428331033182235, -2.6022192122929875)): shape (37, 800, 800)
      Valid pixels: 93575/640000 (14.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=235591, num_faces=235732
      Valid probs shape: (37, 93575)
    ✓ Random_22 (pose=(-0.24536649201571636, 0.8220888998371829, -2.510898498724406)): shape (37, 800, 800)
      Valid pixels: 86800/640000 (13.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=235687, num_faces=235732
      Valid probs shape: (37, 86800)
    ✓ Random_23 (pose=(3.0051520602428896, 0.7644089278609387, 1.2560496481002383)): shape (37, 800, 800)
      Valid pixels: 86564/640000 (13.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=12, max=235730, num_faces=235732
      Valid probs shape: (37, 86564)
    ✓ Random_24 (pose=(-0.36422206060262363, 1.1420448510628107, 2.590458081047524)): shape (37, 800, 800)
      Valid pixels: 66875/640000 (10.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=235730, num_faces=235732
      Valid probs shape: (37, 66875)
    ✓ Random_25 (pose=(0.6795557228778066, 1.990957651572952, -0.4693613381794881)): shape (37, 800, 800)
      Valid pixels: 94150/640000 (14.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=4, max=235585, num_faces=235732
      Valid probs shape: (37, 94150)
    ✓ Random_26 (pose=(2.7344206167741225, 2.250059621933377, 2.3526260161217714)): shape (37, 800, 800)
      Valid pixels: 66512/640000 (10.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=235591, num_faces=235732
      Valid probs shape: (37, 66512)
    ✓ Random_27 (pose=(-0.2973467985895799, -0.43344680327961616, -0.7353828480421245)): shape (37, 800, 800)
      Valid pixels: 72280/640000 (11.3%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=0, max=235557, num_faces=235732
      Valid probs shape: (37, 72280)
    ✓ Random_28 (pose=(0.9944630709476314, -0.49475884214995247, -2.1737374426979494)): shape (37, 800, 800)
      Valid pixels: 78054/640000 (12.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=235728, num_faces=235732
      Valid probs shape: (37, 78054)
    ✓ Random_29 (pose=(1.1103893023852782, -2.263328935589841, -3.1411115642236145)): shape (37, 800, 800)
      Valid pixels: 105461/640000 (16.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=226, max=235731, num_faces=235732
      Valid probs shape: (37, 105461)
    ✓ Random_30 (pose=(-2.0594452038439286, -0.2720616647984748, 2.7877301405587565)): shape (37, 800, 800)
      Valid pixels: 105244/640000 (16.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=9, max=235731, num_faces=235732
      Valid probs shape: (37, 105244)
    ✓ Random_31 (pose=(-2.494562166186545, -0.31972902295915073, -2.256370048023344)): shape (37, 800, 800)
      Valid pixels: 74608/640000 (11.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=24, max=235727, num_faces=235732
      Valid probs shape: (37, 74608)
    ✓ Random_32 (pose=(-1.7306246930754028, -2.6734279647603216, -1.6463348470970154)): shape (37, 800, 800)
      Valid pixels: 68389/640000 (10.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=52, max=235591, num_faces=235732
      Valid probs shape: (37, 68389)
    ✓ Random_33 (pose=(-2.767247560775783, 2.0253227580515842, -1.6127250847239318)): shape (37, 800, 800)
      Valid pixels: 102272/640000 (16.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=2, max=235586, num_faces=235732
      Valid probs shape: (37, 102272)
    ✓ Random_34 (pose=(2.887878981322743, 0.8980297055999467, 1.5623645542352067)): shape (37, 800, 800)
      Valid pixels: 86148/640000 (13.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=11, max=235719, num_faces=235732
      Valid probs shape: (37, 86148)
    ✓ Random_35 (pose=(1.9656567412086794, -1.6066662385969313, 0.9835102339811082)): shape (37, 800, 800)
      Valid pixels: 69642/640000 (10.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=45, max=235592, num_faces=235732
      Valid probs shape: (37, 69642)
    ✓ Random_36 (pose=(-0.013328099062185128, 0.6396228518628795, 2.546163877349394)): shape (37, 800, 800)
      Valid pixels: 64335/640000 (10.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=235684, num_faces=235732
      Valid probs shape: (37, 64335)
    ✓ Random_37 (pose=(0.7160063955136047, -1.212648215695919, -2.018546877191487)): shape (37, 800, 800)
      Valid pixels: 90485/640000 (14.1%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=2, max=235684, num_faces=235732
      Valid probs shape: (37, 90485)
    ✓ Random_38 (pose=(-2.64021873765523, 2.753023019200934, -1.093669887662577)): shape (37, 800, 800)
      Valid pixels: 79487/640000 (12.4%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=1, max=235591, num_faces=235732
      Valid probs shape: (37, 79487)
    ✓ Random_39 (pose=(-1.0852064501731773, 0.9018888615159142, -1.780947814590918)): shape (37, 800, 800)
      Valid pixels: 76928/640000 (12.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=235591, num_faces=235732
      Valid probs shape: (37, 76928)
    P stats: min=0.0000, max=0.9997, mean=0.0260
    Non-zero vertices: 113345/117868
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 4523 1094  909 3077    0 2522  896 3488 6046]
  Ground Truth Stats:
    Labels shape: (117868,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-12/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7670
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8090
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8093

  RESULTS:
  RAW:         median(top-10)=0.8946, mean(top-10)=0.9074, median(all)=0.8384, mean(all)=0.7670
  + SMOOTHING: median(top-10)=0.9136, mean(top-10)=0.9204, median(all)=0.8516, mean(all)=0.8090 [+0.0190]
  + MRF:       median(top-10)=0.9142, mean(top-10)=0.9207, median(all)=0.8519, mean(all)=0.8093 [+0.0006]
  TOTAL IMPROVEMENT (median top-10): +0.0196

================================================================================
Subject: NKI-TRT-20-13
================================================================================
  Step 0: Generating predictions with V2 model (40 random views)...
  Mesh: 168760 vertices, 337516 faces
  Generating 40 random views...
  Generating predictions for 40 views (continuous camera pose)...
    ✓ Random_0 (pose=(-0.41752817382661656, 1.6078801410925214, 1.4048873293867281)): shape (37, 800, 800)
      Valid pixels: 91843/640000 (14.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=2, max=337509, num_faces=337516
      Valid probs shape: (37, 91843)
    ✓ Random_1 (pose=(0.022034763432115412, -1.2407060103938063, -0.6240988574403099)): shape (37, 800, 800)
      Valid pixels: 71622/640000 (11.2%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=19, max=337512, num_faces=337516
      Valid probs shape: (37, 71622)
    ✓ Random_2 (pose=(1.2360268440202447, -0.9872413642626023, -0.9560590542581187)): shape (37, 800, 800)
      Valid pixels: 74489/640000 (11.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=337513, num_faces=337516
      Valid probs shape: (37, 74489)
    ✓ Random_3 (pose=(-1.8593912921605196, -1.332050199606778, -0.7657653034020555)): shape (37, 800, 800)
      Valid pixels: 85929/640000 (13.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=25, max=337436, num_faces=337516
      Valid probs shape: (37, 85929)
    ✓ Random_4 (pose=(0.8314598202634773, -1.1023648017545389, 1.3900254276071227)): shape (37, 800, 800)
      Valid pixels: 80705/640000 (12.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=337515, num_faces=337516
      Valid probs shape: (37, 80705)
    ✓ Random_5 (pose=(1.1556795149522578, 1.802726506992224, 0.26905175123639413)): shape (37, 800, 800)
      Valid pixels: 84637/640000 (13.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=337515, num_faces=337516
      Valid probs shape: (37, 84637)
    ✓ Random_6 (pose=(1.9366901314341973, -0.04179977474598928, 0.02138186791908714)): shape (37, 800, 800)
      Valid pixels: 101774/640000 (15.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=196, max=337515, num_faces=337516
      Valid probs shape: (37, 101774)
    ✓ Random_7 (pose=(-2.6508515130193393, 0.26328489064508886, -1.2220446357610533)): shape (37, 800, 800)
      Valid pixels: 66889/640000 (10.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=45957, max=337515, num_faces=337516
      Valid probs shape: (37, 66889)
    ✓ Random_8 (pose=(1.203402568675985, -0.39470041080652996, 0.6345821657869104)): shape (37, 800, 800)
      Valid pixels: 87291/640000 (13.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=337513, num_faces=337516
      Valid probs shape: (37, 87291)
    ✓ Random_9 (pose=(2.3919423147010583, -2.3928455598630514, 1.1728104686477234)): shape (37, 800, 800)
      Valid pixels: 67832/640000 (10.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=337436, num_faces=337516
      Valid probs shape: (37, 67832)
    ✓ Random_10 (pose=(2.512126179466695, 0.946988300576888, -2.2346573417953577)): shape (37, 800, 800)
      Valid pixels: 91805/640000 (14.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2922, max=337510, num_faces=337516
      Valid probs shape: (37, 91805)
    ✓ Random_11 (pose=(0.1077258328650017, -0.9978151360380845, 2.971518560622097)): shape (37, 800, 800)
      Valid pixels: 59197/640000 (9.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=337515, num_faces=337516
      Valid probs shape: (37, 59197)
    ✓ Random_12 (pose=(1.4409632736159352, 0.5037755110191644, 2.9659273186049795)): shape (37, 800, 800)
      Valid pixels: 99021/640000 (15.5%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=9, max=337510, num_faces=337516
      Valid probs shape: (37, 99021)
    ✓ Random_13 (pose=(-1.4695890231847708, -1.6131826065066872, -0.0330557849866171)): shape (37, 800, 800)
      Valid pixels: 96544/640000 (15.1%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=2, max=337509, num_faces=337516
      Valid probs shape: (37, 96544)
    ✓ Random_14 (pose=(-1.994130839748657, -0.06302993428894954, 0.38991492503031777)): shape (37, 800, 800)
      Valid pixels: 87000/640000 (13.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1523, max=337510, num_faces=337516
      Valid probs shape: (37, 87000)
    ✓ Random_15 (pose=(-1.9520630272695474, -2.744942131472764, -2.1399362866885574)): shape (37, 800, 800)
      Valid pixels: 75846/640000 (11.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=337515, num_faces=337516
      Valid probs shape: (37, 75846)
    ✓ Random_16 (pose=(-1.1900747665952691, 0.2206230028558971, -2.435252426984708)): shape (37, 800, 800)
      Valid pixels: 82031/640000 (12.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=337515, num_faces=337516
      Valid probs shape: (37, 82031)
    ✓ Random_17 (pose=(0.40409473390068884, -1.2064282365779666, -3.0271692667677152)): shape (37, 800, 800)
      Valid pixels: 85018/640000 (13.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=337436, num_faces=337516
      Valid probs shape: (37, 85018)
    ✓ Random_18 (pose=(-2.4878584000416324, 0.3942654183959733, 1.4435249453447865)): shape (37, 800, 800)
      Valid pixels: 65797/640000 (10.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2436, max=337513, num_faces=337516
      Valid probs shape: (37, 65797)
    ✓ Random_19 (pose=(-0.22855573580509203, -0.2258407379284857, -1.0879614734867227)): shape (37, 800, 800)
      Valid pixels: 59935/640000 (9.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=336876, num_faces=337516
      Valid probs shape: (37, 59935)
    ✓ Random_20 (pose=(0.5614426271344457, 1.8653862264945946, -1.2103729714725522)): shape (37, 800, 800)
      Valid pixels: 106257/640000 (16.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=179, max=337515, num_faces=337516
      Valid probs shape: (37, 106257)
    ✓ Random_21 (pose=(2.0081365911631055, -0.7135366683978228, -2.7111070346230113)): shape (37, 800, 800)
      Valid pixels: 79706/640000 (12.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=266, max=337512, num_faces=337516
      Valid probs shape: (37, 79706)
    ✓ Random_22 (pose=(-1.1153664927660802, 2.3453597497025935, -1.8814595841613206)): shape (37, 800, 800)
      Valid pixels: 75057/640000 (11.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=121, max=337515, num_faces=337516
      Valid probs shape: (37, 75057)
    ✓ Random_23 (pose=(-1.5968521727457445, 2.7944232378484175, -3.030421193024308)): shape (37, 800, 800)
      Valid pixels: 103867/640000 (16.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=18, max=337515, num_faces=337516
      Valid probs shape: (37, 103867)
    ✓ Random_24 (pose=(1.5872406957310048, 1.9302196776039349, 1.8422372507380311)): shape (37, 800, 800)
      Valid pixels: 72613/640000 (11.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=19, max=337435, num_faces=337516
      Valid probs shape: (37, 72613)
    ✓ Random_25 (pose=(-0.9336775228741065, 2.6166847739168757, 2.766120918245278)): shape (37, 800, 800)
      Valid pixels: 92837/640000 (14.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=293, max=337512, num_faces=337516
      Valid probs shape: (37, 92837)
    ✓ Random_26 (pose=(1.18046233946077, -2.8409895946268104, -0.24200806057687707)): shape (37, 800, 800)
      Valid pixels: 103310/640000 (16.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=179, max=337511, num_faces=337516
      Valid probs shape: (37, 103310)
    ✓ Random_27 (pose=(0.16243052678343606, -1.8037837994266732, -1.759000021819859)): shape (37, 800, 800)
      Valid pixels: 97542/640000 (15.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=75, max=337510, num_faces=337516
      Valid probs shape: (37, 97542)
    ✓ Random_28 (pose=(1.7032408859692998, 1.3793104187279894, 2.7662888484538968)): shape (37, 800, 800)
      Valid pixels: 101089/640000 (15.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=21, max=337437, num_faces=337516
      Valid probs shape: (37, 101089)
    ✓ Random_29 (pose=(-0.01591311218664382, 1.781308981143873, -2.953595931728624)): shape (37, 800, 800)
      Valid pixels: 71762/640000 (11.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=275, max=337514, num_faces=337516
      Valid probs shape: (37, 71762)
    ✓ Random_30 (pose=(-2.4503431125258137, -0.6271645201770171, -1.062088796511719)): shape (37, 800, 800)
      Valid pixels: 57613/640000 (9.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=473, max=337515, num_faces=337516
      Valid probs shape: (37, 57613)
    ✓ Random_31 (pose=(-0.030552932031267854, 2.8420788412995392, -0.2725691346933963)): shape (37, 800, 800)
      Valid pixels: 44636/640000 (7.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1695, max=337515, num_faces=337516
      Valid probs shape: (37, 44636)
    ✓ Random_32 (pose=(-2.1801793217994176, -1.7064624769058414, -0.3045638619455229)): shape (37, 800, 800)
      Valid pixels: 91839/640000 (14.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=28, max=337426, num_faces=337516
      Valid probs shape: (37, 91839)
    ✓ Random_33 (pose=(0.26673628016447903, -1.9290405500069534, 2.0869678851506146)): shape (37, 800, 800)
      Valid pixels: 78207/640000 (12.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=74, max=337515, num_faces=337516
      Valid probs shape: (37, 78207)
    ✓ Random_34 (pose=(-2.238298893761935, -2.735692413568483, 1.9738730071377626)): shape (37, 800, 800)
      Valid pixels: 56926/640000 (8.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=337514, num_faces=337516
      Valid probs shape: (37, 56926)
    ✓ Random_35 (pose=(-2.380537036324262, 2.3911409070983307, 1.7916238970872307)): shape (37, 800, 800)
      Valid pixels: 82077/640000 (12.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=337514, num_faces=337516
      Valid probs shape: (37, 82077)
    ✓ Random_36 (pose=(2.350886588396916, -1.2302336559078184, -0.6876791959977515)): shape (37, 800, 800)
      Valid pixels: 104048/640000 (16.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=84, max=337515, num_faces=337516
      Valid probs shape: (37, 104048)
    ✓ Random_37 (pose=(-1.8503203817498826, 2.639165682297027, -1.158732262112979)): shape (37, 800, 800)
      Valid pixels: 86443/640000 (13.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=337436, num_faces=337516
      Valid probs shape: (37, 86443)
    ✓ Random_38 (pose=(-0.9033938118038498, 2.0970546290472774, -0.9948435299209826)): shape (37, 800, 800)
      Valid pixels: 60440/640000 (9.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=472, max=337513, num_faces=337516
      Valid probs shape: (37, 60440)
    ✓ Random_39 (pose=(-2.9716234526724277, 2.1329576539983552, 2.543154906485097)): shape (37, 800, 800)
      Valid pixels: 73603/640000 (11.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=337513, num_faces=337516
      Valid probs shape: (37, 73603)
    P stats: min=0.0000, max=1.0000, mean=0.0257
    Non-zero vertices: 160573/168760
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 8187 1641 1758 3980    0 3133 1208 5378 8157]
  Ground Truth Stats:
    Labels shape: (168760,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-13/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7822
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8306
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8308

  RESULTS:
  RAW:         median(top-10)=0.9156, mean(top-10)=0.9158, median(all)=0.8336, mean(all)=0.7822
  + SMOOTHING: median(top-10)=0.9340, mean(top-10)=0.9310, median(all)=0.8539, mean(all)=0.8306 [+0.0184]
  + MRF:       median(top-10)=0.9340, mean(top-10)=0.9311, median(all)=0.8549, mean(all)=0.8308 [+0.0000]
  TOTAL IMPROVEMENT (median top-10): +0.0184

================================================================================
Subject: NKI-TRT-20-14
================================================================================
  Step 0: Generating predictions with V2 model (40 random views)...
  Mesh: 142909 vertices, 285814 faces
  Generating 40 random views...
  Generating predictions for 40 views (continuous camera pose)...
    ✓ Random_0 (pose=(-0.8349627644012121, 2.21692319469778, -1.601589608498699)): shape (37, 800, 800)
      Valid pixels: 66345/640000 (10.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=12, max=285813, num_faces=285814
      Valid probs shape: (37, 66345)
    ✓ Random_1 (pose=(2.4082012298788786, 0.9568685554737009, 1.2021525690843218)): shape (37, 800, 800)
      Valid pixels: 72018/640000 (11.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=183, max=285813, num_faces=285814
      Valid probs shape: (37, 72018)
    ✓ Random_2 (pose=(-1.3630389852975884, 0.553582682901522, -0.9409733608670412)): shape (37, 800, 800)
      Valid pixels: 76026/640000 (11.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=285420, num_faces=285814
      Valid probs shape: (37, 76026)
    ✓ Random_3 (pose=(0.7851936157347654, 2.817940455292561, -0.681564729255546)): shape (37, 800, 800)
      Valid pixels: 71270/640000 (11.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=260, max=285813, num_faces=285814
      Valid probs shape: (37, 71270)
    ✓ Random_4 (pose=(2.526989393442321, -2.246753184066748, -2.386007889320711)): shape (37, 800, 800)
      Valid pixels: 56509/640000 (8.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=285813, num_faces=285814
      Valid probs shape: (37, 56509)
    ✓ Random_5 (pose=(-2.6193339698527156, -2.279012784824073, 3.1125669577957256)): shape (37, 800, 800)
      Valid pixels: 69439/640000 (10.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=285812, num_faces=285814
      Valid probs shape: (37, 69439)
    ✓ Random_6 (pose=(0.875264496306472, -1.2061472042153751, 0.3149317804478109)): shape (37, 800, 800)
      Valid pixels: 89349/640000 (14.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=285812, num_faces=285814
      Valid probs shape: (37, 89349)
    ✓ Random_7 (pose=(-2.3966939680903616, -2.884455882423492, 1.791397600251753)): shape (37, 800, 800)
      Valid pixels: 51776/640000 (8.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=285746, num_faces=285814
      Valid probs shape: (37, 51776)
    ✓ Random_8 (pose=(2.258820706697467, 0.37202750208867474, 0.9506791729669617)): shape (37, 800, 800)
      Valid pixels: 64831/640000 (10.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=14, max=285809, num_faces=285814
      Valid probs shape: (37, 64831)
    ✓ Random_9 (pose=(1.9258659444926973, 2.192354513441269, -1.752067727777135)): shape (37, 800, 800)
      Valid pixels: 65610/640000 (10.3%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=11, max=285813, num_faces=285814
      Valid probs shape: (37, 65610)
    ✓ Random_10 (pose=(0.797963323892088, 0.7049454948062444, -2.8549559522899237)): shape (37, 800, 800)
      Valid pixels: 62019/640000 (9.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=285810, num_faces=285814
      Valid probs shape: (37, 62019)
    ✓ Random_11 (pose=(0.5195159753603877, -1.297006767066627, 0.275854644039355)): shape (37, 800, 800)
      Valid pixels: 84748/640000 (13.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6, max=285812, num_faces=285814
      Valid probs shape: (37, 84748)
    ✓ Random_12 (pose=(-2.0416461080069803, 0.035633025828146536, 0.04466773742974528)): shape (37, 800, 800)
      Valid pixels: 78252/640000 (12.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=28, max=285812, num_faces=285814
      Valid probs shape: (37, 78252)
    ✓ Random_13 (pose=(0.8627294343942253, 0.6385838104107076, 2.8990590119951873)): shape (37, 800, 800)
      Valid pixels: 68517/640000 (10.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=15, max=285794, num_faces=285814
      Valid probs shape: (37, 68517)
    ✓ Random_14 (pose=(1.7380841512792982, -0.006199278833194821, -0.883870318753281)): shape (37, 800, 800)
      Valid pixels: 83233/640000 (13.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=12, max=285813, num_faces=285814
      Valid probs shape: (37, 83233)
    ✓ Random_15 (pose=(-3.023757292772071, 0.34504297305828624, -0.37187392868420366)): shape (37, 800, 800)
      Valid pixels: 45876/640000 (7.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=34242, max=285812, num_faces=285814
      Valid probs shape: (37, 45876)
    ✓ Random_16 (pose=(0.6463867966449919, 2.471806114717193, -2.6898703811618065)): shape (37, 800, 800)
      Valid pixels: 55512/640000 (8.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1345, max=285812, num_faces=285814
      Valid probs shape: (37, 55512)
    ✓ Random_17 (pose=(-0.2558014346071813, -0.8512416967780494, -0.8969412345720924)): shape (37, 800, 800)
      Valid pixels: 63976/640000 (10.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7, max=285813, num_faces=285814
      Valid probs shape: (37, 63976)
    ✓ Random_18 (pose=(-1.8799573473862263, -2.5481576226691076, 1.887789379156855)): shape (37, 800, 800)
      Valid pixels: 60718/640000 (9.5%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=9, max=285813, num_faces=285814
      Valid probs shape: (37, 60718)
    ✓ Random_19 (pose=(1.2061331557326662, -0.427681501191163, 0.3168148736982048)): shape (37, 800, 800)
      Valid pixels: 81475/640000 (12.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=285808, num_faces=285814
      Valid probs shape: (37, 81475)
    ✓ Random_20 (pose=(-2.2667973232987184, -2.2726790693808523, -2.84309022154203)): shape (37, 800, 800)
      Valid pixels: 83884/640000 (13.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=285812, num_faces=285814
      Valid probs shape: (37, 83884)
    ✓ Random_21 (pose=(-2.489776385491981, -0.9087763235912143, -0.31459650383023474)): shape (37, 800, 800)
      Valid pixels: 69368/640000 (10.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=518, max=285813, num_faces=285814
      Valid probs shape: (37, 69368)
    ✓ Random_22 (pose=(-2.302865649956725, 2.7371001365436225, 2.4915552222442416)): shape (37, 800, 800)
      Valid pixels: 74802/640000 (11.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=285812, num_faces=285814
      Valid probs shape: (37, 74802)
    ✓ Random_23 (pose=(0.9906171052468542, 0.4906704750789963, -1.729127399496544)): shape (37, 800, 800)
      Valid pixels: 57507/640000 (9.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6, max=285813, num_faces=285814
      Valid probs shape: (37, 57507)
    ✓ Random_24 (pose=(-0.99313781021594, -2.6779339021802238, 1.0957946680022372)): shape (37, 800, 800)
      Valid pixels: 57276/640000 (8.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1366, max=285812, num_faces=285814
      Valid probs shape: (37, 57276)
    ✓ Random_25 (pose=(-1.5714104748149185, -0.04778891957736109, -1.433430298035229)): shape (37, 800, 800)
      Valid pixels: 60265/640000 (9.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6, max=284744, num_faces=285814
      Valid probs shape: (37, 60265)
    ✓ Random_26 (pose=(1.4136699272590016, 1.2370950774857308, -2.057131617151613)): shape (37, 800, 800)
      Valid pixels: 64582/640000 (10.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=32, max=285812, num_faces=285814
      Valid probs shape: (37, 64582)
    ✓ Random_27 (pose=(0.6227069617689698, 2.2728319195528845, 2.9521949372741956)): shape (37, 800, 800)
      Valid pixels: 66256/640000 (10.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1000, max=285812, num_faces=285814
      Valid probs shape: (37, 66256)
    ✓ Random_28 (pose=(0.30158143179454333, 2.41940184027695, 3.108473615921759)): shape (37, 800, 800)
      Valid pixels: 52940/640000 (8.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1397, max=285812, num_faces=285814
      Valid probs shape: (37, 52940)
    ✓ Random_29 (pose=(-2.669274845768072, 2.187645255293573, 2.724234874158986)): shape (37, 800, 800)
      Valid pixels: 66041/640000 (10.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=285808, num_faces=285814
      Valid probs shape: (37, 66041)
    ✓ Random_30 (pose=(2.856883951655038, -2.4982275183652467, -1.8429870849632708)): shape (37, 800, 800)
      Valid pixels: 62616/640000 (9.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=285812, num_faces=285814
      Valid probs shape: (37, 62616)
    ✓ Random_31 (pose=(-1.3119238087935094, 0.930811828743189, -0.7528291285409376)): shape (37, 800, 800)
      Valid pixels: 79561/640000 (12.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=8, max=285421, num_faces=285814
      Valid probs shape: (37, 79561)
    ✓ Random_32 (pose=(-0.08869306880548145, -0.2118818333112733, -1.4458306728074586)): shape (37, 800, 800)
      Valid pixels: 44108/640000 (6.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=285293, num_faces=285814
      Valid probs shape: (37, 44108)
    ✓ Random_33 (pose=(1.8234101652697046, -2.921091351200887, -1.496180853813179)): shape (37, 800, 800)
      Valid pixels: 60743/640000 (9.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=9, max=285813, num_faces=285814
      Valid probs shape: (37, 60743)
    ✓ Random_34 (pose=(-1.8604991614919435, 0.6939663820061659, -1.8129496391485231)): shape (37, 800, 800)
      Valid pixels: 58603/640000 (9.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=285751, num_faces=285814
      Valid probs shape: (37, 58603)
    ✓ Random_35 (pose=(-0.8760465882839643, 0.8673689429925995, -1.7467079164653443)): shape (37, 800, 800)
      Valid pixels: 63649/640000 (9.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=285813, num_faces=285814
      Valid probs shape: (37, 63649)
    ✓ Random_36 (pose=(3.0922143028702527, 1.6438167559728436, 0.48450484799374305)): shape (37, 800, 800)
      Valid pixels: 78960/640000 (12.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=9, max=285813, num_faces=285814
      Valid probs shape: (37, 78960)
    ✓ Random_37 (pose=(3.061163851310635, -2.0400525906264892, -1.0528083391913126)): shape (37, 800, 800)
      Valid pixels: 72000/640000 (11.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=285813, num_faces=285814
      Valid probs shape: (37, 72000)
    ✓ Random_38 (pose=(-1.3384704319251357, 1.4728725644512828, 1.6045354055505552)): shape (37, 800, 800)
      Valid pixels: 62828/640000 (9.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=11, max=285810, num_faces=285814
      Valid probs shape: (37, 62828)
    ✓ Random_39 (pose=(0.5422470514468629, -0.6487411503965941, -1.8699157101109318)): shape (37, 800, 800)
      Valid pixels: 60631/640000 (9.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=15, max=285422, num_faces=285814
      Valid probs shape: (37, 60631)
    P stats: min=0.0000, max=1.0000, mean=0.0253
    Non-zero vertices: 133651/142909
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 9258 1259 1173 2720    0 2434 1067 5055 6381]
  Ground Truth Stats:
    Labels shape: (142909,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-14/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7696
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8195
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8196

  RESULTS:
  RAW:         median(top-10)=0.9058, mean(top-10)=0.9083, median(all)=0.8282, mean(all)=0.7696
  + SMOOTHING: median(top-10)=0.9256, mean(top-10)=0.9270, median(all)=0.8709, mean(all)=0.8195 [+0.0198]
  + MRF:       median(top-10)=0.9259, mean(top-10)=0.9272, median(all)=0.8703, mean(all)=0.8196 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0201

================================================================================
Subject: NKI-TRT-20-15
================================================================================
  Step 0: Generating predictions with V2 model (40 random views)...
  Mesh: 133351 vertices, 266698 faces
  Generating 40 random views...
  Generating predictions for 40 views (continuous camera pose)...
    ✓ Random_0 (pose=(-3.1083396293009415, -1.4811424062163772, 2.8916925055373044)): shape (37, 800, 800)
      Valid pixels: 75590/640000 (11.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=41, max=266663, num_faces=266698
      Valid probs shape: (37, 75590)
    ✓ Random_1 (pose=(-1.2781521800276119, -1.9157144012302723, 2.498358462700641)): shape (37, 800, 800)
      Valid pixels: 119045/640000 (18.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=156, max=266663, num_faces=266698
      Valid probs shape: (37, 119045)
    ✓ Random_2 (pose=(2.9492386058522015, 0.680917291847241, -0.22966176829563079)): shape (37, 800, 800)
      Valid pixels: 69547/640000 (10.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5992, max=266693, num_faces=266698
      Valid probs shape: (37, 69547)
    ✓ Random_3 (pose=(1.1601796402645252, -1.3807059050357193, 0.5573136386913093)): shape (37, 800, 800)
      Valid pixels: 113176/640000 (17.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=189, max=266681, num_faces=266698
      Valid probs shape: (37, 113176)
    ✓ Random_4 (pose=(-2.192328445813862, 0.7530193193408743, 2.4371107401418692)): shape (37, 800, 800)
      Valid pixels: 113620/640000 (17.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=190, max=266693, num_faces=266698
      Valid probs shape: (37, 113620)
    ✓ Random_5 (pose=(2.299996011137095, 0.4507148145292823, 1.6207447214992863)): shape (37, 800, 800)
      Valid pixels: 66032/640000 (10.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=204, max=266697, num_faces=266698
      Valid probs shape: (37, 66032)
    ✓ Random_6 (pose=(-1.6577293511298974, -2.657093690625371, -1.1142616203635467)): shape (37, 800, 800)
      Valid pixels: 90196/640000 (14.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=19, max=266694, num_faces=266698
      Valid probs shape: (37, 90196)
    ✓ Random_7 (pose=(2.9365074783078136, -1.9143679698941471, -1.0379666869221316)): shape (37, 800, 800)
      Valid pixels: 101931/640000 (15.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=266657, num_faces=266698
      Valid probs shape: (37, 101931)
    ✓ Random_8 (pose=(1.7059371104375174, -0.21492659796167368, 0.3361182418073301)): shape (37, 800, 800)
      Valid pixels: 105856/640000 (16.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=189, max=266697, num_faces=266698
      Valid probs shape: (37, 105856)
    ✓ Random_9 (pose=(0.24992317550844811, -1.8580398086937686, 0.6199347006627987)): shape (37, 800, 800)
      Valid pixels: 113152/640000 (17.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=193, max=266689, num_faces=266698
      Valid probs shape: (37, 113152)
    ✓ Random_10 (pose=(-2.781786534626657, -0.5957011981957514, -0.7143456141938347)): shape (37, 800, 800)
      Valid pixels: 54188/640000 (8.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2459, max=266697, num_faces=266698
      Valid probs shape: (37, 54188)
    ✓ Random_11 (pose=(-0.602629880988085, 2.4960939984826744, 1.378818341373048)): shape (37, 800, 800)
      Valid pixels: 83406/640000 (13.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=8550, max=266695, num_faces=266698
      Valid probs shape: (37, 83406)
    ✓ Random_12 (pose=(0.17777607200855616, 1.018224621346012, 1.3080760605828203)): shape (37, 800, 800)
      Valid pixels: 104100/640000 (16.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=265388, num_faces=266698
      Valid probs shape: (37, 104100)
    ✓ Random_13 (pose=(-2.86773040924444, 2.5458522045490977, 0.13059414601414643)): shape (37, 800, 800)
      Valid pixels: 57828/640000 (9.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=266659, num_faces=266698
      Valid probs shape: (37, 57828)
    ✓ Random_14 (pose=(-2.5699226488258367, 0.0065960984469688455, -0.8324552445037048)): shape (37, 800, 800)
      Valid pixels: 73945/640000 (11.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=23046, max=266697, num_faces=266698
      Valid probs shape: (37, 73945)
    ✓ Random_15 (pose=(-2.1016213023875956, -2.3916419325638283, 2.047416075523202)): shape (37, 800, 800)
      Valid pixels: 64333/640000 (10.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=266663, num_faces=266698
      Valid probs shape: (37, 64333)
    ✓ Random_16 (pose=(-2.159419528899389, 1.3866237181064962, -1.4130750291798533)): shape (37, 800, 800)
      Valid pixels: 105071/640000 (16.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=26, max=266694, num_faces=266698
      Valid probs shape: (37, 105071)
    ✓ Random_17 (pose=(2.976562479557777, -2.0161118498770323, -0.18064923544116063)): shape (37, 800, 800)
      Valid pixels: 74188/640000 (11.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=265950, num_faces=266698
      Valid probs shape: (37, 74188)
    ✓ Random_18 (pose=(1.8665049326737524, -1.8964357205218139, 0.35837510915136983)): shape (37, 800, 800)
      Valid pixels: 94730/640000 (14.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=18, max=266685, num_faces=266698
      Valid probs shape: (37, 94730)
    ✓ Random_19 (pose=(-1.9818943542573602, 1.7719628932846447, 1.1895439518340618)): shape (37, 800, 800)
      Valid pixels: 70531/640000 (11.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=266663, num_faces=266698
      Valid probs shape: (37, 70531)
    ✓ Random_20 (pose=(1.8212733455458352, 2.967421394741704, -3.0700891160614656)): shape (37, 800, 800)
      Valid pixels: 105379/640000 (16.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=21, max=266694, num_faces=266698
      Valid probs shape: (37, 105379)
    ✓ Random_21 (pose=(-2.968455030143271, 2.791134610471386, 1.962480005797234)): shape (37, 800, 800)
      Valid pixels: 63588/640000 (9.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=266660, num_faces=266698
      Valid probs shape: (37, 63588)
    ✓ Random_22 (pose=(-1.9830305218342341, -0.8224222576513149, -1.588596862503058)): shape (37, 800, 800)
      Valid pixels: 73182/640000 (11.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=191, max=266697, num_faces=266698
      Valid probs shape: (37, 73182)
    ✓ Random_23 (pose=(2.743276487898137, 1.881996465360034, 1.0983246659549053)): shape (37, 800, 800)
      Valid pixels: 111715/640000 (17.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=11, max=266663, num_faces=266698
      Valid probs shape: (37, 111715)
    ✓ Random_24 (pose=(0.8280426835308838, -2.0149754019135377, 2.8557692875798883)): shape (37, 800, 800)
      Valid pixels: 95870/640000 (15.0%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=186, max=266697, num_faces=266698
      Valid probs shape: (37, 95870)
    ✓ Random_25 (pose=(-1.5780914816545173, -2.0197471560271927, 0.6945618869645291)): shape (37, 800, 800)
      Valid pixels: 88724/640000 (13.9%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=4, max=266693, num_faces=266698
      Valid probs shape: (37, 88724)
    ✓ Random_26 (pose=(2.6543267337909677, -2.993488377421404, 0.4531211122296739)): shape (37, 800, 800)
      Valid pixels: 67672/640000 (10.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=265964, num_faces=266698
      Valid probs shape: (37, 67672)
    ✓ Random_27 (pose=(2.404310249513281, 0.07665062172318304, -0.24571363050080786)): shape (37, 800, 800)
      Valid pixels: 94340/640000 (14.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=407, max=266694, num_faces=266698
      Valid probs shape: (37, 94340)
    ✓ Random_28 (pose=(-1.7259356725470656, 1.8257744957294353, -0.6585133071134539)): shape (37, 800, 800)
      Valid pixels: 112018/640000 (17.5%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=19, max=266693, num_faces=266698
      Valid probs shape: (37, 112018)
    ✓ Random_29 (pose=(2.366337803438636, 0.8055758401730326, -2.1540690699643372)): shape (37, 800, 800)
      Valid pixels: 93972/640000 (14.7%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=1806, max=266695, num_faces=266698
      Valid probs shape: (37, 93972)
    ✓ Random_30 (pose=(1.1242169287355175, 0.6689805450232948, -2.6614031821729114)): shape (37, 800, 800)
      Valid pixels: 81864/640000 (12.8%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=2, max=266545, num_faces=266698
      Valid probs shape: (37, 81864)
    ✓ Random_31 (pose=(2.108879493139751, 1.3280088845213465, -1.9921066580061708)): shape (37, 800, 800)
      Valid pixels: 90500/640000 (14.1%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=11, max=266693, num_faces=266698
      Valid probs shape: (37, 90500)
    ✓ Random_32 (pose=(-1.2657903038795653, -2.066286394311686, 2.646254933393716)): shape (37, 800, 800)
      Valid pixels: 119883/640000 (18.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=157, max=266663, num_faces=266698
      Valid probs shape: (37, 119883)
    ✓ Random_33 (pose=(-0.8146515015357338, -1.5094926998009845, -1.8871474165938793)): shape (37, 800, 800)
      Valid pixels: 91214/640000 (14.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=266690, num_faces=266698
      Valid probs shape: (37, 91214)
    ✓ Random_34 (pose=(-1.1983363331488086, -2.583024980812428, 1.574854220508973)): shape (37, 800, 800)
      Valid pixels: 80253/640000 (12.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=467, max=266682, num_faces=266698
      Valid probs shape: (37, 80253)
    ✓ Random_35 (pose=(0.5822787721835794, 0.8085769496046606, -0.02852759311788855)): shape (37, 800, 800)
      Valid pixels: 79753/640000 (12.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=266662, num_faces=266698
      Valid probs shape: (37, 79753)
    ✓ Random_36 (pose=(2.148131910640645, 3.060834735006895, -2.566481694618512)): shape (37, 800, 800)
      Valid pixels: 84110/640000 (13.1%)
      Probs stats: min=0.0000, max=0.9994, mean=0.0270
      Face IDs: min=1, max=265962, num_faces=266698
      Valid probs shape: (37, 84110)
    ✓ Random_37 (pose=(-2.848699513683962, 1.7078831231262006, 3.069876157722745)): shape (37, 800, 800)
      Valid pixels: 76051/640000 (11.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=19, max=266359, num_faces=266698
      Valid probs shape: (37, 76051)
    ✓ Random_38 (pose=(2.074053412961793, 0.47254244421241287, 1.805614610281725)): shape (37, 800, 800)
      Valid pixels: 63164/640000 (9.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5193, max=266697, num_faces=266698
      Valid probs shape: (37, 63164)
    ✓ Random_39 (pose=(-1.1596820125332608, -2.5935942920109682, -2.6051793732462665)): shape (37, 800, 800)
      Valid pixels: 87568/640000 (13.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=190, max=266697, num_faces=266698
      Valid probs shape: (37, 87568)
    P stats: min=0.0000, max=0.9999, mean=0.0262
    Non-zero vertices: 129092/133351
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 4259 1165  989 3270    0 1885  778 5058 6266]
  Ground Truth Stats:
    Labels shape: (133351,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-15/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7844
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8270
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8273

  RESULTS:
  RAW:         median(top-10)=0.9323, mean(top-10)=0.9268, median(all)=0.8368, mean(all)=0.7844
  + SMOOTHING: median(top-10)=0.9464, mean(top-10)=0.9439, median(all)=0.8677, mean(all)=0.8270 [+0.0140]
  + MRF:       median(top-10)=0.9466, mean(top-10)=0.9439, median(all)=0.8674, mean(all)=0.8273 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0142

================================================================================
Subject: NKI-TRT-20-16
================================================================================
  Step 0: Generating predictions with V2 model (40 random views)...
  Mesh: 157852 vertices, 315700 faces
  Generating 40 random views...
  Generating predictions for 40 views (continuous camera pose)...
    ✓ Random_0 (pose=(-0.7482463982754526, -1.0537454407915248, 1.3013421082119008)): shape (37, 800, 800)
      Valid pixels: 76332/640000 (11.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6, max=315699, num_faces=315700
      Valid probs shape: (37, 76332)
    ✓ Random_1 (pose=(1.4951934809704923, 2.634559538383849, -0.4454382753996282)): shape (37, 800, 800)
      Valid pixels: 104412/640000 (16.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=22, max=315625, num_faces=315700
      Valid probs shape: (37, 104412)
    ✓ Random_2 (pose=(-1.6639240650957006, -2.6510523734348603, 0.7099533326316658)): shape (37, 800, 800)
      Valid pixels: 78162/640000 (12.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=315699, num_faces=315700
      Valid probs shape: (37, 78162)
    ✓ Random_3 (pose=(1.8332102428127595, -0.6880920947232476, -2.6197902564067124)): shape (37, 800, 800)
      Valid pixels: 79475/640000 (12.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=158, max=315699, num_faces=315700
      Valid probs shape: (37, 79475)
    ✓ Random_4 (pose=(1.1971612416680593, -0.7261504686808831, 2.734417110560938)): shape (37, 800, 800)
      Valid pixels: 94983/640000 (14.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=315688, num_faces=315700
      Valid probs shape: (37, 94983)
    ✓ Random_5 (pose=(-0.48712380160056235, 2.1283919088416496, 1.006715470590505)): shape (37, 800, 800)
      Valid pixels: 90807/640000 (14.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3071, max=315698, num_faces=315700
      Valid probs shape: (37, 90807)
    ✓ Random_6 (pose=(1.2393053918228105, 0.07940367796034353, 2.5643403954858286)): shape (37, 800, 800)
      Valid pixels: 95506/640000 (14.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=315687, num_faces=315700
      Valid probs shape: (37, 95506)
    ✓ Random_7 (pose=(-1.7335796663052776, -1.475992443479077, -2.478587976607585)): shape (37, 800, 800)
      Valid pixels: 87652/640000 (13.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=22, max=315627, num_faces=315700
      Valid probs shape: (37, 87652)
    ✓ Random_8 (pose=(1.690947502779264, -0.9048950491988239, -1.5743077418297173)): shape (37, 800, 800)
      Valid pixels: 67441/640000 (10.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=47, max=315699, num_faces=315700
      Valid probs shape: (37, 67441)
    ✓ Random_9 (pose=(-0.37583956310924815, 2.648789234878283, -3.0711714060004125)): shape (37, 800, 800)
      Valid pixels: 70605/640000 (11.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=45, max=315694, num_faces=315700
      Valid probs shape: (37, 70605)
    ✓ Random_10 (pose=(1.0417577872134327, 2.193018752093783, -1.3201271739628357)): shape (37, 800, 800)
      Valid pixels: 94053/640000 (14.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=28, max=315699, num_faces=315700
      Valid probs shape: (37, 94053)
    ✓ Random_11 (pose=(-1.0069755099795397, -2.331416896070726, 1.4063756482077228)): shape (37, 800, 800)
      Valid pixels: 75477/640000 (11.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=30, max=315699, num_faces=315700
      Valid probs shape: (37, 75477)
    ✓ Random_12 (pose=(1.7619235896022074, -0.20014151713014838, -1.4586555994852912)): shape (37, 800, 800)
      Valid pixels: 70409/640000 (11.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=287, max=315699, num_faces=315700
      Valid probs shape: (37, 70409)
    ✓ Random_13 (pose=(1.8094172708818625, -0.8354583185140472, -2.2202469503803393)): shape (37, 800, 800)
      Valid pixels: 73758/640000 (11.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=92, max=315699, num_faces=315700
      Valid probs shape: (37, 73758)
    ✓ Random_14 (pose=(3.107803380075345, -2.5356802637772318, -1.5768939330370038)): shape (37, 800, 800)
      Valid pixels: 69575/640000 (10.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=16, max=315625, num_faces=315700
      Valid probs shape: (37, 69575)
    ✓ Random_15 (pose=(-0.021556019879248378, 2.921796769948414, 0.8696650904064613)): shape (37, 800, 800)
      Valid pixels: 51756/640000 (8.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=24683, max=315696, num_faces=315700
      Valid probs shape: (37, 51756)
    ✓ Random_16 (pose=(2.4552943572662285, 1.392528152645406, 2.5904028201331446)): shape (37, 800, 800)
      Valid pixels: 67016/640000 (10.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=29, max=315553, num_faces=315700
      Valid probs shape: (37, 67016)
    ✓ Random_17 (pose=(-2.5442223799141566, 1.7046533790202787, -0.5590359732292578)): shape (37, 800, 800)
      Valid pixels: 82399/640000 (12.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=45, max=315699, num_faces=315700
      Valid probs shape: (37, 82399)
    ✓ Random_18 (pose=(0.9219094714558169, -2.9220549132467926, -1.57814926082834)): shape (37, 800, 800)
      Valid pixels: 66831/640000 (10.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4969, max=315699, num_faces=315700
      Valid probs shape: (37, 66831)
    ✓ Random_19 (pose=(2.810802542123663, -2.097235481723742, -0.4958467218148015)): shape (37, 800, 800)
      Valid pixels: 76588/640000 (12.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=315625, num_faces=315700
      Valid probs shape: (37, 76588)
    ✓ Random_20 (pose=(-2.484606695858602, 2.8311076060633864, 0.6404899527256234)): shape (37, 800, 800)
      Valid pixels: 57943/640000 (9.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=29, max=315455, num_faces=315700
      Valid probs shape: (37, 57943)
    ✓ Random_21 (pose=(-1.9624325071493836, -2.698487778930642, 2.030159993878681)): shape (37, 800, 800)
      Valid pixels: 67727/640000 (10.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=315699, num_faces=315700
      Valid probs shape: (37, 67727)
    ✓ Random_22 (pose=(1.324589174438625, 3.0285933813563446, 2.754223612589901)): shape (37, 800, 800)
      Valid pixels: 96528/640000 (15.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=414, max=315696, num_faces=315700
      Valid probs shape: (37, 96528)
    ✓ Random_23 (pose=(-1.0625393134716794, -2.1939442919579246, 1.0611234492243868)): shape (37, 800, 800)
      Valid pixels: 68473/640000 (10.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=214, max=315699, num_faces=315700
      Valid probs shape: (37, 68473)
    ✓ Random_24 (pose=(0.7424748050602692, 2.9044668162331737, 2.397803394266907)): shape (37, 800, 800)
      Valid pixels: 80540/640000 (12.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=14453, max=315696, num_faces=315700
      Valid probs shape: (37, 80540)
    ✓ Random_25 (pose=(0.9272041399782154, 2.823778168364373, 2.585775738704764)): shape (37, 800, 800)
      Valid pixels: 88245/640000 (13.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2832, max=315696, num_faces=315700
      Valid probs shape: (37, 88245)
    ✓ Random_26 (pose=(-2.602069236018454, -1.286389440587854, 1.26759554894912)): shape (37, 800, 800)
      Valid pixels: 88677/640000 (13.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=180, max=315699, num_faces=315700
      Valid probs shape: (37, 88677)
    ✓ Random_27 (pose=(1.5642043257701292, -0.9145581151190796, -2.5448130947208156)): shape (37, 800, 800)
      Valid pixels: 80075/640000 (12.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=19, max=315699, num_faces=315700
      Valid probs shape: (37, 80075)
    ✓ Random_28 (pose=(-2.482637345713706, -0.5411900359510939, 1.7890231724433265)): shape (37, 800, 800)
      Valid pixels: 67241/640000 (10.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=2945, max=315699, num_faces=315700
      Valid probs shape: (37, 67241)
    ✓ Random_29 (pose=(-1.0683170472931947, 0.16900927104841879, -1.4292639648699084)): shape (37, 800, 800)
      Valid pixels: 63908/640000 (10.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=315556, num_faces=315700
      Valid probs shape: (37, 63908)
    ✓ Random_30 (pose=(-1.9283880185468376, -0.724451121589389, -0.28908898864751764)): shape (37, 800, 800)
      Valid pixels: 95122/640000 (14.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=376, max=315696, num_faces=315700
      Valid probs shape: (37, 95122)
    ✓ Random_31 (pose=(1.2273864937629728, 1.347126174980322, 2.747664368967939)): shape (37, 800, 800)
      Valid pixels: 94788/640000 (14.8%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=103, max=315698, num_faces=315700
      Valid probs shape: (37, 94788)
    ✓ Random_32 (pose=(-2.382621211055546, -2.9257079138107773, -1.778456989179939)): shape (37, 800, 800)
      Valid pixels: 62869/640000 (9.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=315625, num_faces=315700
      Valid probs shape: (37, 62869)
    ✓ Random_33 (pose=(-0.4808584020606794, -2.4415748671830175, 0.9168559742307512)): shape (37, 800, 800)
      Valid pixels: 67615/640000 (10.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=342, max=315699, num_faces=315700
      Valid probs shape: (37, 67615)
    ✓ Random_34 (pose=(2.8422229203780045, 1.3028663485718166, 0.009112498590504448)): shape (37, 800, 800)
      Valid pixels: 79284/640000 (12.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=202, max=315699, num_faces=315700
      Valid probs shape: (37, 79284)
    ✓ Random_35 (pose=(-0.6016856183295376, -3.128735105023812, -2.3008272492263666)): shape (37, 800, 800)
      Valid pixels: 56407/640000 (8.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=452, max=315627, num_faces=315700
      Valid probs shape: (37, 56407)
    ✓ Random_36 (pose=(-1.2003722558517815, 2.728903201511317, 1.961306399747344)): shape (37, 800, 800)
      Valid pixels: 74704/640000 (11.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=297, max=315699, num_faces=315700
      Valid probs shape: (37, 74704)
    ✓ Random_37 (pose=(-0.8589702445405663, -3.0709627138246773, -0.3621394861384908)): shape (37, 800, 800)
      Valid pixels: 85123/640000 (13.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=10739, max=315696, num_faces=315700
      Valid probs shape: (37, 85123)
    ✓ Random_38 (pose=(-1.079574587625769, -0.9159869597702595, 2.3859926394033266)): shape (37, 800, 800)
      Valid pixels: 98532/640000 (15.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=12, max=315625, num_faces=315700
      Valid probs shape: (37, 98532)
    ✓ Random_39 (pose=(-2.0496547619986805, 0.6810939801491793, -2.5282547989563335)): shape (37, 800, 800)
      Valid pixels: 72056/640000 (11.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=15, max=315627, num_faces=315700
      Valid probs shape: (37, 72056)
    P stats: min=0.0000, max=1.0000, mean=0.0259
    Non-zero vertices: 151490/157852
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 6362 1543 1160 4143    0 2077  980 5448 6676]
  Ground Truth Stats:
    Labels shape: (157852,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-16/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.8125
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8546
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8551

  RESULTS:
  RAW:         median(top-10)=0.9162, mean(top-10)=0.9179, median(all)=0.8616, mean(all)=0.8125
  + SMOOTHING: median(top-10)=0.9391, mean(top-10)=0.9382, median(all)=0.8964, mean(all)=0.8546 [+0.0229]
  + MRF:       median(top-10)=0.9392, mean(top-10)=0.9385, median(all)=0.8966, mean(all)=0.8551 [+0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0231

================================================================================
Subject: NKI-TRT-20-17
================================================================================
  Step 0: Generating predictions with V2 model (40 random views)...
  Mesh: 135896 vertices, 271788 faces
  Generating 40 random views...
  Generating predictions for 40 views (continuous camera pose)...
    ✓ Random_0 (pose=(-2.429658645473369, 2.094944820583711, -2.1535635361115193)): shape (37, 800, 800)
      Valid pixels: 67684/640000 (10.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=271627, num_faces=271788
      Valid probs shape: (37, 67684)
    ✓ Random_1 (pose=(2.9350252743400054, 2.1544371720708817, 2.3529602872799185)): shape (37, 800, 800)
      Valid pixels: 62603/640000 (9.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=271775, num_faces=271788
      Valid probs shape: (37, 62603)
    ✓ Random_2 (pose=(2.0419546102212918, -2.2859271251673485, -1.05385588657834)): shape (37, 800, 800)
      Valid pixels: 90991/640000 (14.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=16, max=271787, num_faces=271788
      Valid probs shape: (37, 90991)
    ✓ Random_3 (pose=(-2.8022225902488382, -2.0957147417771917, -1.9613259059998511)): shape (37, 800, 800)
      Valid pixels: 83484/640000 (13.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=271787, num_faces=271788
      Valid probs shape: (37, 83484)
    ✓ Random_4 (pose=(-0.636008139770019, -0.4550429568536214, 0.2964888117030875)): shape (37, 800, 800)
      Valid pixels: 56981/640000 (8.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=271719, num_faces=271788
      Valid probs shape: (37, 56981)
    ✓ Random_5 (pose=(0.42033096616573484, 1.2678904425122761, -1.669798378104343)): shape (37, 800, 800)
      Valid pixels: 92667/640000 (14.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=271787, num_faces=271788
      Valid probs shape: (37, 92667)
    ✓ Random_6 (pose=(1.014204598095212, 2.7120229503921705, 2.367799519471438)): shape (37, 800, 800)
      Valid pixels: 86810/640000 (13.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2545, max=271785, num_faces=271788
      Valid probs shape: (37, 86810)
    ✓ Random_7 (pose=(1.0391918335204577, 0.7139938847040481, -0.11451228941932223)): shape (37, 800, 800)
      Valid pixels: 80669/640000 (12.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=271786, num_faces=271788
      Valid probs shape: (37, 80669)
    ✓ Random_8 (pose=(-0.3861394033924186, -3.1350071595034663, -0.42817108229473444)): shape (37, 800, 800)
      Valid pixels: 62133/640000 (9.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=24558, max=271785, num_faces=271788
      Valid probs shape: (37, 62133)
    ✓ Random_9 (pose=(-0.34225306900960994, 0.493391174368909, 1.2865316221545688)): shape (37, 800, 800)
      Valid pixels: 55791/640000 (8.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=270543, num_faces=271788
      Valid probs shape: (37, 55791)
    ✓ Random_10 (pose=(-0.1925924810577042, -1.2475633729932085, -0.04125099660040421)): shape (37, 800, 800)
      Valid pixels: 63769/640000 (10.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=18, max=271719, num_faces=271788
      Valid probs shape: (37, 63769)
    ✓ Random_11 (pose=(2.075701582893225, 1.7865991010206201, 2.8610976904782017)): shape (37, 800, 800)
      Valid pixels: 89076/640000 (13.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=271785, num_faces=271788
      Valid probs shape: (37, 89076)
    ✓ Random_12 (pose=(2.91633147318994, 1.993879903133128, -0.36630088643375514)): shape (37, 800, 800)
      Valid pixels: 61719/640000 (9.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=271719, num_faces=271788
      Valid probs shape: (37, 61719)
    ✓ Random_13 (pose=(0.267788509716973, -2.1225745467367405, 0.5436800890482649)): shape (37, 800, 800)
      Valid pixels: 82006/640000 (12.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=113, max=271787, num_faces=271788
      Valid probs shape: (37, 82006)
    ✓ Random_14 (pose=(0.8205057957976551, -1.5548444558112897, -2.093250520840961)): shape (37, 800, 800)
      Valid pixels: 78314/640000 (12.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=271719, num_faces=271788
      Valid probs shape: (37, 78314)
    ✓ Random_15 (pose=(-2.351936279312755, -1.3021029514632068, 0.30200534424512426)): shape (37, 800, 800)
      Valid pixels: 91072/640000 (14.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=271779, num_faces=271788
      Valid probs shape: (37, 91072)
    ✓ Random_16 (pose=(1.4254366776225087, 2.2926867874519097, 3.0231257939533966)): shape (37, 800, 800)
      Valid pixels: 85677/640000 (13.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=271719, num_faces=271788
      Valid probs shape: (37, 85677)
    ✓ Random_17 (pose=(-0.5191533671683422, 1.1553001788603812, -2.6560248895905945)): shape (37, 800, 800)
      Valid pixels: 90692/640000 (14.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7, max=271787, num_faces=271788
      Valid probs shape: (37, 90692)
    ✓ Random_18 (pose=(1.010982181057103, -1.9569989276400823, 0.3782366022019916)): shape (37, 800, 800)
      Valid pixels: 93019/640000 (14.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=93, max=271787, num_faces=271788
      Valid probs shape: (37, 93019)
    ✓ Random_19 (pose=(-0.6634010555091372, 1.4225988301499832, -2.6344594160860777)): shape (37, 800, 800)
      Valid pixels: 95435/640000 (14.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=271787, num_faces=271788
      Valid probs shape: (37, 95435)
    ✓ Random_20 (pose=(-0.4538927125320984, -1.5246702797827765, -0.8263250934014135)): shape (37, 800, 800)
      Valid pixels: 78119/640000 (12.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=271721, num_faces=271788
      Valid probs shape: (37, 78119)
    ✓ Random_21 (pose=(0.07637161611126153, 0.667907036040793, 1.3295274443751586)): shape (37, 800, 800)
      Valid pixels: 64217/640000 (10.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=271618, num_faces=271788
      Valid probs shape: (37, 64217)
    ✓ Random_22 (pose=(1.485827984859788, 1.2926354041248036, 0.977742325336596)): shape (37, 800, 800)
      Valid pixels: 67272/640000 (10.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=271785, num_faces=271788
      Valid probs shape: (37, 67272)
    ✓ Random_23 (pose=(0.007934926224448802, -2.494276271276777, 0.8545972102396115)): shape (37, 800, 800)
      Valid pixels: 61495/640000 (9.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1162, max=271787, num_faces=271788
      Valid probs shape: (37, 61495)
    ✓ Random_24 (pose=(-0.9142668416827626, -0.2522813972876028, -1.5746356196970441)): shape (37, 800, 800)
      Valid pixels: 61548/640000 (9.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=271626, num_faces=271788
      Valid probs shape: (37, 61548)
    ✓ Random_25 (pose=(-1.4860110592149793, -2.8292764230739635, -0.33503100095302063)): shape (37, 800, 800)
      Valid pixels: 90102/640000 (14.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=9, max=271779, num_faces=271788
      Valid probs shape: (37, 90102)
    ✓ Random_26 (pose=(-1.7570596299638888, -1.140716175211534, 1.855300866748257)): shape (37, 800, 800)
      Valid pixels: 67499/640000 (10.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=88, max=271787, num_faces=271788
      Valid probs shape: (37, 67499)
    ✓ Random_27 (pose=(-0.2848601674218827, 2.9264713028394356, -0.5978496336986847)): shape (37, 800, 800)
      Valid pixels: 53404/640000 (8.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=34271, max=271785, num_faces=271788
      Valid probs shape: (37, 53404)
    ✓ Random_28 (pose=(-0.532926104484106, -0.5015616018187128, -0.014054058564020977)): shape (37, 800, 800)
      Valid pixels: 56420/640000 (8.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=271713, num_faces=271788
      Valid probs shape: (37, 56420)
    ✓ Random_29 (pose=(0.21513988357858693, -1.89691504151207, -2.4739748528537717)): shape (37, 800, 800)
      Valid pixels: 89959/640000 (14.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=0, max=271785, num_faces=271788
      Valid probs shape: (37, 89959)
    ✓ Random_30 (pose=(1.3396238871938566, -2.9479314333482383, -1.3229212574401754)): shape (37, 800, 800)
      Valid pixels: 69868/640000 (10.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=123, max=271787, num_faces=271788
      Valid probs shape: (37, 69868)
    ✓ Random_31 (pose=(-0.35694131807599083, -0.3107369994040825, -2.973934379661612)): shape (37, 800, 800)
      Valid pixels: 51244/640000 (8.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=271739, num_faces=271788
      Valid probs shape: (37, 51244)
    ✓ Random_32 (pose=(-1.3405177492073443, -2.587815423301604, 0.4353896863386879)): shape (37, 800, 800)
      Valid pixels: 75146/640000 (11.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=202, max=271721, num_faces=271788
      Valid probs shape: (37, 75146)
    ✓ Random_33 (pose=(-2.9853278791873974, -2.7607962543906748, -2.6820881469040576)): shape (37, 800, 800)
      Valid pixels: 54851/640000 (8.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=271786, num_faces=271788
      Valid probs shape: (37, 54851)
    ✓ Random_34 (pose=(-2.183885178838304, 1.058358858199263, -0.9386081390088132)): shape (37, 800, 800)
      Valid pixels: 89553/640000 (14.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=436, max=271785, num_faces=271788
      Valid probs shape: (37, 89553)
    ✓ Random_35 (pose=(2.6434391657464396, 2.555461594203887, -2.6333505114620905)): shape (37, 800, 800)
      Valid pixels: 67435/640000 (10.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=271627, num_faces=271788
      Valid probs shape: (37, 67435)
    ✓ Random_36 (pose=(2.51922266509061, -2.221297348782512, 2.5635320073967804)): shape (37, 800, 800)
      Valid pixels: 69902/640000 (10.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=271719, num_faces=271788
      Valid probs shape: (37, 69902)
    ✓ Random_37 (pose=(-1.2664504702733854, 0.896804112113573, 1.9993796631530518)): shape (37, 800, 800)
      Valid pixels: 70630/640000 (11.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=17, max=271787, num_faces=271788
      Valid probs shape: (37, 70630)
    ✓ Random_38 (pose=(0.31851472677803994, -0.6528556466753384, -2.1870968129322605)): shape (37, 800, 800)
      Valid pixels: 64044/640000 (10.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=270542, num_faces=271788
      Valid probs shape: (37, 64044)
    ✓ Random_39 (pose=(-1.6694315351447926, -2.416905543842505, -0.8709408069069355)): shape (37, 800, 800)
      Valid pixels: 86503/640000 (13.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=271717, num_faces=271788
      Valid probs shape: (37, 86503)
    P stats: min=0.0000, max=0.9999, mean=0.0260
    Non-zero vertices: 130832/135896
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 5064 1209 1363 3324    0 1781 1158 5189 6469]
  Ground Truth Stats:
    Labels shape: (135896,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-17/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7751
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8232
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8234

  RESULTS:
  RAW:         median(top-10)=0.9116, mean(top-10)=0.9145, median(all)=0.8519, mean(all)=0.7751
  + SMOOTHING: median(top-10)=0.9335, mean(top-10)=0.9367, median(all)=0.8770, mean(all)=0.8232 [+0.0219]
  + MRF:       median(top-10)=0.9338, mean(top-10)=0.9368, median(all)=0.8770, mean(all)=0.8234 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0222

================================================================================
Subject: NKI-TRT-20-18
================================================================================
  Step 0: Generating predictions with V2 model (40 random views)...
  Mesh: 132036 vertices, 264068 faces
  Generating 40 random views...
  Generating predictions for 40 views (continuous camera pose)...
    ✓ Random_0 (pose=(-3.121899234145833, 0.7842294288473264, -2.0362267290970233)): shape (37, 800, 800)
      Valid pixels: 84218/640000 (13.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=15102, max=264063, num_faces=264068
      Valid probs shape: (37, 84218)
    ✓ Random_1 (pose=(-2.9226194080279075, -1.317340032264717, -0.18235601710404037)): shape (37, 800, 800)
      Valid pixels: 63384/640000 (9.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=494, max=263924, num_faces=264068
      Valid probs shape: (37, 63384)
    ✓ Random_2 (pose=(2.161883032964788, -0.31711265409689426, -2.6369662761057366)): shape (37, 800, 800)
      Valid pixels: 75563/640000 (11.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2367, max=264066, num_faces=264068
      Valid probs shape: (37, 75563)
    ✓ Random_3 (pose=(0.9359974999452003, 1.2642977869148728, 3.0294302253483263)): shape (37, 800, 800)
      Valid pixels: 80386/640000 (12.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=34, max=264064, num_faces=264068
      Valid probs shape: (37, 80386)
    ✓ Random_4 (pose=(-0.11819153234415314, -1.1720513990997965, 1.6916118002516631)): shape (37, 800, 800)
      Valid pixels: 97383/640000 (15.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=264055, num_faces=264068
      Valid probs shape: (37, 97383)
    ✓ Random_5 (pose=(-2.791675136641544, 0.07737031777316661, -1.2497508585893193)): shape (37, 800, 800)
      Valid pixels: 56781/640000 (8.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=56991, max=264065, num_faces=264068
      Valid probs shape: (37, 56781)
    ✓ Random_6 (pose=(1.4365843014442357, -0.4335243094891381, 2.8733730640285176)): shape (37, 800, 800)
      Valid pixels: 103357/640000 (16.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=35, max=264006, num_faces=264068
      Valid probs shape: (37, 103357)
    ✓ Random_7 (pose=(1.6582670150855785, 1.4755740269380562, 1.3808986858341035)): shape (37, 800, 800)
      Valid pixels: 67391/640000 (10.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6, max=264037, num_faces=264068
      Valid probs shape: (37, 67391)
    ✓ Random_8 (pose=(-2.1913770458578066, -0.8262091204746635, -2.5914007965133026)): shape (37, 800, 800)
      Valid pixels: 98166/640000 (15.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=264062, num_faces=264068
      Valid probs shape: (37, 98166)
    ✓ Random_9 (pose=(-2.4493168380507617, -0.43797957246214647, -2.01141231371383)): shape (37, 800, 800)
      Valid pixels: 67413/640000 (10.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=43, max=264055, num_faces=264068
      Valid probs shape: (37, 67413)
    ✓ Random_10 (pose=(1.1993557796242955, 1.2597015408211956, 2.0732648252843893)): shape (37, 800, 800)
      Valid pixels: 100607/640000 (15.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=18, max=263923, num_faces=264068
      Valid probs shape: (37, 100607)
    ✓ Random_11 (pose=(0.48213852492970277, -1.4915685080527028, -2.951990385523585)): shape (37, 800, 800)
      Valid pixels: 96097/640000 (15.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=21, max=263922, num_faces=264068
      Valid probs shape: (37, 96097)
    ✓ Random_12 (pose=(3.079694379535721, 0.27589673214073906, 0.6760424590786283)): shape (37, 800, 800)
      Valid pixels: 52166/640000 (8.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=248, max=264066, num_faces=264068
      Valid probs shape: (37, 52166)
    ✓ Random_13 (pose=(2.7319463258804078, 3.002597378933097, -0.17006086090866157)): shape (37, 800, 800)
      Valid pixels: 58742/640000 (9.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=264027, num_faces=264068
      Valid probs shape: (37, 58742)
    ✓ Random_14 (pose=(1.3331910879155764, -2.0833768654760183, 1.3409389655625032)): shape (37, 800, 800)
      Valid pixels: 70398/640000 (11.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=264055, num_faces=264068
      Valid probs shape: (37, 70398)
    ✓ Random_15 (pose=(-0.6232655785792662, -2.4634275904329153, -0.7985207099514939)): shape (37, 800, 800)
      Valid pixels: 87525/640000 (13.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1998, max=264066, num_faces=264068
      Valid probs shape: (37, 87525)
    ✓ Random_16 (pose=(-0.4889834337168444, -1.5991215784578936, 0.07637256432428963)): shape (37, 800, 800)
      Valid pixels: 71745/640000 (11.2%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=125, max=264065, num_faces=264068
      Valid probs shape: (37, 71745)
    ✓ Random_17 (pose=(3.0732164693328565, 1.4988617388665784, 1.1788576969359266)): shape (37, 800, 800)
      Valid pixels: 109572/640000 (17.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=264065, num_faces=264068
      Valid probs shape: (37, 109572)
    ✓ Random_18 (pose=(2.437360748846756, 0.929658701953338, -1.773601325067804)): shape (37, 800, 800)
      Valid pixels: 78057/640000 (12.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1444, max=264065, num_faces=264068
      Valid probs shape: (37, 78057)
    ✓ Random_19 (pose=(-1.1301548301401723, -1.0076469240441228, 1.7910821899667795)): shape (37, 800, 800)
      Valid pixels: 90944/640000 (14.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=14, max=264065, num_faces=264068
      Valid probs shape: (37, 90944)
    ✓ Random_20 (pose=(-0.92813473320478, -1.9254624175395365, -0.8390356167300896)): shape (37, 800, 800)
      Valid pixels: 101643/640000 (15.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=308, max=264066, num_faces=264068
      Valid probs shape: (37, 101643)
    ✓ Random_21 (pose=(-2.8101277392043835, 1.151526934069354, 2.525060235651666)): shape (37, 800, 800)
      Valid pixels: 80882/640000 (12.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=264055, num_faces=264068
      Valid probs shape: (37, 80882)
    ✓ Random_22 (pose=(-2.611545498175159, -0.16880780843117194, 2.2646984785840143)): shape (37, 800, 800)
      Valid pixels: 61820/640000 (9.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=41, max=264067, num_faces=264068
      Valid probs shape: (37, 61820)
    ✓ Random_23 (pose=(-2.783354191871341, -0.9477785435954393, 2.436661666518007)): shape (37, 800, 800)
      Valid pixels: 69146/640000 (10.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1387, max=264065, num_faces=264068
      Valid probs shape: (37, 69146)
    ✓ Random_24 (pose=(0.5250362897693992, 2.5875101899991284, 2.0738966321725405)): shape (37, 800, 800)
      Valid pixels: 82645/640000 (12.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=15034, max=264062, num_faces=264068
      Valid probs shape: (37, 82645)
    ✓ Random_25 (pose=(0.6223273452027511, 2.1484635128190552, 0.6463250444379027)): shape (37, 800, 800)
      Valid pixels: 60479/640000 (9.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2416, max=263811, num_faces=264068
      Valid probs shape: (37, 60479)
    ✓ Random_26 (pose=(3.0127642131633614, 1.9696741618008744, -2.989284016826017)): shape (37, 800, 800)
      Valid pixels: 77281/640000 (12.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=263809, num_faces=264068
      Valid probs shape: (37, 77281)
    ✓ Random_27 (pose=(-2.474536621470821, -3.089053109116605, -1.0773258137584674)): shape (37, 800, 800)
      Valid pixels: 69211/640000 (10.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=263306, num_faces=264068
      Valid probs shape: (37, 69211)
    ✓ Random_28 (pose=(1.075205776897584, 1.121454802376796, 2.6115923691216283)): shape (37, 800, 800)
      Valid pixels: 98570/640000 (15.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=34, max=263923, num_faces=264068
      Valid probs shape: (37, 98570)
    ✓ Random_29 (pose=(-2.1366666577643745, -1.6644370225933274, 2.2477558827442534)): shape (37, 800, 800)
      Valid pixels: 71151/640000 (11.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=41, max=264065, num_faces=264068
      Valid probs shape: (37, 71151)
    ✓ Random_30 (pose=(-1.2171722221584067, 1.4632466956653065, -0.3923677346365122)): shape (37, 800, 800)
      Valid pixels: 100241/640000 (15.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=5, max=263923, num_faces=264068
      Valid probs shape: (37, 100241)
    ✓ Random_31 (pose=(0.4843106898534417, 0.8535407630264924, -1.8275378679981051)): shape (37, 800, 800)
      Valid pixels: 79045/640000 (12.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=264065, num_faces=264068
      Valid probs shape: (37, 79045)
    ✓ Random_32 (pose=(2.9769348517215493, -3.019176313061716, -1.3461618037435068)): shape (37, 800, 800)
      Valid pixels: 46424/640000 (7.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=264027, num_faces=264068
      Valid probs shape: (37, 46424)
    ✓ Random_33 (pose=(0.326358052685777, -1.1348731046537957, 2.2492839139184184)): shape (37, 800, 800)
      Valid pixels: 70175/640000 (11.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=264055, num_faces=264068
      Valid probs shape: (37, 70175)
    ✓ Random_34 (pose=(0.6543004965595682, 2.5851864154207878, -2.270214931144361)): shape (37, 800, 800)
      Valid pixels: 64525/640000 (10.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=569, max=264065, num_faces=264068
      Valid probs shape: (37, 64525)
    ✓ Random_35 (pose=(2.872996444933947, -1.6067360490238596, -1.0372445308087377)): shape (37, 800, 800)
      Valid pixels: 97283/640000 (15.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=264055, num_faces=264068
      Valid probs shape: (37, 97283)
    ✓ Random_36 (pose=(-2.3558546266005345, -0.8417222820489618, -0.49496717790946265)): shape (37, 800, 800)
      Valid pixels: 78861/640000 (12.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2418, max=263922, num_faces=264068
      Valid probs shape: (37, 78861)
    ✓ Random_37 (pose=(0.6900755779524697, 2.950896740120819, 0.6363099787326982)): shape (37, 800, 800)
      Valid pixels: 60720/640000 (9.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=62, max=264053, num_faces=264068
      Valid probs shape: (37, 60720)
    ✓ Random_38 (pose=(-1.9627099696293144, -2.0320273136602642, 1.884416574186675)): shape (37, 800, 800)
      Valid pixels: 66599/640000 (10.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=264066, num_faces=264068
      Valid probs shape: (37, 66599)
    ✓ Random_39 (pose=(-0.7130345180866442, 2.23904013586682, -0.1353444385735898)): shape (37, 800, 800)
      Valid pixels: 88863/640000 (13.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=2057, max=263923, num_faces=264068
      Valid probs shape: (37, 88863)
    P stats: min=0.0000, max=0.9999, mean=0.0263
    Non-zero vertices: 128639/132036
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 3397 1362  908 3762    0 2215  928 4100 6137]
  Ground Truth Stats:
    Labels shape: (132036,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-18/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7946
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8344
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8350

  RESULTS:
  RAW:         median(top-10)=0.9167, mean(top-10)=0.9163, median(all)=0.8540, mean(all)=0.7946
  + SMOOTHING: median(top-10)=0.9303, mean(top-10)=0.9303, median(all)=0.8803, mean(all)=0.8344 [+0.0136]
  + MRF:       median(top-10)=0.9301, mean(top-10)=0.9305, median(all)=0.8809, mean(all)=0.8350 [-0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0134

================================================================================
Subject: NKI-TRT-20-19
================================================================================
  Step 0: Generating predictions with V2 model (40 random views)...
  Mesh: 131542 vertices, 263080 faces
  Generating 40 random views...
  Generating predictions for 40 views (continuous camera pose)...
    ✓ Random_0 (pose=(1.4429389444154115, -0.6142589405428471, -2.6282035509413513)): shape (37, 800, 800)
      Valid pixels: 69013/640000 (10.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=263076, num_faces=263080
      Valid probs shape: (37, 69013)
    ✓ Random_1 (pose=(-1.6715643793768495, -1.5984422549100221, -2.982217082684728)): shape (37, 800, 800)
      Valid pixels: 85558/640000 (13.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=262950, num_faces=263080
      Valid probs shape: (37, 85558)
    ✓ Random_2 (pose=(-3.0029150183081534, -0.15525093986615035, -2.4925941574064643)): shape (37, 800, 800)
      Valid pixels: 39930/640000 (6.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1641, max=263079, num_faces=263080
      Valid probs shape: (37, 39930)
    ✓ Random_3 (pose=(-1.810177008173672, 0.022577965369941833, -2.5008353247090636)): shape (37, 800, 800)
      Valid pixels: 67922/640000 (10.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=33, max=262833, num_faces=263080
      Valid probs shape: (37, 67922)
    ✓ Random_4 (pose=(2.130057674382093, -0.5438650888048997, -0.32963986420934344)): shape (37, 800, 800)
      Valid pixels: 79358/640000 (12.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=27, max=263079, num_faces=263080
      Valid probs shape: (37, 79358)
    ✓ Random_5 (pose=(-2.5096503024855954, -1.1688596845591561, -1.2445934714822329)): shape (37, 800, 800)
      Valid pixels: 61861/640000 (9.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=178, max=262970, num_faces=263080
      Valid probs shape: (37, 61861)
    ✓ Random_6 (pose=(0.26809016304236577, 0.7568845145920955, 1.735410224760515)): shape (37, 800, 800)
      Valid pixels: 68671/640000 (10.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=262973, num_faces=263080
      Valid probs shape: (37, 68671)
    ✓ Random_7 (pose=(1.1025080083868941, 2.1241367056566363, 0.23023158390583376)): shape (37, 800, 800)
      Valid pixels: 67994/640000 (10.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=42, max=262834, num_faces=263080
      Valid probs shape: (37, 67994)
    ✓ Random_8 (pose=(-0.387080204819922, 2.458407060820874, 2.157607472791911)): shape (37, 800, 800)
      Valid pixels: 51284/640000 (8.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=167, max=263078, num_faces=263080
      Valid probs shape: (37, 51284)
    ✓ Random_9 (pose=(2.5952236961857746, -1.1210015402008575, 2.325429765514066)): shape (37, 800, 800)
      Valid pixels: 75636/640000 (11.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=263078, num_faces=263080
      Valid probs shape: (37, 75636)
    ✓ Random_10 (pose=(0.382012652562012, -0.03512977113288018, 0.24452565925510683)): shape (37, 800, 800)
      Valid pixels: 45282/640000 (7.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6, max=262834, num_faces=263080
      Valid probs shape: (37, 45282)
    ✓ Random_11 (pose=(0.5171890060970856, -2.9994423449085628, -2.118649301255026)): shape (37, 800, 800)
      Valid pixels: 49594/640000 (7.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5604, max=263079, num_faces=263080
      Valid probs shape: (37, 49594)
    ✓ Random_12 (pose=(-2.272034536623916, 2.71570465587138, 3.0576031595717543)): shape (37, 800, 800)
      Valid pixels: 67828/640000 (10.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7, max=262950, num_faces=263080
      Valid probs shape: (37, 67828)
    ✓ Random_13 (pose=(-2.9735234634443346, -0.39513033522899255, -1.7716514923776456)): shape (37, 800, 800)
      Valid pixels: 49252/640000 (7.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1121, max=263079, num_faces=263080
      Valid probs shape: (37, 49252)
    ✓ Random_14 (pose=(-0.612286857277355, 2.7785457517441383, 1.1759530571504655)): shape (37, 800, 800)
      Valid pixels: 55493/640000 (8.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4654, max=263078, num_faces=263080
      Valid probs shape: (37, 55493)
    ✓ Random_15 (pose=(-1.283550481611731, 1.2338816500972074, 1.6533497470850431)): shape (37, 800, 800)
      Valid pixels: 60178/640000 (9.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=263078, num_faces=263080
      Valid probs shape: (37, 60178)
    ✓ Random_16 (pose=(-1.9709660006547736, 0.2804856237008506, 0.7518331145997599)): shape (37, 800, 800)
      Valid pixels: 61714/640000 (9.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=145, max=263078, num_faces=263080
      Valid probs shape: (37, 61714)
    ✓ Random_17 (pose=(0.1511036009755764, 0.8240087885065108, -1.1464262748409342)): shape (37, 800, 800)
      Valid pixels: 64810/640000 (10.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=11, max=262934, num_faces=263080
      Valid probs shape: (37, 64810)
    ✓ Random_18 (pose=(-2.8514871102130868, 2.3204934247807243, 0.8798311274435751)): shape (37, 800, 800)
      Valid pixels: 62553/640000 (9.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6, max=263003, num_faces=263080
      Valid probs shape: (37, 62553)
    ✓ Random_19 (pose=(0.8812551764906491, -2.295963263457347, 1.3640769328649274)): shape (37, 800, 800)
      Valid pixels: 63363/640000 (9.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=47, max=263057, num_faces=263080
      Valid probs shape: (37, 63363)
    ✓ Random_20 (pose=(-0.5140542521126763, -0.9517853963626601, 0.4787301819080043)): shape (37, 800, 800)
      Valid pixels: 55044/640000 (8.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=6, max=263076, num_faces=263080
      Valid probs shape: (37, 55044)
    ✓ Random_21 (pose=(-0.43642293665416476, -1.3049730715466907, 3.035550447870639)): shape (37, 800, 800)
      Valid pixels: 60450/640000 (9.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=262971, num_faces=263080
      Valid probs shape: (37, 60450)
    ✓ Random_22 (pose=(-1.346145918629095, 1.7335511249498312, 2.145795083510607)): shape (37, 800, 800)
      Valid pixels: 75059/640000 (11.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=51, max=263076, num_faces=263080
      Valid probs shape: (37, 75059)
    ✓ Random_23 (pose=(1.5788097919430468, -0.9878950857334461, -2.4991459698384264)): shape (37, 800, 800)
      Valid pixels: 66506/640000 (10.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=263078, num_faces=263080
      Valid probs shape: (37, 66506)
    ✓ Random_24 (pose=(-2.0726499330935364, 2.0051430802845394, 2.7424558495145694)): shape (37, 800, 800)
      Valid pixels: 83547/640000 (13.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=10, max=262951, num_faces=263080
      Valid probs shape: (37, 83547)
    ✓ Random_25 (pose=(0.657053013884382, 1.5706798571322373, -1.3226622821078424)): shape (37, 800, 800)
      Valid pixels: 92072/640000 (14.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=262950, num_faces=263080
      Valid probs shape: (37, 92072)
    ✓ Random_26 (pose=(2.108328280425254, 2.8323091260033904, -2.092718988254094)): shape (37, 800, 800)
      Valid pixels: 59045/640000 (9.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=263078, num_faces=263080
      Valid probs shape: (37, 59045)
    ✓ Random_27 (pose=(-0.5199492080501935, -2.106470843398463, 0.720425008357076)): shape (37, 800, 800)
      Valid pixels: 60886/640000 (9.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=118, max=263076, num_faces=263080
      Valid probs shape: (37, 60886)
    ✓ Random_28 (pose=(-2.014042405600029, 1.7289689694249786, -2.4776175837162215)): shape (37, 800, 800)
      Valid pixels: 60536/640000 (9.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=11, max=262996, num_faces=263080
      Valid probs shape: (37, 60536)
    ✓ Random_29 (pose=(1.8481032792803678, 0.5063622065949729, -2.8276986541274076)): shape (37, 800, 800)
      Valid pixels: 75895/640000 (11.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=263078, num_faces=263080
      Valid probs shape: (37, 75895)
    ✓ Random_30 (pose=(-0.08826977822355309, -2.239318315635472, -2.593423106996358)): shape (37, 800, 800)
      Valid pixels: 66308/640000 (10.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=12567, max=263079, num_faces=263080
      Valid probs shape: (37, 66308)
    ✓ Random_31 (pose=(-0.6319769337943462, 0.9204315378706367, -0.893200192636014)): shape (37, 800, 800)
      Valid pixels: 52727/640000 (8.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=262996, num_faces=263080
      Valid probs shape: (37, 52727)
    ✓ Random_32 (pose=(-2.2681481215778065, -0.5392867048771981, -1.0612688372726442)): shape (37, 800, 800)
      Valid pixels: 56226/640000 (8.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4799, max=263079, num_faces=263080
      Valid probs shape: (37, 56226)
    ✓ Random_33 (pose=(2.2958862536245226, 1.1871276594540898, -2.206865029333001)): shape (37, 800, 800)
      Valid pixels: 73856/640000 (11.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=263078, num_faces=263080
      Valid probs shape: (37, 73856)
    ✓ Random_34 (pose=(-0.9285939070014746, 2.0670542752859946, -0.42777020246227515)): shape (37, 800, 800)
      Valid pixels: 79203/640000 (12.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=263070, num_faces=263080
      Valid probs shape: (37, 79203)
    ✓ Random_35 (pose=(1.6316470397714342, 1.0084991857772936, 1.3721619958658797)): shape (37, 800, 800)
      Valid pixels: 57731/640000 (9.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=16, max=262998, num_faces=263080
      Valid probs shape: (37, 57731)
    ✓ Random_36 (pose=(-1.9155845536334521, -2.6096311004400126, -0.8464463532356006)): shape (37, 800, 800)
      Valid pixels: 77995/640000 (12.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=13, max=262998, num_faces=263080
      Valid probs shape: (37, 77995)
    ✓ Random_37 (pose=(2.7798824317926805, -1.7394857221139868, -0.2946728047679934)): shape (37, 800, 800)
      Valid pixels: 62765/640000 (9.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=16, max=262833, num_faces=263080
      Valid probs shape: (37, 62765)
    ✓ Random_38 (pose=(-3.0535707021894587, 0.47469321989279356, -0.6918506167752305)): shape (37, 800, 800)
      Valid pixels: 48749/640000 (7.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5605, max=263078, num_faces=263080
      Valid probs shape: (37, 48749)
    ✓ Random_39 (pose=(-1.6433689654423829, 0.4703566624374709, -2.863141162401984)): shape (37, 800, 800)
      Valid pixels: 77008/640000 (12.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=15, max=262834, num_faces=263080
      Valid probs shape: (37, 77008)
    P stats: min=0.0000, max=1.0000, mean=0.0256
    Non-zero vertices: 124650/131542
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 6892 1388 1014 2925    0 2148  954 4380 5916]
  Ground Truth Stats:
    Labels shape: (131542,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-19/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7800
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8267
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8270

  RESULTS:
  RAW:         median(top-10)=0.9120, mean(top-10)=0.9125, median(all)=0.8515, mean(all)=0.7800
  + SMOOTHING: median(top-10)=0.9320, mean(top-10)=0.9305, median(all)=0.8855, mean(all)=0.8267 [+0.0200]
  + MRF:       median(top-10)=0.9321, mean(top-10)=0.9309, median(all)=0.8861, mean(all)=0.8270 [+0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0201

================================================================================
Subject: NKI-TRT-20-2
================================================================================
  Step 0: Generating predictions with V2 model (40 random views)...
  Mesh: 174172 vertices, 348340 faces
  Generating 40 random views...
  Generating predictions for 40 views (continuous camera pose)...
    ✓ Random_0 (pose=(-2.893496810888806, -3.073178964531183, 1.9208328703789022)): shape (37, 800, 800)
      Valid pixels: 41314/640000 (6.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=347893, num_faces=348340
      Valid probs shape: (37, 41314)
    ✓ Random_1 (pose=(-1.4417144361922685, 0.058797782839137724, -2.320921884784958)): shape (37, 800, 800)
      Valid pixels: 69742/640000 (10.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7, max=348268, num_faces=348340
      Valid probs shape: (37, 69742)
    ✓ Random_2 (pose=(3.0915541881950332, 1.4130134825944483, 0.24857414938016786)): shape (37, 800, 800)
      Valid pixels: 70610/640000 (11.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=71, max=348339, num_faces=348340
      Valid probs shape: (37, 70610)
    ✓ Random_3 (pose=(-0.06101446907520325, -1.7095527350394037, 1.3288675298614132)): shape (37, 800, 800)
      Valid pixels: 94210/640000 (14.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=165, max=348339, num_faces=348340
      Valid probs shape: (37, 94210)
    ✓ Random_4 (pose=(-0.6165712939064822, -2.25432385275041, 2.5771380344145127)): shape (37, 800, 800)
      Valid pixels: 74955/640000 (11.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=178, max=348339, num_faces=348340
      Valid probs shape: (37, 74955)
    ✓ Random_5 (pose=(-0.8134944088376042, 0.7623149729171383, 0.1870905166097816)): shape (37, 800, 800)
      Valid pixels: 81547/640000 (12.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=348218, num_faces=348340
      Valid probs shape: (37, 81547)
    ✓ Random_6 (pose=(-2.5198312269930936, 0.5142539134703701, -0.8324270627063375)): shape (37, 800, 800)
      Valid pixels: 75165/640000 (11.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=15648, max=348339, num_faces=348340
      Valid probs shape: (37, 75165)
    ✓ Random_7 (pose=(0.7300624522687773, -1.7553967585129115, 1.8827545898937057)): shape (37, 800, 800)
      Valid pixels: 65365/640000 (10.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=10, max=348268, num_faces=348340
      Valid probs shape: (37, 65365)
    ✓ Random_8 (pose=(0.7540865052445866, -1.7947050059435983, -0.5232277893940376)): shape (37, 800, 800)
      Valid pixels: 67640/640000 (10.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=57, max=348339, num_faces=348340
      Valid probs shape: (37, 67640)
    ✓ Random_9 (pose=(2.8895853252199197, 2.6141159842025727, 1.9771132388807047)): shape (37, 800, 800)
      Valid pixels: 55034/640000 (8.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=348268, num_faces=348340
      Valid probs shape: (37, 55034)
    ✓ Random_10 (pose=(-0.49437301993547633, 1.8818274920355202, -2.7324452011947127)): shape (37, 800, 800)
      Valid pixels: 89455/640000 (14.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=151, max=348339, num_faces=348340
      Valid probs shape: (37, 89455)
    ✓ Random_11 (pose=(0.7584579568286838, 2.966071577240135, -2.5082132043059397)): shape (37, 800, 800)
      Valid pixels: 63951/640000 (10.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2391, max=348338, num_faces=348340
      Valid probs shape: (37, 63951)
    ✓ Random_12 (pose=(1.416673150245554, 0.9482285888997692, 2.19879274502453)): shape (37, 800, 800)
      Valid pixels: 85290/640000 (13.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=348222, num_faces=348340
      Valid probs shape: (37, 85290)
    ✓ Random_13 (pose=(0.11722415521409557, -1.0848198740625512, 0.8587995607059531)): shape (37, 800, 800)
      Valid pixels: 82548/640000 (12.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6, max=348339, num_faces=348340
      Valid probs shape: (37, 82548)
    ✓ Random_14 (pose=(-2.5797338290269507, -1.015562680364393, 0.4328980559436735)): shape (37, 800, 800)
      Valid pixels: 84139/640000 (13.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=869, max=348339, num_faces=348340
      Valid probs shape: (37, 84139)
    ✓ Random_15 (pose=(-2.3126594475428206, -1.5485549681431665, 0.0696227188370524)): shape (37, 800, 800)
      Valid pixels: 87806/640000 (13.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=10, max=348222, num_faces=348340
      Valid probs shape: (37, 87806)
    ✓ Random_16 (pose=(2.7668008479479242, -0.7205433492355446, -1.4214733731507276)): shape (37, 800, 800)
      Valid pixels: 72876/640000 (11.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=213, max=348339, num_faces=348340
      Valid probs shape: (37, 72876)
    ✓ Random_17 (pose=(-2.3809702608398196, -0.6070600905934165, 2.0574780461562003)): shape (37, 800, 800)
      Valid pixels: 56981/640000 (8.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=599, max=348339, num_faces=348340
      Valid probs shape: (37, 56981)
    ✓ Random_18 (pose=(-1.549321295808941, -1.6659687350380485, 2.964872171392498)): shape (37, 800, 800)
      Valid pixels: 93914/640000 (14.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=13, max=348273, num_faces=348340
      Valid probs shape: (37, 93914)
    ✓ Random_19 (pose=(0.9607665383715585, -2.8959558075377383, 1.0084527762219837)): shape (37, 800, 800)
      Valid pixels: 62540/640000 (9.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=171, max=348268, num_faces=348340
      Valid probs shape: (37, 62540)
    ✓ Random_20 (pose=(1.0764378525573237, -2.8479545896477467, 0.791663928468465)): shape (37, 800, 800)
      Valid pixels: 68891/640000 (10.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=169, max=348273, num_faces=348340
      Valid probs shape: (37, 68891)
    ✓ Random_21 (pose=(-2.286591991745339, -1.923003268476752, 2.502519462990393)): shape (37, 800, 800)
      Valid pixels: 65651/640000 (10.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=12, max=348339, num_faces=348340
      Valid probs shape: (37, 65651)
    ✓ Random_22 (pose=(-2.3336470501192585, 1.5882522469445552, 2.4493905954964896)): shape (37, 800, 800)
      Valid pixels: 90206/640000 (14.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=12, max=348273, num_faces=348340
      Valid probs shape: (37, 90206)
    ✓ Random_23 (pose=(-2.412442711800678, -0.40681192680802125, 2.42496338865653)): shape (37, 800, 800)
      Valid pixels: 61761/640000 (9.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=154, max=348339, num_faces=348340
      Valid probs shape: (37, 61761)
    ✓ Random_24 (pose=(0.04828872031391507, -1.771285170244833, 0.530400168377426)): shape (37, 800, 800)
      Valid pixels: 81453/640000 (12.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=134, max=348339, num_faces=348340
      Valid probs shape: (37, 81453)
    ✓ Random_25 (pose=(2.745432267414669, -2.8395720269568447, -2.8037912645100844)): shape (37, 800, 800)
      Valid pixels: 47957/640000 (7.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=347914, num_faces=348340
      Valid probs shape: (37, 47957)
    ✓ Random_26 (pose=(-2.94638637113079, -0.8261422178178868, -1.97328138546146)): shape (37, 800, 800)
      Valid pixels: 74008/640000 (11.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=159, max=348339, num_faces=348340
      Valid probs shape: (37, 74008)
    ✓ Random_27 (pose=(0.5559808357507525, -1.5761053850079447, 0.3318561832659572)): shape (37, 800, 800)
      Valid pixels: 90604/640000 (14.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=12, max=348339, num_faces=348340
      Valid probs shape: (37, 90604)
    ✓ Random_28 (pose=(-1.4471411676898291, -2.9794747129612533, -1.5462667542190613)): shape (37, 800, 800)
      Valid pixels: 57716/640000 (9.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=14, max=347576, num_faces=348340
      Valid probs shape: (37, 57716)
    ✓ Random_29 (pose=(2.4661441723415107, 1.4120266307928926, 2.8203010438006135)): shape (37, 800, 800)
      Valid pixels: 72196/640000 (11.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8, max=348214, num_faces=348340
      Valid probs shape: (37, 72196)
    ✓ Random_30 (pose=(-0.9840546135818462, 1.9055379968213506, -0.9202387523629341)): shape (37, 800, 800)
      Valid pixels: 59259/640000 (9.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=9, max=347575, num_faces=348340
      Valid probs shape: (37, 59259)
    ✓ Random_31 (pose=(-0.22421811206055597, 1.4167668637806559, 2.7973403133653383)): shape (37, 800, 800)
      Valid pixels: 59952/640000 (9.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=348339, num_faces=348340
      Valid probs shape: (37, 59952)
    ✓ Random_32 (pose=(-1.8355481238085518, 1.2697797601090448, 0.9158406923735889)): shape (37, 800, 800)
      Valid pixels: 65019/640000 (10.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=52, max=348336, num_faces=348340
      Valid probs shape: (37, 65019)
    ✓ Random_33 (pose=(2.1129325367528455, 1.5013601978555755, 2.5874622935570013)): shape (37, 800, 800)
      Valid pixels: 77044/640000 (12.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=9, max=348216, num_faces=348340
      Valid probs shape: (37, 77044)
    ✓ Random_34 (pose=(-1.1166577167314027, -2.0418369378530388, 2.1109757686103077)): shape (37, 800, 800)
      Valid pixels: 90996/640000 (14.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=68, max=348339, num_faces=348340
      Valid probs shape: (37, 90996)
    ✓ Random_35 (pose=(2.1841990038826085, -2.9490429666869473, -1.642586736432557)): shape (37, 800, 800)
      Valid pixels: 51802/640000 (8.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=8, max=348337, num_faces=348340
      Valid probs shape: (37, 51802)
    ✓ Random_36 (pose=(2.048992609255599, 2.112691318337953, 0.041122879506858556)): shape (37, 800, 800)
      Valid pixels: 91494/640000 (14.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=12, max=348273, num_faces=348340
      Valid probs shape: (37, 91494)
    ✓ Random_37 (pose=(-2.0030450084923688, -0.5913201653491051, -0.7218579883210681)): shape (37, 800, 800)
      Valid pixels: 78512/640000 (12.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=238, max=348318, num_faces=348340
      Valid probs shape: (37, 78512)
    ✓ Random_38 (pose=(-2.8498669334274487, 1.657351743606883, -2.4724686266423737)): shape (37, 800, 800)
      Valid pixels: 72908/640000 (11.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=346945, num_faces=348340
      Valid probs shape: (37, 72908)
    ✓ Random_39 (pose=(1.9158059184133212, 2.7936929737650997, -1.5061572511573629)): shape (37, 800, 800)
      Valid pixels: 57072/640000 (8.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=348339, num_faces=348340
      Valid probs shape: (37, 57072)
    P stats: min=0.0000, max=1.0000, mean=0.0248
    Non-zero vertices: 159730/174172
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 14442  1091  1404  4961     0  2954  1317  5498  8035]
  Ground Truth Stats:
    Labels shape: (174172,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-2/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7344
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7927
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7931

  RESULTS:
  RAW:         median(top-10)=0.8869, mean(top-10)=0.8884, median(all)=0.8242, mean(all)=0.7344
  + SMOOTHING: median(top-10)=0.9114, mean(top-10)=0.9118, median(all)=0.8628, mean(all)=0.7927 [+0.0245]
  + MRF:       median(top-10)=0.9112, mean(top-10)=0.9120, median(all)=0.8638, mean(all)=0.7931 [-0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0243

================================================================================
Subject: NKI-TRT-20-20
================================================================================
  Step 0: Generating predictions with V2 model (40 random views)...
  Mesh: 147840 vertices, 295676 faces
  Generating 40 random views...
  Generating predictions for 40 views (continuous camera pose)...
    ✓ Random_0 (pose=(2.4656860591038496, 1.9069090899278196, 1.6825746725294)): shape (37, 800, 800)
      Valid pixels: 91995/640000 (14.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=6, max=295667, num_faces=295676
      Valid probs shape: (37, 91995)
    ✓ Random_1 (pose=(-0.7569131031408336, 2.270036616155628, -2.608913921138588)): shape (37, 800, 800)
      Valid pixels: 115591/640000 (18.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=157, max=295672, num_faces=295676
      Valid probs shape: (37, 115591)
    ✓ Random_2 (pose=(3.1046638698190705, 2.4357425042473944, -0.5787280878257022)): shape (37, 800, 800)
      Valid pixels: 64387/640000 (10.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=295175, num_faces=295676
      Valid probs shape: (37, 64387)
    ✓ Random_3 (pose=(-1.5441638840450176, 1.9881052389456073, 2.270966471608701)): shape (37, 800, 800)
      Valid pixels: 111652/640000 (17.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=70, max=295668, num_faces=295676
      Valid probs shape: (37, 111652)
    ✓ Random_4 (pose=(0.47490540656310554, -2.6472269981535543, 1.2893190046221434)): shape (37, 800, 800)
      Valid pixels: 76668/640000 (12.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=152, max=295672, num_faces=295676
      Valid probs shape: (37, 76668)
    ✓ Random_5 (pose=(-0.21499989706687117, -2.5152426779338923, 2.768238347916596)): shape (37, 800, 800)
      Valid pixels: 69373/640000 (10.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2267, max=295673, num_faces=295676
      Valid probs shape: (37, 69373)
    ✓ Random_6 (pose=(1.2343288777324242, -1.7946600028971915, 1.674383649795903)): shape (37, 800, 800)
      Valid pixels: 77953/640000 (12.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=98, max=295669, num_faces=295676
      Valid probs shape: (37, 77953)
    ✓ Random_7 (pose=(-1.1534961000343238, 0.23080943103493157, -2.422258921307949)): shape (37, 800, 800)
      Valid pixels: 94966/640000 (14.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=12, max=295667, num_faces=295676
      Valid probs shape: (37, 94966)
    ✓ Random_8 (pose=(1.7595550955153154, 0.6948827568217717, -1.1912766494250255)): shape (37, 800, 800)
      Valid pixels: 89957/640000 (14.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=83, max=295664, num_faces=295676
      Valid probs shape: (37, 89957)
    ✓ Random_9 (pose=(-2.7653630106204323, -1.7246072985572485, 1.2044914326358542)): shape (37, 800, 800)
      Valid pixels: 109911/640000 (17.2%)
      Probs stats: min=0.0000, max=0.9994, mean=0.0270
      Face IDs: min=5, max=295602, num_faces=295676
      Valid probs shape: (37, 109911)
    ✓ Random_10 (pose=(-2.1940933238493354, 2.6660733426997876, 2.244873254996911)): shape (37, 800, 800)
      Valid pixels: 99754/640000 (15.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=295667, num_faces=295676
      Valid probs shape: (37, 99754)
    ✓ Random_11 (pose=(1.7672321914418552, -1.5139615557698325, -2.6081590575875495)): shape (37, 800, 800)
      Valid pixels: 92303/640000 (14.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=24, max=295672, num_faces=295676
      Valid probs shape: (37, 92303)
    ✓ Random_12 (pose=(-0.8870694257560356, -0.11786594129161543, -0.8401753728122943)): shape (37, 800, 800)
      Valid pixels: 102665/640000 (16.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=295579, num_faces=295676
      Valid probs shape: (37, 102665)
    ✓ Random_13 (pose=(2.2893342669349064, 2.490935393095511, -2.565947066710823)): shape (37, 800, 800)
      Valid pixels: 100846/640000 (15.8%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=1, max=295415, num_faces=295676
      Valid probs shape: (37, 100846)
    ✓ Random_14 (pose=(2.9447905422718463, 2.0474724876330983, 3.1145662765825843)): shape (37, 800, 800)
      Valid pixels: 83756/640000 (13.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=295514, num_faces=295676
      Valid probs shape: (37, 83756)
    ✓ Random_15 (pose=(-2.233519331579283, -0.9229309983135168, 0.9006013124062973)): shape (37, 800, 800)
      Valid pixels: 100969/640000 (15.8%)
      Probs stats: min=0.0000, max=0.9993, mean=0.0270
      Face IDs: min=8, max=295675, num_faces=295676
      Valid probs shape: (37, 100969)
    ✓ Random_16 (pose=(-0.5838095165711419, 2.5451399139430695, -2.6478388353470943)): shape (37, 800, 800)
      Valid pixels: 102865/640000 (16.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=664, max=295672, num_faces=295676
      Valid probs shape: (37, 102865)
    ✓ Random_17 (pose=(0.46921968789873736, -0.19960983688691902, 2.0406687380176933)): shape (37, 800, 800)
      Valid pixels: 70987/640000 (11.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=292939, num_faces=295676
      Valid probs shape: (37, 70987)
    ✓ Random_18 (pose=(0.9606883588341999, 1.8085662244141636, -2.5623188968567314)): shape (37, 800, 800)
      Valid pixels: 86653/640000 (13.5%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=75, max=295675, num_faces=295676
      Valid probs shape: (37, 86653)
    ✓ Random_19 (pose=(-1.1186804992947752, -2.3090538211289893, 2.153032849134851)): shape (37, 800, 800)
      Valid pixels: 119978/640000 (18.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=492, max=295668, num_faces=295676
      Valid probs shape: (37, 119978)
    ✓ Random_20 (pose=(1.3924899579752816, 1.155894281950543, -1.1546921919376898)): shape (37, 800, 800)
      Valid pixels: 105599/640000 (16.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=47, max=295668, num_faces=295676
      Valid probs shape: (37, 105599)
    ✓ Random_21 (pose=(-1.7011117575115722, 0.42938507137103477, -1.3870625471669302)): shape (37, 800, 800)
      Valid pixels: 85871/640000 (13.4%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=117, max=295606, num_faces=295676
      Valid probs shape: (37, 85871)
    ✓ Random_22 (pose=(1.6967635655497881, -2.4934954630705026, -0.314280211193704)): shape (37, 800, 800)
      Valid pixels: 121656/640000 (19.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=33, max=295667, num_faces=295676
      Valid probs shape: (37, 121656)
    ✓ Random_23 (pose=(1.920172333628928, -0.19538021506413195, 0.5022641536158807)): shape (37, 800, 800)
      Valid pixels: 97968/640000 (15.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=97, max=295671, num_faces=295676
      Valid probs shape: (37, 97968)
    ✓ Random_24 (pose=(1.8552902537613303, -2.425207004401024, -2.6641202103322854)): shape (37, 800, 800)
      Valid pixels: 90048/640000 (14.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=9, max=295672, num_faces=295676
      Valid probs shape: (37, 90048)
    ✓ Random_25 (pose=(-1.676307888280559, -1.530144073762446, -2.7805653009893594)): shape (37, 800, 800)
      Valid pixels: 114316/640000 (17.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=32, max=295671, num_faces=295676
      Valid probs shape: (37, 114316)
    ✓ Random_26 (pose=(0.8131641809068695, -1.8764549998137858, -1.3161472373048337)): shape (37, 800, 800)
      Valid pixels: 88642/640000 (13.9%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=91, max=295675, num_faces=295676
      Valid probs shape: (37, 88642)
    ✓ Random_27 (pose=(-0.23396884843224708, -1.3737645476410465, 0.3345124717241328)): shape (37, 800, 800)
      Valid pixels: 75785/640000 (11.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=18, max=295668, num_faces=295676
      Valid probs shape: (37, 75785)
    ✓ Random_28 (pose=(-0.7420157821198599, -0.6307075630636914, 2.071108326467396)): shape (37, 800, 800)
      Valid pixels: 96379/640000 (15.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=295671, num_faces=295676
      Valid probs shape: (37, 96379)
    ✓ Random_29 (pose=(-2.5533355601970857, 0.30764787507287705, -1.6426430350653798)): shape (37, 800, 800)
      Valid pixels: 71326/640000 (11.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=41350, max=295674, num_faces=295676
      Valid probs shape: (37, 71326)
    ✓ Random_30 (pose=(-0.5871238257254046, -2.2120414991170154, 2.8920270129708667)): shape (37, 800, 800)
      Valid pixels: 90801/640000 (14.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=239, max=295668, num_faces=295676
      Valid probs shape: (37, 90801)
    ✓ Random_31 (pose=(-0.1863395178433569, -0.9979763580503151, 1.3552970359552603)): shape (37, 800, 800)
      Valid pixels: 101337/640000 (15.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=295667, num_faces=295676
      Valid probs shape: (37, 101337)
    ✓ Random_32 (pose=(1.297730216125995, -0.44623904655390323, -0.035616909154602805)): shape (37, 800, 800)
      Valid pixels: 116939/640000 (18.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7, max=295671, num_faces=295676
      Valid probs shape: (37, 116939)
    ✓ Random_33 (pose=(1.7519379869085672, -1.5633810053276704, -1.4274609727747414)): shape (37, 800, 800)
      Valid pixels: 91600/640000 (14.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=66, max=295668, num_faces=295676
      Valid probs shape: (37, 91600)
    ✓ Random_34 (pose=(2.118875345651695, 2.5278493622518754, 0.07190151624972874)): shape (37, 800, 800)
      Valid pixels: 108986/640000 (17.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=15, max=295668, num_faces=295676
      Valid probs shape: (37, 108986)
    ✓ Random_35 (pose=(-0.4973059918352152, 3.124940035467132, 0.4083269795902642)): shape (37, 800, 800)
      Valid pixels: 81764/640000 (12.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=11153, max=295675, num_faces=295676
      Valid probs shape: (37, 81764)
    ✓ Random_36 (pose=(-2.6206073325814208, 0.035504041150218324, 1.4039196301695762)): shape (37, 800, 800)
      Valid pixels: 70449/640000 (11.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3727, max=295675, num_faces=295676
      Valid probs shape: (37, 70449)
    ✓ Random_37 (pose=(0.679932296887729, 0.15956030807549748, 0.2495439188680333)): shape (37, 800, 800)
      Valid pixels: 83904/640000 (13.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=295671, num_faces=295676
      Valid probs shape: (37, 83904)
    ✓ Random_38 (pose=(-2.2870886057896618, 2.388318524070524, 1.0913686158782108)): shape (37, 800, 800)
      Valid pixels: 66897/640000 (10.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=295463, num_faces=295676
      Valid probs shape: (37, 66897)
    ✓ Random_39 (pose=(1.7633594311801586, 2.5626175776251188, -1.6579725944987262)): shape (37, 800, 800)
      Valid pixels: 77779/640000 (12.2%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=32, max=295660, num_faces=295676
      Valid probs shape: (37, 77779)
    P stats: min=0.0000, max=0.9999, mean=0.0256
    Non-zero vertices: 140011/147840
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 7829 1276 1322 4545    0 2161 1024 4648 5799]
  Ground Truth Stats:
    Labels shape: (147840,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-20/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7752
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8260
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8262

  RESULTS:
  RAW:         median(top-10)=0.9138, mean(top-10)=0.9181, median(all)=0.8331, mean(all)=0.7752
  + SMOOTHING: median(top-10)=0.9348, mean(top-10)=0.9338, median(all)=0.8761, mean(all)=0.8260 [+0.0210]
  + MRF:       median(top-10)=0.9347, mean(top-10)=0.9340, median(all)=0.8765, mean(all)=0.8262 [-0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0209

================================================================================
Subject: NKI-TRT-20-3
================================================================================
  Step 0: Generating predictions with V2 model (40 random views)...
  Mesh: 123781 vertices, 247558 faces
  Generating 40 random views...
  Generating predictions for 40 views (continuous camera pose)...
    ✓ Random_0 (pose=(-1.8276219011241308, -3.0737667888886153, 2.925547019206191)): shape (37, 800, 800)
      Valid pixels: 116249/640000 (18.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=247553, num_faces=247558
      Valid probs shape: (37, 116249)
    ✓ Random_1 (pose=(-0.5734197153768692, 1.2435035211067538, -1.1273819184421505)): shape (37, 800, 800)
      Valid pixels: 86051/640000 (13.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=247552, num_faces=247558
      Valid probs shape: (37, 86051)
    ✓ Random_2 (pose=(0.9997059958391228, -1.8702827123688484, 0.8216718760531609)): shape (37, 800, 800)
      Valid pixels: 110184/640000 (17.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=54, max=247553, num_faces=247558
      Valid probs shape: (37, 110184)
    ✓ Random_3 (pose=(2.7624238438712743, 1.2051968723512916, 2.2513622802067843)): shape (37, 800, 800)
      Valid pixels: 79395/640000 (12.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=62, max=247552, num_faces=247558
      Valid probs shape: (37, 79395)
    ✓ Random_4 (pose=(1.222596334627931, -0.37229796301470364, 0.7427670215058879)): shape (37, 800, 800)
      Valid pixels: 95530/640000 (14.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=247553, num_faces=247558
      Valid probs shape: (37, 95530)
    ✓ Random_5 (pose=(0.43503828320750415, 0.16849166004025662, -0.3329744007586406)): shape (37, 800, 800)
      Valid pixels: 73672/640000 (11.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=247553, num_faces=247558
      Valid probs shape: (37, 73672)
    ✓ Random_6 (pose=(-2.4623128127952945, -1.4573817267520646, -1.5605438858350853)): shape (37, 800, 800)
      Valid pixels: 95019/640000 (14.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=9, max=247553, num_faces=247558
      Valid probs shape: (37, 95019)
    ✓ Random_7 (pose=(-2.4034318290196928, 2.023875256605379, -2.9571625686545278)): shape (37, 800, 800)
      Valid pixels: 87522/640000 (13.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=247553, num_faces=247558
      Valid probs shape: (37, 87522)
    ✓ Random_8 (pose=(0.07415502289425424, -0.24932259759421083, 1.5534859623621715)): shape (37, 800, 800)
      Valid pixels: 64268/640000 (10.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=246802, num_faces=247558
      Valid probs shape: (37, 64268)
    ✓ Random_9 (pose=(-1.7757886375443075, -1.3649872338927302, -2.7267569129416374)): shape (37, 800, 800)
      Valid pixels: 112945/640000 (17.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=247553, num_faces=247558
      Valid probs shape: (37, 112945)
    ✓ Random_10 (pose=(1.4747636453580526, 0.0310067437005479, 1.6301465472792875)): shape (37, 800, 800)
      Valid pixels: 76450/640000 (11.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=22, max=245398, num_faces=247558
      Valid probs shape: (37, 76450)
    ✓ Random_11 (pose=(2.135150863723883, -1.9294430069328006, -0.5164331421678003)): shape (37, 800, 800)
      Valid pixels: 115329/640000 (18.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=7, max=247553, num_faces=247558
      Valid probs shape: (37, 115329)
    ✓ Random_12 (pose=(1.6770943504931974, 0.3750445657959798, -0.6871983227087721)): shape (37, 800, 800)
      Valid pixels: 116556/640000 (18.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=46, max=247553, num_faces=247558
      Valid probs shape: (37, 116556)
    ✓ Random_13 (pose=(-3.1017570161955756, 2.3753754121470383, 2.9331108078102464)): shape (37, 800, 800)
      Valid pixels: 74138/640000 (11.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=247523, num_faces=247558
      Valid probs shape: (37, 74138)
    ✓ Random_14 (pose=(0.6359030558368475, -0.6645868906058063, 1.779703882514636)): shape (37, 800, 800)
      Valid pixels: 80377/640000 (12.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=247553, num_faces=247558
      Valid probs shape: (37, 80377)
    ✓ Random_15 (pose=(-2.4437745624935694, 0.8514209290160157, -3.059377726270275)): shape (37, 800, 800)
      Valid pixels: 80966/640000 (12.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=170, max=247553, num_faces=247558
      Valid probs shape: (37, 80966)
    ✓ Random_16 (pose=(-2.133703775092388, 0.8551253391555145, 1.1564595647132458)): shape (37, 800, 800)
      Valid pixels: 81003/640000 (12.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=140, max=247557, num_faces=247558
      Valid probs shape: (37, 81003)
    ✓ Random_17 (pose=(0.8015949237114985, -2.1683460625024766, 1.4422537601016119)): shape (37, 800, 800)
      Valid pixels: 86984/640000 (13.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=171, max=247553, num_faces=247558
      Valid probs shape: (37, 86984)
    ✓ Random_18 (pose=(2.6602879551365453, -2.5692238886347205, 0.34544849575821024)): shape (37, 800, 800)
      Valid pixels: 76196/640000 (11.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=247540, num_faces=247558
      Valid probs shape: (37, 76196)
    ✓ Random_19 (pose=(1.8974174168841316, 2.7161406774968944, 0.47076380758711833)): shape (37, 800, 800)
      Valid pixels: 103964/640000 (16.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=4, max=247553, num_faces=247558
      Valid probs shape: (37, 103964)
    ✓ Random_20 (pose=(1.2324885941923824, -1.7881763996860895, 1.1471282702962933)): shape (37, 800, 800)
      Valid pixels: 91446/640000 (14.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=6, max=247553, num_faces=247558
      Valid probs shape: (37, 91446)
    ✓ Random_21 (pose=(-0.4942659964977745, -0.5963071806245073, 2.4885387242576478)): shape (37, 800, 800)
      Valid pixels: 88826/640000 (13.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=247553, num_faces=247558
      Valid probs shape: (37, 88826)
    ✓ Random_22 (pose=(-0.9116387600947542, -0.9780797787971443, -3.019209957139567)): shape (37, 800, 800)
      Valid pixels: 93350/640000 (14.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=0, max=247553, num_faces=247558
      Valid probs shape: (37, 93350)
    ✓ Random_23 (pose=(-2.1853494247400125, -2.895672086440699, 2.0113714870345873)): shape (37, 800, 800)
      Valid pixels: 70225/640000 (11.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=247553, num_faces=247558
      Valid probs shape: (37, 70225)
    ✓ Random_24 (pose=(2.572196645139176, -1.5667367915291515, -0.8236344222323515)): shape (37, 800, 800)
      Valid pixels: 114168/640000 (17.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=247553, num_faces=247558
      Valid probs shape: (37, 114168)
    ✓ Random_25 (pose=(-1.2069225062086557, 1.9880514650854906, -0.7490856514347679)): shape (37, 800, 800)
      Valid pixels: 100046/640000 (15.6%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=176, max=247412, num_faces=247558
      Valid probs shape: (37, 100046)
    ✓ Random_26 (pose=(1.8588509980954164, 2.230635854834053, 0.8723740697593412)): shape (37, 800, 800)
      Valid pixels: 96122/640000 (15.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=12, max=247553, num_faces=247558
      Valid probs shape: (37, 96122)
    ✓ Random_27 (pose=(0.20985590871149062, -2.756816605174179, 3.125947707930316)): shape (37, 800, 800)
      Valid pixels: 65970/640000 (10.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=61121, max=247555, num_faces=247558
      Valid probs shape: (37, 65970)
    ✓ Random_28 (pose=(2.8121223890817637, 1.662127346301026, -1.981500941848824)): shape (37, 800, 800)
      Valid pixels: 111398/640000 (17.4%)
      Probs stats: min=0.0000, max=0.9994, mean=0.0270
      Face IDs: min=40, max=247557, num_faces=247558
      Valid probs shape: (37, 111398)
    ✓ Random_29 (pose=(1.6649572776943025, 2.813361060601146, 1.3877293888680127)): shape (37, 800, 800)
      Valid pixels: 77596/640000 (12.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=35, max=247552, num_faces=247558
      Valid probs shape: (37, 77596)
    ✓ Random_30 (pose=(-3.1229038125479596, -2.0917821558947143, 2.213691991590667)): shape (37, 800, 800)
      Valid pixels: 81257/640000 (12.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=3, max=247544, num_faces=247558
      Valid probs shape: (37, 81257)
    ✓ Random_31 (pose=(2.4323023333551097, 1.9152887504494034, -2.9230909425804756)): shape (37, 800, 800)
      Valid pixels: 113971/640000 (17.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=3, max=247447, num_faces=247558
      Valid probs shape: (37, 113971)
    ✓ Random_32 (pose=(-0.8817589199627967, -2.203470537638059, -2.3357816607119988)): shape (37, 800, 800)
      Valid pixels: 69988/640000 (10.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1799, max=247552, num_faces=247558
      Valid probs shape: (37, 69988)
    ✓ Random_33 (pose=(2.604274388189693, 0.6624721975454562, -2.111182780289739)): shape (37, 800, 800)
      Valid pixels: 94900/640000 (14.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6540, max=247557, num_faces=247558
      Valid probs shape: (37, 94900)
    ✓ Random_34 (pose=(-1.771765856108725, 1.4125812238210278, 1.3514278109415763)): shape (37, 800, 800)
      Valid pixels: 77516/640000 (12.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=94, max=247557, num_faces=247558
      Valid probs shape: (37, 77516)
    ✓ Random_35 (pose=(1.057015139022079, 2.642263153303759, 2.8625068040341253)): shape (37, 800, 800)
      Valid pixels: 105502/640000 (16.5%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=2995, max=247557, num_faces=247558
      Valid probs shape: (37, 105502)
    ✓ Random_36 (pose=(-0.6638758097096691, -0.14303626499974653, -1.9037761870913092)): shape (37, 800, 800)
      Valid pixels: 71618/640000 (11.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=246479, num_faces=247558
      Valid probs shape: (37, 71618)
    ✓ Random_37 (pose=(-0.13097526426906114, -2.8651999037871367, -1.5688437963989645)): shape (37, 800, 800)
      Valid pixels: 68983/640000 (10.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=40814, max=247557, num_faces=247558
      Valid probs shape: (37, 68983)
    ✓ Random_38 (pose=(1.8543054710689901, -1.284062551610708, -0.741850810686187)): shape (37, 800, 800)
      Valid pixels: 121457/640000 (19.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=50, max=247553, num_faces=247558
      Valid probs shape: (37, 121457)
    ✓ Random_39 (pose=(2.645215662550024, 0.02113890646610672, 1.9780708127681264)): shape (37, 800, 800)
      Valid pixels: 65154/640000 (10.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=23163, max=247550, num_faces=247558
      Valid probs shape: (37, 65154)
    P stats: min=0.0000, max=0.9998, mean=0.0256
    Non-zero vertices: 117177/123781
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 6604  966 1020 4111    0 2081  671 4297 5206]
  Ground Truth Stats:
    Labels shape: (123781,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-3/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
    MRF iteration 5/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7753
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8259
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8260

  RESULTS:
  RAW:         median(top-10)=0.8935, mean(top-10)=0.8990, median(all)=0.8008, mean(all)=0.7753
  + SMOOTHING: median(top-10)=0.9235, mean(top-10)=0.9254, median(all)=0.8558, mean(all)=0.8259 [+0.0300]
  + MRF:       median(top-10)=0.9237, mean(top-10)=0.9255, median(all)=0.8559, mean(all)=0.8260 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0302

================================================================================
Subject: NKI-TRT-20-4
================================================================================
  Step 0: Generating predictions with V2 model (40 random views)...
  Mesh: 158207 vertices, 316410 faces
  Generating 40 random views...
  Generating predictions for 40 views (continuous camera pose)...
    ✓ Random_0 (pose=(2.061938065845707, 1.128613290852642, 0.7028011502177316)): shape (37, 800, 800)
      Valid pixels: 104708/640000 (16.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=14, max=316409, num_faces=316410
      Valid probs shape: (37, 104708)
    ✓ Random_1 (pose=(-2.3795262264298, -0.13258859233680997, 0.9777282910186402)): shape (37, 800, 800)
      Valid pixels: 78254/640000 (12.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1932, max=316409, num_faces=316410
      Valid probs shape: (37, 78254)
    ✓ Random_2 (pose=(0.07547557237556779, 2.33002539865511, 2.750536086276563)): shape (37, 800, 800)
      Valid pixels: 77415/640000 (12.1%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=3243, max=316409, num_faces=316410
      Valid probs shape: (37, 77415)
    ✓ Random_3 (pose=(0.42379995611299837, 2.347501622365926, 1.372660652353443)): shape (37, 800, 800)
      Valid pixels: 95735/640000 (15.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=5600, max=316408, num_faces=316410
      Valid probs shape: (37, 95735)
    ✓ Random_4 (pose=(-0.664737561534813, -2.0545581706008353, -1.2149416771734343)): shape (37, 800, 800)
      Valid pixels: 107528/640000 (16.8%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=3591, max=316406, num_faces=316410
      Valid probs shape: (37, 107528)
    ✓ Random_5 (pose=(1.0003591722415814, -2.392757108757349, -0.730482139187036)): shape (37, 800, 800)
      Valid pixels: 99147/640000 (15.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=381, max=316400, num_faces=316410
      Valid probs shape: (37, 99147)
    ✓ Random_6 (pose=(-1.964181384129924, 1.312922703087997, -1.6212679567304749)): shape (37, 800, 800)
      Valid pixels: 92743/640000 (14.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=145, max=316407, num_faces=316410
      Valid probs shape: (37, 92743)
    ✓ Random_7 (pose=(0.8517462269131482, 2.1279872443567953, -1.202687682731559)): shape (37, 800, 800)
      Valid pixels: 116611/640000 (18.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=52, max=316409, num_faces=316410
      Valid probs shape: (37, 116611)
    ✓ Random_8 (pose=(2.3656217945081606, -2.7261102159746886, 0.9563397744792255)): shape (37, 800, 800)
      Valid pixels: 70340/640000 (11.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=316385, num_faces=316410
      Valid probs shape: (37, 70340)
    ✓ Random_9 (pose=(-0.412810051638679, 2.2333205177111095, -2.5454530318391257)): shape (37, 800, 800)
      Valid pixels: 108943/640000 (17.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=150, max=316409, num_faces=316410
      Valid probs shape: (37, 108943)
    ✓ Random_10 (pose=(1.1578095670871988, 1.5137526754046338, -2.9248468588280425)): shape (37, 800, 800)
      Valid pixels: 85732/640000 (13.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=32, max=316304, num_faces=316410
      Valid probs shape: (37, 85732)
    ✓ Random_11 (pose=(-0.06268648138736221, -0.924923150996404, -0.9507632580804763)): shape (37, 800, 800)
      Valid pixels: 80645/640000 (12.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=2, max=316300, num_faces=316410
      Valid probs shape: (37, 80645)
    ✓ Random_12 (pose=(0.7771803801071009, -0.9323209521143201, 0.48327748585796737)): shape (37, 800, 800)
      Valid pixels: 105608/640000 (16.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=316409, num_faces=316410
      Valid probs shape: (37, 105608)
    ✓ Random_13 (pose=(-0.8024256869845798, -0.9398558766740757, 0.3567014290449735)): shape (37, 800, 800)
      Valid pixels: 74523/640000 (11.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=11, max=316311, num_faces=316410
      Valid probs shape: (37, 74523)
    ✓ Random_14 (pose=(-2.8592727617152387, 0.603493233665684, -2.5384546351421697)): shape (37, 800, 800)
      Valid pixels: 67088/640000 (10.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=23268, max=316405, num_faces=316410
      Valid probs shape: (37, 67088)
    ✓ Random_15 (pose=(-0.5121768944741083, -0.45112356346607374, 0.6023692700183245)): shape (37, 800, 800)
      Valid pixels: 64181/640000 (10.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=315881, num_faces=316410
      Valid probs shape: (37, 64181)
    ✓ Random_16 (pose=(2.035375917322649, -2.6576733961596366, 2.597202877178052)): shape (37, 800, 800)
      Valid pixels: 108654/640000 (17.0%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=16, max=316220, num_faces=316410
      Valid probs shape: (37, 108654)
    ✓ Random_17 (pose=(0.9986747739563038, 0.013667318325993438, -2.19112489238535)): shape (37, 800, 800)
      Valid pixels: 71766/640000 (11.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=13, max=316311, num_faces=316410
      Valid probs shape: (37, 71766)
    ✓ Random_18 (pose=(-1.7905020936616327, 2.849464729792526, 1.8674427551028376)): shape (37, 800, 800)
      Valid pixels: 89472/640000 (14.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=9, max=316402, num_faces=316410
      Valid probs shape: (37, 89472)
    ✓ Random_19 (pose=(0.6885102146201492, -0.20899873770581312, 1.6368251090319932)): shape (37, 800, 800)
      Valid pixels: 67740/640000 (10.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=316246, num_faces=316410
      Valid probs shape: (37, 67740)
    ✓ Random_20 (pose=(-1.0754310439107186, -3.1051951559968294, 0.4779177477514671)): shape (37, 800, 800)
      Valid pixels: 87985/640000 (13.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3238, max=316407, num_faces=316410
      Valid probs shape: (37, 87985)
    ✓ Random_21 (pose=(-1.3845343124231873, -0.9724042673548356, -0.23716469080688762)): shape (37, 800, 800)
      Valid pixels: 106578/640000 (16.7%)
      Probs stats: min=0.0000, max=0.9995, mean=0.0270
      Face IDs: min=17, max=316306, num_faces=316410
      Valid probs shape: (37, 106578)
    ✓ Random_22 (pose=(-0.20069601951986105, -3.1380959989709347, 0.45103025930905405)): shape (37, 800, 800)
      Valid pixels: 62047/640000 (9.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6618, max=316409, num_faces=316410
      Valid probs shape: (37, 62047)
    ✓ Random_23 (pose=(-2.703258748420553, -0.4776454731914215, 2.502254689837569)): shape (37, 800, 800)
      Valid pixels: 72791/640000 (11.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3217, max=316409, num_faces=316410
      Valid probs shape: (37, 72791)
    ✓ Random_24 (pose=(1.9032288175894676, 1.3015622662854245, 3.1286718938788205)): shape (37, 800, 800)
      Valid pixels: 111489/640000 (17.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=123, max=316396, num_faces=316410
      Valid probs shape: (37, 111489)
    ✓ Random_25 (pose=(-0.6956685227911814, -1.2596905326789078, -0.9172026942073015)): shape (37, 800, 800)
      Valid pixels: 105557/640000 (16.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=22, max=316306, num_faces=316410
      Valid probs shape: (37, 105557)
    ✓ Random_26 (pose=(-2.3335238372972538, 2.7839627635325837, -3.13958968115541)): shape (37, 800, 800)
      Valid pixels: 85918/640000 (13.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=316408, num_faces=316410
      Valid probs shape: (37, 85918)
    ✓ Random_27 (pose=(1.7453474286154371, 1.278733088752043, 0.3528721320555852)): shape (37, 800, 800)
      Valid pixels: 108366/640000 (16.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=13, max=316409, num_faces=316410
      Valid probs shape: (37, 108366)
    ✓ Random_28 (pose=(-2.6856703447990418, 1.5404604233686845, 0.08647079645989875)): shape (37, 800, 800)
      Valid pixels: 78889/640000 (12.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=29, max=316311, num_faces=316410
      Valid probs shape: (37, 78889)
    ✓ Random_29 (pose=(-0.44698953172831546, -0.5436667492497405, -2.1795801825065477)): shape (37, 800, 800)
      Valid pixels: 76862/640000 (12.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=316165, num_faces=316410
      Valid probs shape: (37, 76862)
    ✓ Random_30 (pose=(-2.6341495252967917, -0.4609187557122838, 1.274495664207505)): shape (37, 800, 800)
      Valid pixels: 79350/640000 (12.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4285, max=316409, num_faces=316410
      Valid probs shape: (37, 79350)
    ✓ Random_31 (pose=(1.3834180398304143, 2.852127582983824, -2.0982893895957426)): shape (37, 800, 800)
      Valid pixels: 81230/640000 (12.7%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=61, max=316394, num_faces=316410
      Valid probs shape: (37, 81230)
    ✓ Random_32 (pose=(-3.104415840490687, -1.1313916743751218, 1.1183334954326822)): shape (37, 800, 800)
      Valid pixels: 105934/640000 (16.6%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=8104, max=316408, num_faces=316410
      Valid probs shape: (37, 105934)
    ✓ Random_33 (pose=(-0.597607792022329, -2.7719365612167914, -2.2995067638713524)): shape (37, 800, 800)
      Valid pixels: 60104/640000 (9.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=551, max=316409, num_faces=316410
      Valid probs shape: (37, 60104)
    ✓ Random_34 (pose=(-0.0526918980646931, -1.285768756379452, 0.7435647574800437)): shape (37, 800, 800)
      Valid pixels: 102640/640000 (16.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=316403, num_faces=316410
      Valid probs shape: (37, 102640)
    ✓ Random_35 (pose=(-2.961733810962457, 0.9703687163798005, 3.0538390505216793)): shape (37, 800, 800)
      Valid pixels: 67978/640000 (10.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=426, max=316409, num_faces=316410
      Valid probs shape: (37, 67978)
    ✓ Random_36 (pose=(0.9437694360776021, -0.6617672550736833, 0.3207047113735726)): shape (37, 800, 800)
      Valid pixels: 102724/640000 (16.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=316409, num_faces=316410
      Valid probs shape: (37, 102724)
    ✓ Random_37 (pose=(1.4548287087049063, 1.7801584054614628, -0.5950278686565413)): shape (37, 800, 800)
      Valid pixels: 119271/640000 (18.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=9, max=316409, num_faces=316410
      Valid probs shape: (37, 119271)
    ✓ Random_38 (pose=(1.2385710175562776, -1.2058348311415583, 1.2948559293656068)): shape (37, 800, 800)
      Valid pixels: 81979/640000 (12.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=11, max=316409, num_faces=316410
      Valid probs shape: (37, 81979)
    ✓ Random_39 (pose=(-0.5097425967845952, -0.7455234401411723, -0.8284299955732708)): shape (37, 800, 800)
      Valid pixels: 93377/640000 (14.6%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=8, max=316220, num_faces=316410
      Valid probs shape: (37, 93377)
    P stats: min=0.0000, max=0.9998, mean=0.0259
    Non-zero vertices: 151860/158207
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 6347 1191 1119 4246    0 2942 1075 5783 7284]
  Ground Truth Stats:
    Labels shape: (158207,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-4/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7642
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8071
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8075

  RESULTS:
  RAW:         median(top-10)=0.9101, mean(top-10)=0.9045, median(all)=0.8308, mean(all)=0.7642
  + SMOOTHING: median(top-10)=0.9256, mean(top-10)=0.9219, median(all)=0.8622, mean(all)=0.8071 [+0.0155]
  + MRF:       median(top-10)=0.9261, mean(top-10)=0.9221, median(all)=0.8628, mean(all)=0.8075 [+0.0005]
  TOTAL IMPROVEMENT (median top-10): +0.0160

================================================================================
Subject: NKI-TRT-20-5
================================================================================
  Step 0: Generating predictions with V2 model (40 random views)...
  Mesh: 137753 vertices, 275502 faces
  Generating 40 random views...
  Generating predictions for 40 views (continuous camera pose)...
    ✓ Random_0 (pose=(2.472663122035284, -2.1007439665867085, 1.0229554360335564)): shape (37, 800, 800)
      Valid pixels: 71620/640000 (11.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=273941, num_faces=275502
      Valid probs shape: (37, 71620)
    ✓ Random_1 (pose=(-2.994889597436685, 1.1776806106317625, 2.067075945199658)): shape (37, 800, 800)
      Valid pixels: 88635/640000 (13.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=56, max=275501, num_faces=275502
      Valid probs shape: (37, 88635)
    ✓ Random_2 (pose=(-2.43623323153905, -1.8943860434935187, -0.7707977346142512)): shape (37, 800, 800)
      Valid pixels: 63589/640000 (9.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7, max=275495, num_faces=275502
      Valid probs shape: (37, 63589)
    ✓ Random_3 (pose=(-2.538119851576008, 2.1143618465114313, -0.3565161553387308)): shape (37, 800, 800)
      Valid pixels: 77995/640000 (12.2%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=1, max=275461, num_faces=275502
      Valid probs shape: (37, 77995)
    ✓ Random_4 (pose=(1.5131243071081215, 1.0152285253551918, 1.0575450417684564)): shape (37, 800, 800)
      Valid pixels: 73607/640000 (11.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=275497, num_faces=275502
      Valid probs shape: (37, 73607)
    ✓ Random_5 (pose=(-1.543150451675411, 0.7759732098728769, 2.997553300746107)): shape (37, 800, 800)
      Valid pixels: 106445/640000 (16.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=275501, num_faces=275502
      Valid probs shape: (37, 106445)
    ✓ Random_6 (pose=(-1.4610383461378307, 0.0043737006164077386, -2.6254131287936637)): shape (37, 800, 800)
      Valid pixels: 87219/640000 (13.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=275501, num_faces=275502
      Valid probs shape: (37, 87219)
    ✓ Random_7 (pose=(-0.1631828041249621, 1.0957749120447628, -0.9119909201814669)): shape (37, 800, 800)
      Valid pixels: 73129/640000 (11.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7, max=275501, num_faces=275502
      Valid probs shape: (37, 73129)
    ✓ Random_8 (pose=(0.5491970315847441, -0.7473183350731669, 1.4437226184648697)): shape (37, 800, 800)
      Valid pixels: 73891/640000 (11.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=275501, num_faces=275502
      Valid probs shape: (37, 73891)
    ✓ Random_9 (pose=(2.2069631583386737, -0.5775658148721292, 2.474811268600366)): shape (37, 800, 800)
      Valid pixels: 94440/640000 (14.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2429, max=275462, num_faces=275502
      Valid probs shape: (37, 94440)
    ✓ Random_10 (pose=(0.22152683613553048, 3.029224127040443, 0.7474989759274973)): shape (37, 800, 800)
      Valid pixels: 49062/640000 (7.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7844, max=275501, num_faces=275502
      Valid probs shape: (37, 49062)
    ✓ Random_11 (pose=(-1.2267256582268402, -1.470454411774097, 1.9532374541317843)): shape (37, 800, 800)
      Valid pixels: 96834/640000 (15.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=275498, num_faces=275502
      Valid probs shape: (37, 96834)
    ✓ Random_12 (pose=(-2.1616988401228783, -1.110931860134829, -0.22328371390327328)): shape (37, 800, 800)
      Valid pixels: 95344/640000 (14.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=210, max=275453, num_faces=275502
      Valid probs shape: (37, 95344)
    ✓ Random_13 (pose=(-0.9705219547911197, -1.6031357214861757, -0.7531479438227922)): shape (37, 800, 800)
      Valid pixels: 99047/640000 (15.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=4, max=275459, num_faces=275502
      Valid probs shape: (37, 99047)
    ✓ Random_14 (pose=(0.7704691532137198, 2.2269091608910863, 0.5220471824679733)): shape (37, 800, 800)
      Valid pixels: 70920/640000 (11.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=678, max=275501, num_faces=275502
      Valid probs shape: (37, 70920)
    ✓ Random_15 (pose=(-2.7431644975454708, 1.0823177750195816, -0.4668229467470537)): shape (37, 800, 800)
      Valid pixels: 79746/640000 (12.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1954, max=275462, num_faces=275502
      Valid probs shape: (37, 79746)
    ✓ Random_16 (pose=(-0.08138095671513401, 0.451520890659745, -3.0724668861587716)): shape (37, 800, 800)
      Valid pixels: 53471/640000 (8.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=275330, num_faces=275502
      Valid probs shape: (37, 53471)
    ✓ Random_17 (pose=(-2.273892037823729, 0.42658287178209875, 2.5981116880916098)): shape (37, 800, 800)
      Valid pixels: 88534/640000 (13.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=699, max=275501, num_faces=275502
      Valid probs shape: (37, 88534)
    ✓ Random_18 (pose=(2.652453288490423, -0.25850615603854266, -1.9691536744694769)): shape (37, 800, 800)
      Valid pixels: 50629/640000 (7.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5277, max=275462, num_faces=275502
      Valid probs shape: (37, 50629)
    ✓ Random_19 (pose=(1.8817508339088427, 2.2966461930378976, 1.2623541622637013)): shape (37, 800, 800)
      Valid pixels: 73818/640000 (11.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=275497, num_faces=275502
      Valid probs shape: (37, 73818)
    ✓ Random_20 (pose=(-2.2123383010077364, -0.8460800471055645, 1.2734664316060043)): shape (37, 800, 800)
      Valid pixels: 78554/640000 (12.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=578, max=275461, num_faces=275502
      Valid probs shape: (37, 78554)
    ✓ Random_21 (pose=(-2.3439473487886557, -0.75368293646462, 1.3902381512862894)): shape (37, 800, 800)
      Valid pixels: 76339/640000 (11.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1206, max=275462, num_faces=275502
      Valid probs shape: (37, 76339)
    ✓ Random_22 (pose=(-1.3721365940812438, -2.635580377086926, -2.009153206378703)): shape (37, 800, 800)
      Valid pixels: 71922/640000 (11.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=253, max=274949, num_faces=275502
      Valid probs shape: (37, 71922)
    ✓ Random_23 (pose=(-2.113874416958885, 1.2611836060634598, 0.5463476384833328)): shape (37, 800, 800)
      Valid pixels: 75744/640000 (11.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=56, max=275460, num_faces=275502
      Valid probs shape: (37, 75744)
    ✓ Random_24 (pose=(-0.39458424275382287, -1.6187979952073022, -1.0717852471370914)): shape (37, 800, 800)
      Valid pixels: 94224/640000 (14.7%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=0, max=275458, num_faces=275502
      Valid probs shape: (37, 94224)
    ✓ Random_25 (pose=(1.1114900086915123, 2.6362754256739915, 2.7532949378531466)): shape (37, 800, 800)
      Valid pixels: 96069/640000 (15.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=232, max=275457, num_faces=275502
      Valid probs shape: (37, 96069)
    ✓ Random_26 (pose=(2.5146248698160463, 0.7347629965427185, -0.03829559881022959)): shape (37, 800, 800)
      Valid pixels: 83067/640000 (13.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=795, max=275501, num_faces=275502
      Valid probs shape: (37, 83067)
    ✓ Random_27 (pose=(-3.110738383088597, 2.692881203498776, 1.0468727030921414)): shape (37, 800, 800)
      Valid pixels: 63342/640000 (9.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=275497, num_faces=275502
      Valid probs shape: (37, 63342)
    ✓ Random_28 (pose=(0.5202748780441842, 1.5170175120412264, 2.9674833958845435)): shape (37, 800, 800)
      Valid pixels: 78177/640000 (12.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=61, max=275460, num_faces=275502
      Valid probs shape: (37, 78177)
    ✓ Random_29 (pose=(-0.7535407259995504, 1.7917938908469324, 1.465760620431272)): shape (37, 800, 800)
      Valid pixels: 81466/640000 (12.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=143, max=275454, num_faces=275502
      Valid probs shape: (37, 81466)
    ✓ Random_30 (pose=(-2.636160867602357, 0.5408714529375414, 1.1345431637654357)): shape (37, 800, 800)
      Valid pixels: 60234/640000 (9.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4084, max=275501, num_faces=275502
      Valid probs shape: (37, 60234)
    ✓ Random_31 (pose=(-2.880636911186718, -2.641314530388712, -2.820960759253481)): shape (37, 800, 800)
      Valid pixels: 66371/640000 (10.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=275497, num_faces=275502
      Valid probs shape: (37, 66371)
    ✓ Random_32 (pose=(-2.7570111747346275, 1.9124871974629496, -2.0082557045992866)): shape (37, 800, 800)
      Valid pixels: 90589/640000 (14.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=273940, num_faces=275502
      Valid probs shape: (37, 90589)
    ✓ Random_33 (pose=(0.8358917149207867, 2.4017955704775815, -2.0481486504668167)): shape (37, 800, 800)
      Valid pixels: 64755/640000 (10.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=125, max=275498, num_faces=275502
      Valid probs shape: (37, 64755)
    ✓ Random_34 (pose=(2.692381046075824, -1.987427095053015, 1.9668452764969384)): shape (37, 800, 800)
      Valid pixels: 92058/640000 (14.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=19, max=275459, num_faces=275502
      Valid probs shape: (37, 92058)
    ✓ Random_35 (pose=(0.21046882895387187, 1.3373025449450928, 1.2635613611110532)): shape (37, 800, 800)
      Valid pixels: 98364/640000 (15.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=9, max=275116, num_faces=275502
      Valid probs shape: (37, 98364)
    ✓ Random_36 (pose=(-0.319062670743385, -1.0319232154008535, -0.11548057126206412)): shape (37, 800, 800)
      Valid pixels: 70302/640000 (11.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=4, max=275462, num_faces=275502
      Valid probs shape: (37, 70302)
    ✓ Random_37 (pose=(0.6101470372833497, -2.0524260166803785, 0.12705251484804592)): shape (37, 800, 800)
      Valid pixels: 93428/640000 (14.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=78, max=275501, num_faces=275502
      Valid probs shape: (37, 93428)
    ✓ Random_38 (pose=(-3.094353835842332, -0.4172215040219598, 2.3898892176167585)): shape (37, 800, 800)
      Valid pixels: 58157/640000 (9.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=9392, max=275462, num_faces=275502
      Valid probs shape: (37, 58157)
    ✓ Random_39 (pose=(-3.0173902954758725, 1.3596491082780542, -0.8589228448791908)): shape (37, 800, 800)
      Valid pixels: 82703/640000 (12.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=168, max=275454, num_faces=275502
      Valid probs shape: (37, 82703)
    P stats: min=0.0000, max=0.9999, mean=0.0258
    Non-zero vertices: 131324/137753
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 6429 1706 1244 3423    0 2855 1007 4641 7317]
  Ground Truth Stats:
    Labels shape: (137753,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-5/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
    MRF iteration 5/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7742
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8113
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8116

  RESULTS:
  RAW:         median(top-10)=0.9033, mean(top-10)=0.9082, median(all)=0.8465, mean(all)=0.7742
  + SMOOTHING: median(top-10)=0.9311, mean(top-10)=0.9284, median(all)=0.8613, mean(all)=0.8113 [+0.0278]
  + MRF:       median(top-10)=0.9318, mean(top-10)=0.9287, median(all)=0.8626, mean(all)=0.8116 [+0.0007]
  TOTAL IMPROVEMENT (median top-10): +0.0284

================================================================================
Subject: NKI-TRT-20-6
================================================================================
  Step 0: Generating predictions with V2 model (40 random views)...
  Mesh: 158025 vertices, 316046 faces
  Generating 40 random views...
  Generating predictions for 40 views (continuous camera pose)...
    ✓ Random_0 (pose=(1.1409052685418146, -2.8931501492519525, -2.851811316585259)): shape (37, 800, 800)
      Valid pixels: 92265/640000 (14.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=875, max=316045, num_faces=316046
      Valid probs shape: (37, 92265)
    ✓ Random_1 (pose=(-2.868619536971462, 1.5395700757970703, 0.3647165273977113)): shape (37, 800, 800)
      Valid pixels: 70973/640000 (11.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=316045, num_faces=316046
      Valid probs shape: (37, 70973)
    ✓ Random_2 (pose=(-1.09001540650828, 0.42516894401216465, -2.3163755445845844)): shape (37, 800, 800)
      Valid pixels: 82435/640000 (12.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=316043, num_faces=316046
      Valid probs shape: (37, 82435)
    ✓ Random_3 (pose=(-2.8946147016748434, -2.1527692126582254, 3.0629231793300766)): shape (37, 800, 800)
      Valid pixels: 60539/640000 (9.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=315965, num_faces=316046
      Valid probs shape: (37, 60539)
    ✓ Random_4 (pose=(0.3615794767862055, 1.6368895991233297, -0.844121811459746)): shape (37, 800, 800)
      Valid pixels: 97000/640000 (15.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=10, max=316043, num_faces=316046
      Valid probs shape: (37, 97000)
    ✓ Random_5 (pose=(-2.880074886998836, 2.532270089337235, -0.5327209059079596)): shape (37, 800, 800)
      Valid pixels: 67207/640000 (10.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=2, max=315949, num_faces=316046
      Valid probs shape: (37, 67207)
    ✓ Random_6 (pose=(-2.9234891067115747, -1.2974557246070886, 2.9495440520274396)): shape (37, 800, 800)
      Valid pixels: 72037/640000 (11.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=17, max=316045, num_faces=316046
      Valid probs shape: (37, 72037)
    ✓ Random_7 (pose=(2.6012382221409887, 0.4132922978137801, -0.12496058849176217)): shape (37, 800, 800)
      Valid pixels: 84810/640000 (13.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=203, max=316045, num_faces=316046
      Valid probs shape: (37, 84810)
    ✓ Random_8 (pose=(1.8962749794675346, -0.017171513913417424, -0.9471162580413588)): shape (37, 800, 800)
      Valid pixels: 100094/640000 (15.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=316045, num_faces=316046
      Valid probs shape: (37, 100094)
    ✓ Random_9 (pose=(1.4166104134698916, 0.7790201534044834, 0.9090282365368951)): shape (37, 800, 800)
      Valid pixels: 75329/640000 (11.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=316043, num_faces=316046
      Valid probs shape: (37, 75329)
    ✓ Random_10 (pose=(-0.9815544733567201, 0.391181771517366, 1.0973737530906762)): shape (37, 800, 800)
      Valid pixels: 68408/640000 (10.7%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=10, max=316044, num_faces=316046
      Valid probs shape: (37, 68408)
    ✓ Random_11 (pose=(-2.1315010602124445, 0.23793568082839478, 2.1972923161666227)): shape (37, 800, 800)
      Valid pixels: 99624/640000 (15.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=316045, num_faces=316046
      Valid probs shape: (37, 99624)
    ✓ Random_12 (pose=(0.44595096912740884, -2.97437903945634, 1.8806323139660739)): shape (37, 800, 800)
      Valid pixels: 47384/640000 (7.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=76836, max=316044, num_faces=316046
      Valid probs shape: (37, 47384)
    ✓ Random_13 (pose=(-2.974969134886248, -0.9008881324666111, -1.2346246288780773)): shape (37, 800, 800)
      Valid pixels: 77178/640000 (12.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=316043, num_faces=316046
      Valid probs shape: (37, 77178)
    ✓ Random_14 (pose=(-2.5366121467712714, 2.0590291138019845, 2.6478282163976896)): shape (37, 800, 800)
      Valid pixels: 89608/640000 (14.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=11, max=316043, num_faces=316046
      Valid probs shape: (37, 89608)
    ✓ Random_15 (pose=(0.1671404132689318, -1.7178032794474511, 2.1738343576275376)): shape (37, 800, 800)
      Valid pixels: 81117/640000 (12.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=31, max=316043, num_faces=316046
      Valid probs shape: (37, 81117)
    ✓ Random_16 (pose=(1.7560235961842503, -2.771847976005521, -0.8043023292562972)): shape (37, 800, 800)
      Valid pixels: 103145/640000 (16.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=316045, num_faces=316046
      Valid probs shape: (37, 103145)
    ✓ Random_17 (pose=(2.346759825118042, -2.688265790936972, -3.0514198117949483)): shape (37, 800, 800)
      Valid pixels: 76164/640000 (11.9%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=9, max=315948, num_faces=316046
      Valid probs shape: (37, 76164)
    ✓ Random_18 (pose=(0.5861587907696122, -1.0054386010710306, -3.038370368358513)): shape (37, 800, 800)
      Valid pixels: 99220/640000 (15.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=9, max=315713, num_faces=316046
      Valid probs shape: (37, 99220)
    ✓ Random_19 (pose=(2.640276137531316, -2.081888572651206, -0.5531902744500106)): shape (37, 800, 800)
      Valid pixels: 87425/640000 (13.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=316043, num_faces=316046
      Valid probs shape: (37, 87425)
    ✓ Random_20 (pose=(1.8329429710744272, 1.3828267184367045, -1.9315163356031133)): shape (37, 800, 800)
      Valid pixels: 76333/640000 (11.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=34, max=316045, num_faces=316046
      Valid probs shape: (37, 76333)
    ✓ Random_21 (pose=(-1.126634510027039, 0.9420788975817906, -2.3223337267110735)): shape (37, 800, 800)
      Valid pixels: 91109/640000 (14.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=10, max=316043, num_faces=316046
      Valid probs shape: (37, 91109)
    ✓ Random_22 (pose=(1.279389152573171, 2.8554583844542902, -1.1044567849730367)): shape (37, 800, 800)
      Valid pixels: 97197/640000 (15.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=316045, num_faces=316046
      Valid probs shape: (37, 97197)
    ✓ Random_23 (pose=(-1.2355300642404667, -2.762843995900702, 1.1773478633106738)): shape (37, 800, 800)
      Valid pixels: 72698/640000 (11.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=54, max=316045, num_faces=316046
      Valid probs shape: (37, 72698)
    ✓ Random_24 (pose=(3.0521702508798914, 0.8965156773517657, -1.384431867820673)): shape (37, 800, 800)
      Valid pixels: 83984/640000 (13.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4514, max=316045, num_faces=316046
      Valid probs shape: (37, 83984)
    ✓ Random_25 (pose=(-1.716567188565546, -2.3706739517546915, 1.1617138106663072)): shape (37, 800, 800)
      Valid pixels: 72550/640000 (11.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=13, max=316045, num_faces=316046
      Valid probs shape: (37, 72550)
    ✓ Random_26 (pose=(1.396864379567992, -2.8830712023279474, -3.115324075189043)): shape (37, 800, 800)
      Valid pixels: 101296/640000 (15.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=2, max=316041, num_faces=316046
      Valid probs shape: (37, 101296)
    ✓ Random_27 (pose=(0.8615062499027095, -2.442793799563745, -0.9417499996730112)): shape (37, 800, 800)
      Valid pixels: 73578/640000 (11.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=371, max=316045, num_faces=316046
      Valid probs shape: (37, 73578)
    ✓ Random_28 (pose=(-2.933086371402508, -3.031594731127769, -2.3773528736514002)): shape (37, 800, 800)
      Valid pixels: 54301/640000 (8.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=316006, num_faces=316046
      Valid probs shape: (37, 54301)
    ✓ Random_29 (pose=(-0.8476759110380212, -2.578131810636657, 2.1042876422557946)): shape (37, 800, 800)
      Valid pixels: 101717/640000 (15.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=316045, num_faces=316046
      Valid probs shape: (37, 101717)
    ✓ Random_30 (pose=(2.8196254408343036, 2.563753469252549, -1.352304540115682)): shape (37, 800, 800)
      Valid pixels: 63256/640000 (9.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=2, max=315116, num_faces=316046
      Valid probs shape: (37, 63256)
    ✓ Random_31 (pose=(-0.8554964012082014, -2.47673154562085, 1.7415390314562877)): shape (37, 800, 800)
      Valid pixels: 96701/640000 (15.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=55, max=316045, num_faces=316046
      Valid probs shape: (37, 96701)
    ✓ Random_32 (pose=(-2.7763220551682966, -0.34959073711325095, -1.925153903095232)): shape (37, 800, 800)
      Valid pixels: 62825/640000 (9.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=339, max=316045, num_faces=316046
      Valid probs shape: (37, 62825)
    ✓ Random_33 (pose=(0.4444684437308779, 1.3979680421691691, -2.373382467492916)): shape (37, 800, 800)
      Valid pixels: 80135/640000 (12.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=316045, num_faces=316046
      Valid probs shape: (37, 80135)
    ✓ Random_34 (pose=(-1.3136683317245026, 2.9766165698170024, 2.052688630714136)): shape (37, 800, 800)
      Valid pixels: 92304/640000 (14.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=316045, num_faces=316046
      Valid probs shape: (37, 92304)
    ✓ Random_35 (pose=(-1.7216701469797524, -0.43386360552930725, 3.010911728344432)): shape (37, 800, 800)
      Valid pixels: 112727/640000 (17.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=316043, num_faces=316046
      Valid probs shape: (37, 112727)
    ✓ Random_36 (pose=(0.3297337802402893, -1.1083878341093132, 2.18670487085031)): shape (37, 800, 800)
      Valid pixels: 74476/640000 (11.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=316043, num_faces=316046
      Valid probs shape: (37, 74476)
    ✓ Random_37 (pose=(-2.6853821003860965, 2.454664332050571, 1.6384786531351905)): shape (37, 800, 800)
      Valid pixels: 78617/640000 (12.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=316043, num_faces=316046
      Valid probs shape: (37, 78617)
    ✓ Random_38 (pose=(-1.980480715578593, -3.0660991762301277, 2.3165545672800585)): shape (37, 800, 800)
      Valid pixels: 90245/640000 (14.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=15, max=316043, num_faces=316046
      Valid probs shape: (37, 90245)
    ✓ Random_39 (pose=(1.9718623138669145, -1.666960538518466, -2.634308440101801)): shape (37, 800, 800)
      Valid pixels: 76241/640000 (11.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=34, max=316045, num_faces=316046
      Valid probs shape: (37, 76241)
    P stats: min=0.0000, max=1.0000, mean=0.0245
    Non-zero vertices: 143130/158025
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 14895  1110  1080  3047     0  2375   955  6267  7423]
  Ground Truth Stats:
    Labels shape: (158025,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-6/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
    MRF iteration 5/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7696
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8320
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8320

  RESULTS:
  RAW:         median(top-10)=0.8903, mean(top-10)=0.8961, median(all)=0.8349, mean(all)=0.7696
  + SMOOTHING: median(top-10)=0.9271, mean(top-10)=0.9296, median(all)=0.8745, mean(all)=0.8320 [+0.0368]
  + MRF:       median(top-10)=0.9273, mean(top-10)=0.9300, median(all)=0.8747, mean(all)=0.8320 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0371

================================================================================
Subject: NKI-TRT-20-7
================================================================================
  Step 0: Generating predictions with V2 model (40 random views)...
  Mesh: 145017 vertices, 290030 faces
  Generating 40 random views...
  Generating predictions for 40 views (continuous camera pose)...
    ✓ Random_0 (pose=(0.47142390691508496, 0.027146998778774023, -0.6103838125646388)): shape (37, 800, 800)
      Valid pixels: 57531/640000 (9.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=289863, num_faces=290030
      Valid probs shape: (37, 57531)
    ✓ Random_1 (pose=(-2.2225555030696516, -0.36048608483626765, -1.622291013295884)): shape (37, 800, 800)
      Valid pixels: 61128/640000 (9.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1491, max=290014, num_faces=290030
      Valid probs shape: (37, 61128)
    ✓ Random_2 (pose=(2.6884436515625474, 1.1714904462163593, -2.5827258121344787)): shape (37, 800, 800)
      Valid pixels: 93517/640000 (14.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=375, max=290029, num_faces=290030
      Valid probs shape: (37, 93517)
    ✓ Random_3 (pose=(1.813534566361147, 1.1672293695847493, -0.07683545541355619)): shape (37, 800, 800)
      Valid pixels: 103355/640000 (16.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=289950, num_faces=290030
      Valid probs shape: (37, 103355)
    ✓ Random_4 (pose=(-2.4736229648264345, 2.783407284896991, 0.10231650067277664)): shape (37, 800, 800)
      Valid pixels: 64412/640000 (10.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=290029, num_faces=290030
      Valid probs shape: (37, 64412)
    ✓ Random_5 (pose=(-2.193875307364395, 0.4182094460926362, 0.6727182877434714)): shape (37, 800, 800)
      Valid pixels: 74099/640000 (11.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1283, max=290029, num_faces=290030
      Valid probs shape: (37, 74099)
    ✓ Random_6 (pose=(-1.3809911106130515, -0.2107714169961783, 0.9342260596214667)): shape (37, 800, 800)
      Valid pixels: 72740/640000 (11.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=290029, num_faces=290030
      Valid probs shape: (37, 72740)
    ✓ Random_7 (pose=(-0.9796536755777994, 0.6836386740103269, 1.762862429463694)): shape (37, 800, 800)
      Valid pixels: 61831/640000 (9.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=11, max=290027, num_faces=290030
      Valid probs shape: (37, 61831)
    ✓ Random_8 (pose=(-2.2305304565096264, 1.9503648322464144, 0.925200892868209)): shape (37, 800, 800)
      Valid pixels: 65070/640000 (10.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=11, max=290028, num_faces=290030
      Valid probs shape: (37, 65070)
    ✓ Random_9 (pose=(2.4358205130567567, -2.420195236212587, 0.12961966119587354)): shape (37, 800, 800)
      Valid pixels: 73316/640000 (11.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=289373, num_faces=290030
      Valid probs shape: (37, 73316)
    ✓ Random_10 (pose=(-0.4778260564818968, 1.2262065046090944, 0.7279232796035564)): shape (37, 800, 800)
      Valid pixels: 95868/640000 (15.0%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=4, max=290021, num_faces=290030
      Valid probs shape: (37, 95868)
    ✓ Random_11 (pose=(2.381701277591489, -2.4800076127950383, 0.5240263136699221)): shape (37, 800, 800)
      Valid pixels: 68740/640000 (10.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=288697, num_faces=290030
      Valid probs shape: (37, 68740)
    ✓ Random_12 (pose=(0.01901640878148081, 2.579530355569629, -1.712053819337335)): shape (37, 800, 800)
      Valid pixels: 69035/640000 (10.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1933, max=290029, num_faces=290030
      Valid probs shape: (37, 69035)
    ✓ Random_13 (pose=(-2.5641152236002576, 0.9313319159497562, 2.797394427309812)): shape (37, 800, 800)
      Valid pixels: 76439/640000 (11.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=437, max=289863, num_faces=290030
      Valid probs shape: (37, 76439)
    ✓ Random_14 (pose=(-2.5224945996076773, -2.9169481343656742, 2.28600372792637)): shape (37, 800, 800)
      Valid pixels: 54847/640000 (8.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=289959, num_faces=290030
      Valid probs shape: (37, 54847)
    ✓ Random_15 (pose=(-2.5881755293110915, 0.9522178960243988, -1.4428229510350499)): shape (37, 800, 800)
      Valid pixels: 89272/640000 (13.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=496, max=290029, num_faces=290030
      Valid probs shape: (37, 89272)
    ✓ Random_16 (pose=(0.38179896498764165, -2.068390884085784, 0.5448784863014304)): shape (37, 800, 800)
      Valid pixels: 95781/640000 (15.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=39, max=289974, num_faces=290030
      Valid probs shape: (37, 95781)
    ✓ Random_17 (pose=(2.605978004187768, 1.499454991326651, -2.8210927572760482)): shape (37, 800, 800)
      Valid pixels: 96275/640000 (15.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=12, max=290028, num_faces=290030
      Valid probs shape: (37, 96275)
    ✓ Random_18 (pose=(-3.0143500356631474, 0.5958860655087972, 2.773860854628956)): shape (37, 800, 800)
      Valid pixels: 53727/640000 (8.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2636, max=289636, num_faces=290030
      Valid probs shape: (37, 53727)
    ✓ Random_19 (pose=(1.4192871364695145, 0.8997668470729412, 0.6110042753967551)): shape (37, 800, 800)
      Valid pixels: 79545/640000 (12.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=289634, num_faces=290030
      Valid probs shape: (37, 79545)
    ✓ Random_20 (pose=(-2.758683016975901, 0.3979798993388308, 0.8581378464668488)): shape (37, 800, 800)
      Valid pixels: 58090/640000 (9.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2533, max=290029, num_faces=290030
      Valid probs shape: (37, 58090)
    ✓ Random_21 (pose=(-2.111645200101423, 2.454746145951046, 1.5893665532696168)): shape (37, 800, 800)
      Valid pixels: 71201/640000 (11.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=17, max=290028, num_faces=290030
      Valid probs shape: (37, 71201)
    ✓ Random_22 (pose=(2.400816119520485, -2.1536574265982664, 1.2511406380241192)): shape (37, 800, 800)
      Valid pixels: 80787/640000 (12.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=290004, num_faces=290030
      Valid probs shape: (37, 80787)
    ✓ Random_23 (pose=(0.39253422427033646, -0.8379520522309338, -1.8989597980575914)): shape (37, 800, 800)
      Valid pixels: 77730/640000 (12.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=4, max=290026, num_faces=290030
      Valid probs shape: (37, 77730)
    ✓ Random_24 (pose=(1.7192243570099883, 1.9898508379349602, -2.8237455213759777)): shape (37, 800, 800)
      Valid pixels: 88092/640000 (13.8%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=3, max=290029, num_faces=290030
      Valid probs shape: (37, 88092)
    ✓ Random_25 (pose=(-1.7247681075821168, 1.256307656045399, 2.1898704010658028)): shape (37, 800, 800)
      Valid pixels: 97017/640000 (15.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=290029, num_faces=290030
      Valid probs shape: (37, 97017)
    ✓ Random_26 (pose=(-2.6258614096217796, 2.6160791974186637, -1.5624880323066517)): shape (37, 800, 800)
      Valid pixels: 75665/640000 (11.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=290021, num_faces=290030
      Valid probs shape: (37, 75665)
    ✓ Random_27 (pose=(-2.0308029344639094, -2.19333592847817, -2.1538210575328813)): shape (37, 800, 800)
      Valid pixels: 81681/640000 (12.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=289634, num_faces=290030
      Valid probs shape: (37, 81681)
    ✓ Random_28 (pose=(2.272868938431577, 1.4827378469926549, 2.0947267063442814)): shape (37, 800, 800)
      Valid pixels: 67185/640000 (10.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=288703, num_faces=290030
      Valid probs shape: (37, 67185)
    ✓ Random_29 (pose=(-1.537840018355968, -2.6798545794931576, -2.883947567816045)): shape (37, 800, 800)
      Valid pixels: 93649/640000 (14.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=289949, num_faces=290030
      Valid probs shape: (37, 93649)
    ✓ Random_30 (pose=(1.4892545219810076, 2.666996814795726, 0.08369808581576654)): shape (37, 800, 800)
      Valid pixels: 97617/640000 (15.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=289949, num_faces=290030
      Valid probs shape: (37, 97617)
    ✓ Random_31 (pose=(2.8134730869097, 2.5360139775774844, 0.2839770989387529)): shape (37, 800, 800)
      Valid pixels: 65295/640000 (10.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=289961, num_faces=290030
      Valid probs shape: (37, 65295)
    ✓ Random_32 (pose=(-0.6692253709816134, 0.8181498641221681, -0.16253311771409473)): shape (37, 800, 800)
      Valid pixels: 85629/640000 (13.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=290020, num_faces=290030
      Valid probs shape: (37, 85629)
    ✓ Random_33 (pose=(-1.5918025086987837, -1.197475034264342, 0.9629084108466488)): shape (37, 800, 800)
      Valid pixels: 75727/640000 (11.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=6, max=290029, num_faces=290030
      Valid probs shape: (37, 75727)
    ✓ Random_34 (pose=(-0.13604087415637345, 1.2446325136480434, -1.3809389418142777)): shape (37, 800, 800)
      Valid pixels: 87317/640000 (13.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=289954, num_faces=290030
      Valid probs shape: (37, 87317)
    ✓ Random_35 (pose=(0.6192668129319312, -2.0061301184934623, 1.7596721306972043)): shape (37, 800, 800)
      Valid pixels: 73571/640000 (11.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=14, max=289374, num_faces=290030
      Valid probs shape: (37, 73571)
    ✓ Random_36 (pose=(-0.5629868463985415, -1.6133784613578113, 2.546592410899902)): shape (37, 800, 800)
      Valid pixels: 88775/640000 (13.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=289632, num_faces=290030
      Valid probs shape: (37, 88775)
    ✓ Random_37 (pose=(1.9106663749128776, 0.40674964437150285, 0.220375252859895)): shape (37, 800, 800)
      Valid pixels: 96096/640000 (15.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=289954, num_faces=290030
      Valid probs shape: (37, 96096)
    ✓ Random_38 (pose=(-1.4567830394892192, 0.02562292299206037, -1.0749365783564229)): shape (37, 800, 800)
      Valid pixels: 86550/640000 (13.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=290026, num_faces=290030
      Valid probs shape: (37, 86550)
    ✓ Random_39 (pose=(2.5834732519098154, 1.379137892885236, 1.000708388502197)): shape (37, 800, 800)
      Valid pixels: 100183/640000 (15.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=289954, num_faces=290030
      Valid probs shape: (37, 100183)
    P stats: min=0.0000, max=1.0000, mean=0.0255
    Non-zero vertices: 136788/145017
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 8229 1302 1108 3575    0 2185 1177 5265 6359]
  Ground Truth Stats:
    Labels shape: (145017,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-7/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7749
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8265
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8268

  RESULTS:
  RAW:         median(top-10)=0.9067, mean(top-10)=0.9096, median(all)=0.8450, mean(all)=0.7749
  + SMOOTHING: median(top-10)=0.9343, mean(top-10)=0.9326, median(all)=0.8767, mean(all)=0.8265 [+0.0276]
  + MRF:       median(top-10)=0.9343, mean(top-10)=0.9326, median(all)=0.8769, mean(all)=0.8268 [+0.0000]
  TOTAL IMPROVEMENT (median top-10): +0.0276

================================================================================
Subject: NKI-TRT-20-8
================================================================================
  Step 0: Generating predictions with V2 model (40 random views)...
  Mesh: 147404 vertices, 294804 faces
  Generating 40 random views...
  Generating predictions for 40 views (continuous camera pose)...
    ✓ Random_0 (pose=(-2.8541936088238975, -1.8936272754180017, 2.8678129511857158)): shape (37, 800, 800)
      Valid pixels: 62211/640000 (9.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=294761, num_faces=294804
      Valid probs shape: (37, 62211)
    ✓ Random_1 (pose=(-0.7784063209251038, -0.9441089530135307, -0.8791133080342131)): shape (37, 800, 800)
      Valid pixels: 84489/640000 (13.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=294258, num_faces=294804
      Valid probs shape: (37, 84489)
    ✓ Random_2 (pose=(1.635478378319437, 3.0109301499958265, -1.1084948889360353)): shape (37, 800, 800)
      Valid pixels: 80801/640000 (12.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=9, max=294779, num_faces=294804
      Valid probs shape: (37, 80801)
    ✓ Random_3 (pose=(-2.777847866941802, 2.3451207594713184, 2.014934070857942)): shape (37, 800, 800)
      Valid pixels: 80196/640000 (12.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=294764, num_faces=294804
      Valid probs shape: (37, 80196)
    ✓ Random_4 (pose=(2.7092566542520267, 0.1991322628560419, 1.70966756616854)): shape (37, 800, 800)
      Valid pixels: 50487/640000 (7.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1153, max=294802, num_faces=294804
      Valid probs shape: (37, 50487)
    ✓ Random_5 (pose=(-2.9155388445667882, 0.7729740370718092, -2.245687796836072)): shape (37, 800, 800)
      Valid pixels: 73478/640000 (11.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=18003, max=294789, num_faces=294804
      Valid probs shape: (37, 73478)
    ✓ Random_6 (pose=(2.691053065968739, 1.236103543084214, 1.773893777081529)): shape (37, 800, 800)
      Valid pixels: 74601/640000 (11.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=23, max=294762, num_faces=294804
      Valid probs shape: (37, 74601)
    ✓ Random_7 (pose=(-0.7994776926294427, 1.5752692994001132, 2.3825034373131038)): shape (37, 800, 800)
      Valid pixels: 65943/640000 (10.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=17, max=294801, num_faces=294804
      Valid probs shape: (37, 65943)
    ✓ Random_8 (pose=(3.08959781009424, -0.1716495579173558, 1.9848364590010226)): shape (37, 800, 800)
      Valid pixels: 54197/640000 (8.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7897, max=294783, num_faces=294804
      Valid probs shape: (37, 54197)
    ✓ Random_9 (pose=(1.9380186641353196, -2.7774084108041444, -1.405106008977647)): shape (37, 800, 800)
      Valid pixels: 69950/640000 (10.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=294652, num_faces=294804
      Valid probs shape: (37, 69950)
    ✓ Random_10 (pose=(2.617203366211543, 0.17837756371375724, -1.1841249153203834)): shape (37, 800, 800)
      Valid pixels: 52098/640000 (8.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1090, max=294799, num_faces=294804
      Valid probs shape: (37, 52098)
    ✓ Random_11 (pose=(2.807421483969815, 1.827551404857192, 2.6233118399186672)): shape (37, 800, 800)
      Valid pixels: 61343/640000 (9.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=293960, num_faces=294804
      Valid probs shape: (37, 61343)
    ✓ Random_12 (pose=(-2.7317430691076114, -2.26952164825173, 2.6709176995663313)): shape (37, 800, 800)
      Valid pixels: 56516/640000 (8.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=294659, num_faces=294804
      Valid probs shape: (37, 56516)
    ✓ Random_13 (pose=(1.40908088398563, -1.575639186160078, 0.16001351245367657)): shape (37, 800, 800)
      Valid pixels: 95693/640000 (15.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=294783, num_faces=294804
      Valid probs shape: (37, 95693)
    ✓ Random_14 (pose=(-2.4710750618315385, -0.26810944457032004, -1.0634330900197044)): shape (37, 800, 800)
      Valid pixels: 59372/640000 (9.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=27767, max=294782, num_faces=294804
      Valid probs shape: (37, 59372)
    ✓ Random_15 (pose=(2.2194846391432446, -1.6610154426561134, -0.9918257949633675)): shape (37, 800, 800)
      Valid pixels: 98042/640000 (15.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=294792, num_faces=294804
      Valid probs shape: (37, 98042)
    ✓ Random_16 (pose=(-0.632547225735717, -1.2197767475879178, -1.6507555866624872)): shape (37, 800, 800)
      Valid pixels: 87988/640000 (13.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=293720, num_faces=294804
      Valid probs shape: (37, 87988)
    ✓ Random_17 (pose=(-1.6976400164614873, 2.331258105078353, -1.8358884426782411)): shape (37, 800, 800)
      Valid pixels: 61508/640000 (9.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=293960, num_faces=294804
      Valid probs shape: (37, 61508)
    ✓ Random_18 (pose=(1.2690873968236422, 1.4496525929836315, -0.6518464909926385)): shape (37, 800, 800)
      Valid pixels: 98068/640000 (15.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=8, max=294795, num_faces=294804
      Valid probs shape: (37, 98068)
    ✓ Random_19 (pose=(2.802034932408482, -0.6977124202198874, 0.37428695855312855)): shape (37, 800, 800)
      Valid pixels: 55356/640000 (8.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7032, max=294785, num_faces=294804
      Valid probs shape: (37, 55356)
    ✓ Random_20 (pose=(-1.0236782422857797, 2.9656577565913684, -2.4261598847527885)): shape (37, 800, 800)
      Valid pixels: 71205/640000 (11.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=19, max=294800, num_faces=294804
      Valid probs shape: (37, 71205)
    ✓ Random_21 (pose=(1.5268145224342282, -1.1205816988398891, 1.0383291307366056)): shape (37, 800, 800)
      Valid pixels: 70458/640000 (11.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=294726, num_faces=294804
      Valid probs shape: (37, 70458)
    ✓ Random_22 (pose=(0.5339522819989861, 1.8689801175286282, -1.0347625223123371)): shape (37, 800, 800)
      Valid pixels: 91359/640000 (14.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=13, max=294740, num_faces=294804
      Valid probs shape: (37, 91359)
    ✓ Random_23 (pose=(1.4525047729981528, -2.892429448262318, 2.6979875125221264)): shape (37, 800, 800)
      Valid pixels: 93098/640000 (14.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=294573, num_faces=294804
      Valid probs shape: (37, 93098)
    ✓ Random_24 (pose=(1.487691859581398, -1.8803614778970559, -1.9553206434984571)): shape (37, 800, 800)
      Valid pixels: 69029/640000 (10.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=15, max=294803, num_faces=294804
      Valid probs shape: (37, 69029)
    ✓ Random_25 (pose=(-0.12069910275556284, -2.5495347369052217, -1.046669508749388)): shape (37, 800, 800)
      Valid pixels: 70056/640000 (10.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=15437, max=294797, num_faces=294804
      Valid probs shape: (37, 70056)
    ✓ Random_26 (pose=(2.19586429196469, -0.9632501971656113, 0.978282065830995)): shape (37, 800, 800)
      Valid pixels: 58623/640000 (9.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3132, max=293192, num_faces=294804
      Valid probs shape: (37, 58623)
    ✓ Random_27 (pose=(-0.27033929498707066, 1.3966795009061093, -0.01918476747410791)): shape (37, 800, 800)
      Valid pixels: 70611/640000 (11.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=293207, num_faces=294804
      Valid probs shape: (37, 70611)
    ✓ Random_28 (pose=(1.661727856654986, -0.4017957302452215, 2.631641845006971)): shape (37, 800, 800)
      Valid pixels: 93259/640000 (14.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=19, max=294573, num_faces=294804
      Valid probs shape: (37, 93259)
    ✓ Random_29 (pose=(1.1353972176718568, 1.3256100675158091, 0.022756319940822944)): shape (37, 800, 800)
      Valid pixels: 83661/640000 (13.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=294787, num_faces=294804
      Valid probs shape: (37, 83661)
    ✓ Random_30 (pose=(1.9662239323614008, -0.48478848407854525, 0.539441609041936)): shape (37, 800, 800)
      Valid pixels: 73009/640000 (11.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=294762, num_faces=294804
      Valid probs shape: (37, 73009)
    ✓ Random_31 (pose=(-0.25091148022240173, 1.229958978204312, 2.2873629868394216)): shape (37, 800, 800)
      Valid pixels: 66788/640000 (10.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=294756, num_faces=294804
      Valid probs shape: (37, 66788)
    ✓ Random_32 (pose=(-2.3422595571875657, 2.1895883451670777, -1.7706289048187946)): shape (37, 800, 800)
      Valid pixels: 76068/640000 (11.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=293142, num_faces=294804
      Valid probs shape: (37, 76068)
    ✓ Random_33 (pose=(-1.5394080735425837, -1.8136035844078244, -1.7145358929801235)): shape (37, 800, 800)
      Valid pixels: 60535/640000 (9.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=11, max=293208, num_faces=294804
      Valid probs shape: (37, 60535)
    ✓ Random_34 (pose=(0.02335562862540952, 1.5545304859017133, -1.0161136033825682)): shape (37, 800, 800)
      Valid pixels: 81052/640000 (12.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=294763, num_faces=294804
      Valid probs shape: (37, 81052)
    ✓ Random_35 (pose=(-1.246944204786626, -0.633212023946998, -0.6826990533415045)): shape (37, 800, 800)
      Valid pixels: 90458/640000 (14.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=15, max=294288, num_faces=294804
      Valid probs shape: (37, 90458)
    ✓ Random_36 (pose=(-2.407328725707372, -2.446852597767386, -3.0435663941461732)): shape (37, 800, 800)
      Valid pixels: 83006/640000 (13.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=294723, num_faces=294804
      Valid probs shape: (37, 83006)
    ✓ Random_37 (pose=(-2.5836079460557047, 2.2577251003019683, -2.1154616379073405)): shape (37, 800, 800)
      Valid pixels: 68613/640000 (10.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=293127, num_faces=294804
      Valid probs shape: (37, 68613)
    ✓ Random_38 (pose=(2.207007216404489, -0.3676662302021798, 0.8099623802419735)): shape (37, 800, 800)
      Valid pixels: 63814/640000 (10.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1804, max=294790, num_faces=294804
      Valid probs shape: (37, 63814)
    ✓ Random_39 (pose=(-1.5038711743381528, -0.06487976705037601, -2.798819478385125)): shape (37, 800, 800)
      Valid pixels: 86863/640000 (13.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=294748, num_faces=294804
      Valid probs shape: (37, 86863)
    P stats: min=0.0000, max=1.0000, mean=0.0248
    Non-zero vertices: 135300/147404
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 12104  1463   845  3063     0  2587  1347  5003  6466]
  Ground Truth Stats:
    Labels shape: (147404,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-8/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7367
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7899
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7901

  RESULTS:
  RAW:         median(top-10)=0.8875, mean(top-10)=0.8942, median(all)=0.8037, mean(all)=0.7367
  + SMOOTHING: median(top-10)=0.9069, mean(top-10)=0.9139, median(all)=0.8236, mean(all)=0.7899 [+0.0194]
  + MRF:       median(top-10)=0.9071, mean(top-10)=0.9142, median(all)=0.8241, mean(all)=0.7901 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0196

================================================================================
Subject: NKI-TRT-20-9
================================================================================
  Step 0: Generating predictions with V2 model (40 random views)...
  Mesh: 141802 vertices, 283600 faces
  Generating 40 random views...
  Generating predictions for 40 views (continuous camera pose)...
    ✓ Random_0 (pose=(-1.3001242416015244, -1.432957647112649, 1.2403441007840819)): shape (37, 800, 800)
      Valid pixels: 64003/640000 (10.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=179, max=283596, num_faces=283600
      Valid probs shape: (37, 64003)
    ✓ Random_1 (pose=(1.89583239904952, -0.3339126968137922, -1.4198858238706218)): shape (37, 800, 800)
      Valid pixels: 74525/640000 (11.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=112, max=283593, num_faces=283600
      Valid probs shape: (37, 74525)
    ✓ Random_2 (pose=(1.5681921280826954, 1.7728184042231074, 0.30738813976745494)): shape (37, 800, 800)
      Valid pixels: 97755/640000 (15.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=20, max=283563, num_faces=283600
      Valid probs shape: (37, 97755)
    ✓ Random_3 (pose=(-1.9391403738938655, -2.102569831263993, -0.8717006996431218)): shape (37, 800, 800)
      Valid pixels: 80016/640000 (12.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=283589, num_faces=283600
      Valid probs shape: (37, 80016)
    ✓ Random_4 (pose=(-1.5725483209102593, 1.2248402371507794, -0.7353434550434459)): shape (37, 800, 800)
      Valid pixels: 99954/640000 (15.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=12, max=283589, num_faces=283600
      Valid probs shape: (37, 99954)
    ✓ Random_5 (pose=(-2.0428487849355825, -2.7901608574227943, 0.13162589496192245)): shape (37, 800, 800)
      Valid pixels: 93850/640000 (14.7%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=1, max=283590, num_faces=283600
      Valid probs shape: (37, 93850)
    ✓ Random_6 (pose=(-2.0217785967415915, 1.3262987807872886, 3.049836683034987)): shape (37, 800, 800)
      Valid pixels: 96144/640000 (15.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=84, max=283563, num_faces=283600
      Valid probs shape: (37, 96144)
    ✓ Random_7 (pose=(1.3259093283658663, -0.011491344249352053, 0.6620982801712718)): shape (37, 800, 800)
      Valid pixels: 81624/640000 (12.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6, max=283563, num_faces=283600
      Valid probs shape: (37, 81624)
    ✓ Random_8 (pose=(-2.0460733565965077, -2.653337227146146, -0.1872998827695227)): shape (37, 800, 800)
      Valid pixels: 98467/640000 (15.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=283589, num_faces=283600
      Valid probs shape: (37, 98467)
    ✓ Random_9 (pose=(-1.2190546282889094, 2.7150417386896413, 2.2947927353219493)): shape (37, 800, 800)
      Valid pixels: 90799/640000 (14.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=84, max=283511, num_faces=283600
      Valid probs shape: (37, 90799)
    ✓ Random_10 (pose=(2.286667174261802, -3.1315722510399846, 0.22011565545279188)): shape (37, 800, 800)
      Valid pixels: 80915/640000 (12.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=283357, num_faces=283600
      Valid probs shape: (37, 80915)
    ✓ Random_11 (pose=(-1.9855190375065785, 0.7952443253900157, -0.814301337487287)): shape (37, 800, 800)
      Valid pixels: 101009/640000 (15.8%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=102, max=283592, num_faces=283600
      Valid probs shape: (37, 101009)
    ✓ Random_12 (pose=(2.184826203219761, 2.8495578941730733, -2.3284706699147404)): shape (37, 800, 800)
      Valid pixels: 72305/640000 (11.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=283593, num_faces=283600
      Valid probs shape: (37, 72305)
    ✓ Random_13 (pose=(-0.5629527651666995, 0.9121811212400512, 1.4004231471863768)): shape (37, 800, 800)
      Valid pixels: 76123/640000 (11.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=283596, num_faces=283600
      Valid probs shape: (37, 76123)
    ✓ Random_14 (pose=(-1.03050169077863, -2.5090944337629115, -2.487442022837689)): shape (37, 800, 800)
      Valid pixels: 69124/640000 (10.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=858, max=283569, num_faces=283600
      Valid probs shape: (37, 69124)
    ✓ Random_15 (pose=(-2.7351408992788038, -0.1998421697922792, 1.7776680443751953)): shape (37, 800, 800)
      Valid pixels: 50175/640000 (7.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1211, max=283593, num_faces=283600
      Valid probs shape: (37, 50175)
    ✓ Random_16 (pose=(-1.4705092409105063, 2.433445776210485, 1.8531025728266721)): shape (37, 800, 800)
      Valid pixels: 73135/640000 (11.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=88, max=283593, num_faces=283600
      Valid probs shape: (37, 73135)
    ✓ Random_17 (pose=(-1.3685198699296355, -2.3178711285473725, -0.5626271883279865)): shape (37, 800, 800)
      Valid pixels: 104120/640000 (16.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=283592, num_faces=283600
      Valid probs shape: (37, 104120)
    ✓ Random_18 (pose=(-2.9185785893841163, 2.2582976857014243, -0.5360140821511927)): shape (37, 800, 800)
      Valid pixels: 66690/640000 (10.4%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=1, max=283599, num_faces=283600
      Valid probs shape: (37, 66690)
    ✓ Random_19 (pose=(0.9247992824141003, 1.2121610366058233, 1.502239627446139)): shape (37, 800, 800)
      Valid pixels: 88631/640000 (13.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=283589, num_faces=283600
      Valid probs shape: (37, 88631)
    ✓ Random_20 (pose=(2.4970435841729666, 1.4075498899656438, 1.4226652751228368)): shape (37, 800, 800)
      Valid pixels: 89782/640000 (14.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=20, max=283563, num_faces=283600
      Valid probs shape: (37, 89782)
    ✓ Random_21 (pose=(0.5187486636100669, 1.6844601997069102, 0.09877506632001598)): shape (37, 800, 800)
      Valid pixels: 66865/640000 (10.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=291, max=283568, num_faces=283600
      Valid probs shape: (37, 66865)
    ✓ Random_22 (pose=(-2.683031977395367, -2.7792546221694323, 0.7788508922667061)): shape (37, 800, 800)
      Valid pixels: 67888/640000 (10.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=0, max=283599, num_faces=283600
      Valid probs shape: (37, 67888)
    ✓ Random_23 (pose=(2.0676769057456648, 0.3859468675484776, 1.8222080413515194)): shape (37, 800, 800)
      Valid pixels: 58520/640000 (9.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6190, max=283588, num_faces=283600
      Valid probs shape: (37, 58520)
    ✓ Random_24 (pose=(-1.3788098390843606, -1.036485925494432, 1.0825315379703984)): shape (37, 800, 800)
      Valid pixels: 66469/640000 (10.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=178, max=283594, num_faces=283600
      Valid probs shape: (37, 66469)
    ✓ Random_25 (pose=(-1.3308569152267231, -1.8723063773329818, -1.5998637509330733)): shape (37, 800, 800)
      Valid pixels: 69239/640000 (10.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=31, max=283565, num_faces=283600
      Valid probs shape: (37, 69239)
    ✓ Random_26 (pose=(0.8072474367338214, 2.5377817892863037, 0.8144066330670623)): shape (37, 800, 800)
      Valid pixels: 59197/640000 (9.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1388, max=283565, num_faces=283600
      Valid probs shape: (37, 59197)
    ✓ Random_27 (pose=(-1.0207984775758394, 1.6663687421980322, 1.6258689623203066)): shape (37, 800, 800)
      Valid pixels: 70127/640000 (11.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=222, max=283597, num_faces=283600
      Valid probs shape: (37, 70127)
    ✓ Random_28 (pose=(0.6085038965768685, 2.280618565771115, -2.9703344958079296)): shape (37, 800, 800)
      Valid pixels: 68805/640000 (10.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=683, max=283598, num_faces=283600
      Valid probs shape: (37, 68805)
    ✓ Random_29 (pose=(-0.15165213376816933, 1.2275661479998101, 2.7308988557226908)): shape (37, 800, 800)
      Valid pixels: 61862/640000 (9.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=283593, num_faces=283600
      Valid probs shape: (37, 61862)
    ✓ Random_30 (pose=(2.465767086477184, -2.6459393508510396, -2.1812577834499542)): shape (37, 800, 800)
      Valid pixels: 53628/640000 (8.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=283513, num_faces=283600
      Valid probs shape: (37, 53628)
    ✓ Random_31 (pose=(2.3563494437088233, -0.0866526220141779, 0.19200852091926368)): shape (37, 800, 800)
      Valid pixels: 77076/640000 (12.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=615, max=283567, num_faces=283600
      Valid probs shape: (37, 77076)
    ✓ Random_32 (pose=(0.8693852676546694, -1.6952062777716097, -3.083912573984482)): shape (37, 800, 800)
      Valid pixels: 101633/640000 (15.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8, max=283589, num_faces=283600
      Valid probs shape: (37, 101633)
    ✓ Random_33 (pose=(-0.18321447295544635, -2.7416579393999436, -2.4543231754762935)): shape (37, 800, 800)
      Valid pixels: 52484/640000 (8.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=51596, max=283589, num_faces=283600
      Valid probs shape: (37, 52484)
    ✓ Random_34 (pose=(2.828488394098205, -2.5297027150991545, -1.270077883166562)): shape (37, 800, 800)
      Valid pixels: 75243/640000 (11.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=283414, num_faces=283600
      Valid probs shape: (37, 75243)
    ✓ Random_35 (pose=(0.2527237471793513, -1.6806630141796024, -3.1292538542616493)): shape (37, 800, 800)
      Valid pixels: 73057/640000 (11.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=31, max=283581, num_faces=283600
      Valid probs shape: (37, 73057)
    ✓ Random_36 (pose=(-1.9166165812297031, -0.14979477474579772, -0.38094579880439783)): shape (37, 800, 800)
      Valid pixels: 100344/640000 (15.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=104, max=283592, num_faces=283600
      Valid probs shape: (37, 100344)
    ✓ Random_37 (pose=(-0.8044223383565705, 1.4256595094825348, -0.7504158818571383)): shape (37, 800, 800)
      Valid pixels: 61645/640000 (9.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=9, max=283579, num_faces=283600
      Valid probs shape: (37, 61645)
    ✓ Random_38 (pose=(-2.2873498311050966, -0.7295623054634293, 1.3732714456472221)): shape (37, 800, 800)
      Valid pixels: 72877/640000 (11.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1221, max=283598, num_faces=283600
      Valid probs shape: (37, 72877)
    ✓ Random_39 (pose=(-0.49181925602289134, 2.5006074624547034, -2.289124273515415)): shape (37, 800, 800)
      Valid pixels: 81285/640000 (12.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=578, max=283554, num_faces=283600
      Valid probs shape: (37, 81285)
    P stats: min=0.0000, max=0.9999, mean=0.0255
    Non-zero vertices: 133932/141802
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 7870 1418  917 3153    0 2283 1149 5055 7369]
  Ground Truth Stats:
    Labels shape: (141802,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-9/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7604
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8074
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8072

  RESULTS:
  RAW:         median(top-10)=0.9047, mean(top-10)=0.9070, median(all)=0.8228, mean(all)=0.7604
  + SMOOTHING: median(top-10)=0.9252, mean(top-10)=0.9217, median(all)=0.8553, mean(all)=0.8074 [+0.0205]
  + MRF:       median(top-10)=0.9257, mean(top-10)=0.9218, median(all)=0.8555, mean(all)=0.8072 [+0.0005]
  TOTAL IMPROVEMENT (median top-10): +0.0211

================================================================================
Subject: OASIS-TRT-20-1
================================================================================
  Step 0: Generating predictions with V2 model (40 random views)...
  Mesh: 149052 vertices, 298100 faces
  Generating 40 random views...
  Generating predictions for 40 views (continuous camera pose)...
    ✓ Random_0 (pose=(-2.241267772875571, -0.7183686582827091, -0.3572259850363455)): shape (37, 800, 800)
      Valid pixels: 77572/640000 (12.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=175, max=298098, num_faces=298100
      Valid probs shape: (37, 77572)
    ✓ Random_1 (pose=(1.6849877695824054, -1.3703328857470358, 1.7824035841390522)): shape (37, 800, 800)
      Valid pixels: 69609/640000 (10.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=298098, num_faces=298100
      Valid probs shape: (37, 69609)
    ✓ Random_2 (pose=(0.3475609005296709, 1.4338997839711656, -2.0080213384421546)): shape (37, 800, 800)
      Valid pixels: 85023/640000 (13.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=298087, num_faces=298100
      Valid probs shape: (37, 85023)
    ✓ Random_3 (pose=(2.4754565811594897, 0.4819895984856637, -1.474477461297293)): shape (37, 800, 800)
      Valid pixels: 49108/640000 (7.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=795, max=298093, num_faces=298100
      Valid probs shape: (37, 49108)
    ✓ Random_4 (pose=(2.3492560169416716, -3.034297134867301, -0.5905640089804622)): shape (37, 800, 800)
      Valid pixels: 69598/640000 (10.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=298099, num_faces=298100
      Valid probs shape: (37, 69598)
    ✓ Random_5 (pose=(1.696873114069378, -2.067747979690731, 1.8730481163620913)): shape (37, 800, 800)
      Valid pixels: 72734/640000 (11.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=298098, num_faces=298100
      Valid probs shape: (37, 72734)
    ✓ Random_6 (pose=(-0.7839053936392597, 2.476888093988051, 1.0893420285744755)): shape (37, 800, 800)
      Valid pixels: 62310/640000 (9.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=390, max=298095, num_faces=298100
      Valid probs shape: (37, 62310)
    ✓ Random_7 (pose=(-0.8682249645125695, 2.843369116750104, 0.07127025140260157)): shape (37, 800, 800)
      Valid pixels: 73605/640000 (11.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2175, max=298098, num_faces=298100
      Valid probs shape: (37, 73605)
    ✓ Random_8 (pose=(-2.0335538063425487, 3.1114203698773037, 0.6077592034934391)): shape (37, 800, 800)
      Valid pixels: 58898/640000 (9.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=297995, num_faces=298100
      Valid probs shape: (37, 58898)
    ✓ Random_9 (pose=(2.34305840886526, -0.909127423892274, 1.5740236229077489)): shape (37, 800, 800)
      Valid pixels: 77360/640000 (12.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=174, max=298098, num_faces=298100
      Valid probs shape: (37, 77360)
    ✓ Random_10 (pose=(0.047060428745570704, 1.7484318351498924, 1.5942487878954807)): shape (37, 800, 800)
      Valid pixels: 78986/640000 (12.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=9, max=298096, num_faces=298100
      Valid probs shape: (37, 78986)
    ✓ Random_11 (pose=(-0.7669404866340401, -0.3054795123631333, 2.770478192981683)): shape (37, 800, 800)
      Valid pixels: 67384/640000 (10.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=297918, num_faces=298100
      Valid probs shape: (37, 67384)
    ✓ Random_12 (pose=(-2.1326360757604244, -1.8107905908878903, 1.682114808832858)): shape (37, 800, 800)
      Valid pixels: 58704/640000 (9.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=297997, num_faces=298100
      Valid probs shape: (37, 58704)
    ✓ Random_13 (pose=(-0.748450151574199, -3.083003561579582, 2.1668189467072407)): shape (37, 800, 800)
      Valid pixels: 58756/640000 (9.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=523, max=298099, num_faces=298100
      Valid probs shape: (37, 58756)
    ✓ Random_14 (pose=(2.2027539139157284, 2.5601396962137386, 2.520782522094687)): shape (37, 800, 800)
      Valid pixels: 69297/640000 (10.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6, max=298098, num_faces=298100
      Valid probs shape: (37, 69297)
    ✓ Random_15 (pose=(2.3117564240437964, 1.8957192794449673, -1.267123561759687)): shape (37, 800, 800)
      Valid pixels: 57774/640000 (9.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=11, max=297997, num_faces=298100
      Valid probs shape: (37, 57774)
    ✓ Random_16 (pose=(-0.4502457736074188, 2.1781784616822844, -0.31876046812269276)): shape (37, 800, 800)
      Valid pixels: 61333/640000 (9.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=433, max=298098, num_faces=298100
      Valid probs shape: (37, 61333)
    ✓ Random_17 (pose=(1.3765266832878318, -2.4953239790771904, -2.39679505567996)): shape (37, 800, 800)
      Valid pixels: 64438/640000 (10.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=23, max=298095, num_faces=298100
      Valid probs shape: (37, 64438)
    ✓ Random_18 (pose=(-0.880849271898211, -1.9331066594033266, -2.1632774315570806)): shape (37, 800, 800)
      Valid pixels: 57710/640000 (9.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=66, max=298098, num_faces=298100
      Valid probs shape: (37, 57710)
    ✓ Random_19 (pose=(-1.2782240344215734, 3.03186519961998, 1.4767300128364447)): shape (37, 800, 800)
      Valid pixels: 55639/640000 (8.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6, max=298091, num_faces=298100
      Valid probs shape: (37, 55639)
    ✓ Random_20 (pose=(-2.305745966340199, -0.6707748962032944, -0.43600130526592507)): shape (37, 800, 800)
      Valid pixels: 73768/640000 (11.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=418, max=298098, num_faces=298100
      Valid probs shape: (37, 73768)
    ✓ Random_21 (pose=(-2.8715845488294467, -2.482148638116862, 1.7245955030550908)): shape (37, 800, 800)
      Valid pixels: 50583/640000 (7.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=297984, num_faces=298100
      Valid probs shape: (37, 50583)
    ✓ Random_22 (pose=(-1.1888556633840524, -3.0066274609478127, -1.5463806152319315)): shape (37, 800, 800)
      Valid pixels: 57550/640000 (9.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=421, max=298098, num_faces=298100
      Valid probs shape: (37, 57550)
    ✓ Random_23 (pose=(-1.813079259251149, -1.4433754099624083, -0.9759951929730915)): shape (37, 800, 800)
      Valid pixels: 70924/640000 (11.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=298098, num_faces=298100
      Valid probs shape: (37, 70924)
    ✓ Random_24 (pose=(2.0573181544551398, -3.0490316758725755, -1.6879383577425917)): shape (37, 800, 800)
      Valid pixels: 53904/640000 (8.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=297997, num_faces=298100
      Valid probs shape: (37, 53904)
    ✓ Random_25 (pose=(-2.2053658059613417, 3.0878893901496873, -1.8763629082347473)): shape (37, 800, 800)
      Valid pixels: 47565/640000 (7.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=298039, num_faces=298100
      Valid probs shape: (37, 47565)
    ✓ Random_26 (pose=(0.29838161471995805, 2.3209831097371953, 1.6140374990301822)): shape (37, 800, 800)
      Valid pixels: 73604/640000 (11.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3751, max=298098, num_faces=298100
      Valid probs shape: (37, 73604)
    ✓ Random_27 (pose=(0.5360422238415574, 1.2363784000201719, 1.2317518269613599)): shape (37, 800, 800)
      Valid pixels: 77644/640000 (12.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6, max=298098, num_faces=298100
      Valid probs shape: (37, 77644)
    ✓ Random_28 (pose=(2.4338435443767708, -1.1193187814008598, 2.03891994013511)): shape (37, 800, 800)
      Valid pixels: 81889/640000 (12.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=173, max=298098, num_faces=298100
      Valid probs shape: (37, 81889)
    ✓ Random_29 (pose=(-2.9867276017417805, -0.2392509731858179, 0.8462798734334265)): shape (37, 800, 800)
      Valid pixels: 48957/640000 (7.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=64891, max=298096, num_faces=298100
      Valid probs shape: (37, 48957)
    ✓ Random_30 (pose=(1.3354956300603114, -0.23225658861451492, 0.44722873708604816)): shape (37, 800, 800)
      Valid pixels: 70807/640000 (11.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=298099, num_faces=298100
      Valid probs shape: (37, 70807)
    ✓ Random_31 (pose=(-2.6227096674823693, -2.9277826599111965, -1.6415323078171673)): shape (37, 800, 800)
      Valid pixels: 41810/640000 (6.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=297457, num_faces=298100
      Valid probs shape: (37, 41810)
    ✓ Random_32 (pose=(-0.016279834815912775, -2.3620871848346585, 0.311423237345537)): shape (37, 800, 800)
      Valid pixels: 51648/640000 (8.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=801, max=298093, num_faces=298100
      Valid probs shape: (37, 51648)
    ✓ Random_33 (pose=(0.051045444501939485, 1.4533193339938677, -0.16333412353364007)): shape (37, 800, 800)
      Valid pixels: 52979/640000 (8.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=298098, num_faces=298100
      Valid probs shape: (37, 52979)
    ✓ Random_34 (pose=(-3.141288100531142, 1.7057451434611792, -0.897436480189497)): shape (37, 800, 800)
      Valid pixels: 62634/640000 (9.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8, max=297995, num_faces=298100
      Valid probs shape: (37, 62634)
    ✓ Random_35 (pose=(0.8983432105132234, -2.8855131148291893, 1.9575164426976386)): shape (37, 800, 800)
      Valid pixels: 58024/640000 (9.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=11684, max=298098, num_faces=298100
      Valid probs shape: (37, 58024)
    ✓ Random_36 (pose=(-2.845439584033427, 1.9250715892905248, 2.0708225439825636)): shape (37, 800, 800)
      Valid pixels: 74822/640000 (11.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7, max=298099, num_faces=298100
      Valid probs shape: (37, 74822)
    ✓ Random_37 (pose=(2.909443030627318, -1.24750153449294, 1.2511949969584366)): shape (37, 800, 800)
      Valid pixels: 82999/640000 (13.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=39, max=298098, num_faces=298100
      Valid probs shape: (37, 82999)
    ✓ Random_38 (pose=(-1.8333362987894462, 2.211380190424701, 0.8673796850475597)): shape (37, 800, 800)
      Valid pixels: 58924/640000 (9.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=12, max=297997, num_faces=298100
      Valid probs shape: (37, 58924)
    ✓ Random_39 (pose=(-1.4222177606431738, -1.842586983253426, -2.299245758182536)): shape (37, 800, 800)
      Valid pixels: 59288/640000 (9.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=298099, num_faces=298100
      Valid probs shape: (37, 59288)
    P stats: min=0.0000, max=0.9999, mean=0.0258
    Non-zero vertices: 142512/149052
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 6540 1405 1231 4074    0 2243  879 4929 6490]
  Ground Truth Stats:
    Labels shape: (149052,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-1/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7690
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8194
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8198

  RESULTS:
  RAW:         median(top-10)=0.9076, mean(top-10)=0.9113, median(all)=0.8436, mean(all)=0.7690
  + SMOOTHING: median(top-10)=0.9305, mean(top-10)=0.9285, median(all)=0.8648, mean(all)=0.8194 [+0.0229]
  + MRF:       median(top-10)=0.9307, mean(top-10)=0.9287, median(all)=0.8650, mean(all)=0.8198 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0231

================================================================================
Subject: OASIS-TRT-20-10
================================================================================
  Step 0: Generating predictions with V2 model (40 random views)...
  Mesh: 129540 vertices, 259076 faces
  Generating 40 random views...
  Generating predictions for 40 views (continuous camera pose)...
    ✓ Random_0 (pose=(-1.0667840589352373, 2.6204619869335968, -0.34569791246236115)): shape (37, 800, 800)
      Valid pixels: 83966/640000 (13.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=815, max=259075, num_faces=259076
      Valid probs shape: (37, 83966)
    ✓ Random_1 (pose=(-0.40986290756690025, -2.4098598163521316, -1.4935770304974483)): shape (37, 800, 800)
      Valid pixels: 77011/640000 (12.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8925, max=259072, num_faces=259076
      Valid probs shape: (37, 77011)
    ✓ Random_2 (pose=(-2.307519119076898, 0.366148928010507, 2.0863260216896897)): shape (37, 800, 800)
      Valid pixels: 67159/640000 (10.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=259075, num_faces=259076
      Valid probs shape: (37, 67159)
    ✓ Random_3 (pose=(2.8845742991535213, 1.9584132161077932, -0.17023425940569004)): shape (37, 800, 800)
      Valid pixels: 61532/640000 (9.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=258999, num_faces=259076
      Valid probs shape: (37, 61532)
    ✓ Random_4 (pose=(-1.0392902504186483, -2.5093843781064873, -0.2265648407258376)): shape (37, 800, 800)
      Valid pixels: 78274/640000 (12.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=443, max=259075, num_faces=259076
      Valid probs shape: (37, 78274)
    ✓ Random_5 (pose=(0.7644382260666642, -0.11460022183816632, -1.0959280681730164)): shape (37, 800, 800)
      Valid pixels: 59144/640000 (9.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=258993, num_faces=259076
      Valid probs shape: (37, 59144)
    ✓ Random_6 (pose=(2.7917001377774, -0.32296899427391335, 2.477154873985783)): shape (37, 800, 800)
      Valid pixels: 61937/640000 (9.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=27128, max=259075, num_faces=259076
      Valid probs shape: (37, 61937)
    ✓ Random_7 (pose=(1.9804499453040378, 2.1741923479241088, 1.8799663533003486)): shape (37, 800, 800)
      Valid pixels: 53905/640000 (8.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=259071, num_faces=259076
      Valid probs shape: (37, 53905)
    ✓ Random_8 (pose=(-1.340691348362062, -0.46761852764948353, -0.8941682184040154)): shape (37, 800, 800)
      Valid pixels: 80580/640000 (12.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=259074, num_faces=259076
      Valid probs shape: (37, 80580)
    ✓ Random_9 (pose=(2.4991392444813716, -2.316330377591038, -2.5848213334874925)): shape (37, 800, 800)
      Valid pixels: 57380/640000 (9.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=258997, num_faces=259076
      Valid probs shape: (37, 57380)
    ✓ Random_10 (pose=(3.0534995836647596, 2.5224113185451014, 2.6100072404636547)): shape (37, 800, 800)
      Valid pixels: 46482/640000 (7.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=258998, num_faces=259076
      Valid probs shape: (37, 46482)
    ✓ Random_11 (pose=(0.3697405235415938, -2.0566226470509843, 2.2833774692077267)): shape (37, 800, 800)
      Valid pixels: 59520/640000 (9.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=259074, num_faces=259076
      Valid probs shape: (37, 59520)
    ✓ Random_12 (pose=(-3.0062222580303373, -1.3189402398939927, -1.948039634684409)): shape (37, 800, 800)
      Valid pixels: 85950/640000 (13.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6, max=259071, num_faces=259076
      Valid probs shape: (37, 85950)
    ✓ Random_13 (pose=(-2.2895127876544175, 2.6384990314721737, -1.8921699202755144)): shape (37, 800, 800)
      Valid pixels: 50940/640000 (8.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=253658, num_faces=259076
      Valid probs shape: (37, 50940)
    ✓ Random_14 (pose=(-1.674353619162088, -2.2539688594794605, 1.2081007171510505)): shape (37, 800, 800)
      Valid pixels: 62289/640000 (9.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=259066, num_faces=259076
      Valid probs shape: (37, 62289)
    ✓ Random_15 (pose=(2.265870650198159, -0.5669322438073672, 1.6531950146923862)): shape (37, 800, 800)
      Valid pixels: 72771/640000 (11.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=884, max=259075, num_faces=259076
      Valid probs shape: (37, 72771)
    ✓ Random_16 (pose=(0.5882493574739867, -1.61992830924615, -2.9743478250397906)): shape (37, 800, 800)
      Valid pixels: 82993/640000 (13.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=12, max=259075, num_faces=259076
      Valid probs shape: (37, 82993)
    ✓ Random_17 (pose=(-2.6166186715091277, 1.363751473809251, -2.263133498501141)): shape (37, 800, 800)
      Valid pixels: 71345/640000 (11.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=62, max=259074, num_faces=259076
      Valid probs shape: (37, 71345)
    ✓ Random_18 (pose=(-1.6685113733014163, 1.3245905532626683, 0.1292463983328549)): shape (37, 800, 800)
      Valid pixels: 75355/640000 (11.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=64, max=259075, num_faces=259076
      Valid probs shape: (37, 75355)
    ✓ Random_19 (pose=(1.1882789189085976, -2.1417486519932347, 1.8820278934732944)): shape (37, 800, 800)
      Valid pixels: 56246/640000 (8.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=67, max=259075, num_faces=259076
      Valid probs shape: (37, 56246)
    ✓ Random_20 (pose=(2.7204667107175116, 1.5638480403266897, 1.6374899461531633)): shape (37, 800, 800)
      Valid pixels: 74574/640000 (11.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=259072, num_faces=259076
      Valid probs shape: (37, 74574)
    ✓ Random_21 (pose=(-1.862838388507449, 1.0918103505069485, 2.339795259212049)): shape (37, 800, 800)
      Valid pixels: 88951/640000 (13.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=259071, num_faces=259076
      Valid probs shape: (37, 88951)
    ✓ Random_22 (pose=(-0.6673562888060198, 2.203217041498939, 1.0914522082135827)): shape (37, 800, 800)
      Valid pixels: 73237/640000 (11.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=820, max=259070, num_faces=259076
      Valid probs shape: (37, 73237)
    ✓ Random_23 (pose=(2.344102694016674, -0.30795083308474336, 2.6634461325253005)): shape (37, 800, 800)
      Valid pixels: 76139/640000 (11.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4757, max=259071, num_faces=259076
      Valid probs shape: (37, 76139)
    ✓ Random_24 (pose=(0.341912795423724, -1.024846258069302, 1.3380849214729844)): shape (37, 800, 800)
      Valid pixels: 76777/640000 (12.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=259074, num_faces=259076
      Valid probs shape: (37, 76777)
    ✓ Random_25 (pose=(-0.9396781841805715, -1.909709816897316, 1.2418801338225363)): shape (37, 800, 800)
      Valid pixels: 66469/640000 (10.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=10, max=259072, num_faces=259076
      Valid probs shape: (37, 66469)
    ✓ Random_26 (pose=(-3.0878107348579955, -3.067479042459553, -1.5405582568038838)): shape (37, 800, 800)
      Valid pixels: 38891/640000 (6.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=258899, num_faces=259076
      Valid probs shape: (37, 38891)
    ✓ Random_27 (pose=(-1.0742701603811828, 1.0821644827191772, -1.9227497433784173)): shape (37, 800, 800)
      Valid pixels: 65236/640000 (10.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=259073, num_faces=259076
      Valid probs shape: (37, 65236)
    ✓ Random_28 (pose=(0.6952693136373203, 2.105377685439845, -1.5877032397097803)): shape (37, 800, 800)
      Valid pixels: 78684/640000 (12.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=17, max=259072, num_faces=259076
      Valid probs shape: (37, 78684)
    ✓ Random_29 (pose=(0.5953868756017426, 0.0834593170598934, 1.3137349977615784)): shape (37, 800, 800)
      Valid pixels: 43642/640000 (6.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=258902, num_faces=259076
      Valid probs shape: (37, 43642)
    ✓ Random_30 (pose=(0.8697185791463617, -0.8153283327276295, -1.0063867370394557)): shape (37, 800, 800)
      Valid pixels: 58767/640000 (9.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=258999, num_faces=259076
      Valid probs shape: (37, 58767)
    ✓ Random_31 (pose=(1.8264568868077227, 2.185166243908114, -1.9301607819941309)): shape (37, 800, 800)
      Valid pixels: 62912/640000 (9.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=259066, num_faces=259076
      Valid probs shape: (37, 62912)
    ✓ Random_32 (pose=(-2.762392360299858, 2.225670098368684, 2.68475638164879)): shape (37, 800, 800)
      Valid pixels: 62274/640000 (9.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=259073, num_faces=259076
      Valid probs shape: (37, 62274)
    ✓ Random_33 (pose=(-2.0225830758380985, -0.24349629636300385, -0.4679457329606942)): shape (37, 800, 800)
      Valid pixels: 83767/640000 (13.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=818, max=259073, num_faces=259076
      Valid probs shape: (37, 83767)
    ✓ Random_34 (pose=(-2.362385272424982, -0.7151496156619457, 3.0839131100599264)): shape (37, 800, 800)
      Valid pixels: 73399/640000 (11.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=22, max=259075, num_faces=259076
      Valid probs shape: (37, 73399)
    ✓ Random_35 (pose=(-0.004234090728733708, -0.3258179110460713, -1.9532080361861588)): shape (37, 800, 800)
      Valid pixels: 47773/640000 (7.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=212206, num_faces=259076
      Valid probs shape: (37, 47773)
    ✓ Random_36 (pose=(-0.6414012223794345, -0.11627813571691847, 0.8544056780113558)): shape (37, 800, 800)
      Valid pixels: 52539/640000 (8.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=258999, num_faces=259076
      Valid probs shape: (37, 52539)
    ✓ Random_37 (pose=(-1.8165221972597716, 0.3894488658468882, 2.3553169892179247)): shape (37, 800, 800)
      Valid pixels: 85488/640000 (13.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=10, max=259075, num_faces=259076
      Valid probs shape: (37, 85488)
    ✓ Random_38 (pose=(0.35865426477626006, -1.3313602471952257, -0.604543980200952)): shape (37, 800, 800)
      Valid pixels: 60830/640000 (9.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=10, max=258999, num_faces=259076
      Valid probs shape: (37, 60830)
    ✓ Random_39 (pose=(-0.7133625890238249, 1.1367266974785641, -2.506602180985694)): shape (37, 800, 800)
      Valid pixels: 86584/640000 (13.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=259074, num_faces=259076
      Valid probs shape: (37, 86584)
    P stats: min=0.0000, max=1.0000, mean=0.0259
    Non-zero vertices: 123913/129540
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 5627 1122 1136 3958    0 2091 1125 4309 6381]
  Ground Truth Stats:
    Labels shape: (129540,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-10/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7956
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8452
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8452

  RESULTS:
  RAW:         median(top-10)=0.9115, mean(top-10)=0.9186, median(all)=0.8502, mean(all)=0.7956
  + SMOOTHING: median(top-10)=0.9326, mean(top-10)=0.9377, median(all)=0.8923, mean(all)=0.8452 [+0.0211]
  + MRF:       median(top-10)=0.9323, mean(top-10)=0.9377, median(all)=0.8924, mean(all)=0.8452 [-0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0208

================================================================================
Subject: OASIS-TRT-20-11
================================================================================
  Step 0: Generating predictions with V2 model (40 random views)...
  Mesh: 146531 vertices, 293058 faces
  Generating 40 random views...
  Generating predictions for 40 views (continuous camera pose)...
    ✓ Random_0 (pose=(-1.629566606570922, -0.6135860102588442, -2.622549364731805)): shape (37, 800, 800)
      Valid pixels: 85577/640000 (13.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=15, max=293055, num_faces=293058
      Valid probs shape: (37, 85577)
    ✓ Random_1 (pose=(1.3859000723808377, -0.9208403498844469, 0.5006577655969671)): shape (37, 800, 800)
      Valid pixels: 89707/640000 (14.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=26, max=293055, num_faces=293058
      Valid probs shape: (37, 89707)
    ✓ Random_2 (pose=(-1.5656175491594244, 0.09492812965557285, -1.081690480016249)): shape (37, 800, 800)
      Valid pixels: 81377/640000 (12.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=291165, num_faces=293058
      Valid probs shape: (37, 81377)
    ✓ Random_3 (pose=(0.9204868660212098, 2.9882240723409605, 0.2612521771555185)): shape (37, 800, 800)
      Valid pixels: 74505/640000 (11.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=32, max=293057, num_faces=293058
      Valid probs shape: (37, 74505)
    ✓ Random_4 (pose=(0.9532293592550829, 0.7943743926686837, 1.1062145005770914)): shape (37, 800, 800)
      Valid pixels: 56665/640000 (8.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=291187, num_faces=293058
      Valid probs shape: (37, 56665)
    ✓ Random_5 (pose=(0.4011223541783906, -2.8077926870982752, -1.8291948373946645)): shape (37, 800, 800)
      Valid pixels: 62497/640000 (9.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2488, max=293055, num_faces=293058
      Valid probs shape: (37, 62497)
    ✓ Random_6 (pose=(2.4593812900677072, 1.3729803965256124, 1.165148323669018)): shape (37, 800, 800)
      Valid pixels: 90345/640000 (14.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7, max=293055, num_faces=293058
      Valid probs shape: (37, 90345)
    ✓ Random_7 (pose=(1.2759081528307226, -0.059389888381606415, 0.32821852470625457)): shape (37, 800, 800)
      Valid pixels: 88373/640000 (13.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=293055, num_faces=293058
      Valid probs shape: (37, 88373)
    ✓ Random_8 (pose=(-0.8216550611769744, 0.4311977036390928, 1.5736002108942433)): shape (37, 800, 800)
      Valid pixels: 57677/640000 (9.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=8, max=293052, num_faces=293058
      Valid probs shape: (37, 57677)
    ✓ Random_9 (pose=(-0.15192020392910166, -0.284659963407655, -2.537023489684981)): shape (37, 800, 800)
      Valid pixels: 46179/640000 (7.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=291188, num_faces=293058
      Valid probs shape: (37, 46179)
    ✓ Random_10 (pose=(-1.4352053016756225, 2.140091385075486, 1.5424956300921693)): shape (37, 800, 800)
      Valid pixels: 63524/640000 (9.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=21, max=293057, num_faces=293058
      Valid probs shape: (37, 63524)
    ✓ Random_11 (pose=(2.8366803231305706, -2.778366204352742, 2.8954523373782566)): shape (37, 800, 800)
      Valid pixels: 55811/640000 (8.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=292967, num_faces=293058
      Valid probs shape: (37, 55811)
    ✓ Random_12 (pose=(-3.1295848634893564, 0.24393600998542686, 1.3369782734370608)): shape (37, 800, 800)
      Valid pixels: 45791/640000 (7.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2501, max=293057, num_faces=293058
      Valid probs shape: (37, 45791)
    ✓ Random_13 (pose=(1.2070883894919646, 0.10517595242267541, 1.4836429346665208)): shape (37, 800, 800)
      Valid pixels: 56049/640000 (8.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=291184, num_faces=293058
      Valid probs shape: (37, 56049)
    ✓ Random_14 (pose=(1.6511622110747242, -0.19059929484783433, -2.240679291241953)): shape (37, 800, 800)
      Valid pixels: 71860/640000 (11.2%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=13, max=293057, num_faces=293058
      Valid probs shape: (37, 71860)
    ✓ Random_15 (pose=(-2.465964744392704, 2.6276455806267487, 0.722232492040769)): shape (37, 800, 800)
      Valid pixels: 54825/640000 (8.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=293055, num_faces=293058
      Valid probs shape: (37, 54825)
    ✓ Random_16 (pose=(0.35446164829657834, 2.342356312807456, 1.3230858348716987)): shape (37, 800, 800)
      Valid pixels: 80829/640000 (12.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5920, max=293053, num_faces=293058
      Valid probs shape: (37, 80829)
    ✓ Random_17 (pose=(0.44283581933099603, -2.4881930905134686, -1.7944938000343)): shape (37, 800, 800)
      Valid pixels: 74528/640000 (11.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2485, max=293056, num_faces=293058
      Valid probs shape: (37, 74528)
    ✓ Random_18 (pose=(2.9744065421888655, -1.9745596462887016, 1.016861910219161)): shape (37, 800, 800)
      Valid pixels: 85062/640000 (13.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=292576, num_faces=293058
      Valid probs shape: (37, 85062)
    ✓ Random_19 (pose=(1.074373310310059, 0.6438679877485942, 1.6098011450418763)): shape (37, 800, 800)
      Valid pixels: 71267/640000 (11.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=292470, num_faces=293058
      Valid probs shape: (37, 71267)
    ✓ Random_20 (pose=(-3.1115872012150354, 1.2325031763146885, 0.8560673961185401)): shape (37, 800, 800)
      Valid pixels: 90575/640000 (14.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=20, max=293057, num_faces=293058
      Valid probs shape: (37, 90575)
    ✓ Random_21 (pose=(1.2561208742689756, 2.2951251749170556, 0.9781663497477258)): shape (37, 800, 800)
      Valid pixels: 62428/640000 (9.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=12, max=293055, num_faces=293058
      Valid probs shape: (37, 62428)
    ✓ Random_22 (pose=(1.165079687915683, -2.814463524849516, -1.616124404050265)): shape (37, 800, 800)
      Valid pixels: 62555/640000 (9.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1708, max=293055, num_faces=293058
      Valid probs shape: (37, 62555)
    ✓ Random_23 (pose=(-1.2828455563876995, 0.705473957719243, 0.01859462874466189)): shape (37, 800, 800)
      Valid pixels: 90570/640000 (14.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=25, max=293045, num_faces=293058
      Valid probs shape: (37, 90570)
    ✓ Random_24 (pose=(-1.5463967603226285, 2.7224042653738083, 1.8324543716782324)): shape (37, 800, 800)
      Valid pixels: 72523/640000 (11.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=18, max=293057, num_faces=293058
      Valid probs shape: (37, 72523)
    ✓ Random_25 (pose=(0.1372310930516254, 1.842110203880809, -0.8449344024203316)): shape (37, 800, 800)
      Valid pixels: 79958/640000 (12.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=293055, num_faces=293058
      Valid probs shape: (37, 79958)
    ✓ Random_26 (pose=(1.8122821811248953, -3.103756320587835, 2.828033655858545)): shape (37, 800, 800)
      Valid pixels: 91570/640000 (14.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=292514, num_faces=293058
      Valid probs shape: (37, 91570)
    ✓ Random_27 (pose=(-2.526519344988589, -2.1149332400255245, 0.17328473287646196)): shape (37, 800, 800)
      Valid pixels: 84486/640000 (13.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=292584, num_faces=293058
      Valid probs shape: (37, 84486)
    ✓ Random_28 (pose=(1.9304816727819007, 3.0349311885402868, 0.7600988148930274)): shape (37, 800, 800)
      Valid pixels: 75117/640000 (11.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=293055, num_faces=293058
      Valid probs shape: (37, 75117)
    ✓ Random_29 (pose=(-1.7533932160719203, 1.629736984876203, 1.573794010130955)): shape (37, 800, 800)
      Valid pixels: 69249/640000 (10.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=16, max=293057, num_faces=293058
      Valid probs shape: (37, 69249)
    ✓ Random_30 (pose=(-2.783024567540481, -1.7623033021134245, -2.9799312714824913)): shape (37, 800, 800)
      Valid pixels: 83123/640000 (13.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=293053, num_faces=293058
      Valid probs shape: (37, 83123)
    ✓ Random_31 (pose=(2.31763171879489, 1.1315429438186335, -1.1643939976360818)): shape (37, 800, 800)
      Valid pixels: 64919/640000 (10.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=168, max=293054, num_faces=293058
      Valid probs shape: (37, 64919)
    ✓ Random_32 (pose=(-0.49941478023353847, -1.7230183854655114, -1.3155098727999743)): shape (37, 800, 800)
      Valid pixels: 93387/640000 (14.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=115, max=292514, num_faces=293058
      Valid probs shape: (37, 93387)
    ✓ Random_33 (pose=(-1.4661780738920234, -1.9053172638075764, 3.0605525898536357)): shape (37, 800, 800)
      Valid pixels: 98190/640000 (15.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7, max=293056, num_faces=293058
      Valid probs shape: (37, 98190)
    ✓ Random_34 (pose=(-1.9723317368615243, 1.6712409772967236, -2.7661406038628504)): shape (37, 800, 800)
      Valid pixels: 75512/640000 (11.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=20, max=293055, num_faces=293058
      Valid probs shape: (37, 75512)
    ✓ Random_35 (pose=(-1.2845034301254117, -2.115348579661725, -1.1817950425521286)): shape (37, 800, 800)
      Valid pixels: 86487/640000 (13.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=10, max=291131, num_faces=293058
      Valid probs shape: (37, 86487)
    ✓ Random_36 (pose=(0.3423661648701737, -0.7322726241414479, 0.2889390047041136)): shape (37, 800, 800)
      Valid pixels: 71589/640000 (11.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=293057, num_faces=293058
      Valid probs shape: (37, 71589)
    ✓ Random_37 (pose=(0.3827985414875439, -0.8902605225649038, 1.4815697227122753)): shape (37, 800, 800)
      Valid pixels: 78251/640000 (12.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=293055, num_faces=293058
      Valid probs shape: (37, 78251)
    ✓ Random_38 (pose=(1.3022271669836902, 1.5175986007041669, -2.8277121400958993)): shape (37, 800, 800)
      Valid pixels: 78063/640000 (12.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=115, max=293057, num_faces=293058
      Valid probs shape: (37, 78063)
    ✓ Random_39 (pose=(1.1214167969064155, -0.7954560362079586, 0.8711188989512078)): shape (37, 800, 800)
      Valid pixels: 81442/640000 (12.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=293055, num_faces=293058
      Valid probs shape: (37, 81442)
    P stats: min=0.0000, max=1.0000, mean=0.0256
    Non-zero vertices: 138871/146531
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 7660 1446 1183 3720    0 2889  956 5048 7742]
  Ground Truth Stats:
    Labels shape: (146531,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-11/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7985
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8461
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8462

  RESULTS:
  RAW:         median(top-10)=0.9061, mean(top-10)=0.9113, median(all)=0.8683, mean(all)=0.7985
  + SMOOTHING: median(top-10)=0.9304, mean(top-10)=0.9355, median(all)=0.8956, mean(all)=0.8461 [+0.0244]
  + MRF:       median(top-10)=0.9308, mean(top-10)=0.9357, median(all)=0.8956, mean(all)=0.8462 [+0.0004]
  TOTAL IMPROVEMENT (median top-10): +0.0247

================================================================================
Subject: OASIS-TRT-20-12
================================================================================
  Step 0: Generating predictions with V2 model (40 random views)...
  Mesh: 144559 vertices, 289114 faces
  Generating 40 random views...
  Generating predictions for 40 views (continuous camera pose)...
    ✓ Random_0 (pose=(-2.4396256372079166, -1.7955604249194328, 0.1209077655010824)): shape (37, 800, 800)
      Valid pixels: 80160/640000 (12.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=289067, num_faces=289114
      Valid probs shape: (37, 80160)
    ✓ Random_1 (pose=(3.030230254491963, -0.8503275914676744, 1.6058553752134053)): shape (37, 800, 800)
      Valid pixels: 74991/640000 (11.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1309, max=289113, num_faces=289114
      Valid probs shape: (37, 74991)
    ✓ Random_2 (pose=(-0.6039385190811095, 0.5865926659378378, -0.5642767360978493)): shape (37, 800, 800)
      Valid pixels: 50925/640000 (8.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=287856, num_faces=289114
      Valid probs shape: (37, 50925)
    ✓ Random_3 (pose=(0.8096538279630412, 1.9826962253995681, 0.8296026267803538)): shape (37, 800, 800)
      Valid pixels: 54792/640000 (8.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=8, max=289112, num_faces=289114
      Valid probs shape: (37, 54792)
    ✓ Random_4 (pose=(0.07574948415802218, -2.9315984796994785, 0.9571567682323172)): shape (37, 800, 800)
      Valid pixels: 38736/640000 (6.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4693, max=289112, num_faces=289114
      Valid probs shape: (37, 38736)
    ✓ Random_5 (pose=(-0.3224773121855482, -2.013903251115214, 0.34981816945867283)): shape (37, 800, 800)
      Valid pixels: 51329/640000 (8.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=161, max=289110, num_faces=289114
      Valid probs shape: (37, 51329)
    ✓ Random_6 (pose=(1.7124688011200755, 2.269530460957239, -0.237572019671076)): shape (37, 800, 800)
      Valid pixels: 89857/640000 (14.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=8, max=288987, num_faces=289114
      Valid probs shape: (37, 89857)
    ✓ Random_7 (pose=(1.8593654755296534, -2.49167158995807, -2.665762749453273)): shape (37, 800, 800)
      Valid pixels: 68194/640000 (10.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=289092, num_faces=289114
      Valid probs shape: (37, 68194)
    ✓ Random_8 (pose=(-0.7889164102470096, 2.3800755181002744, 1.0298598046209637)): shape (37, 800, 800)
      Valid pixels: 70154/640000 (11.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=597, max=289109, num_faces=289114
      Valid probs shape: (37, 70154)
    ✓ Random_9 (pose=(2.9584932086931275, -0.9493586394168232, -0.40778395916959864)): shape (37, 800, 800)
      Valid pixels: 60342/640000 (9.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1174, max=289068, num_faces=289114
      Valid probs shape: (37, 60342)
    ✓ Random_10 (pose=(1.4029895231015388, -0.26715664592447563, 1.4418055952101794)): shape (37, 800, 800)
      Valid pixels: 53603/640000 (8.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=289057, num_faces=289114
      Valid probs shape: (37, 53603)
    ✓ Random_11 (pose=(0.07598239373969173, 1.8811906114366295, 2.801297399826394)): shape (37, 800, 800)
      Valid pixels: 58812/640000 (9.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=148, max=289110, num_faces=289114
      Valid probs shape: (37, 58812)
    ✓ Random_12 (pose=(-1.7431191848024923, 1.6106656570193296, 1.4749857155716466)): shape (37, 800, 800)
      Valid pixels: 58153/640000 (9.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=104, max=289094, num_faces=289114
      Valid probs shape: (37, 58153)
    ✓ Random_13 (pose=(-1.3588128041653544, 3.0134773523398986, 0.4184469669964712)): shape (37, 800, 800)
      Valid pixels: 74394/640000 (11.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=690, max=289112, num_faces=289114
      Valid probs shape: (37, 74394)
    ✓ Random_14 (pose=(0.39324706990889347, -0.6739517436040514, -2.537802646840343)): shape (37, 800, 800)
      Valid pixels: 60928/640000 (9.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6, max=289053, num_faces=289114
      Valid probs shape: (37, 60928)
    ✓ Random_15 (pose=(-1.2097889226461966, -0.49829021394482576, 2.4868471016086273)): shape (37, 800, 800)
      Valid pixels: 86689/640000 (13.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=9, max=288993, num_faces=289114
      Valid probs shape: (37, 86689)
    ✓ Random_16 (pose=(-0.12846193099591963, -0.7094451864984994, 1.8938548596636267)): shape (37, 800, 800)
      Valid pixels: 64267/640000 (10.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=288983, num_faces=289114
      Valid probs shape: (37, 64267)
    ✓ Random_17 (pose=(3.058405896739604, 1.9981267607316173, -3.0128120025143246)): shape (37, 800, 800)
      Valid pixels: 56745/640000 (8.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=289057, num_faces=289114
      Valid probs shape: (37, 56745)
    ✓ Random_18 (pose=(0.03960663468499037, 0.392872577812009, -2.3223652775654293)): shape (37, 800, 800)
      Valid pixels: 49806/640000 (7.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=10, max=288987, num_faces=289114
      Valid probs shape: (37, 49806)
    ✓ Random_19 (pose=(2.054315946254877, 2.6372267553422892, 2.1815981755203078)): shape (37, 800, 800)
      Valid pixels: 61899/640000 (9.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=289067, num_faces=289114
      Valid probs shape: (37, 61899)
    ✓ Random_20 (pose=(-0.10565378227501743, -2.4682298715208133, 1.1992122041018307)): shape (37, 800, 800)
      Valid pixels: 56248/640000 (8.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=129, max=289110, num_faces=289114
      Valid probs shape: (37, 56248)
    ✓ Random_21 (pose=(-0.5253773435172424, 2.4620713582979272, -2.3620652694447863)): shape (37, 800, 800)
      Valid pixels: 65911/640000 (10.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=52, max=289110, num_faces=289114
      Valid probs shape: (37, 65911)
    ✓ Random_22 (pose=(-0.07315636200657183, 0.05792108047686595, 1.971794717535075)): shape (37, 800, 800)
      Valid pixels: 37499/640000 (5.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=288953, num_faces=289114
      Valid probs shape: (37, 37499)
    ✓ Random_23 (pose=(-0.05208828579336133, -2.9784071360320366, 1.996499448691143)): shape (37, 800, 800)
      Valid pixels: 38412/640000 (6.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6277, max=289112, num_faces=289114
      Valid probs shape: (37, 38412)
    ✓ Random_24 (pose=(-2.0221827558416905, 0.26033871520878327, -2.4242155505989276)): shape (37, 800, 800)
      Valid pixels: 63823/640000 (10.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=278, max=289068, num_faces=289114
      Valid probs shape: (37, 63823)
    ✓ Random_25 (pose=(-0.5648548155196833, 1.1836524011916278, 2.9347658132952565)): shape (37, 800, 800)
      Valid pixels: 70485/640000 (11.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=288988, num_faces=289114
      Valid probs shape: (37, 70485)
    ✓ Random_26 (pose=(-1.1043220453655098, 2.6719623827837005, 1.1276857023236069)): shape (37, 800, 800)
      Valid pixels: 61679/640000 (9.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=160, max=289110, num_faces=289114
      Valid probs shape: (37, 61679)
    ✓ Random_27 (pose=(-0.43684201789947874, 1.6288887396487892, 1.466261619712684)): shape (37, 800, 800)
      Valid pixels: 75446/640000 (11.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=119, max=289112, num_faces=289114
      Valid probs shape: (37, 75446)
    ✓ Random_28 (pose=(-1.3975985823587076, -0.140557955783565, 1.1660520959698237)): shape (37, 800, 800)
      Valid pixels: 61667/640000 (9.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=288953, num_faces=289114
      Valid probs shape: (37, 61667)
    ✓ Random_29 (pose=(-0.9468698278663701, 1.7286333295512195, -1.487540410508577)): shape (37, 800, 800)
      Valid pixels: 61819/640000 (9.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=289068, num_faces=289114
      Valid probs shape: (37, 61819)
    ✓ Random_30 (pose=(1.1599861155968378, -1.3673732488789423, -2.0889412424547427)): shape (37, 800, 800)
      Valid pixels: 69231/640000 (10.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=34, max=289113, num_faces=289114
      Valid probs shape: (37, 69231)
    ✓ Random_31 (pose=(1.0504458407620447, -1.695550705179431, 1.372441087751663)): shape (37, 800, 800)
      Valid pixels: 65315/640000 (10.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=289057, num_faces=289114
      Valid probs shape: (37, 65315)
    ✓ Random_32 (pose=(-0.5805989243469196, -1.5766219688123904, -1.595560401732489)): shape (37, 800, 800)
      Valid pixels: 84187/640000 (13.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=289111, num_faces=289114
      Valid probs shape: (37, 84187)
    ✓ Random_33 (pose=(1.6844417076982534, 1.9789234192866418, 0.1731839756187714)): shape (37, 800, 800)
      Valid pixels: 86709/640000 (13.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=8, max=288987, num_faces=289114
      Valid probs shape: (37, 86709)
    ✓ Random_34 (pose=(0.5234427040249341, -1.7309262278095658, 0.3845630762261907)): shape (37, 800, 800)
      Valid pixels: 85216/640000 (13.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=56, max=288988, num_faces=289114
      Valid probs shape: (37, 85216)
    ✓ Random_35 (pose=(2.188301589524327, -0.867047361723384, 0.19377536145437535)): shape (37, 800, 800)
      Valid pixels: 67442/640000 (10.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=82, max=289057, num_faces=289114
      Valid probs shape: (37, 67442)
    ✓ Random_36 (pose=(-0.3755779677622417, 0.5047175707434275, -0.07263389006716503)): shape (37, 800, 800)
      Valid pixels: 49764/640000 (7.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=287858, num_faces=289114
      Valid probs shape: (37, 49764)
    ✓ Random_37 (pose=(-0.426071292843778, -0.09029812274524485, 1.1832405808613347)): shape (37, 800, 800)
      Valid pixels: 43176/640000 (6.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=12, max=288950, num_faces=289114
      Valid probs shape: (37, 43176)
    ✓ Random_38 (pose=(-0.09824427614703657, -3.0265475617994553, -0.7127628362284466)): shape (37, 800, 800)
      Valid pixels: 44273/640000 (6.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=78467, max=289113, num_faces=289114
      Valid probs shape: (37, 44273)
    ✓ Random_39 (pose=(1.2743716211050762, -1.228779229777618, -1.9504343013851684)): shape (37, 800, 800)
      Valid pixels: 65278/640000 (10.2%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=17, max=289113, num_faces=289114
      Valid probs shape: (37, 65278)
    P stats: min=0.0000, max=1.0000, mean=0.0259
    Non-zero vertices: 138315/144559
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 6244 1394 1117 3223    0 2022 1174 5142 6167]
  Ground Truth Stats:
    Labels shape: (144559,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-12/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7773
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8190
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8192

  RESULTS:
  RAW:         median(top-10)=0.8907, mean(top-10)=0.8989, median(all)=0.8452, mean(all)=0.7773
  + SMOOTHING: median(top-10)=0.9091, mean(top-10)=0.9170, median(all)=0.8649, mean(all)=0.8190 [+0.0184]
  + MRF:       median(top-10)=0.9090, mean(top-10)=0.9171, median(all)=0.8650, mean(all)=0.8192 [-0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0183

================================================================================
Subject: OASIS-TRT-20-13
================================================================================
  Step 0: Generating predictions with V2 model (40 random views)...
  Mesh: 122339 vertices, 244674 faces
  Generating 40 random views...
  Generating predictions for 40 views (continuous camera pose)...
    ✓ Random_0 (pose=(-0.39782605082198774, 1.8388676270424993, 0.4653547193226739)): shape (37, 800, 800)
      Valid pixels: 87085/640000 (13.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=100, max=244671, num_faces=244674
      Valid probs shape: (37, 87085)
    ✓ Random_1 (pose=(-0.18272304712151266, -0.7544898104319211, 2.054814787445623)): shape (37, 800, 800)
      Valid pixels: 65997/640000 (10.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=244602, num_faces=244674
      Valid probs shape: (37, 65997)
    ✓ Random_2 (pose=(0.04330255697551477, -1.7993603770243702, 1.6470219372420285)): shape (37, 800, 800)
      Valid pixels: 92497/640000 (14.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=33, max=244603, num_faces=244674
      Valid probs shape: (37, 92497)
    ✓ Random_3 (pose=(3.08360609828728, -1.9056353838466913, 2.05551816674015)): shape (37, 800, 800)
      Valid pixels: 76423/640000 (11.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=3, max=244672, num_faces=244674
      Valid probs shape: (37, 76423)
    ✓ Random_4 (pose=(0.8610906017079909, -1.400107152968978, 3.1091802084703852)): shape (37, 800, 800)
      Valid pixels: 88253/640000 (13.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=9, max=244671, num_faces=244674
      Valid probs shape: (37, 88253)
    ✓ Random_5 (pose=(-0.24789699190708747, 1.1494248747787266, -0.16385394091549044)): shape (37, 800, 800)
      Valid pixels: 58501/640000 (9.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=244596, num_faces=244674
      Valid probs shape: (37, 58501)
    ✓ Random_6 (pose=(-1.042938391166257, -0.8115513869867503, 0.7620222604133353)): shape (37, 800, 800)
      Valid pixels: 65669/640000 (10.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=9, max=244673, num_faces=244674
      Valid probs shape: (37, 65669)
    ✓ Random_7 (pose=(0.31541875232992833, -0.4129939501874773, 2.3744593302993575)): shape (37, 800, 800)
      Valid pixels: 46363/640000 (7.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=243225, num_faces=244674
      Valid probs shape: (37, 46363)
    ✓ Random_8 (pose=(1.3499406178705948, -1.5154479085352444, -1.903782197239812)): shape (37, 800, 800)
      Valid pixels: 68295/640000 (10.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=100, max=244673, num_faces=244674
      Valid probs shape: (37, 68295)
    ✓ Random_9 (pose=(0.06330366511000651, -0.2176733592830904, -0.6017613491696316)): shape (37, 800, 800)
      Valid pixels: 49403/640000 (7.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=244293, num_faces=244674
      Valid probs shape: (37, 49403)
    ✓ Random_10 (pose=(-2.337674692266093, -2.0666286911611023, 1.7937161372612884)): shape (37, 800, 800)
      Valid pixels: 66503/640000 (10.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=12, max=244673, num_faces=244674
      Valid probs shape: (37, 66503)
    ✓ Random_11 (pose=(-0.436208111867749, -2.8183307021418837, -0.20090764246552695)): shape (37, 800, 800)
      Valid pixels: 59084/640000 (9.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=31618, max=244673, num_faces=244674
      Valid probs shape: (37, 59084)
    ✓ Random_12 (pose=(2.3119501960706783, -2.92926559827848, 2.713366076369364)): shape (37, 800, 800)
      Valid pixels: 77400/640000 (12.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=244391, num_faces=244674
      Valid probs shape: (37, 77400)
    ✓ Random_13 (pose=(2.795511970753328, 1.474330744979941, 1.0717635694849958)): shape (37, 800, 800)
      Valid pixels: 97024/640000 (15.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=32, max=244673, num_faces=244674
      Valid probs shape: (37, 97024)
    ✓ Random_14 (pose=(-1.0489641375002514, -1.8308287471848388, -0.3491142576092603)): shape (37, 800, 800)
      Valid pixels: 86762/640000 (13.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=0, max=244672, num_faces=244674
      Valid probs shape: (37, 86762)
    ✓ Random_15 (pose=(2.91687163307496, -1.729682694683634, 0.896729887341686)): shape (37, 800, 800)
      Valid pixels: 83258/640000 (13.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8, max=244596, num_faces=244674
      Valid probs shape: (37, 83258)
    ✓ Random_16 (pose=(-0.20091281632624902, -0.23676928088877292, -1.0385944914347478)): shape (37, 800, 800)
      Valid pixels: 55214/640000 (8.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=243477, num_faces=244674
      Valid probs shape: (37, 55214)
    ✓ Random_17 (pose=(-2.355012519092527, 3.0199884460850406, 0.7758605179194209)): shape (37, 800, 800)
      Valid pixels: 61484/640000 (9.6%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=2, max=244673, num_faces=244674
      Valid probs shape: (37, 61484)
    ✓ Random_18 (pose=(-0.38287759436020163, 0.4293596510098574, 0.3624113481699953)): shape (37, 800, 800)
      Valid pixels: 66332/640000 (10.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=244391, num_faces=244674
      Valid probs shape: (37, 66332)
    ✓ Random_19 (pose=(-0.8122074409040243, 0.5219169090297764, -1.4917883450353209)): shape (37, 800, 800)
      Valid pixels: 54697/640000 (8.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=244559, num_faces=244674
      Valid probs shape: (37, 54697)
    ✓ Random_20 (pose=(-1.029517159425299, 1.7159417836367554, -0.4333524727765692)): shape (37, 800, 800)
      Valid pixels: 80069/640000 (12.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=244671, num_faces=244674
      Valid probs shape: (37, 80069)
    ✓ Random_21 (pose=(3.039192510340662, 1.7771910441145904, -1.574969527410589)): shape (37, 800, 800)
      Valid pixels: 86360/640000 (13.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=3, max=244671, num_faces=244674
      Valid probs shape: (37, 86360)
    ✓ Random_22 (pose=(2.251814816740678, -1.9207969048088165, 1.3712896789498394)): shape (37, 800, 800)
      Valid pixels: 74349/640000 (11.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=9, max=244596, num_faces=244674
      Valid probs shape: (37, 74349)
    ✓ Random_23 (pose=(2.5394933264566513, -0.5812887054335394, 2.0207265900224183)): shape (37, 800, 800)
      Valid pixels: 75008/640000 (11.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=10598, max=244671, num_faces=244674
      Valid probs shape: (37, 75008)
    ✓ Random_24 (pose=(-1.7785819543737114, -1.3858999807605101, -3.007192766364936)): shape (37, 800, 800)
      Valid pixels: 96616/640000 (15.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=30, max=244603, num_faces=244674
      Valid probs shape: (37, 96616)
    ✓ Random_25 (pose=(0.5116725834042111, -1.9596115868946924, -0.8782882147984439)): shape (37, 800, 800)
      Valid pixels: 62562/640000 (9.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=440, max=244673, num_faces=244674
      Valid probs shape: (37, 62562)
    ✓ Random_26 (pose=(1.277615590477553, 0.3391647798696096, -0.364208484102313)): shape (37, 800, 800)
      Valid pixels: 91476/640000 (14.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=244603, num_faces=244674
      Valid probs shape: (37, 91476)
    ✓ Random_27 (pose=(2.0891030697065744, 1.2720004025286604, 0.33395275222758913)): shape (37, 800, 800)
      Valid pixels: 96912/640000 (15.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=32, max=244673, num_faces=244674
      Valid probs shape: (37, 96912)
    ✓ Random_28 (pose=(2.804139283253984, 1.8673727657703436, 2.82297537508619)): shape (37, 800, 800)
      Valid pixels: 56734/640000 (8.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=244597, num_faces=244674
      Valid probs shape: (37, 56734)
    ✓ Random_29 (pose=(3.0415773449611594, 1.5510687964456666, 0.8825491247841653)): shape (37, 800, 800)
      Valid pixels: 93939/640000 (14.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=36, max=244672, num_faces=244674
      Valid probs shape: (37, 93939)
    ✓ Random_30 (pose=(-0.5293851124605822, 1.927860206173949, 2.1135063693218763)): shape (37, 800, 800)
      Valid pixels: 64450/640000 (10.1%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=462, max=244673, num_faces=244674
      Valid probs shape: (37, 64450)
    ✓ Random_31 (pose=(-1.920167299566086, 0.4974709978795464, -0.729538645193879)): shape (37, 800, 800)
      Valid pixels: 88139/640000 (13.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=101, max=244673, num_faces=244674
      Valid probs shape: (37, 88139)
    ✓ Random_32 (pose=(2.6434307058923148, 2.49755610241466, -0.08727711328319021)): shape (37, 800, 800)
      Valid pixels: 60623/640000 (9.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=244672, num_faces=244674
      Valid probs shape: (37, 60623)
    ✓ Random_33 (pose=(-2.221931144979541, -2.0487493598156012, 3.0224500924946955)): shape (37, 800, 800)
      Valid pixels: 86932/640000 (13.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=244673, num_faces=244674
      Valid probs shape: (37, 86932)
    ✓ Random_34 (pose=(2.7252802892101053, -2.04066340813603, -2.4672551786721186)): shape (37, 800, 800)
      Valid pixels: 58919/640000 (9.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=244673, num_faces=244674
      Valid probs shape: (37, 58919)
    ✓ Random_35 (pose=(0.9027974804339092, 0.11608999110482587, 0.9389001445547205)): shape (37, 800, 800)
      Valid pixels: 56955/640000 (8.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=244582, num_faces=244674
      Valid probs shape: (37, 56955)
    ✓ Random_36 (pose=(-1.9389981568575785, 2.2573486231778936, -1.6529965884912488)): shape (37, 800, 800)
      Valid pixels: 63582/640000 (9.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=244597, num_faces=244674
      Valid probs shape: (37, 63582)
    ✓ Random_37 (pose=(0.6632348830569961, 2.992119785982519, 2.0052188447335713)): shape (37, 800, 800)
      Valid pixels: 61147/640000 (9.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=23405, max=244671, num_faces=244674
      Valid probs shape: (37, 61147)
    ✓ Random_38 (pose=(0.4483782277545223, -1.9415143604395873, 2.741661907737229)): shape (37, 800, 800)
      Valid pixels: 57249/640000 (8.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=237, max=244671, num_faces=244674
      Valid probs shape: (37, 57249)
    ✓ Random_39 (pose=(0.2834099422895098, -2.238340163889056, 2.8473653469385827)): shape (37, 800, 800)
      Valid pixels: 54881/640000 (8.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1030, max=244671, num_faces=244674
      Valid probs shape: (37, 54881)
    P stats: min=0.0000, max=1.0000, mean=0.0258
    Non-zero vertices: 117004/122339
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 5335 1217 1056 2883    0 1751  998 4195 6262]
  Ground Truth Stats:
    Labels shape: (122339,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-13/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7797
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8233
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8235

  RESULTS:
  RAW:         median(top-10)=0.9062, mean(top-10)=0.9055, median(all)=0.8479, mean(all)=0.7797
  + SMOOTHING: median(top-10)=0.9160, mean(top-10)=0.9192, median(all)=0.8809, mean(all)=0.8233 [+0.0098]
  + MRF:       median(top-10)=0.9162, mean(top-10)=0.9194, median(all)=0.8812, mean(all)=0.8235 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0101

================================================================================
Subject: OASIS-TRT-20-14
================================================================================
  Step 0: Generating predictions with V2 model (40 random views)...
  Mesh: 128019 vertices, 256034 faces
  Generating 40 random views...
  Generating predictions for 40 views (continuous camera pose)...
    ✓ Random_0 (pose=(-0.5947185665290959, -0.3868247237494806, 1.9497700285170252)): shape (37, 800, 800)
      Valid pixels: 65725/640000 (10.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=255933, num_faces=256034
      Valid probs shape: (37, 65725)
    ✓ Random_1 (pose=(1.614621943619218, -2.040116083733741, -2.8060050696405234)): shape (37, 800, 800)
      Valid pixels: 73680/640000 (11.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=0, max=256030, num_faces=256034
      Valid probs shape: (37, 73680)
    ✓ Random_2 (pose=(2.949846996964454, -0.19482333285706677, 2.4348784964951085)): shape (37, 800, 800)
      Valid pixels: 49586/640000 (7.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=45092, max=256033, num_faces=256034
      Valid probs shape: (37, 49586)
    ✓ Random_3 (pose=(-0.030307402987481247, -1.4441345062209663, 2.1495179174933874)): shape (37, 800, 800)
      Valid pixels: 71054/640000 (11.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=255933, num_faces=256034
      Valid probs shape: (37, 71054)
    ✓ Random_4 (pose=(3.0737850585270508, -2.9989270888634953, 2.462261022608379)): shape (37, 800, 800)
      Valid pixels: 43259/640000 (6.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=255917, num_faces=256034
      Valid probs shape: (37, 43259)
    ✓ Random_5 (pose=(-2.9345522299103872, -2.541747286207679, 1.1825740043539659)): shape (37, 800, 800)
      Valid pixels: 59435/640000 (9.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=0, max=256030, num_faces=256034
      Valid probs shape: (37, 59435)
    ✓ Random_6 (pose=(-1.1618581913757255, -0.7158839165779045, -1.898061694770813)): shape (37, 800, 800)
      Valid pixels: 54806/640000 (8.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=255980, num_faces=256034
      Valid probs shape: (37, 54806)
    ✓ Random_7 (pose=(3.057348092212882, 0.03626092839788164, 2.923075616096231)): shape (37, 800, 800)
      Valid pixels: 40354/640000 (6.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=76461, max=256033, num_faces=256034
      Valid probs shape: (37, 40354)
    ✓ Random_8 (pose=(-2.853611993570656, -2.743815720482613, 0.3015190358150144)): shape (37, 800, 800)
      Valid pixels: 53610/640000 (8.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=255141, num_faces=256034
      Valid probs shape: (37, 53610)
    ✓ Random_9 (pose=(-2.773088978504482, 2.411777476614726, -0.8873028354163965)): shape (37, 800, 800)
      Valid pixels: 63591/640000 (9.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=256030, num_faces=256034
      Valid probs shape: (37, 63591)
    ✓ Random_10 (pose=(-1.993916579858553, 2.531021117328655, -0.7611828793354465)): shape (37, 800, 800)
      Valid pixels: 84437/640000 (13.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=255691, num_faces=256034
      Valid probs shape: (37, 84437)
    ✓ Random_11 (pose=(1.6548577025528353, 1.2778667312114003, -1.488945553473951)): shape (37, 800, 800)
      Valid pixels: 60000/640000 (9.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=38, max=256030, num_faces=256034
      Valid probs shape: (37, 60000)
    ✓ Random_12 (pose=(2.190675707541316, 2.8717604268580086, -1.3419048896724326)): shape (37, 800, 800)
      Valid pixels: 54735/640000 (8.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=3, max=256030, num_faces=256034
      Valid probs shape: (37, 54735)
    ✓ Random_13 (pose=(2.602425265159529, -2.394710662345701, -0.3731645845357705)): shape (37, 800, 800)
      Valid pixels: 63732/640000 (10.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=255933, num_faces=256034
      Valid probs shape: (37, 63732)
    ✓ Random_14 (pose=(3.0965756102863535, -2.74082930509609, -1.5126745854032821)): shape (37, 800, 800)
      Valid pixels: 50604/640000 (7.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=255929, num_faces=256034
      Valid probs shape: (37, 50604)
    ✓ Random_15 (pose=(-1.6123891726591095, -2.94415511506241, -3.0657898436805926)): shape (37, 800, 800)
      Valid pixels: 88164/640000 (13.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=43, max=255933, num_faces=256034
      Valid probs shape: (37, 88164)
    ✓ Random_16 (pose=(1.8069119243383769, 0.7185393023651998, -1.4652709259196708)): shape (37, 800, 800)
      Valid pixels: 58661/640000 (9.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=40, max=256030, num_faces=256034
      Valid probs shape: (37, 58661)
    ✓ Random_17 (pose=(1.2389607520748669, 2.632943810758836, 0.9953839721497362)): shape (37, 800, 800)
      Valid pixels: 58405/640000 (9.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=119, max=255980, num_faces=256034
      Valid probs shape: (37, 58405)
    ✓ Random_18 (pose=(-3.048001258269441, -1.147916070565363, -2.5284261340886394)): shape (37, 800, 800)
      Valid pixels: 81359/640000 (12.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=102, max=256033, num_faces=256034
      Valid probs shape: (37, 81359)
    ✓ Random_19 (pose=(-2.7223199163075797, 1.725145122627282, 1.4148377125614955)): shape (37, 800, 800)
      Valid pixels: 92222/640000 (14.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6, max=255933, num_faces=256034
      Valid probs shape: (37, 92222)
    ✓ Random_20 (pose=(-0.7674317044604511, 2.829033594658985, -2.1761422255361724)): shape (37, 800, 800)
      Valid pixels: 60769/640000 (9.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=171, max=256029, num_faces=256034
      Valid probs shape: (37, 60769)
    ✓ Random_21 (pose=(3.1293371081893886, 2.463409579378837, -2.7623278120221153)): shape (37, 800, 800)
      Valid pixels: 55502/640000 (8.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=255141, num_faces=256034
      Valid probs shape: (37, 55502)
    ✓ Random_22 (pose=(-2.96427824917126, -2.9951007119893167, -2.7389399504296654)): shape (37, 800, 800)
      Valid pixels: 42873/640000 (6.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=255924, num_faces=256034
      Valid probs shape: (37, 42873)
    ✓ Random_23 (pose=(-1.7011994135681385, -2.7556282963824974, 1.7683238341831897)): shape (37, 800, 800)
      Valid pixels: 65032/640000 (10.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=256030, num_faces=256034
      Valid probs shape: (37, 65032)
    ✓ Random_24 (pose=(1.6586265575716252, -1.8582591168437155, -2.9570629805896083)): shape (37, 800, 800)
      Valid pixels: 76437/640000 (11.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=256030, num_faces=256034
      Valid probs shape: (37, 76437)
    ✓ Random_25 (pose=(1.9948144101009895, -0.5470467951255236, -3.062239515078581)): shape (37, 800, 800)
      Valid pixels: 75874/640000 (11.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=487, max=256030, num_faces=256034
      Valid probs shape: (37, 75874)
    ✓ Random_26 (pose=(-2.1710650636071267, -0.5583857436676878, -2.34408932569602)): shape (37, 800, 800)
      Valid pixels: 70708/640000 (11.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=187, max=255980, num_faces=256034
      Valid probs shape: (37, 70708)
    ✓ Random_27 (pose=(-1.262091193433159, 2.4381348756337182, -2.809392967278361)): shape (37, 800, 800)
      Valid pixels: 84558/640000 (13.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=70, max=255933, num_faces=256034
      Valid probs shape: (37, 84558)
    ✓ Random_28 (pose=(-0.20413370866613034, 2.621459097745337, 1.5362638531323247)): shape (37, 800, 800)
      Valid pixels: 58276/640000 (9.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=23198, max=256029, num_faces=256034
      Valid probs shape: (37, 58276)
    ✓ Random_29 (pose=(-3.100886492253682, -2.1385459882476363, 0.25582621304274067)): shape (37, 800, 800)
      Valid pixels: 63181/640000 (9.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=255130, num_faces=256034
      Valid probs shape: (37, 63181)
    ✓ Random_30 (pose=(-3.002551722530231, 1.951586714741433, 2.2483744102936667)): shape (37, 800, 800)
      Valid pixels: 68528/640000 (10.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=255933, num_faces=256034
      Valid probs shape: (37, 68528)
    ✓ Random_31 (pose=(-0.14586818069283947, 2.8388947142701086, 2.138278421700446)): shape (37, 800, 800)
      Valid pixels: 40988/640000 (6.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3010, max=256033, num_faces=256034
      Valid probs shape: (37, 40988)
    ✓ Random_32 (pose=(-2.3356454726885985, 0.8560181484082303, 1.9254661095603716)): shape (37, 800, 800)
      Valid pixels: 84353/640000 (13.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=108, max=256033, num_faces=256034
      Valid probs shape: (37, 84353)
    ✓ Random_33 (pose=(-0.24034888800877852, 2.313133910863457, -2.736548584380371)): shape (37, 800, 800)
      Valid pixels: 69102/640000 (10.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=186, max=256033, num_faces=256034
      Valid probs shape: (37, 69102)
    ✓ Random_34 (pose=(1.5050493344673619, 1.009375884659086, -2.2235509475396547)): shape (37, 800, 800)
      Valid pixels: 62967/640000 (9.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=49, max=256030, num_faces=256034
      Valid probs shape: (37, 62967)
    ✓ Random_35 (pose=(-2.381875853320053, -0.4219067624558366, -0.14804009052338785)): shape (37, 800, 800)
      Valid pixels: 77551/640000 (12.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4558, max=256016, num_faces=256034
      Valid probs shape: (37, 77551)
    ✓ Random_36 (pose=(-0.9832665634351541, 2.8579420954923416, -2.529542884953164)): shape (37, 800, 800)
      Valid pixels: 69833/640000 (10.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=185, max=255980, num_faces=256034
      Valid probs shape: (37, 69833)
    ✓ Random_37 (pose=(-3.0012550649882277, 2.0654271441324816, -0.41380268396223663)): shape (37, 800, 800)
      Valid pixels: 58463/640000 (9.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=256030, num_faces=256034
      Valid probs shape: (37, 58463)
    ✓ Random_38 (pose=(-3.005054598414329, -3.1208969707314878, 0.8830832422527584)): shape (37, 800, 800)
      Valid pixels: 42425/640000 (6.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=255830, num_faces=256034
      Valid probs shape: (37, 42425)
    ✓ Random_39 (pose=(-0.6295509800937675, -1.188499778176165, 2.1457321896616373)): shape (37, 800, 800)
      Valid pixels: 87813/640000 (13.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=255933, num_faces=256034
      Valid probs shape: (37, 87813)
    P stats: min=0.0000, max=0.9999, mean=0.0262
    Non-zero vertices: 123876/128019
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 4143 1456 1108 3089    0 2077 1037 4098 6172]
  Ground Truth Stats:
    Labels shape: (128019,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-14/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7922
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8324
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8326

  RESULTS:
  RAW:         median(top-10)=0.9040, mean(top-10)=0.9047, median(all)=0.8636, mean(all)=0.7922
  + SMOOTHING: median(top-10)=0.9239, mean(top-10)=0.9257, median(all)=0.8857, mean(all)=0.8324 [+0.0200]
  + MRF:       median(top-10)=0.9241, mean(top-10)=0.9257, median(all)=0.8851, mean(all)=0.8326 [+0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0201

================================================================================
Subject: OASIS-TRT-20-15
================================================================================
  Step 0: Generating predictions with V2 model (40 random views)...
  Mesh: 121081 vertices, 242158 faces
  Generating 40 random views...
  Generating predictions for 40 views (continuous camera pose)...
    ✓ Random_0 (pose=(-2.36782114818823, -1.9270115088401378, 1.5710026770463328)): shape (37, 800, 800)
      Valid pixels: 61369/640000 (9.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=8, max=242156, num_faces=242158
      Valid probs shape: (37, 61369)
    ✓ Random_1 (pose=(-0.7122955403431863, 3.068042765322975, 1.5357207085461297)): shape (37, 800, 800)
      Valid pixels: 42090/640000 (6.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1879, max=242156, num_faces=242158
      Valid probs shape: (37, 42090)
    ✓ Random_2 (pose=(2.6271242499269594, 1.9877735515025323, 2.577346742614152)): shape (37, 800, 800)
      Valid pixels: 47720/640000 (7.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=242087, num_faces=242158
      Valid probs shape: (37, 47720)
    ✓ Random_3 (pose=(-2.1072252380118353, 1.882192226612431, -0.9358992495990082)): shape (37, 800, 800)
      Valid pixels: 82425/640000 (12.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=241776, num_faces=242158
      Valid probs shape: (37, 82425)
    ✓ Random_4 (pose=(0.980010610308466, -2.5230812044013913, -0.29696308634533874)): shape (37, 800, 800)
      Valid pixels: 76322/640000 (11.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=83, max=242156, num_faces=242158
      Valid probs shape: (37, 76322)
    ✓ Random_5 (pose=(-0.5001239718402646, -3.1382681767131393, 0.9386016596772269)): shape (37, 800, 800)
      Valid pixels: 43788/640000 (6.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3617, max=242153, num_faces=242158
      Valid probs shape: (37, 43788)
    ✓ Random_6 (pose=(-0.5899615599488488, 1.0127997243511677, 3.0645308862773177)): shape (37, 800, 800)
      Valid pixels: 68466/640000 (10.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7, max=242156, num_faces=242158
      Valid probs shape: (37, 68466)
    ✓ Random_7 (pose=(-0.044085776885030015, 0.6062976307464298, -1.8799655153434398)): shape (37, 800, 800)
      Valid pixels: 57576/640000 (9.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=242154, num_faces=242158
      Valid probs shape: (37, 57576)
    ✓ Random_8 (pose=(-2.7646941914787138, 0.1024355508570105, -1.2720787313299402)): shape (37, 800, 800)
      Valid pixels: 46666/640000 (7.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=46882, max=241765, num_faces=242158
      Valid probs shape: (37, 46666)
    ✓ Random_9 (pose=(-1.2039651541161056, -0.16528638410420315, 1.185952965443125)): shape (37, 800, 800)
      Valid pixels: 54228/640000 (8.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=242156, num_faces=242158
      Valid probs shape: (37, 54228)
    ✓ Random_10 (pose=(2.0294023605970075, 3.017499789020312, -2.6801836672098074)): shape (37, 800, 800)
      Valid pixels: 65205/640000 (10.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=242152, num_faces=242158
      Valid probs shape: (37, 65205)
    ✓ Random_11 (pose=(-0.16778339418685206, 0.6017679317410329, 0.8828776121509092)): shape (37, 800, 800)
      Valid pixels: 58987/640000 (9.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=241814, num_faces=242158
      Valid probs shape: (37, 58987)
    ✓ Random_12 (pose=(0.2832873610604487, 1.7015223874537924, 0.5009165558407433)): shape (37, 800, 800)
      Valid pixels: 58367/640000 (9.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=240823, num_faces=242158
      Valid probs shape: (37, 58367)
    ✓ Random_13 (pose=(1.376333539397069, 1.2736220179251818, -2.7307808320471327)): shape (37, 800, 800)
      Valid pixels: 65490/640000 (10.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6, max=242151, num_faces=242158
      Valid probs shape: (37, 65490)
    ✓ Random_14 (pose=(1.517482124859363, -1.8741631810822177, 2.8676175162610287)): shape (37, 800, 800)
      Valid pixels: 83041/640000 (13.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=241775, num_faces=242158
      Valid probs shape: (37, 83041)
    ✓ Random_15 (pose=(2.3308066902502675, -1.2105822140735165, -2.3624613891408623)): shape (37, 800, 800)
      Valid pixels: 52393/640000 (8.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=374, max=242156, num_faces=242158
      Valid probs shape: (37, 52393)
    ✓ Random_16 (pose=(-1.5040780987914089, -2.6280259875292615, 1.4433335221050765)): shape (37, 800, 800)
      Valid pixels: 53722/640000 (8.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=325, max=242156, num_faces=242158
      Valid probs shape: (37, 53722)
    ✓ Random_17 (pose=(1.7523059112826402, -1.8368333926410088, -0.6824810558584242)): shape (37, 800, 800)
      Valid pixels: 85876/640000 (13.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=242156, num_faces=242158
      Valid probs shape: (37, 85876)
    ✓ Random_18 (pose=(-2.4067506560903995, -0.05254244877625114, -2.193714333047062)): shape (37, 800, 800)
      Valid pixels: 52986/640000 (8.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=25, max=242157, num_faces=242158
      Valid probs shape: (37, 52986)
    ✓ Random_19 (pose=(2.1971842728220743, 2.125374475929581, -1.9738169416303968)): shape (37, 800, 800)
      Valid pixels: 63540/640000 (9.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=242156, num_faces=242158
      Valid probs shape: (37, 63540)
    ✓ Random_20 (pose=(-0.6774309990822251, 0.7697152509416489, 1.1772941111962067)): shape (37, 800, 800)
      Valid pixels: 61885/640000 (9.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=241827, num_faces=242158
      Valid probs shape: (37, 61885)
    ✓ Random_21 (pose=(-1.0127660168901498, 1.3576020039742165, 1.5137644459241368)): shape (37, 800, 800)
      Valid pixels: 59307/640000 (9.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=242152, num_faces=242158
      Valid probs shape: (37, 59307)
    ✓ Random_22 (pose=(0.9556764032825393, -2.9925226322684786, -2.190932709252257)): shape (37, 800, 800)
      Valid pixels: 55934/640000 (8.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2047, max=242157, num_faces=242158
      Valid probs shape: (37, 55934)
    ✓ Random_23 (pose=(-0.3087157816564532, -2.644403057482503, -2.4088399743553146)): shape (37, 800, 800)
      Valid pixels: 43841/640000 (6.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=11735, max=240672, num_faces=242158
      Valid probs shape: (37, 43841)
    ✓ Random_24 (pose=(1.2210337514871954, 0.6524449681797022, 2.5492013277393326)): shape (37, 800, 800)
      Valid pixels: 80740/640000 (12.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=241777, num_faces=242158
      Valid probs shape: (37, 80740)
    ✓ Random_25 (pose=(-2.377641129354337, 0.8848867656664119, 0.06853393250009532)): shape (37, 800, 800)
      Valid pixels: 59934/640000 (9.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1348, max=242151, num_faces=242158
      Valid probs shape: (37, 59934)
    ✓ Random_26 (pose=(1.12876832948586, -3.049930464883891, 1.653345078527476)): shape (37, 800, 800)
      Valid pixels: 49626/640000 (7.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=65, max=240809, num_faces=242158
      Valid probs shape: (37, 49626)
    ✓ Random_27 (pose=(-1.4852414594641021, -0.8114613352189552, -2.2994125198373894)): shape (37, 800, 800)
      Valid pixels: 59951/640000 (9.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=242157, num_faces=242158
      Valid probs shape: (37, 59951)
    ✓ Random_28 (pose=(0.7316946789365009, -0.7568728477355049, -0.2696649001195266)): shape (37, 800, 800)
      Valid pixels: 66366/640000 (10.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=242156, num_faces=242158
      Valid probs shape: (37, 66366)
    ✓ Random_29 (pose=(-1.5308457370359072, -2.392735196783372, -1.882955059853274)): shape (37, 800, 800)
      Valid pixels: 52886/640000 (8.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7, max=242157, num_faces=242158
      Valid probs shape: (37, 52886)
    ✓ Random_30 (pose=(-2.903391047899157, -2.069428093370753, -2.2782907124731615)): shape (37, 800, 800)
      Valid pixels: 77784/640000 (12.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=242157, num_faces=242158
      Valid probs shape: (37, 77784)
    ✓ Random_31 (pose=(-2.4058278886319697, 2.027767526491565, -1.7574062716928385)): shape (37, 800, 800)
      Valid pixels: 70132/640000 (11.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=241657, num_faces=242158
      Valid probs shape: (37, 70132)
    ✓ Random_32 (pose=(-2.3818899617491973, -0.8409346394773909, 2.231051558746559)): shape (37, 800, 800)
      Valid pixels: 48308/640000 (7.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=756, max=242156, num_faces=242158
      Valid probs shape: (37, 48308)
    ✓ Random_33 (pose=(0.39894567824187677, 2.3576266695891634, -2.987898926277112)): shape (37, 800, 800)
      Valid pixels: 48318/640000 (7.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=796, max=242156, num_faces=242158
      Valid probs shape: (37, 48318)
    ✓ Random_34 (pose=(0.8480002552773831, 1.1408090014091457, -2.7515429718026905)): shape (37, 800, 800)
      Valid pixels: 57243/640000 (8.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=242156, num_faces=242158
      Valid probs shape: (37, 57243)
    ✓ Random_35 (pose=(0.3501956765968153, 2.536047278600636, 1.1776924928604497)): shape (37, 800, 800)
      Valid pixels: 57795/640000 (9.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5874, max=241767, num_faces=242158
      Valid probs shape: (37, 57795)
    ✓ Random_36 (pose=(2.0050569856005396, 2.9524516416242896, -0.34661329201573166)): shape (37, 800, 800)
      Valid pixels: 79577/640000 (12.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=242157, num_faces=242158
      Valid probs shape: (37, 79577)
    ✓ Random_37 (pose=(0.9984777019800113, 0.08689508787183797, -2.6424337662859836)): shape (37, 800, 800)
      Valid pixels: 61051/640000 (9.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=242146, num_faces=242158
      Valid probs shape: (37, 61051)
    ✓ Random_38 (pose=(1.2873840287319043, -0.6844639904754506, 2.603137148409064)): shape (37, 800, 800)
      Valid pixels: 78429/640000 (12.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=241876, num_faces=242158
      Valid probs shape: (37, 78429)
    ✓ Random_39 (pose=(-2.8325707230894217, -0.3673348027556358, 2.625813322701922)): shape (37, 800, 800)
      Valid pixels: 37011/640000 (5.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=148, max=242153, num_faces=242158
      Valid probs shape: (37, 37011)
    P stats: min=0.0000, max=1.0000, mean=0.0258
    Non-zero vertices: 115377/121081
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 5704 1383 1160 2775    0 1425  859 4377 5056]
  Ground Truth Stats:
    Labels shape: (121081,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-15/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
    MRF iteration 5/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7686
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8101
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8100

  RESULTS:
  RAW:         median(top-10)=0.9011, mean(top-10)=0.9021, median(all)=0.8275, mean(all)=0.7686
  + SMOOTHING: median(top-10)=0.9230, mean(top-10)=0.9228, median(all)=0.8547, mean(all)=0.8101 [+0.0220]
  + MRF:       median(top-10)=0.9229, mean(top-10)=0.9227, median(all)=0.8544, mean(all)=0.8100 [-0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0219

================================================================================
Subject: OASIS-TRT-20-16
================================================================================
  Step 0: Generating predictions with V2 model (40 random views)...
  Mesh: 137726 vertices, 275448 faces
  Generating 40 random views...
  Generating predictions for 40 views (continuous camera pose)...
    ✓ Random_0 (pose=(-2.143332645768808, -2.5321741122728163, 1.700923560086535)): shape (37, 800, 800)
      Valid pixels: 60119/640000 (9.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=275342, num_faces=275448
      Valid probs shape: (37, 60119)
    ✓ Random_1 (pose=(1.4761372035036322, 2.1844309502164405, 2.495100552944047)): shape (37, 800, 800)
      Valid pixels: 112345/640000 (17.6%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=4, max=275446, num_faces=275448
      Valid probs shape: (37, 112345)
    ✓ Random_2 (pose=(0.8652223048515166, 0.6297812202979785, 2.74040266654856)): shape (37, 800, 800)
      Valid pixels: 92852/640000 (14.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=2, max=275193, num_faces=275448
      Valid probs shape: (37, 92852)
    ✓ Random_3 (pose=(-2.2503551228462633, 0.8812080172126997, -0.712050450044801)): shape (37, 800, 800)
      Valid pixels: 105735/640000 (16.5%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=552, max=275446, num_faces=275448
      Valid probs shape: (37, 105735)
    ✓ Random_4 (pose=(2.963344471177768, -2.2453267294318646, 0.19092402570864309)): shape (37, 800, 800)
      Valid pixels: 66471/640000 (10.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=275386, num_faces=275448
      Valid probs shape: (37, 66471)
    ✓ Random_5 (pose=(-2.0129747843565413, -0.4798112174172178, 2.688747293090123)): shape (37, 800, 800)
      Valid pixels: 112400/640000 (17.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=24, max=275445, num_faces=275448
      Valid probs shape: (37, 112400)
    ✓ Random_6 (pose=(-0.047872277540338626, 1.6295183524216013, -1.342959161884281)): shape (37, 800, 800)
      Valid pixels: 103750/640000 (16.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=275447, num_faces=275448
      Valid probs shape: (37, 103750)
    ✓ Random_7 (pose=(2.547267650543903, 0.2189330102222251, 2.4114729231981533)): shape (37, 800, 800)
      Valid pixels: 76306/640000 (11.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=24390, max=275447, num_faces=275448
      Valid probs shape: (37, 76306)
    ✓ Random_8 (pose=(-2.5085444351198882, 0.1905389397869821, 2.7832408109356264)): shape (37, 800, 800)
      Valid pixels: 81172/640000 (12.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=69, max=275443, num_faces=275448
      Valid probs shape: (37, 81172)
    ✓ Random_9 (pose=(1.6130966872917138, -0.7416949384663503, -0.29909163738708067)): shape (37, 800, 800)
      Valid pixels: 120292/640000 (18.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=275433, num_faces=275448
      Valid probs shape: (37, 120292)
    ✓ Random_10 (pose=(2.7038460615125377, -2.9739492732073742, -1.59678881977656)): shape (37, 800, 800)
      Valid pixels: 55081/640000 (8.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=275328, num_faces=275448
      Valid probs shape: (37, 55081)
    ✓ Random_11 (pose=(-2.4272310507130217, 0.26149533018445803, 0.002795565485627094)): shape (37, 800, 800)
      Valid pixels: 85250/640000 (13.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7390, max=275446, num_faces=275448
      Valid probs shape: (37, 85250)
    ✓ Random_12 (pose=(-2.853477788155896, 0.7099797921898428, 1.9584359889276088)): shape (37, 800, 800)
      Valid pixels: 86169/640000 (13.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=47, max=275443, num_faces=275448
      Valid probs shape: (37, 86169)
    ✓ Random_13 (pose=(-1.8997520846028138, -2.0803018152573367, -2.984561933438423)): shape (37, 800, 800)
      Valid pixels: 116178/640000 (18.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=11, max=275445, num_faces=275448
      Valid probs shape: (37, 116178)
    ✓ Random_14 (pose=(1.0640610095703185, 0.27422929067071955, 2.771689232929937)): shape (37, 800, 800)
      Valid pixels: 102709/640000 (16.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=2, max=275380, num_faces=275448
      Valid probs shape: (37, 102709)
    ✓ Random_15 (pose=(0.29253660824294947, -2.9681424495946724, 2.842817134644428)): shape (37, 800, 800)
      Valid pixels: 64096/640000 (10.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=36949, max=275447, num_faces=275448
      Valid probs shape: (37, 64096)
    ✓ Random_16 (pose=(1.039541127256613, 0.7059625569298524, 0.8658321046681525)): shape (37, 800, 800)
      Valid pixels: 69731/640000 (10.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=275447, num_faces=275448
      Valid probs shape: (37, 69731)
    ✓ Random_17 (pose=(1.121914493311471, -1.7030202292454886, 2.1258626311682463)): shape (37, 800, 800)
      Valid pixels: 76886/640000 (12.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=12, max=275447, num_faces=275448
      Valid probs shape: (37, 76886)
    ✓ Random_18 (pose=(0.14696890539397467, 2.1339866853662643, 1.8026674682831398)): shape (37, 800, 800)
      Valid pixels: 98184/640000 (15.3%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=2008, max=275444, num_faces=275448
      Valid probs shape: (37, 98184)
    ✓ Random_19 (pose=(0.40247956284193087, 0.20468601639682316, -1.692205879074133)): shape (37, 800, 800)
      Valid pixels: 54551/640000 (8.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=275334, num_faces=275448
      Valid probs shape: (37, 54551)
    ✓ Random_20 (pose=(1.3444941614911219, -0.8557946600488404, 2.937706659275526)): shape (37, 800, 800)
      Valid pixels: 112515/640000 (17.6%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=4, max=275439, num_faces=275448
      Valid probs shape: (37, 112515)
    ✓ Random_21 (pose=(-0.3580090345160136, -1.1277792604862125, -0.6215345564076151)): shape (37, 800, 800)
      Valid pixels: 79537/640000 (12.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=275342, num_faces=275448
      Valid probs shape: (37, 79537)
    ✓ Random_22 (pose=(-0.11836694011403459, 3.138365942924362, -1.0295715663078955)): shape (37, 800, 800)
      Valid pixels: 52000/640000 (8.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=19507, max=275447, num_faces=275448
      Valid probs shape: (37, 52000)
    ✓ Random_23 (pose=(1.0357686146165985, -0.4722532830795978, -2.1178440037053057)): shape (37, 800, 800)
      Valid pixels: 71790/640000 (11.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=275342, num_faces=275448
      Valid probs shape: (37, 71790)
    ✓ Random_24 (pose=(0.768233797234068, 0.4108989151425977, 3.12784220464194)): shape (37, 800, 800)
      Valid pixels: 77332/640000 (12.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=274930, num_faces=275448
      Valid probs shape: (37, 77332)
    ✓ Random_25 (pose=(1.9649894206113858, -1.3265297873081778, 0.0236093459872726)): shape (37, 800, 800)
      Valid pixels: 97607/640000 (15.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=275447, num_faces=275448
      Valid probs shape: (37, 97607)
    ✓ Random_26 (pose=(0.5032875022889969, 0.2283908584966352, -2.829321694078346)): shape (37, 800, 800)
      Valid pixels: 59429/640000 (9.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=274930, num_faces=275448
      Valid probs shape: (37, 59429)
    ✓ Random_27 (pose=(-2.2451253470390538, 2.191719751258937, -1.3094253357076697)): shape (37, 800, 800)
      Valid pixels: 106518/640000 (16.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=2, max=275384, num_faces=275448
      Valid probs shape: (37, 106518)
    ✓ Random_28 (pose=(2.886381695355695, -1.485263986645896, 0.3492473202351576)): shape (37, 800, 800)
      Valid pixels: 75740/640000 (11.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=275447, num_faces=275448
      Valid probs shape: (37, 75740)
    ✓ Random_29 (pose=(-2.1151752296974964, 0.8097842151841186, -2.9265673220658743)): shape (37, 800, 800)
      Valid pixels: 82780/640000 (12.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=15, max=275447, num_faces=275448
      Valid probs shape: (37, 82780)
    ✓ Random_30 (pose=(-2.194515533273179, -0.581562963148837, 2.5435655380251214)): shape (37, 800, 800)
      Valid pixels: 100021/640000 (15.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=234, max=275443, num_faces=275448
      Valid probs shape: (37, 100021)
    ✓ Random_31 (pose=(1.8448954038493106, -2.52300917913528, 0.5522167991730655)): shape (37, 800, 800)
      Valid pixels: 84188/640000 (13.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=11, max=275447, num_faces=275448
      Valid probs shape: (37, 84188)
    ✓ Random_32 (pose=(-2.1108819182079865, 0.09403278370362722, 1.1077876244270692)): shape (37, 800, 800)
      Valid pixels: 75016/640000 (11.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=2678, max=275342, num_faces=275448
      Valid probs shape: (37, 75016)
    ✓ Random_33 (pose=(-0.6678684732713545, 0.06291984470389211, 2.9954040724238267)): shape (37, 800, 800)
      Valid pixels: 82803/640000 (12.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=275445, num_faces=275448
      Valid probs shape: (37, 82803)
    ✓ Random_34 (pose=(2.9835477841913303, 1.8547960561766716, 1.801132893521042)): shape (37, 800, 800)
      Valid pixels: 95632/640000 (14.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=275447, num_faces=275448
      Valid probs shape: (37, 95632)
    ✓ Random_35 (pose=(1.5562580927787923, 0.7321410888818685, -2.2155672765719086)): shape (37, 800, 800)
      Valid pixels: 76354/640000 (11.9%)
      Probs stats: min=0.0000, max=0.9995, mean=0.0270
      Face IDs: min=33, max=275342, num_faces=275448
      Valid probs shape: (37, 76354)
    ✓ Random_36 (pose=(-0.8594307725574395, -1.545481903145454, -1.7243175843181058)): shape (37, 800, 800)
      Valid pixels: 102109/640000 (16.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=2, max=275447, num_faces=275448
      Valid probs shape: (37, 102109)
    ✓ Random_37 (pose=(2.4896877581659247, -1.257958447100614, 2.5148884912426315)): shape (37, 800, 800)
      Valid pixels: 96616/640000 (15.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=119, max=275443, num_faces=275448
      Valid probs shape: (37, 96616)
    ✓ Random_38 (pose=(-1.569464139518133, 1.6530764206166317, -1.2109441786847233)): shape (37, 800, 800)
      Valid pixels: 92922/640000 (14.5%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=2, max=275447, num_faces=275448
      Valid probs shape: (37, 92922)
    ✓ Random_39 (pose=(-1.5717057621539954, 2.1147114177949042, -1.8444701530225631)): shape (37, 800, 800)
      Valid pixels: 68212/640000 (10.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=26, max=275447, num_faces=275448
      Valid probs shape: (37, 68212)
    P stats: min=0.0000, max=0.9998, mean=0.0262
    Non-zero vertices: 133658/137726
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 4068 1552  927 3744    0 1764  976 5207 7596]
  Ground Truth Stats:
    Labels shape: (137726,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-16/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7885
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8335
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8340

  RESULTS:
  RAW:         median(top-10)=0.9129, mean(top-10)=0.9162, median(all)=0.8501, mean(all)=0.7885
  + SMOOTHING: median(top-10)=0.9302, mean(top-10)=0.9324, median(all)=0.8776, mean(all)=0.8335 [+0.0173]
  + MRF:       median(top-10)=0.9303, mean(top-10)=0.9326, median(all)=0.8774, mean(all)=0.8340 [+0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0174

================================================================================
Subject: OASIS-TRT-20-17
================================================================================
  Step 0: Generating predictions with V2 model (40 random views)...
  Mesh: 148245 vertices, 296486 faces
  Generating 40 random views...
  Generating predictions for 40 views (continuous camera pose)...
    ✓ Random_0 (pose=(-2.8916004364445134, -1.879662789638543, -2.6622444737608726)): shape (37, 800, 800)
      Valid pixels: 97831/640000 (15.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=296476, num_faces=296486
      Valid probs shape: (37, 97831)
    ✓ Random_1 (pose=(-2.1920062038743, -0.9449373350225483, 3.0400040311134156)): shape (37, 800, 800)
      Valid pixels: 111908/640000 (17.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=41, max=296485, num_faces=296486
      Valid probs shape: (37, 111908)
    ✓ Random_2 (pose=(-2.0493080202887244, 2.4575064484984983, 2.5076077677949637)): shape (37, 800, 800)
      Valid pixels: 106631/640000 (16.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=296477, num_faces=296486
      Valid probs shape: (37, 106631)
    ✓ Random_3 (pose=(-0.6935972962937185, 1.7371005488691393, -1.478308040602046)): shape (37, 800, 800)
      Valid pixels: 83424/640000 (13.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=10, max=296477, num_faces=296486
      Valid probs shape: (37, 83424)
    ✓ Random_4 (pose=(0.8426548625346872, -2.7848152747482384, -1.051197278325387)): shape (37, 800, 800)
      Valid pixels: 79506/640000 (12.4%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=983, max=296485, num_faces=296486
      Valid probs shape: (37, 79506)
    ✓ Random_5 (pose=(-2.298855067534727, 1.0761252623272481, -1.9062402659143776)): shape (37, 800, 800)
      Valid pixels: 81368/640000 (12.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=427, max=296396, num_faces=296486
      Valid probs shape: (37, 81368)
    ✓ Random_6 (pose=(1.9062743175974486, 1.2317555109569076, -1.2028280769974384)): shape (37, 800, 800)
      Valid pixels: 74086/640000 (11.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=41, max=296485, num_faces=296486
      Valid probs shape: (37, 74086)
    ✓ Random_7 (pose=(-1.5017390712636471, 1.171816276838043, 3.0224123641929417)): shape (37, 800, 800)
      Valid pixels: 117366/640000 (18.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=10, max=296477, num_faces=296486
      Valid probs shape: (37, 117366)
    ✓ Random_8 (pose=(-2.3096711399199363, -1.7916335279555953, -1.807985051350131)): shape (37, 800, 800)
      Valid pixels: 91944/640000 (14.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=296477, num_faces=296486
      Valid probs shape: (37, 91944)
    ✓ Random_9 (pose=(0.15973930319709018, -2.3483449652043844, 1.205110650164177)): shape (37, 800, 800)
      Valid pixels: 96652/640000 (15.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=428, max=296477, num_faces=296486
      Valid probs shape: (37, 96652)
    ✓ Random_10 (pose=(1.024689047818855, -2.4551651584973277, 1.9458143939278143)): shape (37, 800, 800)
      Valid pixels: 61049/640000 (9.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5477, max=296398, num_faces=296486
      Valid probs shape: (37, 61049)
    ✓ Random_11 (pose=(-0.9231735982049658, -2.1530174195609244, -1.5683806934266284)): shape (37, 800, 800)
      Valid pixels: 92598/640000 (14.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2594, max=296456, num_faces=296486
      Valid probs shape: (37, 92598)
    ✓ Random_12 (pose=(-2.4858733091608807, 0.9641529790196852, 2.233691728532678)): shape (37, 800, 800)
      Valid pixels: 109469/640000 (17.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=429, max=296477, num_faces=296486
      Valid probs shape: (37, 109469)
    ✓ Random_13 (pose=(-1.2962720586374747, -2.4191581426248114, 0.16386245121389065)): shape (37, 800, 800)
      Valid pixels: 95012/640000 (14.8%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=12, max=296396, num_faces=296486
      Valid probs shape: (37, 95012)
    ✓ Random_14 (pose=(-0.5497166581042356, -0.006784297094652114, 2.9890454419156143)): shape (37, 800, 800)
      Valid pixels: 69587/640000 (10.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=296477, num_faces=296486
      Valid probs shape: (37, 69587)
    ✓ Random_15 (pose=(1.5076253351348274, -2.597913906924902, 1.1193379534991692)): shape (37, 800, 800)
      Valid pixels: 73735/640000 (11.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=10, max=296477, num_faces=296486
      Valid probs shape: (37, 73735)
    ✓ Random_16 (pose=(-1.1636619742015402, 1.776993286955146, -0.593896563107438)): shape (37, 800, 800)
      Valid pixels: 99437/640000 (15.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=8, max=296396, num_faces=296486
      Valid probs shape: (37, 99437)
    ✓ Random_17 (pose=(-2.6578771584872123, 1.0542594649481485, 2.259784627770772)): shape (37, 800, 800)
      Valid pixels: 103867/640000 (16.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=429, max=296477, num_faces=296486
      Valid probs shape: (37, 103867)
    ✓ Random_18 (pose=(-0.03127225096452069, -2.363398486946571, -1.8763406981240636)): shape (37, 800, 800)
      Valid pixels: 88988/640000 (13.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=9399, max=296396, num_faces=296486
      Valid probs shape: (37, 88988)
    ✓ Random_19 (pose=(1.821614702894137, 1.8687000621818317, -1.5669126542228895)): shape (37, 800, 800)
      Valid pixels: 67775/640000 (10.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=29, max=296485, num_faces=296486
      Valid probs shape: (37, 67775)
    ✓ Random_20 (pose=(1.8125252825457707, 2.5065735951403827, -2.6662405454573253)): shape (37, 800, 800)
      Valid pixels: 93740/640000 (14.6%)
      Probs stats: min=0.0000, max=0.9995, mean=0.0270
      Face IDs: min=0, max=296396, num_faces=296486
      Valid probs shape: (37, 93740)
    ✓ Random_21 (pose=(0.5269995067380666, 2.4403133310477125, 1.0152099958925191)): shape (37, 800, 800)
      Valid pixels: 67197/640000 (10.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=14908, max=296396, num_faces=296486
      Valid probs shape: (37, 67197)
    ✓ Random_22 (pose=(-2.543401193448404, -2.532930558370331, 0.63541815440274)): shape (37, 800, 800)
      Valid pixels: 95094/640000 (14.9%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=8, max=295640, num_faces=296486
      Valid probs shape: (37, 95094)
    ✓ Random_23 (pose=(3.03215077414095, -2.820683499770123, 1.9595458557227055)): shape (37, 800, 800)
      Valid pixels: 67936/640000 (10.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=294819, num_faces=296486
      Valid probs shape: (37, 67936)
    ✓ Random_24 (pose=(-2.0920753973624286, -1.2364482469703413, -2.100604517860781)): shape (37, 800, 800)
      Valid pixels: 93318/640000 (14.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=10, max=296477, num_faces=296486
      Valid probs shape: (37, 93318)
    ✓ Random_25 (pose=(0.04759739977794286, 2.1084224821715427, -0.33327131187427517)): shape (37, 800, 800)
      Valid pixels: 61313/640000 (9.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1072, max=296477, num_faces=296486
      Valid probs shape: (37, 61313)
    ✓ Random_26 (pose=(1.2884594740683317, -0.3621161825824233, -2.3665211712321303)): shape (37, 800, 800)
      Valid pixels: 79441/640000 (12.4%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=0, max=296396, num_faces=296486
      Valid probs shape: (37, 79441)
    ✓ Random_27 (pose=(1.889356929982677, -0.25553704606776195, 1.3402135901358498)): shape (37, 800, 800)
      Valid pixels: 62677/640000 (9.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3476, max=296477, num_faces=296486
      Valid probs shape: (37, 62677)
    ✓ Random_28 (pose=(-1.4835997332443975, 0.7637981505486056, 0.31082009750306616)): shape (37, 800, 800)
      Valid pixels: 98306/640000 (15.4%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=0, max=296396, num_faces=296486
      Valid probs shape: (37, 98306)
    ✓ Random_29 (pose=(-0.8181277348130465, -0.24476927018565053, 0.9223105669491796)): shape (37, 800, 800)
      Valid pixels: 56317/640000 (8.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7, max=296470, num_faces=296486
      Valid probs shape: (37, 56317)
    ✓ Random_30 (pose=(0.4332316070318156, 0.5859443358560927, 0.9576836258964052)): shape (37, 800, 800)
      Valid pixels: 75674/640000 (11.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=289268, num_faces=296486
      Valid probs shape: (37, 75674)
    ✓ Random_31 (pose=(1.81944222104587, -0.05630743244430869, 0.5741083124419526)): shape (37, 800, 800)
      Valid pixels: 90372/640000 (14.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=10, max=296477, num_faces=296486
      Valid probs shape: (37, 90372)
    ✓ Random_32 (pose=(-0.8212434203219785, -0.5565186204730344, -1.2919329254350513)): shape (37, 800, 800)
      Valid pixels: 99314/640000 (15.5%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=7, max=295588, num_faces=296486
      Valid probs shape: (37, 99314)
    ✓ Random_33 (pose=(2.9046061149411475, -0.2539202360561541, 1.1632167156474953)): shape (37, 800, 800)
      Valid pixels: 53381/640000 (8.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=76476, max=296485, num_faces=296486
      Valid probs shape: (37, 53381)
    ✓ Random_34 (pose=(-1.4388576532039667, -1.9350414429307217, -2.0881963997465203)): shape (37, 800, 800)
      Valid pixels: 71650/640000 (11.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=12, max=296477, num_faces=296486
      Valid probs shape: (37, 71650)
    ✓ Random_35 (pose=(0.18453531345687058, 2.1276612980632867, -0.8771251475279755)): shape (37, 800, 800)
      Valid pixels: 85986/640000 (13.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=32, max=296477, num_faces=296486
      Valid probs shape: (37, 85986)
    ✓ Random_36 (pose=(0.057277496177642995, -2.6758681515526064, 2.577626795878121)): shape (37, 800, 800)
      Valid pixels: 48811/640000 (7.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6976, max=296475, num_faces=296486
      Valid probs shape: (37, 48811)
    ✓ Random_37 (pose=(1.9715208071910055, 2.634733642249807, 2.5272844773061047)): shape (37, 800, 800)
      Valid pixels: 105868/640000 (16.5%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=5, max=296396, num_faces=296486
      Valid probs shape: (37, 105868)
    ✓ Random_38 (pose=(-0.2917336029685984, 1.1644185877939321, 2.77858840633103)): shape (37, 800, 800)
      Valid pixels: 60357/640000 (9.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=3, max=296485, num_faces=296486
      Valid probs shape: (37, 60357)
    ✓ Random_39 (pose=(-1.8323061618381542, 1.2767420079497889, 2.6791714965336144)): shape (37, 800, 800)
      Valid pixels: 118308/640000 (18.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=10, max=296477, num_faces=296486
      Valid probs shape: (37, 118308)
    P stats: min=0.0000, max=0.9998, mean=0.0259
    Non-zero vertices: 141847/148245
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 6398 1136 1171 4518    0 1859 1184 5229 6287]
  Ground Truth Stats:
    Labels shape: (148245,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-17/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7592
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8071
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8076

  RESULTS:
  RAW:         median(top-10)=0.8889, mean(top-10)=0.8885, median(all)=0.8207, mean(all)=0.7592
  + SMOOTHING: median(top-10)=0.9149, mean(top-10)=0.9125, median(all)=0.8456, mean(all)=0.8071 [+0.0259]
  + MRF:       median(top-10)=0.9156, mean(top-10)=0.9130, median(all)=0.8463, mean(all)=0.8076 [+0.0007]
  TOTAL IMPROVEMENT (median top-10): +0.0266

================================================================================
Subject: OASIS-TRT-20-18
================================================================================
  Step 0: Generating predictions with V2 model (40 random views)...
  Mesh: 140676 vertices, 281348 faces
  Generating 40 random views...
  Generating predictions for 40 views (continuous camera pose)...
    ✓ Random_0 (pose=(-1.473274446871421, 2.5184963704308956, -1.3327980806287063)): shape (37, 800, 800)
      Valid pixels: 71901/640000 (11.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=281305, num_faces=281348
      Valid probs shape: (37, 71901)
    ✓ Random_1 (pose=(-3.112753506003648, -2.8254151387075974, -1.513816703617718)): shape (37, 800, 800)
      Valid pixels: 45283/640000 (7.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=281345, num_faces=281348
      Valid probs shape: (37, 45283)
    ✓ Random_2 (pose=(-0.9227911980309655, 1.1048031719936136, -2.342701222925949)): shape (37, 800, 800)
      Valid pixels: 78718/640000 (12.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=281345, num_faces=281348
      Valid probs shape: (37, 78718)
    ✓ Random_3 (pose=(0.8924030648871168, -3.081919509890343, 2.980944840330703)): shape (37, 800, 800)
      Valid pixels: 76897/640000 (12.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4783, max=281300, num_faces=281348
      Valid probs shape: (37, 76897)
    ✓ Random_4 (pose=(-2.8752693067914565, 2.1193706681959137, 0.06251905465205532)): shape (37, 800, 800)
      Valid pixels: 56014/640000 (8.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=281250, num_faces=281348
      Valid probs shape: (37, 56014)
    ✓ Random_5 (pose=(1.5524258360964147, -2.0990943121371886, -2.950580374877716)): shape (37, 800, 800)
      Valid pixels: 76733/640000 (12.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=13, max=281301, num_faces=281348
      Valid probs shape: (37, 76733)
    ✓ Random_6 (pose=(-1.5798897323953134, -0.4045391038842103, 0.855478184405758)): shape (37, 800, 800)
      Valid pixels: 65168/640000 (10.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=32, max=281249, num_faces=281348
      Valid probs shape: (37, 65168)
    ✓ Random_7 (pose=(1.3055115464828893, -1.3536817647807304, 2.398928546097352)): shape (37, 800, 800)
      Valid pixels: 85403/640000 (13.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=30, max=281300, num_faces=281348
      Valid probs shape: (37, 85403)
    ✓ Random_8 (pose=(0.7241695103044639, -2.1694858554695005, -0.5774132833567078)): shape (37, 800, 800)
      Valid pixels: 71195/640000 (11.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=315, max=281347, num_faces=281348
      Valid probs shape: (37, 71195)
    ✓ Random_9 (pose=(-0.45387496413997086, -0.9217386023212382, 0.33073485862926866)): shape (37, 800, 800)
      Valid pixels: 55262/640000 (8.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=281248, num_faces=281348
      Valid probs shape: (37, 55262)
    ✓ Random_10 (pose=(-0.6928030355419668, -2.5819612765559623, 1.7852720710860197)): shape (37, 800, 800)
      Valid pixels: 74878/640000 (11.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=347, max=281347, num_faces=281348
      Valid probs shape: (37, 74878)
    ✓ Random_11 (pose=(0.05039757259605793, 2.5519210398927337, 0.6322112011144005)): shape (37, 800, 800)
      Valid pixels: 62901/640000 (9.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=24641, max=281305, num_faces=281348
      Valid probs shape: (37, 62901)
    ✓ Random_12 (pose=(0.4320254000244059, 0.3530341463988331, 1.8869570671452758)): shape (37, 800, 800)
      Valid pixels: 60653/640000 (9.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=279813, num_faces=281348
      Valid probs shape: (37, 60653)
    ✓ Random_13 (pose=(-1.562960585770045, 3.023970126610968, 1.6988417275006347)): shape (37, 800, 800)
      Valid pixels: 71349/640000 (11.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=26, max=281347, num_faces=281348
      Valid probs shape: (37, 71349)
    ✓ Random_14 (pose=(-0.0029812821866217476, 0.31566737279970924, 0.41421814799565393)): shape (37, 800, 800)
      Valid pixels: 48308/640000 (7.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=279820, num_faces=281348
      Valid probs shape: (37, 48308)
    ✓ Random_15 (pose=(3.117599358242656, 3.01143743375931, 2.979997722233442)): shape (37, 800, 800)
      Valid pixels: 41749/640000 (6.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=280421, num_faces=281348
      Valid probs shape: (37, 41749)
    ✓ Random_16 (pose=(-1.096629370544111, -3.08524697831308, 2.0281531984202497)): shape (37, 800, 800)
      Valid pixels: 78959/640000 (12.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=316, max=281347, num_faces=281348
      Valid probs shape: (37, 78959)
    ✓ Random_17 (pose=(-2.3677722148264984, -2.233534253273385, 0.6525473563888675)): shape (37, 800, 800)
      Valid pixels: 74899/640000 (11.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=281249, num_faces=281348
      Valid probs shape: (37, 74899)
    ✓ Random_18 (pose=(2.1666042912572543, -1.907654708477028, 2.2462743606506965)): shape (37, 800, 800)
      Valid pixels: 86537/640000 (13.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=18, max=281235, num_faces=281348
      Valid probs shape: (37, 86537)
    ✓ Random_19 (pose=(-0.9814791342639864, 0.9477054445977444, -1.4577882025825097)): shape (37, 800, 800)
      Valid pixels: 57138/640000 (8.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=281345, num_faces=281348
      Valid probs shape: (37, 57138)
    ✓ Random_20 (pose=(-2.3479955266532753, 1.6465873230071795, 1.5227255356349216)): shape (37, 800, 800)
      Valid pixels: 91346/640000 (14.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=281347, num_faces=281348
      Valid probs shape: (37, 91346)
    ✓ Random_21 (pose=(3.072084915793872, -0.9366798674010055, -1.2591158860333205)): shape (37, 800, 800)
      Valid pixels: 70987/640000 (11.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=55, max=281346, num_faces=281348
      Valid probs shape: (37, 70987)
    ✓ Random_22 (pose=(-2.519275930387119, 2.81238950115909, -0.282902724285504)): shape (37, 800, 800)
      Valid pixels: 60300/640000 (9.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=280405, num_faces=281348
      Valid probs shape: (37, 60300)
    ✓ Random_23 (pose=(-0.17188887121023688, -2.0563039953849755, -2.2208051342420543)): shape (37, 800, 800)
      Valid pixels: 83178/640000 (13.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=161, max=281305, num_faces=281348
      Valid probs shape: (37, 83178)
    ✓ Random_24 (pose=(0.4700713279429798, 2.0715488337150365, -1.4604715959207433)): shape (37, 800, 800)
      Valid pixels: 86003/640000 (13.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=310, max=281347, num_faces=281348
      Valid probs shape: (37, 86003)
    ✓ Random_25 (pose=(1.880266775358609, 3.084334639633447, -0.1687748226832384)): shape (37, 800, 800)
      Valid pixels: 87988/640000 (13.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=281346, num_faces=281348
      Valid probs shape: (37, 87988)
    ✓ Random_26 (pose=(-2.5150758731944145, 0.01887131166820577, -0.7249166429798386)): shape (37, 800, 800)
      Valid pixels: 67831/640000 (10.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=38136, max=281305, num_faces=281348
      Valid probs shape: (37, 67831)
    ✓ Random_27 (pose=(-0.4057621370404374, 1.3844441102313132, 1.6786528390902031)): shape (37, 800, 800)
      Valid pixels: 68181/640000 (10.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=281296, num_faces=281348
      Valid probs shape: (37, 68181)
    ✓ Random_28 (pose=(2.624581642983838, 1.0489588528803688, -0.017078828072749186)): shape (37, 800, 800)
      Valid pixels: 81776/640000 (12.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=315, max=281347, num_faces=281348
      Valid probs shape: (37, 81776)
    ✓ Random_29 (pose=(2.6610706782105815, 3.1063756550862758, 0.19654869865439117)): shape (37, 800, 800)
      Valid pixels: 52416/640000 (8.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=281345, num_faces=281348
      Valid probs shape: (37, 52416)
    ✓ Random_30 (pose=(-0.9536739254779341, -3.106375107681226, -1.6981141502950108)): shape (37, 800, 800)
      Valid pixels: 54288/640000 (8.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2769, max=281305, num_faces=281348
      Valid probs shape: (37, 54288)
    ✓ Random_31 (pose=(-2.273933907946773, -1.0015218292643246, 1.2851258583442968)): shape (37, 800, 800)
      Valid pixels: 65386/640000 (10.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=277, max=281250, num_faces=281348
      Valid probs shape: (37, 65386)
    ✓ Random_32 (pose=(2.7420933490239108, -1.6549167354698655, 2.242713734566963)): shape (37, 800, 800)
      Valid pixels: 73663/640000 (11.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8, max=281301, num_faces=281348
      Valid probs shape: (37, 73663)
    ✓ Random_33 (pose=(-2.0880916375775707, 0.5879444258807065, 2.236666001492118)): shape (37, 800, 800)
      Valid pixels: 87294/640000 (13.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=317, max=281347, num_faces=281348
      Valid probs shape: (37, 87294)
    ✓ Random_34 (pose=(-2.536184236162182, -1.590648259090474, -1.977224529045875)): shape (37, 800, 800)
      Valid pixels: 82452/640000 (12.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=281346, num_faces=281348
      Valid probs shape: (37, 82452)
    ✓ Random_35 (pose=(1.3463555190109178, -1.405518711755826, -1.9190241072625231)): shape (37, 800, 800)
      Valid pixels: 63920/640000 (10.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=11, max=281250, num_faces=281348
      Valid probs shape: (37, 63920)
    ✓ Random_36 (pose=(0.348742607350931, 0.503084370430845, -0.23252404502872093)): shape (37, 800, 800)
      Valid pixels: 51774/640000 (8.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=281345, num_faces=281348
      Valid probs shape: (37, 51774)
    ✓ Random_37 (pose=(2.116735326561372, 0.6414844943912854, 0.48793425054593564)): shape (37, 800, 800)
      Valid pixels: 78655/640000 (12.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=56, max=281344, num_faces=281348
      Valid probs shape: (37, 78655)
    ✓ Random_38 (pose=(-0.09035254588833164, 3.032836341316024, 1.6051284328337028)): shape (37, 800, 800)
      Valid pixels: 41092/640000 (6.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5938, max=281298, num_faces=281348
      Valid probs shape: (37, 41092)
    ✓ Random_39 (pose=(-1.8130447619801326, -1.3906855228273953, -0.728959533209498)): shape (37, 800, 800)
      Valid pixels: 86535/640000 (13.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=12, max=281300, num_faces=281348
      Valid probs shape: (37, 86535)
    P stats: min=0.0000, max=1.0000, mean=0.0262
    Non-zero vertices: 136418/140676
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 4258 1422 1029 3535    0 2276 1153 4611 6809]
  Ground Truth Stats:
    Labels shape: (140676,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-18/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7813
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8315
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8318

  RESULTS:
  RAW:         median(top-10)=0.9014, mean(top-10)=0.9051, median(all)=0.8535, mean(all)=0.7813
  + SMOOTHING: median(top-10)=0.9148, mean(top-10)=0.9242, median(all)=0.8749, mean(all)=0.8315 [+0.0134]
  + MRF:       median(top-10)=0.9153, mean(top-10)=0.9245, median(all)=0.8753, mean(all)=0.8318 [+0.0005]
  TOTAL IMPROVEMENT (median top-10): +0.0139

================================================================================
Subject: OASIS-TRT-20-19
================================================================================
  Step 0: Generating predictions with V2 model (40 random views)...
  Mesh: 114731 vertices, 229458 faces
  Generating 40 random views...
  Generating predictions for 40 views (continuous camera pose)...
    ✓ Random_0 (pose=(-0.9899395141297145, -2.018674959773443, -0.967840419219288)): shape (37, 800, 800)
      Valid pixels: 104970/640000 (16.4%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=16, max=229453, num_faces=229458
      Valid probs shape: (37, 104970)
    ✓ Random_1 (pose=(2.406941726090687, -3.0212828648036854, -1.5800316224040776)): shape (37, 800, 800)
      Valid pixels: 58399/640000 (9.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=229402, num_faces=229458
      Valid probs shape: (37, 58399)
    ✓ Random_2 (pose=(2.0922916396564224, 2.3940494001936647, -0.028625323188815166)): shape (37, 800, 800)
      Valid pixels: 103528/640000 (16.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=229407, num_faces=229458
      Valid probs shape: (37, 103528)
    ✓ Random_3 (pose=(-2.6433642596763747, -0.9932998619904452, 1.5825486072288797)): shape (37, 800, 800)
      Valid pixels: 80817/640000 (12.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1376, max=229453, num_faces=229458
      Valid probs shape: (37, 80817)
    ✓ Random_4 (pose=(-1.2469547747636442, 3.1169354030906735, -0.6213152735800658)): shape (37, 800, 800)
      Valid pixels: 101963/640000 (15.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=365, max=229453, num_faces=229458
      Valid probs shape: (37, 101963)
    ✓ Random_5 (pose=(-0.08676921160411766, 2.3352227853955334, -0.5649397310955231)): shape (37, 800, 800)
      Valid pixels: 63503/640000 (9.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=448, max=229457, num_faces=229458
      Valid probs shape: (37, 63503)
    ✓ Random_6 (pose=(0.7434784603985296, -0.4338919636919951, -0.21528649171443615)): shape (37, 800, 800)
      Valid pixels: 82811/640000 (12.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=229407, num_faces=229458
      Valid probs shape: (37, 82811)
    ✓ Random_7 (pose=(2.752684289019321, -2.528102914258059, 2.1563202335086604)): shape (37, 800, 800)
      Valid pixels: 81138/640000 (12.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=0, max=229278, num_faces=229458
      Valid probs shape: (37, 81138)
    ✓ Random_8 (pose=(2.395117842983373, -2.9795029377601097, -0.8371943095076713)): shape (37, 800, 800)
      Valid pixels: 78561/640000 (12.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=229407, num_faces=229458
      Valid probs shape: (37, 78561)
    ✓ Random_9 (pose=(-0.9207249754142093, 0.7693618572427248, 0.673067167010474)): shape (37, 800, 800)
      Valid pixels: 87632/640000 (13.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=229453, num_faces=229458
      Valid probs shape: (37, 87632)
    ✓ Random_10 (pose=(-0.12443559303322083, 2.3190370251856978, 1.0325581092089493)): shape (37, 800, 800)
      Valid pixels: 90338/640000 (14.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=7105, max=229457, num_faces=229458
      Valid probs shape: (37, 90338)
    ✓ Random_11 (pose=(3.0924319097699096, 1.440466470217853, -1.9449040762314165)): shape (37, 800, 800)
      Valid pixels: 106363/640000 (16.6%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=5, max=229453, num_faces=229458
      Valid probs shape: (37, 106363)
    ✓ Random_12 (pose=(0.1530041387420047, -3.1020240308710285, -0.7611470501471529)): shape (37, 800, 800)
      Valid pixels: 49527/640000 (7.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2608, max=229457, num_faces=229458
      Valid probs shape: (37, 49527)
    ✓ Random_13 (pose=(2.5417959362203675, -1.6287802807891272, 1.1371089279673168)): shape (37, 800, 800)
      Valid pixels: 96526/640000 (15.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=25, max=229453, num_faces=229458
      Valid probs shape: (37, 96526)
    ✓ Random_14 (pose=(2.38322130006999, -1.4551238499393073, 0.3355226576060435)): shape (37, 800, 800)
      Valid pixels: 72002/640000 (11.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=229457, num_faces=229458
      Valid probs shape: (37, 72002)
    ✓ Random_15 (pose=(-1.8938891603163002, 0.932472959325735, 2.0079698911574884)): shape (37, 800, 800)
      Valid pixels: 105827/640000 (16.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=86, max=229407, num_faces=229458
      Valid probs shape: (37, 105827)
    ✓ Random_16 (pose=(0.6156754220275262, 0.579590799206569, -3.0898681250963884)): shape (37, 800, 800)
      Valid pixels: 68770/640000 (10.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=0, max=229405, num_faces=229458
      Valid probs shape: (37, 68770)
    ✓ Random_17 (pose=(0.26711471751562854, -2.2294978729189916, 1.4947279758318066)): shape (37, 800, 800)
      Valid pixels: 86588/640000 (13.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=12, max=229457, num_faces=229458
      Valid probs shape: (37, 86588)
    ✓ Random_18 (pose=(2.7455384941800327, -2.482580489915919, 2.555641643679385)): shape (37, 800, 800)
      Valid pixels: 74389/640000 (11.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=229278, num_faces=229458
      Valid probs shape: (37, 74389)
    ✓ Random_19 (pose=(0.9782871609270885, -2.6682770562298432, 0.5924767621818741)): shape (37, 800, 800)
      Valid pixels: 89457/640000 (14.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=258, max=229424, num_faces=229458
      Valid probs shape: (37, 89457)
    ✓ Random_20 (pose=(0.5305629085583785, 2.4899166116774722, -2.7208011584861533)): shape (37, 800, 800)
      Valid pixels: 66713/640000 (10.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1563, max=229457, num_faces=229458
      Valid probs shape: (37, 66713)
    ✓ Random_21 (pose=(2.5732010959114753, -2.7596883433134667, 1.5612863737517175)): shape (37, 800, 800)
      Valid pixels: 79210/640000 (12.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=221332, num_faces=229458
      Valid probs shape: (37, 79210)
    ✓ Random_22 (pose=(-0.26823742725631305, -1.4232604566325966, 2.7759056068154564)): shape (37, 800, 800)
      Valid pixels: 76820/640000 (12.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=13, max=229406, num_faces=229458
      Valid probs shape: (37, 76820)
    ✓ Random_23 (pose=(-0.9755233299118666, 2.3386536811925467, -2.8423675700801825)): shape (37, 800, 800)
      Valid pixels: 107275/640000 (16.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=257, max=229407, num_faces=229458
      Valid probs shape: (37, 107275)
    ✓ Random_24 (pose=(-3.119094445933883, -1.5468850872392068, 2.2289272033617484)): shape (37, 800, 800)
      Valid pixels: 81451/640000 (12.7%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=42, max=229453, num_faces=229458
      Valid probs shape: (37, 81451)
    ✓ Random_25 (pose=(-2.386175448051936, -1.206889025558583, -2.3817052697521515)): shape (37, 800, 800)
      Valid pixels: 107492/640000 (16.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=95, max=229407, num_faces=229458
      Valid probs shape: (37, 107492)
    ✓ Random_26 (pose=(0.654457169830033, 3.0942727357216357, -2.9169027935537053)): shape (37, 800, 800)
      Valid pixels: 74510/640000 (11.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4906, max=229453, num_faces=229458
      Valid probs shape: (37, 74510)
    ✓ Random_27 (pose=(-0.8846660730116427, 0.11605087233293387, 2.8392054376599445)): shape (37, 800, 800)
      Valid pixels: 88471/640000 (13.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=229407, num_faces=229458
      Valid probs shape: (37, 88471)
    ✓ Random_28 (pose=(0.6504833973670245, -2.3792617675263275, 0.1512807099215956)): shape (37, 800, 800)
      Valid pixels: 100678/640000 (15.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=286, max=229407, num_faces=229458
      Valid probs shape: (37, 100678)
    ✓ Random_29 (pose=(1.4213043332266215, 2.8616568320995848, -2.6923295832998564)): shape (37, 800, 800)
      Valid pixels: 85282/640000 (13.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=70, max=229453, num_faces=229458
      Valid probs shape: (37, 85282)
    ✓ Random_30 (pose=(2.483092443795867, -1.2934193771906926, -2.0274420865757947)): shape (37, 800, 800)
      Valid pixels: 94864/640000 (14.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=87, max=229407, num_faces=229458
      Valid probs shape: (37, 94864)
    ✓ Random_31 (pose=(-0.6516992022575594, -1.7148197994875267, -2.561982604690857)): shape (37, 800, 800)
      Valid pixels: 65314/640000 (10.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=229450, num_faces=229458
      Valid probs shape: (37, 65314)
    ✓ Random_32 (pose=(-1.310373018492016, 0.7029909190345642, 0.3289698527110283)): shape (37, 800, 800)
      Valid pixels: 92951/640000 (14.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=6, max=229453, num_faces=229458
      Valid probs shape: (37, 92951)
    ✓ Random_33 (pose=(-0.9679515368329383, 1.9682618683407727, 1.5338714011417194)): shape (37, 800, 800)
      Valid pixels: 77477/640000 (12.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=320, max=229452, num_faces=229458
      Valid probs shape: (37, 77477)
    ✓ Random_34 (pose=(-1.3337434545203168, -2.469992317857185, 1.5983944394846796)): shape (37, 800, 800)
      Valid pixels: 80472/640000 (12.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=60, max=229407, num_faces=229458
      Valid probs shape: (37, 80472)
    ✓ Random_35 (pose=(1.3222247305804276, -2.419443027534095, -2.1080462109455924)): shape (37, 800, 800)
      Valid pixels: 78801/640000 (12.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=105, max=229453, num_faces=229458
      Valid probs shape: (37, 78801)
    ✓ Random_36 (pose=(-2.597118456803219, -0.9446379458624552, -2.57376786389079)): shape (37, 800, 800)
      Valid pixels: 104508/640000 (16.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=259, max=229407, num_faces=229458
      Valid probs shape: (37, 104508)
    ✓ Random_37 (pose=(-3.122438718597251, -1.160763988765728, 0.1836288381631408)): shape (37, 800, 800)
      Valid pixels: 75674/640000 (11.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=6223, max=229453, num_faces=229458
      Valid probs shape: (37, 75674)
    ✓ Random_38 (pose=(-2.34746569394749, 0.05029050650226008, 3.092495881284635)): shape (37, 800, 800)
      Valid pixels: 85956/640000 (13.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=409, max=229457, num_faces=229458
      Valid probs shape: (37, 85956)
    ✓ Random_39 (pose=(-1.7075245053802393, -1.837534369877581, 1.6894636386249102)): shape (37, 800, 800)
      Valid pixels: 69965/640000 (10.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=31, max=229407, num_faces=229458
      Valid probs shape: (37, 69965)
    P stats: min=0.0000, max=0.9997, mean=0.0260
    Non-zero vertices: 110195/114731
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 4536 1671  903 2580    0 1787 1087 3571 6330]
  Ground Truth Stats:
    Labels shape: (114731,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-19/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7812
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8276
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8277

  RESULTS:
  RAW:         median(top-10)=0.9159, mean(top-10)=0.9165, median(all)=0.8376, mean(all)=0.7812
  + SMOOTHING: median(top-10)=0.9344, mean(top-10)=0.9315, median(all)=0.8743, mean(all)=0.8276 [+0.0185]
  + MRF:       median(top-10)=0.9343, mean(top-10)=0.9318, median(all)=0.8748, mean(all)=0.8277 [-0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0184

================================================================================
Subject: OASIS-TRT-20-2
================================================================================
  Step 0: Generating predictions with V2 model (40 random views)...
  Mesh: 153483 vertices, 306962 faces
  Generating 40 random views...
  Generating predictions for 40 views (continuous camera pose)...
    ✓ Random_0 (pose=(2.4268466389048333, -0.3182633929305627, 2.999042068700459)): shape (37, 800, 800)
      Valid pixels: 77963/640000 (12.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3312, max=306960, num_faces=306962
      Valid probs shape: (37, 77963)
    ✓ Random_1 (pose=(0.7927242004000266, -0.45770952105524954, -0.55871612103256)): shape (37, 800, 800)
      Valid pixels: 72697/640000 (11.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=306960, num_faces=306962
      Valid probs shape: (37, 72697)
    ✓ Random_2 (pose=(-2.2540616908205946, -0.7922133454641931, 0.43789203324343395)): shape (37, 800, 800)
      Valid pixels: 90566/640000 (14.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=100, max=306957, num_faces=306962
      Valid probs shape: (37, 90566)
    ✓ Random_3 (pose=(0.9944931646100796, -3.051120499545812, 0.27041967679990053)): shape (37, 800, 800)
      Valid pixels: 80646/640000 (12.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=306961, num_faces=306962
      Valid probs shape: (37, 80646)
    ✓ Random_4 (pose=(-1.3508712159607805, 2.6892666595263295, 0.7650159859429877)): shape (37, 800, 800)
      Valid pixels: 77438/640000 (12.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=80, max=306957, num_faces=306962
      Valid probs shape: (37, 77438)
    ✓ Random_5 (pose=(-2.5072519140979166, -1.6225031627473774, 2.5859222057470372)): shape (37, 800, 800)
      Valid pixels: 65873/640000 (10.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=81, max=306960, num_faces=306962
      Valid probs shape: (37, 65873)
    ✓ Random_6 (pose=(2.1142303577938177, 1.519018849151152, -2.998815994522878)): shape (37, 800, 800)
      Valid pixels: 96120/640000 (15.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=2, max=306295, num_faces=306962
      Valid probs shape: (37, 96120)
    ✓ Random_7 (pose=(-1.1959139374298347, 2.0358840491844763, -3.0714629856337115)): shape (37, 800, 800)
      Valid pixels: 101536/640000 (15.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=306961, num_faces=306962
      Valid probs shape: (37, 101536)
    ✓ Random_8 (pose=(-2.1741203332710075, 1.8536145813566929, 1.7379625992977763)): shape (37, 800, 800)
      Valid pixels: 94174/640000 (14.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=306961, num_faces=306962
      Valid probs shape: (37, 94174)
    ✓ Random_9 (pose=(-2.1349506037142723, 0.056137840551360174, 1.6418334078772459)): shape (37, 800, 800)
      Valid pixels: 62316/640000 (9.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=737, max=306960, num_faces=306962
      Valid probs shape: (37, 62316)
    ✓ Random_10 (pose=(-2.7675657255523154, -3.050950400308132, -2.735862603584324)): shape (37, 800, 800)
      Valid pixels: 54531/640000 (8.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=306871, num_faces=306962
      Valid probs shape: (37, 54531)
    ✓ Random_11 (pose=(-0.05361848608953457, -3.0289719422786776, -2.0311468355517857)): shape (37, 800, 800)
      Valid pixels: 44848/640000 (7.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=54994, max=306961, num_faces=306962
      Valid probs shape: (37, 44848)
    ✓ Random_12 (pose=(-0.4213514418677855, -1.9715843004971607, 0.09020716271334805)): shape (37, 800, 800)
      Valid pixels: 67542/640000 (10.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=499, max=306960, num_faces=306962
      Valid probs shape: (37, 67542)
    ✓ Random_13 (pose=(-0.19310422357603718, 0.629745759539762, 0.04933223563444278)): shape (37, 800, 800)
      Valid pixels: 61006/640000 (9.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=305648, num_faces=306962
      Valid probs shape: (37, 61006)
    ✓ Random_14 (pose=(-0.8858440565887791, 0.1333122280134562, -2.044650017439132)): shape (37, 800, 800)
      Valid pixels: 62537/640000 (9.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=306858, num_faces=306962
      Valid probs shape: (37, 62537)
    ✓ Random_15 (pose=(0.039605082997258734, -1.9855493885998177, 1.272401657835215)): shape (37, 800, 800)
      Valid pixels: 95182/640000 (14.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=137, max=306961, num_faces=306962
      Valid probs shape: (37, 95182)
    ✓ Random_16 (pose=(-0.9694395320698539, 0.10730563345455435, 2.13139945606219)): shape (37, 800, 800)
      Valid pixels: 72518/640000 (11.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=306961, num_faces=306962
      Valid probs shape: (37, 72518)
    ✓ Random_17 (pose=(-0.40455406754095957, 2.486844944618295, -3.0340533216619647)): shape (37, 800, 800)
      Valid pixels: 72103/640000 (11.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=316, max=306960, num_faces=306962
      Valid probs shape: (37, 72103)
    ✓ Random_18 (pose=(1.1620837355720752, -2.8211011890165185, 1.4330918107584223)): shape (37, 800, 800)
      Valid pixels: 61041/640000 (9.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2061, max=306871, num_faces=306962
      Valid probs shape: (37, 61041)
    ✓ Random_19 (pose=(-2.984236470437931, 3.028666092888921, 2.0312662460103885)): shape (37, 800, 800)
      Valid pixels: 44240/640000 (6.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=306868, num_faces=306962
      Valid probs shape: (37, 44240)
    ✓ Random_20 (pose=(2.8133655241245235, 1.8508600012010774, 2.553746995501675)): shape (37, 800, 800)
      Valid pixels: 61741/640000 (9.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=306871, num_faces=306962
      Valid probs shape: (37, 61741)
    ✓ Random_21 (pose=(3.0327571842003573, 0.7542023359602901, -1.2212500600449265)): shape (37, 800, 800)
      Valid pixels: 71636/640000 (11.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3309, max=306960, num_faces=306962
      Valid probs shape: (37, 71636)
    ✓ Random_22 (pose=(-2.6664581572574053, -0.4851116694963884, 1.7066026223306867)): shape (37, 800, 800)
      Valid pixels: 60767/640000 (9.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3313, max=306960, num_faces=306962
      Valid probs shape: (37, 60767)
    ✓ Random_23 (pose=(-2.836910612765798, 0.6275764387030707, -3.0259691761476364)): shape (37, 800, 800)
      Valid pixels: 52112/640000 (8.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2781, max=306859, num_faces=306962
      Valid probs shape: (37, 52112)
    ✓ Random_24 (pose=(1.060698371947856, -0.21414588461419193, 0.002658062019399665)): shape (37, 800, 800)
      Valid pixels: 90115/640000 (14.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=306869, num_faces=306962
      Valid probs shape: (37, 90115)
    ✓ Random_25 (pose=(-2.3919297457811397, -2.7293138625094144, -1.714802090378954)): shape (37, 800, 800)
      Valid pixels: 60363/640000 (9.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=306871, num_faces=306962
      Valid probs shape: (37, 60363)
    ✓ Random_26 (pose=(-1.4310944537809254, 2.3894734978443832, -2.8459794552070394)): shape (37, 800, 800)
      Valid pixels: 93037/640000 (14.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=306869, num_faces=306962
      Valid probs shape: (37, 93037)
    ✓ Random_27 (pose=(0.4934258747634295, 1.0147110462721365, -2.494168579608866)): shape (37, 800, 800)
      Valid pixels: 59829/640000 (9.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=306957, num_faces=306962
      Valid probs shape: (37, 59829)
    ✓ Random_28 (pose=(1.3020046758327517, 2.655386618708402, -2.0605252381044377)): shape (37, 800, 800)
      Valid pixels: 68103/640000 (10.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=152, max=306960, num_faces=306962
      Valid probs shape: (37, 68103)
    ✓ Random_29 (pose=(2.9481318966561885, -0.9674717305431386, 1.5030170737721917)): shape (37, 800, 800)
      Valid pixels: 88070/640000 (13.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2327, max=306957, num_faces=306962
      Valid probs shape: (37, 88070)
    ✓ Random_30 (pose=(3.023691522913614, 0.6330122395577731, -1.438042447800184)): shape (37, 800, 800)
      Valid pixels: 70447/640000 (11.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4282, max=306960, num_faces=306962
      Valid probs shape: (37, 70447)
    ✓ Random_31 (pose=(-2.0703428994562785, 0.8625110137305052, -2.314650595461882)): shape (37, 800, 800)
      Valid pixels: 63332/640000 (9.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=732, max=306871, num_faces=306962
      Valid probs shape: (37, 63332)
    ✓ Random_32 (pose=(0.7278274119635721, -2.843572751201285, 0.43467792638013325)): shape (37, 800, 800)
      Valid pixels: 71887/640000 (11.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=177, max=306961, num_faces=306962
      Valid probs shape: (37, 71887)
    ✓ Random_33 (pose=(2.6928324076290098, 1.1370151217373845, 2.8310533248779235)): shape (37, 800, 800)
      Valid pixels: 68479/640000 (10.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3444, max=305593, num_faces=306962
      Valid probs shape: (37, 68479)
    ✓ Random_34 (pose=(1.4531477824485668, -1.1850752460759544, -1.3667450420792728)): shape (37, 800, 800)
      Valid pixels: 66588/640000 (10.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=66, max=306960, num_faces=306962
      Valid probs shape: (37, 66588)
    ✓ Random_35 (pose=(-0.7674848515357358, -1.2944657239660247, 0.20745817529006194)): shape (37, 800, 800)
      Valid pixels: 69298/640000 (10.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=19, max=306957, num_faces=306962
      Valid probs shape: (37, 69298)
    ✓ Random_36 (pose=(0.9727341492720658, 0.913355607376535, 3.0499294529660066)): shape (37, 800, 800)
      Valid pixels: 77149/640000 (12.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=3, max=306960, num_faces=306962
      Valid probs shape: (37, 77149)
    ✓ Random_37 (pose=(3.0513988986292233, -1.53209852861601, 0.5329201199189533)): shape (37, 800, 800)
      Valid pixels: 82824/640000 (12.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=305545, num_faces=306962
      Valid probs shape: (37, 82824)
    ✓ Random_38 (pose=(2.252614645883348, 1.3999180624924703, 0.9389750649756472)): shape (37, 800, 800)
      Valid pixels: 90865/640000 (14.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=20, max=306869, num_faces=306962
      Valid probs shape: (37, 90865)
    ✓ Random_39 (pose=(0.8197631620369412, 0.334404259895273, 1.1938992991856967)): shape (37, 800, 800)
      Valid pixels: 54977/640000 (8.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=305647, num_faces=306962
      Valid probs shape: (37, 54977)
    P stats: min=0.0000, max=0.9999, mean=0.0258
    Non-zero vertices: 146381/153483
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 7102 1386 1417 3694    0 2755 1049 5550 6738]
  Ground Truth Stats:
    Labels shape: (153483,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-2/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7983
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8477
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8482

  RESULTS:
  RAW:         median(top-10)=0.9121, mean(top-10)=0.9167, median(all)=0.8656, mean(all)=0.7983
  + SMOOTHING: median(top-10)=0.9352, mean(top-10)=0.9378, median(all)=0.9009, mean(all)=0.8477 [+0.0231]
  + MRF:       median(top-10)=0.9358, mean(top-10)=0.9382, median(all)=0.9011, mean(all)=0.8482 [+0.0006]
  TOTAL IMPROVEMENT (median top-10): +0.0237

================================================================================
Subject: OASIS-TRT-20-20
================================================================================
  Step 0: Generating predictions with V2 model (40 random views)...
  Mesh: 124947 vertices, 249890 faces
  Generating 40 random views...
  Generating predictions for 40 views (continuous camera pose)...
    ✓ Random_0 (pose=(-0.1605322371862914, 2.732609360572468, 2.817284968322494)): shape (37, 800, 800)
      Valid pixels: 56374/640000 (8.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5013, max=249889, num_faces=249890
      Valid probs shape: (37, 56374)
    ✓ Random_1 (pose=(2.0351084629436045, 0.5506758987011899, -1.3255185926880388)): shape (37, 800, 800)
      Valid pixels: 75066/640000 (11.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=18, max=249888, num_faces=249890
      Valid probs shape: (37, 75066)
    ✓ Random_2 (pose=(-0.3847834298509447, 0.4619919991373953, -2.0442861004250084)): shape (37, 800, 800)
      Valid pixels: 71549/640000 (11.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=249764, num_faces=249890
      Valid probs shape: (37, 71549)
    ✓ Random_3 (pose=(-0.3849519319929784, -2.312363068990064, -3.114869235354461)): shape (37, 800, 800)
      Valid pixels: 61368/640000 (9.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6062, max=249773, num_faces=249890
      Valid probs shape: (37, 61368)
    ✓ Random_4 (pose=(2.625386017732813, 2.4373004900828343, -2.092002763570889)): shape (37, 800, 800)
      Valid pixels: 71522/640000 (11.2%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=1, max=249719, num_faces=249890
      Valid probs shape: (37, 71522)
    ✓ Random_5 (pose=(1.3315114277850064, -1.0874728584624886, -2.6930317004969972)): shape (37, 800, 800)
      Valid pixels: 86962/640000 (13.6%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=19, max=249889, num_faces=249890
      Valid probs shape: (37, 86962)
    ✓ Random_6 (pose=(-0.10601270349933145, -0.7531652895517706, 2.1396323942152646)): shape (37, 800, 800)
      Valid pixels: 75622/640000 (11.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=249773, num_faces=249890
      Valid probs shape: (37, 75622)
    ✓ Random_7 (pose=(-2.4228244165435178, -2.2532057596099024, 2.7554330452284486)): shape (37, 800, 800)
      Valid pixels: 85706/640000 (13.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=249875, num_faces=249890
      Valid probs shape: (37, 85706)
    ✓ Random_8 (pose=(-1.36427072039375, 2.255894654280774, 1.4739466886417372)): shape (37, 800, 800)
      Valid pixels: 74106/640000 (11.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=9, max=249888, num_faces=249890
      Valid probs shape: (37, 74106)
    ✓ Random_9 (pose=(-0.6047556619504979, -2.3957018829732153, 2.8574788856826423)): shape (37, 800, 800)
      Valid pixels: 69994/640000 (10.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=189, max=249874, num_faces=249890
      Valid probs shape: (37, 69994)
    ✓ Random_10 (pose=(2.5785121569265836, -1.644686275040255, 2.7296995258500036)): shape (37, 800, 800)
      Valid pixels: 78347/640000 (12.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=18, max=249889, num_faces=249890
      Valid probs shape: (37, 78347)
    ✓ Random_11 (pose=(-0.3090563729739597, 2.703849259068206, 1.724038182785102)): shape (37, 800, 800)
      Valid pixels: 66321/640000 (10.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5029, max=249889, num_faces=249890
      Valid probs shape: (37, 66321)
    ✓ Random_12 (pose=(1.8958903839233274, 2.7060328212596216, 1.9511948641278876)): shape (37, 800, 800)
      Valid pixels: 83145/640000 (13.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=249719, num_faces=249890
      Valid probs shape: (37, 83145)
    ✓ Random_13 (pose=(0.5028423201359793, -1.6027635100213145, -2.757593061795121)): shape (37, 800, 800)
      Valid pixels: 104565/640000 (16.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=18, max=249719, num_faces=249890
      Valid probs shape: (37, 104565)
    ✓ Random_14 (pose=(-2.64749401920913, -2.091570331717163, 2.3159348325135225)): shape (37, 800, 800)
      Valid pixels: 64006/640000 (10.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=249889, num_faces=249890
      Valid probs shape: (37, 64006)
    ✓ Random_15 (pose=(-0.8072659708795893, 1.7003694802464269, 0.20052713999610727)): shape (37, 800, 800)
      Valid pixels: 105328/640000 (16.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=29, max=249864, num_faces=249890
      Valid probs shape: (37, 105328)
    ✓ Random_16 (pose=(-0.56927778748152, 1.9692446320958306, -2.334424745092619)): shape (37, 800, 800)
      Valid pixels: 99938/640000 (15.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=249884, num_faces=249890
      Valid probs shape: (37, 99938)
    ✓ Random_17 (pose=(-2.7739070824199885, 2.879721564083626, 0.619044014731092)): shape (37, 800, 800)
      Valid pixels: 51126/640000 (8.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=249819, num_faces=249890
      Valid probs shape: (37, 51126)
    ✓ Random_18 (pose=(-0.6838721418772074, 0.9360419134874576, -2.742950122636315)): shape (37, 800, 800)
      Valid pixels: 100563/640000 (15.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=249875, num_faces=249890
      Valid probs shape: (37, 100563)
    ✓ Random_19 (pose=(-2.112917081986133, 0.6902634816554154, -1.706948783865235)): shape (37, 800, 800)
      Valid pixels: 81051/640000 (12.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=366, max=249719, num_faces=249890
      Valid probs shape: (37, 81051)
    ✓ Random_20 (pose=(1.902648113838974, -2.921804950864031, 0.11454656779444994)): shape (37, 800, 800)
      Valid pixels: 94434/640000 (14.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=249875, num_faces=249890
      Valid probs shape: (37, 94434)
    ✓ Random_21 (pose=(-1.5290866269013692, 2.278844882679108, 0.47932868012857677)): shape (37, 800, 800)
      Valid pixels: 82175/640000 (12.8%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=0, max=249889, num_faces=249890
      Valid probs shape: (37, 82175)
    ✓ Random_22 (pose=(1.7348784811766143, 0.8347982185569554, 2.6561774007412575)): shape (37, 800, 800)
      Valid pixels: 105058/640000 (16.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=249719, num_faces=249890
      Valid probs shape: (37, 105058)
    ✓ Random_23 (pose=(-0.5484627027635498, -0.10941930338175165, 1.9255520362211618)): shape (37, 800, 800)
      Valid pixels: 66540/640000 (10.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=249861, num_faces=249890
      Valid probs shape: (37, 66540)
    ✓ Random_24 (pose=(2.428492512767562, 0.9979993324995933, 3.130956424073047)): shape (37, 800, 800)
      Valid pixels: 98953/640000 (15.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=358, max=249889, num_faces=249890
      Valid probs shape: (37, 98953)
    ✓ Random_25 (pose=(3.078877974173918, -1.8707577870789995, -2.925197813240011)): shape (37, 800, 800)
      Valid pixels: 75880/640000 (11.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=21, max=249884, num_faces=249890
      Valid probs shape: (37, 75880)
    ✓ Random_26 (pose=(-3.0317780826511647, -1.0934270469664789, 0.4933128080547631)): shape (37, 800, 800)
      Valid pixels: 94469/640000 (14.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=359, max=249868, num_faces=249890
      Valid probs shape: (37, 94469)
    ✓ Random_27 (pose=(3.133716033563232, 0.5382952352918067, -2.2580208945332707)): shape (37, 800, 800)
      Valid pixels: 76671/640000 (12.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=17983, max=249889, num_faces=249890
      Valid probs shape: (37, 76671)
    ✓ Random_28 (pose=(0.8766292581327297, -0.795737779984298, -2.741811333792747)): shape (37, 800, 800)
      Valid pixels: 90283/640000 (14.1%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=3, max=249791, num_faces=249890
      Valid probs shape: (37, 90283)
    ✓ Random_29 (pose=(-0.011458893095360079, -2.4419381440235095, 1.0603802317960351)): shape (37, 800, 800)
      Valid pixels: 77231/640000 (12.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=288, max=249884, num_faces=249890
      Valid probs shape: (37, 77231)
    ✓ Random_30 (pose=(0.1585444722381677, -1.1724703983336906, -3.125324974123621)): shape (37, 800, 800)
      Valid pixels: 78515/640000 (12.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=249564, num_faces=249890
      Valid probs shape: (37, 78515)
    ✓ Random_31 (pose=(-1.0569588476856997, -1.1476028456350014, -0.3963724144528902)): shape (37, 800, 800)
      Valid pixels: 90650/640000 (14.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=3, max=249889, num_faces=249890
      Valid probs shape: (37, 90650)
    ✓ Random_32 (pose=(0.45365300140640974, 1.349868628598963, 1.9635991826793742)): shape (37, 800, 800)
      Valid pixels: 95377/640000 (14.9%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=3, max=249888, num_faces=249890
      Valid probs shape: (37, 95377)
    ✓ Random_33 (pose=(-0.9104977148366706, 2.9168270120622504, -1.9086502471587696)): shape (37, 800, 800)
      Valid pixels: 62802/640000 (9.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6060, max=249773, num_faces=249890
      Valid probs shape: (37, 62802)
    ✓ Random_34 (pose=(1.9263981302829576, 0.2783614795257048, 0.23929949253426352)): shape (37, 800, 800)
      Valid pixels: 91729/640000 (14.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=22, max=249875, num_faces=249890
      Valid probs shape: (37, 91729)
    ✓ Random_35 (pose=(-0.01583690835644891, 3.069372473160324, 2.2256264533403867)): shape (37, 800, 800)
      Valid pixels: 50708/640000 (7.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=812, max=249889, num_faces=249890
      Valid probs shape: (37, 50708)
    ✓ Random_36 (pose=(3.02042000817041, 1.3476585545270616, -0.9040056076794474)): shape (37, 800, 800)
      Valid pixels: 78092/640000 (12.2%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=18, max=249889, num_faces=249890
      Valid probs shape: (37, 78092)
    ✓ Random_37 (pose=(1.220814259216949, -3.017385907485132, 1.2471962322040175)): shape (37, 800, 800)
      Valid pixels: 67845/640000 (10.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=363, max=249773, num_faces=249890
      Valid probs shape: (37, 67845)
    ✓ Random_38 (pose=(1.0097269168707461, 0.6216100660156201, 1.11784606582125)): shape (37, 800, 800)
      Valid pixels: 68564/640000 (10.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=249727, num_faces=249890
      Valid probs shape: (37, 68564)
    ✓ Random_39 (pose=(-2.1306105924730776, 1.565590398235245, -2.870452994984471)): shape (37, 800, 800)
      Valid pixels: 77498/640000 (12.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=34, max=249861, num_faces=249890
      Valid probs shape: (37, 77498)
    P stats: min=0.0000, max=0.9998, mean=0.0260
    Non-zero vertices: 120030/124947
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 4917 1189  848 3114    0 1661 1016 4731 5900]
  Ground Truth Stats:
    Labels shape: (124947,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-20/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7836
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8274
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8277

  RESULTS:
  RAW:         median(top-10)=0.9022, mean(top-10)=0.9098, median(all)=0.8393, mean(all)=0.7836
  + SMOOTHING: median(top-10)=0.9296, mean(top-10)=0.9299, median(all)=0.8697, mean(all)=0.8274 [+0.0274]
  + MRF:       median(top-10)=0.9301, mean(top-10)=0.9302, median(all)=0.8701, mean(all)=0.8277 [+0.0005]
  TOTAL IMPROVEMENT (median top-10): +0.0279

================================================================================
Subject: OASIS-TRT-20-3
================================================================================
  Step 0: Generating predictions with V2 model (40 random views)...
  Mesh: 134843 vertices, 269682 faces
  Generating 40 random views...
  Generating predictions for 40 views (continuous camera pose)...
    ✓ Random_0 (pose=(-2.004121311995912, -0.621337532709243, 0.5507682434911412)): shape (37, 800, 800)
      Valid pixels: 77483/640000 (12.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2089, max=269677, num_faces=269682
      Valid probs shape: (37, 77483)
    ✓ Random_1 (pose=(-0.5721784529984948, 0.2408061988250103, -1.8136323286137332)): shape (37, 800, 800)
      Valid pixels: 50228/640000 (7.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=269634, num_faces=269682
      Valid probs shape: (37, 50228)
    ✓ Random_2 (pose=(-1.2668717124359012, -2.6086579472915497, 1.1909505216267275)): shape (37, 800, 800)
      Valid pixels: 60167/640000 (9.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=66, max=269639, num_faces=269682
      Valid probs shape: (37, 60167)
    ✓ Random_3 (pose=(1.8563224730454424, -0.7757562197312562, -2.0564710116903124)): shape (37, 800, 800)
      Valid pixels: 61066/640000 (9.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=66, max=269639, num_faces=269682
      Valid probs shape: (37, 61066)
    ✓ Random_4 (pose=(2.5089367244635667, 1.5941633110178834, 2.949928421401925)): shape (37, 800, 800)
      Valid pixels: 76221/640000 (11.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7, max=269680, num_faces=269682
      Valid probs shape: (37, 76221)
    ✓ Random_5 (pose=(-1.3566225458828056, 0.6967856290339087, 2.230209179689423)): shape (37, 800, 800)
      Valid pixels: 79059/640000 (12.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=27, max=269639, num_faces=269682
      Valid probs shape: (37, 79059)
    ✓ Random_6 (pose=(-1.1514555514513367, 3.0518081945781166, -3.057142886398444)): shape (37, 800, 800)
      Valid pixels: 84451/640000 (13.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=24, max=269639, num_faces=269682
      Valid probs shape: (37, 84451)
    ✓ Random_7 (pose=(2.5060782508095736, 0.5172133486041846, -0.9177889274952249)): shape (37, 800, 800)
      Valid pixels: 51684/640000 (8.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=690, max=269677, num_faces=269682
      Valid probs shape: (37, 51684)
    ✓ Random_8 (pose=(0.6809969003847121, 1.9327223503927993, -1.803802345051451)): shape (37, 800, 800)
      Valid pixels: 82848/640000 (12.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=123, max=269639, num_faces=269682
      Valid probs shape: (37, 82848)
    ✓ Random_9 (pose=(0.40096999996811356, -1.9496197721023807, -2.729801256194406)): shape (37, 800, 800)
      Valid pixels: 83533/640000 (13.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=164, max=269680, num_faces=269682
      Valid probs shape: (37, 83533)
    ✓ Random_10 (pose=(-0.2892531533419671, 0.3380671568211566, -0.13302399227040507)): shape (37, 800, 800)
      Valid pixels: 52735/640000 (8.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=268256, num_faces=269682
      Valid probs shape: (37, 52735)
    ✓ Random_11 (pose=(2.0225906403321314, -0.6178920849244576, -1.1772397111709165)): shape (37, 800, 800)
      Valid pixels: 82622/640000 (12.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=191, max=269639, num_faces=269682
      Valid probs shape: (37, 82622)
    ✓ Random_12 (pose=(2.9798188402219754, -0.5858281177858502, -0.12414895842242801)): shape (37, 800, 800)
      Valid pixels: 47708/640000 (7.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3069, max=269673, num_faces=269682
      Valid probs shape: (37, 47708)
    ✓ Random_13 (pose=(0.5128492630622068, 3.029311930237794, -2.245497575445777)): shape (37, 800, 800)
      Valid pixels: 47544/640000 (7.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1147, max=269677, num_faces=269682
      Valid probs shape: (37, 47544)
    ✓ Random_14 (pose=(-1.9012609310044315, -1.1363344883094735, 0.25110859020611365)): shape (37, 800, 800)
      Valid pixels: 85737/640000 (13.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=71, max=269679, num_faces=269682
      Valid probs shape: (37, 85737)
    ✓ Random_15 (pose=(-0.5839889243126604, -0.5670718123277645, -0.6848185998971261)): shape (37, 800, 800)
      Valid pixels: 67533/640000 (10.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=269532, num_faces=269682
      Valid probs shape: (37, 67533)
    ✓ Random_16 (pose=(0.5841116201334295, 1.8005614789940845, 2.0253834504828845)): shape (37, 800, 800)
      Valid pixels: 86967/640000 (13.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=67, max=269681, num_faces=269682
      Valid probs shape: (37, 86967)
    ✓ Random_17 (pose=(-0.49928550921554393, 1.47669346059031, -1.8893195986979232)): shape (37, 800, 800)
      Valid pixels: 85359/640000 (13.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=269639, num_faces=269682
      Valid probs shape: (37, 85359)
    ✓ Random_18 (pose=(1.7126201127002458, -2.238267409387942, -2.2465099498722196)): shape (37, 800, 800)
      Valid pixels: 64243/640000 (10.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=8, max=269638, num_faces=269682
      Valid probs shape: (37, 64243)
    ✓ Random_19 (pose=(-0.30124386299031647, -2.1186718448313755, -3.0116824647800247)): shape (37, 800, 800)
      Valid pixels: 53518/640000 (8.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=148, max=269680, num_faces=269682
      Valid probs shape: (37, 53518)
    ✓ Random_20 (pose=(-2.539636227523781, 0.07548905341501655, 2.995138585600377)): shape (37, 800, 800)
      Valid pixels: 61319/640000 (9.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=325, max=269639, num_faces=269682
      Valid probs shape: (37, 61319)
    ✓ Random_21 (pose=(2.9029189567844575, 2.7725335058252485, -1.4741824180471326)): shape (37, 800, 800)
      Valid pixels: 48629/640000 (7.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=269614, num_faces=269682
      Valid probs shape: (37, 48629)
    ✓ Random_22 (pose=(2.2819744938709423, -1.5028752195784045, 1.630392895296497)): shape (37, 800, 800)
      Valid pixels: 85470/640000 (13.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=269680, num_faces=269682
      Valid probs shape: (37, 85470)
    ✓ Random_23 (pose=(0.9188429705028778, -0.48177547593493886, 0.39124015096812403)): shape (37, 800, 800)
      Valid pixels: 77013/640000 (12.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=269639, num_faces=269682
      Valid probs shape: (37, 77013)
    ✓ Random_24 (pose=(-2.1988429811561945, 1.599875682263903, -0.6553108692813274)): shape (37, 800, 800)
      Valid pixels: 84804/640000 (13.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=36, max=269679, num_faces=269682
      Valid probs shape: (37, 84804)
    ✓ Random_25 (pose=(-2.892284761070249, -2.735163786111371, -2.535873888686659)): shape (37, 800, 800)
      Valid pixels: 53702/640000 (8.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=269639, num_faces=269682
      Valid probs shape: (37, 53702)
    ✓ Random_26 (pose=(0.10037954523822146, 1.9463110921286866, 0.9651786396436108)): shape (37, 800, 800)
      Valid pixels: 83463/640000 (13.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=164, max=269680, num_faces=269682
      Valid probs shape: (37, 83463)
    ✓ Random_27 (pose=(3.072671207262518, -0.6730821927852504, 0.8336756053033807)): shape (37, 800, 800)
      Valid pixels: 65098/640000 (10.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=20131, max=269678, num_faces=269682
      Valid probs shape: (37, 65098)
    ✓ Random_28 (pose=(1.0600520586541151, -1.2382434768432116, -1.6979172081312282)): shape (37, 800, 800)
      Valid pixels: 64329/640000 (10.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=27, max=269638, num_faces=269682
      Valid probs shape: (37, 64329)
    ✓ Random_29 (pose=(-0.48108960030538483, 2.601600693387023, 0.009871364955215789)): shape (37, 800, 800)
      Valid pixels: 67969/640000 (10.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=18770, max=269680, num_faces=269682
      Valid probs shape: (37, 67969)
    ✓ Random_30 (pose=(-0.39257631871386467, -1.821651210906223, -1.9565659677790679)): shape (37, 800, 800)
      Valid pixels: 84297/640000 (13.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=4, max=269680, num_faces=269682
      Valid probs shape: (37, 84297)
    ✓ Random_31 (pose=(0.8117254871932253, 1.2795992648859027, -1.7111583099421706)): shape (37, 800, 800)
      Valid pixels: 80890/640000 (12.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=23, max=269639, num_faces=269682
      Valid probs shape: (37, 80890)
    ✓ Random_32 (pose=(2.277664367555163, 1.4130655436445805, 1.021335327209644)): shape (37, 800, 800)
      Valid pixels: 81669/640000 (12.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=28, max=269639, num_faces=269682
      Valid probs shape: (37, 81669)
    ✓ Random_33 (pose=(-0.9037466932231975, 0.35576003231317355, 1.5809161294837741)): shape (37, 800, 800)
      Valid pixels: 51634/640000 (8.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=3, max=269639, num_faces=269682
      Valid probs shape: (37, 51634)
    ✓ Random_34 (pose=(2.104934404259674, 1.3691810098748851, 2.408546259223632)): shape (37, 800, 800)
      Valid pixels: 70138/640000 (11.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=269680, num_faces=269682
      Valid probs shape: (37, 70138)
    ✓ Random_35 (pose=(0.5265691793378968, 0.4871508995589404, 0.43389750848552877)): shape (37, 800, 800)
      Valid pixels: 50460/640000 (7.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=269639, num_faces=269682
      Valid probs shape: (37, 50460)
    ✓ Random_36 (pose=(0.840672784773997, 1.1133947319665527, -1.7303621293793328)): shape (37, 800, 800)
      Valid pixels: 76191/640000 (11.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=23, max=269639, num_faces=269682
      Valid probs shape: (37, 76191)
    ✓ Random_37 (pose=(-1.0746947650846819, -1.4181303073950906, -1.4370048532263953)): shape (37, 800, 800)
      Valid pixels: 81979/640000 (12.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=269680, num_faces=269682
      Valid probs shape: (37, 81979)
    ✓ Random_38 (pose=(-0.36006969708969505, 2.7310271986556955, -0.6207733578016876)): shape (37, 800, 800)
      Valid pixels: 45786/640000 (7.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=35730, max=269680, num_faces=269682
      Valid probs shape: (37, 45786)
    ✓ Random_39 (pose=(0.8404970076285743, 2.429641008182152, 2.4213481734883073)): shape (37, 800, 800)
      Valid pixels: 82327/640000 (12.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2135, max=269681, num_faces=269682
      Valid probs shape: (37, 82327)
    P stats: min=0.0000, max=1.0000, mean=0.0260
    Non-zero vertices: 129658/134843
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 5185 1676 1060 3513    0 2476 1077 4156 6691]
  Ground Truth Stats:
    Labels shape: (134843,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-3/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7694
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8058
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8058

  RESULTS:
  RAW:         median(top-10)=0.9111, mean(top-10)=0.9097, median(all)=0.8345, mean(all)=0.7694
  + SMOOTHING: median(top-10)=0.9233, mean(top-10)=0.9238, median(all)=0.8654, mean(all)=0.8058 [+0.0122]
  + MRF:       median(top-10)=0.9237, mean(top-10)=0.9242, median(all)=0.8652, mean(all)=0.8058 [+0.0004]
  TOTAL IMPROVEMENT (median top-10): +0.0126

================================================================================
Subject: OASIS-TRT-20-4
================================================================================
  Step 0: Generating predictions with V2 model (40 random views)...
  Mesh: 138101 vertices, 276198 faces
  Generating 40 random views...
  Generating predictions for 40 views (continuous camera pose)...
    ✓ Random_0 (pose=(2.397656548517606, 2.539131866242955, 1.750918335540331)): shape (37, 800, 800)
      Valid pixels: 62406/640000 (9.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=276188, num_faces=276198
      Valid probs shape: (37, 62406)
    ✓ Random_1 (pose=(2.384619355359921, -1.723522436994761, 0.3436912366364968)): shape (37, 800, 800)
      Valid pixels: 67948/640000 (10.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=276194, num_faces=276198
      Valid probs shape: (37, 67948)
    ✓ Random_2 (pose=(0.3308579249195924, -1.330103454037915, -1.7262839732400426)): shape (37, 800, 800)
      Valid pixels: 89221/640000 (13.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=2, max=276197, num_faces=276198
      Valid probs shape: (37, 89221)
    ✓ Random_3 (pose=(2.9464448282026874, -0.34222044425913056, -1.4702010539818076)): shape (37, 800, 800)
      Valid pixels: 59015/640000 (9.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=399, max=276197, num_faces=276198
      Valid probs shape: (37, 59015)
    ✓ Random_4 (pose=(2.877000647520325, 2.269542001470903, -0.1766894493711484)): shape (37, 800, 800)
      Valid pixels: 56067/640000 (8.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=276175, num_faces=276198
      Valid probs shape: (37, 56067)
    ✓ Random_5 (pose=(-1.8464405485988562, -2.030509947327807, -1.6792578259327424)): shape (37, 800, 800)
      Valid pixels: 66442/640000 (10.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=276194, num_faces=276198
      Valid probs shape: (37, 66442)
    ✓ Random_6 (pose=(-2.9864650477376737, 1.532107792840545, -0.04556705935098959)): shape (37, 800, 800)
      Valid pixels: 66054/640000 (10.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=73, max=276195, num_faces=276198
      Valid probs shape: (37, 66054)
    ✓ Random_7 (pose=(-0.3926359580276464, 2.245742803397051, 1.6507347857579378)): shape (37, 800, 800)
      Valid pixels: 78060/640000 (12.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1366, max=276196, num_faces=276198
      Valid probs shape: (37, 78060)
    ✓ Random_8 (pose=(0.12986714265110555, 0.6831129050750366, 0.7118535069603746)): shape (37, 800, 800)
      Valid pixels: 71907/640000 (11.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=275473, num_faces=276198
      Valid probs shape: (37, 71907)
    ✓ Random_9 (pose=(-2.263012021712483, -0.9170773102470848, 1.2738216007780228)): shape (37, 800, 800)
      Valid pixels: 78113/640000 (12.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=410, max=276196, num_faces=276198
      Valid probs shape: (37, 78113)
    ✓ Random_10 (pose=(0.06878307619195523, -0.8581632644191233, 1.2473009370091308)): shape (37, 800, 800)
      Valid pixels: 82686/640000 (12.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=276194, num_faces=276198
      Valid probs shape: (37, 82686)
    ✓ Random_11 (pose=(-2.546521529240568, -0.9248803183797216, 1.7869350623947797)): shape (37, 800, 800)
      Valid pixels: 72692/640000 (11.4%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=413, max=276196, num_faces=276198
      Valid probs shape: (37, 72692)
    ✓ Random_12 (pose=(-1.0679405566622555, 0.4185795191442052, -1.7704743746544567)): shape (37, 800, 800)
      Valid pixels: 66323/640000 (10.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=276188, num_faces=276198
      Valid probs shape: (37, 66323)
    ✓ Random_13 (pose=(3.131975994697944, 1.1471127124640699, -1.836088558771317)): shape (37, 800, 800)
      Valid pixels: 95424/640000 (14.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=808, max=276197, num_faces=276198
      Valid probs shape: (37, 95424)
    ✓ Random_14 (pose=(0.5144066111829884, 1.541855251763276, 0.5046764575427685)): shape (37, 800, 800)
      Valid pixels: 62629/640000 (9.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=276079, num_faces=276198
      Valid probs shape: (37, 62629)
    ✓ Random_15 (pose=(3.0245648807549665, -2.7187348505730267, -0.6054219028977048)): shape (37, 800, 800)
      Valid pixels: 57576/640000 (9.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=276188, num_faces=276198
      Valid probs shape: (37, 57576)
    ✓ Random_16 (pose=(-1.6828088232057317, -1.068849489892909, -1.8798756857972876)): shape (37, 800, 800)
      Valid pixels: 66964/640000 (10.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=14, max=276197, num_faces=276198
      Valid probs shape: (37, 66964)
    ✓ Random_17 (pose=(-2.701390496525292, -0.5716220620133283, -1.150656926610853)): shape (37, 800, 800)
      Valid pixels: 53056/640000 (8.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=802, max=276197, num_faces=276198
      Valid probs shape: (37, 53056)
    ✓ Random_18 (pose=(-1.8315274697607333, 2.824004594770397, -0.2455391964114284)): shape (37, 800, 800)
      Valid pixels: 97389/640000 (15.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=5, max=276196, num_faces=276198
      Valid probs shape: (37, 97389)
    ✓ Random_19 (pose=(-0.8510195838164081, -1.2645178798999113, 1.3208092633056303)): shape (37, 800, 800)
      Valid pixels: 83147/640000 (13.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=14, max=276195, num_faces=276198
      Valid probs shape: (37, 83147)
    ✓ Random_20 (pose=(-1.5190503581268238, -2.488234455256376, 0.10471748880591969)): shape (37, 800, 800)
      Valid pixels: 93130/640000 (14.6%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=1, max=276196, num_faces=276198
      Valid probs shape: (37, 93130)
    ✓ Random_21 (pose=(2.030072695048105, 0.09583522546978962, 3.100718905143821)): shape (37, 800, 800)
      Valid pixels: 93540/640000 (14.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=807, max=276196, num_faces=276198
      Valid probs shape: (37, 93540)
    ✓ Random_22 (pose=(1.0125133143761422, -2.7913569388006603, 0.40952325969229886)): shape (37, 800, 800)
      Valid pixels: 88259/640000 (13.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=134, max=276197, num_faces=276198
      Valid probs shape: (37, 88259)
    ✓ Random_23 (pose=(-0.07577180641811987, 2.032201184708909, 2.1998389158051843)): shape (37, 800, 800)
      Valid pixels: 76900/640000 (12.0%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=414, max=276196, num_faces=276198
      Valid probs shape: (37, 76900)
    ✓ Random_24 (pose=(-0.9393839891805702, 3.042602727033569, 2.3583830756519903)): shape (37, 800, 800)
      Valid pixels: 87594/640000 (13.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=135, max=276197, num_faces=276198
      Valid probs shape: (37, 87594)
    ✓ Random_25 (pose=(-0.5654901208031813, -0.10260766105853669, -0.6578400756481373)): shape (37, 800, 800)
      Valid pixels: 72945/640000 (11.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=275898, num_faces=276198
      Valid probs shape: (37, 72945)
    ✓ Random_26 (pose=(1.1563694396351014, 2.9094117524063154, 0.8599209364954126)): shape (37, 800, 800)
      Valid pixels: 68263/640000 (10.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=293, max=276197, num_faces=276198
      Valid probs shape: (37, 68263)
    ✓ Random_27 (pose=(0.5558075147001893, -2.6319511284984203, -0.9870924352088104)): shape (37, 800, 800)
      Valid pixels: 58841/640000 (9.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=508, max=276196, num_faces=276198
      Valid probs shape: (37, 58841)
    ✓ Random_28 (pose=(-0.2061851584157357, 0.24327769580066638, -0.28513547950383744)): shape (37, 800, 800)
      Valid pixels: 55517/640000 (8.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=275461, num_faces=276198
      Valid probs shape: (37, 55517)
    ✓ Random_29 (pose=(0.5048797787096078, -1.9969152404838355, -1.3174434866903533)): shape (37, 800, 800)
      Valid pixels: 76336/640000 (11.9%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=534, max=276197, num_faces=276198
      Valid probs shape: (37, 76336)
    ✓ Random_30 (pose=(0.8467289295418352, -0.20281307118143177, 3.010762410722432)): shape (37, 800, 800)
      Valid pixels: 85874/640000 (13.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=275898, num_faces=276198
      Valid probs shape: (37, 85874)
    ✓ Random_31 (pose=(1.4787103124806302, 1.8180485295467248, 1.2028386813063667)): shape (37, 800, 800)
      Valid pixels: 63764/640000 (10.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=276197, num_faces=276198
      Valid probs shape: (37, 63764)
    ✓ Random_32 (pose=(0.8357677088729774, -1.1083143184152293, -2.280449780902381)): shape (37, 800, 800)
      Valid pixels: 88003/640000 (13.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=8, max=276196, num_faces=276198
      Valid probs shape: (37, 88003)
    ✓ Random_33 (pose=(1.6320190705134054, -1.9860264450011322, -0.6237221020837471)): shape (37, 800, 800)
      Valid pixels: 104583/640000 (16.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=18, max=276197, num_faces=276198
      Valid probs shape: (37, 104583)
    ✓ Random_34 (pose=(-1.082689486833623, 2.9593592643149407, 0.9168313299189492)): shape (37, 800, 800)
      Valid pixels: 74940/640000 (11.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=795, max=276197, num_faces=276198
      Valid probs shape: (37, 74940)
    ✓ Random_35 (pose=(-1.3048175873433199, 2.0636384978289426, -1.291051025454245)): shape (37, 800, 800)
      Valid pixels: 63983/640000 (10.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=23, max=275054, num_faces=276198
      Valid probs shape: (37, 63983)
    ✓ Random_36 (pose=(0.38496874995347685, 2.482995734916857, 1.8423764871570674)): shape (37, 800, 800)
      Valid pixels: 81885/640000 (12.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=11279, max=276197, num_faces=276198
      Valid probs shape: (37, 81885)
    ✓ Random_37 (pose=(-0.45154838044504064, 0.19722248549195331, -0.588317237361351)): shape (37, 800, 800)
      Valid pixels: 64856/640000 (10.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=275053, num_faces=276198
      Valid probs shape: (37, 64856)
    ✓ Random_38 (pose=(1.0219486144692862, 0.7376128004533387, 3.039837317734161)): shape (37, 800, 800)
      Valid pixels: 82302/640000 (12.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=276170, num_faces=276198
      Valid probs shape: (37, 82302)
    ✓ Random_39 (pose=(-3.0819377019899643, -1.2993388115768796, 2.031415110114147)): shape (37, 800, 800)
      Valid pixels: 82656/640000 (12.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=126, max=276197, num_faces=276198
      Valid probs shape: (37, 82656)
    P stats: min=0.0000, max=1.0000, mean=0.0258
    Non-zero vertices: 132086/138101
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 6015 1169  894 3070    0 2225 1025 4239 6443]
  Ground Truth Stats:
    Labels shape: (138101,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-4/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7905
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8355
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8356

  RESULTS:
  RAW:         median(top-10)=0.9184, mean(top-10)=0.9260, median(all)=0.8558, mean(all)=0.7905
  + SMOOTHING: median(top-10)=0.9389, mean(top-10)=0.9413, median(all)=0.8826, mean(all)=0.8355 [+0.0205]
  + MRF:       median(top-10)=0.9390, mean(top-10)=0.9416, median(all)=0.8825, mean(all)=0.8356 [+0.0000]
  TOTAL IMPROVEMENT (median top-10): +0.0206

================================================================================
Subject: OASIS-TRT-20-5
================================================================================
  Step 0: Generating predictions with V2 model (40 random views)...
  Mesh: 151342 vertices, 302680 faces
  Generating 40 random views...
  Generating predictions for 40 views (continuous camera pose)...
    ✓ Random_0 (pose=(-2.495667572098931, 1.177313186255609, -0.47714679206613964)): shape (37, 800, 800)
      Valid pixels: 88795/640000 (13.9%)
      Probs stats: min=0.0000, max=0.9995, mean=0.0270
      Face IDs: min=317, max=302679, num_faces=302680
      Valid probs shape: (37, 88795)
    ✓ Random_1 (pose=(0.7098155291609562, 2.1739330262063348, -1.3242510144907556)): shape (37, 800, 800)
      Valid pixels: 103231/640000 (16.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=302671, num_faces=302680
      Valid probs shape: (37, 103231)
    ✓ Random_2 (pose=(-0.669412425516271, -0.06776212373460533, 2.570513307736225)): shape (37, 800, 800)
      Valid pixels: 75212/640000 (11.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=302618, num_faces=302680
      Valid probs shape: (37, 75212)
    ✓ Random_3 (pose=(-2.2371295054206044, -0.017124339973492386, -0.2114141546989572)): shape (37, 800, 800)
      Valid pixels: 92006/640000 (14.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=11132, max=302679, num_faces=302680
      Valid probs shape: (37, 92006)
    ✓ Random_4 (pose=(2.756424672203293, 2.627221689535074, -2.203787856210712)): shape (37, 800, 800)
      Valid pixels: 73687/640000 (11.5%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=3, max=302015, num_faces=302680
      Valid probs shape: (37, 73687)
    ✓ Random_5 (pose=(-3.038114156247719, 1.2553326060375758, -0.3176220536524248)): shape (37, 800, 800)
      Valid pixels: 76279/640000 (11.9%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=318, max=302678, num_faces=302680
      Valid probs shape: (37, 76279)
    ✓ Random_6 (pose=(-0.3084113899183265, 2.004210744705621, -0.026916031744236957)): shape (37, 800, 800)
      Valid pixels: 76184/640000 (11.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2550, max=302679, num_faces=302680
      Valid probs shape: (37, 76184)
    ✓ Random_7 (pose=(0.3014264488296048, 0.33895583795539386, 0.2460203690855005)): shape (37, 800, 800)
      Valid pixels: 61238/640000 (9.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=302610, num_faces=302680
      Valid probs shape: (37, 61238)
    ✓ Random_8 (pose=(0.5997995179203124, 0.3338446078105144, 3.07764254295717)): shape (37, 800, 800)
      Valid pixels: 69487/640000 (10.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=302665, num_faces=302680
      Valid probs shape: (37, 69487)
    ✓ Random_9 (pose=(-1.7481528886313262, 1.9726582420873422, -0.16268333457260065)): shape (37, 800, 800)
      Valid pixels: 98695/640000 (15.4%)
      Probs stats: min=0.0000, max=0.9995, mean=0.0270
      Face IDs: min=9, max=302679, num_faces=302680
      Valid probs shape: (37, 98695)
    ✓ Random_10 (pose=(-0.7237627822761659, 2.9882325879508533, -0.6983072967474504)): shape (37, 800, 800)
      Valid pixels: 78830/640000 (12.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=21814, max=302679, num_faces=302680
      Valid probs shape: (37, 78830)
    ✓ Random_11 (pose=(2.530751654344132, 0.09381510299906903, 1.6454704158261242)): shape (37, 800, 800)
      Valid pixels: 52362/640000 (8.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=8002, max=302677, num_faces=302680
      Valid probs shape: (37, 52362)
    ✓ Random_12 (pose=(-1.2753784044032646, 0.15601664225853984, 1.2338771777663178)): shape (37, 800, 800)
      Valid pixels: 69097/640000 (10.8%)
      Probs stats: min=0.0000, max=0.9994, mean=0.0270
      Face IDs: min=1, max=302676, num_faces=302680
      Valid probs shape: (37, 69097)
    ✓ Random_13 (pose=(-2.6298567765840217, 2.552281105762635, 1.831443077345103)): shape (37, 800, 800)
      Valid pixels: 78720/640000 (12.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=302626, num_faces=302680
      Valid probs shape: (37, 78720)
    ✓ Random_14 (pose=(-2.6415766823419307, -2.0985285616816873, 0.0711602712264634)): shape (37, 800, 800)
      Valid pixels: 90733/640000 (14.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=3, max=302670, num_faces=302680
      Valid probs shape: (37, 90733)
    ✓ Random_15 (pose=(1.44018107420146, 0.3276419588348709, -0.6275342949816896)): shape (37, 800, 800)
      Valid pixels: 105818/640000 (16.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=302626, num_faces=302680
      Valid probs shape: (37, 105818)
    ✓ Random_16 (pose=(1.48489512545739, 0.6542491938608999, 0.4730002688070645)): shape (37, 800, 800)
      Valid pixels: 91387/640000 (14.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=302623, num_faces=302680
      Valid probs shape: (37, 91387)
    ✓ Random_17 (pose=(0.248638674264281, 0.09909063643899474, 1.6075225802265454)): shape (37, 800, 800)
      Valid pixels: 56508/640000 (8.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=300477, num_faces=302680
      Valid probs shape: (37, 56508)
    ✓ Random_18 (pose=(1.134821550841683, -0.7622877959910248, -1.0402670601354997)): shape (37, 800, 800)
      Valid pixels: 68368/640000 (10.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=6, max=302630, num_faces=302680
      Valid probs shape: (37, 68368)
    ✓ Random_19 (pose=(1.780589980068533, 1.0471555443391818, -1.768884655498544)): shape (37, 800, 800)
      Valid pixels: 74495/640000 (11.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=295, max=302678, num_faces=302680
      Valid probs shape: (37, 74495)
    ✓ Random_20 (pose=(-2.8179206275606656, -0.6732346492094292, 1.6213840878681038)): shape (37, 800, 800)
      Valid pixels: 79483/640000 (12.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5937, max=302679, num_faces=302680
      Valid probs shape: (37, 79483)
    ✓ Random_21 (pose=(-1.9066270792354691, 0.16661574642638133, 2.702039674094073)): shape (37, 800, 800)
      Valid pixels: 107474/640000 (16.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=302670, num_faces=302680
      Valid probs shape: (37, 107474)
    ✓ Random_22 (pose=(2.1096683089406634, 0.9495911509225037, 1.921940972896559)): shape (37, 800, 800)
      Valid pixels: 65311/640000 (10.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=11, max=302671, num_faces=302680
      Valid probs shape: (37, 65311)
    ✓ Random_23 (pose=(-0.8325788099934739, -1.1830291587826312, -0.8870347136053818)): shape (37, 800, 800)
      Valid pixels: 101479/640000 (15.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=4, max=302679, num_faces=302680
      Valid probs shape: (37, 101479)
    ✓ Random_24 (pose=(0.11577026449527406, 1.4909865785037901, 2.9518503387811723)): shape (37, 800, 800)
      Valid pixels: 71318/640000 (11.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=40, max=302679, num_faces=302680
      Valid probs shape: (37, 71318)
    ✓ Random_25 (pose=(2.0760417605235046, 2.657841933798233, 2.552340763357015)): shape (37, 800, 800)
      Valid pixels: 94422/640000 (14.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=3, max=302677, num_faces=302680
      Valid probs shape: (37, 94422)
    ✓ Random_26 (pose=(-1.4565342149606748, 1.6838473384283539, -1.642812016616909)): shape (37, 800, 800)
      Valid pixels: 69554/640000 (10.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=302623, num_faces=302680
      Valid probs shape: (37, 69554)
    ✓ Random_27 (pose=(-1.6178777242481823, 2.8831084246818923, -2.191993627132663)): shape (37, 800, 800)
      Valid pixels: 79498/640000 (12.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=302623, num_faces=302680
      Valid probs shape: (37, 79498)
    ✓ Random_28 (pose=(-2.682260158396828, 0.2870151275612831, -0.9050611415092189)): shape (37, 800, 800)
      Valid pixels: 76225/640000 (11.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=25680, max=302679, num_faces=302680
      Valid probs shape: (37, 76225)
    ✓ Random_29 (pose=(-0.8284131820858867, -1.3782002789116066, -2.5535276788286367)): shape (37, 800, 800)
      Valid pixels: 71578/640000 (11.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=302620, num_faces=302680
      Valid probs shape: (37, 71578)
    ✓ Random_30 (pose=(2.183998786025878, 2.3175267911710185, 1.6995721076984776)): shape (37, 800, 800)
      Valid pixels: 72577/640000 (11.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=302618, num_faces=302680
      Valid probs shape: (37, 72577)
    ✓ Random_31 (pose=(-0.5951995758694895, 1.6396301695745183, 0.5127792919817842)): shape (37, 800, 800)
      Valid pixels: 104687/640000 (16.4%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=1, max=302679, num_faces=302680
      Valid probs shape: (37, 104687)
    ✓ Random_32 (pose=(0.5410788447813686, 2.753227598358227, 1.0738297169896303)): shape (37, 800, 800)
      Valid pixels: 55471/640000 (8.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=34620, max=302677, num_faces=302680
      Valid probs shape: (37, 55471)
    ✓ Random_33 (pose=(2.85927715590889, -2.5877191878459636, 2.7763359880552736)): shape (37, 800, 800)
      Valid pixels: 62589/640000 (9.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=4, max=302014, num_faces=302680
      Valid probs shape: (37, 62589)
    ✓ Random_34 (pose=(-2.381353825395891, 0.487595192135434, 1.7229512190161937)): shape (37, 800, 800)
      Valid pixels: 84607/640000 (13.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=315, max=302672, num_faces=302680
      Valid probs shape: (37, 84607)
    ✓ Random_35 (pose=(-0.7495984531557678, 2.4626563111992192, -2.5833965801396856)): shape (37, 800, 800)
      Valid pixels: 93621/640000 (14.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=302671, num_faces=302680
      Valid probs shape: (37, 93621)
    ✓ Random_36 (pose=(-0.9374813126866424, 1.1703368993094951, -0.7714539921575532)): shape (37, 800, 800)
      Valid pixels: 74376/640000 (11.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=302524, num_faces=302680
      Valid probs shape: (37, 74376)
    ✓ Random_37 (pose=(-2.4636135779579185, -1.4819352449167742, -2.1320534038914833)): shape (37, 800, 800)
      Valid pixels: 104809/640000 (16.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=302626, num_faces=302680
      Valid probs shape: (37, 104809)
    ✓ Random_38 (pose=(1.482207272954689, -0.7688907613917384, -2.578928001979167)): shape (37, 800, 800)
      Valid pixels: 84647/640000 (13.2%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=7, max=302679, num_faces=302680
      Valid probs shape: (37, 84647)
    ✓ Random_39 (pose=(3.0440717745545482, 2.8741422159828476, -2.51521346829782)): shape (37, 800, 800)
      Valid pixels: 60395/640000 (9.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=300440, num_faces=302680
      Valid probs shape: (37, 60395)
    P stats: min=0.0000, max=0.9999, mean=0.0262
    Non-zero vertices: 146591/151342
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 4751 1059  889 3646    0 2587 1013 6526 7306]
  Ground Truth Stats:
    Labels shape: (151342,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-5/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7785
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8169
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8172

  RESULTS:
  RAW:         median(top-10)=0.9093, mean(top-10)=0.9163, median(all)=0.8493, mean(all)=0.7785
  + SMOOTHING: median(top-10)=0.9256, mean(top-10)=0.9327, median(all)=0.8717, mean(all)=0.8169 [+0.0163]
  + MRF:       median(top-10)=0.9257, mean(top-10)=0.9327, median(all)=0.8722, mean(all)=0.8172 [+0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0164

================================================================================
Subject: OASIS-TRT-20-6
================================================================================
  Step 0: Generating predictions with V2 model (40 random views)...
  Mesh: 152023 vertices, 304042 faces
  Generating 40 random views...
  Generating predictions for 40 views (continuous camera pose)...
    ✓ Random_0 (pose=(0.7694306002441769, 2.3445363978648306, 0.19363144068490312)): shape (37, 800, 800)
      Valid pixels: 64927/640000 (10.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=23, max=304040, num_faces=304042
      Valid probs shape: (37, 64927)
    ✓ Random_1 (pose=(-0.14573252933064795, -2.6295459840336273, 2.9989202148498224)): shape (37, 800, 800)
      Valid pixels: 46792/640000 (7.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4024, max=304041, num_faces=304042
      Valid probs shape: (37, 46792)
    ✓ Random_2 (pose=(0.1833080096633064, 0.8025819096726989, 2.0909912372551274)): shape (37, 800, 800)
      Valid pixels: 66721/640000 (10.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=0, max=303975, num_faces=304042
      Valid probs shape: (37, 66721)
    ✓ Random_3 (pose=(1.2857854956744283, 0.14316601147931562, 0.17187858695850622)): shape (37, 800, 800)
      Valid pixels: 84794/640000 (13.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=304040, num_faces=304042
      Valid probs shape: (37, 84794)
    ✓ Random_4 (pose=(-3.1192041327062863, 0.17995793152503792, 2.6414361660669217)): shape (37, 800, 800)
      Valid pixels: 40101/640000 (6.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4967, max=304041, num_faces=304042
      Valid probs shape: (37, 40101)
    ✓ Random_5 (pose=(-2.221445401149713, -2.634504979727792, -2.715717525755581)): shape (37, 800, 800)
      Valid pixels: 78765/640000 (12.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=304040, num_faces=304042
      Valid probs shape: (37, 78765)
    ✓ Random_6 (pose=(0.5699328408943996, 0.8990294116245243, 0.1410619749117905)): shape (37, 800, 800)
      Valid pixels: 60720/640000 (9.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=304040, num_faces=304042
      Valid probs shape: (37, 60720)
    ✓ Random_7 (pose=(0.48392027357346334, 2.861837354978717, -2.0778376513513797)): shape (37, 800, 800)
      Valid pixels: 48595/640000 (7.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1779, max=304040, num_faces=304042
      Valid probs shape: (37, 48595)
    ✓ Random_8 (pose=(1.7046011887334807, 1.9632504693342545, 1.412627656692524)): shape (37, 800, 800)
      Valid pixels: 61268/640000 (9.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=304028, num_faces=304042
      Valid probs shape: (37, 61268)
    ✓ Random_9 (pose=(-0.3377298575643408, -2.9929273454885563, -0.7632408593967388)): shape (37, 800, 800)
      Valid pixels: 56601/640000 (8.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=56265, max=304041, num_faces=304042
      Valid probs shape: (37, 56601)
    ✓ Random_10 (pose=(2.555024295285131, -1.4499929980380202, -2.190852446889619)): shape (37, 800, 800)
      Valid pixels: 77147/640000 (12.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=94, max=304039, num_faces=304042
      Valid probs shape: (37, 77147)
    ✓ Random_11 (pose=(-0.2805051606386799, 1.3838397664314517, -1.3151212601236242)): shape (37, 800, 800)
      Valid pixels: 76505/640000 (12.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=304040, num_faces=304042
      Valid probs shape: (37, 76505)
    ✓ Random_12 (pose=(0.29405056956406117, 2.108323644099574, 0.364348176137236)): shape (37, 800, 800)
      Valid pixels: 56714/640000 (8.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3489, max=304036, num_faces=304042
      Valid probs shape: (37, 56714)
    ✓ Random_13 (pose=(1.495062678467244, 0.9550573176436528, -0.3915806129607162)): shape (37, 800, 800)
      Valid pixels: 97034/640000 (15.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6, max=304040, num_faces=304042
      Valid probs shape: (37, 97034)
    ✓ Random_14 (pose=(1.8966040515032985, -1.2533938106491467, -2.233443852215482)): shape (37, 800, 800)
      Valid pixels: 64465/640000 (10.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=250, max=304039, num_faces=304042
      Valid probs shape: (37, 64465)
    ✓ Random_15 (pose=(-1.194726822833591, 1.2264510850463468, -2.2147612584316105)): shape (37, 800, 800)
      Valid pixels: 76383/640000 (11.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=304040, num_faces=304042
      Valid probs shape: (37, 76383)
    ✓ Random_16 (pose=(1.3513943309356415, -1.413763042502837, -1.8149712255481505)): shape (37, 800, 800)
      Valid pixels: 65145/640000 (10.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=38, max=303988, num_faces=304042
      Valid probs shape: (37, 65145)
    ✓ Random_17 (pose=(2.726501688741341, 0.31147396062807564, -1.07135798461136)): shape (37, 800, 800)
      Valid pixels: 48163/640000 (7.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2201, max=304041, num_faces=304042
      Valid probs shape: (37, 48163)
    ✓ Random_18 (pose=(-2.4444400593054647, 3.0482213506269105, -1.0060888124569707)): shape (37, 800, 800)
      Valid pixels: 68091/640000 (10.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=303973, num_faces=304042
      Valid probs shape: (37, 68091)
    ✓ Random_19 (pose=(-0.28688106036550476, -0.32167272524157386, 1.2047205556692395)): shape (37, 800, 800)
      Valid pixels: 46488/640000 (7.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=304008, num_faces=304042
      Valid probs shape: (37, 46488)
    ✓ Random_20 (pose=(-0.057215947488439056, -2.1633904015224106, -0.8120971180755254)): shape (37, 800, 800)
      Valid pixels: 67345/640000 (10.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1871, max=304041, num_faces=304042
      Valid probs shape: (37, 67345)
    ✓ Random_21 (pose=(-0.11372075041621876, 0.10049168120966012, -1.1530059555443017)): shape (37, 800, 800)
      Valid pixels: 40695/640000 (6.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=302255, num_faces=304042
      Valid probs shape: (37, 40695)
    ✓ Random_22 (pose=(1.4596905275907561, -2.8003705372899437, -2.0343752470954897)): shape (37, 800, 800)
      Valid pixels: 66140/640000 (10.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=241, max=304039, num_faces=304042
      Valid probs shape: (37, 66140)
    ✓ Random_23 (pose=(1.3736332413566759, -2.898292943706347, 2.2959168216250516)): shape (37, 800, 800)
      Valid pixels: 86562/640000 (13.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=303988, num_faces=304042
      Valid probs shape: (37, 86562)
    ✓ Random_24 (pose=(0.16470197402776598, -2.4580416870785493, 0.4581345750908401)): shape (37, 800, 800)
      Valid pixels: 67603/640000 (10.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1321, max=304040, num_faces=304042
      Valid probs shape: (37, 67603)
    ✓ Random_25 (pose=(0.9299194199682779, 2.8258883549197247, 1.4258933843025412)): shape (37, 800, 800)
      Valid pixels: 56513/640000 (8.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2087, max=304041, num_faces=304042
      Valid probs shape: (37, 56513)
    ✓ Random_26 (pose=(-2.207241476420684, -1.3624899099102414, 2.3973030636458006)): shape (37, 800, 800)
      Valid pixels: 69519/640000 (10.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=171, max=304039, num_faces=304042
      Valid probs shape: (37, 69519)
    ✓ Random_27 (pose=(1.8330012926486914, -3.1345145651766857, -1.698220358795689)): shape (37, 800, 800)
      Valid pixels: 60789/640000 (9.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=304003, num_faces=304042
      Valid probs shape: (37, 60789)
    ✓ Random_28 (pose=(-2.18186532743516, 2.6952600303010836, 1.0949149246733825)): shape (37, 800, 800)
      Valid pixels: 55284/640000 (8.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=303947, num_faces=304042
      Valid probs shape: (37, 55284)
    ✓ Random_29 (pose=(-2.7826886180564374, 3.1144207548375995, 1.8270819237737)): shape (37, 800, 800)
      Valid pixels: 43045/640000 (6.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=304020, num_faces=304042
      Valid probs shape: (37, 43045)
    ✓ Random_30 (pose=(1.1872727378753716, 1.2532963178058694, -2.022466802727422)): shape (37, 800, 800)
      Valid pixels: 62562/640000 (9.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=19, max=303949, num_faces=304042
      Valid probs shape: (37, 62562)
    ✓ Random_31 (pose=(2.0695054005837203, 0.47547384229281153, -2.865983994342474)): shape (37, 800, 800)
      Valid pixels: 82147/640000 (12.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=133, max=304041, num_faces=304042
      Valid probs shape: (37, 82147)
    ✓ Random_32 (pose=(-2.332740490282406, 0.33697243998392334, -1.3100988978761294)): shape (37, 800, 800)
      Valid pixels: 70289/640000 (11.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=9368, max=304041, num_faces=304042
      Valid probs shape: (37, 70289)
    ✓ Random_33 (pose=(2.2151721386279295, -2.0863726842944956, 0.2096875223897645)): shape (37, 800, 800)
      Valid pixels: 68994/640000 (10.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=304029, num_faces=304042
      Valid probs shape: (37, 68994)
    ✓ Random_34 (pose=(-0.8228392172338816, 1.1409406299308555, 2.319348703431336)): shape (37, 800, 800)
      Valid pixels: 61257/640000 (9.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=304010, num_faces=304042
      Valid probs shape: (37, 61257)
    ✓ Random_35 (pose=(1.6234912748316814, 2.680487646211202, 0.517887243042161)): shape (37, 800, 800)
      Valid pixels: 79233/640000 (12.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=304040, num_faces=304042
      Valid probs shape: (37, 79233)
    ✓ Random_36 (pose=(0.37860423339999905, -0.5473892094313548, 2.9477819555399067)): shape (37, 800, 800)
      Valid pixels: 61883/640000 (9.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=303964, num_faces=304042
      Valid probs shape: (37, 61883)
    ✓ Random_37 (pose=(2.2944840673861906, -0.16336621878208657, -2.464094944805317)): shape (37, 800, 800)
      Valid pixels: 63466/640000 (9.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3480, max=304041, num_faces=304042
      Valid probs shape: (37, 63466)
    ✓ Random_38 (pose=(-0.8939671713916604, 0.37401233163297176, -2.519696130738973)): shape (37, 800, 800)
      Valid pixels: 71340/640000 (11.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=304040, num_faces=304042
      Valid probs shape: (37, 71340)
    ✓ Random_39 (pose=(1.3634508594280694, -1.853335026008514, 2.315681009586073)): shape (37, 800, 800)
      Valid pixels: 83306/640000 (13.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=303979, num_faces=304042
      Valid probs shape: (37, 83306)
    P stats: min=0.0000, max=1.0000, mean=0.0255
    Non-zero vertices: 143168/152023
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 8855  903 1462 4430    0 2280 1339 4935 6166]
  Ground Truth Stats:
    Labels shape: (152023,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-6/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7666
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8213
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8216

  RESULTS:
  RAW:         median(top-10)=0.8885, mean(top-10)=0.8954, median(all)=0.8214, mean(all)=0.7666
  + SMOOTHING: median(top-10)=0.9186, mean(top-10)=0.9183, median(all)=0.8723, mean(all)=0.8213 [+0.0301]
  + MRF:       median(top-10)=0.9183, mean(top-10)=0.9183, median(all)=0.8724, mean(all)=0.8216 [-0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0298

================================================================================
Subject: OASIS-TRT-20-7
================================================================================
  Step 0: Generating predictions with V2 model (40 random views)...
  Mesh: 142612 vertices, 285220 faces
  Generating 40 random views...
  Generating predictions for 40 views (continuous camera pose)...
    ✓ Random_0 (pose=(1.439467186007513, 2.819090659118242, 1.8337012654388065)): shape (37, 800, 800)
      Valid pixels: 84083/640000 (13.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=183, max=285219, num_faces=285220
      Valid probs shape: (37, 84083)
    ✓ Random_1 (pose=(0.8918771527788838, 1.247950798736209, -0.6815789192811303)): shape (37, 800, 800)
      Valid pixels: 106294/640000 (16.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=284965, num_faces=285220
      Valid probs shape: (37, 106294)
    ✓ Random_2 (pose=(-2.7381960585396694, -2.5627273026835535, -2.786023962730382)): shape (37, 800, 800)
      Valid pixels: 73603/640000 (11.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=285000, num_faces=285220
      Valid probs shape: (37, 73603)
    ✓ Random_3 (pose=(0.9655124990436796, 0.3317853711939245, -2.133817142253504)): shape (37, 800, 800)
      Valid pixels: 61112/640000 (9.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=285162, num_faces=285220
      Valid probs shape: (37, 61112)
    ✓ Random_4 (pose=(-1.2506360878665992, -2.3395397320210707, -1.9666789469928583)): shape (37, 800, 800)
      Valid pixels: 65844/640000 (10.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=211, max=285219, num_faces=285220
      Valid probs shape: (37, 65844)
    ✓ Random_5 (pose=(2.492741945195884, -1.388483288371304, 0.8938294495132775)): shape (37, 800, 800)
      Valid pixels: 79451/640000 (12.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=183, max=285219, num_faces=285220
      Valid probs shape: (37, 79451)
    ✓ Random_6 (pose=(1.2028190755274322, 1.6742338889995834, 2.8572728377012737)): shape (37, 800, 800)
      Valid pixels: 98931/640000 (15.5%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=3, max=285203, num_faces=285220
      Valid probs shape: (37, 98931)
    ✓ Random_7 (pose=(-0.8890263517687735, 1.9818361702818788, -1.549301790088395)): shape (37, 800, 800)
      Valid pixels: 75637/640000 (11.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=75, max=285217, num_faces=285220
      Valid probs shape: (37, 75637)
    ✓ Random_8 (pose=(2.6037730442879967, -2.7720820503425108, -1.5155787971207397)): shape (37, 800, 800)
      Valid pixels: 64067/640000 (10.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=285116, num_faces=285220
      Valid probs shape: (37, 64067)
    ✓ Random_9 (pose=(2.9576540049456614, 1.1502657844181101, 1.2623021835520154)): shape (37, 800, 800)
      Valid pixels: 106532/640000 (16.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8, max=284967, num_faces=285220
      Valid probs shape: (37, 106532)
    ✓ Random_10 (pose=(-2.911591620756626, -0.6272966143955534, -1.4014840319146118)): shape (37, 800, 800)
      Valid pixels: 67309/640000 (10.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=462, max=285219, num_faces=285220
      Valid probs shape: (37, 67309)
    ✓ Random_11 (pose=(-0.9018501726456334, 1.1716851131652382, 0.33027800407013563)): shape (37, 800, 800)
      Valid pixels: 104545/640000 (16.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=6, max=285214, num_faces=285220
      Valid probs shape: (37, 104545)
    ✓ Random_12 (pose=(-3.073008387905667, 2.75389900785786, 2.433684412509204)): shape (37, 800, 800)
      Valid pixels: 58214/640000 (9.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=284934, num_faces=285220
      Valid probs shape: (37, 58214)
    ✓ Random_13 (pose=(-0.7758665297374985, 0.9160152789279374, -1.4740374316978413)): shape (37, 800, 800)
      Valid pixels: 73695/640000 (11.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=285109, num_faces=285220
      Valid probs shape: (37, 73695)
    ✓ Random_14 (pose=(-0.8559978940743997, 1.0352134370902393, 1.3651131766726792)): shape (37, 800, 800)
      Valid pixels: 76714/640000 (12.0%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=5, max=285167, num_faces=285220
      Valid probs shape: (37, 76714)
    ✓ Random_15 (pose=(1.1559389073830166, -0.015283810205906523, -1.1589907180401602)): shape (37, 800, 800)
      Valid pixels: 78884/640000 (12.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=285166, num_faces=285220
      Valid probs shape: (37, 78884)
    ✓ Random_16 (pose=(1.8165579443498245, 1.1048267886542131, 1.362996564548121)): shape (37, 800, 800)
      Valid pixels: 72577/640000 (11.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=285217, num_faces=285220
      Valid probs shape: (37, 72577)
    ✓ Random_17 (pose=(0.7818944034126343, 1.5034334942723548, 0.424421049089724)): shape (37, 800, 800)
      Valid pixels: 71681/640000 (11.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=285213, num_faces=285220
      Valid probs shape: (37, 71681)
    ✓ Random_18 (pose=(-1.2219204636151773, 2.1422194616800736, 1.9658719027518412)): shape (37, 800, 800)
      Valid pixels: 76215/640000 (11.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=127, max=285163, num_faces=285220
      Valid probs shape: (37, 76215)
    ✓ Random_19 (pose=(1.289234910417834, -1.7181648087038106, 0.06971626074724968)): shape (37, 800, 800)
      Valid pixels: 112861/640000 (17.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=284964, num_faces=285220
      Valid probs shape: (37, 112861)
    ✓ Random_20 (pose=(-1.656192617347188, 2.185405356444119, 1.4791259647875332)): shape (37, 800, 800)
      Valid pixels: 68979/640000 (10.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=77, max=285163, num_faces=285220
      Valid probs shape: (37, 68979)
    ✓ Random_21 (pose=(-1.536640577743753, 2.4932651512901804, 0.46770711393862774)): shape (37, 800, 800)
      Valid pixels: 87986/640000 (13.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=36, max=285161, num_faces=285220
      Valid probs shape: (37, 87986)
    ✓ Random_22 (pose=(1.96356189651224, -0.6530576054352113, -1.8856152905182777)): shape (37, 800, 800)
      Valid pixels: 71931/640000 (11.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=150, max=285161, num_faces=285220
      Valid probs shape: (37, 71931)
    ✓ Random_23 (pose=(0.340758743310845, -2.5510520393584435, -2.114222263216269)): shape (37, 800, 800)
      Valid pixels: 80300/640000 (12.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=11058, max=285219, num_faces=285220
      Valid probs shape: (37, 80300)
    ✓ Random_24 (pose=(0.609303056460841, -0.7585190892144045, -3.051851883700334)): shape (37, 800, 800)
      Valid pixels: 95746/640000 (15.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=285212, num_faces=285220
      Valid probs shape: (37, 95746)
    ✓ Random_25 (pose=(2.035267185155604, -2.806582411620269, -0.9321196909050866)): shape (37, 800, 800)
      Valid pixels: 93517/640000 (14.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7, max=285135, num_faces=285220
      Valid probs shape: (37, 93517)
    ✓ Random_26 (pose=(-0.6838838004539722, 0.4814797221846949, 1.802688194556361)): shape (37, 800, 800)
      Valid pixels: 56525/640000 (8.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=285162, num_faces=285220
      Valid probs shape: (37, 56525)
    ✓ Random_27 (pose=(-1.5698390081355496, -0.03312780720905639, -2.8961708590359234)): shape (37, 800, 800)
      Valid pixels: 101416/640000 (15.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=284967, num_faces=285220
      Valid probs shape: (37, 101416)
    ✓ Random_28 (pose=(1.0211037063992547, -0.9588685816069438, -1.7681392873150523)): shape (37, 800, 800)
      Valid pixels: 73818/640000 (11.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=285162, num_faces=285220
      Valid probs shape: (37, 73818)
    ✓ Random_29 (pose=(-2.9578411361912833, 0.6150105941448456, 1.7553965397778057)): shape (37, 800, 800)
      Valid pixels: 80655/640000 (12.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=96, max=285218, num_faces=285220
      Valid probs shape: (37, 80655)
    ✓ Random_30 (pose=(1.5456412720596076, -1.1846054122178866, -1.3721780454198458)): shape (37, 800, 800)
      Valid pixels: 77636/640000 (12.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=47, max=285162, num_faces=285220
      Valid probs shape: (37, 77636)
    ✓ Random_31 (pose=(-2.1747354998643784, -1.8655242137696821, 1.4355924951022079)): shape (37, 800, 800)
      Valid pixels: 77458/640000 (12.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=285162, num_faces=285220
      Valid probs shape: (37, 77458)
    ✓ Random_32 (pose=(-0.4482743556289668, 2.2576958197010306, -0.8617913526222951)): shape (37, 800, 800)
      Valid pixels: 62496/640000 (9.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2051, max=285219, num_faces=285220
      Valid probs shape: (37, 62496)
    ✓ Random_33 (pose=(0.16358238399910263, -2.85548422089847, -0.15916390215258858)): shape (37, 800, 800)
      Valid pixels: 56188/640000 (8.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=995, max=285218, num_faces=285220
      Valid probs shape: (37, 56188)
    ✓ Random_34 (pose=(1.0209617935660065, 2.238244720421899, -0.9280578848492858)): shape (37, 800, 800)
      Valid pixels: 110461/640000 (17.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=75, max=285162, num_faces=285220
      Valid probs shape: (37, 110461)
    ✓ Random_35 (pose=(-2.4413393237554706, 2.2320409481021315, 0.2121787616644255)): shape (37, 800, 800)
      Valid pixels: 68298/640000 (10.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=285162, num_faces=285220
      Valid probs shape: (37, 68298)
    ✓ Random_36 (pose=(-2.5721401331992744, -0.5585698976307687, -0.030905941795582592)): shape (37, 800, 800)
      Valid pixels: 82695/640000 (12.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=11125, max=285219, num_faces=285220
      Valid probs shape: (37, 82695)
    ✓ Random_37 (pose=(-1.900485714388155, -0.5682955055808767, 1.6688772571241186)): shape (37, 800, 800)
      Valid pixels: 71855/640000 (11.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=98, max=285163, num_faces=285220
      Valid probs shape: (37, 71855)
    ✓ Random_38 (pose=(2.712375001663487, -2.0243272827210514, -1.0366685123156447)): shape (37, 800, 800)
      Valid pixels: 97875/640000 (15.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=284961, num_faces=285220
      Valid probs shape: (37, 97875)
    ✓ Random_39 (pose=(-0.17485626183240255, -2.8190960253791597, -2.7382106319831916)): shape (37, 800, 800)
      Valid pixels: 46148/640000 (7.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=8050, max=285219, num_faces=285220
      Valid probs shape: (37, 46148)
    P stats: min=0.0000, max=0.9998, mean=0.0257
    Non-zero vertices: 135694/142612
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 6918 1379  943 3780    0 2118 1267 5335 6896]
  Ground Truth Stats:
    Labels shape: (142612,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-7/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
    MRF iteration 5/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7801
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8269
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8272

  RESULTS:
  RAW:         median(top-10)=0.9184, mean(top-10)=0.9170, median(all)=0.8466, mean(all)=0.7801
  + SMOOTHING: median(top-10)=0.9365, mean(top-10)=0.9338, median(all)=0.8837, mean(all)=0.8269 [+0.0181]
  + MRF:       median(top-10)=0.9371, mean(top-10)=0.9341, median(all)=0.8841, mean(all)=0.8272 [+0.0006]
  TOTAL IMPROVEMENT (median top-10): +0.0187

================================================================================
Subject: OASIS-TRT-20-8
================================================================================
  Step 0: Generating predictions with V2 model (40 random views)...
  Mesh: 139571 vertices, 279138 faces
  Generating 40 random views...
  Generating predictions for 40 views (continuous camera pose)...
    ✓ Random_0 (pose=(3.129220668470273, -1.177846943553343, 0.8768218134267896)): shape (37, 800, 800)
      Valid pixels: 106042/640000 (16.6%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=1547, max=279137, num_faces=279138
      Valid probs shape: (37, 106042)
    ✓ Random_1 (pose=(-0.6046815725900219, 0.30341415690946194, -0.34677645015002323)): shape (37, 800, 800)
      Valid pixels: 80204/640000 (12.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=279019, num_faces=279138
      Valid probs shape: (37, 80204)
    ✓ Random_2 (pose=(-2.235933793691739, 2.2832065327419153, 2.9900665961935253)): shape (37, 800, 800)
      Valid pixels: 101308/640000 (15.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=279070, num_faces=279138
      Valid probs shape: (37, 101308)
    ✓ Random_3 (pose=(-2.3157293768718548, 2.3242158434703395, 2.9373020159224934)): shape (37, 800, 800)
      Valid pixels: 99102/640000 (15.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=279070, num_faces=279138
      Valid probs shape: (37, 99102)
    ✓ Random_4 (pose=(1.537217440886355, -2.1785493839715158, 3.018646256561458)): shape (37, 800, 800)
      Valid pixels: 112885/640000 (17.6%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=11, max=279137, num_faces=279138
      Valid probs shape: (37, 112885)
    ✓ Random_5 (pose=(0.676699775129932, 1.485694888121456, 2.970237458693221)): shape (37, 800, 800)
      Valid pixels: 85938/640000 (13.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=279072, num_faces=279138
      Valid probs shape: (37, 85938)
    ✓ Random_6 (pose=(-0.2760521466221366, 1.1320330208813756, 2.4667025301105276)): shape (37, 800, 800)
      Valid pixels: 69665/640000 (10.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=3, max=279071, num_faces=279138
      Valid probs shape: (37, 69665)
    ✓ Random_7 (pose=(-1.8791758073540201, -1.8138966445769984, 1.9362005288581035)): shape (37, 800, 800)
      Valid pixels: 72954/640000 (11.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=39, max=279070, num_faces=279138
      Valid probs shape: (37, 72954)
    ✓ Random_8 (pose=(-1.1207514918612485, -2.4550773265196764, -2.1921737270757973)): shape (37, 800, 800)
      Valid pixels: 71682/640000 (11.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=148, max=279128, num_faces=279138
      Valid probs shape: (37, 71682)
    ✓ Random_9 (pose=(2.9504146551255452, 1.141337233548601, 1.4214734738929753)): shape (37, 800, 800)
      Valid pixels: 108460/640000 (16.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=33, max=279070, num_faces=279138
      Valid probs shape: (37, 108460)
    ✓ Random_10 (pose=(-0.7276804725266524, -1.3125543650740172, 1.2064693776748223)): shape (37, 800, 800)
      Valid pixels: 91773/640000 (14.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=8, max=279070, num_faces=279138
      Valid probs shape: (37, 91773)
    ✓ Random_11 (pose=(0.3338999980625843, 1.2142753013885361, 3.053222318399351)): shape (37, 800, 800)
      Valid pixels: 73064/640000 (11.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=8, max=279072, num_faces=279138
      Valid probs shape: (37, 73064)
    ✓ Random_12 (pose=(0.1360670559240562, -2.9353367457731014, 3.0919654900520417)): shape (37, 800, 800)
      Valid pixels: 62349/640000 (9.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=27168, max=279137, num_faces=279138
      Valid probs shape: (37, 62349)
    ✓ Random_13 (pose=(2.0066350756481333, 2.5722270238913865, -0.039483385120800296)): shape (37, 800, 800)
      Valid pixels: 113771/640000 (17.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=5, max=279070, num_faces=279138
      Valid probs shape: (37, 113771)
    ✓ Random_14 (pose=(-2.642396841297458, 1.4193200296887447, 0.23679123119645196)): shape (37, 800, 800)
      Valid pixels: 76962/640000 (12.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=306, max=279072, num_faces=279138
      Valid probs shape: (37, 76962)
    ✓ Random_15 (pose=(-0.0064099402771327085, -2.901306700503178, -1.5938658447327125)): shape (37, 800, 800)
      Valid pixels: 68263/640000 (10.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=25341, max=279137, num_faces=279138
      Valid probs shape: (37, 68263)
    ✓ Random_16 (pose=(3.1394105407306867, 2.5381254897982393, 2.9786677980895266)): shape (37, 800, 800)
      Valid pixels: 65075/640000 (10.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=278696, num_faces=279138
      Valid probs shape: (37, 65075)
    ✓ Random_17 (pose=(2.108002783747808, 0.5318898477108265, -2.060638100380097)): shape (37, 800, 800)
      Valid pixels: 87919/640000 (13.7%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=308, max=279130, num_faces=279138
      Valid probs shape: (37, 87919)
    ✓ Random_18 (pose=(-2.9354533033655104, -2.9699269610961427, -0.5110908180570921)): shape (37, 800, 800)
      Valid pixels: 58720/640000 (9.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=276754, num_faces=279138
      Valid probs shape: (37, 58720)
    ✓ Random_19 (pose=(0.7898673339382478, 1.5309551858763841, 0.5282672114120328)): shape (37, 800, 800)
      Valid pixels: 73299/640000 (11.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=279126, num_faces=279138
      Valid probs shape: (37, 73299)
    ✓ Random_20 (pose=(1.5222769438925754, -2.2519320522186126, -1.8953665129817086)): shape (37, 800, 800)
      Valid pixels: 78306/640000 (12.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=287, max=279072, num_faces=279138
      Valid probs shape: (37, 78306)
    ✓ Random_21 (pose=(-1.0536902033129127, -0.09739837541025986, 0.059538206890827894)): shape (37, 800, 800)
      Valid pixels: 94743/640000 (14.8%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=1, max=279071, num_faces=279138
      Valid probs shape: (37, 94743)
    ✓ Random_22 (pose=(-1.7649056452914433, 2.9391631212092983, -1.642377379557106)): shape (37, 800, 800)
      Valid pixels: 68031/640000 (10.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=279133, num_faces=279138
      Valid probs shape: (37, 68031)
    ✓ Random_23 (pose=(-1.429874771557098, 2.3728154594663353, 2.5090689416451486)): shape (37, 800, 800)
      Valid pixels: 111615/640000 (17.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=22, max=279068, num_faces=279138
      Valid probs shape: (37, 111615)
    ✓ Random_24 (pose=(-2.439162136476685, 0.2941689797337155, -2.1970376408305867)): shape (37, 800, 800)
      Valid pixels: 59155/640000 (9.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=578, max=279137, num_faces=279138
      Valid probs shape: (37, 59155)
    ✓ Random_25 (pose=(-2.0260111974166164, 2.660621624970436, 0.008100607565733053)): shape (37, 800, 800)
      Valid pixels: 94334/640000 (14.7%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=1, max=279125, num_faces=279138
      Valid probs shape: (37, 94334)
    ✓ Random_26 (pose=(1.2675489733756988, -1.2085618770647057, -1.457166293991071)): shape (37, 800, 800)
      Valid pixels: 72907/640000 (11.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=55, max=279072, num_faces=279138
      Valid probs shape: (37, 72907)
    ✓ Random_27 (pose=(2.2783959018251663, 0.15093303194632224, -1.3990342846307313)): shape (37, 800, 800)
      Valid pixels: 71087/640000 (11.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4507, max=279072, num_faces=279138
      Valid probs shape: (37, 71087)
    ✓ Random_28 (pose=(1.7788512534173826, 2.3640364838324226, -2.8234343352430873)): shape (37, 800, 800)
      Valid pixels: 102428/640000 (16.0%)
      Probs stats: min=0.0000, max=0.9995, mean=0.0270
      Face IDs: min=5, max=279133, num_faces=279138
      Valid probs shape: (37, 102428)
    ✓ Random_29 (pose=(0.27741206231684234, -0.17717111004694752, 0.6340852226112013)): shape (37, 800, 800)
      Valid pixels: 68591/640000 (10.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=279068, num_faces=279138
      Valid probs shape: (37, 68591)
    ✓ Random_30 (pose=(1.5393186437494437, 2.8506020795743323, 1.114726387247508)): shape (37, 800, 800)
      Valid pixels: 78231/640000 (12.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=279066, num_faces=279138
      Valid probs shape: (37, 78231)
    ✓ Random_31 (pose=(-0.5902397708090668, -2.2182956165271626, 0.3207934090005664)): shape (37, 800, 800)
      Valid pixels: 79733/640000 (12.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=951, max=279130, num_faces=279138
      Valid probs shape: (37, 79733)
    ✓ Random_32 (pose=(1.2496406330355825, -2.593003396042807, -1.7816028368273105)): shape (37, 800, 800)
      Valid pixels: 80226/640000 (12.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=308, max=279072, num_faces=279138
      Valid probs shape: (37, 80226)
    ✓ Random_33 (pose=(1.4530117226956243, 1.7184745872471483, 2.1416852245359133)): shape (37, 800, 800)
      Valid pixels: 104510/640000 (16.3%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=3, max=279134, num_faces=279138
      Valid probs shape: (37, 104510)
    ✓ Random_34 (pose=(-2.647498986467239, -2.213068324124886, -2.5368950867310627)): shape (37, 800, 800)
      Valid pixels: 103986/640000 (16.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=279070, num_faces=279138
      Valid probs shape: (37, 103986)
    ✓ Random_35 (pose=(1.0950894797213913, 1.1056180110487803, 0.4236242246363955)): shape (37, 800, 800)
      Valid pixels: 87505/640000 (13.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=279069, num_faces=279138
      Valid probs shape: (37, 87505)
    ✓ Random_36 (pose=(-2.422829364067342, 2.3074130970745985, -0.6743046157782469)): shape (37, 800, 800)
      Valid pixels: 96201/640000 (15.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=279071, num_faces=279138
      Valid probs shape: (37, 96201)
    ✓ Random_37 (pose=(-0.006538180292285034, 0.8485157544872188, 1.0318783718700324)): shape (37, 800, 800)
      Valid pixels: 92651/640000 (14.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=279133, num_faces=279138
      Valid probs shape: (37, 92651)
    ✓ Random_38 (pose=(-1.644971298100565, -1.3755056554564968, 1.3201103489442607)): shape (37, 800, 800)
      Valid pixels: 77368/640000 (12.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=259, max=279072, num_faces=279138
      Valid probs shape: (37, 77368)
    ✓ Random_39 (pose=(0.6554960829108434, 2.374839912945995, -1.1761306711559931)): shape (37, 800, 800)
      Valid pixels: 102647/640000 (16.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=33, max=279117, num_faces=279138
      Valid probs shape: (37, 102647)
    P stats: min=0.0000, max=0.9999, mean=0.0258
    Non-zero vertices: 133428/139571
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 6143 1106 1308 3647    0 2088  896 5479 6322]
  Ground Truth Stats:
    Labels shape: (139571,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-8/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7898
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8363
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8369

  RESULTS:
  RAW:         median(top-10)=0.9058, mean(top-10)=0.9100, median(all)=0.8552, mean(all)=0.7898
  + SMOOTHING: median(top-10)=0.9332, mean(top-10)=0.9343, median(all)=0.8788, mean(all)=0.8363 [+0.0275]
  + MRF:       median(top-10)=0.9334, mean(top-10)=0.9347, median(all)=0.8798, mean(all)=0.8369 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0277

================================================================================
Subject: OASIS-TRT-20-9
================================================================================
  Step 0: Generating predictions with V2 model (40 random views)...
  Mesh: 134960 vertices, 269916 faces
  Generating 40 random views...
  Generating predictions for 40 views (continuous camera pose)...
    ✓ Random_0 (pose=(2.358518700102766, 0.12485328751769931, -1.1990007740670512)): shape (37, 800, 800)
      Valid pixels: 56834/640000 (8.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=479, max=269914, num_faces=269916
      Valid probs shape: (37, 56834)
    ✓ Random_1 (pose=(-0.846809273203379, -1.3196331339820326, 0.0565050618306997)): shape (37, 800, 800)
      Valid pixels: 67984/640000 (10.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=25, max=269915, num_faces=269916
      Valid probs shape: (37, 67984)
    ✓ Random_2 (pose=(2.4059215669879643, 1.6157088495883372, 2.9414469577564333)): shape (37, 800, 800)
      Valid pixels: 83109/640000 (13.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=269878, num_faces=269916
      Valid probs shape: (37, 83109)
    ✓ Random_3 (pose=(-1.894133953861201, -1.964716807240921, -0.9755043339618461)): shape (37, 800, 800)
      Valid pixels: 72357/640000 (11.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=269662, num_faces=269916
      Valid probs shape: (37, 72357)
    ✓ Random_4 (pose=(-0.2040536989049886, 0.17007178993304617, -0.9469055378644762)): shape (37, 800, 800)
      Valid pixels: 41454/640000 (6.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=207301, num_faces=269916
      Valid probs shape: (37, 41454)
    ✓ Random_5 (pose=(-2.707565527501367, -2.7292746874338243, 0.04559796077163547)): shape (37, 800, 800)
      Valid pixels: 60327/640000 (9.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=268428, num_faces=269916
      Valid probs shape: (37, 60327)
    ✓ Random_6 (pose=(0.6800907051204987, -0.815386692245855, -1.1588133891575383)): shape (37, 800, 800)
      Valid pixels: 57064/640000 (8.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=269805, num_faces=269916
      Valid probs shape: (37, 57064)
    ✓ Random_7 (pose=(-0.37230427527334164, -0.7994682916705314, 0.6044306477963088)): shape (37, 800, 800)
      Valid pixels: 55133/640000 (8.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=269805, num_faces=269916
      Valid probs shape: (37, 55133)
    ✓ Random_8 (pose=(0.4033120835128834, -1.9110053030823941, -0.45962100011818174)): shape (37, 800, 800)
      Valid pixels: 61938/640000 (9.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=74, max=269914, num_faces=269916
      Valid probs shape: (37, 61938)
    ✓ Random_9 (pose=(-2.038176174067573, 2.7998500066641476, 0.04714790899055288)): shape (37, 800, 800)
      Valid pixels: 71648/640000 (11.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=269877, num_faces=269916
      Valid probs shape: (37, 71648)
    ✓ Random_10 (pose=(3.0772378771900435, -0.21700500735773565, -0.4562493303503321)): shape (37, 800, 800)
      Valid pixels: 43393/640000 (6.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4238, max=269911, num_faces=269916
      Valid probs shape: (37, 43393)
    ✓ Random_11 (pose=(1.1122357435102979, -1.4142086568607988, 0.5403657338796468)): shape (37, 800, 800)
      Valid pixels: 90814/640000 (14.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=9, max=269807, num_faces=269916
      Valid probs shape: (37, 90814)
    ✓ Random_12 (pose=(-1.2725340889482295, 1.8659504246454173, -0.04489699883366649)): shape (37, 800, 800)
      Valid pixels: 91344/640000 (14.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=13, max=269895, num_faces=269916
      Valid probs shape: (37, 91344)
    ✓ Random_13 (pose=(1.5485027003919036, 1.5070866846287627, -0.7173307717437942)): shape (37, 800, 800)
      Valid pixels: 94237/640000 (14.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=269912, num_faces=269916
      Valid probs shape: (37, 94237)
    ✓ Random_14 (pose=(-3.1364355699770656, 1.6998378079599208, 2.879549846509758)): shape (37, 800, 800)
      Valid pixels: 59623/640000 (9.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7, max=269678, num_faces=269916
      Valid probs shape: (37, 59623)
    ✓ Random_15 (pose=(1.64493065418284, -0.11828978983593741, 1.1322782906944173)): shape (37, 800, 800)
      Valid pixels: 62581/640000 (9.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=18, max=269875, num_faces=269916
      Valid probs shape: (37, 62581)
    ✓ Random_16 (pose=(-1.0231232433243669, -2.8402117781992686, 2.6480461941849383)): shape (37, 800, 800)
      Valid pixels: 84070/640000 (13.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=74, max=269906, num_faces=269916
      Valid probs shape: (37, 84070)
    ✓ Random_17 (pose=(-2.076027491369558, -1.3941969175645892, -2.816598629038018)): shape (37, 800, 800)
      Valid pixels: 95467/640000 (14.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=269806, num_faces=269916
      Valid probs shape: (37, 95467)
    ✓ Random_18 (pose=(-0.18150681329347096, 0.07848147651260007, 0.49005958130050375)): shape (37, 800, 800)
      Valid pixels: 45337/640000 (7.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=269546, num_faces=269916
      Valid probs shape: (37, 45337)
    ✓ Random_19 (pose=(1.0590344816177977, -1.839961425324026, 0.03093535513936052)): shape (37, 800, 800)
      Valid pixels: 95336/640000 (14.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=269906, num_faces=269916
      Valid probs shape: (37, 95336)
    ✓ Random_20 (pose=(0.9105972341918571, -1.3647523176235725, 0.5387135309190385)): shape (37, 800, 800)
      Valid pixels: 94813/640000 (14.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=18, max=269805, num_faces=269916
      Valid probs shape: (37, 94813)
    ✓ Random_21 (pose=(3.1224677234784117, 2.41488170188598, -0.9675249521327958)): shape (37, 800, 800)
      Valid pixels: 55036/640000 (8.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=269805, num_faces=269916
      Valid probs shape: (37, 55036)
    ✓ Random_22 (pose=(2.4731903994309485, -1.8925340149858747, 0.812062386781677)): shape (37, 800, 800)
      Valid pixels: 63961/640000 (10.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=269650, num_faces=269916
      Valid probs shape: (37, 63961)
    ✓ Random_23 (pose=(-2.2685588487867534, -3.0442453739707065, -0.8151005627354282)): shape (37, 800, 800)
      Valid pixels: 71162/640000 (11.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=269876, num_faces=269916
      Valid probs shape: (37, 71162)
    ✓ Random_24 (pose=(2.2305859862226702, -2.647130689271287, -1.640590475212599)): shape (37, 800, 800)
      Valid pixels: 65090/640000 (10.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=269805, num_faces=269916
      Valid probs shape: (37, 65090)
    ✓ Random_25 (pose=(1.379692576265617, -0.850653745289415, -2.5874468051639234)): shape (37, 800, 800)
      Valid pixels: 73667/640000 (11.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=14, max=269878, num_faces=269916
      Valid probs shape: (37, 73667)
    ✓ Random_26 (pose=(1.519469032598809, 2.9883309869912997, 2.780883720768405)): shape (37, 800, 800)
      Valid pixels: 91368/640000 (14.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=269914, num_faces=269916
      Valid probs shape: (37, 91368)
    ✓ Random_27 (pose=(1.2599465098078202, -2.657974091308345, 2.723440768123563)): shape (37, 800, 800)
      Valid pixels: 90520/640000 (14.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=269914, num_faces=269916
      Valid probs shape: (37, 90520)
    ✓ Random_28 (pose=(2.6280184699474773, 0.8189813355825262, -1.75015186160819)): shape (37, 800, 800)
      Valid pixels: 72217/640000 (11.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1137, max=269914, num_faces=269916
      Valid probs shape: (37, 72217)
    ✓ Random_29 (pose=(-2.3175537757592144, 2.2600127442102114, 2.96062684573368)): shape (37, 800, 800)
      Valid pixels: 74170/640000 (11.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=269804, num_faces=269916
      Valid probs shape: (37, 74170)
    ✓ Random_30 (pose=(3.052544143736136, 1.3723342312463407, 0.8811952195493626)): shape (37, 800, 800)
      Valid pixels: 93398/640000 (14.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=269912, num_faces=269916
      Valid probs shape: (37, 93398)
    ✓ Random_31 (pose=(-2.2598137224375097, 0.05432353509918508, -1.0708655496394424)): shape (37, 800, 800)
      Valid pixels: 73182/640000 (11.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=10553, max=269911, num_faces=269916
      Valid probs shape: (37, 73182)
    ✓ Random_32 (pose=(-1.148052337499259, -0.3018985368299778, -0.47052243054158893)): shape (37, 800, 800)
      Valid pixels: 83985/640000 (13.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=269878, num_faces=269916
      Valid probs shape: (37, 83985)
    ✓ Random_33 (pose=(3.004415914606702, -1.5637989264181218, -1.3381219303158)): shape (37, 800, 800)
      Valid pixels: 90709/640000 (14.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=269805, num_faces=269916
      Valid probs shape: (37, 90709)
    ✓ Random_34 (pose=(1.6785966342077936, 0.1887393466518379, 2.0910820951159588)): shape (37, 800, 800)
      Valid pixels: 81782/640000 (12.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=15, max=269876, num_faces=269916
      Valid probs shape: (37, 81782)
    ✓ Random_35 (pose=(1.4615305633933318, -0.46978281809798217, 0.9435579382920283)): shape (37, 800, 800)
      Valid pixels: 67289/640000 (10.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=269808, num_faces=269916
      Valid probs shape: (37, 67289)
    ✓ Random_36 (pose=(2.741654881833811, -2.105525041013004, 0.645622602213523)): shape (37, 800, 800)
      Valid pixels: 63905/640000 (10.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=266866, num_faces=269916
      Valid probs shape: (37, 63905)
    ✓ Random_37 (pose=(-0.005309935493542639, 0.05413808606522119, -0.8589893737907324)): shape (37, 800, 800)
      Valid pixels: 38764/640000 (6.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=269447, num_faces=269916
      Valid probs shape: (37, 38764)
    ✓ Random_38 (pose=(0.3765777783519102, 1.6921073169977499, -2.592860810565255)): shape (37, 800, 800)
      Valid pixels: 69056/640000 (10.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=17, max=269914, num_faces=269916
      Valid probs shape: (37, 69056)
    ✓ Random_39 (pose=(-0.6380243613429242, 2.359184387184543, 2.5444707540207325)): shape (37, 800, 800)
      Valid pixels: 61833/640000 (9.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=232, max=269915, num_faces=269916
      Valid probs shape: (37, 61833)
    P stats: min=0.0000, max=1.0000, mean=0.0260
    Non-zero vertices: 129916/134960
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 5044 1234 1017 3487    0 1979 1011 4995 5916]
  Ground Truth Stats:
    Labels shape: (134960,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-9/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7948
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8365
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8367

  RESULTS:
  RAW:         median(top-10)=0.9145, mean(top-10)=0.9198, median(all)=0.8438, mean(all)=0.7948
  + SMOOTHING: median(top-10)=0.9353, mean(top-10)=0.9352, median(all)=0.8891, mean(all)=0.8365 [+0.0208]
  + MRF:       median(top-10)=0.9356, mean(top-10)=0.9354, median(all)=0.8890, mean(all)=0.8367 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0210

================================================================================
Subject: Twins-2-1
================================================================================
  Step 0: Generating predictions with V2 model (40 random views)...
  Mesh: 145069 vertices, 290134 faces
  Generating 40 random views...
  Generating predictions for 40 views (continuous camera pose)...
    ✓ Random_0 (pose=(-1.473690913032373, -1.71166045622122, 1.4572163242949898)): shape (37, 800, 800)
      Valid pixels: 75999/640000 (11.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=428, max=290133, num_faces=290134
      Valid probs shape: (37, 75999)
    ✓ Random_1 (pose=(1.620381574943866, 2.8137649408091336, -1.2487848117817715)): shape (37, 800, 800)
      Valid pixels: 89466/640000 (14.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=258, max=290133, num_faces=290134
      Valid probs shape: (37, 89466)
    ✓ Random_2 (pose=(-2.7470528516430965, 0.02370537671445838, -1.3478763460220122)): shape (37, 800, 800)
      Valid pixels: 61010/640000 (9.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=70658, max=290132, num_faces=290134
      Valid probs shape: (37, 61010)
    ✓ Random_3 (pose=(2.9488248716280276, -2.5155307249017094, 2.700152866994064)): shape (37, 800, 800)
      Valid pixels: 68434/640000 (10.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=0, max=289390, num_faces=290134
      Valid probs shape: (37, 68434)
    ✓ Random_4 (pose=(-3.105840875319362, -2.215045571051193, 0.8795697638853177)): shape (37, 800, 800)
      Valid pixels: 104471/640000 (16.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=0, max=289979, num_faces=290134
      Valid probs shape: (37, 104471)
    ✓ Random_5 (pose=(2.4816522096323617, 0.6676169210447536, 2.2198767073113244)): shape (37, 800, 800)
      Valid pixels: 61486/640000 (9.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=29909, max=290132, num_faces=290134
      Valid probs shape: (37, 61486)
    ✓ Random_6 (pose=(0.4779161426378393, 3.0468066198990913, -0.9710049146774535)): shape (37, 800, 800)
      Valid pixels: 77539/640000 (12.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1116, max=290133, num_faces=290134
      Valid probs shape: (37, 77539)
    ✓ Random_7 (pose=(2.04185914319772, 2.388890578570585, 0.7946733730955069)): shape (37, 800, 800)
      Valid pixels: 103613/640000 (16.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=290132, num_faces=290134
      Valid probs shape: (37, 103613)
    ✓ Random_8 (pose=(-2.7150549725132245, -0.7745760224235712, 3.088581529378117)): shape (37, 800, 800)
      Valid pixels: 93381/640000 (14.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=415, max=290133, num_faces=290134
      Valid probs shape: (37, 93381)
    ✓ Random_9 (pose=(-0.6509810689174178, -1.8013410893779676, -1.5739928331369957)): shape (37, 800, 800)
      Valid pixels: 115167/640000 (18.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=9, max=290012, num_faces=290134
      Valid probs shape: (37, 115167)
    ✓ Random_10 (pose=(-3.0355596101610542, 2.077373693877, -0.8025354402133305)): shape (37, 800, 800)
      Valid pixels: 83447/640000 (13.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=7, max=290132, num_faces=290134
      Valid probs shape: (37, 83447)
    ✓ Random_11 (pose=(2.0631058961832416, -1.9313905313142241, 2.7363392842328453)): shape (37, 800, 800)
      Valid pixels: 110842/640000 (17.3%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=9, max=290131, num_faces=290134
      Valid probs shape: (37, 110842)
    ✓ Random_12 (pose=(0.33837928928494376, 0.32353590270187293, -1.5664603681279097)): shape (37, 800, 800)
      Valid pixels: 65450/640000 (10.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=290133, num_faces=290134
      Valid probs shape: (37, 65450)
    ✓ Random_13 (pose=(1.4514232519370625, -0.5348060656894957, -0.01844640625091154)): shape (37, 800, 800)
      Valid pixels: 124217/640000 (19.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8, max=290133, num_faces=290134
      Valid probs shape: (37, 124217)
    ✓ Random_14 (pose=(-1.6503788053044557, -2.355213023445795, -0.2995939809736554)): shape (37, 800, 800)
      Valid pixels: 119749/640000 (18.7%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=10, max=290133, num_faces=290134
      Valid probs shape: (37, 119749)
    ✓ Random_15 (pose=(1.9341754862317604, 1.5171361152126357, -3.1032351966846856)): shape (37, 800, 800)
      Valid pixels: 119401/640000 (18.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=4, max=290131, num_faces=290134
      Valid probs shape: (37, 119401)
    ✓ Random_16 (pose=(0.7578366958564855, -0.19302769057687552, 2.603805775467812)): shape (37, 800, 800)
      Valid pixels: 96111/640000 (15.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=289979, num_faces=290134
      Valid probs shape: (37, 96111)
    ✓ Random_17 (pose=(0.46815800651419215, 0.663546981650629, -0.6174151729646669)): shape (37, 800, 800)
      Valid pixels: 92708/640000 (14.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=290132, num_faces=290134
      Valid probs shape: (37, 92708)
    ✓ Random_18 (pose=(-0.34090713145414897, -2.9767472523860667, -1.6046995959029835)): shape (37, 800, 800)
      Valid pixels: 63781/640000 (10.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=64996, max=290131, num_faces=290134
      Valid probs shape: (37, 63781)
    ✓ Random_19 (pose=(1.3009559142782745, -0.8241748922509307, 0.7924889374167297)): shape (37, 800, 800)
      Valid pixels: 101157/640000 (15.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=4, max=290127, num_faces=290134
      Valid probs shape: (37, 101157)
    ✓ Random_20 (pose=(-2.30613011485259, 0.9301223474805242, 1.3954555764167136)): shape (37, 800, 800)
      Valid pixels: 100028/640000 (15.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=859, max=290133, num_faces=290134
      Valid probs shape: (37, 100028)
    ✓ Random_21 (pose=(-2.862915500008746, 1.0657833797122027, -2.452787872015161)): shape (37, 800, 800)
      Valid pixels: 88606/640000 (13.8%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=12345, max=289705, num_faces=290134
      Valid probs shape: (37, 88606)
    ✓ Random_22 (pose=(-0.40506218229938407, 1.4008179472621922, -1.573333528809152)): shape (37, 800, 800)
      Valid pixels: 108402/640000 (16.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=9, max=290132, num_faces=290134
      Valid probs shape: (37, 108402)
    ✓ Random_23 (pose=(-0.8531685222668695, -1.7063930922479436, 2.8525589270703406)): shape (37, 800, 800)
      Valid pixels: 108385/640000 (16.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=9, max=290131, num_faces=290134
      Valid probs shape: (37, 108385)
    ✓ Random_24 (pose=(1.18006528418299, 1.4202988232303646, 1.9455036389313056)): shape (37, 800, 800)
      Valid pixels: 113938/640000 (17.8%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=6, max=290034, num_faces=290134
      Valid probs shape: (37, 113938)
    ✓ Random_25 (pose=(0.8209034992507593, 0.682857865049384, 1.4372929253173936)): shape (37, 800, 800)
      Valid pixels: 91001/640000 (14.2%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=1, max=289396, num_faces=290134
      Valid probs shape: (37, 91001)
    ✓ Random_26 (pose=(-1.4585048169112758, 1.6410705468144577, 2.383465336188457)): shape (37, 800, 800)
      Valid pixels: 113161/640000 (17.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=27, max=290133, num_faces=290134
      Valid probs shape: (37, 113161)
    ✓ Random_27 (pose=(-0.6648767686646893, -1.5401995244552462, -2.356330950453211)): shape (37, 800, 800)
      Valid pixels: 77665/640000 (12.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=287839, num_faces=290134
      Valid probs shape: (37, 77665)
    ✓ Random_28 (pose=(2.984947305937757, 0.11702987778878793, -0.4042166574344317)): shape (37, 800, 800)
      Valid pixels: 58942/640000 (9.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1116, max=290131, num_faces=290134
      Valid probs shape: (37, 58942)
    ✓ Random_29 (pose=(1.9799505629338645, 1.1363729746602642, 2.628673464678198)): shape (37, 800, 800)
      Valid pixels: 110001/640000 (17.2%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=10, max=289706, num_faces=290134
      Valid probs shape: (37, 110001)
    ✓ Random_30 (pose=(-0.19867515104940692, 1.1566354419835534, 3.1032481569571884)): shape (37, 800, 800)
      Valid pixels: 70908/640000 (11.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=25, max=290133, num_faces=290134
      Valid probs shape: (37, 70908)
    ✓ Random_31 (pose=(-0.1647326450058264, -2.4765142444162187, 3.0997588157705467)): shape (37, 800, 800)
      Valid pixels: 57137/640000 (8.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1057, max=290132, num_faces=290134
      Valid probs shape: (37, 57137)
    ✓ Random_32 (pose=(2.4789620293276755, 0.18654064298311113, 1.0754023168492282)): shape (37, 800, 800)
      Valid pixels: 65786/640000 (10.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=508, max=290131, num_faces=290134
      Valid probs shape: (37, 65786)
    ✓ Random_33 (pose=(-1.6015974377118714, 2.8666753132278826, 2.1687967470408145)): shape (37, 800, 800)
      Valid pixels: 108393/640000 (16.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=29, max=290133, num_faces=290134
      Valid probs shape: (37, 108393)
    ✓ Random_34 (pose=(-1.2169992757519785, 1.8114307829224323, -1.7024218937550175)): shape (37, 800, 800)
      Valid pixels: 82295/640000 (12.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=290133, num_faces=290134
      Valid probs shape: (37, 82295)
    ✓ Random_35 (pose=(2.51851706545599, -0.47647680781065205, 0.3263976684160852)): shape (37, 800, 800)
      Valid pixels: 67945/640000 (10.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=529, max=290132, num_faces=290134
      Valid probs shape: (37, 67945)
    ✓ Random_36 (pose=(-2.19756220862142, 0.5360450819848879, 0.4054321528701168)): shape (37, 800, 800)
      Valid pixels: 92516/640000 (14.5%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=1780, max=290132, num_faces=290134
      Valid probs shape: (37, 92516)
    ✓ Random_37 (pose=(2.8593782140107065, 0.640713318250508, -2.761607685500976)): shape (37, 800, 800)
      Valid pixels: 89666/640000 (14.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=4762, max=290131, num_faces=290134
      Valid probs shape: (37, 89666)
    ✓ Random_38 (pose=(2.5904226841659908, -1.3185424890802127, 1.0210691405659178)): shape (37, 800, 800)
      Valid pixels: 98476/640000 (15.4%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=9, max=289685, num_faces=290134
      Valid probs shape: (37, 98476)
    ✓ Random_39 (pose=(-0.5656833048901371, -2.218633998514736, -2.2417906878658935)): shape (37, 800, 800)
      Valid pixels: 78250/640000 (12.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=12346, max=289392, num_faces=290134
      Valid probs shape: (37, 78250)
    P stats: min=0.0000, max=0.9998, mean=0.0256
    Non-zero vertices: 137490/145069
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 7579 1144  994 4290    0 1963 1218 5414 6388]
  Ground Truth Stats:
    Labels shape: (145069,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/Twins-2-1/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7783
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8289
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8294

  RESULTS:
  RAW:         median(top-10)=0.9122, mean(top-10)=0.9133, median(all)=0.8399, mean(all)=0.7783
  + SMOOTHING: median(top-10)=0.9290, mean(top-10)=0.9295, median(all)=0.8673, mean(all)=0.8289 [+0.0169]
  + MRF:       median(top-10)=0.9295, mean(top-10)=0.9299, median(all)=0.8675, mean(all)=0.8294 [+0.0005]
  TOTAL IMPROVEMENT (median top-10): +0.0173

================================================================================
Subject: Twins-2-2
================================================================================
  Step 0: Generating predictions with V2 model (40 random views)...
  Mesh: 149751 vertices, 299498 faces
  Generating 40 random views...
  Generating predictions for 40 views (continuous camera pose)...
    ✓ Random_0 (pose=(0.486432452858105, -1.0119581407869211, 2.8490485735685276)): shape (37, 800, 800)
      Valid pixels: 100755/640000 (15.7%)
      Probs stats: min=0.0000, max=0.9995, mean=0.0270
      Face IDs: min=2, max=298363, num_faces=299498
      Valid probs shape: (37, 100755)
    ✓ Random_1 (pose=(1.554841468130352, 0.11045169763308094, -0.5100630668576009)): shape (37, 800, 800)
      Valid pixels: 138151/640000 (21.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=299497, num_faces=299498
      Valid probs shape: (37, 138151)
    ✓ Random_2 (pose=(1.022632567744572, -1.4251022505624436, 0.7698061633734916)): shape (37, 800, 800)
      Valid pixels: 132367/640000 (20.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=299497, num_faces=299498
      Valid probs shape: (37, 132367)
    ✓ Random_3 (pose=(2.227256128991007, -1.2380405750561736, -0.899568046061638)): shape (37, 800, 800)
      Valid pixels: 144730/640000 (22.6%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=0, max=299497, num_faces=299498
      Valid probs shape: (37, 144730)
    ✓ Random_4 (pose=(2.414446762008219, -1.3628940756048264, -3.0088426949690237)): shape (37, 800, 800)
      Valid pixels: 98430/640000 (15.4%)
      Probs stats: min=0.0000, max=0.9991, mean=0.0270
      Face IDs: min=120, max=299459, num_faces=299498
      Valid probs shape: (37, 98430)
    ✓ Random_5 (pose=(0.8146021558781564, -0.017736156371206402, -2.4084355939547324)): shape (37, 800, 800)
      Valid pixels: 90749/640000 (14.2%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=1, max=298361, num_faces=299498
      Valid probs shape: (37, 90749)
    ✓ Random_6 (pose=(-0.05457122966525718, -1.5128106470473583, -0.5456361857116554)): shape (37, 800, 800)
      Valid pixels: 95040/640000 (14.8%)
      Probs stats: min=0.0000, max=0.9992, mean=0.0270
      Face IDs: min=98, max=299461, num_faces=299498
      Valid probs shape: (37, 95040)
    ✓ Random_7 (pose=(2.118439825424238, -1.0330051449886866, -1.713458490039816)): shape (37, 800, 800)
      Valid pixels: 107769/640000 (16.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=335, max=299497, num_faces=299498
      Valid probs shape: (37, 107769)
    ✓ Random_8 (pose=(2.348461978776694, -1.9521545891420822, 2.5277136715839736)): shape (37, 800, 800)
      Valid pixels: 123492/640000 (19.3%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=4, max=299256, num_faces=299498
      Valid probs shape: (37, 123492)
    ✓ Random_9 (pose=(0.4531345262002793, 0.4079618309678881, -1.1958612032694846)): shape (37, 800, 800)
      Valid pixels: 87000/640000 (13.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=299493, num_faces=299498
      Valid probs shape: (37, 87000)
    ✓ Random_10 (pose=(-3.0565020951191864, -3.075455368749867, 0.7586454835351626)): shape (37, 800, 800)
      Valid pixels: 76896/640000 (12.0%)
      Probs stats: min=0.0000, max=0.9995, mean=0.0270
      Face IDs: min=0, max=298358, num_faces=299498
      Valid probs shape: (37, 76896)
    ✓ Random_11 (pose=(2.514530995008383, 2.2799735970330293, 1.2235151791628747)): shape (37, 800, 800)
      Valid pixels: 110388/640000 (17.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=299492, num_faces=299498
      Valid probs shape: (37, 110388)
    ✓ Random_12 (pose=(2.416159446787982, 2.592289601601445, 3.128683155674123)): shape (37, 800, 800)
      Valid pixels: 123767/640000 (19.3%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=0, max=298364, num_faces=299498
      Valid probs shape: (37, 123767)
    ✓ Random_13 (pose=(2.373190048419927, -0.7987480100431688, 1.3894846675940418)): shape (37, 800, 800)
      Valid pixels: 99784/640000 (15.6%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=5244, max=299251, num_faces=299498
      Valid probs shape: (37, 99784)
    ✓ Random_14 (pose=(2.6904127985907316, 2.639820934368382, 1.66848873804879)): shape (37, 800, 800)
      Valid pixels: 89986/640000 (14.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=299462, num_faces=299498
      Valid probs shape: (37, 89986)
    ✓ Random_15 (pose=(2.932443399654985, -1.1902639259672994, -2.6696010599691897)): shape (37, 800, 800)
      Valid pixels: 101921/640000 (15.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=630, max=299497, num_faces=299498
      Valid probs shape: (37, 101921)
    ✓ Random_16 (pose=(1.6920693447976962, 0.5503378243580683, 0.43750442051507576)): shape (37, 800, 800)
      Valid pixels: 126574/640000 (19.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=299497, num_faces=299498
      Valid probs shape: (37, 126574)
    ✓ Random_17 (pose=(3.089039676866901, -1.5406811579156274, -2.224333414475777)): shape (37, 800, 800)
      Valid pixels: 132119/640000 (20.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=299497, num_faces=299498
      Valid probs shape: (37, 132119)
    ✓ Random_18 (pose=(-1.9327262927975106, 1.8834107046578579, 0.003590149066969417)): shape (37, 800, 800)
      Valid pixels: 114874/640000 (17.9%)
      Probs stats: min=0.0000, max=0.9994, mean=0.0270
      Face IDs: min=2, max=298364, num_faces=299498
      Valid probs shape: (37, 114874)
    ✓ Random_19 (pose=(0.6960734466106531, 2.490338223728182, -1.4585151572325565)): shape (37, 800, 800)
      Valid pixels: 124757/640000 (19.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=979, max=299497, num_faces=299498
      Valid probs shape: (37, 124757)
    ✓ Random_20 (pose=(2.135410017189052, 0.9810945545376217, 1.483163997491471)): shape (37, 800, 800)
      Valid pixels: 93291/640000 (14.6%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=3, max=299462, num_faces=299498
      Valid probs shape: (37, 93291)
    ✓ Random_21 (pose=(-2.302491702519361, 2.9028901210180083, 0.5599472147213946)): shape (37, 800, 800)
      Valid pixels: 89672/640000 (14.0%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=0, max=298361, num_faces=299498
      Valid probs shape: (37, 89672)
    ✓ Random_22 (pose=(0.12761454409899464, -2.793948957572652, -1.5133457313648464)): shape (37, 800, 800)
      Valid pixels: 86988/640000 (13.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=20567, max=299462, num_faces=299498
      Valid probs shape: (37, 86988)
    ✓ Random_23 (pose=(-2.650543029468734, -0.21241264145788508, 1.7747762042397728)): shape (37, 800, 800)
      Valid pixels: 85896/640000 (13.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=10359, max=299459, num_faces=299498
      Valid probs shape: (37, 85896)
    ✓ Random_24 (pose=(2.2066501818998656, -0.2763795231110415, 0.957700140160358)): shape (37, 800, 800)
      Valid pixels: 77905/640000 (12.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=321, max=299462, num_faces=299498
      Valid probs shape: (37, 77905)
    ✓ Random_25 (pose=(0.12652806596118094, -1.5226559806148947, 1.5552908408053057)): shape (37, 800, 800)
      Valid pixels: 137210/640000 (21.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=299497, num_faces=299498
      Valid probs shape: (37, 137210)
    ✓ Random_26 (pose=(2.388454776980219, -2.168757215113118, -0.7802788638113527)): shape (37, 800, 800)
      Valid pixels: 125487/640000 (19.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=299497, num_faces=299498
      Valid probs shape: (37, 125487)
    ✓ Random_27 (pose=(-0.44614767496933316, -2.4361682918541447, 2.38809972399857)): shape (37, 800, 800)
      Valid pixels: 115781/640000 (18.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=320, max=299497, num_faces=299498
      Valid probs shape: (37, 115781)
    ✓ Random_28 (pose=(-1.2609795532670913, -1.6121688908250447, -1.6210193643237116)): shape (37, 800, 800)
      Valid pixels: 98938/640000 (15.5%)
      Probs stats: min=0.0000, max=0.9994, mean=0.0270
      Face IDs: min=0, max=298364, num_faces=299498
      Valid probs shape: (37, 98938)
    ✓ Random_29 (pose=(0.6558048894551085, 2.155145541049066, -2.71906491655096)): shape (37, 800, 800)
      Valid pixels: 94214/640000 (14.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1259, max=299461, num_faces=299498
      Valid probs shape: (37, 94214)
    ✓ Random_30 (pose=(-0.6237614879427062, 3.045923800693193, 0.9328676593306406)): shape (37, 800, 800)
      Valid pixels: 94889/640000 (14.8%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=9792, max=299459, num_faces=299498
      Valid probs shape: (37, 94889)
    ✓ Random_31 (pose=(-0.45821690785650837, -0.9971087271461809, -2.213639617526515)): shape (37, 800, 800)
      Valid pixels: 108196/640000 (16.9%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=1, max=298364, num_faces=299498
      Valid probs shape: (37, 108196)
    ✓ Random_32 (pose=(2.037631129646879, 1.3676127809651106, 2.6377946988218612)): shape (37, 800, 800)
      Valid pixels: 120563/640000 (18.8%)
      Probs stats: min=0.0000, max=0.9995, mean=0.0270
      Face IDs: min=209, max=298364, num_faces=299498
      Valid probs shape: (37, 120563)
    ✓ Random_33 (pose=(2.0716788435517763, 0.25058029365153267, 2.3531654969533484)): shape (37, 800, 800)
      Valid pixels: 111023/640000 (17.3%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=2056, max=299256, num_faces=299498
      Valid probs shape: (37, 111023)
    ✓ Random_34 (pose=(-2.3824061496915734, -2.315301477150131, 2.3459269978618673)): shape (37, 800, 800)
      Valid pixels: 67499/640000 (10.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=299455, num_faces=299498
      Valid probs shape: (37, 67499)
    ✓ Random_35 (pose=(-1.684178239846078, 3.0817606121838352, -2.031605043141229)): shape (37, 800, 800)
      Valid pixels: 93156/640000 (14.6%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=6, max=299462, num_faces=299498
      Valid probs shape: (37, 93156)
    ✓ Random_36 (pose=(-2.8075650809274144, -0.3407407705743797, -0.5230754340381623)): shape (37, 800, 800)
      Valid pixels: 65634/640000 (10.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=59737, max=299285, num_faces=299498
      Valid probs shape: (37, 65634)
    ✓ Random_37 (pose=(-2.9765571281722716, -1.563201841587806, -0.7102982480968967)): shape (37, 800, 800)
      Valid pixels: 96469/640000 (15.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=0, max=299462, num_faces=299498
      Valid probs shape: (37, 96469)
    ✓ Random_38 (pose=(-0.2698192253538081, -2.8468225239730227, -0.5703488786819819)): shape (37, 800, 800)
      Valid pixels: 88868/640000 (13.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=22816, max=299458, num_faces=299498
      Valid probs shape: (37, 88868)
    ✓ Random_39 (pose=(0.2550429953413649, 1.2971166360731265, 2.991013290535836)): shape (37, 800, 800)
      Valid pixels: 84357/640000 (13.2%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=7, max=299455, num_faces=299498
      Valid probs shape: (37, 84357)
    P stats: min=0.0000, max=0.9998, mean=0.0259
    Non-zero vertices: 143388/149751
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 6363 1073 1045 3981    0 2671  828 5197 7597]
  Ground Truth Stats:
    Labels shape: (149751,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/Twins-2-2/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7421
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7834
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7839

  RESULTS:
  RAW:         median(top-10)=0.9026, mean(top-10)=0.9104, median(all)=0.8044, mean(all)=0.7421
  + SMOOTHING: median(top-10)=0.9257, mean(top-10)=0.9278, median(all)=0.8302, mean(all)=0.7834 [+0.0230]
  + MRF:       median(top-10)=0.9259, mean(top-10)=0.9281, median(all)=0.8306, mean(all)=0.7839 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0233

================================================================================
AGGREGATE RESULTS ACROSS ALL TEST SUBJECTS
================================================================================
Number of subjects: 101

RAW PREDICTIONS:
  Median(top-10):  0.9084 ± 0.0100  (min: 0.8857, max: 0.9323)
  Mean(top-10):    0.9114 ± 0.0084  (min: 0.8884, max: 0.9268)
  Median(all):     0.8417 ± 0.0176  (min: 0.7781, max: 0.8721)
  Mean(all):       0.7783 ± 0.0165  (min: 0.7016, max: 0.8125)

+ SMOOTHING (α=0.75, 20 iter):
  Median(top-10):  0.9283 ± 0.0083  (min: 0.9069, max: 0.9476)
  Mean(top-10):    0.9296 ± 0.0072  (min: 0.9105, max: 0.9439)
  Median(all):     0.8714 ± 0.0167  (min: 0.8056, max: 0.9009)
  Mean(all):       0.8249 ± 0.0161  (min: 0.7435, max: 0.8546)
  Improvement:     median(top-10) +0.0199, mean(all) +0.0466

+ MRF (β=0.1, 5 iter):
  Median(top-10):  0.9286 ± 0.0083  (min: 0.9071, max: 0.9477)
  Mean(top-10):    0.9298 ± 0.0072  (min: 0.9108, max: 0.9439)
  Median(all):     0.8718 ± 0.0167  (min: 0.8063, max: 0.9011)
  Mean(all):       0.8252 ± 0.0161  (min: 0.7436, max: 0.8551)
  Improvement:     median(top-10) +0.0003, mean(all) +0.0003

TOTAL IMPROVEMENT (RAW → MRF):
  Median(top-10):  +0.0202
  Mean(top-10):    +0.0184
  Median(all):     +0.0300
  Mean(all):       +0.0468
================================================================================
