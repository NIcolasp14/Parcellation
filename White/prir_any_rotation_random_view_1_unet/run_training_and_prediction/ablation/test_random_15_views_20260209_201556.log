nohup: ignoring input
[GPU] PyTorch3D loaded - GPU raycasting AVAILABLE (FAST MODE: bin_size=None)
[GPU] PyTorch3D loaded - GPU raycasting AVAILABLE (will be enabled via --raycasting arg)
Using 15 random views for testing
Auto-detected latest checkpoint: last.ckpt

Loading model from: /autofs/space/ballarat_004/users/np341/PRIR_Code/Training/White/prir_x_y_z_conditional_1_unet/models/xyz_random_views_7794326/last.ckpt
✓ Model loaded (using TRAIN mode due to corrupted BN running stats)

================================================================================
Testing VIEW-CONDITIONED model V2 (Arbitrary Views) with PyTorch3D pipeline
Checkpoint: /autofs/space/ballarat_004/users/np341/PRIR_Code/Training/White/prir_x_y_z_conditional_1_unet/models/xyz_random_views_7794326/last.ckpt
Test data: /autofs/space/ballarat_004/users/np341/mindboggle2
Using 15 random views per subject
1. Generate predictions using V2 model (continuous camera pose)
2. Iterative smoothing (α=0.75, 20 iter)
3. MRF with ICM (β=0.1)
================================================================================

Found 101 test subjects

================================================================================
Subject: Afterthought-1
================================================================================
  Step 0: Generating predictions with V2 model (15 random views)...
  Mesh: 130921 vertices, 261838 faces
  Generating 15 random views...
  Generating predictions for 15 views (continuous camera pose)...
    ✓ Random_0 (pose=(2.945311169114631, 1.453724818312768, -1.3608334501480088)): shape (37, 800, 800)
      Valid pixels: 84608/640000 (13.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=228, max=261837, num_faces=261838
      Valid probs shape: (37, 84608)
    ✓ Random_1 (pose=(1.9694394678952927, 2.8295776237547257, -2.1636625783571257)): shape (37, 800, 800)
      Valid pixels: 73938/640000 (11.6%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=3, max=261835, num_faces=261838
      Valid probs shape: (37, 73938)
    ✓ Random_2 (pose=(1.1252514969042577, 2.702041066808012, 2.8817303018296423)): shape (37, 800, 800)
      Valid pixels: 94198/640000 (14.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=740, max=261837, num_faces=261838
      Valid probs shape: (37, 94198)
    ✓ Random_3 (pose=(-3.1269786660068957, 1.5422613323727132, -0.4898669196305039)): shape (37, 800, 800)
      Valid pixels: 75108/640000 (11.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=111, max=261837, num_faces=261838
      Valid probs shape: (37, 75108)
    ✓ Random_4 (pose=(1.3585556802328362, 0.5598230067422509, 0.09793369444146593)): shape (37, 800, 800)
      Valid pixels: 94407/640000 (14.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=261837, num_faces=261838
      Valid probs shape: (37, 94407)
    ✓ Random_5 (pose=(-1.648257525504304, 2.1398878070831877, -0.11575030768705918)): shape (37, 800, 800)
      Valid pixels: 96066/640000 (15.0%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=10, max=261816, num_faces=261838
      Valid probs shape: (37, 96066)
    ✓ Random_6 (pose=(-2.4084477325929603, -2.590998953499198, -1.1292466524315294)): shape (37, 800, 800)
      Valid pixels: 62931/640000 (9.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=260585, num_faces=261838
      Valid probs shape: (37, 62931)
    ✓ Random_7 (pose=(2.0929551735083667, 2.048654336970758, 3.1003485480857)): shape (37, 800, 800)
      Valid pixels: 101510/640000 (15.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=261703, num_faces=261838
      Valid probs shape: (37, 101510)
    ✓ Random_8 (pose=(-2.635474304781627, -2.2118443146295537, 0.2896297584367442)): shape (37, 800, 800)
      Valid pixels: 93254/640000 (14.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=261702, num_faces=261838
      Valid probs shape: (37, 93254)
    ✓ Random_9 (pose=(2.1505699268842022, 1.9078998689939395, 2.9063364951401844)): shape (37, 800, 800)
      Valid pixels: 99500/640000 (15.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=261703, num_faces=261838
      Valid probs shape: (37, 99500)
    ✓ Random_10 (pose=(2.320991914299551, -2.7685343235693427, 0.7334037885343183)): shape (37, 800, 800)
      Valid pixels: 66194/640000 (10.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=261834, num_faces=261838
      Valid probs shape: (37, 66194)
    ✓ Random_11 (pose=(-1.3461636649484057, -2.053376245008679, -0.03557365369627963)): shape (37, 800, 800)
      Valid pixels: 91102/640000 (14.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=80, max=261837, num_faces=261838
      Valid probs shape: (37, 91102)
    ✓ Random_12 (pose=(0.17580057707506702, -1.744021775546378, -1.2530064670371166)): shape (37, 800, 800)
      Valid pixels: 82902/640000 (13.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=298, max=261837, num_faces=261838
      Valid probs shape: (37, 82902)
    ✓ Random_13 (pose=(1.5630596629554319, -1.9117137140906741, -2.3770071486532123)): shape (37, 800, 800)
      Valid pixels: 78464/640000 (12.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=109, max=261837, num_faces=261838
      Valid probs shape: (37, 78464)
    ✓ Random_14 (pose=(2.181252129010799, -1.2111580720959025, -2.5807565110482367)): shape (37, 800, 800)
      Valid pixels: 74472/640000 (11.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=146, max=261837, num_faces=261838
      Valid probs shape: (37, 74472)
    P stats: min=0.0000, max=1.0000, mean=0.0219
    Non-zero vertices: 105960/130921
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 24961  1448   817  3077     0  1699   852  2679  6096]
  Ground Truth Stats:
    Labels shape: (130921,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/Afterthought-1/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7190
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8178
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8181

  RESULTS:
  RAW:         median(top-10)=0.8667, mean(top-10)=0.8670, median(all)=0.7712, mean(all)=0.7190
  + SMOOTHING: median(top-10)=0.9192, mean(top-10)=0.9167, median(all)=0.8573, mean(all)=0.8178 [+0.0525]
  + MRF:       median(top-10)=0.9194, mean(top-10)=0.9170, median(all)=0.8575, mean(all)=0.8181 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0527

================================================================================
Subject: Colin27-1
================================================================================
  Step 0: Generating predictions with V2 model (15 random views)...
  Mesh: 182414 vertices, 364824 faces
  Generating 15 random views...
  Generating predictions for 15 views (continuous camera pose)...
    ✓ Random_0 (pose=(0.16055641306702917, -2.3624435871597775, -0.3406839891765454)): shape (37, 800, 800)
      Valid pixels: 52825/640000 (8.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1064, max=364823, num_faces=364824
      Valid probs shape: (37, 52825)
    ✓ Random_1 (pose=(-1.3121534298687314, 3.072189382656296, 2.2959034043883078)): shape (37, 800, 800)
      Valid pixels: 88233/640000 (13.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=133, max=364815, num_faces=364824
      Valid probs shape: (37, 88233)
    ✓ Random_2 (pose=(1.8605722777641622, 0.5297655786755726, 2.5272322912615834)): shape (37, 800, 800)
      Valid pixels: 89766/640000 (14.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=364174, num_faces=364824
      Valid probs shape: (37, 89766)
    ✓ Random_3 (pose=(-1.0786631778686409, -1.7253314646451592, -3.084090595322287)): shape (37, 800, 800)
      Valid pixels: 79675/640000 (12.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=138, max=364820, num_faces=364824
      Valid probs shape: (37, 79675)
    ✓ Random_4 (pose=(2.810561940142377, -1.391839172821724, -1.4498995065550722)): shape (37, 800, 800)
      Valid pixels: 98575/640000 (15.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=74, max=364819, num_faces=364824
      Valid probs shape: (37, 98575)
    ✓ Random_5 (pose=(-1.3178497655670176, -1.4190602741138394, 1.2493624488071084)): shape (37, 800, 800)
      Valid pixels: 60675/640000 (9.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=132, max=364823, num_faces=364824
      Valid probs shape: (37, 60675)
    ✓ Random_6 (pose=(-0.14195871793382064, 0.8505470799171642, -0.587604199833319)): shape (37, 800, 800)
      Valid pixels: 54199/640000 (8.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=364820, num_faces=364824
      Valid probs shape: (37, 54199)
    ✓ Random_7 (pose=(-0.8107037389867724, 1.090216755692305, -0.2879827801316228)): shape (37, 800, 800)
      Valid pixels: 80760/640000 (12.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=364172, num_faces=364824
      Valid probs shape: (37, 80760)
    ✓ Random_8 (pose=(-0.6479503343991109, -1.1813530426394552, -2.3986389003535016)): shape (37, 800, 800)
      Valid pixels: 57605/640000 (9.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=363728, num_faces=364824
      Valid probs shape: (37, 57605)
    ✓ Random_9 (pose=(2.99865225147232, -0.6375488131397558, -2.4560643170615886)): shape (37, 800, 800)
      Valid pixels: 55107/640000 (8.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=694, max=364823, num_faces=364824
      Valid probs shape: (37, 55107)
    ✓ Random_10 (pose=(1.4849837651354152, 1.0539631621117254, 0.05903542727895328)): shape (37, 800, 800)
      Valid pixels: 94344/640000 (14.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=20, max=364820, num_faces=364824
      Valid probs shape: (37, 94344)
    ✓ Random_11 (pose=(0.35360175167363783, 1.7497423615809726, 0.5302580717564562)): shape (37, 800, 800)
      Valid pixels: 63293/640000 (9.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=371, max=364175, num_faces=364824
      Valid probs shape: (37, 63293)
    ✓ Random_12 (pose=(-1.3633750529853368, -1.8025593867388896, -0.564129988253506)): shape (37, 800, 800)
      Valid pixels: 94111/640000 (14.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=364676, num_faces=364824
      Valid probs shape: (37, 94111)
    ✓ Random_13 (pose=(0.13736703670946326, -1.7894584710666515, -3.0160074199981812)): shape (37, 800, 800)
      Valid pixels: 67710/640000 (10.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=331, max=364172, num_faces=364824
      Valid probs shape: (37, 67710)
    ✓ Random_14 (pose=(-2.6272611596926665, -0.48994609685199997, 2.1623135478711966)): shape (37, 800, 800)
      Valid pixels: 50575/640000 (7.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1079, max=364823, num_faces=364824
      Valid probs shape: (37, 50575)
    P stats: min=0.0000, max=1.0000, mean=0.0223
    Non-zero vertices: 150563/182414
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 31851   901  1521  3480     0  2717  1474  5141  7669]
  Ground Truth Stats:
    Labels shape: (182414,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/Colin27-1/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6969
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7833
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7836

  RESULTS:
  RAW:         median(top-10)=0.8124, mean(top-10)=0.8264, median(all)=0.7636, mean(all)=0.6969
  + SMOOTHING: median(top-10)=0.8876, mean(top-10)=0.8885, median(all)=0.8458, mean(all)=0.7833 [+0.0752]
  + MRF:       median(top-10)=0.8879, mean(top-10)=0.8887, median(all)=0.8464, mean(all)=0.7836 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0755

================================================================================
Subject: HLN-12-1
================================================================================
  Step 0: Generating predictions with V2 model (15 random views)...
  Mesh: 138729 vertices, 277454 faces
  Generating 15 random views...
  Generating predictions for 15 views (continuous camera pose)...
    ✓ Random_0 (pose=(2.475692917677753, -2.0816554130411307, 0.019589963132348398)): shape (37, 800, 800)
      Valid pixels: 83691/640000 (13.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=277449, num_faces=277454
      Valid probs shape: (37, 83691)
    ✓ Random_1 (pose=(-2.18816378679441, -0.4584848151810701, 1.741248480507565)): shape (37, 800, 800)
      Valid pixels: 79083/640000 (12.4%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=317, max=277453, num_faces=277454
      Valid probs shape: (37, 79083)
    ✓ Random_2 (pose=(1.2983775399965607, 2.567364376184587, -2.3519549219158717)): shape (37, 800, 800)
      Valid pixels: 81391/640000 (12.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=105, max=277448, num_faces=277454
      Valid probs shape: (37, 81391)
    ✓ Random_3 (pose=(2.7888356234598985, 1.165491110003816, 1.3455666007080787)): shape (37, 800, 800)
      Valid pixels: 94426/640000 (14.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=277453, num_faces=277454
      Valid probs shape: (37, 94426)
    ✓ Random_4 (pose=(-1.7121078942714971, 1.2489002583797797, 0.8073307304405182)): shape (37, 800, 800)
      Valid pixels: 79003/640000 (12.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=31, max=277450, num_faces=277454
      Valid probs shape: (37, 79003)
    ✓ Random_5 (pose=(1.9275560701023853, -0.21033007111172664, -1.1116021764742574)): shape (37, 800, 800)
      Valid pixels: 93225/640000 (14.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=13, max=277453, num_faces=277454
      Valid probs shape: (37, 93225)
    ✓ Random_6 (pose=(2.558059237933902, -1.3871328252415027, -2.8363113108806894)): shape (37, 800, 800)
      Valid pixels: 78574/640000 (12.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=52, max=277453, num_faces=277454
      Valid probs shape: (37, 78574)
    ✓ Random_7 (pose=(-0.9062411685565945, -2.8696542163312078, 0.5206711738179228)): shape (37, 800, 800)
      Valid pixels: 84057/640000 (13.1%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=2390, max=277441, num_faces=277454
      Valid probs shape: (37, 84057)
    ✓ Random_8 (pose=(1.4038302725465188, 1.6835753677344343, -2.7233289357211783)): shape (37, 800, 800)
      Valid pixels: 84238/640000 (13.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=277453, num_faces=277454
      Valid probs shape: (37, 84238)
    ✓ Random_9 (pose=(0.165768061522519, 1.6740079842930218, 1.9142964933479458)): shape (37, 800, 800)
      Valid pixels: 96446/640000 (15.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=6, max=277385, num_faces=277454
      Valid probs shape: (37, 96446)
    ✓ Random_10 (pose=(1.338066746617372, 1.3867100571209594, 1.9460360218719517)): shape (37, 800, 800)
      Valid pixels: 99453/640000 (15.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=277285, num_faces=277454
      Valid probs shape: (37, 99453)
    ✓ Random_11 (pose=(-1.7749620043564578, -0.5808226528612557, 2.121946299183504)): shape (37, 800, 800)
      Valid pixels: 92850/640000 (14.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=13, max=277453, num_faces=277454
      Valid probs shape: (37, 92850)
    ✓ Random_12 (pose=(-1.6917333425888323, -0.38491213071946895, 2.2620131663834826)): shape (37, 800, 800)
      Valid pixels: 103156/640000 (16.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=14, max=277453, num_faces=277454
      Valid probs shape: (37, 103156)
    ✓ Random_13 (pose=(1.944951940494513, -2.870866014217541, -1.8868411527679767)): shape (37, 800, 800)
      Valid pixels: 67529/640000 (10.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=277453, num_faces=277454
      Valid probs shape: (37, 67529)
    ✓ Random_14 (pose=(1.746276429193812, 1.0656802530536167, -2.442821668811525)): shape (37, 800, 800)
      Valid pixels: 86058/640000 (13.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=27, max=277447, num_faces=277454
      Valid probs shape: (37, 86058)
    P stats: min=0.0000, max=0.9999, mean=0.0213
    Non-zero vertices: 109202/138729
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 29527  1158  1057  2305     0  1689  1090  4836  5348]
  Ground Truth Stats:
    Labels shape: (138729,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/HLN-12-1/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6976
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7944
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7946

  RESULTS:
  RAW:         median(top-10)=0.8617, mean(top-10)=0.8512, median(all)=0.7723, mean(all)=0.6976
  + SMOOTHING: median(top-10)=0.9182, mean(top-10)=0.9152, median(all)=0.8683, mean(all)=0.7944 [+0.0564]
  + MRF:       median(top-10)=0.9185, mean(top-10)=0.9154, median(all)=0.8685, mean(all)=0.7946 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0568

================================================================================
Subject: HLN-12-10
================================================================================
  Step 0: Generating predictions with V2 model (15 random views)...
  Mesh: 134639 vertices, 269274 faces
  Generating 15 random views...
  Generating predictions for 15 views (continuous camera pose)...
    ✓ Random_0 (pose=(-1.0365442818461639, 0.7925961765960565, -2.0386649929347644)): shape (37, 800, 800)
      Valid pixels: 79554/640000 (12.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=268823, num_faces=269274
      Valid probs shape: (37, 79554)
    ✓ Random_1 (pose=(-1.1238345713250406, -0.7222812608277303, 2.8655307633882776)): shape (37, 800, 800)
      Valid pixels: 97661/640000 (15.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=269268, num_faces=269274
      Valid probs shape: (37, 97661)
    ✓ Random_2 (pose=(-2.6512899091343676, 2.1949289803279184, 0.8237266174075111)): shape (37, 800, 800)
      Valid pixels: 65219/640000 (10.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=5, max=269156, num_faces=269274
      Valid probs shape: (37, 65219)
    ✓ Random_3 (pose=(-2.8271453833415814, 2.9898717929513303, -2.6568648138439683)): shape (37, 800, 800)
      Valid pixels: 51883/640000 (8.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=268812, num_faces=269274
      Valid probs shape: (37, 51883)
    ✓ Random_4 (pose=(0.6414195335836803, 2.060896178676848, 0.3496695106740919)): shape (37, 800, 800)
      Valid pixels: 70197/640000 (11.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=118, max=269272, num_faces=269274
      Valid probs shape: (37, 70197)
    ✓ Random_5 (pose=(1.7611118602818188, -0.8243866626888092, 2.9322983205172175)): shape (37, 800, 800)
      Valid pixels: 97802/640000 (15.3%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=5, max=269267, num_faces=269274
      Valid probs shape: (37, 97802)
    ✓ Random_6 (pose=(-0.4769767314966731, -2.758764402290182, 3.1353988687431)): shape (37, 800, 800)
      Valid pixels: 65214/640000 (10.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=145, max=269273, num_faces=269274
      Valid probs shape: (37, 65214)
    ✓ Random_7 (pose=(2.4920162580448837, -0.9012286899663287, -0.3278799392185734)): shape (37, 800, 800)
      Valid pixels: 83821/640000 (13.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=85, max=269272, num_faces=269274
      Valid probs shape: (37, 83821)
    ✓ Random_8 (pose=(-0.9775058279794857, -2.5458882507968834, 1.8940962930870313)): shape (37, 800, 800)
      Valid pixels: 86420/640000 (13.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=116, max=269273, num_faces=269274
      Valid probs shape: (37, 86420)
    ✓ Random_9 (pose=(2.4799942448744146, 0.7938618476015598, 0.825834849439262)): shape (37, 800, 800)
      Valid pixels: 88067/640000 (13.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=116, max=269272, num_faces=269274
      Valid probs shape: (37, 88067)
    ✓ Random_10 (pose=(0.7596262984284867, 0.7525055873479629, 0.3840217628331972)): shape (37, 800, 800)
      Valid pixels: 68248/640000 (10.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=268821, num_faces=269274
      Valid probs shape: (37, 68248)
    ✓ Random_11 (pose=(-2.4244714527632256, 0.3425136408048064, -2.6865488500221066)): shape (37, 800, 800)
      Valid pixels: 69162/640000 (10.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=117, max=269272, num_faces=269274
      Valid probs shape: (37, 69162)
    ✓ Random_12 (pose=(-3.13653767390933, 0.11264524070106763, -1.2926486764458078)): shape (37, 800, 800)
      Valid pixels: 52740/640000 (8.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=84209, max=269273, num_faces=269274
      Valid probs shape: (37, 52740)
    ✓ Random_13 (pose=(1.40652620216862, -0.30858723457687853, -0.7929200536715104)): shape (37, 800, 800)
      Valid pixels: 93975/640000 (14.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=269155, num_faces=269274
      Valid probs shape: (37, 93975)
    ✓ Random_14 (pose=(-2.2625710740186986, 1.4004613039758205, 2.454019176108517)): shape (37, 800, 800)
      Valid pixels: 102862/640000 (16.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=86, max=269272, num_faces=269274
      Valid probs shape: (37, 102862)
    P stats: min=0.0000, max=1.0000, mean=0.0216
    Non-zero vertices: 107732/134639
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 26907   649  1063  2299     0  3102  1359  4113  4236]
  Ground Truth Stats:
    Labels shape: (134639,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/HLN-12-10/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6948
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7962
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7966

  RESULTS:
  RAW:         median(top-10)=0.8542, mean(top-10)=0.8687, median(all)=0.7536, mean(all)=0.6948
  + SMOOTHING: median(top-10)=0.9041, mean(top-10)=0.9099, median(all)=0.8529, mean(all)=0.7962 [+0.0498]
  + MRF:       median(top-10)=0.9053, mean(top-10)=0.9105, median(all)=0.8537, mean(all)=0.7966 [+0.0013]
  TOTAL IMPROVEMENT (median top-10): +0.0511

================================================================================
Subject: HLN-12-11
================================================================================
  Step 0: Generating predictions with V2 model (15 random views)...
  Mesh: 130710 vertices, 261416 faces
  Generating 15 random views...
  Generating predictions for 15 views (continuous camera pose)...
    ✓ Random_0 (pose=(2.157771695058277, 0.5290356341077267, -1.6897089272316983)): shape (37, 800, 800)
      Valid pixels: 77970/640000 (12.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=515, max=261415, num_faces=261416
      Valid probs shape: (37, 77970)
    ✓ Random_1 (pose=(1.736638142061592, 3.0896417658585484, -0.8945544289933927)): shape (37, 800, 800)
      Valid pixels: 98777/640000 (15.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=18, max=261411, num_faces=261416
      Valid probs shape: (37, 98777)
    ✓ Random_2 (pose=(-0.825582151492803, 1.487949380005885, -1.027216242611472)): shape (37, 800, 800)
      Valid pixels: 72328/640000 (11.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=35, max=260226, num_faces=261416
      Valid probs shape: (37, 72328)
    ✓ Random_3 (pose=(2.5856697146931156, 0.027812737514951724, -0.4144950804420673)): shape (37, 800, 800)
      Valid pixels: 72823/640000 (11.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=379, max=261413, num_faces=261416
      Valid probs shape: (37, 72823)
    ✓ Random_4 (pose=(-1.6995538399900847, -0.16839884695481988, 2.6520519952453885)): shape (37, 800, 800)
      Valid pixels: 109512/640000 (17.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8, max=261413, num_faces=261416
      Valid probs shape: (37, 109512)
    ✓ Random_5 (pose=(0.8678180553523127, -1.032075420176894, 0.9029296223204026)): shape (37, 800, 800)
      Valid pixels: 97400/640000 (15.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=261133, num_faces=261416
      Valid probs shape: (37, 97400)
    ✓ Random_6 (pose=(-2.0109927619315178, 1.6447318334737675, 2.8794067269905694)): shape (37, 800, 800)
      Valid pixels: 103869/640000 (16.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8, max=261179, num_faces=261416
      Valid probs shape: (37, 103869)
    ✓ Random_7 (pose=(-0.9124021031291814, -1.1770554377143594, -0.7333222389168976)): shape (37, 800, 800)
      Valid pixels: 99838/640000 (15.6%)
      Probs stats: min=0.0000, max=0.9995, mean=0.0270
      Face IDs: min=16, max=261119, num_faces=261416
      Valid probs shape: (37, 99838)
    ✓ Random_8 (pose=(1.9710551456775782, -0.9647907464763064, -2.2948570530302472)): shape (37, 800, 800)
      Valid pixels: 79649/640000 (12.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=178, max=261415, num_faces=261416
      Valid probs shape: (37, 79649)
    ✓ Random_9 (pose=(-1.8646423401275694, -2.645685390381299, -0.8664775811164231)): shape (37, 800, 800)
      Valid pixels: 91771/640000 (14.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=10, max=261108, num_faces=261416
      Valid probs shape: (37, 91771)
    ✓ Random_10 (pose=(-1.2157452368662658, -1.4520053976623266, -2.7492890491301942)): shape (37, 800, 800)
      Valid pixels: 86659/640000 (13.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8, max=261133, num_faces=261416
      Valid probs shape: (37, 86659)
    ✓ Random_11 (pose=(-2.973234560055987, 2.0077530097722383, 1.2553705729921978)): shape (37, 800, 800)
      Valid pixels: 100073/640000 (15.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=261291, num_faces=261416
      Valid probs shape: (37, 100073)
    ✓ Random_12 (pose=(2.691901511075561, -2.8085180134098993, 0.8512720991566152)): shape (37, 800, 800)
      Valid pixels: 61255/640000 (9.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=261123, num_faces=261416
      Valid probs shape: (37, 61255)
    ✓ Random_13 (pose=(0.06674256417177515, 0.0027337186132450064, 2.3657830856090847)): shape (37, 800, 800)
      Valid pixels: 55504/640000 (8.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=260363, num_faces=261416
      Valid probs shape: (37, 55504)
    ✓ Random_14 (pose=(2.945151926847691, -0.8969496914181088, -0.028023079579298393)): shape (37, 800, 800)
      Valid pixels: 69761/640000 (10.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3241, max=261128, num_faces=261416
      Valid probs shape: (37, 69761)
    P stats: min=0.0000, max=0.9999, mean=0.0231
    Non-zero vertices: 111701/130710
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 19009   871   932  2563     0  1891  1084  3822  5419]
  Ground Truth Stats:
    Labels shape: (130710,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/HLN-12-11/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7310
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=33
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8054
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=33
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8058

  RESULTS:
  RAW:         median(top-10)=0.8868, mean(top-10)=0.8832, median(all)=0.7982, mean(all)=0.7310
  + SMOOTHING: median(top-10)=0.9226, mean(top-10)=0.9253, median(all)=0.8672, mean(all)=0.8054 [+0.0358]
  + MRF:       median(top-10)=0.9226, mean(top-10)=0.9255, median(all)=0.8678, mean(all)=0.8058 [-0.0000]
  TOTAL IMPROVEMENT (median top-10): +0.0358

================================================================================
Subject: HLN-12-12
================================================================================
  Step 0: Generating predictions with V2 model (15 random views)...
  Mesh: 148128 vertices, 296252 faces
  Generating 15 random views...
  Generating predictions for 15 views (continuous camera pose)...
    ✓ Random_0 (pose=(-2.3855132438910447, 2.755573497723441, -2.1740177041775177)): shape (37, 800, 800)
      Valid pixels: 48902/640000 (7.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=295944, num_faces=296252
      Valid probs shape: (37, 48902)
    ✓ Random_1 (pose=(-1.2932200015223034, -2.834314064013789, 1.439569646849626)): shape (37, 800, 800)
      Valid pixels: 57741/640000 (9.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=90, max=296198, num_faces=296252
      Valid probs shape: (37, 57741)
    ✓ Random_2 (pose=(-2.2077411196547994, -2.4063719693096934, 0.5655013296141886)): shape (37, 800, 800)
      Valid pixels: 73548/640000 (11.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=5, max=296203, num_faces=296252
      Valid probs shape: (37, 73548)
    ✓ Random_3 (pose=(2.1879274429063953, 2.0877292076901517, -0.6520331651179094)): shape (37, 800, 800)
      Valid pixels: 68389/640000 (10.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=29, max=296202, num_faces=296252
      Valid probs shape: (37, 68389)
    ✓ Random_4 (pose=(-0.8566095142654051, 1.543615063057377, -0.9346985621618105)): shape (37, 800, 800)
      Valid pixels: 54639/640000 (8.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=14, max=295942, num_faces=296252
      Valid probs shape: (37, 54639)
    ✓ Random_5 (pose=(1.731710559226828, 0.7337283646632424, 2.422214115181352)): shape (37, 800, 800)
      Valid pixels: 82057/640000 (12.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=296210, num_faces=296252
      Valid probs shape: (37, 82057)
    ✓ Random_6 (pose=(1.355036856622836, -1.5933999613470973, -2.3646315916613143)): shape (37, 800, 800)
      Valid pixels: 71550/640000 (11.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=3, max=296203, num_faces=296252
      Valid probs shape: (37, 71550)
    ✓ Random_7 (pose=(-2.857180514808283, 2.617474001951133, -1.2104671619511143)): shape (37, 800, 800)
      Valid pixels: 58154/640000 (9.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=295714, num_faces=296252
      Valid probs shape: (37, 58154)
    ✓ Random_8 (pose=(-1.1439169686670323, -1.8217382641507944, -0.3071105923239936)): shape (37, 800, 800)
      Valid pixels: 80377/640000 (12.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=296203, num_faces=296252
      Valid probs shape: (37, 80377)
    ✓ Random_9 (pose=(0.16797145908218036, -0.014923736678766009, -2.5276313735206917)): shape (37, 800, 800)
      Valid pixels: 40386/640000 (6.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=296199, num_faces=296252
      Valid probs shape: (37, 40386)
    ✓ Random_10 (pose=(-0.5269738854563069, -2.916955579325172, -0.42322154318472105)): shape (37, 800, 800)
      Valid pixels: 61737/640000 (9.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5106, max=296251, num_faces=296252
      Valid probs shape: (37, 61737)
    ✓ Random_11 (pose=(-1.425992722918085, -0.39389576670443693, 0.11962588759744097)): shape (37, 800, 800)
      Valid pixels: 78077/640000 (12.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=296203, num_faces=296252
      Valid probs shape: (37, 78077)
    ✓ Random_12 (pose=(-2.545479105055648, -0.4442612709352103, -0.5757383122876538)): shape (37, 800, 800)
      Valid pixels: 61132/640000 (9.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=25291, max=296251, num_faces=296252
      Valid probs shape: (37, 61132)
    ✓ Random_13 (pose=(0.014517591612586145, -1.9373836933476634, 0.9419700179858346)): shape (37, 800, 800)
      Valid pixels: 82628/640000 (12.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=28, max=296204, num_faces=296252
      Valid probs shape: (37, 82628)
    ✓ Random_14 (pose=(2.2171939919199533, 1.4253963879497933, 2.8545224458463627)): shape (37, 800, 800)
      Valid pixels: 79597/640000 (12.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=36, max=296228, num_faces=296252
      Valid probs shape: (37, 79597)
    P stats: min=0.0000, max=1.0000, mean=0.0231
    Non-zero vertices: 126857/148128
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 21271  1374   698  4322     0  2015   837  5588  7122]
  Ground Truth Stats:
    Labels shape: (148128,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/HLN-12-12/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7100
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7851
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7855

  RESULTS:
  RAW:         median(top-10)=0.8729, mean(top-10)=0.8701, median(all)=0.7737, mean(all)=0.7100
  + SMOOTHING: median(top-10)=0.9016, mean(top-10)=0.9071, median(all)=0.8138, mean(all)=0.7851 [+0.0286]
  + MRF:       median(top-10)=0.9018, mean(top-10)=0.9075, median(all)=0.8144, mean(all)=0.7855 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0288

================================================================================
Subject: HLN-12-2
================================================================================
  Step 0: Generating predictions with V2 model (15 random views)...
  Mesh: 146833 vertices, 293662 faces
  Generating 15 random views...
  Generating predictions for 15 views (continuous camera pose)...
    ✓ Random_0 (pose=(1.6162870571815686, 0.7045010254939026, 0.4498365551770993)): shape (37, 800, 800)
      Valid pixels: 90955/640000 (14.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=293617, num_faces=293662
      Valid probs shape: (37, 90955)
    ✓ Random_1 (pose=(1.5649459252941949, 0.4992999227934334, -0.20626011275171097)): shape (37, 800, 800)
      Valid pixels: 106159/640000 (16.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=293617, num_faces=293662
      Valid probs shape: (37, 106159)
    ✓ Random_2 (pose=(-2.508528695351334, 2.923498503775119, -2.4857253458888966)): shape (37, 800, 800)
      Valid pixels: 63402/640000 (9.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=293611, num_faces=293662
      Valid probs shape: (37, 63402)
    ✓ Random_3 (pose=(-1.5131592966768543, -1.317527181623961, 1.2066868431981748)): shape (37, 800, 800)
      Valid pixels: 69222/640000 (10.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=76, max=293658, num_faces=293662
      Valid probs shape: (37, 69222)
    ✓ Random_4 (pose=(-0.6242205426851761, 2.8230171306148915, -1.236062914517551)): shape (37, 800, 800)
      Valid pixels: 49375/640000 (7.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1208, max=293661, num_faces=293662
      Valid probs shape: (37, 49375)
    ✓ Random_5 (pose=(-1.2488439963715672, 2.610488470081167, -0.9449510835662118)): shape (37, 800, 800)
      Valid pixels: 81141/640000 (12.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=283, max=293660, num_faces=293662
      Valid probs shape: (37, 81141)
    ✓ Random_6 (pose=(-1.2179972203078813, 0.4799468641873448, 2.979471815410564)): shape (37, 800, 800)
      Valid pixels: 99206/640000 (15.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=293617, num_faces=293662
      Valid probs shape: (37, 99206)
    ✓ Random_7 (pose=(1.2701340576912106, 2.8528589920669694, 2.366997097887162)): shape (37, 800, 800)
      Valid pixels: 94086/640000 (14.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=142, max=293661, num_faces=293662
      Valid probs shape: (37, 94086)
    ✓ Random_8 (pose=(1.5388474009651203, 1.9642984369266, 1.2393652527075378)): shape (37, 800, 800)
      Valid pixels: 67410/640000 (10.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=22, max=293650, num_faces=293662
      Valid probs shape: (37, 67410)
    ✓ Random_9 (pose=(-1.5134376051662213, 1.9265826706230698, -0.13350668250751685)): shape (37, 800, 800)
      Valid pixels: 99490/640000 (15.5%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=80, max=293660, num_faces=293662
      Valid probs shape: (37, 99490)
    ✓ Random_10 (pose=(-0.22172079202563477, -0.42911466391499786, -1.6634976079709998)): shape (37, 800, 800)
      Valid pixels: 67786/640000 (10.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=292830, num_faces=293662
      Valid probs shape: (37, 67786)
    ✓ Random_11 (pose=(-2.406978922423697, 0.8030640461370715, -2.116031542690158)): shape (37, 800, 800)
      Valid pixels: 61000/640000 (9.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=19669, max=293660, num_faces=293662
      Valid probs shape: (37, 61000)
    ✓ Random_12 (pose=(-0.6795065432910237, -2.919415595591263, -0.6528565405723747)): shape (37, 800, 800)
      Valid pixels: 77340/640000 (12.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=17313, max=293661, num_faces=293662
      Valid probs shape: (37, 77340)
    ✓ Random_13 (pose=(-2.7978600086742293, -0.4925426094348113, 0.07668470938276961)): shape (37, 800, 800)
      Valid pixels: 66227/640000 (10.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=36046, max=293661, num_faces=293662
      Valid probs shape: (37, 66227)
    ✓ Random_14 (pose=(-0.48653916010062437, 1.7714222372648791, 0.08332839138466097)): shape (37, 800, 800)
      Valid pixels: 87665/640000 (13.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=150, max=293661, num_faces=293662
      Valid probs shape: (37, 87665)
    P stats: min=0.0000, max=1.0000, mean=0.0232
    Non-zero vertices: 126014/146833
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 20819   529  1075  4230     0  1851   889  3999  4951]
  Ground Truth Stats:
    Labels shape: (146833,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/HLN-12-2/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7277
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7983
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7986

  RESULTS:
  RAW:         median(top-10)=0.8767, mean(top-10)=0.8737, median(all)=0.7888, mean(all)=0.7277
  + SMOOTHING: median(top-10)=0.9011, mean(top-10)=0.9101, median(all)=0.8484, mean(all)=0.7983 [+0.0244]
  + MRF:       median(top-10)=0.9014, mean(top-10)=0.9105, median(all)=0.8482, mean(all)=0.7986 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0247

================================================================================
Subject: HLN-12-3
================================================================================
  Step 0: Generating predictions with V2 model (15 random views)...
  Mesh: 150991 vertices, 301978 faces
  Generating 15 random views...
  Generating predictions for 15 views (continuous camera pose)...
    ✓ Random_0 (pose=(-0.35764317479393526, 0.6748416337537173, 0.5771932029872611)): shape (37, 800, 800)
      Valid pixels: 81041/640000 (12.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=301634, num_faces=301978
      Valid probs shape: (37, 81041)
    ✓ Random_1 (pose=(-0.24768811351382514, 0.8267293509858789, 2.70500781700082)): shape (37, 800, 800)
      Valid pixels: 63232/640000 (9.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=301972, num_faces=301978
      Valid probs shape: (37, 63232)
    ✓ Random_2 (pose=(-0.0064456356486415345, 0.38434261848741524, 0.6745274752001271)): shape (37, 800, 800)
      Valid pixels: 60982/640000 (9.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=298368, num_faces=301978
      Valid probs shape: (37, 60982)
    ✓ Random_3 (pose=(2.6511874221004765, -1.8945990756521471, -0.9858516136101692)): shape (37, 800, 800)
      Valid pixels: 98281/640000 (15.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=301976, num_faces=301978
      Valid probs shape: (37, 98281)
    ✓ Random_4 (pose=(-0.26026760399269167, -0.6230350633907853, 0.21518500164873977)): shape (37, 800, 800)
      Valid pixels: 61369/640000 (9.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=3, max=301788, num_faces=301978
      Valid probs shape: (37, 61369)
    ✓ Random_5 (pose=(-2.442602433830034, 1.0735370070029937, -0.298809174445577)): shape (37, 800, 800)
      Valid pixels: 82246/640000 (12.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=194, max=301977, num_faces=301978
      Valid probs shape: (37, 82246)
    ✓ Random_6 (pose=(-1.8116393128784836, 1.7337522097162896, 0.7724712540315717)): shape (37, 800, 800)
      Valid pixels: 78119/640000 (12.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=11, max=301975, num_faces=301978
      Valid probs shape: (37, 78119)
    ✓ Random_7 (pose=(0.8434714793777061, -0.555264586393664, -1.6996123186078935)): shape (37, 800, 800)
      Valid pixels: 71147/640000 (11.1%)
      Probs stats: min=0.0000, max=0.9994, mean=0.0270
      Face IDs: min=3, max=301976, num_faces=301978
      Valid probs shape: (37, 71147)
    ✓ Random_8 (pose=(2.4898389715456917, -1.3291180675155583, 2.118554078408299)): shape (37, 800, 800)
      Valid pixels: 98072/640000 (15.3%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=48, max=301972, num_faces=301978
      Valid probs shape: (37, 98072)
    ✓ Random_9 (pose=(0.07013140615779356, -1.3557778419388566, 2.648179617059193)): shape (37, 800, 800)
      Valid pixels: 74535/640000 (11.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=301976, num_faces=301978
      Valid probs shape: (37, 74535)
    ✓ Random_10 (pose=(-1.218106682393084, -1.9664244617445268, -0.8416158553459057)): shape (37, 800, 800)
      Valid pixels: 100516/640000 (15.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=0, max=301967, num_faces=301978
      Valid probs shape: (37, 100516)
    ✓ Random_11 (pose=(-0.9640555013404111, 0.14871252191810225, -0.25626272176430875)): shape (37, 800, 800)
      Valid pixels: 90361/640000 (14.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=301795, num_faces=301978
      Valid probs shape: (37, 90361)
    ✓ Random_12 (pose=(-2.5421195212521304, 2.0829414715041485, -1.3339302995749072)): shape (37, 800, 800)
      Valid pixels: 96096/640000 (15.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=301895, num_faces=301978
      Valid probs shape: (37, 96096)
    ✓ Random_13 (pose=(-2.0137884232827807, 2.0998793974529493, 2.7150218676796216)): shape (37, 800, 800)
      Valid pixels: 101691/640000 (15.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6, max=301975, num_faces=301978
      Valid probs shape: (37, 101691)
    ✓ Random_14 (pose=(-0.12944316504056008, -0.7331669503857747, 1.1064653917209144)): shape (37, 800, 800)
      Valid pixels: 75139/640000 (11.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=301959, num_faces=301978
      Valid probs shape: (37, 75139)
    P stats: min=0.0000, max=0.9999, mean=0.0218
    Non-zero vertices: 121657/150991
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 29334  1415  1200  2450     0  2026   958  3915  6810]
  Ground Truth Stats:
    Labels shape: (150991,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/HLN-12-3/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7086
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8123
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8126

  RESULTS:
  RAW:         median(top-10)=0.8395, mean(top-10)=0.8363, median(all)=0.7751, mean(all)=0.7086
  + SMOOTHING: median(top-10)=0.9101, mean(top-10)=0.9093, median(all)=0.8704, mean(all)=0.8123 [+0.0705]
  + MRF:       median(top-10)=0.9101, mean(top-10)=0.9095, median(all)=0.8701, mean(all)=0.8126 [+0.0000]
  TOTAL IMPROVEMENT (median top-10): +0.0705

================================================================================
Subject: HLN-12-4
================================================================================
  Step 0: Generating predictions with V2 model (15 random views)...
  Mesh: 137751 vertices, 275498 faces
  Generating 15 random views...
  Generating predictions for 15 views (continuous camera pose)...
    ✓ Random_0 (pose=(2.6190788484929337, 1.4655712069975078, 1.5937465137044526)): shape (37, 800, 800)
      Valid pixels: 84925/640000 (13.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=56, max=275496, num_faces=275498
      Valid probs shape: (37, 84925)
    ✓ Random_1 (pose=(1.0392941346154476, -2.817810281074872, 2.238522715722092)): shape (37, 800, 800)
      Valid pixels: 79180/640000 (12.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7275, max=275424, num_faces=275498
      Valid probs shape: (37, 79180)
    ✓ Random_2 (pose=(1.7835541021139454, -2.248297043366969, 2.5858574654723183)): shape (37, 800, 800)
      Valid pixels: 98720/640000 (15.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=10, max=275453, num_faces=275498
      Valid probs shape: (37, 98720)
    ✓ Random_3 (pose=(0.014958720347496346, 0.44563359546001413, -0.6061646146491073)): shape (37, 800, 800)
      Valid pixels: 54117/640000 (8.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=275491, num_faces=275498
      Valid probs shape: (37, 54117)
    ✓ Random_4 (pose=(1.3782679024123343, 2.307581811828313, 3.015227521859644)): shape (37, 800, 800)
      Valid pixels: 92946/640000 (14.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=275448, num_faces=275498
      Valid probs shape: (37, 92946)
    ✓ Random_5 (pose=(3.116847429462248, 1.1175454143383003, 2.8106103408012046)): shape (37, 800, 800)
      Valid pixels: 63926/640000 (10.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=112, max=275492, num_faces=275498
      Valid probs shape: (37, 63926)
    ✓ Random_6 (pose=(-0.7627206281972398, -2.235029259569709, 0.050396628805929655)): shape (37, 800, 800)
      Valid pixels: 75019/640000 (11.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1898, max=275495, num_faces=275498
      Valid probs shape: (37, 75019)
    ✓ Random_7 (pose=(-2.5196846206503123, 2.9913818418722204, -2.9552446557274106)): shape (37, 800, 800)
      Valid pixels: 66611/640000 (10.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=275496, num_faces=275498
      Valid probs shape: (37, 66611)
    ✓ Random_8 (pose=(2.2049644851998815, -0.20652682815300594, -1.8296486316043021)): shape (37, 800, 800)
      Valid pixels: 61986/640000 (9.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1353, max=275497, num_faces=275498
      Valid probs shape: (37, 61986)
    ✓ Random_9 (pose=(-0.42816882922295374, -1.4162898968555762, -2.394464012446523)): shape (37, 800, 800)
      Valid pixels: 75949/640000 (11.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=275421, num_faces=275498
      Valid probs shape: (37, 75949)
    ✓ Random_10 (pose=(-2.7405871999530134, 1.985185428941631, 0.46206974429022774)): shape (37, 800, 800)
      Valid pixels: 60787/640000 (9.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=10, max=275497, num_faces=275498
      Valid probs shape: (37, 60787)
    ✓ Random_11 (pose=(1.1348782834814228, 2.4439704789555643, 0.26648287072253574)): shape (37, 800, 800)
      Valid pixels: 82606/640000 (12.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=73, max=275497, num_faces=275498
      Valid probs shape: (37, 82606)
    ✓ Random_12 (pose=(2.696825317443227, 1.2296825162046723, 3.129471312163788)): shape (37, 800, 800)
      Valid pixels: 81489/640000 (12.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=893, max=275424, num_faces=275498
      Valid probs shape: (37, 81489)
    ✓ Random_13 (pose=(1.6514062430940788, 1.8224788024033138, -2.3735032396754887)): shape (37, 800, 800)
      Valid pixels: 77416/640000 (12.1%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=6, max=275495, num_faces=275498
      Valid probs shape: (37, 77416)
    ✓ Random_14 (pose=(-2.5778674641089747, -0.07116118542670469, 0.1788832569532759)): shape (37, 800, 800)
      Valid pixels: 69789/640000 (10.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=16110, max=275495, num_faces=275498
      Valid probs shape: (37, 69789)
    P stats: min=0.0000, max=1.0000, mean=0.0235
    Non-zero vertices: 119672/137751
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 18079  1354  1197  3910     0  2358  1082  3294  6194]
  Ground Truth Stats:
    Labels shape: (137751,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/HLN-12-4/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7180
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7911
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7915

  RESULTS:
  RAW:         median(top-10)=0.8818, mean(top-10)=0.8803, median(all)=0.7950, mean(all)=0.7180
  + SMOOTHING: median(top-10)=0.9157, mean(top-10)=0.9163, median(all)=0.8554, mean(all)=0.7911 [+0.0338]
  + MRF:       median(top-10)=0.9157, mean(top-10)=0.9166, median(all)=0.8557, mean(all)=0.7915 [-0.0000]
  TOTAL IMPROVEMENT (median top-10): +0.0338

================================================================================
Subject: HLN-12-5
================================================================================
  Step 0: Generating predictions with V2 model (15 random views)...
  Mesh: 167182 vertices, 334360 faces
  Generating 15 random views...
  Generating predictions for 15 views (continuous camera pose)...
    ✓ Random_0 (pose=(-1.020608057210921, 2.2690854728683467, 0.7414768365352602)): shape (37, 800, 800)
      Valid pixels: 100311/640000 (15.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=522, max=334359, num_faces=334360
      Valid probs shape: (37, 100311)
    ✓ Random_1 (pose=(0.6384068833812178, 2.4723774497505557, -2.42559833315588)): shape (37, 800, 800)
      Valid pixels: 80494/640000 (12.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=4325, max=334356, num_faces=334360
      Valid probs shape: (37, 80494)
    ✓ Random_2 (pose=(-0.21935147323186976, -2.175872913460385, -0.8096463058961785)): shape (37, 800, 800)
      Valid pixels: 94309/640000 (14.7%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=1638, max=334358, num_faces=334360
      Valid probs shape: (37, 94309)
    ✓ Random_3 (pose=(-2.2912282956112366, -1.3972591279731352, -1.1249426323825662)): shape (37, 800, 800)
      Valid pixels: 81457/640000 (12.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8, max=333738, num_faces=334360
      Valid probs shape: (37, 81457)
    ✓ Random_4 (pose=(-2.5320642759267162, -0.6693394581476286, -2.527193547417033)): shape (37, 800, 800)
      Valid pixels: 100410/640000 (15.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=82, max=334357, num_faces=334360
      Valid probs shape: (37, 100410)
    ✓ Random_5 (pose=(2.0101514799864217, 0.33039981441098965, 1.1859871963184547)): shape (37, 800, 800)
      Valid pixels: 84238/640000 (13.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=82, max=333738, num_faces=334360
      Valid probs shape: (37, 84238)
    ✓ Random_6 (pose=(-3.125972323457585, 1.8079663251771914, 1.8373749256552259)): shape (37, 800, 800)
      Valid pixels: 108822/640000 (17.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=334330, num_faces=334360
      Valid probs shape: (37, 108822)
    ✓ Random_7 (pose=(-1.9668216664844915, 1.5439334856180196, -2.387097189402111)): shape (37, 800, 800)
      Valid pixels: 85496/640000 (13.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=333738, num_faces=334360
      Valid probs shape: (37, 85496)
    ✓ Random_8 (pose=(-0.8146755893909399, -0.0063311539841675035, -1.6084845859389654)): shape (37, 800, 800)
      Valid pixels: 72433/640000 (11.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=333141, num_faces=334360
      Valid probs shape: (37, 72433)
    ✓ Random_9 (pose=(1.9848553170884928, 2.458981208533782, -2.0168473654026093)): shape (37, 800, 800)
      Valid pixels: 85281/640000 (13.3%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=16, max=334356, num_faces=334360
      Valid probs shape: (37, 85281)
    ✓ Random_10 (pose=(3.1249903063131033, -2.4183516049554923, -0.33273926875278903)): shape (37, 800, 800)
      Valid pixels: 74939/640000 (11.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=333737, num_faces=334360
      Valid probs shape: (37, 74939)
    ✓ Random_11 (pose=(-0.6822483935904033, 2.8390401886045096, -2.518337725329548)): shape (37, 800, 800)
      Valid pixels: 84483/640000 (13.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=85, max=334359, num_faces=334360
      Valid probs shape: (37, 84483)
    ✓ Random_12 (pose=(2.494688222871317, -1.9717068150343393, -1.1757057832037885)): shape (37, 800, 800)
      Valid pixels: 116107/640000 (18.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8, max=334330, num_faces=334360
      Valid probs shape: (37, 116107)
    ✓ Random_13 (pose=(-2.5385671573115127, 0.7261280181945833, 2.700021407030749)): shape (37, 800, 800)
      Valid pixels: 90618/640000 (14.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=31, max=334355, num_faces=334360
      Valid probs shape: (37, 90618)
    ✓ Random_14 (pose=(-2.8457301684221123, 0.24028383316843094, -1.0741196568874751)): shape (37, 800, 800)
      Valid pixels: 80474/640000 (12.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=57303, max=334358, num_faces=334360
      Valid probs shape: (37, 80474)
    P stats: min=0.0000, max=0.9999, mean=0.0213
    Non-zero vertices: 131799/167182
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 35383   713  1605  2789     0  2549  1284  5253  6318]
  Ground Truth Stats:
    Labels shape: (167182,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/HLN-12-5/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6861
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7838
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7842

  RESULTS:
  RAW:         median(top-10)=0.8362, mean(top-10)=0.8438, median(all)=0.7245, mean(all)=0.6861
  + SMOOTHING: median(top-10)=0.9005, mean(top-10)=0.9049, median(all)=0.8532, mean(all)=0.7838 [+0.0644]
  + MRF:       median(top-10)=0.9010, mean(top-10)=0.9051, median(all)=0.8538, mean(all)=0.7842 [+0.0004]
  TOTAL IMPROVEMENT (median top-10): +0.0648

================================================================================
Subject: HLN-12-6
================================================================================
  Step 0: Generating predictions with V2 model (15 random views)...
  Mesh: 149409 vertices, 298814 faces
  Generating 15 random views...
  Generating predictions for 15 views (continuous camera pose)...
    ✓ Random_0 (pose=(-1.506717064119945, 2.305660115048372, 0.5523882586822402)): shape (37, 800, 800)
      Valid pixels: 82835/640000 (12.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=298813, num_faces=298814
      Valid probs shape: (37, 82835)
    ✓ Random_1 (pose=(-2.0690784414864742, 1.5334691682853698, 0.8003102895813958)): shape (37, 800, 800)
      Valid pixels: 68479/640000 (10.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=195, max=298813, num_faces=298814
      Valid probs shape: (37, 68479)
    ✓ Random_2 (pose=(-1.8593992581390943, 2.295367235057401, 1.873368448970405)): shape (37, 800, 800)
      Valid pixels: 88737/640000 (13.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=298812, num_faces=298814
      Valid probs shape: (37, 88737)
    ✓ Random_3 (pose=(-0.6981844388821505, 2.649709165550168, -2.5022543798176837)): shape (37, 800, 800)
      Valid pixels: 81989/640000 (12.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=8, max=298813, num_faces=298814
      Valid probs shape: (37, 81989)
    ✓ Random_4 (pose=(1.6592310766511584, 1.3230719384072742, -2.4120548202192484)): shape (37, 800, 800)
      Valid pixels: 79434/640000 (12.4%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=8, max=298812, num_faces=298814
      Valid probs shape: (37, 79434)
    ✓ Random_5 (pose=(-0.7037833818930364, -1.8964834242006638, -1.826997206893267)): shape (37, 800, 800)
      Valid pixels: 90397/640000 (14.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=168, max=298813, num_faces=298814
      Valid probs shape: (37, 90397)
    ✓ Random_6 (pose=(-1.9385667041992238, -2.8577347270296123, -0.3129636657543977)): shape (37, 800, 800)
      Valid pixels: 100330/640000 (15.7%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=11, max=298798, num_faces=298814
      Valid probs shape: (37, 100330)
    ✓ Random_7 (pose=(2.678214703094282, -2.424705876576995, -0.6712620996905065)): shape (37, 800, 800)
      Valid pixels: 78418/640000 (12.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=298709, num_faces=298814
      Valid probs shape: (37, 78418)
    ✓ Random_8 (pose=(-1.043083537735399, 1.9445619312210383, -0.7369864207384045)): shape (37, 800, 800)
      Valid pixels: 80229/640000 (12.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=238, max=298812, num_faces=298814
      Valid probs shape: (37, 80229)
    ✓ Random_9 (pose=(2.191655516689888, 1.618648726028315, -2.9753208509256286)): shape (37, 800, 800)
      Valid pixels: 103713/640000 (16.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=11, max=298813, num_faces=298814
      Valid probs shape: (37, 103713)
    ✓ Random_10 (pose=(-0.9917274470068107, -0.6089014014716732, 1.2665245700626535)): shape (37, 800, 800)
      Valid pixels: 61332/640000 (9.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=12, max=298671, num_faces=298814
      Valid probs shape: (37, 61332)
    ✓ Random_11 (pose=(-2.9395840560979183, 0.4107793064567562, -0.6716264850890763)): shape (37, 800, 800)
      Valid pixels: 64361/640000 (10.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6644, max=298812, num_faces=298814
      Valid probs shape: (37, 64361)
    ✓ Random_12 (pose=(1.1147888938872361, 1.3828702587985102, -1.8544042016213476)): shape (37, 800, 800)
      Valid pixels: 71131/640000 (11.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=26, max=298813, num_faces=298814
      Valid probs shape: (37, 71131)
    ✓ Random_13 (pose=(1.3616514511861473, -0.03445560914166901, -2.4371371645524977)): shape (37, 800, 800)
      Valid pixels: 78057/640000 (12.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=298813, num_faces=298814
      Valid probs shape: (37, 78057)
    ✓ Random_14 (pose=(3.084237246517361, -0.7910533139259552, 2.4455859061844043)): shape (37, 800, 800)
      Valid pixels: 68248/640000 (10.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1747, max=298812, num_faces=298814
      Valid probs shape: (37, 68248)
    P stats: min=0.0000, max=0.9999, mean=0.0219
    Non-zero vertices: 121337/149409
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 28072  1056   923  3571     0  1528   903  5473  5610]
  Ground Truth Stats:
    Labels shape: (149409,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/HLN-12-6/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7045
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7928
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7932

  RESULTS:
  RAW:         median(top-10)=0.8432, mean(top-10)=0.8498, median(all)=0.7488, mean(all)=0.7045
  + SMOOTHING: median(top-10)=0.9148, mean(top-10)=0.9142, median(all)=0.8264, mean(all)=0.7928 [+0.0716]
  + MRF:       median(top-10)=0.9152, mean(top-10)=0.9145, median(all)=0.8265, mean(all)=0.7932 [+0.0005]
  TOTAL IMPROVEMENT (median top-10): +0.0720

================================================================================
Subject: HLN-12-7
================================================================================
  Step 0: Generating predictions with V2 model (15 random views)...
  Mesh: 122042 vertices, 244080 faces
  Generating 15 random views...
  Generating predictions for 15 views (continuous camera pose)...
    ✓ Random_0 (pose=(-2.99551570879446, 2.069176293431406, 1.02318539962815)): shape (37, 800, 800)
      Valid pixels: 85549/640000 (13.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=244000, num_faces=244080
      Valid probs shape: (37, 85549)
    ✓ Random_1 (pose=(-0.6929910087992797, 1.8332139872026296, -0.26420770308727937)): shape (37, 800, 800)
      Valid pixels: 83362/640000 (13.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=10, max=244076, num_faces=244080
      Valid probs shape: (37, 83362)
    ✓ Random_2 (pose=(-1.205460560856252, -0.39218074009419013, -2.6020610997119453)): shape (37, 800, 800)
      Valid pixels: 79044/640000 (12.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=243897, num_faces=244080
      Valid probs shape: (37, 79044)
    ✓ Random_3 (pose=(-0.058770940691549534, -0.7306911634696753, 2.2423900085943824)): shape (37, 800, 800)
      Valid pixels: 68283/640000 (10.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=243897, num_faces=244080
      Valid probs shape: (37, 68283)
    ✓ Random_4 (pose=(-1.8355610822616473, 0.5250016012049583, -1.9757024998070192)): shape (37, 800, 800)
      Valid pixels: 70657/640000 (11.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=15, max=244079, num_faces=244080
      Valid probs shape: (37, 70657)
    ✓ Random_5 (pose=(-1.9271870957392971, 0.3017572247883824, 3.0952137788886684)): shape (37, 800, 800)
      Valid pixels: 92976/640000 (14.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=243989, num_faces=244080
      Valid probs shape: (37, 92976)
    ✓ Random_6 (pose=(1.4670191285387393, -1.225242879068514, -1.9156067133008725)): shape (37, 800, 800)
      Valid pixels: 75205/640000 (11.8%)
      Probs stats: min=0.0000, max=0.9995, mean=0.0270
      Face IDs: min=11, max=244078, num_faces=244080
      Valid probs shape: (37, 75205)
    ✓ Random_7 (pose=(0.033236234782850094, -1.5447887100758761, -1.795774826246134)): shape (37, 800, 800)
      Valid pixels: 93578/640000 (14.6%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=9, max=244047, num_faces=244080
      Valid probs shape: (37, 93578)
    ✓ Random_8 (pose=(-0.1360936671500408, 0.6006792682484479, -2.967401467758815)): shape (37, 800, 800)
      Valid pixels: 61176/640000 (9.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=243995, num_faces=244080
      Valid probs shape: (37, 61176)
    ✓ Random_9 (pose=(2.7136922124861638, -1.77389622035452, -2.9771174217474843)): shape (37, 800, 800)
      Valid pixels: 72076/640000 (11.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=7, max=244078, num_faces=244080
      Valid probs shape: (37, 72076)
    ✓ Random_10 (pose=(1.6679987679792267, -0.8166203517857626, -0.2440155700589015)): shape (37, 800, 800)
      Valid pixels: 100846/640000 (15.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=13, max=244000, num_faces=244080
      Valid probs shape: (37, 100846)
    ✓ Random_11 (pose=(-2.2039051312289626, 0.7709467907044232, -0.7384593118618761)): shape (37, 800, 800)
      Valid pixels: 89164/640000 (13.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=621, max=244079, num_faces=244080
      Valid probs shape: (37, 89164)
    ✓ Random_12 (pose=(3.0416719485831933, 1.0470689661660586, 2.4594905794043047)): shape (37, 800, 800)
      Valid pixels: 72404/640000 (11.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=7, max=244076, num_faces=244080
      Valid probs shape: (37, 72404)
    ✓ Random_13 (pose=(-0.8106386017184746, 1.0952256842704315, 2.055887049720728)): shape (37, 800, 800)
      Valid pixels: 69561/640000 (10.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=6, max=244079, num_faces=244080
      Valid probs shape: (37, 69561)
    ✓ Random_14 (pose=(-2.1868402259223227, -1.624967877545169, -2.8140918026853)): shape (37, 800, 800)
      Valid pixels: 101602/640000 (15.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=10, max=244000, num_faces=244080
      Valid probs shape: (37, 101602)
    P stats: min=0.0000, max=0.9999, mean=0.0228
    Non-zero vertices: 103060/122042
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 18982   520  1081  3008     0  1845   925  3730  3698]
  Ground Truth Stats:
    Labels shape: (122042,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/HLN-12-7/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7277
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8129
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8133

  RESULTS:
  RAW:         median(top-10)=0.8574, mean(top-10)=0.8664, median(all)=0.7699, mean(all)=0.7277
  + SMOOTHING: median(top-10)=0.9081, mean(top-10)=0.9121, median(all)=0.8608, mean(all)=0.8129 [+0.0507]
  + MRF:       median(top-10)=0.9085, mean(top-10)=0.9124, median(all)=0.8613, mean(all)=0.8133 [+0.0004]
  TOTAL IMPROVEMENT (median top-10): +0.0510

================================================================================
Subject: HLN-12-8
================================================================================
  Step 0: Generating predictions with V2 model (15 random views)...
  Mesh: 163705 vertices, 327406 faces
  Generating 15 random views...
  Generating predictions for 15 views (continuous camera pose)...
    ✓ Random_0 (pose=(-2.052943736809123, 2.1078862648982852, -2.5834835670047123)): shape (37, 800, 800)
      Valid pixels: 70531/640000 (11.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=12, max=327000, num_faces=327406
      Valid probs shape: (37, 70531)
    ✓ Random_1 (pose=(2.7766728457559573, -1.7608508582978981, 2.4866413744650515)): shape (37, 800, 800)
      Valid pixels: 76488/640000 (12.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=14, max=327402, num_faces=327406
      Valid probs shape: (37, 76488)
    ✓ Random_2 (pose=(2.409530857442755, 2.723233443702748, -1.1027019890515906)): shape (37, 800, 800)
      Valid pixels: 53532/640000 (8.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=327191, num_faces=327406
      Valid probs shape: (37, 53532)
    ✓ Random_3 (pose=(-2.8205746890948733, -0.9726035535231681, -2.2010051537043225)): shape (37, 800, 800)
      Valid pixels: 88492/640000 (13.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=327365, num_faces=327406
      Valid probs shape: (37, 88492)
    ✓ Random_4 (pose=(-2.0315570157815515, 0.41795436265630803, -0.31806648010701677)): shape (37, 800, 800)
      Valid pixels: 93124/640000 (14.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=619, max=327404, num_faces=327406
      Valid probs shape: (37, 93124)
    ✓ Random_5 (pose=(-2.36852762859504, 2.5880487175009517, 2.997180687297181)): shape (37, 800, 800)
      Valid pixels: 77939/640000 (12.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=326868, num_faces=327406
      Valid probs shape: (37, 77939)
    ✓ Random_6 (pose=(-2.9163771723406264, -0.6738860962375228, 2.8311066033517234)): shape (37, 800, 800)
      Valid pixels: 55069/640000 (8.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=856, max=327396, num_faces=327406
      Valid probs shape: (37, 55069)
    ✓ Random_7 (pose=(-2.2113544001743515, 1.0112293250252797, -2.0341777166935064)): shape (37, 800, 800)
      Valid pixels: 64509/640000 (10.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=619, max=327404, num_faces=327406
      Valid probs shape: (37, 64509)
    ✓ Random_8 (pose=(-0.49493335610329847, 1.2261742176401569, -2.7187272874677664)): shape (37, 800, 800)
      Valid pixels: 95327/640000 (14.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=327191, num_faces=327406
      Valid probs shape: (37, 95327)
    ✓ Random_9 (pose=(0.3520192561727469, 1.794623930088287, 2.648101493325604)): shape (37, 800, 800)
      Valid pixels: 75890/640000 (11.9%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=14, max=327404, num_faces=327406
      Valid probs shape: (37, 75890)
    ✓ Random_10 (pose=(-0.8573165768523876, -1.09189585284326, 1.8161654972038646)): shape (37, 800, 800)
      Valid pixels: 94109/640000 (14.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=16, max=327191, num_faces=327406
      Valid probs shape: (37, 94109)
    ✓ Random_11 (pose=(0.810553913533715, 2.4141213479291697, -2.3341628515825232)): shape (37, 800, 800)
      Valid pixels: 64750/640000 (10.1%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=784, max=327404, num_faces=327406
      Valid probs shape: (37, 64750)
    ✓ Random_12 (pose=(-0.28811914927420057, -2.883126396211561, -1.8381670440008449)): shape (37, 800, 800)
      Valid pixels: 55423/640000 (8.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=49262, max=327405, num_faces=327406
      Valid probs shape: (37, 55423)
    ✓ Random_13 (pose=(-2.0017555326037995, 2.7422496194841033, -0.6878967370446905)): shape (37, 800, 800)
      Valid pixels: 90125/640000 (14.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=11, max=327393, num_faces=327406
      Valid probs shape: (37, 90125)
    ✓ Random_14 (pose=(-2.1245007704990932, -1.8469589661472159, 0.9477175144958068)): shape (37, 800, 800)
      Valid pixels: 80474/640000 (12.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=15, max=327402, num_faces=327406
      Valid probs shape: (37, 80474)
    P stats: min=0.0000, max=0.9999, mean=0.0236
    Non-zero vertices: 142742/163705
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 20963  1005  1431  3661     0  2255  1323  5443  5902]
  Ground Truth Stats:
    Labels shape: (163705,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/HLN-12-8/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7399
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8136
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8140

  RESULTS:
  RAW:         median(top-10)=0.8534, mean(top-10)=0.8675, median(all)=0.7792, mean(all)=0.7399
  + SMOOTHING: median(top-10)=0.9070, mean(top-10)=0.9078, median(all)=0.8465, mean(all)=0.8136 [+0.0537]
  + MRF:       median(top-10)=0.9074, mean(top-10)=0.9081, median(all)=0.8486, mean(all)=0.8140 [+0.0004]
  TOTAL IMPROVEMENT (median top-10): +0.0541

================================================================================
Subject: HLN-12-9
================================================================================
  Step 0: Generating predictions with V2 model (15 random views)...
  Mesh: 137393 vertices, 274782 faces
  Generating 15 random views...
  Generating predictions for 15 views (continuous camera pose)...
    ✓ Random_0 (pose=(0.9572643695795762, -0.4710273656089905, 0.9976912953616752)): shape (37, 800, 800)
      Valid pixels: 76711/640000 (12.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=274781, num_faces=274782
      Valid probs shape: (37, 76711)
    ✓ Random_1 (pose=(-0.14876604968266482, -2.3881060265086016, -2.2700657471008454)): shape (37, 800, 800)
      Valid pixels: 80461/640000 (12.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=22731, max=274780, num_faces=274782
      Valid probs shape: (37, 80461)
    ✓ Random_2 (pose=(3.0657235679009167, 0.44502378681559396, 1.5322108198128062)): shape (37, 800, 800)
      Valid pixels: 60089/640000 (9.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=482, max=274781, num_faces=274782
      Valid probs shape: (37, 60089)
    ✓ Random_3 (pose=(2.371025008014225, -0.5144725014160234, -2.9574774822654573)): shape (37, 800, 800)
      Valid pixels: 76988/640000 (12.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2627, max=274781, num_faces=274782
      Valid probs shape: (37, 76988)
    ✓ Random_4 (pose=(-2.0312356575196278, 2.7399500125038907, -1.817961029089066)): shape (37, 800, 800)
      Valid pixels: 65774/640000 (10.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=274759, num_faces=274782
      Valid probs shape: (37, 65774)
    ✓ Random_5 (pose=(0.6404426213234404, 0.3226036520339619, 0.9368950788530013)): shape (37, 800, 800)
      Valid pixels: 60282/640000 (9.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=274775, num_faces=274782
      Valid probs shape: (37, 60282)
    ✓ Random_6 (pose=(-3.0647940516375805, 3.136391307950001, 0.11808766746048471)): shape (37, 800, 800)
      Valid pixels: 48778/640000 (7.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=274138, num_faces=274782
      Valid probs shape: (37, 48778)
    ✓ Random_7 (pose=(1.7692326507193652, -2.1766439768813166, -1.035398958635561)): shape (37, 800, 800)
      Valid pixels: 100094/640000 (15.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=29, max=274777, num_faces=274782
      Valid probs shape: (37, 100094)
    ✓ Random_8 (pose=(1.2711882792612164, 0.11944971470213028, 0.8182543730562499)): shape (37, 800, 800)
      Valid pixels: 77189/640000 (12.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=274781, num_faces=274782
      Valid probs shape: (37, 77189)
    ✓ Random_9 (pose=(2.1762243057054755, -2.516177499002983, 2.9776458248043314)): shape (37, 800, 800)
      Valid pixels: 82874/640000 (12.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=0, max=274780, num_faces=274782
      Valid probs shape: (37, 82874)
    ✓ Random_10 (pose=(-3.0651335615004434, -2.2373937235445465, -0.09083539445518296)): shape (37, 800, 800)
      Valid pixels: 64263/640000 (10.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=274759, num_faces=274782
      Valid probs shape: (37, 64263)
    ✓ Random_11 (pose=(2.709134328273101, -0.434160989952324, 2.1278744691438103)): shape (37, 800, 800)
      Valid pixels: 79469/640000 (12.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=17983, max=274781, num_faces=274782
      Valid probs shape: (37, 79469)
    ✓ Random_12 (pose=(-2.3223335807777095, 2.1749250780015377, 2.334553912334342)): shape (37, 800, 800)
      Valid pixels: 100132/640000 (15.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=10, max=274781, num_faces=274782
      Valid probs shape: (37, 100132)
    ✓ Random_13 (pose=(-0.9336390479831094, 2.5528241858331793, 1.762464610860409)): shape (37, 800, 800)
      Valid pixels: 71493/640000 (11.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=307, max=274780, num_faces=274782
      Valid probs shape: (37, 71493)
    ✓ Random_14 (pose=(-1.0734851908364669, 2.7396736137438076, 1.0729758425374545)): shape (37, 800, 800)
      Valid pixels: 76706/640000 (12.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=602, max=274778, num_faces=274782
      Valid probs shape: (37, 76706)
    P stats: min=0.0000, max=1.0000, mean=0.0234
    Non-zero vertices: 118899/137393
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 18494  1116  1080  2819     0  2515   908  4615  5708]
  Ground Truth Stats:
    Labels shape: (137393,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/HLN-12-9/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7294
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=33
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7972
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=33
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7974

  RESULTS:
  RAW:         median(top-10)=0.8750, mean(top-10)=0.8775, median(all)=0.8205, mean(all)=0.7294
  + SMOOTHING: median(top-10)=0.9260, mean(top-10)=0.9238, median(all)=0.8727, mean(all)=0.7972 [+0.0510]
  + MRF:       median(top-10)=0.9263, mean(top-10)=0.9241, median(all)=0.8734, mean(all)=0.7974 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0513

================================================================================
Subject: MMRR-21-1
================================================================================
  Step 0: Generating predictions with V2 model (15 random views)...
  Mesh: 130631 vertices, 261258 faces
  Generating 15 random views...
  Generating predictions for 15 views (continuous camera pose)...
    ✓ Random_0 (pose=(-3.013719820301071, 2.7629082680049324, -3.079954353509238)): shape (37, 800, 800)
      Valid pixels: 47173/640000 (7.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=260712, num_faces=261258
      Valid probs shape: (37, 47173)
    ✓ Random_1 (pose=(2.4436754069639113, 1.079998194454344, 0.8746162473148873)): shape (37, 800, 800)
      Valid pixels: 94041/640000 (14.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=261247, num_faces=261258
      Valid probs shape: (37, 94041)
    ✓ Random_2 (pose=(-0.9321392867246634, 1.3094349855602792, -1.6854114991899785)): shape (37, 800, 800)
      Valid pixels: 72750/640000 (11.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=261192, num_faces=261258
      Valid probs shape: (37, 72750)
    ✓ Random_3 (pose=(1.8999184577477282, -0.3672971923515118, -2.933139964845832)): shape (37, 800, 800)
      Valid pixels: 84143/640000 (13.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=177, max=261257, num_faces=261258
      Valid probs shape: (37, 84143)
    ✓ Random_4 (pose=(-0.5333802501249694, 0.3707836167514911, -1.0511754737210768)): shape (37, 800, 800)
      Valid pixels: 50399/640000 (7.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=260588, num_faces=261258
      Valid probs shape: (37, 50399)
    ✓ Random_5 (pose=(0.7307868395998427, -0.46412200197966014, -2.79315580603417)): shape (37, 800, 800)
      Valid pixels: 79106/640000 (12.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=261257, num_faces=261258
      Valid probs shape: (37, 79106)
    ✓ Random_6 (pose=(-1.4206829700725654, -1.7054972253627516, -2.48016660664735)): shape (37, 800, 800)
      Valid pixels: 73871/640000 (11.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=261183, num_faces=261258
      Valid probs shape: (37, 73871)
    ✓ Random_7 (pose=(-1.7323491018358808, 1.6346840490191568, 0.41851868116798663)): shape (37, 800, 800)
      Valid pixels: 76769/640000 (12.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=110, max=261257, num_faces=261258
      Valid probs shape: (37, 76769)
    ✓ Random_8 (pose=(3.0015286287646417, 0.9577718525585741, 2.3450054695526052)): shape (37, 800, 800)
      Valid pixels: 63004/640000 (9.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=319, max=261254, num_faces=261258
      Valid probs shape: (37, 63004)
    ✓ Random_9 (pose=(-2.2342610981404083, -2.9703353862729975, 1.2262651402211162)): shape (37, 800, 800)
      Valid pixels: 56717/640000 (8.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=261246, num_faces=261258
      Valid probs shape: (37, 56717)
    ✓ Random_10 (pose=(3.131120221981468, -1.3112904541929116, 0.029796174762604988)): shape (37, 800, 800)
      Valid pixels: 56598/640000 (8.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=9, max=261254, num_faces=261258
      Valid probs shape: (37, 56598)
    ✓ Random_11 (pose=(1.5599002141930196, -1.1831758969653536, -0.6457366857942142)): shape (37, 800, 800)
      Valid pixels: 97547/640000 (15.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=261192, num_faces=261258
      Valid probs shape: (37, 97547)
    ✓ Random_12 (pose=(-0.2695523132878086, -0.2091007960601181, 2.2723044172511884)): shape (37, 800, 800)
      Valid pixels: 50642/640000 (7.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=261168, num_faces=261258
      Valid probs shape: (37, 50642)
    ✓ Random_13 (pose=(0.5205043698899878, -1.6458072717513157, -2.448790917894784)): shape (37, 800, 800)
      Valid pixels: 97056/640000 (15.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=9, max=261257, num_faces=261258
      Valid probs shape: (37, 97056)
    ✓ Random_14 (pose=(-2.3291692075002075, -1.418714216124163, -1.6902127817074566)): shape (37, 800, 800)
      Valid pixels: 76855/640000 (12.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=261196, num_faces=261258
      Valid probs shape: (37, 76855)
    P stats: min=0.0000, max=0.9999, mean=0.0233
    Non-zero vertices: 112852/130631
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 17779  1158  1035  2905     0  1500   903  4383  5826]
  Ground Truth Stats:
    Labels shape: (130631,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-1/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7619
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8409
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8413

  RESULTS:
  RAW:         median(top-10)=0.8704, mean(top-10)=0.8835, median(all)=0.8176, mean(all)=0.7619
  + SMOOTHING: median(top-10)=0.9201, mean(top-10)=0.9291, median(all)=0.8840, mean(all)=0.8409 [+0.0497]
  + MRF:       median(top-10)=0.9207, mean(top-10)=0.9294, median(all)=0.8837, mean(all)=0.8413 [+0.0007]
  TOTAL IMPROVEMENT (median top-10): +0.0504

================================================================================
Subject: MMRR-21-10
================================================================================
  Step 0: Generating predictions with V2 model (15 random views)...
  Mesh: 148162 vertices, 296320 faces
  Generating 15 random views...
  Generating predictions for 15 views (continuous camera pose)...
    ✓ Random_0 (pose=(0.6874814022539302, 0.5256350994580363, 2.7787055875133957)): shape (37, 800, 800)
      Valid pixels: 71963/640000 (11.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=296217, num_faces=296320
      Valid probs shape: (37, 71963)
    ✓ Random_1 (pose=(0.956333533924763, 1.0847767550351541, -1.5412504240712304)): shape (37, 800, 800)
      Valid pixels: 81956/640000 (12.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=296095, num_faces=296320
      Valid probs shape: (37, 81956)
    ✓ Random_2 (pose=(-2.254810371224475, 0.4287704637016958, 1.5005356472401559)): shape (37, 800, 800)
      Valid pixels: 64225/640000 (10.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=29, max=296319, num_faces=296320
      Valid probs shape: (37, 64225)
    ✓ Random_3 (pose=(-2.481355444779693, 0.7285574316716015, 2.16920409380005)): shape (37, 800, 800)
      Valid pixels: 85357/640000 (13.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=77, max=296319, num_faces=296320
      Valid probs shape: (37, 85357)
    ✓ Random_4 (pose=(2.4991202969524693, 2.6896135166331057, -2.7667717517353045)): shape (37, 800, 800)
      Valid pixels: 74305/640000 (11.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=296257, num_faces=296320
      Valid probs shape: (37, 74305)
    ✓ Random_5 (pose=(3.0196327619453376, -2.651099506063882, -2.050863111991495)): shape (37, 800, 800)
      Valid pixels: 57892/640000 (9.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=296092, num_faces=296320
      Valid probs shape: (37, 57892)
    ✓ Random_6 (pose=(2.280585762443982, -3.128730553091972, -3.1244504862943145)): shape (37, 800, 800)
      Valid pixels: 75852/640000 (11.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=296217, num_faces=296320
      Valid probs shape: (37, 75852)
    ✓ Random_7 (pose=(2.83375186823098, 3.090071695111905, 2.302025774193366)): shape (37, 800, 800)
      Valid pixels: 50369/640000 (7.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=293564, num_faces=296320
      Valid probs shape: (37, 50369)
    ✓ Random_8 (pose=(-1.6952897664963595, -0.9184228560492733, 1.2644798530419123)): shape (37, 800, 800)
      Valid pixels: 70370/640000 (11.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=7, max=296250, num_faces=296320
      Valid probs shape: (37, 70370)
    ✓ Random_9 (pose=(-2.0567821881586967, 3.0322685694786724, -2.772388547645576)): shape (37, 800, 800)
      Valid pixels: 80745/640000 (12.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=296093, num_faces=296320
      Valid probs shape: (37, 80745)
    ✓ Random_10 (pose=(0.20537690973080736, 0.7222682403653051, 1.5683182800168094)): shape (37, 800, 800)
      Valid pixels: 74249/640000 (11.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=296257, num_faces=296320
      Valid probs shape: (37, 74249)
    ✓ Random_11 (pose=(1.5898595924511216, -1.7543408891465686, -1.3502702607882457)): shape (37, 800, 800)
      Valid pixels: 68262/640000 (10.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=11, max=296094, num_faces=296320
      Valid probs shape: (37, 68262)
    ✓ Random_12 (pose=(0.6704915590384517, -2.296869541032196, 3.0732002315743507)): shape (37, 800, 800)
      Valid pixels: 82159/640000 (12.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8813, max=296313, num_faces=296320
      Valid probs shape: (37, 82159)
    ✓ Random_13 (pose=(1.7738529880840348, 0.6456374380114362, 2.726644391538933)): shape (37, 800, 800)
      Valid pixels: 94734/640000 (14.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=22, max=296313, num_faces=296320
      Valid probs shape: (37, 94734)
    ✓ Random_14 (pose=(-2.6122134154753196, 2.0013143867809386, -2.854438656943256)): shape (37, 800, 800)
      Valid pixels: 64643/640000 (10.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=296249, num_faces=296320
      Valid probs shape: (37, 64643)
    P stats: min=0.0000, max=1.0000, mean=0.0229
    Non-zero vertices: 125365/148162
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 22797  1166   839  3590     0  2492  1234  5357  7077]
  Ground Truth Stats:
    Labels shape: (148162,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-10/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7166
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7965
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7968

  RESULTS:
  RAW:         median(top-10)=0.8482, mean(top-10)=0.8602, median(all)=0.7926, mean(all)=0.7166
  + SMOOTHING: median(top-10)=0.9058, mean(top-10)=0.9083, median(all)=0.8577, mean(all)=0.7965 [+0.0575]
  + MRF:       median(top-10)=0.9059, mean(top-10)=0.9086, median(all)=0.8580, mean(all)=0.7968 [+0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0577

================================================================================
Subject: MMRR-21-11
================================================================================
  Step 0: Generating predictions with V2 model (15 random views)...
  Mesh: 136982 vertices, 273960 faces
  Generating 15 random views...
  Generating predictions for 15 views (continuous camera pose)...
    ✓ Random_0 (pose=(-1.3171652906569484, 0.5142091924095236, -0.8749090032236042)): shape (37, 800, 800)
      Valid pixels: 97525/640000 (15.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=273950, num_faces=273960
      Valid probs shape: (37, 97525)
    ✓ Random_1 (pose=(-1.1232755267059238, -2.234580932432486, -1.8665889058976546)): shape (37, 800, 800)
      Valid pixels: 68376/640000 (10.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=821, max=273955, num_faces=273960
      Valid probs shape: (37, 68376)
    ✓ Random_2 (pose=(-1.2177116807859072, 0.31268678354522494, 0.21896434862234848)): shape (37, 800, 800)
      Valid pixels: 95049/640000 (14.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=2, max=273951, num_faces=273960
      Valid probs shape: (37, 95049)
    ✓ Random_3 (pose=(-2.466049930312799, -2.1277996851951366, 0.057800461160105954)): shape (37, 800, 800)
      Valid pixels: 101709/640000 (15.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=273950, num_faces=273960
      Valid probs shape: (37, 101709)
    ✓ Random_4 (pose=(0.529926957252274, 2.0535617832474227, 3.138875165969183)): shape (37, 800, 800)
      Valid pixels: 79492/640000 (12.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=745, max=273955, num_faces=273960
      Valid probs shape: (37, 79492)
    ✓ Random_5 (pose=(-0.9241478366653535, 1.8012695420467146, -2.899493379747628)): shape (37, 800, 800)
      Valid pixels: 115098/640000 (18.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=273959, num_faces=273960
      Valid probs shape: (37, 115098)
    ✓ Random_6 (pose=(-1.628122636956399, -2.099826299515785, 0.814882945973312)): shape (37, 800, 800)
      Valid pixels: 80989/640000 (12.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=20, max=273957, num_faces=273960
      Valid probs shape: (37, 80989)
    ✓ Random_7 (pose=(-2.5725856870852164, -0.0876450129265609, -0.050270923693253255)): shape (37, 800, 800)
      Valid pixels: 78033/640000 (12.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=19987, max=273959, num_faces=273960
      Valid probs shape: (37, 78033)
    ✓ Random_8 (pose=(-3.0111188769051833, 0.8858202940641666, 3.0876237423560955)): shape (37, 800, 800)
      Valid pixels: 60484/640000 (9.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1430, max=273958, num_faces=273960
      Valid probs shape: (37, 60484)
    ✓ Random_9 (pose=(-0.39463709093514376, 1.3732855769689731, -0.31083859417237036)): shape (37, 800, 800)
      Valid pixels: 73433/640000 (11.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=273902, num_faces=273960
      Valid probs shape: (37, 73433)
    ✓ Random_10 (pose=(2.9271211339599015, 1.698166851937665, 0.5934769915510101)): shape (37, 800, 800)
      Valid pixels: 105011/640000 (16.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=273959, num_faces=273960
      Valid probs shape: (37, 105011)
    ✓ Random_11 (pose=(1.5984655361395612, -1.6125565306630218, 0.16160630632677186)): shape (37, 800, 800)
      Valid pixels: 105094/640000 (16.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=273956, num_faces=273960
      Valid probs shape: (37, 105094)
    ✓ Random_12 (pose=(-1.7181655193103578, -0.1638905378891371, -2.688187084140508)): shape (37, 800, 800)
      Valid pixels: 94499/640000 (14.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=273959, num_faces=273960
      Valid probs shape: (37, 94499)
    ✓ Random_13 (pose=(0.44864573264190755, 1.3023306200859883, 2.9631900160193396)): shape (37, 800, 800)
      Valid pixels: 75174/640000 (11.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=17, max=273951, num_faces=273960
      Valid probs shape: (37, 75174)
    ✓ Random_14 (pose=(0.6570237686420448, -2.7094916594356886, -2.4739548046412065)): shape (37, 800, 800)
      Valid pixels: 84219/640000 (13.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=11864, max=273955, num_faces=273960
      Valid probs shape: (37, 84219)
    P stats: min=0.0000, max=0.9999, mean=0.0235
    Non-zero vertices: 119297/136982
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 17685  1158   816  2563     0  1428   872  4846  5432]
  Ground Truth Stats:
    Labels shape: (136982,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-11/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6444
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7113
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7115

  RESULTS:
  RAW:         median(top-10)=0.8587, mean(top-10)=0.8473, median(all)=0.7149, mean(all)=0.6444
  + SMOOTHING: median(top-10)=0.8882, mean(top-10)=0.8939, median(all)=0.7768, mean(all)=0.7113 [+0.0295]
  + MRF:       median(top-10)=0.8880, mean(top-10)=0.8944, median(all)=0.7767, mean(all)=0.7115 [-0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0293

================================================================================
Subject: MMRR-21-12
================================================================================
  Step 0: Generating predictions with V2 model (15 random views)...
  Mesh: 102602 vertices, 205200 faces
  Generating 15 random views...
  Generating predictions for 15 views (continuous camera pose)...
    ✓ Random_0 (pose=(-2.3610508976247644, 0.051688919346935425, 2.646334925597439)): shape (37, 800, 800)
      Valid pixels: 75709/640000 (11.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=110, max=205196, num_faces=205200
      Valid probs shape: (37, 75709)
    ✓ Random_1 (pose=(2.787440065588206, 2.923419662590933, 0.6163931135480416)): shape (37, 800, 800)
      Valid pixels: 61221/640000 (9.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=205192, num_faces=205200
      Valid probs shape: (37, 61221)
    ✓ Random_2 (pose=(-0.7581676553047587, 0.3079574508703411, 2.822703167132776)): shape (37, 800, 800)
      Valid pixels: 79601/640000 (12.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=205196, num_faces=205200
      Valid probs shape: (37, 79601)
    ✓ Random_3 (pose=(1.2828269852280245, -2.981475090805155, -0.09672128853735362)): shape (37, 800, 800)
      Valid pixels: 96947/640000 (15.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=16, max=205196, num_faces=205200
      Valid probs shape: (37, 96947)
    ✓ Random_4 (pose=(-0.8906020031652875, 0.8384656301660076, -0.7620887450492355)): shape (37, 800, 800)
      Valid pixels: 69542/640000 (10.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=205099, num_faces=205200
      Valid probs shape: (37, 69542)
    ✓ Random_5 (pose=(1.895627900815505, 0.10673294563316249, -3.009544106989828)): shape (37, 800, 800)
      Valid pixels: 90120/640000 (14.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=244, max=205199, num_faces=205200
      Valid probs shape: (37, 90120)
    ✓ Random_6 (pose=(-1.6575667513280519, -0.844331163435498, 2.860846039918889)): shape (37, 800, 800)
      Valid pixels: 101732/640000 (15.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=9, max=205196, num_faces=205200
      Valid probs shape: (37, 101732)
    ✓ Random_7 (pose=(-0.6750165998177153, 1.2058275845523045, 1.0820418582638718)): shape (37, 800, 800)
      Valid pixels: 83039/640000 (13.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=5, max=205023, num_faces=205200
      Valid probs shape: (37, 83039)
    ✓ Random_8 (pose=(-1.71855218462808, 2.439954597732636, -1.2805782684037879)): shape (37, 800, 800)
      Valid pixels: 79088/640000 (12.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=205110, num_faces=205200
      Valid probs shape: (37, 79088)
    ✓ Random_9 (pose=(0.41588164974077113, -0.8728928107391996, 2.4977880980024665)): shape (37, 800, 800)
      Valid pixels: 58380/640000 (9.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=205191, num_faces=205200
      Valid probs shape: (37, 58380)
    ✓ Random_10 (pose=(2.7993855442602307, -1.1994931577690144, 2.6732535901005923)): shape (37, 800, 800)
      Valid pixels: 75655/640000 (11.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=272, max=205199, num_faces=205200
      Valid probs shape: (37, 75655)
    ✓ Random_11 (pose=(1.0922329786118867, -1.277316175523713, -1.4521110639478885)): shape (37, 800, 800)
      Valid pixels: 69367/640000 (10.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=4, max=205023, num_faces=205200
      Valid probs shape: (37, 69367)
    ✓ Random_12 (pose=(2.4426710632787474, -0.14354608738276298, 0.6463539480724494)): shape (37, 800, 800)
      Valid pixels: 64070/640000 (10.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=110, max=205198, num_faces=205200
      Valid probs shape: (37, 64070)
    ✓ Random_13 (pose=(-1.6688783651686998, -0.9616609349575618, -2.195791492208371)): shape (37, 800, 800)
      Valid pixels: 75622/640000 (11.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=205196, num_faces=205200
      Valid probs shape: (37, 75622)
    ✓ Random_14 (pose=(1.5438727163345218, -3.056675636397647, -0.6501811393801229)): shape (37, 800, 800)
      Valid pixels: 98992/640000 (15.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8, max=205196, num_faces=205200
      Valid probs shape: (37, 98992)
    P stats: min=0.0000, max=0.9999, mean=0.0238
    Non-zero vertices: 90529/102602
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 12073  1009   874  1676     0  1635   879  3279  4048]
  Ground Truth Stats:
    Labels shape: (102602,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-12/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7346
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8033
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8034

  RESULTS:
  RAW:         median(top-10)=0.8672, mean(top-10)=0.8764, median(all)=0.8077, mean(all)=0.7346
  + SMOOTHING: median(top-10)=0.9271, mean(top-10)=0.9241, median(all)=0.8754, mean(all)=0.8033 [+0.0599]
  + MRF:       median(top-10)=0.9275, mean(top-10)=0.9246, median(all)=0.8755, mean(all)=0.8034 [+0.0004]
  TOTAL IMPROVEMENT (median top-10): +0.0603

================================================================================
Subject: MMRR-21-13
================================================================================
  Step 0: Generating predictions with V2 model (15 random views)...
  Mesh: 128887 vertices, 257770 faces
  Generating 15 random views...
  Generating predictions for 15 views (continuous camera pose)...
    ✓ Random_0 (pose=(-2.0650307565800308, -2.0571122096973755, 1.8048009058497678)): shape (37, 800, 800)
      Valid pixels: 81434/640000 (12.7%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=3, max=257765, num_faces=257770
      Valid probs shape: (37, 81434)
    ✓ Random_1 (pose=(-0.7909270000848747, -0.519753150304556, -2.885508609378807)): shape (37, 800, 800)
      Valid pixels: 92756/640000 (14.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=257769, num_faces=257770
      Valid probs shape: (37, 92756)
    ✓ Random_2 (pose=(-3.0140300689471915, -0.8856681126841242, -2.315049284622111)): shape (37, 800, 800)
      Valid pixels: 114936/640000 (18.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=307, max=257769, num_faces=257770
      Valid probs shape: (37, 114936)
    ✓ Random_3 (pose=(0.3278653789109196, -1.781254085838216, -1.7307647213219235)): shape (37, 800, 800)
      Valid pixels: 110775/640000 (17.3%)
      Probs stats: min=0.0000, max=0.9994, mean=0.0270
      Face IDs: min=39, max=257767, num_faces=257770
      Valid probs shape: (37, 110775)
    ✓ Random_4 (pose=(-2.9975623181623625, -0.2897404220660613, 1.6265034080588796)): shape (37, 800, 800)
      Valid pixels: 77807/640000 (12.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8619, max=257767, num_faces=257770
      Valid probs shape: (37, 77807)
    ✓ Random_5 (pose=(-0.4688550166922063, 1.717422969661981, -0.5158454647008925)): shape (37, 800, 800)
      Valid pixels: 80197/640000 (12.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=359, max=257709, num_faces=257770
      Valid probs shape: (37, 80197)
    ✓ Random_6 (pose=(0.19602476031858584, -3.1297102006660595, 1.8323538237945822)): shape (37, 800, 800)
      Valid pixels: 62107/640000 (9.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=17736, max=257767, num_faces=257770
      Valid probs shape: (37, 62107)
    ✓ Random_7 (pose=(-3.0867812838378743, -2.8077243770992726, -2.1678522415383292)): shape (37, 800, 800)
      Valid pixels: 70180/640000 (11.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=257766, num_faces=257770
      Valid probs shape: (37, 70180)
    ✓ Random_8 (pose=(-2.7187837758025095, -0.916573057028014, -0.21052804153188287)): shape (37, 800, 800)
      Valid pixels: 88239/640000 (13.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5812, max=257767, num_faces=257770
      Valid probs shape: (37, 88239)
    ✓ Random_9 (pose=(-3.118087069164662, 2.2118138748799616, -1.5083558477932224)): shape (37, 800, 800)
      Valid pixels: 106325/640000 (16.6%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=3, max=257158, num_faces=257770
      Valid probs shape: (37, 106325)
    ✓ Random_10 (pose=(1.4169656212811201, -0.627179605107075, 2.299344882402152)): shape (37, 800, 800)
      Valid pixels: 115320/640000 (18.0%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=1, max=257649, num_faces=257770
      Valid probs shape: (37, 115320)
    ✓ Random_11 (pose=(-1.1797918596421286, -1.383089618462728, -2.4084714276901846)): shape (37, 800, 800)
      Valid pixels: 90498/640000 (14.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=6, max=257769, num_faces=257770
      Valid probs shape: (37, 90498)
    ✓ Random_12 (pose=(1.3781088275826825, -0.2567230997094416, -1.6702660279813424)): shape (37, 800, 800)
      Valid pixels: 81526/640000 (12.7%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=3, max=257765, num_faces=257770
      Valid probs shape: (37, 81526)
    ✓ Random_13 (pose=(-2.8921472396191943, -1.7412383583532833, 0.46766457533485006)): shape (37, 800, 800)
      Valid pixels: 118021/640000 (18.4%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=5, max=257574, num_faces=257770
      Valid probs shape: (37, 118021)
    ✓ Random_14 (pose=(-0.42248380920356654, 2.827455657695011, 1.8820842471009431)): shape (37, 800, 800)
      Valid pixels: 81246/640000 (12.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2429, max=257767, num_faces=257770
      Valid probs shape: (37, 81246)
    P stats: min=0.0000, max=0.9999, mean=0.0230
    Non-zero vertices: 109762/128887
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 19125   950  1037  2940     0  1653   546  4171  5437]
  Ground Truth Stats:
    Labels shape: (128887,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-13/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7023
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7826
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7830

  RESULTS:
  RAW:         median(top-10)=0.8444, mean(top-10)=0.8558, median(all)=0.7638, mean(all)=0.7023
  + SMOOTHING: median(top-10)=0.9037, mean(top-10)=0.9070, median(all)=0.8450, mean(all)=0.7826 [+0.0592]
  + MRF:       median(top-10)=0.9041, mean(top-10)=0.9074, median(all)=0.8454, mean(all)=0.7830 [+0.0005]
  TOTAL IMPROVEMENT (median top-10): +0.0597

================================================================================
Subject: MMRR-21-14
================================================================================
  Step 0: Generating predictions with V2 model (15 random views)...
  Mesh: 127387 vertices, 254770 faces
  Generating 15 random views...
  Generating predictions for 15 views (continuous camera pose)...
    ✓ Random_0 (pose=(2.266766991894414, 2.455506535258567, -2.678839011277004)): shape (37, 800, 800)
      Valid pixels: 86306/640000 (13.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=254754, num_faces=254770
      Valid probs shape: (37, 86306)
    ✓ Random_1 (pose=(1.6990541092264957, -0.9782286948852006, -0.23943457274989344)): shape (37, 800, 800)
      Valid pixels: 103942/640000 (16.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=12, max=254767, num_faces=254770
      Valid probs shape: (37, 103942)
    ✓ Random_2 (pose=(-0.23259435978896414, 0.13877407412632747, 0.9918211767858036)): shape (37, 800, 800)
      Valid pixels: 51365/640000 (8.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=253835, num_faces=254770
      Valid probs shape: (37, 51365)
    ✓ Random_3 (pose=(-1.4363088717345815, 1.2424052696585228, -2.64354742518591)): shape (37, 800, 800)
      Valid pixels: 90394/640000 (14.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=36, max=254638, num_faces=254770
      Valid probs shape: (37, 90394)
    ✓ Random_4 (pose=(0.11848652013003402, -2.9839989137832346, -1.2970952936045528)): shape (37, 800, 800)
      Valid pixels: 47327/640000 (7.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3749, max=254769, num_faces=254770
      Valid probs shape: (37, 47327)
    ✓ Random_5 (pose=(1.6922332130132407, 0.07448631231366276, -0.6485502231023972)): shape (37, 800, 800)
      Valid pixels: 101973/640000 (15.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=254767, num_faces=254770
      Valid probs shape: (37, 101973)
    ✓ Random_6 (pose=(-0.4258586465294907, -0.7740462061160205, 2.1979829616606246)): shape (37, 800, 800)
      Valid pixels: 81586/640000 (12.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=254644, num_faces=254770
      Valid probs shape: (37, 81586)
    ✓ Random_7 (pose=(1.5087867396328543, -0.9633833890276695, 0.22662916249685505)): shape (37, 800, 800)
      Valid pixels: 97082/640000 (15.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=33, max=254765, num_faces=254770
      Valid probs shape: (37, 97082)
    ✓ Random_8 (pose=(-2.0298891173403404, -2.4294582830152773, -2.137396531077555)): shape (37, 800, 800)
      Valid pixels: 77566/640000 (12.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=254638, num_faces=254770
      Valid probs shape: (37, 77566)
    ✓ Random_9 (pose=(0.7307541299114271, 1.6063565953136418, -2.802655525743813)): shape (37, 800, 800)
      Valid pixels: 70828/640000 (11.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=254769, num_faces=254770
      Valid probs shape: (37, 70828)
    ✓ Random_10 (pose=(0.9867793529924507, 2.266129782900867, -0.8966408548075577)): shape (37, 800, 800)
      Valid pixels: 101135/640000 (15.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=83, max=254767, num_faces=254770
      Valid probs shape: (37, 101135)
    ✓ Random_11 (pose=(-2.8980132541459525, -2.6215836583841785, 1.999355903221173)): shape (37, 800, 800)
      Valid pixels: 55392/640000 (8.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=254671, num_faces=254770
      Valid probs shape: (37, 55392)
    ✓ Random_12 (pose=(1.3084753839253613, 0.24096734807771192, -2.257109109049143)): shape (37, 800, 800)
      Valid pixels: 69935/640000 (10.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=254768, num_faces=254770
      Valid probs shape: (37, 69935)
    ✓ Random_13 (pose=(-2.6705524542475425, -1.453473374586007, -2.717175702849981)): shape (37, 800, 800)
      Valid pixels: 101671/640000 (15.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=254767, num_faces=254770
      Valid probs shape: (37, 101671)
    ✓ Random_14 (pose=(-0.7234398531466502, -1.9683801260142695, 2.03633698454807)): shape (37, 800, 800)
      Valid pixels: 102359/640000 (16.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=41, max=254768, num_faces=254770
      Valid probs shape: (37, 102359)
    P stats: min=0.0000, max=1.0000, mean=0.0195
    Non-zero vertices: 91869/127387
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 35518   795  1072  1444     0  1847  1210  4609  4015]
  Ground Truth Stats:
    Labels shape: (127387,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-14/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6354
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7408
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7412

  RESULTS:
  RAW:         median(top-10)=0.8375, mean(top-10)=0.8470, median(all)=0.6503, mean(all)=0.6354
  + SMOOTHING: median(top-10)=0.8912, mean(top-10)=0.8903, median(all)=0.7907, mean(all)=0.7408 [+0.0537]
  + MRF:       median(top-10)=0.8920, mean(top-10)=0.8910, median(all)=0.7909, mean(all)=0.7412 [+0.0008]
  TOTAL IMPROVEMENT (median top-10): +0.0544

================================================================================
Subject: MMRR-21-15
================================================================================
  Step 0: Generating predictions with V2 model (15 random views)...
  Mesh: 137028 vertices, 274052 faces
  Generating 15 random views...
  Generating predictions for 15 views (continuous camera pose)...
    ✓ Random_0 (pose=(-1.5396265439725643, -1.2145009752163312, 0.8004641338126688)): shape (37, 800, 800)
      Valid pixels: 68691/640000 (10.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=59, max=274044, num_faces=274052
      Valid probs shape: (37, 68691)
    ✓ Random_1 (pose=(-1.6052273275845814, 1.014333841491771, 0.9482796315881936)): shape (37, 800, 800)
      Valid pixels: 67008/640000 (10.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=63, max=274044, num_faces=274052
      Valid probs shape: (37, 67008)
    ✓ Random_2 (pose=(0.5544280950669926, 2.2766052624782507, -1.6367426893662844)): shape (37, 800, 800)
      Valid pixels: 75672/640000 (11.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=142, max=274051, num_faces=274052
      Valid probs shape: (37, 75672)
    ✓ Random_3 (pose=(2.0835416049462925, 0.12785943810207856, -2.7599750889819985)): shape (37, 800, 800)
      Valid pixels: 74856/640000 (11.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=314, max=274051, num_faces=274052
      Valid probs shape: (37, 74856)
    ✓ Random_4 (pose=(1.1955349164036049, -1.6385645758009695, 0.3990011340574089)): shape (37, 800, 800)
      Valid pixels: 89962/640000 (14.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=273971, num_faces=274052
      Valid probs shape: (37, 89962)
    ✓ Random_5 (pose=(2.2775513393860436, -2.2387809677342303, 0.9364823396299764)): shape (37, 800, 800)
      Valid pixels: 53768/640000 (8.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=272681, num_faces=274052
      Valid probs shape: (37, 53768)
    ✓ Random_6 (pose=(-2.444419826020342, -2.4206028929151504, 2.132141050978129)): shape (37, 800, 800)
      Valid pixels: 53903/640000 (8.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=274041, num_faces=274052
      Valid probs shape: (37, 53903)
    ✓ Random_7 (pose=(-1.9795671389611194, 1.4254261528926984, -2.5642027449562215)): shape (37, 800, 800)
      Valid pixels: 66656/640000 (10.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=273971, num_faces=274052
      Valid probs shape: (37, 66656)
    ✓ Random_8 (pose=(0.5843060086094396, 0.42982063320033115, -2.2870547842006115)): shape (37, 800, 800)
      Valid pixels: 48183/640000 (7.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=274043, num_faces=274052
      Valid probs shape: (37, 48183)
    ✓ Random_9 (pose=(-0.2520003910987221, -0.20619141750398118, 0.7436292631058152)): shape (37, 800, 800)
      Valid pixels: 40976/640000 (6.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=273967, num_faces=274052
      Valid probs shape: (37, 40976)
    ✓ Random_10 (pose=(-1.6435624282270813, -2.03533277000858, -0.9300179907605788)): shape (37, 800, 800)
      Valid pixels: 79957/640000 (12.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=2, max=274050, num_faces=274052
      Valid probs shape: (37, 79957)
    ✓ Random_11 (pose=(-3.073113770580546, 1.7196436399134587, 0.2890175341887051)): shape (37, 800, 800)
      Valid pixels: 66333/640000 (10.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=274043, num_faces=274052
      Valid probs shape: (37, 66333)
    ✓ Random_12 (pose=(-2.5741466177315773, -2.756115423152385, -1.9494106014210366)): shape (37, 800, 800)
      Valid pixels: 57220/640000 (8.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=273971, num_faces=274052
      Valid probs shape: (37, 57220)
    ✓ Random_13 (pose=(-2.4771978767142886, 0.22999175286748486, 0.9277741557465591)): shape (37, 800, 800)
      Valid pixels: 51534/640000 (8.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3711, max=274051, num_faces=274052
      Valid probs shape: (37, 51534)
    ✓ Random_14 (pose=(-1.4258280948100015, -1.5792693312244217, 1.5519969767736308)): shape (37, 800, 800)
      Valid pixels: 62654/640000 (9.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=10, max=274043, num_faces=274052
      Valid probs shape: (37, 62654)
    P stats: min=0.0000, max=1.0000, mean=0.0223
    Non-zero vertices: 112879/137028
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 24149   425  1199  2895     0  2234   859  3881  5321]
  Ground Truth Stats:
    Labels shape: (137028,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-15/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7094
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=33
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7853
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=33
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7858

  RESULTS:
  RAW:         median(top-10)=0.8395, mean(top-10)=0.8528, median(all)=0.7739, mean(all)=0.7094
  + SMOOTHING: median(top-10)=0.9099, mean(top-10)=0.9096, median(all)=0.8410, mean(all)=0.7853 [+0.0704]
  + MRF:       median(top-10)=0.9103, mean(top-10)=0.9100, median(all)=0.8416, mean(all)=0.7858 [+0.0004]
  TOTAL IMPROVEMENT (median top-10): +0.0708

================================================================================
Subject: MMRR-21-16
================================================================================
  Step 0: Generating predictions with V2 model (15 random views)...
  Mesh: 147500 vertices, 294996 faces
  Generating 15 random views...
  Generating predictions for 15 views (continuous camera pose)...
    ✓ Random_0 (pose=(-2.415115546197, -1.4018536505844743, 0.8925341580310908)): shape (37, 800, 800)
      Valid pixels: 86199/640000 (13.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=22, max=294991, num_faces=294996
      Valid probs shape: (37, 86199)
    ✓ Random_1 (pose=(-1.2428672318822285, -2.028870092333715, -2.517236898325017)): shape (37, 800, 800)
      Valid pixels: 67841/640000 (10.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=17, max=294995, num_faces=294996
      Valid probs shape: (37, 67841)
    ✓ Random_2 (pose=(-0.8530803144086869, -1.3462273851478477, -1.5820952522820242)): shape (37, 800, 800)
      Valid pixels: 86426/640000 (13.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8, max=294983, num_faces=294996
      Valid probs shape: (37, 86426)
    ✓ Random_3 (pose=(1.6952115309861808, -0.5135157623033897, 1.8799607923479993)): shape (37, 800, 800)
      Valid pixels: 74963/640000 (11.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=18, max=294995, num_faces=294996
      Valid probs shape: (37, 74963)
    ✓ Random_4 (pose=(2.602708130570581, -3.133483124486688, -2.7390885439123243)): shape (37, 800, 800)
      Valid pixels: 56751/640000 (8.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=294345, num_faces=294996
      Valid probs shape: (37, 56751)
    ✓ Random_5 (pose=(-1.2079368582095513, -0.2107237056289777, 1.8845061234443206)): shape (37, 800, 800)
      Valid pixels: 72394/640000 (11.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=9, max=294924, num_faces=294996
      Valid probs shape: (37, 72394)
    ✓ Random_6 (pose=(1.770294787198286, -2.7271553850492354, -1.5526917125934823)): shape (37, 800, 800)
      Valid pixels: 62666/640000 (9.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=294924, num_faces=294996
      Valid probs shape: (37, 62666)
    ✓ Random_7 (pose=(-3.1126483190455594, -1.65782051640638, 0.7978836006152594)): shape (37, 800, 800)
      Valid pixels: 89726/640000 (14.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8, max=294991, num_faces=294996
      Valid probs shape: (37, 89726)
    ✓ Random_8 (pose=(2.2353586018689873, 1.1646690323195887, 2.3386859820705954)): shape (37, 800, 800)
      Valid pixels: 63523/640000 (9.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7, max=294995, num_faces=294996
      Valid probs shape: (37, 63523)
    ✓ Random_9 (pose=(1.829151266300987, 2.7117302091230435, -0.9323740716918443)): shape (37, 800, 800)
      Valid pixels: 81144/640000 (12.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=294924, num_faces=294996
      Valid probs shape: (37, 81144)
    ✓ Random_10 (pose=(0.6027654414942316, -1.4250219302356033, -2.2153314897716174)): shape (37, 800, 800)
      Valid pixels: 86984/640000 (13.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=294991, num_faces=294996
      Valid probs shape: (37, 86984)
    ✓ Random_11 (pose=(0.26434063732480073, -0.266609617812962, -2.1590952807740087)): shape (37, 800, 800)
      Valid pixels: 52620/640000 (8.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=293886, num_faces=294996
      Valid probs shape: (37, 52620)
    ✓ Random_12 (pose=(-2.918876745665462, 2.7530805044492066, -1.312071186593395)): shape (37, 800, 800)
      Valid pixels: 57890/640000 (9.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=294363, num_faces=294996
      Valid probs shape: (37, 57890)
    ✓ Random_13 (pose=(1.0995255998226812, 0.5329901800257639, -1.1800407556925396)): shape (37, 800, 800)
      Valid pixels: 80468/640000 (12.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=8, max=294924, num_faces=294996
      Valid probs shape: (37, 80468)
    ✓ Random_14 (pose=(0.7950434027950717, 2.928058323548451, -0.4102746877794612)): shape (37, 800, 800)
      Valid pixels: 75206/640000 (11.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=294995, num_faces=294996
      Valid probs shape: (37, 75206)
    P stats: min=0.0000, max=0.9999, mean=0.0223
    Non-zero vertices: 121841/147500
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 25659  1005  1450  3000     0  1757  1139  4229  5969]
  Ground Truth Stats:
    Labels shape: (147500,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-16/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7060
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7844
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7852

  RESULTS:
  RAW:         median(top-10)=0.8347, mean(top-10)=0.8476, median(all)=0.7884, mean(all)=0.7060
  + SMOOTHING: median(top-10)=0.9101, mean(top-10)=0.9079, median(all)=0.8323, mean(all)=0.7844 [+0.0753]
  + MRF:       median(top-10)=0.9103, mean(top-10)=0.9083, median(all)=0.8326, mean(all)=0.7852 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0755

================================================================================
Subject: MMRR-21-17
================================================================================
  Step 0: Generating predictions with V2 model (15 random views)...
  Mesh: 126138 vertices, 252272 faces
  Generating 15 random views...
  Generating predictions for 15 views (continuous camera pose)...
    ✓ Random_0 (pose=(2.733057557778925, -2.259103744693867, 1.263035237489408)): shape (37, 800, 800)
      Valid pixels: 88502/640000 (13.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=252271, num_faces=252272
      Valid probs shape: (37, 88502)
    ✓ Random_1 (pose=(-1.3752582874284194, -2.5655935965403787, -0.04076422079813824)): shape (37, 800, 800)
      Valid pixels: 93368/640000 (14.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=28, max=252271, num_faces=252272
      Valid probs shape: (37, 93368)
    ✓ Random_2 (pose=(-2.7400169003989503, 1.2389774667508968, 2.781092111793911)): shape (37, 800, 800)
      Valid pixels: 73266/640000 (11.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=34, max=252270, num_faces=252272
      Valid probs shape: (37, 73266)
    ✓ Random_3 (pose=(-0.018796824501459142, -0.4141018167628623, -0.40171012756063584)): shape (37, 800, 800)
      Valid pixels: 51990/640000 (8.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=252200, num_faces=252272
      Valid probs shape: (37, 51990)
    ✓ Random_4 (pose=(-0.6395577191571764, 0.16721670249396947, -2.984207647922187)): shape (37, 800, 800)
      Valid pixels: 73715/640000 (11.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=252204, num_faces=252272
      Valid probs shape: (37, 73715)
    ✓ Random_5 (pose=(-2.837489868041489, -0.1000122379362991, -0.14150502356396055)): shape (37, 800, 800)
      Valid pixels: 59716/640000 (9.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=52386, max=252264, num_faces=252272
      Valid probs shape: (37, 59716)
    ✓ Random_6 (pose=(-2.0714250599161934, 2.460278563493394, -2.159375571826888)): shape (37, 800, 800)
      Valid pixels: 62084/640000 (9.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=252270, num_faces=252272
      Valid probs shape: (37, 62084)
    ✓ Random_7 (pose=(2.9659130793079402, -1.1124808876081507, -2.862194029085124)): shape (37, 800, 800)
      Valid pixels: 68359/640000 (10.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=462, max=252204, num_faces=252272
      Valid probs shape: (37, 68359)
    ✓ Random_8 (pose=(-1.6297239652133682, 2.025930070275682, 2.6304554320836564)): shape (37, 800, 800)
      Valid pixels: 106306/640000 (16.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=252204, num_faces=252272
      Valid probs shape: (37, 106306)
    ✓ Random_9 (pose=(-2.341840018816751, 1.9254359779084238, 0.9183396519086369)): shape (37, 800, 800)
      Valid pixels: 65616/640000 (10.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=252204, num_faces=252272
      Valid probs shape: (37, 65616)
    ✓ Random_10 (pose=(1.5110683440772732, -1.4333091769499917, 3.126142255723545)): shape (37, 800, 800)
      Valid pixels: 97247/640000 (15.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=10, max=252271, num_faces=252272
      Valid probs shape: (37, 97247)
    ✓ Random_11 (pose=(-1.1328361275083294, 1.244443113560398, 3.056799173116425)): shape (37, 800, 800)
      Valid pixels: 104580/640000 (16.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=252204, num_faces=252272
      Valid probs shape: (37, 104580)
    ✓ Random_12 (pose=(2.4538768095615913, 0.9497728055882213, 1.9669788015330774)): shape (37, 800, 800)
      Valid pixels: 60781/640000 (9.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=681, max=252270, num_faces=252272
      Valid probs shape: (37, 60781)
    ✓ Random_13 (pose=(2.7944224492121057, 2.841014973213597, 1.7825229894438923)): shape (37, 800, 800)
      Valid pixels: 54581/640000 (8.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=251947, num_faces=252272
      Valid probs shape: (37, 54581)
    ✓ Random_14 (pose=(-1.7353677588408185, -1.5671923804398344, -0.35832630220602013)): shape (37, 800, 800)
      Valid pixels: 102468/640000 (16.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=24, max=252270, num_faces=252272
      Valid probs shape: (37, 102468)
    P stats: min=0.0000, max=0.9999, mean=0.0243
    Non-zero vertices: 113288/126138
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 12850   933  1077  2755     0  2600   723  4346  5210]
  Ground Truth Stats:
    Labels shape: (126138,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-17/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7547
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8099
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8101

  RESULTS:
  RAW:         median(top-10)=0.8893, mean(top-10)=0.8868, median(all)=0.8161, mean(all)=0.7547
  + SMOOTHING: median(top-10)=0.9252, mean(top-10)=0.9210, median(all)=0.8777, mean(all)=0.8099 [+0.0359]
  + MRF:       median(top-10)=0.9254, mean(top-10)=0.9212, median(all)=0.8783, mean(all)=0.8101 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0361

================================================================================
Subject: MMRR-21-18
================================================================================
  Step 0: Generating predictions with V2 model (15 random views)...
  Mesh: 131379 vertices, 262754 faces
  Generating 15 random views...
  Generating predictions for 15 views (continuous camera pose)...
    ✓ Random_0 (pose=(0.037475809156756856, 2.3218401589539788, 0.8980237109104392)): shape (37, 800, 800)
      Valid pixels: 77229/640000 (12.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=10558, max=262751, num_faces=262754
      Valid probs shape: (37, 77229)
    ✓ Random_1 (pose=(-1.015683916264567, 0.5306171547481617, 2.4014979723153855)): shape (37, 800, 800)
      Valid pixels: 75090/640000 (11.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=262747, num_faces=262754
      Valid probs shape: (37, 75090)
    ✓ Random_2 (pose=(-0.3682843198932848, 2.808933350482941, -1.5403615416754455)): shape (37, 800, 800)
      Valid pixels: 52508/640000 (8.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=905, max=262753, num_faces=262754
      Valid probs shape: (37, 52508)
    ✓ Random_3 (pose=(-0.8145701226378699, 2.4818690804825234, 0.09351852483370093)): shape (37, 800, 800)
      Valid pixels: 82883/640000 (13.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6212, max=262751, num_faces=262754
      Valid probs shape: (37, 82883)
    ✓ Random_4 (pose=(2.440239035898105, -1.3539253645161953, -2.0586708551343555)): shape (37, 800, 800)
      Valid pixels: 78317/640000 (12.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=259, max=262708, num_faces=262754
      Valid probs shape: (37, 78317)
    ✓ Random_5 (pose=(-2.9971266339090703, -3.0364557313031515, 0.5181934580406726)): shape (37, 800, 800)
      Valid pixels: 48159/640000 (7.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=262449, num_faces=262754
      Valid probs shape: (37, 48159)
    ✓ Random_6 (pose=(-1.1192977390259724, -2.490589654418897, 1.848388865990609)): shape (37, 800, 800)
      Valid pixels: 83223/640000 (13.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=262750, num_faces=262754
      Valid probs shape: (37, 83223)
    ✓ Random_7 (pose=(1.4134208767161294, -1.7818982078408196, 2.566602348866632)): shape (37, 800, 800)
      Valid pixels: 89786/640000 (14.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=262751, num_faces=262754
      Valid probs shape: (37, 89786)
    ✓ Random_8 (pose=(-0.5968888819641704, 2.9083586640870784, -1.1626660020514235)): shape (37, 800, 800)
      Valid pixels: 54174/640000 (8.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=35175, max=262751, num_faces=262754
      Valid probs shape: (37, 54174)
    ✓ Random_9 (pose=(-1.8426603607785657, -1.5902912305792152, -2.4576246491169185)): shape (37, 800, 800)
      Valid pixels: 81878/640000 (12.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=262753, num_faces=262754
      Valid probs shape: (37, 81878)
    ✓ Random_10 (pose=(2.2987430025245814, 0.14848600187241123, 1.2217035971750771)): shape (37, 800, 800)
      Valid pixels: 61549/640000 (9.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=487, max=262753, num_faces=262754
      Valid probs shape: (37, 61549)
    ✓ Random_11 (pose=(2.5743380282664576, -2.6597184201156425, -0.9713739767477083)): shape (37, 800, 800)
      Valid pixels: 69822/640000 (10.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=262753, num_faces=262754
      Valid probs shape: (37, 69822)
    ✓ Random_12 (pose=(2.50696964160497, -0.18124515756369153, 1.4605785465167873)): shape (37, 800, 800)
      Valid pixels: 55854/640000 (8.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=23099, max=262751, num_faces=262754
      Valid probs shape: (37, 55854)
    ✓ Random_13 (pose=(2.543661933942807, -0.07470443556283213, -0.0675970163585391)): shape (37, 800, 800)
      Valid pixels: 62130/640000 (9.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=67, max=262753, num_faces=262754
      Valid probs shape: (37, 62130)
    ✓ Random_14 (pose=(1.2459933951876652, -0.8611225096424264, -1.2762977968421205)): shape (37, 800, 800)
      Valid pixels: 64916/640000 (10.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=262643, num_faces=262754
      Valid probs shape: (37, 64916)
    P stats: min=0.0000, max=0.9999, mean=0.0215
    Non-zero vertices: 104597/131379
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 26782   343  1333  2622     0  1499   922  3419  3875]
  Ground Truth Stats:
    Labels shape: (131379,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-18/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6842
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7708
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7712

  RESULTS:
  RAW:         median(top-10)=0.8223, mean(top-10)=0.8477, median(all)=0.7529, mean(all)=0.6842
  + SMOOTHING: median(top-10)=0.8939, mean(top-10)=0.9049, median(all)=0.8236, mean(all)=0.7708 [+0.0716]
  + MRF:       median(top-10)=0.8943, mean(top-10)=0.9054, median(all)=0.8246, mean(all)=0.7712 [+0.0005]
  TOTAL IMPROVEMENT (median top-10): +0.0721

================================================================================
Subject: MMRR-21-19
================================================================================
  Step 0: Generating predictions with V2 model (15 random views)...
  Mesh: 145253 vertices, 290502 faces
  Generating 15 random views...
  Generating predictions for 15 views (continuous camera pose)...
    ✓ Random_0 (pose=(2.008201057155235, -0.12745721499436868, -1.7892221989082435)): shape (37, 800, 800)
      Valid pixels: 75420/640000 (11.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=123, max=290501, num_faces=290502
      Valid probs shape: (37, 75420)
    ✓ Random_1 (pose=(2.5903233353537436, 2.574591795352184, -2.7125419366887233)): shape (37, 800, 800)
      Valid pixels: 90533/640000 (14.1%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=1, max=288277, num_faces=290502
      Valid probs shape: (37, 90533)
    ✓ Random_2 (pose=(-2.2596984293513858, -3.0902722035117556, -2.6244260431287234)): shape (37, 800, 800)
      Valid pixels: 76112/640000 (11.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=290437, num_faces=290502
      Valid probs shape: (37, 76112)
    ✓ Random_3 (pose=(1.4453716402931427, -2.761539773346683, -2.584853198858846)): shape (37, 800, 800)
      Valid pixels: 82091/640000 (12.8%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=6, max=290499, num_faces=290502
      Valid probs shape: (37, 82091)
    ✓ Random_4 (pose=(1.0865755041920728, -0.5236718843839712, -0.3997663311041988)): shape (37, 800, 800)
      Valid pixels: 93044/640000 (14.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=290501, num_faces=290502
      Valid probs shape: (37, 93044)
    ✓ Random_5 (pose=(0.4488952617961761, 0.9763962003453193, 0.2456729267372979)): shape (37, 800, 800)
      Valid pixels: 69735/640000 (10.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=290438, num_faces=290502
      Valid probs shape: (37, 69735)
    ✓ Random_6 (pose=(2.3900415649274462, 2.6503715322216097, 2.2674336797722674)): shape (37, 800, 800)
      Valid pixels: 77366/640000 (12.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=288280, num_faces=290502
      Valid probs shape: (37, 77366)
    ✓ Random_7 (pose=(1.9722490083127173, -2.125316652001751, 2.133148278777541)): shape (37, 800, 800)
      Valid pixels: 104947/640000 (16.4%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=3, max=290125, num_faces=290502
      Valid probs shape: (37, 104947)
    ✓ Random_8 (pose=(-1.1020521705558184, 2.143125182465848, -0.9017964296067027)): shape (37, 800, 800)
      Valid pixels: 79086/640000 (12.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=200, max=288281, num_faces=290502
      Valid probs shape: (37, 79086)
    ✓ Random_9 (pose=(-2.611872077251072, -1.1225290842254494, -2.2756965958088133)): shape (37, 800, 800)
      Valid pixels: 104893/640000 (16.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=290501, num_faces=290502
      Valid probs shape: (37, 104893)
    ✓ Random_10 (pose=(-1.833522926085801, 0.7163813006362085, -2.1670442168926023)): shape (37, 800, 800)
      Valid pixels: 69835/640000 (10.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=39, max=290438, num_faces=290502
      Valid probs shape: (37, 69835)
    ✓ Random_11 (pose=(1.2667452016148397, 0.976366983309159, -2.641267540310899)): shape (37, 800, 800)
      Valid pixels: 74390/640000 (11.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=2, max=290499, num_faces=290502
      Valid probs shape: (37, 74390)
    ✓ Random_12 (pose=(-0.7815936109071782, -0.7114170310239691, 1.6727213594784267)): shape (37, 800, 800)
      Valid pixels: 79483/640000 (12.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=290501, num_faces=290502
      Valid probs shape: (37, 79483)
    ✓ Random_13 (pose=(-1.2278266728218246, -3.023169909163445, -0.6436387915728274)): shape (37, 800, 800)
      Valid pixels: 97704/640000 (15.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=194, max=290501, num_faces=290502
      Valid probs shape: (37, 97704)
    ✓ Random_14 (pose=(-0.4268342851589879, -0.4904856910221542, 1.0512689793987926)): shape (37, 800, 800)
      Valid pixels: 51835/640000 (8.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=290498, num_faces=290502
      Valid probs shape: (37, 51835)
    P stats: min=0.0000, max=0.9999, mean=0.0239
    Non-zero vertices: 128583/145253
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 16670  1146   959  3366     0  1584  1011  4979  7297]
  Ground Truth Stats:
    Labels shape: (145253,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-19/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7370
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7957
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7958

  RESULTS:
  RAW:         median(top-10)=0.8772, mean(top-10)=0.8852, median(all)=0.7910, mean(all)=0.7370
  + SMOOTHING: median(top-10)=0.9144, mean(top-10)=0.9201, median(all)=0.8551, mean(all)=0.7957 [+0.0372]
  + MRF:       median(top-10)=0.9148, mean(top-10)=0.9204, median(all)=0.8553, mean(all)=0.7958 [+0.0005]
  TOTAL IMPROVEMENT (median top-10): +0.0377

================================================================================
Subject: MMRR-21-2
================================================================================
  Step 0: Generating predictions with V2 model (15 random views)...
  Mesh: 148593 vertices, 297182 faces
  Generating 15 random views...
  Generating predictions for 15 views (continuous camera pose)...
    ✓ Random_0 (pose=(-0.20454378208903545, 2.22829578767601, -0.848518419343538)): shape (37, 800, 800)
      Valid pixels: 66973/640000 (10.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=770, max=297178, num_faces=297182
      Valid probs shape: (37, 66973)
    ✓ Random_1 (pose=(-2.408575720507746, -0.7240674114524985, -2.605772215298577)): shape (37, 800, 800)
      Valid pixels: 88629/640000 (13.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=34, max=297160, num_faces=297182
      Valid probs shape: (37, 88629)
    ✓ Random_2 (pose=(-0.2629598167584417, 2.420224706677124, -1.489668877725068)): shape (37, 800, 800)
      Valid pixels: 69765/640000 (10.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=737, max=297178, num_faces=297182
      Valid probs shape: (37, 69765)
    ✓ Random_3 (pose=(0.3113547871474003, 2.27094839685748, -1.1170321251097626)): shape (37, 800, 800)
      Valid pixels: 83285/640000 (13.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=610, max=297176, num_faces=297182
      Valid probs shape: (37, 83285)
    ✓ Random_4 (pose=(-2.334897418381229, 2.5890772684878574, -2.438934906054087)): shape (37, 800, 800)
      Valid pixels: 61590/640000 (9.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=296915, num_faces=297182
      Valid probs shape: (37, 61590)
    ✓ Random_5 (pose=(0.11784037433989081, -0.7193383173949184, -0.9792216968499226)): shape (37, 800, 800)
      Valid pixels: 61325/640000 (9.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=296981, num_faces=297182
      Valid probs shape: (37, 61325)
    ✓ Random_6 (pose=(-2.7353523280189664, 2.54977617281049, -1.6414144119054663)): shape (37, 800, 800)
      Valid pixels: 72390/640000 (11.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=297129, num_faces=297182
      Valid probs shape: (37, 72390)
    ✓ Random_7 (pose=(-0.12312091387662782, 1.0526681124486688, 1.6142050684208282)): shape (37, 800, 800)
      Valid pixels: 82219/640000 (12.8%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=5, max=297168, num_faces=297182
      Valid probs shape: (37, 82219)
    ✓ Random_8 (pose=(-2.5971478377418, 1.0866741406165294, -0.7186099868493465)): shape (37, 800, 800)
      Valid pixels: 86657/640000 (13.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=428, max=297181, num_faces=297182
      Valid probs shape: (37, 86657)
    ✓ Random_9 (pose=(-1.7225807903560222, 0.6187685157836254, 2.004126071929048)): shape (37, 800, 800)
      Valid pixels: 87754/640000 (13.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=10, max=297181, num_faces=297182
      Valid probs shape: (37, 87754)
    ✓ Random_10 (pose=(-2.759479903837394, 2.2057031677696184, 2.224536927958148)): shape (37, 800, 800)
      Valid pixels: 83181/640000 (13.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=297146, num_faces=297182
      Valid probs shape: (37, 83181)
    ✓ Random_11 (pose=(-0.40148382728504517, 0.277829807208378, -1.7717185765688988)): shape (37, 800, 800)
      Valid pixels: 54150/640000 (8.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=296937, num_faces=297182
      Valid probs shape: (37, 54150)
    ✓ Random_12 (pose=(1.8305788195860009, -1.877964220575524, -1.8953772829462316)): shape (37, 800, 800)
      Valid pixels: 65700/640000 (10.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=297181, num_faces=297182
      Valid probs shape: (37, 65700)
    ✓ Random_13 (pose=(-2.2015586470136403, 0.599102803726729, -1.3158151632849628)): shape (37, 800, 800)
      Valid pixels: 85410/640000 (13.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6048, max=297178, num_faces=297182
      Valid probs shape: (37, 85410)
    ✓ Random_14 (pose=(-2.8336815991736364, -1.2628887281432806, 1.3460573526358282)): shape (37, 800, 800)
      Valid pixels: 91666/640000 (14.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=86, max=297174, num_faces=297182
      Valid probs shape: (37, 91666)
    P stats: min=0.0000, max=1.0000, mean=0.0230
    Non-zero vertices: 126720/148593
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 21873  1284  1058  3287     0  2000  1111  4475  5713]
  Ground Truth Stats:
    Labels shape: (148593,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-2/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7356
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8173
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8179

  RESULTS:
  RAW:         median(top-10)=0.8579, mean(top-10)=0.8647, median(all)=0.7914, mean(all)=0.7356
  + SMOOTHING: median(top-10)=0.9110, mean(top-10)=0.9148, median(all)=0.8616, mean(all)=0.8173 [+0.0531]
  + MRF:       median(top-10)=0.9113, mean(top-10)=0.9151, median(all)=0.8622, mean(all)=0.8179 [+0.0004]
  TOTAL IMPROVEMENT (median top-10): +0.0535

================================================================================
Subject: MMRR-21-20
================================================================================
  Step 0: Generating predictions with V2 model (15 random views)...
  Mesh: 149927 vertices, 299850 faces
  Generating 15 random views...
  Generating predictions for 15 views (continuous camera pose)...
    ✓ Random_0 (pose=(-1.855295336662556, 0.343226080936871, 3.0305310520275066)): shape (37, 800, 800)
      Valid pixels: 90367/640000 (14.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=299849, num_faces=299850
      Valid probs shape: (37, 90367)
    ✓ Random_1 (pose=(-3.0953930171051636, -0.7320311413261669, -0.7522368607817693)): shape (37, 800, 800)
      Valid pixels: 56654/640000 (8.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3030, max=299827, num_faces=299850
      Valid probs shape: (37, 56654)
    ✓ Random_2 (pose=(-2.037719966331332, -2.8001280791567065, 2.8997412329173136)): shape (37, 800, 800)
      Valid pixels: 88201/640000 (13.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=299849, num_faces=299850
      Valid probs shape: (37, 88201)
    ✓ Random_3 (pose=(-1.5933246766217757, -1.785374159528354, 0.2947832256525471)): shape (37, 800, 800)
      Valid pixels: 82164/640000 (12.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=17, max=299844, num_faces=299850
      Valid probs shape: (37, 82164)
    ✓ Random_4 (pose=(1.538284322170056, 1.2601180002212766, -2.8447218067145297)): shape (37, 800, 800)
      Valid pixels: 80457/640000 (12.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=299846, num_faces=299850
      Valid probs shape: (37, 80457)
    ✓ Random_5 (pose=(2.0138410690861885, -1.6926576075807156, 1.2709098626336157)): shape (37, 800, 800)
      Valid pixels: 58446/640000 (9.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=8, max=299434, num_faces=299850
      Valid probs shape: (37, 58446)
    ✓ Random_6 (pose=(2.2103345430382193, 2.609291411570953, 1.9776580300848323)): shape (37, 800, 800)
      Valid pixels: 50034/640000 (7.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=299423, num_faces=299850
      Valid probs shape: (37, 50034)
    ✓ Random_7 (pose=(-2.479814121510981, 2.887700417164173, -2.35721391229034)): shape (37, 800, 800)
      Valid pixels: 50488/640000 (7.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=299608, num_faces=299850
      Valid probs shape: (37, 50488)
    ✓ Random_8 (pose=(-3.054750368822207, 2.449070477291869, -2.1312979986469465)): shape (37, 800, 800)
      Valid pixels: 61426/640000 (9.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=299664, num_faces=299850
      Valid probs shape: (37, 61426)
    ✓ Random_9 (pose=(0.6964980872721069, 2.3399019697813044, -2.1183896098665493)): shape (37, 800, 800)
      Valid pixels: 53865/640000 (8.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=700, max=299849, num_faces=299850
      Valid probs shape: (37, 53865)
    ✓ Random_10 (pose=(1.0240961629668703, -1.0938725771125526, -1.7183691428040326)): shape (37, 800, 800)
      Valid pixels: 66005/640000 (10.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=4, max=299846, num_faces=299850
      Valid probs shape: (37, 66005)
    ✓ Random_11 (pose=(1.9821897196880585, -1.5420892119458263, 2.071355663153244)): shape (37, 800, 800)
      Valid pixels: 88673/640000 (13.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=299824, num_faces=299850
      Valid probs shape: (37, 88673)
    ✓ Random_12 (pose=(2.514358647812834, 2.3569127657328544, 0.8706797659688963)): shape (37, 800, 800)
      Valid pixels: 79902/640000 (12.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=299849, num_faces=299850
      Valid probs shape: (37, 79902)
    ✓ Random_13 (pose=(0.7643024058079106, -2.6440020165211546, 2.829666206315882)): shape (37, 800, 800)
      Valid pixels: 77445/640000 (12.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=11550, max=299824, num_faces=299850
      Valid probs shape: (37, 77445)
    ✓ Random_14 (pose=(2.0737307969867453, -1.107323102852248, 0.07844547986766237)): shape (37, 800, 800)
      Valid pixels: 78172/640000 (12.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=14, max=299608, num_faces=299850
      Valid probs shape: (37, 78172)
    P stats: min=0.0000, max=1.0000, mean=0.0235
    Non-zero vertices: 130126/149927
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 19801  1331  1197  3034     0  2326   948  4649  6094]
  Ground Truth Stats:
    Labels shape: (149927,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-20/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7401
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8099
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8103

  RESULTS:
  RAW:         median(top-10)=0.8696, mean(top-10)=0.8767, median(all)=0.8132, mean(all)=0.7401
  + SMOOTHING: median(top-10)=0.9150, mean(top-10)=0.9186, median(all)=0.8474, mean(all)=0.8099 [+0.0454]
  + MRF:       median(top-10)=0.9152, mean(top-10)=0.9190, median(all)=0.8476, mean(all)=0.8103 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0456

================================================================================
Subject: MMRR-21-21
================================================================================
  Step 0: Generating predictions with V2 model (15 random views)...
  Mesh: 137496 vertices, 274988 faces
  Generating 15 random views...
  Generating predictions for 15 views (continuous camera pose)...
    ✓ Random_0 (pose=(1.1845353076102754, -1.667240999157342, 1.0623946963030253)): shape (37, 800, 800)
      Valid pixels: 78792/640000 (12.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8, max=274984, num_faces=274988
      Valid probs shape: (37, 78792)
    ✓ Random_1 (pose=(-0.4120632127395245, 2.475239169388775, 1.7487817928272937)): shape (37, 800, 800)
      Valid pixels: 66485/640000 (10.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4001, max=274984, num_faces=274988
      Valid probs shape: (37, 66485)
    ✓ Random_2 (pose=(0.6504017273472096, 1.5067320870451946, 1.275446077816568)): shape (37, 800, 800)
      Valid pixels: 88573/640000 (13.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=274959, num_faces=274988
      Valid probs shape: (37, 88573)
    ✓ Random_3 (pose=(2.532689495234189, -1.409087572440223, -2.7810662861473388)): shape (37, 800, 800)
      Valid pixels: 68069/640000 (10.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=274985, num_faces=274988
      Valid probs shape: (37, 68069)
    ✓ Random_4 (pose=(-1.9479199804258682, -2.317495989158976, 0.8925031090196613)): shape (37, 800, 800)
      Valid pixels: 76115/640000 (11.9%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=5, max=274982, num_faces=274988
      Valid probs shape: (37, 76115)
    ✓ Random_5 (pose=(1.9895027982122375, -0.757423250836037, -0.09237427352464067)): shape (37, 800, 800)
      Valid pixels: 89550/640000 (14.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=274987, num_faces=274988
      Valid probs shape: (37, 89550)
    ✓ Random_6 (pose=(3.04648767945994, 2.7604287779553314, -2.488223587048374)): shape (37, 800, 800)
      Valid pixels: 61800/640000 (9.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=274023, num_faces=274988
      Valid probs shape: (37, 61800)
    ✓ Random_7 (pose=(-2.2648440902922697, 0.8111333306590298, 0.9756430024316085)): shape (37, 800, 800)
      Valid pixels: 65714/640000 (10.3%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=33, max=274985, num_faces=274988
      Valid probs shape: (37, 65714)
    ✓ Random_8 (pose=(-2.501952087302178, -0.23220150155863806, 1.838378654829408)): shape (37, 800, 800)
      Valid pixels: 57080/640000 (8.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=507, max=274985, num_faces=274988
      Valid probs shape: (37, 57080)
    ✓ Random_9 (pose=(-2.2868651116689573, 1.2915990770949506, 1.8954524057495687)): shape (37, 800, 800)
      Valid pixels: 99887/640000 (15.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=28, max=274987, num_faces=274988
      Valid probs shape: (37, 99887)
    ✓ Random_10 (pose=(-2.2844436089264306, 2.8913091265670623, 2.012627774358819)): shape (37, 800, 800)
      Valid pixels: 71486/640000 (11.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=274985, num_faces=274988
      Valid probs shape: (37, 71486)
    ✓ Random_11 (pose=(0.39198817894474924, 2.7959474048602626, 1.3209613129720896)): shape (37, 800, 800)
      Valid pixels: 59846/640000 (9.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=35265, max=274985, num_faces=274988
      Valid probs shape: (37, 59846)
    ✓ Random_12 (pose=(1.3794728476159435, -0.20844518833920844, 2.0054622438061873)): shape (37, 800, 800)
      Valid pixels: 79158/640000 (12.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=274959, num_faces=274988
      Valid probs shape: (37, 79158)
    ✓ Random_13 (pose=(-1.301382616258006, 0.562891114389461, 1.314066181116802)): shape (37, 800, 800)
      Valid pixels: 68242/640000 (10.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=12, max=274984, num_faces=274988
      Valid probs shape: (37, 68242)
    ✓ Random_14 (pose=(0.16499177277697497, -0.3029204519209072, 1.3671188855830865)): shape (37, 800, 800)
      Valid pixels: 53450/640000 (8.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=274984, num_faces=274988
      Valid probs shape: (37, 53450)
    P stats: min=0.0000, max=1.0000, mean=0.0228
    Non-zero vertices: 116177/137496
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 21319   873  1173  2511     0  2079  1122  4831  6452]
  Ground Truth Stats:
    Labels shape: (137496,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-21/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7052
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7773
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7773

  RESULTS:
  RAW:         median(top-10)=0.8499, mean(top-10)=0.8623, median(all)=0.7857, mean(all)=0.7052
  + SMOOTHING: median(top-10)=0.9050, mean(top-10)=0.9102, median(all)=0.8416, mean(all)=0.7773 [+0.0551]
  + MRF:       median(top-10)=0.9048, mean(top-10)=0.9105, median(all)=0.8415, mean(all)=0.7773 [-0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0549

================================================================================
Subject: MMRR-21-3
================================================================================
  Step 0: Generating predictions with V2 model (15 random views)...
  Mesh: 144159 vertices, 288314 faces
  Generating 15 random views...
  Generating predictions for 15 views (continuous camera pose)...
    ✓ Random_0 (pose=(2.7336070033712705, 1.503405170140451, 2.349584370979769)): shape (37, 800, 800)
      Valid pixels: 63628/640000 (9.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7, max=288280, num_faces=288314
      Valid probs shape: (37, 63628)
    ✓ Random_1 (pose=(2.094205989739474, -1.1568068232844042, -0.6960542514001293)): shape (37, 800, 800)
      Valid pixels: 96879/640000 (15.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=288313, num_faces=288314
      Valid probs shape: (37, 96879)
    ✓ Random_2 (pose=(-2.629565329027224, -0.46618591928714936, 3.01648572329227)): shape (37, 800, 800)
      Valid pixels: 68513/640000 (10.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=303, max=288313, num_faces=288314
      Valid probs shape: (37, 68513)
    ✓ Random_3 (pose=(-0.8937315400205748, 2.4354587363446756, 1.046843329095486)): shape (37, 800, 800)
      Valid pixels: 72297/640000 (11.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=940, max=288306, num_faces=288314
      Valid probs shape: (37, 72297)
    ✓ Random_4 (pose=(2.3566026362958334, 1.2221832982537144, 1.8759813577708648)): shape (37, 800, 800)
      Valid pixels: 63964/640000 (10.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8, max=288277, num_faces=288314
      Valid probs shape: (37, 63964)
    ✓ Random_5 (pose=(3.113044966273063, 3.1192695497620733, 0.8149257842277038)): shape (37, 800, 800)
      Valid pixels: 41319/640000 (6.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=288218, num_faces=288314
      Valid probs shape: (37, 41319)
    ✓ Random_6 (pose=(-0.14318808740109779, -3.114474837000835, -0.6080175157809524)): shape (37, 800, 800)
      Valid pixels: 46891/640000 (7.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=13281, max=288309, num_faces=288314
      Valid probs shape: (37, 46891)
    ✓ Random_7 (pose=(-2.0278351924266262, 1.3074018834636387, -0.28226748799790213)): shape (37, 800, 800)
      Valid pixels: 84475/640000 (13.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=31, max=288307, num_faces=288314
      Valid probs shape: (37, 84475)
    ✓ Random_8 (pose=(-2.516227143224553, -0.5011910099743511, 2.763346650797403)): shape (37, 800, 800)
      Valid pixels: 71032/640000 (11.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=439, max=288313, num_faces=288314
      Valid probs shape: (37, 71032)
    ✓ Random_9 (pose=(-0.41391645887640793, -0.551022790246174, 0.8332290848396866)): shape (37, 800, 800)
      Valid pixels: 48677/640000 (7.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=288309, num_faces=288314
      Valid probs shape: (37, 48677)
    ✓ Random_10 (pose=(-0.18700135539703933, 1.356908552483409, -1.7209197543085903)): shape (37, 800, 800)
      Valid pixels: 92482/640000 (14.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=288313, num_faces=288314
      Valid probs shape: (37, 92482)
    ✓ Random_11 (pose=(0.41083643162665995, -2.7832504709276433, -2.0403569155489834)): shape (37, 800, 800)
      Valid pixels: 61930/640000 (9.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2395, max=288307, num_faces=288314
      Valid probs shape: (37, 61930)
    ✓ Random_12 (pose=(2.171984802720563, -2.5633402384783603, -2.5764729436059426)): shape (37, 800, 800)
      Valid pixels: 61933/640000 (9.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=8, max=288307, num_faces=288314
      Valid probs shape: (37, 61933)
    ✓ Random_13 (pose=(-0.15148091896371874, -2.485199070796496, 0.7875532401799816)): shape (37, 800, 800)
      Valid pixels: 64458/640000 (10.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=762, max=288313, num_faces=288314
      Valid probs shape: (37, 64458)
    ✓ Random_14 (pose=(2.67332452246343, 1.3922647290294714, -0.46313633829564527)): shape (37, 800, 800)
      Valid pixels: 65525/640000 (10.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=83, max=288309, num_faces=288314
      Valid probs shape: (37, 65525)
    P stats: min=0.0000, max=1.0000, mean=0.0218
    Non-zero vertices: 116385/144159
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 27774   877   989  2741     0  1870  1314  4561  5013]
  Ground Truth Stats:
    Labels shape: (144159,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-3/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7112
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8034
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8038

  RESULTS:
  RAW:         median(top-10)=0.8461, mean(top-10)=0.8542, median(all)=0.7329, mean(all)=0.7112
  + SMOOTHING: median(top-10)=0.8949, mean(top-10)=0.9001, median(all)=0.8486, mean(all)=0.8034 [+0.0487]
  + MRF:       median(top-10)=0.8954, mean(top-10)=0.9006, median(all)=0.8514, mean(all)=0.8038 [+0.0005]
  TOTAL IMPROVEMENT (median top-10): +0.0493

================================================================================
Subject: MMRR-21-4
================================================================================
  Step 0: Generating predictions with V2 model (15 random views)...
  Mesh: 118034 vertices, 236064 faces
  Generating 15 random views...
  Generating predictions for 15 views (continuous camera pose)...
    ✓ Random_0 (pose=(2.371491643828686, 2.0604060708605214, -2.045945463694144)): shape (37, 800, 800)
      Valid pixels: 79322/640000 (12.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=236061, num_faces=236064
      Valid probs shape: (37, 79322)
    ✓ Random_1 (pose=(2.1258271572688274, 2.085368137387862, -1.6821755180949785)): shape (37, 800, 800)
      Valid pixels: 67760/640000 (10.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=0, max=236028, num_faces=236064
      Valid probs shape: (37, 67760)
    ✓ Random_2 (pose=(2.2013216910757105, 2.6516760071391925, 0.9743639673730291)): shape (37, 800, 800)
      Valid pixels: 71258/640000 (11.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=236016, num_faces=236064
      Valid probs shape: (37, 71258)
    ✓ Random_3 (pose=(3.0928049184720816, -0.9484935456397352, -1.9749316696715404)): shape (37, 800, 800)
      Valid pixels: 88473/640000 (13.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=230, max=236017, num_faces=236064
      Valid probs shape: (37, 88473)
    ✓ Random_4 (pose=(2.4986381245953346, 0.6376371325244587, 0.11396513804851338)): shape (37, 800, 800)
      Valid pixels: 84796/640000 (13.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=145, max=236017, num_faces=236064
      Valid probs shape: (37, 84796)
    ✓ Random_5 (pose=(-2.0961092677988167, 2.4155002524685205, 2.9316944919258603)): shape (37, 800, 800)
      Valid pixels: 86067/640000 (13.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=236015, num_faces=236064
      Valid probs shape: (37, 86067)
    ✓ Random_6 (pose=(2.8356379375360294, -1.1010560710885282, -2.760973452522865)): shape (37, 800, 800)
      Valid pixels: 63863/640000 (10.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=512, max=235907, num_faces=236064
      Valid probs shape: (37, 63863)
    ✓ Random_7 (pose=(-1.7958951638307212, -0.19685320755416624, 2.0788161421323563)): shape (37, 800, 800)
      Valid pixels: 82464/640000 (12.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=140, max=236010, num_faces=236064
      Valid probs shape: (37, 82464)
    ✓ Random_8 (pose=(-0.8054317213518112, -1.256505297057175, -2.7219974536614213)): shape (37, 800, 800)
      Valid pixels: 66595/640000 (10.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=236062, num_faces=236064
      Valid probs shape: (37, 66595)
    ✓ Random_9 (pose=(-0.1262302252158536, 1.9618294652370283, -0.8157192493856731)): shape (37, 800, 800)
      Valid pixels: 69777/640000 (10.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=12, max=236062, num_faces=236064
      Valid probs shape: (37, 69777)
    ✓ Random_10 (pose=(1.9271651670141683, 2.3543029635962665, -2.6411195372512903)): shape (37, 800, 800)
      Valid pixels: 83575/640000 (13.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=236061, num_faces=236064
      Valid probs shape: (37, 83575)
    ✓ Random_11 (pose=(-0.046688718948798336, -0.12592333444883996, -1.4244002649305787)): shape (37, 800, 800)
      Valid pixels: 48827/640000 (7.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=234903, num_faces=236064
      Valid probs shape: (37, 48827)
    ✓ Random_12 (pose=(-2.9183929608238297, 0.26997829636576, 2.1396205084641586)): shape (37, 800, 800)
      Valid pixels: 55119/640000 (8.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=810, max=236062, num_faces=236064
      Valid probs shape: (37, 55119)
    ✓ Random_13 (pose=(-1.386487602353626, -1.2399403260440938, -1.4565932871155083)): shape (37, 800, 800)
      Valid pixels: 72686/640000 (11.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=236063, num_faces=236064
      Valid probs shape: (37, 72686)
    ✓ Random_14 (pose=(2.2480981314613055, 1.7919860722512304, -2.971363120005342)): shape (37, 800, 800)
      Valid pixels: 94155/640000 (14.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=236061, num_faces=236064
      Valid probs shape: (37, 94155)
    P stats: min=0.0000, max=1.0000, mean=0.0239
    Non-zero vertices: 104582/118034
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 13452   877   958  2772     0  1728  1250  3632  4169]
  Ground Truth Stats:
    Labels shape: (118034,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-4/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7375
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8052
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8055

  RESULTS:
  RAW:         median(top-10)=0.8933, mean(top-10)=0.8938, median(all)=0.7977, mean(all)=0.7375
  + SMOOTHING: median(top-10)=0.9329, mean(top-10)=0.9299, median(all)=0.8535, mean(all)=0.8052 [+0.0396]
  + MRF:       median(top-10)=0.9329, mean(top-10)=0.9300, median(all)=0.8533, mean(all)=0.8055 [-0.0000]
  TOTAL IMPROVEMENT (median top-10): +0.0396

================================================================================
Subject: MMRR-21-5
================================================================================
  Step 0: Generating predictions with V2 model (15 random views)...
  Mesh: 145215 vertices, 290426 faces
  Generating 15 random views...
  Generating predictions for 15 views (continuous camera pose)...
    ✓ Random_0 (pose=(-0.7123102039104445, 0.09259881960125105, 0.019169530461978113)): shape (37, 800, 800)
      Valid pixels: 79665/640000 (12.4%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=1, max=288856, num_faces=290426
      Valid probs shape: (37, 79665)
    ✓ Random_1 (pose=(-1.9480740708401358, 2.3863655745302195, 0.5806928362981023)): shape (37, 800, 800)
      Valid pixels: 74038/640000 (11.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=15, max=290351, num_faces=290426
      Valid probs shape: (37, 74038)
    ✓ Random_2 (pose=(-2.4897722596378875, -0.933743067470473, -0.32169455458778984)): shape (37, 800, 800)
      Valid pixels: 82636/640000 (12.9%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=5783, max=288851, num_faces=290426
      Valid probs shape: (37, 82636)
    ✓ Random_3 (pose=(2.0615209381924835, -0.7051599788752281, -2.1023233440531097)): shape (37, 800, 800)
      Valid pixels: 71856/640000 (11.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=510, max=290422, num_faces=290426
      Valid probs shape: (37, 71856)
    ✓ Random_4 (pose=(1.2958307495649501, 0.4306339392576466, 2.442014877108501)): shape (37, 800, 800)
      Valid pixels: 102865/640000 (16.1%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=2, max=288855, num_faces=290426
      Valid probs shape: (37, 102865)
    ✓ Random_5 (pose=(2.475528556829289, -0.010207882073096197, -2.62837212478185)): shape (37, 800, 800)
      Valid pixels: 72848/640000 (11.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4366, max=290290, num_faces=290426
      Valid probs shape: (37, 72848)
    ✓ Random_6 (pose=(2.866788104812075, -0.6694793431522585, 1.9494165707679585)): shape (37, 800, 800)
      Valid pixels: 82316/640000 (12.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6872, max=290329, num_faces=290426
      Valid probs shape: (37, 82316)
    ✓ Random_7 (pose=(1.8715292064956657, 0.4935712047295717, 1.0106163818458667)): shape (37, 800, 800)
      Valid pixels: 77213/640000 (12.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=12, max=290409, num_faces=290426
      Valid probs shape: (37, 77213)
    ✓ Random_8 (pose=(2.397757980175167, -1.8281298941627777, -1.2059970111202134)): shape (37, 800, 800)
      Valid pixels: 107258/640000 (16.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=11, max=290425, num_faces=290426
      Valid probs shape: (37, 107258)
    ✓ Random_9 (pose=(-2.2108726795273914, 0.46867867391104046, 0.8363100612399834)): shape (37, 800, 800)
      Valid pixels: 71322/640000 (11.1%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=909, max=290290, num_faces=290426
      Valid probs shape: (37, 71322)
    ✓ Random_10 (pose=(2.691188330652678, 2.5375202602587965, -2.7393334684671022)): shape (37, 800, 800)
      Valid pixels: 83248/640000 (13.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=288852, num_faces=290426
      Valid probs shape: (37, 83248)
    ✓ Random_11 (pose=(-3.0925421245746185, 2.507372122214348, -1.7022583968791236)): shape (37, 800, 800)
      Valid pixels: 76712/640000 (12.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=288849, num_faces=290426
      Valid probs shape: (37, 76712)
    ✓ Random_12 (pose=(-1.913424996881724, 2.3297103953656864, 0.8958656215277578)): shape (37, 800, 800)
      Valid pixels: 71158/640000 (11.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=2, max=290351, num_faces=290426
      Valid probs shape: (37, 71158)
    ✓ Random_13 (pose=(-1.0717473018601376, 1.7144464256936054, 1.8174114550676785)): shape (37, 800, 800)
      Valid pixels: 72336/640000 (11.3%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=164, max=290423, num_faces=290426
      Valid probs shape: (37, 72336)
    ✓ Random_14 (pose=(-1.7283038624512734, -0.06938471712361105, -2.8115554704808723)): shape (37, 800, 800)
      Valid pixels: 95205/640000 (14.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=14, max=290423, num_faces=290426
      Valid probs shape: (37, 95205)
    P stats: min=0.0000, max=0.9999, mean=0.0229
    Non-zero vertices: 123269/145215
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 21946  1261  1230  3406     0  1614  1104  3670  4970]
  Ground Truth Stats:
    Labels shape: (145215,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-5/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
    MRF iteration 5/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7339
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8121
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8126

  RESULTS:
  RAW:         median(top-10)=0.8639, mean(top-10)=0.8672, median(all)=0.7870, mean(all)=0.7339
  + SMOOTHING: median(top-10)=0.9179, mean(top-10)=0.9215, median(all)=0.8445, mean(all)=0.8121 [+0.0540]
  + MRF:       median(top-10)=0.9182, mean(top-10)=0.9220, median(all)=0.8453, mean(all)=0.8126 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0543

================================================================================
Subject: MMRR-21-6
================================================================================
  Step 0: Generating predictions with V2 model (15 random views)...
  Mesh: 128994 vertices, 257984 faces
  Generating 15 random views...
  Generating predictions for 15 views (continuous camera pose)...
    ✓ Random_0 (pose=(-1.6651080848323188, -0.14135090258977456, 0.4842258919266884)): shape (37, 800, 800)
      Valid pixels: 81130/640000 (12.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=19, max=257980, num_faces=257984
      Valid probs shape: (37, 81130)
    ✓ Random_1 (pose=(0.653448395362163, -1.4583159223026727, -1.8055354631716076)): shape (37, 800, 800)
      Valid pixels: 81089/640000 (12.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=10, max=257980, num_faces=257984
      Valid probs shape: (37, 81089)
    ✓ Random_2 (pose=(2.797188217629799, -1.756364090922071, 2.888073358583976)): shape (37, 800, 800)
      Valid pixels: 70043/640000 (10.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=257982, num_faces=257984
      Valid probs shape: (37, 70043)
    ✓ Random_3 (pose=(-1.9156532767358017, -0.19353417287518537, -1.6566333454036608)): shape (37, 800, 800)
      Valid pixels: 61471/640000 (9.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=921, max=257652, num_faces=257984
      Valid probs shape: (37, 61471)
    ✓ Random_4 (pose=(-0.6218748364424034, 2.1509595868009512, 1.38337899082945)): shape (37, 800, 800)
      Valid pixels: 79110/640000 (12.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=206, max=257983, num_faces=257984
      Valid probs shape: (37, 79110)
    ✓ Random_5 (pose=(-0.22622086151496523, -3.034984858519352, -1.9998480412552926)): shape (37, 800, 800)
      Valid pixels: 49608/640000 (7.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=55311, max=257983, num_faces=257984
      Valid probs shape: (37, 49608)
    ✓ Random_6 (pose=(-2.8049023243687703, 1.0702441712643944, 2.134418956350312)): shape (37, 800, 800)
      Valid pixels: 86098/640000 (13.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=250, max=257980, num_faces=257984
      Valid probs shape: (37, 86098)
    ✓ Random_7 (pose=(0.9409195987651309, 0.4638403627902794, 1.4370583105710368)): shape (37, 800, 800)
      Valid pixels: 62515/640000 (9.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=256956, num_faces=257984
      Valid probs shape: (37, 62515)
    ✓ Random_8 (pose=(2.3851169961823135, -2.756634035985749, -1.4205371456696443)): shape (37, 800, 800)
      Valid pixels: 72093/640000 (11.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=257982, num_faces=257984
      Valid probs shape: (37, 72093)
    ✓ Random_9 (pose=(0.13570189970921565, 2.601996356002897, 1.063488840664303)): shape (37, 800, 800)
      Valid pixels: 73476/640000 (11.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=24621, max=257980, num_faces=257984
      Valid probs shape: (37, 73476)
    ✓ Random_10 (pose=(-2.1102492797166597, 2.154902371641108, 3.129778320534812)): shape (37, 800, 800)
      Valid pixels: 84902/640000 (13.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=257943, num_faces=257984
      Valid probs shape: (37, 84902)
    ✓ Random_11 (pose=(-0.13270626943536978, 1.418227821878669, 0.4045043225578926)): shape (37, 800, 800)
      Valid pixels: 85221/640000 (13.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=257771, num_faces=257984
      Valid probs shape: (37, 85221)
    ✓ Random_12 (pose=(1.3980949534632447, -0.937769151018073, 0.1759084944238949)): shape (37, 800, 800)
      Valid pixels: 100603/640000 (15.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=257975, num_faces=257984
      Valid probs shape: (37, 100603)
    ✓ Random_13 (pose=(-2.9678317258024727, -2.6632061814593495, 0.14955906308701783)): shape (37, 800, 800)
      Valid pixels: 56359/640000 (8.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=256955, num_faces=257984
      Valid probs shape: (37, 56359)
    ✓ Random_14 (pose=(2.9675917218052943, 2.114542020133504, 0.1073698114740429)): shape (37, 800, 800)
      Valid pixels: 69247/640000 (10.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=257982, num_faces=257984
      Valid probs shape: (37, 69247)
    P stats: min=0.0000, max=0.9999, mean=0.0237
    Non-zero vertices: 113124/128994
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 15870  1119  1118  3058     0  1936   955  4501  4927]
  Ground Truth Stats:
    Labels shape: (128994,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-6/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7240
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7955
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7958

  RESULTS:
  RAW:         median(top-10)=0.8759, mean(top-10)=0.8759, median(all)=0.7927, mean(all)=0.7240
  + SMOOTHING: median(top-10)=0.9224, mean(top-10)=0.9203, median(all)=0.8437, mean(all)=0.7955 [+0.0465]
  + MRF:       median(top-10)=0.9228, mean(top-10)=0.9206, median(all)=0.8439, mean(all)=0.7958 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0469

================================================================================
Subject: MMRR-21-7
================================================================================
  Step 0: Generating predictions with V2 model (15 random views)...
  Mesh: 148998 vertices, 297992 faces
  Generating 15 random views...
  Generating predictions for 15 views (continuous camera pose)...
    ✓ Random_0 (pose=(-2.110768691650018, -1.3506120519872518, 1.9507730275762096)): shape (37, 800, 800)
      Valid pixels: 58276/640000 (9.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=35, max=297956, num_faces=297992
      Valid probs shape: (37, 58276)
    ✓ Random_1 (pose=(-2.441936682345334, -2.710657077624426, 2.999138273933907)): shape (37, 800, 800)
      Valid pixels: 69868/640000 (10.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=297892, num_faces=297992
      Valid probs shape: (37, 69868)
    ✓ Random_2 (pose=(0.15994866893632542, 1.9568687281714716, 2.4504657449247977)): shape (37, 800, 800)
      Valid pixels: 68050/640000 (10.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1451, max=297954, num_faces=297992
      Valid probs shape: (37, 68050)
    ✓ Random_3 (pose=(-2.8122747899324883, -0.10747848868614929, -2.1877942723422987)): shape (37, 800, 800)
      Valid pixels: 44953/640000 (7.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=54, max=297986, num_faces=297992
      Valid probs shape: (37, 44953)
    ✓ Random_4 (pose=(-0.8649683473502945, -2.586135011162318, 1.2255753380185652)): shape (37, 800, 800)
      Valid pixels: 55013/640000 (8.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=520, max=297956, num_faces=297992
      Valid probs shape: (37, 55013)
    ✓ Random_5 (pose=(-1.915659275831507, -1.1344877436558902, -0.5475216683744315)): shape (37, 800, 800)
      Valid pixels: 83685/640000 (13.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=297980, num_faces=297992
      Valid probs shape: (37, 83685)
    ✓ Random_6 (pose=(0.6286523487457245, 0.6166728697890345, 0.688072199203305)): shape (37, 800, 800)
      Valid pixels: 50983/640000 (8.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=297689, num_faces=297992
      Valid probs shape: (37, 50983)
    ✓ Random_7 (pose=(-1.912357539395128, -0.957999859522944, -2.6989360009433008)): shape (37, 800, 800)
      Valid pixels: 86711/640000 (13.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=297819, num_faces=297992
      Valid probs shape: (37, 86711)
    ✓ Random_8 (pose=(2.060327045116919, -1.681870106846107, 2.408308564952966)): shape (37, 800, 800)
      Valid pixels: 88285/640000 (13.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=31, max=297991, num_faces=297992
      Valid probs shape: (37, 88285)
    ✓ Random_9 (pose=(1.574250018396394, -1.719699427742597, 2.899427123664613)): shape (37, 800, 800)
      Valid pixels: 88386/640000 (13.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=37, max=297991, num_faces=297992
      Valid probs shape: (37, 88386)
    ✓ Random_10 (pose=(-2.613665515805881, -0.3902088834040214, 1.3506199125840936)): shape (37, 800, 800)
      Valid pixels: 58684/640000 (9.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3230, max=297991, num_faces=297992
      Valid probs shape: (37, 58684)
    ✓ Random_11 (pose=(-0.07307315020175231, -1.6942667532884428, 2.910232907440853)): shape (37, 800, 800)
      Valid pixels: 57547/640000 (9.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6, max=297986, num_faces=297992
      Valid probs shape: (37, 57547)
    ✓ Random_12 (pose=(1.971405248788793, -2.0791762928645743, 2.9724140509353782)): shape (37, 800, 800)
      Valid pixels: 78854/640000 (12.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=5, max=297991, num_faces=297992
      Valid probs shape: (37, 78854)
    ✓ Random_13 (pose=(2.4439940016697115, 2.054653106351294, 1.9954774328055782)): shape (37, 800, 800)
      Valid pixels: 57419/640000 (9.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=297824, num_faces=297992
      Valid probs shape: (37, 57419)
    ✓ Random_14 (pose=(1.0722867781829697, 2.128813493645052, 2.38477507983342)): shape (37, 800, 800)
      Valid pixels: 87568/640000 (13.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=158, max=297991, num_faces=297992
      Valid probs shape: (37, 87568)
    P stats: min=0.0000, max=1.0000, mean=0.0234
    Non-zero vertices: 129034/148998
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 19964  1016  1385  3119     0  2082  1118  4446  5798]
  Ground Truth Stats:
    Labels shape: (148998,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-7/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7569
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8308
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8311

  RESULTS:
  RAW:         median(top-10)=0.8832, mean(top-10)=0.8831, median(all)=0.8051, mean(all)=0.7569
  + SMOOTHING: median(top-10)=0.9338, mean(top-10)=0.9274, median(all)=0.8756, mean(all)=0.8308 [+0.0506]
  + MRF:       median(top-10)=0.9344, mean(top-10)=0.9279, median(all)=0.8765, mean(all)=0.8311 [+0.0006]
  TOTAL IMPROVEMENT (median top-10): +0.0512

================================================================================
Subject: MMRR-21-8
================================================================================
  Step 0: Generating predictions with V2 model (15 random views)...
  Mesh: 124399 vertices, 248794 faces
  Generating 15 random views...
  Generating predictions for 15 views (continuous camera pose)...
    ✓ Random_0 (pose=(-0.8690483848421424, 0.984792740772507, 2.472583000119104)): shape (37, 800, 800)
      Valid pixels: 67257/640000 (10.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=10, max=248793, num_faces=248794
      Valid probs shape: (37, 67257)
    ✓ Random_1 (pose=(-2.186778040404767, 0.8968713475032049, -2.9044625001286932)): shape (37, 800, 800)
      Valid pixels: 73813/640000 (11.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7, max=248778, num_faces=248794
      Valid probs shape: (37, 73813)
    ✓ Random_2 (pose=(0.6425721991203224, 1.1129005533882896, 0.9439644597855095)): shape (37, 800, 800)
      Valid pixels: 67410/640000 (10.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=248556, num_faces=248794
      Valid probs shape: (37, 67410)
    ✓ Random_3 (pose=(-2.925810143112671, 1.708889867107497, -0.4621046993646498)): shape (37, 800, 800)
      Valid pixels: 70438/640000 (11.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=248791, num_faces=248794
      Valid probs shape: (37, 70438)
    ✓ Random_4 (pose=(-0.241366580143084, 1.792203483306114, 0.8183122080003455)): shape (37, 800, 800)
      Valid pixels: 96531/640000 (15.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=76, max=248573, num_faces=248794
      Valid probs shape: (37, 96531)
    ✓ Random_5 (pose=(0.8621822527311354, 0.9012217478897488, -0.860894430948326)): shape (37, 800, 800)
      Valid pixels: 94272/640000 (14.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=248793, num_faces=248794
      Valid probs shape: (37, 94272)
    ✓ Random_6 (pose=(1.0732136453890337, 2.959951079977106, -2.2897343428231896)): shape (37, 800, 800)
      Valid pixels: 67781/640000 (10.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3137, max=248790, num_faces=248794
      Valid probs shape: (37, 67781)
    ✓ Random_7 (pose=(-0.26217659790745707, -2.903857233651127, -1.0423271955422724)): shape (37, 800, 800)
      Valid pixels: 60667/640000 (9.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=29450, max=248764, num_faces=248794
      Valid probs shape: (37, 60667)
    ✓ Random_8 (pose=(-2.1895254530580988, -1.832610610670108, -2.139639908073457)): shape (37, 800, 800)
      Valid pixels: 88529/640000 (13.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=248777, num_faces=248794
      Valid probs shape: (37, 88529)
    ✓ Random_9 (pose=(2.585208891722292, 2.913058922978986, -0.7025142818899659)): shape (37, 800, 800)
      Valid pixels: 56695/640000 (8.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=248791, num_faces=248794
      Valid probs shape: (37, 56695)
    ✓ Random_10 (pose=(3.1212433069719205, -0.3371787237252617, 1.55871459726636)): shape (37, 800, 800)
      Valid pixels: 59425/640000 (9.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=29506, max=248793, num_faces=248794
      Valid probs shape: (37, 59425)
    ✓ Random_11 (pose=(0.41424622213691586, 2.9977536576594543, -1.3477663404634315)): shape (37, 800, 800)
      Valid pixels: 51096/640000 (8.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=481, max=248793, num_faces=248794
      Valid probs shape: (37, 51096)
    ✓ Random_12 (pose=(0.3049289959704371, 1.7582093922937165, 1.003128207342475)): shape (37, 800, 800)
      Valid pixels: 90035/640000 (14.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=365, max=248764, num_faces=248794
      Valid probs shape: (37, 90035)
    ✓ Random_13 (pose=(-1.2163088668262299, -2.4603865514539085, -3.047793910481048)): shape (37, 800, 800)
      Valid pixels: 89229/640000 (13.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=35, max=248793, num_faces=248794
      Valid probs shape: (37, 89229)
    ✓ Random_14 (pose=(2.5269675002978778, -0.2668021067952213, 0.1922878412757716)): shape (37, 800, 800)
      Valid pixels: 61868/640000 (9.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=39, max=248790, num_faces=248794
      Valid probs shape: (37, 61868)
    P stats: min=0.0000, max=1.0000, mean=0.0228
    Non-zero vertices: 104923/124399
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 19476   513  1055  2717     0  2151  1044  3781  4368]
  Ground Truth Stats:
    Labels shape: (124399,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-8/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
    MRF iteration 5/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7203
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7914
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7918

  RESULTS:
  RAW:         median(top-10)=0.8726, mean(top-10)=0.8765, median(all)=0.7942, mean(all)=0.7203
  + SMOOTHING: median(top-10)=0.9142, mean(top-10)=0.9145, median(all)=0.8360, mean(all)=0.7914 [+0.0416]
  + MRF:       median(top-10)=0.9145, mean(top-10)=0.9146, median(all)=0.8375, mean(all)=0.7918 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0419

================================================================================
Subject: MMRR-21-9
================================================================================
  Step 0: Generating predictions with V2 model (15 random views)...
  Mesh: 131827 vertices, 263650 faces
  Generating 15 random views...
  Generating predictions for 15 views (continuous camera pose)...
    ✓ Random_0 (pose=(-2.2387899015381243, 1.5520503054767225, 2.773061503225108)): shape (37, 800, 800)
      Valid pixels: 93644/640000 (14.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=27, max=263645, num_faces=263650
      Valid probs shape: (37, 93644)
    ✓ Random_1 (pose=(-2.386601414235254, -2.9548740567214575, 0.7415458241148216)): shape (37, 800, 800)
      Valid pixels: 67033/640000 (10.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=263422, num_faces=263650
      Valid probs shape: (37, 67033)
    ✓ Random_2 (pose=(-2.238101918643604, 0.13341805255833394, 3.134467928312217)): shape (37, 800, 800)
      Valid pixels: 82466/640000 (12.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=232, max=263649, num_faces=263650
      Valid probs shape: (37, 82466)
    ✓ Random_3 (pose=(-1.95321302675118, -0.2967837823246193, 1.6247316841906931)): shape (37, 800, 800)
      Valid pixels: 67015/640000 (10.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=229, max=263646, num_faces=263650
      Valid probs shape: (37, 67015)
    ✓ Random_4 (pose=(2.405533560088206, -0.9312757439514732, -2.3616826081065714)): shape (37, 800, 800)
      Valid pixels: 66127/640000 (10.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=612, max=263647, num_faces=263650
      Valid probs shape: (37, 66127)
    ✓ Random_5 (pose=(1.3129817895546099, -2.2665950824391246, 2.214686720109097)): shape (37, 800, 800)
      Valid pixels: 83769/640000 (13.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=38, max=263649, num_faces=263650
      Valid probs shape: (37, 83769)
    ✓ Random_6 (pose=(0.0740669198149635, -0.9736411809312613, 3.077897892229883)): shape (37, 800, 800)
      Valid pixels: 61606/640000 (9.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=263639, num_faces=263650
      Valid probs shape: (37, 61606)
    ✓ Random_7 (pose=(-0.9169792531621765, -1.696379778565866, -0.41198027137974025)): shape (37, 800, 800)
      Valid pixels: 88918/640000 (13.9%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=17, max=263648, num_faces=263650
      Valid probs shape: (37, 88918)
    ✓ Random_8 (pose=(0.1724733442768973, 0.5787358212537006, -1.662443480508948)): shape (37, 800, 800)
      Valid pixels: 69757/640000 (10.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=263649, num_faces=263650
      Valid probs shape: (37, 69757)
    ✓ Random_9 (pose=(-0.7652139941759337, -2.085717376311912, 1.7002121872469393)): shape (37, 800, 800)
      Valid pixels: 98851/640000 (15.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=21, max=263649, num_faces=263650
      Valid probs shape: (37, 98851)
    ✓ Random_10 (pose=(2.9295564084271764, -0.7238925831633263, -1.1397214964802282)): shape (37, 800, 800)
      Valid pixels: 74756/640000 (11.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=599, max=263649, num_faces=263650
      Valid probs shape: (37, 74756)
    ✓ Random_11 (pose=(-1.282260891749157, 3.0413540266955073, 2.0969410545389193)): shape (37, 800, 800)
      Valid pixels: 88326/640000 (13.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=26, max=263646, num_faces=263650
      Valid probs shape: (37, 88326)
    ✓ Random_12 (pose=(0.5142757379668659, -2.3119704814618585, -1.3350553038725503)): shape (37, 800, 800)
      Valid pixels: 70884/640000 (11.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1776, max=263647, num_faces=263650
      Valid probs shape: (37, 70884)
    ✓ Random_13 (pose=(0.4826475844471356, -0.9097047305277197, 0.16950764146800212)): shape (37, 800, 800)
      Valid pixels: 83373/640000 (13.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=263545, num_faces=263650
      Valid probs shape: (37, 83373)
    ✓ Random_14 (pose=(0.8614607974724855, -2.7989941044369173, -0.30253672330295034)): shape (37, 800, 800)
      Valid pixels: 88598/640000 (13.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=754, max=263649, num_faces=263650
      Valid probs shape: (37, 88598)
    P stats: min=0.0000, max=0.9999, mean=0.0229
    Non-zero vertices: 111681/131827
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 35]
    Pred label counts: [    0 20146   850   998  2738     0  1475  1125  4430  5227]
  Ground Truth Stats:
    Labels shape: (131827,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-9/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7264
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=33
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8077
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=33
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8082

  RESULTS:
  RAW:         median(top-10)=0.8707, mean(top-10)=0.8774, median(all)=0.7683, mean(all)=0.7264
  + SMOOTHING: median(top-10)=0.9252, mean(top-10)=0.9219, median(all)=0.8712, mean(all)=0.8077 [+0.0545]
  + MRF:       median(top-10)=0.9252, mean(top-10)=0.9222, median(all)=0.8717, mean(all)=0.8082 [-0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0545

================================================================================
Subject: MMRR-3T7T-2-1
================================================================================
  Step 0: Generating predictions with V2 model (15 random views)...
  Mesh: 150156 vertices, 300308 faces
  Generating 15 random views...
  Generating predictions for 15 views (continuous camera pose)...
    ✓ Random_0 (pose=(-1.2722301948136736, 1.6502010576947947, -2.967305716663163)): shape (37, 800, 800)
      Valid pixels: 115401/640000 (18.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=300307, num_faces=300308
      Valid probs shape: (37, 115401)
    ✓ Random_1 (pose=(2.9773335789105344, 0.6926006407353107, 2.898714962302071)): shape (37, 800, 800)
      Valid pixels: 55640/640000 (8.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=17978, max=299514, num_faces=300308
      Valid probs shape: (37, 55640)
    ✓ Random_2 (pose=(0.09799168354342358, -1.3176428478990199, 1.940143746920934)): shape (37, 800, 800)
      Valid pixels: 94373/640000 (14.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=300307, num_faces=300308
      Valid probs shape: (37, 94373)
    ✓ Random_3 (pose=(1.0323090510930912, -1.5545817116180527, 0.3444097214041726)): shape (37, 800, 800)
      Valid pixels: 116299/640000 (18.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=300307, num_faces=300308
      Valid probs shape: (37, 116299)
    ✓ Random_4 (pose=(0.19068318666685968, 1.9228680780512128, 2.3092818517010043)): shape (37, 800, 800)
      Valid pixels: 86046/640000 (13.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=160, max=300279, num_faces=300308
      Valid probs shape: (37, 86046)
    ✓ Random_5 (pose=(-2.3792934808089656, -2.4606482822873925, -2.347158782662631)): shape (37, 800, 800)
      Valid pixels: 91742/640000 (14.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=300298, num_faces=300308
      Valid probs shape: (37, 91742)
    ✓ Random_6 (pose=(1.8050921247352285, -0.16403443915942129, 1.714995916119376)): shape (37, 800, 800)
      Valid pixels: 75162/640000 (11.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=138, max=300223, num_faces=300308
      Valid probs shape: (37, 75162)
    ✓ Random_7 (pose=(2.303822107273101, -0.7835119027838302, 2.361327629538856)): shape (37, 800, 800)
      Valid pixels: 101065/640000 (15.8%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=461, max=300280, num_faces=300308
      Valid probs shape: (37, 101065)
    ✓ Random_8 (pose=(0.9256023070204966, 2.8228853413482717, -2.0217506952703896)): shape (37, 800, 800)
      Valid pixels: 71092/640000 (11.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2919, max=300279, num_faces=300308
      Valid probs shape: (37, 71092)
    ✓ Random_9 (pose=(-0.24075053814037473, 2.6946898938318435, -2.807588954929172)): shape (37, 800, 800)
      Valid pixels: 74100/640000 (11.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=324, max=300307, num_faces=300308
      Valid probs shape: (37, 74100)
    ✓ Random_10 (pose=(-3.0729484078456966, 2.3074843933937306, -0.4512788831086456)): shape (37, 800, 800)
      Valid pixels: 63556/640000 (9.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=300074, num_faces=300308
      Valid probs shape: (37, 63556)
    ✓ Random_11 (pose=(-0.01977635526708088, 0.2996254388957076, 2.6495802797832653)): shape (37, 800, 800)
      Valid pixels: 52450/640000 (8.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=299529, num_faces=300308
      Valid probs shape: (37, 52450)
    ✓ Random_12 (pose=(0.8550635429268763, 2.363752361859163, 2.2152614362165046)): shape (37, 800, 800)
      Valid pixels: 101865/640000 (15.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=3993, max=300280, num_faces=300308
      Valid probs shape: (37, 101865)
    ✓ Random_13 (pose=(-0.748333355254188, 1.2106780032600248, 0.8765767947376215)): shape (37, 800, 800)
      Valid pixels: 98994/640000 (15.5%)
      Probs stats: min=0.0000, max=0.9994, mean=0.0270
      Face IDs: min=4, max=300279, num_faces=300308
      Valid probs shape: (37, 98994)
    ✓ Random_14 (pose=(2.1369752638479875, -2.566583710822986, 1.5150858733692738)): shape (37, 800, 800)
      Valid pixels: 81201/640000 (12.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=300257, num_faces=300308
      Valid probs shape: (37, 81201)
    P stats: min=0.0000, max=1.0000, mean=0.0238
    Non-zero vertices: 132246/150156
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 17910  1559  1170  3890     0  1434  1116  5300  6308]
  Ground Truth Stats:
    Labels shape: (150156,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-3T7T-2-1/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7230
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8061
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8063

  RESULTS:
  RAW:         median(top-10)=0.8781, mean(top-10)=0.8760, median(all)=0.7890, mean(all)=0.7230
  + SMOOTHING: median(top-10)=0.9228, mean(top-10)=0.9268, median(all)=0.8515, mean(all)=0.8061 [+0.0447]
  + MRF:       median(top-10)=0.9230, mean(top-10)=0.9269, median(all)=0.8523, mean(all)=0.8063 [+0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0448

================================================================================
Subject: MMRR-3T7T-2-2
================================================================================
  Step 0: Generating predictions with V2 model (15 random views)...
  Mesh: 135252 vertices, 270500 faces
  Generating 15 random views...
  Generating predictions for 15 views (continuous camera pose)...
    ✓ Random_0 (pose=(2.4582915712383206, -0.43142090428402335, -2.4221346593737323)): shape (37, 800, 800)
      Valid pixels: 60382/640000 (9.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1933, max=270498, num_faces=270500
      Valid probs shape: (37, 60382)
    ✓ Random_1 (pose=(3.108318748513655, 1.082747957866057, -1.1290272916625916)): shape (37, 800, 800)
      Valid pixels: 76102/640000 (11.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=661, max=270498, num_faces=270500
      Valid probs shape: (37, 76102)
    ✓ Random_2 (pose=(-0.6240912855207346, 2.7140936115595604, 0.9219806672100486)): shape (37, 800, 800)
      Valid pixels: 70355/640000 (11.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2755, max=270499, num_faces=270500
      Valid probs shape: (37, 70355)
    ✓ Random_3 (pose=(-3.001725255864772, 1.3642280342080735, -1.1066450391901879)): shape (37, 800, 800)
      Valid pixels: 82895/640000 (13.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=53, max=270498, num_faces=270500
      Valid probs shape: (37, 82895)
    ✓ Random_4 (pose=(-1.0319629111216013, -2.569871640377145, 0.995006607444628)): shape (37, 800, 800)
      Valid pixels: 64954/640000 (10.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1327, max=270491, num_faces=270500
      Valid probs shape: (37, 64954)
    ✓ Random_5 (pose=(-1.158790259792522, -0.1940634434160846, -1.7742005364510993)): shape (37, 800, 800)
      Valid pixels: 60163/640000 (9.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=270495, num_faces=270500
      Valid probs shape: (37, 60163)
    ✓ Random_6 (pose=(-1.8469633050212622, 1.6642756126418368, 1.9724937855022118)): shape (37, 800, 800)
      Valid pixels: 92801/640000 (14.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=270446, num_faces=270500
      Valid probs shape: (37, 92801)
    ✓ Random_7 (pose=(-3.045077486708767, 1.5178714701276457, -1.2675226455553652)): shape (37, 800, 800)
      Valid pixels: 86246/640000 (13.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=65, max=270499, num_faces=270500
      Valid probs shape: (37, 86246)
    ✓ Random_8 (pose=(1.045585129162368, -0.49722422008164857, -2.324238085190842)): shape (37, 800, 800)
      Valid pixels: 75538/640000 (11.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=270498, num_faces=270500
      Valid probs shape: (37, 75538)
    ✓ Random_9 (pose=(1.0819820146379557, 0.21044320373457337, -2.7252371891449405)): shape (37, 800, 800)
      Valid pixels: 75555/640000 (11.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=270498, num_faces=270500
      Valid probs shape: (37, 75555)
    ✓ Random_10 (pose=(-3.073336924053373, -0.28712130592621676, 0.6315766371419174)): shape (37, 800, 800)
      Valid pixels: 58284/640000 (9.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=72478, max=270498, num_faces=270500
      Valid probs shape: (37, 58284)
    ✓ Random_11 (pose=(1.1365659067613372, -2.2372970632394895, -0.24009056781369154)): shape (37, 800, 800)
      Valid pixels: 99664/640000 (15.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=270445, num_faces=270500
      Valid probs shape: (37, 99664)
    ✓ Random_12 (pose=(1.7795467720990894, 0.9234639062112677, 1.2439920725051552)): shape (37, 800, 800)
      Valid pixels: 70087/640000 (11.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=270499, num_faces=270500
      Valid probs shape: (37, 70087)
    ✓ Random_13 (pose=(1.2724597004316287, -2.29523560227331, 2.202876795029101)): shape (37, 800, 800)
      Valid pixels: 78610/640000 (12.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=270499, num_faces=270500
      Valid probs shape: (37, 78610)
    ✓ Random_14 (pose=(-3.078653590560868, 0.2694111686490297, 1.0913269905220648)): shape (37, 800, 800)
      Valid pixels: 54143/640000 (8.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=370, max=270497, num_faces=270500
      Valid probs shape: (37, 54143)
    P stats: min=0.0000, max=0.9999, mean=0.0224
    Non-zero vertices: 112175/135252
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 23077   936   957  3020     0  1311   727  4072  5695]
  Ground Truth Stats:
    Labels shape: (135252,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-3T7T-2-2/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6912
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7794
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7801

  RESULTS:
  RAW:         median(top-10)=0.8484, mean(top-10)=0.8491, median(all)=0.7432, mean(all)=0.6912
  + SMOOTHING: median(top-10)=0.9068, mean(top-10)=0.9064, median(all)=0.8239, mean(all)=0.7794 [+0.0584]
  + MRF:       median(top-10)=0.9072, mean(top-10)=0.9071, median(all)=0.8242, mean(all)=0.7801 [+0.0004]
  TOTAL IMPROVEMENT (median top-10): +0.0588

================================================================================
Subject: NKI-RS-22-1
================================================================================
  Step 0: Generating predictions with V2 model (15 random views)...
  Mesh: 137338 vertices, 274672 faces
  Generating 15 random views...
  Generating predictions for 15 views (continuous camera pose)...
    ✓ Random_0 (pose=(-0.14373604276786178, 2.8060780723934693, 2.0412930222773102)): shape (37, 800, 800)
      Valid pixels: 57678/640000 (9.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2993, max=274671, num_faces=274672
      Valid probs shape: (37, 57678)
    ✓ Random_1 (pose=(-2.4328086899028336, -1.212492969469271, 1.8890678891158306)): shape (37, 800, 800)
      Valid pixels: 73732/640000 (11.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=343, max=274670, num_faces=274672
      Valid probs shape: (37, 73732)
    ✓ Random_2 (pose=(-0.7502062628368806, 1.065314109975172, -0.6213715738725694)): shape (37, 800, 800)
      Valid pixels: 70830/640000 (11.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=273780, num_faces=274672
      Valid probs shape: (37, 70830)
    ✓ Random_3 (pose=(0.08971934889635591, 1.6041539767868116, 2.828620286621466)): shape (37, 800, 800)
      Valid pixels: 70956/640000 (11.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=195, max=274671, num_faces=274672
      Valid probs shape: (37, 70956)
    ✓ Random_4 (pose=(-1.1525996419976134, -2.3447166634952668, -1.2496784569744035)): shape (37, 800, 800)
      Valid pixels: 89307/640000 (14.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=450, max=274670, num_faces=274672
      Valid probs shape: (37, 89307)
    ✓ Random_5 (pose=(-3.0508522590473843, -0.5514036252968224, 1.1706265389936847)): shape (37, 800, 800)
      Valid pixels: 71947/640000 (11.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=17107, max=274671, num_faces=274672
      Valid probs shape: (37, 71947)
    ✓ Random_6 (pose=(-1.646028199218715, 3.0517567215171653, 0.41384051004409406)): shape (37, 800, 800)
      Valid pixels: 83302/640000 (13.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=66, max=274670, num_faces=274672
      Valid probs shape: (37, 83302)
    ✓ Random_7 (pose=(2.9312953076972352, 0.2762407741395676, 0.3812317965540477)): shape (37, 800, 800)
      Valid pixels: 57365/640000 (9.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2912, max=274671, num_faces=274672
      Valid probs shape: (37, 57365)
    ✓ Random_8 (pose=(0.3084641121678806, 3.03237338001776, -1.867231083048875)): shape (37, 800, 800)
      Valid pixels: 49696/640000 (7.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3768, max=274670, num_faces=274672
      Valid probs shape: (37, 49696)
    ✓ Random_9 (pose=(-2.1447240817319875, -3.130627030317737, -1.9988910119987289)): shape (37, 800, 800)
      Valid pixels: 67389/640000 (10.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=274117, num_faces=274672
      Valid probs shape: (37, 67389)
    ✓ Random_10 (pose=(-1.2132302382992748, 1.1827579122848277, -2.874520811895247)): shape (37, 800, 800)
      Valid pixels: 102529/640000 (16.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=274670, num_faces=274672
      Valid probs shape: (37, 102529)
    ✓ Random_11 (pose=(-2.116931467196831, -1.141887590041055, 2.053849954090608)): shape (37, 800, 800)
      Valid pixels: 68491/640000 (10.7%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=324, max=274671, num_faces=274672
      Valid probs shape: (37, 68491)
    ✓ Random_12 (pose=(1.898493894151171, 2.8064800877138936, -3.0812692193482154)): shape (37, 800, 800)
      Valid pixels: 93352/640000 (14.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=274664, num_faces=274672
      Valid probs shape: (37, 93352)
    ✓ Random_13 (pose=(-0.6889719995078796, 0.6391736516823197, 2.4422718052376897)): shape (37, 800, 800)
      Valid pixels: 58126/640000 (9.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=27, max=274669, num_faces=274672
      Valid probs shape: (37, 58126)
    ✓ Random_14 (pose=(-1.827879677634062, 1.316255623857007, -2.750601984504328)): shape (37, 800, 800)
      Valid pixels: 83115/640000 (13.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=21, max=274111, num_faces=274672
      Valid probs shape: (37, 83115)
    P stats: min=0.0000, max=1.0000, mean=0.0236
    Non-zero vertices: 119981/137338
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 17357  1013   871  3369     0  2286  1127  4266  5182]
  Ground Truth Stats:
    Labels shape: (137338,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-1/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
    MRF iteration 5/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7293
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7959
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7960

  RESULTS:
  RAW:         median(top-10)=0.8640, mean(top-10)=0.8702, median(all)=0.7858, mean(all)=0.7293
  + SMOOTHING: median(top-10)=0.9193, mean(top-10)=0.9229, median(all)=0.8436, mean(all)=0.7959 [+0.0554]
  + MRF:       median(top-10)=0.9198, mean(top-10)=0.9231, median(all)=0.8441, mean(all)=0.7960 [+0.0004]
  TOTAL IMPROVEMENT (median top-10): +0.0558

================================================================================
Subject: NKI-RS-22-10
================================================================================
  Step 0: Generating predictions with V2 model (15 random views)...
  Mesh: 130448 vertices, 260892 faces
  Generating 15 random views...
  Generating predictions for 15 views (continuous camera pose)...
    ✓ Random_0 (pose=(1.3127538919291961, 0.5465795481062421, 1.2179507913627443)): shape (37, 800, 800)
      Valid pixels: 67545/640000 (10.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=260885, num_faces=260892
      Valid probs shape: (37, 67545)
    ✓ Random_1 (pose=(2.2671051928695913, 0.7936596288749662, -0.8707717252302145)): shape (37, 800, 800)
      Valid pixels: 74527/640000 (11.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=177, max=260891, num_faces=260892
      Valid probs shape: (37, 74527)
    ✓ Random_2 (pose=(0.5899387692939331, 1.1099298860768583, -2.2956307710213224)): shape (37, 800, 800)
      Valid pixels: 68415/640000 (10.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=0, max=260890, num_faces=260892
      Valid probs shape: (37, 68415)
    ✓ Random_3 (pose=(-2.6793359950772597, -1.3670771287056933, -2.2450804757910703)): shape (37, 800, 800)
      Valid pixels: 111980/640000 (17.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=52, max=260885, num_faces=260892
      Valid probs shape: (37, 111980)
    ✓ Random_4 (pose=(-0.7561835174035845, 2.719359438590054, 1.0582377944684112)): shape (37, 800, 800)
      Valid pixels: 79056/640000 (12.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5555, max=260891, num_faces=260892
      Valid probs shape: (37, 79056)
    ✓ Random_5 (pose=(1.7251614053898514, -0.4190764633202493, -3.0180966620942713)): shape (37, 800, 800)
      Valid pixels: 97908/640000 (15.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=260805, num_faces=260892
      Valid probs shape: (37, 97908)
    ✓ Random_6 (pose=(-0.9465095676887834, 0.8944810898579201, 2.0683138364866336)): shape (37, 800, 800)
      Valid pixels: 63001/640000 (9.8%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=10, max=260890, num_faces=260892
      Valid probs shape: (37, 63001)
    ✓ Random_7 (pose=(0.25104675158417855, -0.16892634258393757, 0.3390980631146405)): shape (37, 800, 800)
      Valid pixels: 56825/640000 (8.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=260884, num_faces=260892
      Valid probs shape: (37, 56825)
    ✓ Random_8 (pose=(2.8646419964667693, -1.8542413441174201, -2.4450815426648127)): shape (37, 800, 800)
      Valid pixels: 82777/640000 (12.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=260890, num_faces=260892
      Valid probs shape: (37, 82777)
    ✓ Random_9 (pose=(-1.7099748907041783, 0.3064071394732988, 2.928879942002694)): shape (37, 800, 800)
      Valid pixels: 112111/640000 (17.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=52, max=260891, num_faces=260892
      Valid probs shape: (37, 112111)
    ✓ Random_10 (pose=(-2.9969597459207873, -0.015478856329891766, -2.3803502020514276)): shape (37, 800, 800)
      Valid pixels: 47189/640000 (7.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5835, max=260891, num_faces=260892
      Valid probs shape: (37, 47189)
    ✓ Random_11 (pose=(-1.5453081796856207, -0.45108865674409815, 2.980095837554546)): shape (37, 800, 800)
      Valid pixels: 112176/640000 (17.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=18, max=260885, num_faces=260892
      Valid probs shape: (37, 112176)
    ✓ Random_12 (pose=(-2.634461886321813, 1.2108817971912176, -1.1850849657364466)): shape (37, 800, 800)
      Valid pixels: 102549/640000 (16.0%)
      Probs stats: min=0.0000, max=0.9995, mean=0.0270
      Face IDs: min=63, max=260805, num_faces=260892
      Valid probs shape: (37, 102549)
    ✓ Random_13 (pose=(-2.8292528632906286, 1.8609752385790728, -1.471802131299667)): shape (37, 800, 800)
      Valid pixels: 103220/640000 (16.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=5, max=260804, num_faces=260892
      Valid probs shape: (37, 103220)
    ✓ Random_14 (pose=(0.44573973566662817, -0.3173680753900703, 1.1911038025676914)): shape (37, 800, 800)
      Valid pixels: 67362/640000 (10.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=260884, num_faces=260892
      Valid probs shape: (37, 67362)
    P stats: min=0.0000, max=1.0000, mean=0.0233
    Non-zero vertices: 112312/130448
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 18136  1503   902  2250     0  1574   769  3963  5824]
  Ground Truth Stats:
    Labels shape: (130448,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-10/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7478
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8327
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8331

  RESULTS:
  RAW:         median(top-10)=0.8501, mean(top-10)=0.8615, median(all)=0.8091, mean(all)=0.7478
  + SMOOTHING: median(top-10)=0.9272, mean(top-10)=0.9270, median(all)=0.8659, mean(all)=0.8327 [+0.0771]
  + MRF:       median(top-10)=0.9277, mean(top-10)=0.9274, median(all)=0.8658, mean(all)=0.8331 [+0.0005]
  TOTAL IMPROVEMENT (median top-10): +0.0776

================================================================================
Subject: NKI-RS-22-11
================================================================================
  Step 0: Generating predictions with V2 model (15 random views)...
  Mesh: 138161 vertices, 276318 faces
  Generating 15 random views...
  Generating predictions for 15 views (continuous camera pose)...
    ✓ Random_0 (pose=(-0.1796873101788412, -1.4428679009490641, -0.2016503188316361)): shape (37, 800, 800)
      Valid pixels: 67868/640000 (10.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=24, max=276315, num_faces=276318
      Valid probs shape: (37, 67868)
    ✓ Random_1 (pose=(-1.7061522875465942, -2.995145336804771, -0.7730945032925565)): shape (37, 800, 800)
      Valid pixels: 90693/640000 (14.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=276299, num_faces=276318
      Valid probs shape: (37, 90693)
    ✓ Random_2 (pose=(1.1063479429596423, 1.3289279864927206, -0.027675023493638484)): shape (37, 800, 800)
      Valid pixels: 89281/640000 (14.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=276235, num_faces=276318
      Valid probs shape: (37, 89281)
    ✓ Random_3 (pose=(2.810238256167457, 2.2814738194558144, -0.06563726398938607)): shape (37, 800, 800)
      Valid pixels: 62995/640000 (9.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=276317, num_faces=276318
      Valid probs shape: (37, 62995)
    ✓ Random_4 (pose=(1.5768904499930807, 0.5007797124583666, -2.7903622718137098)): shape (37, 800, 800)
      Valid pixels: 84714/640000 (13.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=30, max=276315, num_faces=276318
      Valid probs shape: (37, 84714)
    ✓ Random_5 (pose=(0.4950197941175323, 0.5858962592919341, -1.4395739809074712)): shape (37, 800, 800)
      Valid pixels: 72734/640000 (11.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=276280, num_faces=276318
      Valid probs shape: (37, 72734)
    ✓ Random_6 (pose=(2.076783208547999, 2.9385019414377735, 1.1505774145998968)): shape (37, 800, 800)
      Valid pixels: 65972/640000 (10.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=276242, num_faces=276318
      Valid probs shape: (37, 65972)
    ✓ Random_7 (pose=(0.8758113775570662, -0.18701125622714132, -0.3474026514088955)): shape (37, 800, 800)
      Valid pixels: 81975/640000 (12.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=276315, num_faces=276318
      Valid probs shape: (37, 81975)
    ✓ Random_8 (pose=(-2.0023481766980735, 2.2451392432874178, -0.8066079819934266)): shape (37, 800, 800)
      Valid pixels: 94185/640000 (14.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=7, max=276317, num_faces=276318
      Valid probs shape: (37, 94185)
    ✓ Random_9 (pose=(1.8196624491638067, -1.1070767045824117, -2.836548948729213)): shape (37, 800, 800)
      Valid pixels: 81124/640000 (12.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=54, max=276314, num_faces=276318
      Valid probs shape: (37, 81124)
    ✓ Random_10 (pose=(-1.0633645236347125, 2.6722508784845047, -2.752978069602867)): shape (37, 800, 800)
      Valid pixels: 88665/640000 (13.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=85, max=276236, num_faces=276318
      Valid probs shape: (37, 88665)
    ✓ Random_11 (pose=(1.4231588590531885, 1.5730532721883517, 2.879721254497814)): shape (37, 800, 800)
      Valid pixels: 94745/640000 (14.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8, max=276315, num_faces=276318
      Valid probs shape: (37, 94745)
    ✓ Random_12 (pose=(-1.5591507182031183, -1.563105006068235, 3.125739877796545)): shape (37, 800, 800)
      Valid pixels: 100249/640000 (15.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=41, max=276242, num_faces=276318
      Valid probs shape: (37, 100249)
    ✓ Random_13 (pose=(-0.9611392835339352, -2.173517909519882, -0.35837692643252783)): shape (37, 800, 800)
      Valid pixels: 89020/640000 (13.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=46, max=276313, num_faces=276318
      Valid probs shape: (37, 89020)
    ✓ Random_14 (pose=(-0.5344408545474719, -0.5820725786711827, 0.06175655907587929)): shape (37, 800, 800)
      Valid pixels: 60546/640000 (9.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=276232, num_faces=276318
      Valid probs shape: (37, 60546)
    P stats: min=0.0000, max=0.9999, mean=0.0228
    Non-zero vertices: 116636/138161
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 21525  1435  1236  2885     0  2231   982  3846  5404]
  Ground Truth Stats:
    Labels shape: (138161,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-11/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7512
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8372
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8375

  RESULTS:
  RAW:         median(top-10)=0.8722, mean(top-10)=0.8770, median(all)=0.8038, mean(all)=0.7512
  + SMOOTHING: median(top-10)=0.9262, mean(top-10)=0.9311, median(all)=0.8929, mean(all)=0.8372 [+0.0539]
  + MRF:       median(top-10)=0.9267, mean(top-10)=0.9314, median(all)=0.8929, mean(all)=0.8375 [+0.0005]
  TOTAL IMPROVEMENT (median top-10): +0.0544

================================================================================
Subject: NKI-RS-22-12
================================================================================
  Step 0: Generating predictions with V2 model (15 random views)...
  Mesh: 144832 vertices, 289660 faces
  Generating 15 random views...
  Generating predictions for 15 views (continuous camera pose)...
    ✓ Random_0 (pose=(0.7392997474778005, -1.0529921437989058, -2.038237561672217)): shape (37, 800, 800)
      Valid pixels: 71590/640000 (11.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=6, max=289655, num_faces=289660
      Valid probs shape: (37, 71590)
    ✓ Random_1 (pose=(0.8170139682811017, -1.2209038005285584, -0.914595263089943)): shape (37, 800, 800)
      Valid pixels: 62329/640000 (9.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=289547, num_faces=289660
      Valid probs shape: (37, 62329)
    ✓ Random_2 (pose=(-2.249810533953497, -0.13052362971777764, 0.08553063049040466)): shape (37, 800, 800)
      Valid pixels: 77849/640000 (12.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2166, max=289650, num_faces=289660
      Valid probs shape: (37, 77849)
    ✓ Random_3 (pose=(-1.0312549102491242, 0.20543288935927118, 3.1355020769923723)): shape (37, 800, 800)
      Valid pixels: 84185/640000 (13.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=289646, num_faces=289660
      Valid probs shape: (37, 84185)
    ✓ Random_4 (pose=(0.569430364542113, 1.163640594068637, 0.09959663490323534)): shape (37, 800, 800)
      Valid pixels: 63792/640000 (10.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=289647, num_faces=289660
      Valid probs shape: (37, 63792)
    ✓ Random_5 (pose=(1.204541677930826, -0.0804503467708444, 2.116681609212363)): shape (37, 800, 800)
      Valid pixels: 81212/640000 (12.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=289650, num_faces=289660
      Valid probs shape: (37, 81212)
    ✓ Random_6 (pose=(0.2424711381222675, -1.2929702115473252, 2.152840913627297)): shape (37, 800, 800)
      Valid pixels: 67815/640000 (10.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=8, max=289648, num_faces=289660
      Valid probs shape: (37, 67815)
    ✓ Random_7 (pose=(-1.6262031940335124, 0.2976181075608366, 2.923107372652966)): shape (37, 800, 800)
      Valid pixels: 96003/640000 (15.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=34, max=289648, num_faces=289660
      Valid probs shape: (37, 96003)
    ✓ Random_8 (pose=(0.9417035088491152, 3.021909939554397, -1.2351265741724158)): shape (37, 800, 800)
      Valid pixels: 72496/640000 (11.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1722, max=289648, num_faces=289660
      Valid probs shape: (37, 72496)
    ✓ Random_9 (pose=(1.769712352336346, 0.5983100221199176, -0.24236073310943818)): shape (37, 800, 800)
      Valid pixels: 96144/640000 (15.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=31, max=289648, num_faces=289660
      Valid probs shape: (37, 96144)
    ✓ Random_10 (pose=(-1.1034560307143448, -3.0168682214129725, 0.8047780082426401)): shape (37, 800, 800)
      Valid pixels: 66171/640000 (10.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=539, max=289658, num_faces=289660
      Valid probs shape: (37, 66171)
    ✓ Random_11 (pose=(-2.024853022142427, -0.13762748729381302, -0.8683710043033588)): shape (37, 800, 800)
      Valid pixels: 82902/640000 (13.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=547, max=289650, num_faces=289660
      Valid probs shape: (37, 82902)
    ✓ Random_12 (pose=(-3.0606450899550817, 1.292123840802586, 0.4082278835601101)): shape (37, 800, 800)
      Valid pixels: 77968/640000 (12.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=181, max=289656, num_faces=289660
      Valid probs shape: (37, 77968)
    ✓ Random_13 (pose=(-1.448087539293885, -0.33961918146182457, -1.4339555127891463)): shape (37, 800, 800)
      Valid pixels: 70824/640000 (11.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=289650, num_faces=289660
      Valid probs shape: (37, 70824)
    ✓ Random_14 (pose=(2.662146728952113, -0.5276035536602355, 2.385989756118673)): shape (37, 800, 800)
      Valid pixels: 71743/640000 (11.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=8772, max=289657, num_faces=289660
      Valid probs shape: (37, 71743)
    P stats: min=0.0000, max=0.9999, mean=0.0238
    Non-zero vertices: 127663/144832
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 17169  1009  1207  2702     0  2423   909  4282  5150]
  Ground Truth Stats:
    Labels shape: (144832,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-12/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7560
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8313
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8316

  RESULTS:
  RAW:         median(top-10)=0.8811, mean(top-10)=0.8878, median(all)=0.8250, mean(all)=0.7560
  + SMOOTHING: median(top-10)=0.9298, mean(top-10)=0.9304, median(all)=0.8753, mean(all)=0.8313 [+0.0488]
  + MRF:       median(top-10)=0.9302, mean(top-10)=0.9306, median(all)=0.8756, mean(all)=0.8316 [+0.0004]
  TOTAL IMPROVEMENT (median top-10): +0.0491

================================================================================
Subject: NKI-RS-22-13
================================================================================
  Step 0: Generating predictions with V2 model (15 random views)...
  Mesh: 121451 vertices, 242898 faces
  Generating 15 random views...
  Generating predictions for 15 views (continuous camera pose)...
    ✓ Random_0 (pose=(-0.802660540703382, -2.7033418234934965, -1.5534687403199945)): shape (37, 800, 800)
      Valid pixels: 63762/640000 (10.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=12904, max=241821, num_faces=242898
      Valid probs shape: (37, 63762)
    ✓ Random_1 (pose=(1.8811250933740542, -2.378420115985259, -1.1072203974571124)): shape (37, 800, 800)
      Valid pixels: 82501/640000 (12.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=18, max=242887, num_faces=242898
      Valid probs shape: (37, 82501)
    ✓ Random_2 (pose=(-1.6165315229979051, 2.6565616811713966, -0.5859360876013926)): shape (37, 800, 800)
      Valid pixels: 90275/640000 (14.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=11, max=241822, num_faces=242898
      Valid probs shape: (37, 90275)
    ✓ Random_3 (pose=(-0.9044232030639665, 3.057674250214835, -1.3886262782165415)): shape (37, 800, 800)
      Valid pixels: 53660/640000 (8.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=19950, max=241820, num_faces=242898
      Valid probs shape: (37, 53660)
    ✓ Random_4 (pose=(0.5168680418668261, -2.133554665658015, -1.0793932836955276)): shape (37, 800, 800)
      Valid pixels: 62149/640000 (9.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1239, max=242896, num_faces=242898
      Valid probs shape: (37, 62149)
    ✓ Random_5 (pose=(2.0973778223042716, 1.04866867075157, 0.7569469783318099)): shape (37, 800, 800)
      Valid pixels: 82879/640000 (12.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=242360, num_faces=242898
      Valid probs shape: (37, 82879)
    ✓ Random_6 (pose=(2.252423329483336, 3.0231795073504655, 2.148079761583582)): shape (37, 800, 800)
      Valid pixels: 65336/640000 (10.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=241820, num_faces=242898
      Valid probs shape: (37, 65336)
    ✓ Random_7 (pose=(2.4958498326745273, 1.4237293771887574, 1.4021366048290158)): shape (37, 800, 800)
      Valid pixels: 78505/640000 (12.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=147, max=242360, num_faces=242898
      Valid probs shape: (37, 78505)
    ✓ Random_8 (pose=(0.10665817553780688, 0.49771923514985117, -2.409108660214934)): shape (37, 800, 800)
      Valid pixels: 47476/640000 (7.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=242896, num_faces=242898
      Valid probs shape: (37, 47476)
    ✓ Random_9 (pose=(0.8277271255219478, -0.7314830047771879, 2.333077419455371)): shape (37, 800, 800)
      Valid pixels: 58472/640000 (9.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=241468, num_faces=242898
      Valid probs shape: (37, 58472)
    ✓ Random_10 (pose=(-2.1311928894499794, 0.27990089643757576, 1.512390707968044)): shape (37, 800, 800)
      Valid pixels: 56391/640000 (8.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1265, max=242894, num_faces=242898
      Valid probs shape: (37, 56391)
    ✓ Random_11 (pose=(-0.6891748908772848, 0.6514414584374539, -2.5033969868327053)): shape (37, 800, 800)
      Valid pixels: 74941/640000 (11.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=15, max=242714, num_faces=242898
      Valid probs shape: (37, 74941)
    ✓ Random_12 (pose=(-1.2316211790059939, -1.28560231794079, -2.842339609350513)): shape (37, 800, 800)
      Valid pixels: 74442/640000 (11.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=9, max=242355, num_faces=242898
      Valid probs shape: (37, 74442)
    ✓ Random_13 (pose=(-1.211294150012062, 1.1096507921952892, 1.6552089089492341)): shape (37, 800, 800)
      Valid pixels: 59147/640000 (9.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=21, max=242897, num_faces=242898
      Valid probs shape: (37, 59147)
    ✓ Random_14 (pose=(-0.6332857142095731, 1.8923498084341368, -2.2095217907555846)): shape (37, 800, 800)
      Valid pixels: 89615/640000 (14.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=242887, num_faces=242898
      Valid probs shape: (37, 89615)
    P stats: min=0.0000, max=1.0000, mean=0.0230
    Non-zero vertices: 103321/121451
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 18130   318   953  2045     0  2048  1024  3724  4136]
  Ground Truth Stats:
    Labels shape: (121451,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-13/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7138
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7821
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7826

  RESULTS:
  RAW:         median(top-10)=0.8657, mean(top-10)=0.8787, median(all)=0.7926, mean(all)=0.7138
  + SMOOTHING: median(top-10)=0.9084, mean(top-10)=0.9109, median(all)=0.8504, mean(all)=0.7821 [+0.0427]
  + MRF:       median(top-10)=0.9085, mean(top-10)=0.9111, median(all)=0.8508, mean(all)=0.7826 [+0.0000]
  TOTAL IMPROVEMENT (median top-10): +0.0427

================================================================================
Subject: NKI-RS-22-14
================================================================================
  Step 0: Generating predictions with V2 model (15 random views)...
  Mesh: 142823 vertices, 285642 faces
  Generating 15 random views...
  Generating predictions for 15 views (continuous camera pose)...
    ✓ Random_0 (pose=(-0.7641316833337868, -3.0630634470090174, -2.3114930293982883)): shape (37, 800, 800)
      Valid pixels: 58223/640000 (9.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=456, max=285638, num_faces=285642
      Valid probs shape: (37, 58223)
    ✓ Random_1 (pose=(2.0324584100939145, -0.9690559982722835, 0.08392162380665447)): shape (37, 800, 800)
      Valid pixels: 75677/640000 (11.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=285638, num_faces=285642
      Valid probs shape: (37, 75677)
    ✓ Random_2 (pose=(1.0922385566978248, -1.4845057304445823, 1.213489466365064)): shape (37, 800, 800)
      Valid pixels: 70720/640000 (11.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6, max=285638, num_faces=285642
      Valid probs shape: (37, 70720)
    ✓ Random_3 (pose=(2.3427134698249352, 1.4545078468711115, -1.8418823733627456)): shape (37, 800, 800)
      Valid pixels: 71584/640000 (11.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=18, max=285641, num_faces=285642
      Valid probs shape: (37, 71584)
    ✓ Random_4 (pose=(2.265575917469558, -1.790764979877655, -1.5187070836801662)): shape (37, 800, 800)
      Valid pixels: 84357/640000 (13.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7, max=285641, num_faces=285642
      Valid probs shape: (37, 84357)
    ✓ Random_5 (pose=(-0.027916889634049813, -0.8763483953267128, 1.019630364697817)): shape (37, 800, 800)
      Valid pixels: 72367/640000 (11.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=285641, num_faces=285642
      Valid probs shape: (37, 72367)
    ✓ Random_6 (pose=(-2.1964941351360916, 0.3478219868062231, -0.30028414642981227)): shape (37, 800, 800)
      Valid pixels: 77480/640000 (12.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=503, max=285633, num_faces=285642
      Valid probs shape: (37, 77480)
    ✓ Random_7 (pose=(1.6035620898380465, 1.4838117030973645, -0.1367796172775524)): shape (37, 800, 800)
      Valid pixels: 91050/640000 (14.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=285641, num_faces=285642
      Valid probs shape: (37, 91050)
    ✓ Random_8 (pose=(-0.3993864341300628, 1.6820094980479006, -1.3989605554781417)): shape (37, 800, 800)
      Valid pixels: 74034/640000 (11.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=285638, num_faces=285642
      Valid probs shape: (37, 74034)
    ✓ Random_9 (pose=(-1.8077874318832414, -2.9390346141072885, 1.484723018554198)): shape (37, 800, 800)
      Valid pixels: 61567/640000 (9.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=12, max=285641, num_faces=285642
      Valid probs shape: (37, 61567)
    ✓ Random_10 (pose=(0.21236105169626684, 2.7729748438807773, -2.611417431889514)): shape (37, 800, 800)
      Valid pixels: 37246/640000 (5.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3564, max=285641, num_faces=285642
      Valid probs shape: (37, 37246)
    ✓ Random_11 (pose=(-2.5033393695993844, 2.474011328567851, -1.529267096965511)): shape (37, 800, 800)
      Valid pixels: 68018/640000 (10.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=285097, num_faces=285642
      Valid probs shape: (37, 68018)
    ✓ Random_12 (pose=(2.9243395928755556, 0.9438492127316511, 1.2298399763976358)): shape (37, 800, 800)
      Valid pixels: 75674/640000 (11.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=159, max=285638, num_faces=285642
      Valid probs shape: (37, 75674)
    ✓ Random_13 (pose=(1.8972743699245456, -1.2839003759531222, -0.8502291848201535)): shape (37, 800, 800)
      Valid pixels: 90360/640000 (14.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6, max=285640, num_faces=285642
      Valid probs shape: (37, 90360)
    ✓ Random_14 (pose=(-0.19225396028635489, 0.33158718470618, -3.1292034592164275)): shape (37, 800, 800)
      Valid pixels: 46468/640000 (7.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=285641, num_faces=285642
      Valid probs shape: (37, 46468)
    P stats: min=0.0000, max=0.9999, mean=0.0224
    Non-zero vertices: 118314/142823
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 24509  1044  1133  1896     0  2111  1304  4814  4887]
  Ground Truth Stats:
    Labels shape: (142823,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-14/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7163
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7955
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7956

  RESULTS:
  RAW:         median(top-10)=0.8561, mean(top-10)=0.8673, median(all)=0.7806, mean(all)=0.7163
  + SMOOTHING: median(top-10)=0.9082, mean(top-10)=0.9106, median(all)=0.8562, mean(all)=0.7955 [+0.0521]
  + MRF:       median(top-10)=0.9087, mean(top-10)=0.9109, median(all)=0.8565, mean(all)=0.7956 [+0.0005]
  TOTAL IMPROVEMENT (median top-10): +0.0526

================================================================================
Subject: NKI-RS-22-15
================================================================================
  Step 0: Generating predictions with V2 model (15 random views)...
  Mesh: 158740 vertices, 317476 faces
  Generating 15 random views...
  Generating predictions for 15 views (continuous camera pose)...
    ✓ Random_0 (pose=(1.0809442926625747, 0.7164161466227412, 2.1326025929298638)): shape (37, 800, 800)
      Valid pixels: 102946/640000 (16.1%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=9, max=317095, num_faces=317476
      Valid probs shape: (37, 102946)
    ✓ Random_1 (pose=(2.4577166378129336, 0.21110136858981132, 1.564917823793916)): shape (37, 800, 800)
      Valid pixels: 54362/640000 (8.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4024, max=317451, num_faces=317476
      Valid probs shape: (37, 54362)
    ✓ Random_2 (pose=(2.8856360911390118, 2.438598966186275, 0.6766708087494955)): shape (37, 800, 800)
      Valid pixels: 76454/640000 (11.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=317474, num_faces=317476
      Valid probs shape: (37, 76454)
    ✓ Random_3 (pose=(-0.3221425407506566, 1.1340172575302274, -1.1552821277793572)): shape (37, 800, 800)
      Valid pixels: 80453/640000 (12.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=8, max=317472, num_faces=317476
      Valid probs shape: (37, 80453)
    ✓ Random_4 (pose=(0.6151054347071279, -1.6605197131632263, -1.8648014330332325)): shape (37, 800, 800)
      Valid pixels: 90363/640000 (14.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=0, max=317474, num_faces=317476
      Valid probs shape: (37, 90363)
    ✓ Random_5 (pose=(-1.962180740660868, -0.7667892187062235, -2.467272287865196)): shape (37, 800, 800)
      Valid pixels: 92041/640000 (14.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=238, max=317474, num_faces=317476
      Valid probs shape: (37, 92041)
    ✓ Random_6 (pose=(-0.7159507417775446, 3.092009481322771, 0.8785092317738217)): shape (37, 800, 800)
      Valid pixels: 75445/640000 (11.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6818, max=317475, num_faces=317476
      Valid probs shape: (37, 75445)
    ✓ Random_7 (pose=(0.8145559242377329, 2.5253601726499006, -0.3425104148974496)): shape (37, 800, 800)
      Valid pixels: 91566/640000 (14.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=221, max=317474, num_faces=317476
      Valid probs shape: (37, 91566)
    ✓ Random_8 (pose=(-0.8971510935158542, -2.6929632284014167, -2.9693091710149258)): shape (37, 800, 800)
      Valid pixels: 80942/640000 (12.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=273, max=317475, num_faces=317476
      Valid probs shape: (37, 80942)
    ✓ Random_9 (pose=(0.4736233694931946, 1.4952960162068285, 1.8828545221480102)): shape (37, 800, 800)
      Valid pixels: 102187/640000 (16.0%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=8, max=317428, num_faces=317476
      Valid probs shape: (37, 102187)
    ✓ Random_10 (pose=(0.5341623289194826, 1.0314413588938658, 0.5102828682232485)): shape (37, 800, 800)
      Valid pixels: 68964/640000 (10.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=316320, num_faces=317476
      Valid probs shape: (37, 68964)
    ✓ Random_11 (pose=(0.9740300293978192, -1.9582599503910838, -1.586879786796949)): shape (37, 800, 800)
      Valid pixels: 78893/640000 (12.3%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=1, max=317474, num_faces=317476
      Valid probs shape: (37, 78893)
    ✓ Random_12 (pose=(1.6427499307603446, -0.6443341488857905, -3.080614580518641)): shape (37, 800, 800)
      Valid pixels: 96840/640000 (15.1%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=12, max=317474, num_faces=317476
      Valid probs shape: (37, 96840)
    ✓ Random_13 (pose=(1.5623708995296406, -2.27801426756995, 0.06378347637323989)): shape (37, 800, 800)
      Valid pixels: 106239/640000 (16.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=136, max=317474, num_faces=317476
      Valid probs shape: (37, 106239)
    ✓ Random_14 (pose=(-1.439791871789352, 2.7748151389237563, 1.5777804302427105)): shape (37, 800, 800)
      Valid pixels: 74059/640000 (11.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=317475, num_faces=317476
      Valid probs shape: (37, 74059)
    P stats: min=0.0000, max=0.9999, mean=0.0233
    Non-zero vertices: 136692/158740
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 22048  1078  1297  3818     0  2392  1088  4945  6404]
  Ground Truth Stats:
    Labels shape: (158740,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-15/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7455
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8216
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8219

  RESULTS:
  RAW:         median(top-10)=0.8685, mean(top-10)=0.8656, median(all)=0.7864, mean(all)=0.7455
  + SMOOTHING: median(top-10)=0.9147, mean(top-10)=0.9154, median(all)=0.8617, mean(all)=0.8216 [+0.0462]
  + MRF:       median(top-10)=0.9151, mean(top-10)=0.9158, median(all)=0.8622, mean(all)=0.8219 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0466

================================================================================
Subject: NKI-RS-22-16
================================================================================
  Step 0: Generating predictions with V2 model (15 random views)...
  Mesh: 137370 vertices, 274736 faces
  Generating 15 random views...
  Generating predictions for 15 views (continuous camera pose)...
    ✓ Random_0 (pose=(-3.0897892949108683, -0.6781736075771843, 2.163550334960851)): shape (37, 800, 800)
      Valid pixels: 85157/640000 (13.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=3700, max=274734, num_faces=274736
      Valid probs shape: (37, 85157)
    ✓ Random_1 (pose=(0.31840713136371024, 0.8494803786639737, -1.2173686346359611)): shape (37, 800, 800)
      Valid pixels: 101297/640000 (15.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=274733, num_faces=274736
      Valid probs shape: (37, 101297)
    ✓ Random_2 (pose=(1.2572271826465942, -2.9739053643254496, -2.23997556393445)): shape (37, 800, 800)
      Valid pixels: 89457/640000 (14.0%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=97, max=274731, num_faces=274736
      Valid probs shape: (37, 89457)
    ✓ Random_3 (pose=(-1.6560087410874087, -1.8467367869645486, -2.4280474677725157)): shape (37, 800, 800)
      Valid pixels: 97210/640000 (15.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=274733, num_faces=274736
      Valid probs shape: (37, 97210)
    ✓ Random_4 (pose=(3.124041758200539, -0.42394148793290576, 2.9925058635993267)): shape (37, 800, 800)
      Valid pixels: 62934/640000 (9.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5715, max=274735, num_faces=274736
      Valid probs shape: (37, 62934)
    ✓ Random_5 (pose=(-2.2851142342168664, -1.4467162869242882, 1.0829973970796214)): shape (37, 800, 800)
      Valid pixels: 101400/640000 (15.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=11, max=274664, num_faces=274736
      Valid probs shape: (37, 101400)
    ✓ Random_6 (pose=(2.1582796721702096, 2.6666556274542588, 0.33348470465305535)): shape (37, 800, 800)
      Valid pixels: 107710/640000 (16.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=274733, num_faces=274736
      Valid probs shape: (37, 107710)
    ✓ Random_7 (pose=(1.1958502080391318, 0.3702620578736169, -1.9900563516837073)): shape (37, 800, 800)
      Valid pixels: 75922/640000 (11.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=0, max=274452, num_faces=274736
      Valid probs shape: (37, 75922)
    ✓ Random_8 (pose=(1.0080227986199208, -1.3818913900681202, -2.542146514844109)): shape (37, 800, 800)
      Valid pixels: 109380/640000 (17.1%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=0, max=274661, num_faces=274736
      Valid probs shape: (37, 109380)
    ✓ Random_9 (pose=(-1.6191658202364714, 2.5581616521603543, -2.1874159622666838)): shape (37, 800, 800)
      Valid pixels: 85601/640000 (13.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=274711, num_faces=274736
      Valid probs shape: (37, 85601)
    ✓ Random_10 (pose=(-3.0644494832697977, -2.418068095787878, -1.9983949577355085)): shape (37, 800, 800)
      Valid pixels: 92920/640000 (14.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=274733, num_faces=274736
      Valid probs shape: (37, 92920)
    ✓ Random_11 (pose=(-2.9671303443084147, -1.0601311481126428, 0.40730444953157274)): shape (37, 800, 800)
      Valid pixels: 101169/640000 (15.8%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=10259, max=274735, num_faces=274736
      Valid probs shape: (37, 101169)
    ✓ Random_12 (pose=(-0.177975366723242, 2.09744169686713, -1.8949961440609844)): shape (37, 800, 800)
      Valid pixels: 110947/640000 (17.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=172, max=274733, num_faces=274736
      Valid probs shape: (37, 110947)
    ✓ Random_13 (pose=(3.1321448846599873, -1.4171444593561786, 2.17790853080999)): shape (37, 800, 800)
      Valid pixels: 95893/640000 (15.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=86, max=274664, num_faces=274736
      Valid probs shape: (37, 95893)
    ✓ Random_14 (pose=(2.9702296912111423, 2.743470808226151, -2.654818646118212)): shape (37, 800, 800)
      Valid pixels: 74845/640000 (11.7%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=0, max=272347, num_faces=274736
      Valid probs shape: (37, 74845)
    P stats: min=0.0000, max=0.9999, mean=0.0233
    Non-zero vertices: 118212/137370
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 19158   967  1176  1905     0  1864   828  5025  4752]
  Ground Truth Stats:
    Labels shape: (137370,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-16/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
    MRF iteration 5/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7143
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7871
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7876

  RESULTS:
  RAW:         median(top-10)=0.8489, mean(top-10)=0.8600, median(all)=0.7654, mean(all)=0.7143
  + SMOOTHING: median(top-10)=0.9088, mean(top-10)=0.9115, median(all)=0.8391, mean(all)=0.7871 [+0.0599]
  + MRF:       median(top-10)=0.9086, mean(top-10)=0.9116, median(all)=0.8399, mean(all)=0.7876 [-0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0597

================================================================================
Subject: NKI-RS-22-17
================================================================================
  Step 0: Generating predictions with V2 model (15 random views)...
  Mesh: 161773 vertices, 323542 faces
  Generating 15 random views...
  Generating predictions for 15 views (continuous camera pose)...
    ✓ Random_0 (pose=(0.18172282711382826, -1.662173731519503, -0.005416255354977917)): shape (37, 800, 800)
      Valid pixels: 74961/640000 (11.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=29, max=323540, num_faces=323542
      Valid probs shape: (37, 74961)
    ✓ Random_1 (pose=(1.8580699271581471, 2.7366883465338177, 3.007558816442182)): shape (37, 800, 800)
      Valid pixels: 98622/640000 (15.4%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=11, max=323501, num_faces=323542
      Valid probs shape: (37, 98622)
    ✓ Random_2 (pose=(0.10958334796295865, 2.8089701713947086, -1.4755609081341823)): shape (37, 800, 800)
      Valid pixels: 56636/640000 (8.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1911, max=323504, num_faces=323542
      Valid probs shape: (37, 56636)
    ✓ Random_3 (pose=(-2.929718795802216, 1.8302510161985595, 2.805705114478804)): shape (37, 800, 800)
      Valid pixels: 69199/640000 (10.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=11, max=322968, num_faces=323542
      Valid probs shape: (37, 69199)
    ✓ Random_4 (pose=(2.6581453539810234, 1.6467396653499762, -2.61357682135747)): shape (37, 800, 800)
      Valid pixels: 102470/640000 (16.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=77, max=323475, num_faces=323542
      Valid probs shape: (37, 102470)
    ✓ Random_5 (pose=(0.16762915711719284, 1.0619034086387957, -2.1675602989029663)): shape (37, 800, 800)
      Valid pixels: 89639/640000 (14.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=323541, num_faces=323542
      Valid probs shape: (37, 89639)
    ✓ Random_6 (pose=(0.4141879600372649, -2.894894607864802, 2.14015283757134)): shape (37, 800, 800)
      Valid pixels: 55999/640000 (8.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=68029, max=323534, num_faces=323542
      Valid probs shape: (37, 55999)
    ✓ Random_7 (pose=(-2.9226186945694046, 3.0022729762048668, -1.860544833112806)): shape (37, 800, 800)
      Valid pixels: 53511/640000 (8.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=320682, num_faces=323542
      Valid probs shape: (37, 53511)
    ✓ Random_8 (pose=(-0.8364863597425201, -2.832134451598791, 0.7505659769354249)): shape (37, 800, 800)
      Valid pixels: 66478/640000 (10.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2424, max=323539, num_faces=323542
      Valid probs shape: (37, 66478)
    ✓ Random_9 (pose=(1.8973927626216724, 0.6328904732989864, -0.6451538387570093)): shape (37, 800, 800)
      Valid pixels: 100340/640000 (15.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=254, max=323540, num_faces=323542
      Valid probs shape: (37, 100340)
    ✓ Random_10 (pose=(-0.27695318722274953, 1.2310693062966411, -2.820021013162635)): shape (37, 800, 800)
      Valid pixels: 91693/640000 (14.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=9, max=323541, num_faces=323542
      Valid probs shape: (37, 91693)
    ✓ Random_11 (pose=(-1.8141197650019794, -2.363196167140496, -0.06583683175642818)): shape (37, 800, 800)
      Valid pixels: 99982/640000 (15.6%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=19, max=323501, num_faces=323542
      Valid probs shape: (37, 99982)
    ✓ Random_12 (pose=(2.1734903030958677, -2.9300475744636487, -2.167013134276918)): shape (37, 800, 800)
      Valid pixels: 64695/640000 (10.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=323343, num_faces=323542
      Valid probs shape: (37, 64695)
    ✓ Random_13 (pose=(1.6766080604071671, 0.9637380472830168, 1.4185960420336983)): shape (37, 800, 800)
      Valid pixels: 64140/640000 (10.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=322961, num_faces=323542
      Valid probs shape: (37, 64140)
    ✓ Random_14 (pose=(-1.7752852003138506, -1.8958951816530314, 2.062785859561817)): shape (37, 800, 800)
      Valid pixels: 80948/640000 (12.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=11, max=323541, num_faces=323542
      Valid probs shape: (37, 80948)
    P stats: min=0.0000, max=1.0000, mean=0.0223
    Non-zero vertices: 133634/161773
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 28139   916  1119  3933     0  2374  1116  4658  7077]
  Ground Truth Stats:
    Labels shape: (161773,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-17/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7017
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7748
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7750

  RESULTS:
  RAW:         median(top-10)=0.8506, mean(top-10)=0.8541, median(all)=0.7781, mean(all)=0.7017
  + SMOOTHING: median(top-10)=0.9084, mean(top-10)=0.9076, median(all)=0.8371, mean(all)=0.7748 [+0.0578]
  + MRF:       median(top-10)=0.9089, mean(top-10)=0.9080, median(all)=0.8378, mean(all)=0.7750 [+0.0005]
  TOTAL IMPROVEMENT (median top-10): +0.0583

================================================================================
Subject: NKI-RS-22-18
================================================================================
  Step 0: Generating predictions with V2 model (15 random views)...
  Mesh: 147633 vertices, 295262 faces
  Generating 15 random views...
  Generating predictions for 15 views (continuous camera pose)...
    ✓ Random_0 (pose=(1.7082519863947985, 0.6342326004847494, 2.411053670773023)): shape (37, 800, 800)
      Valid pixels: 92075/640000 (14.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=295207, num_faces=295262
      Valid probs shape: (37, 92075)
    ✓ Random_1 (pose=(-0.2907464763143932, -1.3046030821655872, 2.6049440562648334)): shape (37, 800, 800)
      Valid pixels: 73061/640000 (11.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=295260, num_faces=295262
      Valid probs shape: (37, 73061)
    ✓ Random_2 (pose=(-2.18102952310169, -0.4377548728068401, 0.3519711236760683)): shape (37, 800, 800)
      Valid pixels: 84018/640000 (13.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=14, max=295259, num_faces=295262
      Valid probs shape: (37, 84018)
    ✓ Random_3 (pose=(-2.9999018637915396, -0.12030215798911348, -2.163411238347271)): shape (37, 800, 800)
      Valid pixels: 42272/640000 (6.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2998, max=295260, num_faces=295262
      Valid probs shape: (37, 42272)
    ✓ Random_4 (pose=(1.6275198146448266, 1.444704091027222, -2.964391422201403)): shape (37, 800, 800)
      Valid pixels: 89807/640000 (14.0%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=8, max=295219, num_faces=295262
      Valid probs shape: (37, 89807)
    ✓ Random_5 (pose=(2.2874987666657525, -2.3098850346687057, -2.4806702262663207)): shape (37, 800, 800)
      Valid pixels: 59317/640000 (9.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=295115, num_faces=295262
      Valid probs shape: (37, 59317)
    ✓ Random_6 (pose=(1.0170093109320364, 0.7613345919431773, 1.013888583512351)): shape (37, 800, 800)
      Valid pixels: 56809/640000 (8.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=294979, num_faces=295262
      Valid probs shape: (37, 56809)
    ✓ Random_7 (pose=(1.3760100461733034, 0.7216531240763233, 2.0391355891038225)): shape (37, 800, 800)
      Valid pixels: 86346/640000 (13.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=295207, num_faces=295262
      Valid probs shape: (37, 86346)
    ✓ Random_8 (pose=(0.12098339791463708, -2.1171439127785403, 0.6960460591936246)): shape (37, 800, 800)
      Valid pixels: 87148/640000 (13.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=130, max=295261, num_faces=295262
      Valid probs shape: (37, 87148)
    ✓ Random_9 (pose=(-0.48948027017837825, -2.030634861303542, 0.6014572572546046)): shape (37, 800, 800)
      Valid pixels: 61660/640000 (9.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=708, max=295261, num_faces=295262
      Valid probs shape: (37, 61660)
    ✓ Random_10 (pose=(-0.2636172696960588, 2.5759807962074666, -0.018676447411988484)): shape (37, 800, 800)
      Valid pixels: 61702/640000 (9.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=35471, max=295260, num_faces=295262
      Valid probs shape: (37, 61702)
    ✓ Random_11 (pose=(-1.7145362397839115, -2.5798667179424526, -2.1760290421694624)): shape (37, 800, 800)
      Valid pixels: 69932/640000 (10.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=295250, num_faces=295262
      Valid probs shape: (37, 69932)
    ✓ Random_12 (pose=(0.3293517870947804, -1.8865687275279592, 2.567815980812198)): shape (37, 800, 800)
      Valid pixels: 59412/640000 (9.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=149, max=295253, num_faces=295262
      Valid probs shape: (37, 59412)
    ✓ Random_13 (pose=(3.0282194235018096, -1.6960149472460109, 0.6676462342582203)): shape (37, 800, 800)
      Valid pixels: 84412/640000 (13.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=295200, num_faces=295262
      Valid probs shape: (37, 84412)
    ✓ Random_14 (pose=(0.8187345271180182, -2.3917865806684313, -2.9583923536165444)): shape (37, 800, 800)
      Valid pixels: 88466/640000 (13.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=33, max=295259, num_faces=295262
      Valid probs shape: (37, 88466)
    P stats: min=0.0000, max=1.0000, mean=0.0227
    Non-zero vertices: 124180/147633
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 23453  1381  1031  3690     0  2253   826  4368  6243]
  Ground Truth Stats:
    Labels shape: (147633,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-18/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7130
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7992
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7993

  RESULTS:
  RAW:         median(top-10)=0.8841, mean(top-10)=0.8766, median(all)=0.7638, mean(all)=0.7130
  + SMOOTHING: median(top-10)=0.9202, mean(top-10)=0.9188, median(all)=0.8318, mean(all)=0.7992 [+0.0360]
  + MRF:       median(top-10)=0.9201, mean(top-10)=0.9188, median(all)=0.8325, mean(all)=0.7993 [-0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0360

================================================================================
Subject: NKI-RS-22-19
================================================================================
  Step 0: Generating predictions with V2 model (15 random views)...
  Mesh: 141397 vertices, 282790 faces
  Generating 15 random views...
  Generating predictions for 15 views (continuous camera pose)...
    ✓ Random_0 (pose=(-0.19575762878425174, -2.748230468845336, 0.036076768001537474)): shape (37, 800, 800)
      Valid pixels: 45402/640000 (7.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4598, max=282789, num_faces=282790
      Valid probs shape: (37, 45402)
    ✓ Random_1 (pose=(1.0891932654680252, -0.17639824778658353, -2.3384342916899294)): shape (37, 800, 800)
      Valid pixels: 64962/640000 (10.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=4, max=282743, num_faces=282790
      Valid probs shape: (37, 64962)
    ✓ Random_2 (pose=(1.053487569703079, 0.8085629456988754, 1.8000569211252415)): shape (37, 800, 800)
      Valid pixels: 74618/640000 (11.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=282543, num_faces=282790
      Valid probs shape: (37, 74618)
    ✓ Random_3 (pose=(-2.9590480212762627, -0.974659619052543, -0.42311276817298094)): shape (37, 800, 800)
      Valid pixels: 55270/640000 (8.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1620, max=282771, num_faces=282790
      Valid probs shape: (37, 55270)
    ✓ Random_4 (pose=(2.492529382649324, -2.168671081273989, -0.7657474653740488)): shape (37, 800, 800)
      Valid pixels: 83183/640000 (13.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=282779, num_faces=282790
      Valid probs shape: (37, 83183)
    ✓ Random_5 (pose=(-1.2305608792948093, 2.1248407238071545, 1.3125298809568786)): shape (37, 800, 800)
      Valid pixels: 65042/640000 (10.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=149, max=282787, num_faces=282790
      Valid probs shape: (37, 65042)
    ✓ Random_6 (pose=(-1.9113357724018785, 0.16334808075617735, 1.9963041415969265)): shape (37, 800, 800)
      Valid pixels: 71257/640000 (11.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=173, max=282781, num_faces=282790
      Valid probs shape: (37, 71257)
    ✓ Random_7 (pose=(-1.9698909493358878, -0.4680783635422059, -0.373187412875871)): shape (37, 800, 800)
      Valid pixels: 85608/640000 (13.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=21, max=282789, num_faces=282790
      Valid probs shape: (37, 85608)
    ✓ Random_8 (pose=(-2.088104704303062, 0.378897430691957, 1.1442939780184975)): shape (37, 800, 800)
      Valid pixels: 55871/640000 (8.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=600, max=282787, num_faces=282790
      Valid probs shape: (37, 55871)
    ✓ Random_9 (pose=(-3.084048879761734, -1.0723655533098992, -2.25869738851653)): shape (37, 800, 800)
      Valid pixels: 79745/640000 (12.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=483, max=282781, num_faces=282790
      Valid probs shape: (37, 79745)
    ✓ Random_10 (pose=(0.7738029041580572, -1.1802297957796675, -1.334548228575307)): shape (37, 800, 800)
      Valid pixels: 63920/640000 (10.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=282787, num_faces=282790
      Valid probs shape: (37, 63920)
    ✓ Random_11 (pose=(1.3068456362424898, -2.8248782382598643, -1.435761081032795)): shape (37, 800, 800)
      Valid pixels: 57239/640000 (8.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=580, max=282789, num_faces=282790
      Valid probs shape: (37, 57239)
    ✓ Random_12 (pose=(2.533562800574538, 2.3681485358764007, -0.47464906858917244)): shape (37, 800, 800)
      Valid pixels: 60766/640000 (9.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=282747, num_faces=282790
      Valid probs shape: (37, 60766)
    ✓ Random_13 (pose=(0.6808684625744532, 2.2605103354195153, 3.1328601441195696)): shape (37, 800, 800)
      Valid pixels: 66179/640000 (10.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1192, max=282789, num_faces=282790
      Valid probs shape: (37, 66179)
    ✓ Random_14 (pose=(-1.8857401780084366, 1.0385138392958515, -1.7908977948923142)): shape (37, 800, 800)
      Valid pixels: 56353/640000 (8.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=282723, num_faces=282790
      Valid probs shape: (37, 56353)
    P stats: min=0.0000, max=1.0000, mean=0.0225
    Non-zero vertices: 117963/141397
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 23434   644  1159  3326     0  1350   925  4918  4609]
  Ground Truth Stats:
    Labels shape: (141397,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-19/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
    MRF iteration 5/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6980
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7877
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7877

  RESULTS:
  RAW:         median(top-10)=0.8548, mean(top-10)=0.8623, median(all)=0.7583, mean(all)=0.6980
  + SMOOTHING: median(top-10)=0.9097, mean(top-10)=0.9105, median(all)=0.8541, mean(all)=0.7877 [+0.0549]
  + MRF:       median(top-10)=0.9100, mean(top-10)=0.9108, median(all)=0.8538, mean(all)=0.7877 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0552

================================================================================
Subject: NKI-RS-22-2
================================================================================
  Step 0: Generating predictions with V2 model (15 random views)...
  Mesh: 137791 vertices, 275578 faces
  Generating 15 random views...
  Generating predictions for 15 views (continuous camera pose)...
    ✓ Random_0 (pose=(-0.9806841654047838, 1.7202136649590871, 2.0714865214434104)): shape (37, 800, 800)
      Valid pixels: 64042/640000 (10.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=602, max=275475, num_faces=275578
      Valid probs shape: (37, 64042)
    ✓ Random_1 (pose=(-0.8670306656064142, -1.1706391406040273, -2.382305553947403)): shape (37, 800, 800)
      Valid pixels: 58815/640000 (9.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=275575, num_faces=275578
      Valid probs shape: (37, 58815)
    ✓ Random_2 (pose=(1.654406090847714, -1.2268793644453095, -1.0388573478350067)): shape (37, 800, 800)
      Valid pixels: 90572/640000 (14.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=59, max=275496, num_faces=275578
      Valid probs shape: (37, 90572)
    ✓ Random_3 (pose=(2.5506633183931005, -0.3208554504581089, 0.5490828941921859)): shape (37, 800, 800)
      Valid pixels: 56254/640000 (8.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=453, max=275577, num_faces=275578
      Valid probs shape: (37, 56254)
    ✓ Random_4 (pose=(1.4526809081571335, 0.6426147444567105, -2.902049125725573)): shape (37, 800, 800)
      Valid pixels: 80588/640000 (12.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=275577, num_faces=275578
      Valid probs shape: (37, 80588)
    ✓ Random_5 (pose=(-0.8029214884909082, -0.06691722980335824, 0.8561954794209949)): shape (37, 800, 800)
      Valid pixels: 58947/640000 (9.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=275405, num_faces=275578
      Valid probs shape: (37, 58947)
    ✓ Random_6 (pose=(0.6306552426117222, -2.6139820207936184, -1.5518658668862433)): shape (37, 800, 800)
      Valid pixels: 60881/640000 (9.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1296, max=275577, num_faces=275578
      Valid probs shape: (37, 60881)
    ✓ Random_7 (pose=(1.3811111424283053, -0.4982420738546711, 1.088524401445449)): shape (37, 800, 800)
      Valid pixels: 66757/640000 (10.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=10, max=275575, num_faces=275578
      Valid probs shape: (37, 66757)
    ✓ Random_8 (pose=(1.5730096137677263, -1.9292464388597552, 1.4443442391800918)): shape (37, 800, 800)
      Valid pixels: 59387/640000 (9.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=10, max=275575, num_faces=275578
      Valid probs shape: (37, 59387)
    ✓ Random_9 (pose=(-1.371378728235895, 2.7490848310982923, 1.362759613157582)): shape (37, 800, 800)
      Valid pixels: 65151/640000 (10.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=647, max=275485, num_faces=275578
      Valid probs shape: (37, 65151)
    ✓ Random_10 (pose=(-2.010940038637126, -0.9422990167056908, 1.0876956672870426)): shape (37, 800, 800)
      Valid pixels: 71886/640000 (11.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=728, max=275577, num_faces=275578
      Valid probs shape: (37, 71886)
    ✓ Random_11 (pose=(2.2857580739041135, 1.5514442504848285, -2.5957117393572373)): shape (37, 800, 800)
      Valid pixels: 94620/640000 (14.8%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=5, max=275577, num_faces=275578
      Valid probs shape: (37, 94620)
    ✓ Random_12 (pose=(-2.7669076383726967, -2.620169487033733, 3.011761459028773)): shape (37, 800, 800)
      Valid pixels: 60862/640000 (9.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=275496, num_faces=275578
      Valid probs shape: (37, 60862)
    ✓ Random_13 (pose=(-2.1407876986324634, -0.7804704067401893, -2.8326325567833237)): shape (37, 800, 800)
      Valid pixels: 92442/640000 (14.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=29, max=275496, num_faces=275578
      Valid probs shape: (37, 92442)
    ✓ Random_14 (pose=(2.689510116269455, 1.2617396016094906, 0.7280518967090952)): shape (37, 800, 800)
      Valid pixels: 98565/640000 (15.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=30, max=275496, num_faces=275578
      Valid probs shape: (37, 98565)
    P stats: min=0.0000, max=1.0000, mean=0.0226
    Non-zero vertices: 115231/137791
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 22560  1105  1057  2800     0  1356   972  4650  5554]
  Ground Truth Stats:
    Labels shape: (137791,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-2/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7271
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8143
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8149

  RESULTS:
  RAW:         median(top-10)=0.8749, mean(top-10)=0.8699, median(all)=0.7722, mean(all)=0.7271
  + SMOOTHING: median(top-10)=0.9029, mean(top-10)=0.9060, median(all)=0.8664, mean(all)=0.8143 [+0.0280]
  + MRF:       median(top-10)=0.9032, mean(top-10)=0.9064, median(all)=0.8665, mean(all)=0.8149 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0283

================================================================================
Subject: NKI-RS-22-20
================================================================================
  Step 0: Generating predictions with V2 model (15 random views)...
  Mesh: 140825 vertices, 281646 faces
  Generating 15 random views...
  Generating predictions for 15 views (continuous camera pose)...
    ✓ Random_0 (pose=(-0.577858291559203, 2.5374946202447033, -2.4116974561211824)): shape (37, 800, 800)
      Valid pixels: 78130/640000 (12.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=273, max=281636, num_faces=281646
      Valid probs shape: (37, 78130)
    ✓ Random_1 (pose=(-2.28649635452249, -1.1331757220165266, 2.330830039021831)): shape (37, 800, 800)
      Valid pixels: 71224/640000 (11.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=56, max=281644, num_faces=281646
      Valid probs shape: (37, 71224)
    ✓ Random_2 (pose=(1.5531443903399182, -1.5250811388781222, 1.9272627203328785)): shape (37, 800, 800)
      Valid pixels: 81057/640000 (12.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=281645, num_faces=281646
      Valid probs shape: (37, 81057)
    ✓ Random_3 (pose=(-2.051275263403369, -1.0419881292286566, -0.11001228632349624)): shape (37, 800, 800)
      Valid pixels: 97144/640000 (15.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=20, max=281624, num_faces=281646
      Valid probs shape: (37, 97144)
    ✓ Random_4 (pose=(1.3247039562411231, -2.3213380835779907, -0.34067244150331266)): shape (37, 800, 800)
      Valid pixels: 103522/640000 (16.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=13, max=281630, num_faces=281646
      Valid probs shape: (37, 103522)
    ✓ Random_5 (pose=(1.3525804635562908, 0.2969036725515739, 2.772823708911411)): shape (37, 800, 800)
      Valid pixels: 96304/640000 (15.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=281473, num_faces=281646
      Valid probs shape: (37, 96304)
    ✓ Random_6 (pose=(1.9611837468268787, -2.9819657710339036, -1.9543920945345568)): shape (37, 800, 800)
      Valid pixels: 65683/640000 (10.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=16, max=281644, num_faces=281646
      Valid probs shape: (37, 65683)
    ✓ Random_7 (pose=(-2.9696915550143985, 2.8598833550089786, 1.201858055431435)): shape (37, 800, 800)
      Valid pixels: 50192/640000 (7.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=281339, num_faces=281646
      Valid probs shape: (37, 50192)
    ✓ Random_8 (pose=(-1.6754708742662618, -0.09865390785299955, -0.6516457319419877)): shape (37, 800, 800)
      Valid pixels: 97734/640000 (15.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=14, max=281635, num_faces=281646
      Valid probs shape: (37, 97734)
    ✓ Random_9 (pose=(-2.3136671324778013, -0.48007370497685686, -2.9900621896294455)): shape (37, 800, 800)
      Valid pixels: 87933/640000 (13.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=54, max=281636, num_faces=281646
      Valid probs shape: (37, 87933)
    ✓ Random_10 (pose=(3.096167502860549, -2.1414631429177957, -1.6528788657663602)): shape (37, 800, 800)
      Valid pixels: 86785/640000 (13.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=281533, num_faces=281646
      Valid probs shape: (37, 86785)
    ✓ Random_11 (pose=(0.263890532252697, -2.667092583643006, -1.1386529064990478)): shape (37, 800, 800)
      Valid pixels: 58683/640000 (9.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3493, max=281645, num_faces=281646
      Valid probs shape: (37, 58683)
    ✓ Random_12 (pose=(-0.5471268618028429, -2.9870872352824973, -2.7699517276554717)): shape (37, 800, 800)
      Valid pixels: 60298/640000 (9.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3917, max=281645, num_faces=281646
      Valid probs shape: (37, 60298)
    ✓ Random_13 (pose=(0.8563687893659995, 1.2063572844824275, -1.9550626825111452)): shape (37, 800, 800)
      Valid pixels: 77825/640000 (12.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=281644, num_faces=281646
      Valid probs shape: (37, 77825)
    ✓ Random_14 (pose=(-2.8215929215558706, 2.814834839838519, 2.1112925907768947)): shape (37, 800, 800)
      Valid pixels: 59078/640000 (9.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=281533, num_faces=281646
      Valid probs shape: (37, 59078)
    P stats: min=0.0000, max=1.0000, mean=0.0230
    Non-zero vertices: 119645/140825
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 21180   897   802  3141     0  2488  1145  4484  5105]
  Ground Truth Stats:
    Labels shape: (140825,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-20/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7225
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8013
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8019

  RESULTS:
  RAW:         median(top-10)=0.8622, mean(top-10)=0.8701, median(all)=0.7636, mean(all)=0.7225
  + SMOOTHING: median(top-10)=0.9127, mean(top-10)=0.9163, median(all)=0.8335, mean(all)=0.8013 [+0.0505]
  + MRF:       median(top-10)=0.9127, mean(top-10)=0.9166, median(all)=0.8347, mean(all)=0.8019 [+0.0000]
  TOTAL IMPROVEMENT (median top-10): +0.0506

================================================================================
Subject: NKI-RS-22-21
================================================================================
  Step 0: Generating predictions with V2 model (15 random views)...
  Mesh: 138920 vertices, 277836 faces
  Generating 15 random views...
  Generating predictions for 15 views (continuous camera pose)...
    ✓ Random_0 (pose=(0.9549230749716298, 2.2663588824301737, -0.05216599910745545)): shape (37, 800, 800)
      Valid pixels: 73415/640000 (11.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=277833, num_faces=277836
      Valid probs shape: (37, 73415)
    ✓ Random_1 (pose=(2.481988737019128, -2.3392441963992567, -3.0767388893159446)): shape (37, 800, 800)
      Valid pixels: 60214/640000 (9.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=277835, num_faces=277836
      Valid probs shape: (37, 60214)
    ✓ Random_2 (pose=(2.230595349653057, 1.6397999622997732, 1.733364769397503)): shape (37, 800, 800)
      Valid pixels: 62614/640000 (9.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=9, max=277831, num_faces=277836
      Valid probs shape: (37, 62614)
    ✓ Random_3 (pose=(-2.403068667163239, 0.2039136636491743, 0.9961610360536044)): shape (37, 800, 800)
      Valid pixels: 52838/640000 (8.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1494, max=277835, num_faces=277836
      Valid probs shape: (37, 52838)
    ✓ Random_4 (pose=(1.1709051630834049, 1.0905544698883007, 0.047626602096313864)): shape (37, 800, 800)
      Valid pixels: 78756/640000 (12.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=14, max=277829, num_faces=277836
      Valid probs shape: (37, 78756)
    ✓ Random_5 (pose=(1.645162045535975, -1.4969071635761877, -0.47017496324044394)): shape (37, 800, 800)
      Valid pixels: 95222/640000 (14.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=32, max=277833, num_faces=277836
      Valid probs shape: (37, 95222)
    ✓ Random_6 (pose=(0.5226292552895764, 2.6664377691377243, 2.9735220433580833)): shape (37, 800, 800)
      Valid pixels: 64496/640000 (10.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1540, max=277835, num_faces=277836
      Valid probs shape: (37, 64496)
    ✓ Random_7 (pose=(-1.7766959468762635, -1.0646216503993404, -1.589107177634476)): shape (37, 800, 800)
      Valid pixels: 57746/640000 (9.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=277817, num_faces=277836
      Valid probs shape: (37, 57746)
    ✓ Random_8 (pose=(0.5109386041854189, -0.793939701142012, -0.2686271799706548)): shape (37, 800, 800)
      Valid pixels: 63883/640000 (10.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=277835, num_faces=277836
      Valid probs shape: (37, 63883)
    ✓ Random_9 (pose=(0.02640154402796968, -1.3036941447972303, -1.5098308861893137)): shape (37, 800, 800)
      Valid pixels: 78456/640000 (12.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=10, max=277835, num_faces=277836
      Valid probs shape: (37, 78456)
    ✓ Random_10 (pose=(-2.8204662932763687, 0.07760696731234784, 0.2598886527728306)): shape (37, 800, 800)
      Valid pixels: 51859/640000 (8.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=45343, max=277835, num_faces=277836
      Valid probs shape: (37, 51859)
    ✓ Random_11 (pose=(2.5206373307597056, 3.110323929742724, -1.1203810902382987)): shape (37, 800, 800)
      Valid pixels: 55326/640000 (8.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=277835, num_faces=277836
      Valid probs shape: (37, 55326)
    ✓ Random_12 (pose=(-0.6741713509109157, -1.7450545819394994, 1.9194295300901274)): shape (37, 800, 800)
      Valid pixels: 93881/640000 (14.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=72, max=277833, num_faces=277836
      Valid probs shape: (37, 93881)
    ✓ Random_13 (pose=(-2.3227881263657233, 2.8713035846546013, 1.0142842840802908)): shape (37, 800, 800)
      Valid pixels: 53325/640000 (8.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=277834, num_faces=277836
      Valid probs shape: (37, 53325)
    ✓ Random_14 (pose=(-1.1643854020926807, -1.6040215880209583, -2.8549725901987832)): shape (37, 800, 800)
      Valid pixels: 71286/640000 (11.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7, max=277833, num_faces=277836
      Valid probs shape: (37, 71286)
    P stats: min=0.0000, max=1.0000, mean=0.0215
    Non-zero vertices: 110302/138920
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 28618   966  1323  3020     0  2406   919  4720  4640]
  Ground Truth Stats:
    Labels shape: (138920,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-21/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6997
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7808
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7811

  RESULTS:
  RAW:         median(top-10)=0.8579, mean(top-10)=0.8531, median(all)=0.7386, mean(all)=0.6997
  + SMOOTHING: median(top-10)=0.9022, mean(top-10)=0.9009, median(all)=0.8195, mean(all)=0.7808 [+0.0442]
  + MRF:       median(top-10)=0.9022, mean(top-10)=0.9013, median(all)=0.8198, mean(all)=0.7811 [+0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0443

================================================================================
Subject: NKI-RS-22-22
================================================================================
  Step 0: Generating predictions with V2 model (15 random views)...
  Mesh: 129976 vertices, 259948 faces
  Generating 15 random views...
  Generating predictions for 15 views (continuous camera pose)...
    ✓ Random_0 (pose=(-1.6222912958149331, -1.3188509841180127, 3.02897068829608)): shape (37, 800, 800)
      Valid pixels: 92597/640000 (14.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=259946, num_faces=259948
      Valid probs shape: (37, 92597)
    ✓ Random_1 (pose=(3.0143432770774155, -0.7930226042566417, -1.4511145197483695)): shape (37, 800, 800)
      Valid pixels: 70023/640000 (10.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=245, max=259946, num_faces=259948
      Valid probs shape: (37, 70023)
    ✓ Random_2 (pose=(0.6478823636535944, -2.599769055232461, 2.001620917794728)): shape (37, 800, 800)
      Valid pixels: 53601/640000 (8.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=956, max=259947, num_faces=259948
      Valid probs shape: (37, 53601)
    ✓ Random_3 (pose=(2.9819973044968595, -0.4648159289470839, -1.4482523630539623)): shape (37, 800, 800)
      Valid pixels: 55902/640000 (8.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=191, max=259947, num_faces=259948
      Valid probs shape: (37, 55902)
    ✓ Random_4 (pose=(1.918860090576274, 3.081318765446036, -2.04887109785985)): shape (37, 800, 800)
      Valid pixels: 63637/640000 (9.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=11, max=259946, num_faces=259948
      Valid probs shape: (37, 63637)
    ✓ Random_5 (pose=(-0.14139865020860753, 1.0219184011038394, 0.7601288629102143)): shape (37, 800, 800)
      Valid pixels: 80301/640000 (12.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=258568, num_faces=259948
      Valid probs shape: (37, 80301)
    ✓ Random_6 (pose=(-1.7289940097580079, -1.8397036170844612, -1.9768182106011527)): shape (37, 800, 800)
      Valid pixels: 66831/640000 (10.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=37, max=259921, num_faces=259948
      Valid probs shape: (37, 66831)
    ✓ Random_7 (pose=(1.2204769610939614, 0.49541240978209844, -0.09548953095197454)): shape (37, 800, 800)
      Valid pixels: 84538/640000 (13.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6, max=259946, num_faces=259948
      Valid probs shape: (37, 84538)
    ✓ Random_8 (pose=(-0.5072363848767361, -1.68034046885578, 0.024352738216546488)): shape (37, 800, 800)
      Valid pixels: 66581/640000 (10.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=259947, num_faces=259948
      Valid probs shape: (37, 66581)
    ✓ Random_9 (pose=(0.07058586886998519, -0.6132444164791986, 2.4719277841880025)): shape (37, 800, 800)
      Valid pixels: 52647/640000 (8.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=259850, num_faces=259948
      Valid probs shape: (37, 52647)
    ✓ Random_10 (pose=(1.5116314118554808, 1.5891691965971537, 1.6866232908455085)): shape (37, 800, 800)
      Valid pixels: 67853/640000 (10.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=12, max=258567, num_faces=259948
      Valid probs shape: (37, 67853)
    ✓ Random_11 (pose=(0.14147247712187383, 2.9011353300634033, 0.14219491223891945)): shape (37, 800, 800)
      Valid pixels: 43399/640000 (6.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1115, max=259947, num_faces=259948
      Valid probs shape: (37, 43399)
    ✓ Random_12 (pose=(-1.9144950657239472, 1.5920335639433922, 1.7157983163007478)): shape (37, 800, 800)
      Valid pixels: 82347/640000 (12.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=259946, num_faces=259948
      Valid probs shape: (37, 82347)
    ✓ Random_13 (pose=(2.2879294795043386, -1.6657037650342732, -2.4659075434755313)): shape (37, 800, 800)
      Valid pixels: 63513/640000 (9.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=259946, num_faces=259948
      Valid probs shape: (37, 63513)
    ✓ Random_14 (pose=(2.3550777310925923, 2.0525788186623686, -1.324011422984886)): shape (37, 800, 800)
      Valid pixels: 63471/640000 (9.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8, max=259945, num_faces=259948
      Valid probs shape: (37, 63471)
    P stats: min=0.0000, max=1.0000, mean=0.0217
    Non-zero vertices: 104395/129976
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 25581   445   920  2753     0  1697  1270  4009  4994]
  Ground Truth Stats:
    Labels shape: (129976,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-22/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6866
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7732
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7736

  RESULTS:
  RAW:         median(top-10)=0.8693, mean(top-10)=0.8658, median(all)=0.7524, mean(all)=0.6866
  + SMOOTHING: median(top-10)=0.9117, mean(top-10)=0.9112, median(all)=0.8071, mean(all)=0.7732 [+0.0424]
  + MRF:       median(top-10)=0.9117, mean(top-10)=0.9115, median(all)=0.8080, mean(all)=0.7736 [-0.0000]
  TOTAL IMPROVEMENT (median top-10): +0.0424

================================================================================
Subject: NKI-RS-22-3
================================================================================
  Step 0: Generating predictions with V2 model (15 random views)...
  Mesh: 136714 vertices, 273424 faces
  Generating 15 random views...
  Generating predictions for 15 views (continuous camera pose)...
    ✓ Random_0 (pose=(2.5406830531416382, -0.1329862889845952, 2.6120730221773387)): shape (37, 800, 800)
      Valid pixels: 80084/640000 (12.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=35333, max=273373, num_faces=273424
      Valid probs shape: (37, 80084)
    ✓ Random_1 (pose=(-2.393368124233449, -0.9613168225185036, -0.9614302963597927)): shape (37, 800, 800)
      Valid pixels: 66251/640000 (10.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1366, max=273422, num_faces=273424
      Valid probs shape: (37, 66251)
    ✓ Random_2 (pose=(-0.9259999627969173, -1.188422980773135, 1.0587187844261887)): shape (37, 800, 800)
      Valid pixels: 67665/640000 (10.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8, max=273373, num_faces=273424
      Valid probs shape: (37, 67665)
    ✓ Random_3 (pose=(2.6748021268323603, 2.512887741864258, -1.7672281231257814)): shape (37, 800, 800)
      Valid pixels: 69155/640000 (10.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=0, max=273269, num_faces=273424
      Valid probs shape: (37, 69155)
    ✓ Random_4 (pose=(-1.3452425759849227, -1.4242985204390615, 0.5436661379625676)): shape (37, 800, 800)
      Valid pixels: 80013/640000 (12.5%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=13, max=273372, num_faces=273424
      Valid probs shape: (37, 80013)
    ✓ Random_5 (pose=(0.2157465448676925, 0.7662407956843094, 0.1281780125287435)): shape (37, 800, 800)
      Valid pixels: 56922/640000 (8.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=273411, num_faces=273424
      Valid probs shape: (37, 56922)
    ✓ Random_6 (pose=(-1.7875276244240668, 1.5003338305938083, -0.3253669090662674)): shape (37, 800, 800)
      Valid pixels: 98645/640000 (15.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=10, max=273373, num_faces=273424
      Valid probs shape: (37, 98645)
    ✓ Random_7 (pose=(-1.5800411275889423, -0.39590075083475407, -3.0666289844115133)): shape (37, 800, 800)
      Valid pixels: 102824/640000 (16.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=273421, num_faces=273424
      Valid probs shape: (37, 102824)
    ✓ Random_8 (pose=(-3.0463239633130104, -2.1205113348547964, -1.8052124745784144)): shape (37, 800, 800)
      Valid pixels: 93287/640000 (14.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=273419, num_faces=273424
      Valid probs shape: (37, 93287)
    ✓ Random_9 (pose=(0.7685205124153556, 2.3116416856258324, -2.3544603993026403)): shape (37, 800, 800)
      Valid pixels: 66936/640000 (10.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=197, max=273373, num_faces=273424
      Valid probs shape: (37, 66936)
    ✓ Random_10 (pose=(0.43736265482183345, -0.8460637296320885, -1.0598827742686079)): shape (37, 800, 800)
      Valid pixels: 67423/640000 (10.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=2, max=273372, num_faces=273424
      Valid probs shape: (37, 67423)
    ✓ Random_11 (pose=(-2.8955157870100177, 1.7383091087189309, -0.6719267714433133)): shape (37, 800, 800)
      Valid pixels: 80838/640000 (12.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=3, max=273372, num_faces=273424
      Valid probs shape: (37, 80838)
    ✓ Random_12 (pose=(-0.11992747022334083, -2.725355811129692, 2.802389399082424)): shape (37, 800, 800)
      Valid pixels: 56046/640000 (8.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3419, max=273423, num_faces=273424
      Valid probs shape: (37, 56046)
    ✓ Random_13 (pose=(-3.0013941357803042, 0.6125822125444431, -1.1448673428571692)): shape (37, 800, 800)
      Valid pixels: 76827/640000 (12.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=15451, max=273371, num_faces=273424
      Valid probs shape: (37, 76827)
    ✓ Random_14 (pose=(-2.978301726228789, -0.6582381554158974, -2.842994694632588)): shape (37, 800, 800)
      Valid pixels: 64286/640000 (10.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1412, max=273422, num_faces=273424
      Valid probs shape: (37, 64286)
    P stats: min=0.0000, max=1.0000, mean=0.0231
    Non-zero vertices: 117055/136714
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 19659  1219  1153  3026     0  2221   945  4611  6600]
  Ground Truth Stats:
    Labels shape: (136714,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-3/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7330
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8013
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8016

  RESULTS:
  RAW:         median(top-10)=0.8760, mean(top-10)=0.8803, median(all)=0.7604, mean(all)=0.7330
  + SMOOTHING: median(top-10)=0.9116, mean(top-10)=0.9103, median(all)=0.8402, mean(all)=0.8013 [+0.0356]
  + MRF:       median(top-10)=0.9116, mean(top-10)=0.9105, median(all)=0.8408, mean(all)=0.8016 [-0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0356

================================================================================
Subject: NKI-RS-22-4
================================================================================
  Step 0: Generating predictions with V2 model (15 random views)...
  Mesh: 169171 vertices, 338338 faces
  Generating 15 random views...
  Generating predictions for 15 views (continuous camera pose)...
    ✓ Random_0 (pose=(-0.20558726949642647, 1.4833024850367513, 2.2026531077266185)): shape (37, 800, 800)
      Valid pixels: 70695/640000 (11.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=25, max=338334, num_faces=338338
      Valid probs shape: (37, 70695)
    ✓ Random_1 (pose=(-2.530861957138303, -0.9715979881023382, -2.4972778630456194)): shape (37, 800, 800)
      Valid pixels: 87360/640000 (13.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=338337, num_faces=338338
      Valid probs shape: (37, 87360)
    ✓ Random_2 (pose=(-0.48531191485628966, -3.04464618423556, -0.3028903834467327)): shape (37, 800, 800)
      Valid pixels: 70775/640000 (11.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=35825, max=338334, num_faces=338338
      Valid probs shape: (37, 70775)
    ✓ Random_3 (pose=(-2.335377263151807, -0.15120251764533688, 0.7573602981693193)): shape (37, 800, 800)
      Valid pixels: 69929/640000 (10.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=586, max=338334, num_faces=338338
      Valid probs shape: (37, 69929)
    ✓ Random_4 (pose=(-2.803640249286577, 0.7073608386356969, 3.0041099008697225)): shape (37, 800, 800)
      Valid pixels: 58959/640000 (9.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1262, max=338337, num_faces=338338
      Valid probs shape: (37, 58959)
    ✓ Random_5 (pose=(-1.5871105898889277, -1.5387165578720676, 1.2007416789336656)): shape (37, 800, 800)
      Valid pixels: 65049/640000 (10.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=25, max=338332, num_faces=338338
      Valid probs shape: (37, 65049)
    ✓ Random_6 (pose=(0.3451281754348252, -1.3798962096186278, 3.011278665144764)): shape (37, 800, 800)
      Valid pixels: 67196/640000 (10.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=338294, num_faces=338338
      Valid probs shape: (37, 67196)
    ✓ Random_7 (pose=(1.921083836801837, -3.0829092628388075, 1.9373430077379217)): shape (37, 800, 800)
      Valid pixels: 71720/640000 (11.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=338294, num_faces=338338
      Valid probs shape: (37, 71720)
    ✓ Random_8 (pose=(2.574300685256463, 1.0450689659954104, -1.7689763173859028)): shape (37, 800, 800)
      Valid pixels: 78516/640000 (12.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=531, max=338337, num_faces=338338
      Valid probs shape: (37, 78516)
    ✓ Random_9 (pose=(0.32824161741783753, 2.545999995920912, -2.706340385670452)): shape (37, 800, 800)
      Valid pixels: 45632/640000 (7.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=565, max=338335, num_faces=338338
      Valid probs shape: (37, 45632)
    ✓ Random_10 (pose=(-0.04692470957754624, 1.93379623607159, 1.3505170353352298)): shape (37, 800, 800)
      Valid pixels: 91964/640000 (14.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=526, max=338334, num_faces=338338
      Valid probs shape: (37, 91964)
    ✓ Random_11 (pose=(0.49663332522024595, -0.5760807102584513, -2.5476445676697694)): shape (37, 800, 800)
      Valid pixels: 66786/640000 (10.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=0, max=337452, num_faces=338338
      Valid probs shape: (37, 66786)
    ✓ Random_12 (pose=(1.1082343152193728, -2.5421954569534453, 0.6330501110800602)): shape (37, 800, 800)
      Valid pixels: 80390/640000 (12.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=382, max=338337, num_faces=338338
      Valid probs shape: (37, 80390)
    ✓ Random_13 (pose=(-1.8574333854459701, -0.2677389495942455, -1.544824409823045)): shape (37, 800, 800)
      Valid pixels: 57266/640000 (8.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1033, max=338334, num_faces=338338
      Valid probs shape: (37, 57266)
    ✓ Random_14 (pose=(1.5630509494500258, 1.7967707782774598, -2.5939524415767385)): shape (37, 800, 800)
      Valid pixels: 76203/640000 (11.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=23, max=338334, num_faces=338338
      Valid probs shape: (37, 76203)
    P stats: min=0.0000, max=0.9999, mean=0.0230
    Non-zero vertices: 144051/169171
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 25120  1180  1153  3616     0  2484  1078  3712  6888]
  Ground Truth Stats:
    Labels shape: (169171,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-4/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7159
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8040
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8043

  RESULTS:
  RAW:         median(top-10)=0.8492, mean(top-10)=0.8519, median(all)=0.7904, mean(all)=0.7159
  + SMOOTHING: median(top-10)=0.8995, mean(top-10)=0.9035, median(all)=0.8558, mean(all)=0.8040 [+0.0502]
  + MRF:       median(top-10)=0.8999, mean(top-10)=0.9041, median(all)=0.8564, mean(all)=0.8043 [+0.0004]
  TOTAL IMPROVEMENT (median top-10): +0.0507

================================================================================
Subject: NKI-RS-22-5
================================================================================
  Step 0: Generating predictions with V2 model (15 random views)...
  Mesh: 138967 vertices, 277930 faces
  Generating 15 random views...
  Generating predictions for 15 views (continuous camera pose)...
    ✓ Random_0 (pose=(1.8660715636324365, 2.9494147339856935, 1.7757495046250789)): shape (37, 800, 800)
      Valid pixels: 65216/640000 (10.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=277407, num_faces=277930
      Valid probs shape: (37, 65216)
    ✓ Random_1 (pose=(-1.4282543309159466, -0.588540091950378, -2.329158892800015)): shape (37, 800, 800)
      Valid pixels: 68065/640000 (10.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=21, max=277754, num_faces=277930
      Valid probs shape: (37, 68065)
    ✓ Random_2 (pose=(-1.0450702867884325, -0.3006458334078048, -1.8407052809423148)): shape (37, 800, 800)
      Valid pixels: 55133/640000 (8.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6, max=277407, num_faces=277930
      Valid probs shape: (37, 55133)
    ✓ Random_3 (pose=(1.3983066233693453, 1.8606466552693055, 0.9316378483299887)): shape (37, 800, 800)
      Valid pixels: 64690/640000 (10.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=277754, num_faces=277930
      Valid probs shape: (37, 64690)
    ✓ Random_4 (pose=(2.522460837984502, 2.941058838522416, 3.0058773141092407)): shape (37, 800, 800)
      Valid pixels: 62237/640000 (9.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=277587, num_faces=277930
      Valid probs shape: (37, 62237)
    ✓ Random_5 (pose=(1.6137622001581082, 0.33963534166507303, 3.002640094080826)): shape (37, 800, 800)
      Valid pixels: 90364/640000 (14.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=277925, num_faces=277930
      Valid probs shape: (37, 90364)
    ✓ Random_6 (pose=(2.6388046838125385, -2.3589340908161254, -3.0783674768381153)): shape (37, 800, 800)
      Valid pixels: 57484/640000 (9.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=277921, num_faces=277930
      Valid probs shape: (37, 57484)
    ✓ Random_7 (pose=(-1.7091585369091897, -1.0141862122033598, 2.3696105804723384)): shape (37, 800, 800)
      Valid pixels: 90241/640000 (14.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=9, max=277920, num_faces=277930
      Valid probs shape: (37, 90241)
    ✓ Random_8 (pose=(-2.814266067881618, 2.549675623285557, -2.0917751979091515)): shape (37, 800, 800)
      Valid pixels: 57870/640000 (9.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=276638, num_faces=277930
      Valid probs shape: (37, 57870)
    ✓ Random_9 (pose=(-3.099812932538194, -0.6237170540336963, 0.6444781961120136)): shape (37, 800, 800)
      Valid pixels: 72513/640000 (11.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=12551, max=277862, num_faces=277930
      Valid probs shape: (37, 72513)
    ✓ Random_10 (pose=(-1.0308622100337823, 2.7028328942589575, 2.0946050741669637)): shape (37, 800, 800)
      Valid pixels: 67073/640000 (10.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=847, max=277927, num_faces=277930
      Valid probs shape: (37, 67073)
    ✓ Random_11 (pose=(3.1205419846345297, -0.6478589686218355, -0.7108550670769165)): shape (37, 800, 800)
      Valid pixels: 54165/640000 (8.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1892, max=277917, num_faces=277930
      Valid probs shape: (37, 54165)
    ✓ Random_12 (pose=(0.3645817805490714, 1.8056297267931596, 1.4256279605303686)): shape (37, 800, 800)
      Valid pixels: 93145/640000 (14.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=185, max=277862, num_faces=277930
      Valid probs shape: (37, 93145)
    ✓ Random_13 (pose=(-2.566460668306639, 0.6385774835384828, -1.3421040480159545)): shape (37, 800, 800)
      Valid pixels: 83303/640000 (13.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=11030, max=277923, num_faces=277930
      Valid probs shape: (37, 83303)
    ✓ Random_14 (pose=(-1.9951598572001894, 1.7891843145966373, 0.9480853121984332)): shape (37, 800, 800)
      Valid pixels: 63436/640000 (9.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=97, max=277927, num_faces=277930
      Valid probs shape: (37, 63436)
    P stats: min=0.0000, max=1.0000, mean=0.0234
    Non-zero vertices: 120449/138967
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 18518  1137   770  3766     0  2210   757  3743  4956]
  Ground Truth Stats:
    Labels shape: (138967,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-5/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7422
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8085
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8087

  RESULTS:
  RAW:         median(top-10)=0.8734, mean(top-10)=0.8749, median(all)=0.8044, mean(all)=0.7422
  + SMOOTHING: median(top-10)=0.9217, mean(top-10)=0.9176, median(all)=0.8659, mean(all)=0.8085 [+0.0483]
  + MRF:       median(top-10)=0.9220, mean(top-10)=0.9181, median(all)=0.8655, mean(all)=0.8087 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0486

================================================================================
Subject: NKI-RS-22-6
================================================================================
  Step 0: Generating predictions with V2 model (15 random views)...
  Mesh: 185380 vertices, 370756 faces
  Generating 15 random views...
  Generating predictions for 15 views (continuous camera pose)...
    ✓ Random_0 (pose=(0.3192758886170797, 3.049948033216552, -2.7982952862153243)): shape (37, 800, 800)
      Valid pixels: 50460/640000 (7.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=8553, max=370754, num_faces=370756
      Valid probs shape: (37, 50460)
    ✓ Random_1 (pose=(-1.7168427707777205, 0.6312912606956012, 1.4384992071400795)): shape (37, 800, 800)
      Valid pixels: 62368/640000 (9.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=255, max=370715, num_faces=370756
      Valid probs shape: (37, 62368)
    ✓ Random_2 (pose=(1.848488251948452, -0.6041402607282871, 1.7981584319154917)): shape (37, 800, 800)
      Valid pixels: 74210/640000 (11.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=341, max=370744, num_faces=370756
      Valid probs shape: (37, 74210)
    ✓ Random_3 (pose=(-1.6950671862236053, -2.5091268814452836, -0.004506744726878065)): shape (37, 800, 800)
      Valid pixels: 88629/640000 (13.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=50, max=370751, num_faces=370756
      Valid probs shape: (37, 88629)
    ✓ Random_4 (pose=(-0.3422973110440384, 2.5102237565187604, -0.8974544251610355)): shape (37, 800, 800)
      Valid pixels: 50343/640000 (7.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=79, max=370755, num_faces=370756
      Valid probs shape: (37, 50343)
    ✓ Random_5 (pose=(-3.1282826804500954, 1.1259397880795623, 0.8664030198528172)): shape (37, 800, 800)
      Valid pixels: 87321/640000 (13.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=74, max=370754, num_faces=370756
      Valid probs shape: (37, 87321)
    ✓ Random_6 (pose=(0.6657318831804622, -3.0697184531765807, -0.9618842059423653)): shape (37, 800, 800)
      Valid pixels: 59071/640000 (9.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=212, max=370754, num_faces=370756
      Valid probs shape: (37, 59071)
    ✓ Random_7 (pose=(-0.5167245841057264, 1.1178505246262578, -1.7966025131891423)): shape (37, 800, 800)
      Valid pixels: 81764/640000 (12.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=26, max=370715, num_faces=370756
      Valid probs shape: (37, 81764)
    ✓ Random_8 (pose=(-0.7437067406169406, -2.6127859399300073, -2.509661678038936)): shape (37, 800, 800)
      Valid pixels: 56321/640000 (8.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=48, max=370754, num_faces=370756
      Valid probs shape: (37, 56321)
    ✓ Random_9 (pose=(1.2322172331842527, -1.4656731972175872, -2.618080771610041)): shape (37, 800, 800)
      Valid pixels: 83577/640000 (13.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=370751, num_faces=370756
      Valid probs shape: (37, 83577)
    ✓ Random_10 (pose=(1.2578584547825908, 3.0160571444911204, 0.5908442138379404)): shape (37, 800, 800)
      Valid pixels: 73352/640000 (11.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=30, max=370717, num_faces=370756
      Valid probs shape: (37, 73352)
    ✓ Random_11 (pose=(-1.3969184408064916, -1.8249485519388915, -0.7926921395711597)): shape (37, 800, 800)
      Valid pixels: 91615/640000 (14.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=66, max=370753, num_faces=370756
      Valid probs shape: (37, 91615)
    ✓ Random_12 (pose=(0.6103786848229311, -2.4698605854787297, -3.090485779033763)): shape (37, 800, 800)
      Valid pixels: 78333/640000 (12.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=21086, max=370751, num_faces=370756
      Valid probs shape: (37, 78333)
    ✓ Random_13 (pose=(1.5526573712337246, -1.1720047464542727, -2.6484441691142284)): shape (37, 800, 800)
      Valid pixels: 77426/640000 (12.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=40, max=370753, num_faces=370756
      Valid probs shape: (37, 77426)
    ✓ Random_14 (pose=(-0.8617691574798387, -0.25972932218633016, 0.7768146125103645)): shape (37, 800, 800)
      Valid pixels: 56676/640000 (8.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=370715, num_faces=370756
      Valid probs shape: (37, 56676)
    P stats: min=0.0000, max=1.0000, mean=0.0227
    Non-zero vertices: 155836/185380
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 29544  1458  1688  3852     0  3081   963  6052  6852]
  Ground Truth Stats:
    Labels shape: (185380,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-6/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7262
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7995
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7997

  RESULTS:
  RAW:         median(top-10)=0.8712, mean(top-10)=0.8823, median(all)=0.8076, mean(all)=0.7262
  + SMOOTHING: median(top-10)=0.9296, mean(top-10)=0.9281, median(all)=0.8610, mean(all)=0.7995 [+0.0585]
  + MRF:       median(top-10)=0.9303, mean(top-10)=0.9285, median(all)=0.8615, mean(all)=0.7997 [+0.0006]
  TOTAL IMPROVEMENT (median top-10): +0.0591

================================================================================
Subject: NKI-RS-22-7
================================================================================
  Step 0: Generating predictions with V2 model (15 random views)...
  Mesh: 153181 vertices, 306358 faces
  Generating 15 random views...
  Generating predictions for 15 views (continuous camera pose)...
    ✓ Random_0 (pose=(-0.9750723165805084, -3.067409465515159, 0.23733620039639813)): shape (37, 800, 800)
      Valid pixels: 92458/640000 (14.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=609, max=306353, num_faces=306358
      Valid probs shape: (37, 92458)
    ✓ Random_1 (pose=(-1.2037067866803461, 1.506186472609679, 1.5417565966529763)): shape (37, 800, 800)
      Valid pixels: 74233/640000 (11.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=131, max=306158, num_faces=306358
      Valid probs shape: (37, 74233)
    ✓ Random_2 (pose=(1.9123830164278415, -1.932567636195501, -0.03172203992039169)): shape (37, 800, 800)
      Valid pixels: 104847/640000 (16.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=10, max=306250, num_faces=306358
      Valid probs shape: (37, 104847)
    ✓ Random_3 (pose=(-1.0526526119715665, 2.388927732386896, 2.131459845504314)): shape (37, 800, 800)
      Valid pixels: 73548/640000 (11.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=215, max=306353, num_faces=306358
      Valid probs shape: (37, 73548)
    ✓ Random_4 (pose=(0.19523214060381688, 1.5093345756395884, -0.11584833592930499)): shape (37, 800, 800)
      Valid pixels: 71176/640000 (11.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=76, max=306357, num_faces=306358
      Valid probs shape: (37, 71176)
    ✓ Random_5 (pose=(0.0431106491951474, 2.896276581177232, 2.697868470873331)): shape (37, 800, 800)
      Valid pixels: 55269/640000 (8.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6756, max=306350, num_faces=306358
      Valid probs shape: (37, 55269)
    ✓ Random_6 (pose=(-0.8189309771353268, -2.717126499063854, 1.575208522513444)): shape (37, 800, 800)
      Valid pixels: 75487/640000 (11.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1399, max=306353, num_faces=306358
      Valid probs shape: (37, 75487)
    ✓ Random_7 (pose=(-1.243572101798713, 2.6148282345345732, 2.4782520828692807)): shape (37, 800, 800)
      Valid pixels: 101822/640000 (15.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=7, max=306335, num_faces=306358
      Valid probs shape: (37, 101822)
    ✓ Random_8 (pose=(-2.1972447541926017, -2.6811704992467527, 1.9408117079768967)): shape (37, 800, 800)
      Valid pixels: 57716/640000 (9.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6, max=306157, num_faces=306358
      Valid probs shape: (37, 57716)
    ✓ Random_9 (pose=(2.5139930322989326, -1.3755974851781665, 2.7668805611624814)): shape (37, 800, 800)
      Valid pixels: 89980/640000 (14.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=13, max=306353, num_faces=306358
      Valid probs shape: (37, 89980)
    ✓ Random_10 (pose=(-0.2162594752122997, 2.1331769192520635, -1.243355048049409)): shape (37, 800, 800)
      Valid pixels: 82130/640000 (12.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=306357, num_faces=306358
      Valid probs shape: (37, 82130)
    ✓ Random_11 (pose=(-1.4401568505660352, 0.650734514466631, 0.456015104629492)): shape (37, 800, 800)
      Valid pixels: 93070/640000 (14.5%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=15, max=306338, num_faces=306358
      Valid probs shape: (37, 93070)
    ✓ Random_12 (pose=(1.452282317691031, -1.5451253589748455, 1.5389232684156324)): shape (37, 800, 800)
      Valid pixels: 67205/640000 (10.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=31, max=306357, num_faces=306358
      Valid probs shape: (37, 67205)
    ✓ Random_13 (pose=(1.3467266361795698, 0.03154401257843498, 1.603684611894332)): shape (37, 800, 800)
      Valid pixels: 66646/640000 (10.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=25, max=306357, num_faces=306358
      Valid probs shape: (37, 66646)
    ✓ Random_14 (pose=(0.04145270997594874, 1.0448949685293254, -1.0253988137446877)): shape (37, 800, 800)
      Valid pixels: 87941/640000 (13.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=306250, num_faces=306358
      Valid probs shape: (37, 87941)
    P stats: min=0.0000, max=0.9999, mean=0.0218
    Non-zero vertices: 123406/153181
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 29775   777  1156  3763     0  3032   922  4379  4676]
  Ground Truth Stats:
    Labels shape: (153181,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-7/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
    MRF iteration 5/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7036
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7894
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7899

  RESULTS:
  RAW:         median(top-10)=0.8646, mean(top-10)=0.8643, median(all)=0.7501, mean(all)=0.7036
  + SMOOTHING: median(top-10)=0.9049, mean(top-10)=0.9065, median(all)=0.8577, mean(all)=0.7894 [+0.0403]
  + MRF:       median(top-10)=0.9056, mean(top-10)=0.9070, median(all)=0.8576, mean(all)=0.7899 [+0.0008]
  TOTAL IMPROVEMENT (median top-10): +0.0411

================================================================================
Subject: NKI-RS-22-8
================================================================================
  Step 0: Generating predictions with V2 model (15 random views)...
  Mesh: 158049 vertices, 316094 faces
  Generating 15 random views...
  Generating predictions for 15 views (continuous camera pose)...
    ✓ Random_0 (pose=(-1.031867331491895, -0.39450279844960257, -0.7285440197092763)): shape (37, 800, 800)
      Valid pixels: 91502/640000 (14.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=9, max=314969, num_faces=316094
      Valid probs shape: (37, 91502)
    ✓ Random_1 (pose=(0.1891458990146817, -0.2274643899529516, 1.2742937270825951)): shape (37, 800, 800)
      Valid pixels: 53576/640000 (8.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=315777, num_faces=316094
      Valid probs shape: (37, 53576)
    ✓ Random_2 (pose=(1.5405624834292606, 3.095917000024728, -3.064365282091906)): shape (37, 800, 800)
      Valid pixels: 93608/640000 (14.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8, max=316093, num_faces=316094
      Valid probs shape: (37, 93608)
    ✓ Random_3 (pose=(-1.5977804686012567, 0.6355520264854073, -1.2200857939757157)): shape (37, 800, 800)
      Valid pixels: 77241/640000 (12.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=9, max=314936, num_faces=316094
      Valid probs shape: (37, 77241)
    ✓ Random_4 (pose=(-2.2652746330980214, -2.3781078116140444, -2.946532571646837)): shape (37, 800, 800)
      Valid pixels: 91003/640000 (14.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=316046, num_faces=316094
      Valid probs shape: (37, 91003)
    ✓ Random_5 (pose=(-2.1675766116156305, 0.5212849309910577, 1.5884431627280478)): shape (37, 800, 800)
      Valid pixels: 74297/640000 (11.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2977, max=316093, num_faces=316094
      Valid probs shape: (37, 74297)
    ✓ Random_6 (pose=(-1.4748687709317572, 1.646327027873661, 0.5506091848231098)): shape (37, 800, 800)
      Valid pixels: 84256/640000 (13.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=7, max=316092, num_faces=316094
      Valid probs shape: (37, 84256)
    ✓ Random_7 (pose=(1.6478290136169784, -1.531514341326141, -2.4773605379855805)): shape (37, 800, 800)
      Valid pixels: 78182/640000 (12.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=15, max=316093, num_faces=316094
      Valid probs shape: (37, 78182)
    ✓ Random_8 (pose=(2.320721124659295, -1.344201721019701, -0.5478175537859475)): shape (37, 800, 800)
      Valid pixels: 98834/640000 (15.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=16, max=315777, num_faces=316094
      Valid probs shape: (37, 98834)
    ✓ Random_9 (pose=(2.8585995497296723, 1.8586670296983812, -2.2716609220833313)): shape (37, 800, 800)
      Valid pixels: 96409/640000 (15.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8, max=314968, num_faces=316094
      Valid probs shape: (37, 96409)
    ✓ Random_10 (pose=(0.1729593256866373, 0.6266011370422575, 0.1083011106260936)): shape (37, 800, 800)
      Valid pixels: 54978/640000 (8.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=315774, num_faces=316094
      Valid probs shape: (37, 54978)
    ✓ Random_11 (pose=(-2.8240420575403538, 3.0935526213057836, -2.098301191173882)): shape (37, 800, 800)
      Valid pixels: 50442/640000 (7.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=315776, num_faces=316094
      Valid probs shape: (37, 50442)
    ✓ Random_12 (pose=(-0.40036587394802314, -3.1330185023771877, 2.856817663296961)): shape (37, 800, 800)
      Valid pixels: 60109/640000 (9.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=951, max=316093, num_faces=316094
      Valid probs shape: (37, 60109)
    ✓ Random_13 (pose=(-1.7028062368266947, 2.0893374917901344, 1.6281654530095135)): shape (37, 800, 800)
      Valid pixels: 66315/640000 (10.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=45, max=316093, num_faces=316094
      Valid probs shape: (37, 66315)
    ✓ Random_14 (pose=(-2.4509860503581016, 0.32356415506014935, -1.8961486593364494)): shape (37, 800, 800)
      Valid pixels: 50200/640000 (7.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=24231, max=314244, num_faces=316094
      Valid probs shape: (37, 50200)
    P stats: min=0.0000, max=1.0000, mean=0.0238
    Non-zero vertices: 139468/158049
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 18581  1122  1102  3595     0  2795  1222  5016  5784]
  Ground Truth Stats:
    Labels shape: (158049,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-8/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7333
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8146
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8151

  RESULTS:
  RAW:         median(top-10)=0.8645, mean(top-10)=0.8696, median(all)=0.7935, mean(all)=0.7333
  + SMOOTHING: median(top-10)=0.9254, mean(top-10)=0.9193, median(all)=0.8487, mean(all)=0.8146 [+0.0609]
  + MRF:       median(top-10)=0.9258, mean(top-10)=0.9198, median(all)=0.8486, mean(all)=0.8151 [+0.0005]
  TOTAL IMPROVEMENT (median top-10): +0.0614

================================================================================
Subject: NKI-RS-22-9
================================================================================
  Step 0: Generating predictions with V2 model (15 random views)...
  Mesh: 129746 vertices, 259488 faces
  Generating 15 random views...
  Generating predictions for 15 views (continuous camera pose)...
    ✓ Random_0 (pose=(1.8246445620287375, -2.662467624636394, -0.670736243258323)): shape (37, 800, 800)
      Valid pixels: 94738/640000 (14.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=16, max=259432, num_faces=259488
      Valid probs shape: (37, 94738)
    ✓ Random_1 (pose=(1.2368548268985808, -3.0026627532959984, 2.549950256494724)): shape (37, 800, 800)
      Valid pixels: 90195/640000 (14.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=77, max=259485, num_faces=259488
      Valid probs shape: (37, 90195)
    ✓ Random_2 (pose=(-0.08710100004441435, -0.2839053967927452, -2.286204220456503)): shape (37, 800, 800)
      Valid pixels: 45787/640000 (7.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=257295, num_faces=259488
      Valid probs shape: (37, 45787)
    ✓ Random_3 (pose=(-0.6660903377209659, -1.680910687966585, -1.7114136890730902)): shape (37, 800, 800)
      Valid pixels: 89482/640000 (14.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=259485, num_faces=259488
      Valid probs shape: (37, 89482)
    ✓ Random_4 (pose=(-0.059854643830082654, -0.34629716565313373, -1.1826331884223842)): shape (37, 800, 800)
      Valid pixels: 50013/640000 (7.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=259003, num_faces=259488
      Valid probs shape: (37, 50013)
    ✓ Random_5 (pose=(-0.12963827046727827, 1.5119233650513788, 2.2614179125733553)): shape (37, 800, 800)
      Valid pixels: 67514/640000 (10.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=74, max=259486, num_faces=259488
      Valid probs shape: (37, 67514)
    ✓ Random_6 (pose=(0.08037923933192959, -1.0706615222364864, -0.36741712652411707)): shape (37, 800, 800)
      Valid pixels: 56115/640000 (8.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=10, max=259438, num_faces=259488
      Valid probs shape: (37, 56115)
    ✓ Random_7 (pose=(-0.28912992027084083, -3.1232604866375953, 1.1419318985640707)): shape (37, 800, 800)
      Valid pixels: 43604/640000 (6.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1258, max=259487, num_faces=259488
      Valid probs shape: (37, 43604)
    ✓ Random_8 (pose=(-0.9704198441942138, -3.0326827882007477, -1.263114334085984)): shape (37, 800, 800)
      Valid pixels: 69232/640000 (10.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4475, max=259486, num_faces=259488
      Valid probs shape: (37, 69232)
    ✓ Random_9 (pose=(-0.29732574019281754, -2.658490418195622, 1.1807144322922145)): shape (37, 800, 800)
      Valid pixels: 54075/640000 (8.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=530, max=259486, num_faces=259488
      Valid probs shape: (37, 54075)
    ✓ Random_10 (pose=(-2.149607816070177, 3.0854824988063845, -2.514886523665708)): shape (37, 800, 800)
      Valid pixels: 67387/640000 (10.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=259245, num_faces=259488
      Valid probs shape: (37, 67387)
    ✓ Random_11 (pose=(-1.7395204744593518, -1.540092380773423, -1.1227471602015178)): shape (37, 800, 800)
      Valid pixels: 70321/640000 (11.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6, max=259485, num_faces=259488
      Valid probs shape: (37, 70321)
    ✓ Random_12 (pose=(-1.2346581846822753, 2.162736504608832, -0.0820029548994996)): shape (37, 800, 800)
      Valid pixels: 93094/640000 (14.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=27, max=259486, num_faces=259488
      Valid probs shape: (37, 93094)
    ✓ Random_13 (pose=(2.339870135588919, 0.43966254623302836, -0.2956742896703961)): shape (37, 800, 800)
      Valid pixels: 77606/640000 (12.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=250, max=259487, num_faces=259488
      Valid probs shape: (37, 77606)
    ✓ Random_14 (pose=(-1.3227153801517808, -2.743420011334335, 1.7419619216568254)): shape (37, 800, 800)
      Valid pixels: 69621/640000 (10.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=134, max=259438, num_faces=259488
      Valid probs shape: (37, 69621)
    P stats: min=0.0000, max=1.0000, mean=0.0237
    Non-zero vertices: 113600/129746
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 16146   793   862  2656     0  1958   949  4277  5304]
  Ground Truth Stats:
    Labels shape: (129746,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-9/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
    MRF iteration 5/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7355
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8111
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8114

  RESULTS:
  RAW:         median(top-10)=0.8852, mean(top-10)=0.8887, median(all)=0.7834, mean(all)=0.7355
  + SMOOTHING: median(top-10)=0.9180, mean(top-10)=0.9191, median(all)=0.8402, mean(all)=0.8111 [+0.0328]
  + MRF:       median(top-10)=0.9183, mean(top-10)=0.9192, median(all)=0.8407, mean(all)=0.8114 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0331

================================================================================
Subject: NKI-TRT-20-1
================================================================================
  Step 0: Generating predictions with V2 model (15 random views)...
  Mesh: 143932 vertices, 287860 faces
  Generating 15 random views...
  Generating predictions for 15 views (continuous camera pose)...
    ✓ Random_0 (pose=(-1.3345173936053403, 0.8670580577303024, 0.6911029636533925)): shape (37, 800, 800)
      Valid pixels: 106816/640000 (16.7%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=10, max=287859, num_faces=287860
      Valid probs shape: (37, 106816)
    ✓ Random_1 (pose=(-2.68900357027724, -0.41690834381466724, 2.512252690345025)): shape (37, 800, 800)
      Valid pixels: 83905/640000 (13.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2652, max=287859, num_faces=287860
      Valid probs shape: (37, 83905)
    ✓ Random_2 (pose=(-1.0861949712728722, 2.4106358516323896, -1.4009516855709279)): shape (37, 800, 800)
      Valid pixels: 80537/640000 (12.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1251, max=287852, num_faces=287860
      Valid probs shape: (37, 80537)
    ✓ Random_3 (pose=(-0.044894916031209764, 1.1268019715995186, 1.9711529354582602)): shape (37, 800, 800)
      Valid pixels: 105580/640000 (16.5%)
      Probs stats: min=0.0000, max=0.9994, mean=0.0270
      Face IDs: min=10, max=287856, num_faces=287860
      Valid probs shape: (37, 105580)
    ✓ Random_4 (pose=(-1.1960722662509307, -2.6916974227483323, -0.9730765031903159)): shape (37, 800, 800)
      Valid pixels: 116989/640000 (18.3%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=3978, max=287856, num_faces=287860
      Valid probs shape: (37, 116989)
    ✓ Random_5 (pose=(-1.6539798697684422, -1.8390821539997486, 1.2089089437368488)): shape (37, 800, 800)
      Valid pixels: 91577/640000 (14.3%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=6, max=287858, num_faces=287860
      Valid probs shape: (37, 91577)
    ✓ Random_6 (pose=(3.08200124736424, 0.7779527198319611, 2.0942205139378736)): shape (37, 800, 800)
      Valid pixels: 91084/640000 (14.2%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=543, max=287858, num_faces=287860
      Valid probs shape: (37, 91084)
    ✓ Random_7 (pose=(-0.5367116719055884, 2.5474356564467096, -1.6901986865416336)): shape (37, 800, 800)
      Valid pixels: 88111/640000 (13.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=402, max=287858, num_faces=287860
      Valid probs shape: (37, 88111)
    ✓ Random_8 (pose=(-1.8413999071160458, 3.1319077019320085, 0.4168145958334786)): shape (37, 800, 800)
      Valid pixels: 109488/640000 (17.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=10, max=287856, num_faces=287860
      Valid probs shape: (37, 109488)
    ✓ Random_9 (pose=(-0.12659358089169892, -0.49704451761361357, -0.11281879188351374)): shape (37, 800, 800)
      Valid pixels: 71182/640000 (11.1%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=1, max=287628, num_faces=287860
      Valid probs shape: (37, 71182)
    ✓ Random_10 (pose=(-2.3644252932887366, -2.241590026550073, -1.086104068151172)): shape (37, 800, 800)
      Valid pixels: 84346/640000 (13.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=287805, num_faces=287860
      Valid probs shape: (37, 84346)
    ✓ Random_11 (pose=(0.0969827038191391, -2.167737914047599, 2.5756148825682947)): shape (37, 800, 800)
      Valid pixels: 82804/640000 (12.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=504, max=287857, num_faces=287860
      Valid probs shape: (37, 82804)
    ✓ Random_12 (pose=(0.29314907278854596, 0.5950933060808219, 0.018983120986769464)): shape (37, 800, 800)
      Valid pixels: 82980/640000 (13.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=287722, num_faces=287860
      Valid probs shape: (37, 82980)
    ✓ Random_13 (pose=(2.3625632661566973, 2.0001483682209322, -2.8921199813534404)): shape (37, 800, 800)
      Valid pixels: 127664/640000 (19.9%)
      Probs stats: min=0.0000, max=0.9995, mean=0.0270
      Face IDs: min=5, max=287855, num_faces=287860
      Valid probs shape: (37, 127664)
    ✓ Random_14 (pose=(2.001966712478353, 1.589132627599124, 0.2828584502853202)): shape (37, 800, 800)
      Valid pixels: 139430/640000 (21.8%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=9, max=287846, num_faces=287860
      Valid probs shape: (37, 139430)
    P stats: min=0.0000, max=0.9999, mean=0.0232
    Non-zero vertices: 123772/143932
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 20160   975   940  2882     0  1914   955  4670  7503]
  Ground Truth Stats:
    Labels shape: (143932,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-1/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7059
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7915
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7918

  RESULTS:
  RAW:         median(top-10)=0.8397, mean(top-10)=0.8455, median(all)=0.7824, mean(all)=0.7059
  + SMOOTHING: median(top-10)=0.9027, mean(top-10)=0.9046, median(all)=0.8460, mean(all)=0.7915 [+0.0630]
  + MRF:       median(top-10)=0.9028, mean(top-10)=0.9049, median(all)=0.8463, mean(all)=0.7918 [+0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0631

================================================================================
Subject: NKI-TRT-20-10
================================================================================
  Step 0: Generating predictions with V2 model (15 random views)...
  Mesh: 122978 vertices, 245952 faces
  Generating 15 random views...
  Generating predictions for 15 views (continuous camera pose)...
    ✓ Random_0 (pose=(3.106914924449476, -0.07431427169898663, -0.8159871079031977)): shape (37, 800, 800)
      Valid pixels: 34367/640000 (5.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2529, max=245951, num_faces=245952
      Valid probs shape: (37, 34367)
    ✓ Random_1 (pose=(-2.619782073194008, 0.09368406309374411, -0.15305731525058297)): shape (37, 800, 800)
      Valid pixels: 58331/640000 (9.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7817, max=245951, num_faces=245952
      Valid probs shape: (37, 58331)
    ✓ Random_2 (pose=(-2.3137657635863733, -1.3722529471873484, -2.61687311724339)): shape (37, 800, 800)
      Valid pixels: 86667/640000 (13.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=245943, num_faces=245952
      Valid probs shape: (37, 86667)
    ✓ Random_3 (pose=(-2.8158606133072404, 1.0874506681791356, 0.80477084267753)): shape (37, 800, 800)
      Valid pixels: 66558/640000 (10.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=58, max=245944, num_faces=245952
      Valid probs shape: (37, 66558)
    ✓ Random_4 (pose=(-2.30503504286927, -2.500372156372212, -3.004071046879271)): shape (37, 800, 800)
      Valid pixels: 74473/640000 (11.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=11, max=245943, num_faces=245952
      Valid probs shape: (37, 74473)
    ✓ Random_5 (pose=(2.5880264115789657, -0.1746045073385556, -2.6864615634380606)): shape (37, 800, 800)
      Valid pixels: 54557/640000 (8.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5539, max=245951, num_faces=245952
      Valid probs shape: (37, 54557)
    ✓ Random_6 (pose=(2.2435101383625264, 2.498326662778246, 2.7610164663797336)): shape (37, 800, 800)
      Valid pixels: 71722/640000 (11.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=245950, num_faces=245952
      Valid probs shape: (37, 71722)
    ✓ Random_7 (pose=(0.9623237905514159, -2.4604606602165484, 1.5679890540410977)): shape (37, 800, 800)
      Valid pixels: 56046/640000 (8.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=11, max=245947, num_faces=245952
      Valid probs shape: (37, 56046)
    ✓ Random_8 (pose=(2.1548213394672304, -2.2400909871848516, -0.7317161071130069)): shape (37, 800, 800)
      Valid pixels: 82382/640000 (12.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=10, max=245944, num_faces=245952
      Valid probs shape: (37, 82382)
    ✓ Random_9 (pose=(2.817806704071744, -0.03290552245792355, 2.7569916321369483)): shape (37, 800, 800)
      Valid pixels: 49738/640000 (7.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=33586, max=245951, num_faces=245952
      Valid probs shape: (37, 49738)
    ✓ Random_10 (pose=(1.73800047927777, 0.5039674312304174, 1.7440106816987573)): shape (37, 800, 800)
      Valid pixels: 55015/640000 (8.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=245946, num_faces=245952
      Valid probs shape: (37, 55015)
    ✓ Random_11 (pose=(2.86302225138033, 1.514165912629922, -1.0920342048723968)): shape (37, 800, 800)
      Valid pixels: 65877/640000 (10.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=73, max=245949, num_faces=245952
      Valid probs shape: (37, 65877)
    ✓ Random_12 (pose=(1.4137087125669714, 1.0023578764413381, -2.7697188857810704)): shape (37, 800, 800)
      Valid pixels: 69780/640000 (10.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=23, max=245626, num_faces=245952
      Valid probs shape: (37, 69780)
    ✓ Random_13 (pose=(-0.8346960324386936, -1.64641524989817, -0.528356539556746)): shape (37, 800, 800)
      Valid pixels: 77312/640000 (12.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=69, max=245871, num_faces=245952
      Valid probs shape: (37, 77312)
    ✓ Random_14 (pose=(-2.394372403942644, 3.0464238353009563, 0.6304718131262255)): shape (37, 800, 800)
      Valid pixels: 52185/640000 (8.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=245491, num_faces=245952
      Valid probs shape: (37, 52185)
    P stats: min=0.0000, max=1.0000, mean=0.0238
    Non-zero vertices: 108188/122978
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 14790  1176   732  2449     0  1647   816  4277  5216]
  Ground Truth Stats:
    Labels shape: (122978,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-10/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7403
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8024
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8024

  RESULTS:
  RAW:         median(top-10)=0.8857, mean(top-10)=0.8851, median(all)=0.8031, mean(all)=0.7403
  + SMOOTHING: median(top-10)=0.9215, mean(top-10)=0.9216, median(all)=0.8572, mean(all)=0.8024 [+0.0357]
  + MRF:       median(top-10)=0.9222, mean(top-10)=0.9219, median(all)=0.8566, mean(all)=0.8024 [+0.0007]
  TOTAL IMPROVEMENT (median top-10): +0.0364

================================================================================
Subject: NKI-TRT-20-11
================================================================================
  Step 0: Generating predictions with V2 model (15 random views)...
  Mesh: 146103 vertices, 292202 faces
  Generating 15 random views...
  Generating predictions for 15 views (continuous camera pose)...
    ✓ Random_0 (pose=(-1.1178125842787296, 2.1977512434654036, -1.208633459069083)): shape (37, 800, 800)
      Valid pixels: 68602/640000 (10.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1997, max=292169, num_faces=292202
      Valid probs shape: (37, 68602)
    ✓ Random_1 (pose=(2.1144364148102444, -1.395847892032189, -2.692002988076504)): shape (37, 800, 800)
      Valid pixels: 82712/640000 (12.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=14, max=292187, num_faces=292202
      Valid probs shape: (37, 82712)
    ✓ Random_2 (pose=(-0.8977589073970114, 2.264822804574888, 0.9849648871371324)): shape (37, 800, 800)
      Valid pixels: 90477/640000 (14.1%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=907, max=292198, num_faces=292202
      Valid probs shape: (37, 90477)
    ✓ Random_3 (pose=(-1.096990519484479, -0.11629929813047912, -1.6145256192669482)): shape (37, 800, 800)
      Valid pixels: 74439/640000 (11.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=291056, num_faces=292202
      Valid probs shape: (37, 74439)
    ✓ Random_4 (pose=(-1.6551655156097946, -0.8394621230006662, 1.1856778887201358)): shape (37, 800, 800)
      Valid pixels: 80243/640000 (12.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=14, max=292138, num_faces=292202
      Valid probs shape: (37, 80243)
    ✓ Random_5 (pose=(3.047694882664418, 0.32471497442704145, -1.8501245067742107)): shape (37, 800, 800)
      Valid pixels: 65910/640000 (10.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=18819, max=292201, num_faces=292202
      Valid probs shape: (37, 65910)
    ✓ Random_6 (pose=(-1.8065370983550615, 3.079550240390902, -2.9896378544392004)): shape (37, 800, 800)
      Valid pixels: 104223/640000 (16.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=53, max=292002, num_faces=292202
      Valid probs shape: (37, 104223)
    ✓ Random_7 (pose=(2.808195582951062, 0.8828298194531676, -0.38311058738650994)): shape (37, 800, 800)
      Valid pixels: 78904/640000 (12.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=660, max=292201, num_faces=292202
      Valid probs shape: (37, 78904)
    ✓ Random_8 (pose=(-0.5325403501793562, 1.500597619534445, 2.348731115328186)): shape (37, 800, 800)
      Valid pixels: 75819/640000 (11.8%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=0, max=292138, num_faces=292202
      Valid probs shape: (37, 75819)
    ✓ Random_9 (pose=(-2.48512632385529, -2.303294518528665, 1.7678776246091177)): shape (37, 800, 800)
      Valid pixels: 69580/640000 (10.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=291880, num_faces=292202
      Valid probs shape: (37, 69580)
    ✓ Random_10 (pose=(2.628825472633248, 1.55718469215482, -0.4137260059880985)): shape (37, 800, 800)
      Valid pixels: 78165/640000 (12.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=157, max=292138, num_faces=292202
      Valid probs shape: (37, 78165)
    ✓ Random_11 (pose=(-0.9366830524719671, -2.989233732022118, 0.12642669134656925)): shape (37, 800, 800)
      Valid pixels: 89914/640000 (14.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=2370, max=292198, num_faces=292202
      Valid probs shape: (37, 89914)
    ✓ Random_12 (pose=(2.6194139066590187, 0.708383797049104, -1.193058174964835)): shape (37, 800, 800)
      Valid pixels: 78781/640000 (12.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7083, max=292201, num_faces=292202
      Valid probs shape: (37, 78781)
    ✓ Random_13 (pose=(-0.8505348855242967, -2.9753305711024303, 1.7262265997715476)): shape (37, 800, 800)
      Valid pixels: 84339/640000 (13.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=528, max=292201, num_faces=292202
      Valid probs shape: (37, 84339)
    ✓ Random_14 (pose=(-0.32419653537191584, -2.474902553967195, -0.16237085323964395)): shape (37, 800, 800)
      Valid pixels: 77332/640000 (12.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3892, max=292200, num_faces=292202
      Valid probs shape: (37, 77332)
    P stats: min=0.0000, max=1.0000, mean=0.0207
    Non-zero vertices: 112047/146103
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 34056   417   779  2935     0  2395   884  4019  3907]
  Ground Truth Stats:
    Labels shape: (146103,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-11/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6503
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7548
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7551

  RESULTS:
  RAW:         median(top-10)=0.8320, mean(top-10)=0.8344, median(all)=0.6957, mean(all)=0.6503
  + SMOOTHING: median(top-10)=0.9054, mean(top-10)=0.9000, median(all)=0.8026, mean(all)=0.7548 [+0.0734]
  + MRF:       median(top-10)=0.9053, mean(top-10)=0.9004, median(all)=0.8030, mean(all)=0.7551 [-0.0000]
  TOTAL IMPROVEMENT (median top-10): +0.0733

================================================================================
Subject: NKI-TRT-20-12
================================================================================
  Step 0: Generating predictions with V2 model (15 random views)...
  Mesh: 117868 vertices, 235732 faces
  Generating 15 random views...
  Generating predictions for 15 views (continuous camera pose)...
    ✓ Random_0 (pose=(1.8213531511356713, 1.7747272161006444, -0.21766213438264304)): shape (37, 800, 800)
      Valid pixels: 114514/640000 (17.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=235687, num_faces=235732
      Valid probs shape: (37, 114514)
    ✓ Random_1 (pose=(2.9127908401973297, 0.49317347153203706, -0.29069063098617676)): shape (37, 800, 800)
      Valid pixels: 59868/640000 (9.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1657, max=235731, num_faces=235732
      Valid probs shape: (37, 59868)
    ✓ Random_2 (pose=(-1.6525423162730606, 2.337302305367257, -2.310359754363991)): shape (37, 800, 800)
      Valid pixels: 80607/640000 (12.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=235591, num_faces=235732
      Valid probs shape: (37, 80607)
    ✓ Random_3 (pose=(-2.9036162389191635, -2.626867444650423, -2.707167435263985)): shape (37, 800, 800)
      Valid pixels: 70487/640000 (11.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=235654, num_faces=235732
      Valid probs shape: (37, 70487)
    ✓ Random_4 (pose=(-0.13988000935018885, 1.6068352343819123, 2.3995856599037255)): shape (37, 800, 800)
      Valid pixels: 79572/640000 (12.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=300, max=235731, num_faces=235732
      Valid probs shape: (37, 79572)
    ✓ Random_5 (pose=(-0.5926530392181055, -2.096162817702926, -1.3658348328968068)): shape (37, 800, 800)
      Valid pixels: 102349/640000 (16.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=251, max=235731, num_faces=235732
      Valid probs shape: (37, 102349)
    ✓ Random_6 (pose=(-0.14770681054998214, 1.3044856579683026, 2.770838884904026)): shape (37, 800, 800)
      Valid pixels: 70149/640000 (11.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=235731, num_faces=235732
      Valid probs shape: (37, 70149)
    ✓ Random_7 (pose=(0.08982846068069561, 1.4727770558764952, 1.021725725809035)): shape (37, 800, 800)
      Valid pixels: 106932/640000 (16.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=10, max=235585, num_faces=235732
      Valid probs shape: (37, 106932)
    ✓ Random_8 (pose=(-2.15561399810481, -2.1257715675391227, -1.6316408490579513)): shape (37, 800, 800)
      Valid pixels: 76327/640000 (11.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7, max=235591, num_faces=235732
      Valid probs shape: (37, 76327)
    ✓ Random_9 (pose=(-1.2851422358696767, 1.290615266064056, -0.3231927733528521)): shape (37, 800, 800)
      Valid pixels: 107554/640000 (16.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=235587, num_faces=235732
      Valid probs shape: (37, 107554)
    ✓ Random_10 (pose=(0.9867757811941784, 1.9912732564066786, -0.6507387707554271)): shape (37, 800, 800)
      Valid pixels: 109712/640000 (17.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=235687, num_faces=235732
      Valid probs shape: (37, 109712)
    ✓ Random_11 (pose=(0.7513342982036133, -2.0960295378173024, -0.6207284430591997)): shape (37, 800, 800)
      Valid pixels: 79264/640000 (12.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=468, max=235731, num_faces=235732
      Valid probs shape: (37, 79264)
    ✓ Random_12 (pose=(-2.616653311909009, -1.869898030188911, 0.2771475792793989)): shape (37, 800, 800)
      Valid pixels: 102716/640000 (16.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=6, max=235578, num_faces=235732
      Valid probs shape: (37, 102716)
    ✓ Random_13 (pose=(-2.5433649113459813, -0.01298998671031315, -0.5016415658801954)): shape (37, 800, 800)
      Valid pixels: 81946/640000 (12.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=41141, max=235731, num_faces=235732
      Valid probs shape: (37, 81946)
    ✓ Random_14 (pose=(-0.40196395560597553, -1.0193218877138932, 1.3665433308684864)): shape (37, 800, 800)
      Valid pixels: 96316/640000 (15.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=235687, num_faces=235732
      Valid probs shape: (37, 96316)
    P stats: min=0.0000, max=0.9999, mean=0.0233
    Non-zero vertices: 101804/117868
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 16064   534   904  3087     0  2366  1033  3203  4121]
  Ground Truth Stats:
    Labels shape: (117868,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-12/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7317
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7912
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7918

  RESULTS:
  RAW:         median(top-10)=0.8755, mean(top-10)=0.8773, median(all)=0.7969, mean(all)=0.7317
  + SMOOTHING: median(top-10)=0.9086, mean(top-10)=0.9129, median(all)=0.8401, mean(all)=0.7912 [+0.0331]
  + MRF:       median(top-10)=0.9091, mean(top-10)=0.9133, median(all)=0.8407, mean(all)=0.7918 [+0.0005]
  TOTAL IMPROVEMENT (median top-10): +0.0336

================================================================================
Subject: NKI-TRT-20-13
================================================================================
  Step 0: Generating predictions with V2 model (15 random views)...
  Mesh: 168760 vertices, 337516 faces
  Generating 15 random views...
  Generating predictions for 15 views (continuous camera pose)...
    ✓ Random_0 (pose=(-0.3441393640016175, 0.541673803589767, 0.6078085108438818)): shape (37, 800, 800)
      Valid pixels: 76181/640000 (11.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=337207, num_faces=337516
      Valid probs shape: (37, 76181)
    ✓ Random_1 (pose=(2.421076601173046, 1.3219481074921582, -0.21256390327692642)): shape (37, 800, 800)
      Valid pixels: 88548/640000 (13.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=273, max=337511, num_faces=337516
      Valid probs shape: (37, 88548)
    ✓ Random_2 (pose=(-1.6499651835112603, -3.0381066735849447, 2.775956537452421)): shape (37, 800, 800)
      Valid pixels: 105588/640000 (16.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=337512, num_faces=337516
      Valid probs shape: (37, 105588)
    ✓ Random_3 (pose=(-1.4320236805991167, 1.3656608883595567, 1.336285891646705)): shape (37, 800, 800)
      Valid pixels: 71125/640000 (11.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=34, max=337514, num_faces=337516
      Valid probs shape: (37, 71125)
    ✓ Random_4 (pose=(-2.5336251308116498, -2.451696309875344, 2.8861334388254782)): shape (37, 800, 800)
      Valid pixels: 68490/640000 (10.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=337514, num_faces=337516
      Valid probs shape: (37, 68490)
    ✓ Random_5 (pose=(3.049935399918658, -1.8627281851775688, 1.0319288216781626)): shape (37, 800, 800)
      Valid pixels: 97289/640000 (15.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=9, max=337435, num_faces=337516
      Valid probs shape: (37, 97289)
    ✓ Random_6 (pose=(-2.207148961012175, 0.9906282280052761, -2.085864937823569)): shape (37, 800, 800)
      Valid pixels: 59936/640000 (9.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=472, max=337515, num_faces=337516
      Valid probs shape: (37, 59936)
    ✓ Random_7 (pose=(1.5688793296803016, -1.8001211185200212, -0.1332641207960612)): shape (37, 800, 800)
      Valid pixels: 107276/640000 (16.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8, max=337515, num_faces=337516
      Valid probs shape: (37, 107276)
    ✓ Random_8 (pose=(3.033319457889638, -0.7533466246753182, -0.5318850224927019)): shape (37, 800, 800)
      Valid pixels: 65136/640000 (10.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=968, max=337515, num_faces=337516
      Valid probs shape: (37, 65136)
    ✓ Random_9 (pose=(-2.0472457423398476, -1.5913382776756653, 2.027240252893007)): shape (37, 800, 800)
      Valid pixels: 67398/640000 (10.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=337514, num_faces=337516
      Valid probs shape: (37, 67398)
    ✓ Random_10 (pose=(0.14196220974058527, -2.453770155363592, 2.0648801314913987)): shape (37, 800, 800)
      Valid pixels: 65910/640000 (10.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=972, max=337515, num_faces=337516
      Valid probs shape: (37, 65910)
    ✓ Random_11 (pose=(-2.728880934454374, 2.4400876476090643, -2.197610335423439)): shape (37, 800, 800)
      Valid pixels: 67684/640000 (10.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=337433, num_faces=337516
      Valid probs shape: (37, 67684)
    ✓ Random_12 (pose=(-2.53932204660606, 1.7435483691965974, 1.8267221327235825)): shape (37, 800, 800)
      Valid pixels: 104624/640000 (16.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=25, max=337515, num_faces=337516
      Valid probs shape: (37, 104624)
    ✓ Random_13 (pose=(-2.853790157820202, -0.8234310548821155, -0.7714893182171023)): shape (37, 800, 800)
      Valid pixels: 61874/640000 (9.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=471, max=337515, num_faces=337516
      Valid probs shape: (37, 61874)
    ✓ Random_14 (pose=(-2.310456114501309, 3.1031940439547228, -2.5501767045102497)): shape (37, 800, 800)
      Valid pixels: 71889/640000 (11.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=337514, num_faces=337516
      Valid probs shape: (37, 71889)
    P stats: min=0.0000, max=0.9999, mean=0.0214
    Non-zero vertices: 133917/168760
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 34843   642  1795  3490     0  2341   892  4826  7374]
  Ground Truth Stats:
    Labels shape: (168760,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-13/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6782
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7652
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7653

  RESULTS:
  RAW:         median(top-10)=0.8550, mean(top-10)=0.8603, median(all)=0.7589, mean(all)=0.6782
  + SMOOTHING: median(top-10)=0.9054, mean(top-10)=0.9085, median(all)=0.8258, mean(all)=0.7652 [+0.0504]
  + MRF:       median(top-10)=0.9056, mean(top-10)=0.9087, median(all)=0.8260, mean(all)=0.7653 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0506

================================================================================
Subject: NKI-TRT-20-14
================================================================================
  Step 0: Generating predictions with V2 model (15 random views)...
  Mesh: 142909 vertices, 285814 faces
  Generating 15 random views...
  Generating predictions for 15 views (continuous camera pose)...
    ✓ Random_0 (pose=(-1.4057084930316344, 1.3547351145159592, -1.0003748466994336)): shape (37, 800, 800)
      Valid pixels: 72658/640000 (11.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=285421, num_faces=285814
      Valid probs shape: (37, 72658)
    ✓ Random_1 (pose=(3.02295402450972, -3.100814194861944, -2.3156303036685024)): shape (37, 800, 800)
      Valid pixels: 41258/640000 (6.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=285698, num_faces=285814
      Valid probs shape: (37, 41258)
    ✓ Random_2 (pose=(2.9809026211167415, 1.6257569377717713, -1.4855940716963731)): shape (37, 800, 800)
      Valid pixels: 76429/640000 (11.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=22, max=285812, num_faces=285814
      Valid probs shape: (37, 76429)
    ✓ Random_3 (pose=(-0.7881047555076535, -1.6927047249087996, 1.9957193967795055)): shape (37, 800, 800)
      Valid pixels: 91453/640000 (14.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6, max=285813, num_faces=285814
      Valid probs shape: (37, 91453)
    ✓ Random_4 (pose=(-1.7286315072902056, 1.723227268927113, -2.0723786085262565)): shape (37, 800, 800)
      Valid pixels: 62491/640000 (9.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=285813, num_faces=285814
      Valid probs shape: (37, 62491)
    ✓ Random_5 (pose=(-1.260501444920939, -0.35970129878113566, 1.0273291919772696)): shape (37, 800, 800)
      Valid pixels: 64622/640000 (10.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=285812, num_faces=285814
      Valid probs shape: (37, 64622)
    ✓ Random_6 (pose=(-1.897434376308913, 0.8855046067373769, 2.9424039403827402)): shape (37, 800, 800)
      Valid pixels: 86375/640000 (13.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7, max=285812, num_faces=285814
      Valid probs shape: (37, 86375)
    ✓ Random_7 (pose=(1.788107159518388, -2.3709060620787854, -0.9311810784710919)): shape (37, 800, 800)
      Valid pixels: 85564/640000 (13.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7, max=285813, num_faces=285814
      Valid probs shape: (37, 85564)
    ✓ Random_8 (pose=(0.49851487448052145, 1.6736690851760576, 2.8967704095254545)): shape (37, 800, 800)
      Valid pixels: 67759/640000 (10.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=25, max=285812, num_faces=285814
      Valid probs shape: (37, 67759)
    ✓ Random_9 (pose=(-2.5537442717490633, 2.4380267727031413, -1.1142168925489644)): shape (37, 800, 800)
      Valid pixels: 71570/640000 (11.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=285489, num_faces=285814
      Valid probs shape: (37, 71570)
    ✓ Random_10 (pose=(-2.4718501449633123, 1.1241168991602075, -2.7586300741766925)): shape (37, 800, 800)
      Valid pixels: 62690/640000 (9.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=285809, num_faces=285814
      Valid probs shape: (37, 62690)
    ✓ Random_11 (pose=(0.9625020246751834, 1.3261628270553398, -1.095872914348651)): shape (37, 800, 800)
      Valid pixels: 90193/640000 (14.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6, max=285813, num_faces=285814
      Valid probs shape: (37, 90193)
    ✓ Random_12 (pose=(-2.0247637799178437, 1.490550032649816, -1.3275197263437413)): shape (37, 800, 800)
      Valid pixels: 83487/640000 (13.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=285423, num_faces=285814
      Valid probs shape: (37, 83487)
    ✓ Random_13 (pose=(-2.13884554885189, 1.3003474766094758, 1.469800906853095)): shape (37, 800, 800)
      Valid pixels: 75090/640000 (11.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=42, max=285813, num_faces=285814
      Valid probs shape: (37, 75090)
    ✓ Random_14 (pose=(-0.07519916997142406, 1.8597337169776296, 2.952830350401336)): shape (37, 800, 800)
      Valid pixels: 59911/640000 (9.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=788, max=285813, num_faces=285814
      Valid probs shape: (37, 59911)
    P stats: min=0.0000, max=1.0000, mean=0.0231
    Non-zero vertices: 122169/142909
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 35]
    Pred label counts: [    0 20740  1189  1219  2505     0  2240  1109  5020  6337]
  Ground Truth Stats:
    Labels shape: (142909,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-14/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7216
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=33
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7905
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=33
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7907

  RESULTS:
  RAW:         median(top-10)=0.8797, mean(top-10)=0.8824, median(all)=0.7956, mean(all)=0.7216
  + SMOOTHING: median(top-10)=0.9248, mean(top-10)=0.9240, median(all)=0.8518, mean(all)=0.7905 [+0.0451]
  + MRF:       median(top-10)=0.9253, mean(top-10)=0.9243, median(all)=0.8528, mean(all)=0.7907 [+0.0004]
  TOTAL IMPROVEMENT (median top-10): +0.0455

================================================================================
Subject: NKI-TRT-20-15
================================================================================
  Step 0: Generating predictions with V2 model (15 random views)...
  Mesh: 133351 vertices, 266698 faces
  Generating 15 random views...
  Generating predictions for 15 views (continuous camera pose)...
    ✓ Random_0 (pose=(1.0008325004546101, 2.517905846923016, 1.1334926272900487)): shape (37, 800, 800)
      Valid pixels: 63856/640000 (10.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=409, max=266697, num_faces=266698
      Valid probs shape: (37, 63856)
    ✓ Random_1 (pose=(-2.660887405207877, 0.8250907068101272, 0.05246870565009809)): shape (37, 800, 800)
      Valid pixels: 79093/640000 (12.4%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=1532, max=266693, num_faces=266698
      Valid probs shape: (37, 79093)
    ✓ Random_2 (pose=(-0.9582808347386713, -1.2035498845060215, 1.7187708191932956)): shape (37, 800, 800)
      Valid pixels: 101739/640000 (15.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8, max=266663, num_faces=266698
      Valid probs shape: (37, 101739)
    ✓ Random_3 (pose=(-0.2674084575012676, -1.9193674955970565, -0.5951462749150784)): shape (37, 800, 800)
      Valid pixels: 88220/640000 (13.8%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=562, max=266693, num_faces=266698
      Valid probs shape: (37, 88220)
    ✓ Random_4 (pose=(-2.11186805513478, 0.9168922619744286, 2.943366988201075)): shape (37, 800, 800)
      Valid pixels: 106790/640000 (16.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=188, max=266697, num_faces=266698
      Valid probs shape: (37, 106790)
    ✓ Random_5 (pose=(-0.07249080306546496, -2.0140537123996722, -0.14285480837285291)): shape (37, 800, 800)
      Valid pixels: 77023/640000 (12.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1923, max=266693, num_faces=266698
      Valid probs shape: (37, 77023)
    ✓ Random_6 (pose=(-1.8833426052748716, -1.0203622614306553, -2.1998649131207513)): shape (37, 800, 800)
      Valid pixels: 93610/640000 (14.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=191, max=266695, num_faces=266698
      Valid probs shape: (37, 93610)
    ✓ Random_7 (pose=(-3.0595728019121107, -1.9497546242560906, 2.711825620773304)): shape (37, 800, 800)
      Valid pixels: 70459/640000 (11.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8, max=266663, num_faces=266698
      Valid probs shape: (37, 70459)
    ✓ Random_8 (pose=(0.03319247911611267, -2.1277704383466585, 1.724881248235901)): shape (37, 800, 800)
      Valid pixels: 100482/640000 (15.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=186, max=266697, num_faces=266698
      Valid probs shape: (37, 100482)
    ✓ Random_9 (pose=(-1.3625348816683533, -1.3268746260480442, 1.494516362901738)): shape (37, 800, 800)
      Valid pixels: 72500/640000 (11.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=266663, num_faces=266698
      Valid probs shape: (37, 72500)
    ✓ Random_10 (pose=(-2.889739331126917, -0.6757309590723906, 2.054785172019516)): shape (37, 800, 800)
      Valid pixels: 77086/640000 (12.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8499, max=266696, num_faces=266698
      Valid probs shape: (37, 77086)
    ✓ Random_11 (pose=(-2.7628480078569093, -0.0040856803703008815, -3.1074369102863875)): shape (37, 800, 800)
      Valid pixels: 65194/640000 (10.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=935, max=266697, num_faces=266698
      Valid probs shape: (37, 65194)
    ✓ Random_12 (pose=(-2.770708674919664, -1.7226189517943338, -1.5003133106159356)): shape (37, 800, 800)
      Valid pixels: 101618/640000 (15.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=9, max=266688, num_faces=266698
      Valid probs shape: (37, 101618)
    ✓ Random_13 (pose=(-1.8146073807810152, -1.8672712703472736, 2.613533765089363)): shape (37, 800, 800)
      Valid pixels: 108505/640000 (17.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=266663, num_faces=266698
      Valid probs shape: (37, 108505)
    ✓ Random_14 (pose=(0.2553118908346361, 0.6035361134169679, -2.053917820261076)): shape (37, 800, 800)
      Valid pixels: 66472/640000 (10.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=266661, num_faces=266698
      Valid probs shape: (37, 66472)
    P stats: min=0.0000, max=1.0000, mean=0.0194
    Non-zero vertices: 95927/133351
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 35]
    Pred label counts: [    0 37424   502   957  1972     0  1695  1079  4374  2961]
  Ground Truth Stats:
    Labels shape: (133351,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-15/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
    MRF iteration 5/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6595
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=33
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7589
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=33
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7595

  RESULTS:
  RAW:         median(top-10)=0.8404, mean(top-10)=0.8439, median(all)=0.7238, mean(all)=0.6595
  + SMOOTHING: median(top-10)=0.8991, mean(top-10)=0.9015, median(all)=0.8174, mean(all)=0.7589 [+0.0587]
  + MRF:       median(top-10)=0.8995, mean(top-10)=0.9020, median(all)=0.8176, mean(all)=0.7595 [+0.0004]
  TOTAL IMPROVEMENT (median top-10): +0.0590

================================================================================
Subject: NKI-TRT-20-16
================================================================================
  Step 0: Generating predictions with V2 model (15 random views)...
  Mesh: 157852 vertices, 315700 faces
  Generating 15 random views...
  Generating predictions for 15 views (continuous camera pose)...
    ✓ Random_0 (pose=(1.7035197457166316, -2.6303104878248353, 2.6228097238372072)): shape (37, 800, 800)
      Valid pixels: 98409/640000 (15.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=107, max=315696, num_faces=315700
      Valid probs shape: (37, 98409)
    ✓ Random_1 (pose=(0.9676964045835712, 0.7597369395188527, 2.943538356278946)): shape (37, 800, 800)
      Valid pixels: 81933/640000 (12.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=10, max=315699, num_faces=315700
      Valid probs shape: (37, 81933)
    ✓ Random_2 (pose=(-1.9044303405855414, 2.1536081982895556, -1.1519659119877477)): shape (37, 800, 800)
      Valid pixels: 92096/640000 (14.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=40, max=315685, num_faces=315700
      Valid probs shape: (37, 92096)
    ✓ Random_3 (pose=(1.5470568212176579, -2.9018966966966957, 0.9890887980131255)): shape (37, 800, 800)
      Valid pixels: 74436/640000 (11.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=28, max=315625, num_faces=315700
      Valid probs shape: (37, 74436)
    ✓ Random_4 (pose=(0.4639851505296564, -0.4254704529424074, -1.569515205079925)): shape (37, 800, 800)
      Valid pixels: 58307/640000 (9.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=28, max=315256, num_faces=315700
      Valid probs shape: (37, 58307)
    ✓ Random_5 (pose=(-0.05559290018880825, 2.814751683638403, 1.4918657957837302)): shape (37, 800, 800)
      Valid pixels: 57857/640000 (9.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=14997, max=315698, num_faces=315700
      Valid probs shape: (37, 57857)
    ✓ Random_6 (pose=(-2.6691715911763474, 2.882134982682434, -0.2172702454860862)): shape (37, 800, 800)
      Valid pixels: 64900/640000 (10.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=17, max=314479, num_faces=315700
      Valid probs shape: (37, 64900)
    ✓ Random_7 (pose=(2.68708583267982, 0.5686303292352473, -2.4919747838837516)): shape (37, 800, 800)
      Valid pixels: 79406/640000 (12.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=14448, max=315696, num_faces=315700
      Valid probs shape: (37, 79406)
    ✓ Random_8 (pose=(-2.6181593106063703, 2.662675883860943, 0.6075942434770671)): shape (37, 800, 800)
      Valid pixels: 53756/640000 (8.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=18, max=315452, num_faces=315700
      Valid probs shape: (37, 53756)
    ✓ Random_9 (pose=(0.16152399809765727, 0.19590452984646678, -0.4249409606588568)): shape (37, 800, 800)
      Valid pixels: 51755/640000 (8.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=18, max=315256, num_faces=315700
      Valid probs shape: (37, 51755)
    ✓ Random_10 (pose=(1.1875020253965927, 2.540684714219476, -2.2141572492115627)): shape (37, 800, 800)
      Valid pixels: 72982/640000 (11.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1677, max=315699, num_faces=315700
      Valid probs shape: (37, 72982)
    ✓ Random_11 (pose=(-0.5370864296699689, 2.991712060960012, -0.996435451440556)): shape (37, 800, 800)
      Valid pixels: 56966/640000 (8.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=61510, max=315696, num_faces=315700
      Valid probs shape: (37, 56966)
    ✓ Random_12 (pose=(0.21095486240300465, -0.8529583522814637, -1.0624042221407044)): shape (37, 800, 800)
      Valid pixels: 64731/640000 (10.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=25, max=315699, num_faces=315700
      Valid probs shape: (37, 64731)
    ✓ Random_13 (pose=(2.0509495607663997, 1.0712841966592777, 2.8667665658968033)): shape (37, 800, 800)
      Valid pixels: 94010/640000 (14.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=159, max=315696, num_faces=315700
      Valid probs shape: (37, 94010)
    ✓ Random_14 (pose=(-1.8374656368079858, -3.132760321886514, 2.7973497444748334)): shape (37, 800, 800)
      Valid pixels: 99319/640000 (15.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8, max=315625, num_faces=315700
      Valid probs shape: (37, 99319)
    P stats: min=0.0000, max=1.0000, mean=0.0235
    Non-zero vertices: 137121/157852
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 20731  1186  1009  3800     0  1766   706  5129  6455]
  Ground Truth Stats:
    Labels shape: (157852,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-16/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7501
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8217
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8220

  RESULTS:
  RAW:         median(top-10)=0.8794, mean(top-10)=0.8844, median(all)=0.7795, mean(all)=0.7501
  + SMOOTHING: median(top-10)=0.9246, mean(top-10)=0.9256, median(all)=0.8582, mean(all)=0.8217 [+0.0451]
  + MRF:       median(top-10)=0.9248, mean(top-10)=0.9258, median(all)=0.8583, mean(all)=0.8220 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0454

================================================================================
Subject: NKI-TRT-20-17
================================================================================
  Step 0: Generating predictions with V2 model (15 random views)...
  Mesh: 135896 vertices, 271788 faces
  Generating 15 random views...
  Generating predictions for 15 views (continuous camera pose)...
    ✓ Random_0 (pose=(-2.9413963617623633, 1.3864976953637393, -3.007702905629258)): shape (37, 800, 800)
      Valid pixels: 60928/640000 (9.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=22, max=271721, num_faces=271788
      Valid probs shape: (37, 60928)
    ✓ Random_1 (pose=(-2.6229779898289, -0.12328378197667078, -1.5236437653258392)): shape (37, 800, 800)
      Valid pixels: 48604/640000 (7.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5708, max=271785, num_faces=271788
      Valid probs shape: (37, 48604)
    ✓ Random_2 (pose=(-0.37740231849414174, 1.3879941010008618, -2.0907534337023703)): shape (37, 800, 800)
      Valid pixels: 93062/640000 (14.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=271787, num_faces=271788
      Valid probs shape: (37, 93062)
    ✓ Random_3 (pose=(-0.9307029215830629, 0.6288010861280675, -2.1242682221146927)): shape (37, 800, 800)
      Valid pixels: 71405/640000 (11.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=271785, num_faces=271788
      Valid probs shape: (37, 71405)
    ✓ Random_4 (pose=(-0.44060285233419627, 1.791082316730428, -2.8924345240962586)): shape (37, 800, 800)
      Valid pixels: 89193/640000 (13.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=89, max=271787, num_faces=271788
      Valid probs shape: (37, 89193)
    ✓ Random_5 (pose=(-1.8298688736229998, 1.8149904858971313, 2.778035462167665)): shape (37, 800, 800)
      Valid pixels: 93741/640000 (14.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8, max=271787, num_faces=271788
      Valid probs shape: (37, 93741)
    ✓ Random_6 (pose=(2.934625173518442, -0.5141503980452882, -1.669821698956235)): shape (37, 800, 800)
      Valid pixels: 57274/640000 (8.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1269, max=271787, num_faces=271788
      Valid probs shape: (37, 57274)
    ✓ Random_7 (pose=(-2.146798019386499, 0.9148791270234256, -0.6670205301997805)): shape (37, 800, 800)
      Valid pixels: 87335/640000 (13.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1124, max=271779, num_faces=271788
      Valid probs shape: (37, 87335)
    ✓ Random_8 (pose=(1.0247790510691877, -0.5399740403231061, 2.0575068988369614)): shape (37, 800, 800)
      Valid pixels: 64946/640000 (10.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=271627, num_faces=271788
      Valid probs shape: (37, 64946)
    ✓ Random_9 (pose=(-1.9166488172844474, -2.185127919781149, -0.4452225726800978)): shape (37, 800, 800)
      Valid pixels: 87848/640000 (13.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=271715, num_faces=271788
      Valid probs shape: (37, 87848)
    ✓ Random_10 (pose=(1.4187084497832956, 0.7833831427701203, -0.9072420188116919)): shape (37, 800, 800)
      Valid pixels: 92488/640000 (14.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=271787, num_faces=271788
      Valid probs shape: (37, 92488)
    ✓ Random_11 (pose=(-0.06130209566278655, 0.060355347134092074, -1.7205879816552752)): shape (37, 800, 800)
      Valid pixels: 40200/640000 (6.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=271388, num_faces=271788
      Valid probs shape: (37, 40200)
    ✓ Random_12 (pose=(1.3388850333812128, -1.2844146089531743, 1.121655231413004)): shape (37, 800, 800)
      Valid pixels: 70113/640000 (11.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=271785, num_faces=271788
      Valid probs shape: (37, 70113)
    ✓ Random_13 (pose=(-1.9287474811697891, 0.5667241927021531, 2.8720868919682605)): shape (37, 800, 800)
      Valid pixels: 89104/640000 (13.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=155, max=271787, num_faces=271788
      Valid probs shape: (37, 89104)
    ✓ Random_14 (pose=(-0.8513807281400991, 1.0142476640138431, 1.8364662124257976)): shape (37, 800, 800)
      Valid pixels: 64235/640000 (10.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=271719, num_faces=271788
      Valid probs shape: (37, 64235)
    P stats: min=0.0000, max=1.0000, mean=0.0232
    Non-zero vertices: 116452/135896
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 19444   592  1358  3124     0  1740  1093  4343  5287]
  Ground Truth Stats:
    Labels shape: (135896,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-17/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7158
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8025
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8029

  RESULTS:
  RAW:         median(top-10)=0.8780, mean(top-10)=0.8803, median(all)=0.7699, mean(all)=0.7158
  + SMOOTHING: median(top-10)=0.9214, mean(top-10)=0.9235, median(all)=0.8377, mean(all)=0.8025 [+0.0434]
  + MRF:       median(top-10)=0.9216, mean(top-10)=0.9239, median(all)=0.8380, mean(all)=0.8029 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0436

================================================================================
Subject: NKI-TRT-20-18
================================================================================
  Step 0: Generating predictions with V2 model (15 random views)...
  Mesh: 132036 vertices, 264068 faces
  Generating 15 random views...
  Generating predictions for 15 views (continuous camera pose)...
    ✓ Random_0 (pose=(3.039361851313573, -1.1665862687267732, 0.30614883524065917)): shape (37, 800, 800)
      Valid pixels: 68557/640000 (10.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2418, max=263924, num_faces=264068
      Valid probs shape: (37, 68557)
    ✓ Random_1 (pose=(-0.23997705602621133, -0.6281328044904662, 0.5797231347744067)): shape (37, 800, 800)
      Valid pixels: 52603/640000 (8.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=264064, num_faces=264068
      Valid probs shape: (37, 52603)
    ✓ Random_2 (pose=(-0.0032017228456959756, -1.1719202003762261, -2.7155380451745392)): shape (37, 800, 800)
      Valid pixels: 82854/640000 (12.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=263916, num_faces=264068
      Valid probs shape: (37, 82854)
    ✓ Random_3 (pose=(1.738354725779848, -0.9463880320617517, 0.1858642143286624)): shape (37, 800, 800)
      Valid pixels: 95088/640000 (14.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=264062, num_faces=264068
      Valid probs shape: (37, 95088)
    ✓ Random_4 (pose=(2.5317744000891063, -2.678996116771031, 0.0136879769273488)): shape (37, 800, 800)
      Valid pixels: 68847/640000 (10.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=264055, num_faces=264068
      Valid probs shape: (37, 68847)
    ✓ Random_5 (pose=(3.1043680877979796, 2.193263174144663, -0.5935062228875307)): shape (37, 800, 800)
      Valid pixels: 62101/640000 (9.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=264066, num_faces=264068
      Valid probs shape: (37, 62101)
    ✓ Random_6 (pose=(3.0218850836604556, 0.6470567953269155, -0.3600397409653948)): shape (37, 800, 800)
      Valid pixels: 60770/640000 (9.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=807, max=264065, num_faces=264068
      Valid probs shape: (37, 60770)
    ✓ Random_7 (pose=(-1.820803236639763, 2.3585742443858484, 1.0011104521534167)): shape (37, 800, 800)
      Valid pixels: 69275/640000 (10.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=13, max=264066, num_faces=264068
      Valid probs shape: (37, 69275)
    ✓ Random_8 (pose=(0.6393156023132929, 2.2854981336742792, -0.5238011922104762)): shape (37, 800, 800)
      Valid pixels: 86355/640000 (13.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=43, max=264065, num_faces=264068
      Valid probs shape: (37, 86355)
    ✓ Random_9 (pose=(-0.9947970490744731, -2.456707050161927, 2.4764817907260728)): shape (37, 800, 800)
      Valid pixels: 102804/640000 (16.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=264064, num_faces=264068
      Valid probs shape: (37, 102804)
    ✓ Random_10 (pose=(2.11318206458606, 0.516760623318393, 1.42643923426892)): shape (37, 800, 800)
      Valid pixels: 66860/640000 (10.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=40, max=263793, num_faces=264068
      Valid probs shape: (37, 66860)
    ✓ Random_11 (pose=(-1.8230801915225896, -1.673043851898632, -1.4437618965710202)): shape (37, 800, 800)
      Valid pixels: 65018/640000 (10.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=17, max=263811, num_faces=264068
      Valid probs shape: (37, 65018)
    ✓ Random_12 (pose=(1.2770377010677043, 0.71097768572203, -0.6508659687452356)): shape (37, 800, 800)
      Valid pixels: 104169/640000 (16.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=9, max=264064, num_faces=264068
      Valid probs shape: (37, 104169)
    ✓ Random_13 (pose=(1.102481877611142, 0.0016856377528959854, 2.2826263265563576)): shape (37, 800, 800)
      Valid pixels: 91458/640000 (14.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=263923, num_faces=264068
      Valid probs shape: (37, 91458)
    ✓ Random_14 (pose=(2.8503867896532054, -2.3496940685166896, -0.1769995810908589)): shape (37, 800, 800)
      Valid pixels: 65787/640000 (10.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=264055, num_faces=264068
      Valid probs shape: (37, 65787)
    P stats: min=0.0000, max=0.9999, mean=0.0224
    Non-zero vertices: 109199/132036
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 35]
    Pred label counts: [    0 22837   312   940  2887     0  2337   952  4041  5534]
  Ground Truth Stats:
    Labels shape: (132036,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-18/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
/autofs/space/ballarat_004/users/np341/PRIR_Code/Training/White/prir_x_y_z_conditional_1_unet/run_training_and_prediction/test_conditioned_model_v2.py:201: RuntimeWarning: invalid value encountered in divide
  P_normalized = P_smooth / np.sum(P_smooth, axis=0, keepdims=True)
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6808
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7519
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=33
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7741

  RESULTS:
  RAW:         median(top-10)=0.8576, mean(top-10)=0.8585, median(all)=0.7908, mean(all)=0.6808
  + SMOOTHING: median(top-10)=0.9099, mean(top-10)=0.9088, median(all)=0.8536, mean(all)=0.7519 [+0.0522]
  + MRF:       median(top-10)=0.9099, mean(top-10)=0.9089, median(all)=0.8564, mean(all)=0.7741 [-0.0000]
  TOTAL IMPROVEMENT (median top-10): +0.0522

================================================================================
Subject: NKI-TRT-20-19
================================================================================
  Step 0: Generating predictions with V2 model (15 random views)...
  Mesh: 131542 vertices, 263080 faces
  Generating 15 random views...
  Generating predictions for 15 views (continuous camera pose)...
    ✓ Random_0 (pose=(1.2182448971667466, 0.3341028904776002, 2.381379209406151)): shape (37, 800, 800)
      Valid pixels: 84445/640000 (13.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=262996, num_faces=263080
      Valid probs shape: (37, 84445)
    ✓ Random_1 (pose=(-2.5598857253189498, 0.9239974774257353, -1.4804076793516434)): shape (37, 800, 800)
      Valid pixels: 80213/640000 (12.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=878, max=263077, num_faces=263080
      Valid probs shape: (37, 80213)
    ✓ Random_2 (pose=(0.47508672009099584, 0.27862199953246325, 0.7859046432230379)): shape (37, 800, 800)
      Valid pixels: 42737/640000 (6.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=8, max=262830, num_faces=263080
      Valid probs shape: (37, 42737)
    ✓ Random_3 (pose=(-1.784950061540209, 1.988081304510522, -2.3616409531915696)): shape (37, 800, 800)
      Valid pixels: 62194/640000 (9.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=15, max=262969, num_faces=263080
      Valid probs shape: (37, 62194)
    ✓ Random_4 (pose=(2.812760672054492, -0.4038554300744246, -1.2480921442897694)): shape (37, 800, 800)
      Valid pixels: 56063/640000 (8.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=576, max=263079, num_faces=263080
      Valid probs shape: (37, 56063)
    ✓ Random_5 (pose=(-0.5155731592783925, -0.36309901338097106, -1.7214274715924875)): shape (37, 800, 800)
      Valid pixels: 55223/640000 (8.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=262970, num_faces=263080
      Valid probs shape: (37, 55223)
    ✓ Random_6 (pose=(-2.8652552698856946, -1.7871310353017533, -0.3298194673248207)): shape (37, 800, 800)
      Valid pixels: 56427/640000 (8.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=18, max=262998, num_faces=263080
      Valid probs shape: (37, 56427)
    ✓ Random_7 (pose=(-0.8701495684014509, 0.16645233344113075, 2.8437132952271202)): shape (37, 800, 800)
      Valid pixels: 73562/640000 (11.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=262833, num_faces=263080
      Valid probs shape: (37, 73562)
    ✓ Random_8 (pose=(1.4042927103104041, 2.438157126317333, -1.6515744068917178)): shape (37, 800, 800)
      Valid pixels: 61929/640000 (9.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=121, max=263078, num_faces=263080
      Valid probs shape: (37, 61929)
    ✓ Random_9 (pose=(-1.570799561592065, -0.05353321795966348, 2.236627265086737)): shape (37, 800, 800)
      Valid pixels: 85705/640000 (13.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=263072, num_faces=263080
      Valid probs shape: (37, 85705)
    ✓ Random_10 (pose=(1.1046874632217447, 2.97411579043455, -0.55546365847428)): shape (37, 800, 800)
      Valid pixels: 84379/640000 (13.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=132, max=263074, num_faces=263080
      Valid probs shape: (37, 84379)
    ✓ Random_11 (pose=(0.2762609769436608, -2.8507053836718503, -1.58249702736309)): shape (37, 800, 800)
      Valid pixels: 45180/640000 (7.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5628, max=263079, num_faces=263080
      Valid probs shape: (37, 45180)
    ✓ Random_12 (pose=(1.0720470917310898, 1.6681912869910294, -1.640395354008437)): shape (37, 800, 800)
      Valid pixels: 78202/640000 (12.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=52, max=263076, num_faces=263080
      Valid probs shape: (37, 78202)
    ✓ Random_13 (pose=(-2.384592049295721, 1.8102093349043198, -2.628526774880294)): shape (37, 800, 800)
      Valid pixels: 56919/640000 (8.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=18, max=262991, num_faces=263080
      Valid probs shape: (37, 56919)
    ✓ Random_14 (pose=(0.6621360528796534, -0.8010368228167342, -1.7012312798432205)): shape (37, 800, 800)
      Valid pixels: 59290/640000 (9.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=9, max=263077, num_faces=263080
      Valid probs shape: (37, 59290)
    P stats: min=0.0000, max=1.0000, mean=0.0233
    Non-zero vertices: 113295/131542
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 18247   751  1025  2943     0  1965  1094  4132  6065]
  Ground Truth Stats:
    Labels shape: (131542,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-19/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
    MRF iteration 5/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7327
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7812
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7815

  RESULTS:
  RAW:         median(top-10)=0.8627, mean(top-10)=0.8714, median(all)=0.7758, mean(all)=0.7327
  + SMOOTHING: median(top-10)=0.9201, mean(top-10)=0.9190, median(all)=0.8634, mean(all)=0.7812 [+0.0574]
  + MRF:       median(top-10)=0.9200, mean(top-10)=0.9191, median(all)=0.8632, mean(all)=0.7815 [-0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0573

================================================================================
Subject: NKI-TRT-20-2
================================================================================
  Step 0: Generating predictions with V2 model (15 random views)...
  Mesh: 174172 vertices, 348340 faces
  Generating 15 random views...
  Generating predictions for 15 views (continuous camera pose)...
    ✓ Random_0 (pose=(-1.353866128971747, -0.8293014677516646, -1.6129119394142215)): shape (37, 800, 800)
      Valid pixels: 61033/640000 (9.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=347551, num_faces=348340
      Valid probs shape: (37, 61033)
    ✓ Random_1 (pose=(1.0026192002036156, 1.6162813128032916, 2.7692995505785207)): shape (37, 800, 800)
      Valid pixels: 80868/640000 (12.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=16, max=348339, num_faces=348340
      Valid probs shape: (37, 80868)
    ✓ Random_2 (pose=(2.454847043280842, 1.8756159547902058, -2.3494376961024432)): shape (37, 800, 800)
      Valid pixels: 84275/640000 (13.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=6, max=348339, num_faces=348340
      Valid probs shape: (37, 84275)
    ✓ Random_3 (pose=(0.937778788306316, 1.6435274785662983, 2.3763004390735203)): shape (37, 800, 800)
      Valid pixels: 87596/640000 (13.7%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=11, max=348339, num_faces=348340
      Valid probs shape: (37, 87596)
    ✓ Random_4 (pose=(-2.4912485226901095, 1.4134979045300406, 2.5606461234788043)): shape (37, 800, 800)
      Valid pixels: 82268/640000 (12.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=12, max=348273, num_faces=348340
      Valid probs shape: (37, 82268)
    ✓ Random_5 (pose=(-1.1554452992614364, -0.4258396590174094, -1.0488969152740166)): shape (37, 800, 800)
      Valid pixels: 80240/640000 (12.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=348222, num_faces=348340
      Valid probs shape: (37, 80240)
    ✓ Random_6 (pose=(2.727114384362218, 1.5530134937231237, 2.6025686743197083)): shape (37, 800, 800)
      Valid pixels: 57916/640000 (9.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=13, max=348268, num_faces=348340
      Valid probs shape: (37, 57916)
    ✓ Random_7 (pose=(2.3274482437438673, 1.6505950174829431, -1.7789446105460411)): shape (37, 800, 800)
      Valid pixels: 71588/640000 (11.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=10, max=348339, num_faces=348340
      Valid probs shape: (37, 71588)
    ✓ Random_8 (pose=(2.0595724512945175, -2.5096256144869957, 2.0370081054154054)): shape (37, 800, 800)
      Valid pixels: 81383/640000 (12.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=348195, num_faces=348340
      Valid probs shape: (37, 81383)
    ✓ Random_9 (pose=(2.048125545578805, -1.9893975707054254, 2.5690966208859134)): shape (37, 800, 800)
      Valid pixels: 86276/640000 (13.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=348339, num_faces=348340
      Valid probs shape: (37, 86276)
    ✓ Random_10 (pose=(0.29715667786665456, 1.505835149203942, 2.8696662574503486)): shape (37, 800, 800)
      Valid pixels: 66328/640000 (10.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=348336, num_faces=348340
      Valid probs shape: (37, 66328)
    ✓ Random_11 (pose=(1.8727500878006307, -1.9879124558178527, -0.0690853625254979)): shape (37, 800, 800)
      Valid pixels: 86629/640000 (13.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=348273, num_faces=348340
      Valid probs shape: (37, 86629)
    ✓ Random_12 (pose=(0.8211479552102743, -1.5080344413141304, 0.5594765877718002)): shape (37, 800, 800)
      Valid pixels: 94126/640000 (14.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=12, max=348273, num_faces=348340
      Valid probs shape: (37, 94126)
    ✓ Random_13 (pose=(-0.7876389298983044, -0.25696741102576803, 0.9633382253541383)): shape (37, 800, 800)
      Valid pixels: 51606/640000 (8.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=348339, num_faces=348340
      Valid probs shape: (37, 51606)
    ✓ Random_14 (pose=(-1.506567803065215, -2.7843668116316227, -0.5199797603822973)): shape (37, 800, 800)
      Valid pixels: 89537/640000 (14.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=5, max=348339, num_faces=348340
      Valid probs shape: (37, 89537)
    P stats: min=0.0000, max=0.9999, mean=0.0223
    Non-zero vertices: 143718/174172
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 30454  2125  1194  4217     0  2171  1032  5150  8211]
  Ground Truth Stats:
    Labels shape: (174172,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-2/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7127
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8114
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8119

  RESULTS:
  RAW:         median(top-10)=0.8447, mean(top-10)=0.8507, median(all)=0.7834, mean(all)=0.7127
  + SMOOTHING: median(top-10)=0.9173, mean(top-10)=0.9166, median(all)=0.8692, mean(all)=0.8114 [+0.0726]
  + MRF:       median(top-10)=0.9176, mean(top-10)=0.9170, median(all)=0.8700, mean(all)=0.8119 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0729

================================================================================
Subject: NKI-TRT-20-20
================================================================================
  Step 0: Generating predictions with V2 model (15 random views)...
  Mesh: 147840 vertices, 295676 faces
  Generating 15 random views...
  Generating predictions for 15 views (continuous camera pose)...
    ✓ Random_0 (pose=(2.654624877030124, 0.8692668362408602, 1.6308504505179435)): shape (37, 800, 800)
      Valid pixels: 86451/640000 (13.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=511, max=295668, num_faces=295676
      Valid probs shape: (37, 86451)
    ✓ Random_1 (pose=(1.1897649705715425, -0.9362503402023656, -0.5028098300938337)): shape (37, 800, 800)
      Valid pixels: 108355/640000 (16.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=9, max=295667, num_faces=295676
      Valid probs shape: (37, 108355)
    ✓ Random_2 (pose=(-0.7697719233718123, -1.0294983725417781, 0.6024602944735169)): shape (37, 800, 800)
      Valid pixels: 73182/640000 (11.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=295669, num_faces=295676
      Valid probs shape: (37, 73182)
    ✓ Random_3 (pose=(0.19981371256403202, 2.675276669612039, -0.5672137663630887)): shape (37, 800, 800)
      Valid pixels: 67385/640000 (10.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2326, max=295673, num_faces=295676
      Valid probs shape: (37, 67385)
    ✓ Random_4 (pose=(3.0661446626595295, 0.14036672256434457, 0.1939794104149657)): shape (37, 800, 800)
      Valid pixels: 57004/640000 (8.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4370, max=295675, num_faces=295676
      Valid probs shape: (37, 57004)
    ✓ Random_5 (pose=(-2.2134069180947087, 0.8590679201022695, -1.929333500991777)): shape (37, 800, 800)
      Valid pixels: 76972/640000 (12.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1812, max=295608, num_faces=295676
      Valid probs shape: (37, 76972)
    ✓ Random_6 (pose=(-0.037981130353719195, 2.686863083849647, -1.0391212766092282)): shape (37, 800, 800)
      Valid pixels: 64391/640000 (10.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1546, max=295673, num_faces=295676
      Valid probs shape: (37, 64391)
    ✓ Random_7 (pose=(2.607309064377195, -1.0778642761650095, -0.9956366054000347)): shape (37, 800, 800)
      Valid pixels: 115328/640000 (18.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=131, max=295668, num_faces=295676
      Valid probs shape: (37, 115328)
    ✓ Random_8 (pose=(-2.8329988189327975, 1.380059181470699, -0.06418094325155899)): shape (37, 800, 800)
      Valid pixels: 86731/640000 (13.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=55, max=295675, num_faces=295676
      Valid probs shape: (37, 86731)
    ✓ Random_9 (pose=(-2.932906781994666, 1.1130538543586432, -2.8393559179699106)): shape (37, 800, 800)
      Valid pixels: 71947/640000 (11.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1818, max=295608, num_faces=295676
      Valid probs shape: (37, 71947)
    ✓ Random_10 (pose=(-3.029359293784852, -0.0370012716108894, -3.1263802846538415)): shape (37, 800, 800)
      Valid pixels: 53910/640000 (8.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3310, max=295675, num_faces=295676
      Valid probs shape: (37, 53910)
    ✓ Random_11 (pose=(-0.028368773480818454, -0.2821033511319717, -1.5478442163470696)): shape (37, 800, 800)
      Valid pixels: 70329/640000 (11.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=293372, num_faces=295676
      Valid probs shape: (37, 70329)
    ✓ Random_12 (pose=(2.948342895810806, -1.4916275244354684, -1.9497511429585137)): shape (37, 800, 800)
      Valid pixels: 121765/640000 (19.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=97, max=295668, num_faces=295676
      Valid probs shape: (37, 121765)
    ✓ Random_13 (pose=(2.1537695034049245, -1.5699706793317865, 0.89976097650033)): shape (37, 800, 800)
      Valid pixels: 74837/640000 (11.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=108, max=295661, num_faces=295676
      Valid probs shape: (37, 74837)
    ✓ Random_14 (pose=(2.316790254995478, 0.05079385889929622, -0.5449092397705098)): shape (37, 800, 800)
      Valid pixels: 105147/640000 (16.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=154, max=295670, num_faces=295676
      Valid probs shape: (37, 105147)
    P stats: min=0.0000, max=0.9999, mean=0.0199
    Non-zero vertices: 108643/147840
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 35]
    Pred label counts: [    0 39197   347  1262  3059     0  2027   970  4146  3967]
  Ground Truth Stats:
    Labels shape: (147840,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-20/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6386
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7299
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7300

  RESULTS:
  RAW:         median(top-10)=0.8532, mean(top-10)=0.8433, median(all)=0.7264, mean(all)=0.6386
  + SMOOTHING: median(top-10)=0.8971, mean(top-10)=0.8960, median(all)=0.7977, mean(all)=0.7299 [+0.0439]
  + MRF:       median(top-10)=0.8972, mean(top-10)=0.8961, median(all)=0.7974, mean(all)=0.7300 [+0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0440

================================================================================
Subject: NKI-TRT-20-3
================================================================================
  Step 0: Generating predictions with V2 model (15 random views)...
  Mesh: 123781 vertices, 247558 faces
  Generating 15 random views...
  Generating predictions for 15 views (continuous camera pose)...
    ✓ Random_0 (pose=(-0.2542617004024006, -0.4154636117266346, -2.031769548516225)): shape (37, 800, 800)
      Valid pixels: 77995/640000 (12.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=245475, num_faces=247558
      Valid probs shape: (37, 77995)
    ✓ Random_1 (pose=(0.1318940617014599, -2.2976611257158486, 2.5455260745457986)): shape (37, 800, 800)
      Valid pixels: 65341/640000 (10.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2228, max=247552, num_faces=247558
      Valid probs shape: (37, 65341)
    ✓ Random_2 (pose=(2.4988620179897882, -1.455870224874676, -1.8739371370768587)): shape (37, 800, 800)
      Valid pixels: 108481/640000 (17.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=60, max=247553, num_faces=247558
      Valid probs shape: (37, 108481)
    ✓ Random_3 (pose=(-1.794203161503857, 1.3200417804243285, 2.1486858722813436)): shape (37, 800, 800)
      Valid pixels: 114975/640000 (18.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=44, max=247553, num_faces=247558
      Valid probs shape: (37, 114975)
    ✓ Random_4 (pose=(-2.229767874883331, 0.249607917045231, 1.4196015445154915)): shape (37, 800, 800)
      Valid pixels: 80094/640000 (12.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2514, max=247557, num_faces=247558
      Valid probs shape: (37, 80094)
    ✓ Random_5 (pose=(-1.5335452967078695, -0.052977505391024415, -0.0604629765072664)): shape (37, 800, 800)
      Valid pixels: 111248/640000 (17.4%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=1, max=247557, num_faces=247558
      Valid probs shape: (37, 111248)
    ✓ Random_6 (pose=(-2.9373457171674384, -2.811515271811668, -1.8857544896087868)): shape (37, 800, 800)
      Valid pixels: 70331/640000 (11.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=247553, num_faces=247558
      Valid probs shape: (37, 70331)
    ✓ Random_7 (pose=(1.3905926023731858, 1.2261554391057787, 2.804171262507766)): shape (37, 800, 800)
      Valid pixels: 113340/640000 (17.7%)
      Probs stats: min=0.0000, max=0.9993, mean=0.0270
      Face IDs: min=5, max=247557, num_faces=247558
      Valid probs shape: (37, 113340)
    ✓ Random_8 (pose=(1.3090094691534748, -0.9777146773331697, -0.2533804389237)): shape (37, 800, 800)
      Valid pixels: 117886/640000 (18.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=15, max=247553, num_faces=247558
      Valid probs shape: (37, 117886)
    ✓ Random_9 (pose=(-0.7233420937743942, 1.9455535504356218, 0.015871259239559787)): shape (37, 800, 800)
      Valid pixels: 108438/640000 (16.9%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=964, max=247542, num_faces=247558
      Valid probs shape: (37, 108438)
    ✓ Random_10 (pose=(-2.3893187630988213, 1.5755399296594428, 1.498275122797394)): shape (37, 800, 800)
      Valid pixels: 112584/640000 (17.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=60, max=247553, num_faces=247558
      Valid probs shape: (37, 112584)
    ✓ Random_11 (pose=(2.2130155518060928, -0.015841531977701884, -0.2558257988057977)): shape (37, 800, 800)
      Valid pixels: 108548/640000 (17.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=159, max=247553, num_faces=247558
      Valid probs shape: (37, 108548)
    ✓ Random_12 (pose=(-2.8828363834797157, -2.721320395963973, 1.4098276343580007)): shape (37, 800, 800)
      Valid pixels: 72555/640000 (11.3%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=1, max=246296, num_faces=247558
      Valid probs shape: (37, 72555)
    ✓ Random_13 (pose=(-0.28160803506800747, 1.2150885270518899, -1.1942031680981626)): shape (37, 800, 800)
      Valid pixels: 93558/640000 (14.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=247553, num_faces=247558
      Valid probs shape: (37, 93558)
    ✓ Random_14 (pose=(-2.541420045179344, -2.540033574100787, -0.33884563249844657)): shape (37, 800, 800)
      Valid pixels: 91351/640000 (14.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=245475, num_faces=247558
      Valid probs shape: (37, 91351)
    P stats: min=0.0000, max=1.0000, mean=0.0232
    Non-zero vertices: 106338/123781
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 17443   497  1011  3448     0  1811   542  3858  4996]
  Ground Truth Stats:
    Labels shape: (123781,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-3/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7252
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8012
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8020

  RESULTS:
  RAW:         median(top-10)=0.8436, mean(top-10)=0.8534, median(all)=0.7887, mean(all)=0.7252
  + SMOOTHING: median(top-10)=0.9120, mean(top-10)=0.9116, median(all)=0.8518, mean(all)=0.8012 [+0.0684]
  + MRF:       median(top-10)=0.9127, mean(top-10)=0.9122, median(all)=0.8521, mean(all)=0.8020 [+0.0007]
  TOTAL IMPROVEMENT (median top-10): +0.0691

================================================================================
Subject: NKI-TRT-20-4
================================================================================
  Step 0: Generating predictions with V2 model (15 random views)...
  Mesh: 158207 vertices, 316410 faces
  Generating 15 random views...
  Generating predictions for 15 views (continuous camera pose)...
    ✓ Random_0 (pose=(-0.42556307027454476, -2.394159807013113, 1.4604095355925875)): shape (37, 800, 800)
      Valid pixels: 100658/640000 (15.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=378, max=316409, num_faces=316410
      Valid probs shape: (37, 100658)
    ✓ Random_1 (pose=(-1.8406869231775809, -1.249071094879648, -3.0807979231456826)): shape (37, 800, 800)
      Valid pixels: 119100/640000 (18.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8, max=316409, num_faces=316410
      Valid probs shape: (37, 119100)
    ✓ Random_2 (pose=(-1.0145896943767236, 1.2502339992142355, -1.5002718558386907)): shape (37, 800, 800)
      Valid pixels: 78796/640000 (12.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=18, max=316409, num_faces=316410
      Valid probs shape: (37, 78796)
    ✓ Random_3 (pose=(-0.4097092554258781, -0.049722508943393695, -0.74739731142563)): shape (37, 800, 800)
      Valid pixels: 77565/640000 (12.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=314143, num_faces=316410
      Valid probs shape: (37, 77565)
    ✓ Random_4 (pose=(-3.1067903690276837, -2.8009592308534375, -2.822203593950105)): shape (37, 800, 800)
      Valid pixels: 55456/640000 (8.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=316409, num_faces=316410
      Valid probs shape: (37, 55456)
    ✓ Random_5 (pose=(-1.4231132434943983, 0.04189000404477694, 1.7118561667116419)): shape (37, 800, 800)
      Valid pixels: 78442/640000 (12.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=29, max=316311, num_faces=316410
      Valid probs shape: (37, 78442)
    ✓ Random_6 (pose=(-2.0301013794581175, 0.11316129312132306, -2.0948984330907496)): shape (37, 800, 800)
      Valid pixels: 74369/640000 (11.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=128, max=316409, num_faces=316410
      Valid probs shape: (37, 74369)
    ✓ Random_7 (pose=(-1.45120863811387, -0.4733794868886321, 0.6725237681679488)): shape (37, 800, 800)
      Valid pixels: 83786/640000 (13.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=29, max=316311, num_faces=316410
      Valid probs shape: (37, 83786)
    ✓ Random_8 (pose=(0.24403361916000188, -1.1106054029435692, 0.42280102153054555)): shape (37, 800, 800)
      Valid pixels: 95827/640000 (15.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=14, max=316403, num_faces=316410
      Valid probs shape: (37, 95827)
    ✓ Random_9 (pose=(2.679311056867374, -0.37897587594567206, -1.9611659576369043)): shape (37, 800, 800)
      Valid pixels: 73734/640000 (11.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1336, max=316409, num_faces=316410
      Valid probs shape: (37, 73734)
    ✓ Random_10 (pose=(-2.3679787177694083, -3.088421167215603, -2.32705214594818)): shape (37, 800, 800)
      Valid pixels: 76259/640000 (11.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=316404, num_faces=316410
      Valid probs shape: (37, 76259)
    ✓ Random_11 (pose=(2.6808554846765986, -2.7087005269605395, -2.3023770446238547)): shape (37, 800, 800)
      Valid pixels: 59157/640000 (9.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=315928, num_faces=316410
      Valid probs shape: (37, 59157)
    ✓ Random_12 (pose=(2.8453901955106833, -0.1137696556351151, 3.0311609788787655)): shape (37, 800, 800)
      Valid pixels: 68535/640000 (10.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8684, max=316409, num_faces=316410
      Valid probs shape: (37, 68535)
    ✓ Random_13 (pose=(-2.3884459017967483, 2.406885038863571, -2.9020467089391913)): shape (37, 800, 800)
      Valid pixels: 79043/640000 (12.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=316404, num_faces=316410
      Valid probs shape: (37, 79043)
    ✓ Random_14 (pose=(2.4318706389190172, 1.124918650917973, -1.7084143182380473)): shape (37, 800, 800)
      Valid pixels: 86573/640000 (13.5%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=2086, max=316407, num_faces=316410
      Valid probs shape: (37, 86573)
    P stats: min=0.0000, max=1.0000, mean=0.0212
    Non-zero vertices: 123993/158207
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 34214   412   941  2083     0  3110   936  5465  5192]
  Ground Truth Stats:
    Labels shape: (158207,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-4/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6605
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7413
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7414

  RESULTS:
  RAW:         median(top-10)=0.8634, mean(top-10)=0.8555, median(all)=0.7256, mean(all)=0.6605
  + SMOOTHING: median(top-10)=0.8964, mean(top-10)=0.8980, median(all)=0.7913, mean(all)=0.7413 [+0.0330]
  + MRF:       median(top-10)=0.8966, mean(top-10)=0.8981, median(all)=0.7914, mean(all)=0.7414 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0332

================================================================================
Subject: NKI-TRT-20-5
================================================================================
  Step 0: Generating predictions with V2 model (15 random views)...
  Mesh: 137753 vertices, 275502 faces
  Generating 15 random views...
  Generating predictions for 15 views (continuous camera pose)...
    ✓ Random_0 (pose=(-1.5027837368022803, -1.7508945427401377, 0.674055951417011)): shape (37, 800, 800)
      Valid pixels: 80392/640000 (12.6%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=95, max=275454, num_faces=275502
      Valid probs shape: (37, 80392)
    ✓ Random_1 (pose=(2.0487718663006698, -1.3032260259601067, 0.4606973639396852)): shape (37, 800, 800)
      Valid pixels: 78587/640000 (12.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=58, max=275496, num_faces=275502
      Valid probs shape: (37, 78587)
    ✓ Random_2 (pose=(1.959988626756319, 2.8669134566988683, 2.281796557006995)): shape (37, 800, 800)
      Valid pixels: 84686/640000 (13.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=273937, num_faces=275502
      Valid probs shape: (37, 84686)
    ✓ Random_3 (pose=(-2.5562216485899354, 2.7292245350574094, 0.594452476918446)): shape (37, 800, 800)
      Valid pixels: 61017/640000 (9.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=275462, num_faces=275502
      Valid probs shape: (37, 61017)
    ✓ Random_4 (pose=(1.4646840571133533, -2.138448374003069, -1.8100145918960253)): shape (37, 800, 800)
      Valid pixels: 73786/640000 (11.5%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=57, max=275460, num_faces=275502
      Valid probs shape: (37, 73786)
    ✓ Random_5 (pose=(1.8422967025551849, 0.23833617894631187, 1.1845369972598263)): shape (37, 800, 800)
      Valid pixels: 74148/640000 (11.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=71, max=275493, num_faces=275502
      Valid probs shape: (37, 74148)
    ✓ Random_6 (pose=(-1.1278864201144918, 1.312105642342602, -0.9869971736512961)): shape (37, 800, 800)
      Valid pixels: 69412/640000 (10.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=273939, num_faces=275502
      Valid probs shape: (37, 69412)
    ✓ Random_7 (pose=(1.3250820441540725, -1.0773488310636106, 1.7659656948449074)): shape (37, 800, 800)
      Valid pixels: 64389/640000 (10.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=273940, num_faces=275502
      Valid probs shape: (37, 64389)
    ✓ Random_8 (pose=(1.0912119282187343, -1.3786806012662889, -0.8637618188699512)): shape (37, 800, 800)
      Valid pixels: 73779/640000 (11.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=61, max=275498, num_faces=275502
      Valid probs shape: (37, 73779)
    ✓ Random_9 (pose=(-0.9549896172913934, -0.09658840441268701, -0.22469654504654768)): shape (37, 800, 800)
      Valid pixels: 85526/640000 (13.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=275462, num_faces=275502
      Valid probs shape: (37, 85526)
    ✓ Random_10 (pose=(-1.1507703853055564, 1.4791366580630267, -3.0472990436022016)): shape (37, 800, 800)
      Valid pixels: 106662/640000 (16.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6, max=275501, num_faces=275502
      Valid probs shape: (37, 106662)
    ✓ Random_11 (pose=(-3.1382587312510033, 1.7446570500990752, 0.2853597559307386)): shape (37, 800, 800)
      Valid pixels: 76010/640000 (11.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=59, max=275498, num_faces=275502
      Valid probs shape: (37, 76010)
    ✓ Random_12 (pose=(3.075141566621072, 0.027206296746697944, -0.6514267049785691)): shape (37, 800, 800)
      Valid pixels: 43819/640000 (6.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=10425, max=275498, num_faces=275502
      Valid probs shape: (37, 43819)
    ✓ Random_13 (pose=(-1.3545824436829184, -2.5246617906084907, 0.1549275557259815)): shape (37, 800, 800)
      Valid pixels: 89773/640000 (14.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=54, max=275454, num_faces=275502
      Valid probs shape: (37, 89773)
    ✓ Random_14 (pose=(3.0223128084646014, 1.2839197913126457, -0.8134478881015719)): shape (37, 800, 800)
      Valid pixels: 77407/640000 (12.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=168, max=275460, num_faces=275502
      Valid probs shape: (37, 77407)
    P stats: min=0.0000, max=1.0000, mean=0.0223
    Non-zero vertices: 113738/137753
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 24015  1542   994  3188     0  2161   792  4412  6378]
  Ground Truth Stats:
    Labels shape: (137753,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-5/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7163
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7967
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7971

  RESULTS:
  RAW:         median(top-10)=0.8625, mean(top-10)=0.8642, median(all)=0.7635, mean(all)=0.7163
  + SMOOTHING: median(top-10)=0.8973, mean(top-10)=0.9022, median(all)=0.8459, mean(all)=0.7967 [+0.0348]
  + MRF:       median(top-10)=0.8977, mean(top-10)=0.9027, median(all)=0.8461, mean(all)=0.7971 [+0.0005]
  TOTAL IMPROVEMENT (median top-10): +0.0353

================================================================================
Subject: NKI-TRT-20-6
================================================================================
  Step 0: Generating predictions with V2 model (15 random views)...
  Mesh: 158025 vertices, 316046 faces
  Generating 15 random views...
  Generating predictions for 15 views (continuous camera pose)...
    ✓ Random_0 (pose=(2.8477605827089674, -2.3245383627012175, -2.2056469493383872)): shape (37, 800, 800)
      Valid pixels: 69590/640000 (10.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=316042, num_faces=316046
      Valid probs shape: (37, 69590)
    ✓ Random_1 (pose=(1.9491966940794727, -0.2532467714207596, 1.408676156668502)): shape (37, 800, 800)
      Valid pixels: 60010/640000 (9.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=8529, max=316029, num_faces=316046
      Valid probs shape: (37, 60010)
    ✓ Random_2 (pose=(-1.753735894031962, -1.273662827862988, 1.5690964232135736)): shape (37, 800, 800)
      Valid pixels: 69458/640000 (10.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=14, max=316045, num_faces=316046
      Valid probs shape: (37, 69458)
    ✓ Random_3 (pose=(-1.3669745811018115, -2.2462676206087817, -1.6975579316041254)): shape (37, 800, 800)
      Valid pixels: 63769/640000 (10.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=160, max=314483, num_faces=316046
      Valid probs shape: (37, 63769)
    ✓ Random_4 (pose=(2.7230481715624064, -0.4097943688270522, 1.7045016763664265)): shape (37, 800, 800)
      Valid pixels: 71806/640000 (11.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=26272, max=316044, num_faces=316046
      Valid probs shape: (37, 71806)
    ✓ Random_5 (pose=(-0.9284689385329186, -1.9849007872469056, 0.818825194754385)): shape (37, 800, 800)
      Valid pixels: 71520/640000 (11.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=34, max=316045, num_faces=316046
      Valid probs shape: (37, 71520)
    ✓ Random_6 (pose=(1.9620129372132258, 2.430255766343566, 0.07789836724805488)): shape (37, 800, 800)
      Valid pixels: 106287/640000 (16.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=14, max=316043, num_faces=316046
      Valid probs shape: (37, 106287)
    ✓ Random_7 (pose=(2.8504906076930796, 0.38437814061397235, 0.5601692833284573)): shape (37, 800, 800)
      Valid pixels: 73423/640000 (11.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=462, max=316045, num_faces=316046
      Valid probs shape: (37, 73423)
    ✓ Random_8 (pose=(-0.47136629286995024, 1.6893585326472005, 0.987863336592671)): shape (37, 800, 800)
      Valid pixels: 103725/640000 (16.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=5, max=316041, num_faces=316046
      Valid probs shape: (37, 103725)
    ✓ Random_9 (pose=(-1.8828515608837777, 0.4047459094971435, -1.7941035989470988)): shape (37, 800, 800)
      Valid pixels: 61203/640000 (9.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=8530, max=316029, num_faces=316046
      Valid probs shape: (37, 61203)
    ✓ Random_10 (pose=(1.0974456700215853, -0.07524072049695052, -2.4951258624643757)): shape (37, 800, 800)
      Valid pixels: 76363/640000 (11.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=9, max=316044, num_faces=316046
      Valid probs shape: (37, 76363)
    ✓ Random_11 (pose=(0.46373951311861106, -0.32814377250411475, 2.8200890684776567)): shape (37, 800, 800)
      Valid pixels: 75930/640000 (11.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=314909, num_faces=316046
      Valid probs shape: (37, 75930)
    ✓ Random_12 (pose=(-1.8636927782736419, -2.2171600299541017, 0.55491359215464)): shape (37, 800, 800)
      Valid pixels: 90594/640000 (14.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=31, max=316041, num_faces=316046
      Valid probs shape: (37, 90594)
    ✓ Random_13 (pose=(1.4264352194898056, -0.9070813237745781, 0.4889469761532048)): shape (37, 800, 800)
      Valid pixels: 96636/640000 (15.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=11, max=316043, num_faces=316046
      Valid probs shape: (37, 96636)
    ✓ Random_14 (pose=(2.037189136009655, 0.3215870022327345, -1.1306016712993738)): shape (37, 800, 800)
      Valid pixels: 82632/640000 (12.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=23, max=316045, num_faces=316046
      Valid probs shape: (37, 82632)
    P stats: min=0.0000, max=0.9999, mean=0.0234
    Non-zero vertices: 136591/158025
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 21434  1035  1076  3194     0  2076   996  6068  7230]
  Ground Truth Stats:
    Labels shape: (158025,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-6/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7496
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8374
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8381

  RESULTS:
  RAW:         median(top-10)=0.8712, mean(top-10)=0.8765, median(all)=0.8012, mean(all)=0.7496
  + SMOOTHING: median(top-10)=0.9179, mean(top-10)=0.9263, median(all)=0.8674, mean(all)=0.8374 [+0.0467]
  + MRF:       median(top-10)=0.9183, mean(top-10)=0.9268, median(all)=0.8682, mean(all)=0.8381 [+0.0004]
  TOTAL IMPROVEMENT (median top-10): +0.0471

================================================================================
Subject: NKI-TRT-20-7
================================================================================
  Step 0: Generating predictions with V2 model (15 random views)...
  Mesh: 145017 vertices, 290030 faces
  Generating 15 random views...
  Generating predictions for 15 views (continuous camera pose)...
    ✓ Random_0 (pose=(3.0313216442119097, -1.2083783493288287, -2.0509538411900117)): shape (37, 800, 800)
      Valid pixels: 98374/640000 (15.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=290003, num_faces=290030
      Valid probs shape: (37, 98374)
    ✓ Random_1 (pose=(1.3446692230992099, 2.892223096318661, 0.5974217583056101)): shape (37, 800, 800)
      Valid pixels: 79583/640000 (12.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=289636, num_faces=290030
      Valid probs shape: (37, 79583)
    ✓ Random_2 (pose=(-2.8331301658054704, -2.3098703700372445, -2.992487585413066)): shape (37, 800, 800)
      Valid pixels: 66942/640000 (10.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=289963, num_faces=290030
      Valid probs shape: (37, 66942)
    ✓ Random_3 (pose=(-0.28563450105565646, -0.11593677600577834, 0.9065329788360783)): shape (37, 800, 800)
      Valid pixels: 46677/640000 (7.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=289951, num_faces=290030
      Valid probs shape: (37, 46677)
    ✓ Random_4 (pose=(1.6078003367955507, 2.50131520448742, 1.0866056171596519)): shape (37, 800, 800)
      Valid pixels: 73796/640000 (11.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=289374, num_faces=290030
      Valid probs shape: (37, 73796)
    ✓ Random_5 (pose=(-0.6442413558297226, 1.0155558481691882, -1.5673385759470235)): shape (37, 800, 800)
      Valid pixels: 76877/640000 (12.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=289374, num_faces=290030
      Valid probs shape: (37, 76877)
    ✓ Random_6 (pose=(-0.6088705001633721, -2.3234939008334132, 2.53873690098819)): shape (37, 800, 800)
      Valid pixels: 83285/640000 (13.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=437, max=289954, num_faces=290030
      Valid probs shape: (37, 83285)
    ✓ Random_7 (pose=(3.077261517905323, -0.5177668787490903, -0.6670568438032487)): shape (37, 800, 800)
      Valid pixels: 53544/640000 (8.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2635, max=289635, num_faces=290030
      Valid probs shape: (37, 53544)
    ✓ Random_8 (pose=(-2.592565002800097, -2.338049459653961, 0.7839437926962911)): shape (37, 800, 800)
      Valid pixels: 84313/640000 (13.2%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=4, max=290021, num_faces=290030
      Valid probs shape: (37, 84313)
    ✓ Random_9 (pose=(2.1823000793651195, 2.762183055104008, -2.276811311837883)): shape (37, 800, 800)
      Valid pixels: 69359/640000 (10.8%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=8, max=290028, num_faces=290030
      Valid probs shape: (37, 69359)
    ✓ Random_10 (pose=(1.9989516416080901, 1.1916078783583055, -0.14406270321425074)): shape (37, 800, 800)
      Valid pixels: 101676/640000 (15.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=289969, num_faces=290030
      Valid probs shape: (37, 101676)
    ✓ Random_11 (pose=(1.5004770429691545, -0.23209940219948555, -0.821422455201017)): shape (37, 800, 800)
      Valid pixels: 94385/640000 (14.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=290002, num_faces=290030
      Valid probs shape: (37, 94385)
    ✓ Random_12 (pose=(-1.882263743506517, 1.8539112103260162, -1.0665796589403653)): shape (37, 800, 800)
      Valid pixels: 95869/640000 (15.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=4, max=290027, num_faces=290030
      Valid probs shape: (37, 95869)
    ✓ Random_13 (pose=(-1.6068275970913863, -1.6016304984988756, 1.9815999720268485)): shape (37, 800, 800)
      Valid pixels: 80873/640000 (12.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=25, max=290028, num_faces=290030
      Valid probs shape: (37, 80873)
    ✓ Random_14 (pose=(0.29835045597793597, -2.027919482405072, 1.0272817617629384)): shape (37, 800, 800)
      Valid pixels: 96563/640000 (15.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=12, max=290004, num_faces=290030
      Valid probs shape: (37, 96563)
    P stats: min=0.0000, max=1.0000, mean=0.0211
    Non-zero vertices: 113352/145017
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 31665  1045  1071  2594     0  2019  1000  4706  5321]
  Ground Truth Stats:
    Labels shape: (145017,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-7/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6846
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7827
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7829

  RESULTS:
  RAW:         median(top-10)=0.8444, mean(top-10)=0.8530, median(all)=0.7422, mean(all)=0.6846
  + SMOOTHING: median(top-10)=0.9081, mean(top-10)=0.9119, median(all)=0.8573, mean(all)=0.7827 [+0.0636]
  + MRF:       median(top-10)=0.9082, mean(top-10)=0.9121, median(all)=0.8574, mean(all)=0.7829 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0638

================================================================================
Subject: NKI-TRT-20-8
================================================================================
  Step 0: Generating predictions with V2 model (15 random views)...
  Mesh: 147404 vertices, 294804 faces
  Generating 15 random views...
  Generating predictions for 15 views (continuous camera pose)...
    ✓ Random_0 (pose=(2.828096407336213, -2.40371057296772, -0.8537180098072503)): shape (37, 800, 800)
      Valid pixels: 74042/640000 (11.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=294754, num_faces=294804
      Valid probs shape: (37, 74042)
    ✓ Random_1 (pose=(1.8168544401815065, 3.132438953817192, 1.8848212167758112)): shape (37, 800, 800)
      Valid pixels: 72223/640000 (11.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=294253, num_faces=294804
      Valid probs shape: (37, 72223)
    ✓ Random_2 (pose=(2.5954481510488305, -1.8333311671822623, -0.11146545360158377)): shape (37, 800, 800)
      Valid pixels: 72084/640000 (11.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=294727, num_faces=294804
      Valid probs shape: (37, 72084)
    ✓ Random_3 (pose=(0.6457421114265962, 0.5368544994383306, 2.8335774880204916)): shape (37, 800, 800)
      Valid pixels: 65580/640000 (10.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=293628, num_faces=294804
      Valid probs shape: (37, 65580)
    ✓ Random_4 (pose=(1.2663963732150512, -2.197042934206545, 2.3356065814929057)): shape (37, 800, 800)
      Valid pixels: 81975/640000 (12.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7, max=294791, num_faces=294804
      Valid probs shape: (37, 81975)
    ✓ Random_5 (pose=(-2.884446187466581, -2.8131739087882752, -1.4613364674598366)): shape (37, 800, 800)
      Valid pixels: 53542/640000 (8.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=294658, num_faces=294804
      Valid probs shape: (37, 53542)
    ✓ Random_6 (pose=(2.450158068161037, -1.8148115386731973, 1.4158568480442515)): shape (37, 800, 800)
      Valid pixels: 87059/640000 (13.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=294398, num_faces=294804
      Valid probs shape: (37, 87059)
    ✓ Random_7 (pose=(-0.7578628495693915, 0.46410575546210975, 1.677220585796137)): shape (37, 800, 800)
      Valid pixels: 57438/640000 (9.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=5, max=294679, num_faces=294804
      Valid probs shape: (37, 57438)
    ✓ Random_8 (pose=(-2.4691201721464684, 0.0835655384413676, -2.7315166381755036)): shape (37, 800, 800)
      Valid pixels: 59181/640000 (9.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1973, max=294803, num_faces=294804
      Valid probs shape: (37, 59181)
    ✓ Random_9 (pose=(1.6477998646841314, 2.152753835447818, -0.49713737824684934)): shape (37, 800, 800)
      Valid pixels: 95867/640000 (15.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=294801, num_faces=294804
      Valid probs shape: (37, 95867)
    ✓ Random_10 (pose=(0.045624737791893466, 2.980796689151762, 0.5337849791636726)): shape (37, 800, 800)
      Valid pixels: 49314/640000 (7.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=74521, max=294800, num_faces=294804
      Valid probs shape: (37, 49314)
    ✓ Random_11 (pose=(-0.372492576163594, -1.5210417711699356, -1.1844506627032427)): shape (37, 800, 800)
      Valid pixels: 88399/640000 (13.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=14, max=294682, num_faces=294804
      Valid probs shape: (37, 88399)
    ✓ Random_12 (pose=(-2.1884787978658813, 1.9306311091381394, 1.7299403038589682)): shape (37, 800, 800)
      Valid pixels: 89483/640000 (14.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=11, max=294673, num_faces=294804
      Valid probs shape: (37, 89483)
    ✓ Random_13 (pose=(0.16937840446461916, -2.1748232386504984, -0.42244010587619707)): shape (37, 800, 800)
      Valid pixels: 63759/640000 (10.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=840, max=294802, num_faces=294804
      Valid probs shape: (37, 63759)
    ✓ Random_14 (pose=(-1.3887885729728005, 2.703178373680437, 0.2986775077837178)): shape (37, 800, 800)
      Valid pixels: 84723/640000 (13.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=20, max=294795, num_faces=294804
      Valid probs shape: (37, 84723)
    P stats: min=0.0000, max=1.0000, mean=0.0235
    Non-zero vertices: 128095/147404
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 19309  1356   870  2813     0  2078  1029  4444  6746]
  Ground Truth Stats:
    Labels shape: (147404,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-8/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6979
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7651
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7655

  RESULTS:
  RAW:         median(top-10)=0.8491, mean(top-10)=0.8570, median(all)=0.7875, mean(all)=0.6979
  + SMOOTHING: median(top-10)=0.8937, mean(top-10)=0.8997, median(all)=0.8267, mean(all)=0.7651 [+0.0446]
  + MRF:       median(top-10)=0.8944, mean(top-10)=0.9001, median(all)=0.8282, mean(all)=0.7655 [+0.0007]
  TOTAL IMPROVEMENT (median top-10): +0.0453

================================================================================
Subject: NKI-TRT-20-9
================================================================================
  Step 0: Generating predictions with V2 model (15 random views)...
  Mesh: 141802 vertices, 283600 faces
  Generating 15 random views...
  Generating predictions for 15 views (continuous camera pose)...
    ✓ Random_0 (pose=(1.3027112041208682, -0.7802202118214963, 1.61589651566681)): shape (37, 800, 800)
      Valid pixels: 60447/640000 (9.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=283563, num_faces=283600
      Valid probs shape: (37, 60447)
    ✓ Random_1 (pose=(-0.4445092422181869, -1.3758612286495984, 2.4379015213654984)): shape (37, 800, 800)
      Valid pixels: 92309/640000 (14.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7, max=283563, num_faces=283600
      Valid probs shape: (37, 92309)
    ✓ Random_2 (pose=(-1.1473663596317083, 0.04032796984311737, -1.4252907375859245)): shape (37, 800, 800)
      Valid pixels: 64204/640000 (10.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=283563, num_faces=283600
      Valid probs shape: (37, 64204)
    ✓ Random_3 (pose=(-3.0542877575434604, 1.5356791416935458, -1.1345114109506134)): shape (37, 800, 800)
      Valid pixels: 90247/640000 (14.1%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=82, max=283595, num_faces=283600
      Valid probs shape: (37, 90247)
    ✓ Random_4 (pose=(0.7527636084778297, 0.41402741326392656, 1.3866294851929828)): shape (37, 800, 800)
      Valid pixels: 63972/640000 (10.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=283563, num_faces=283600
      Valid probs shape: (37, 63972)
    ✓ Random_5 (pose=(0.23635127072937, -1.176296715300893, -0.15676687805176437)): shape (37, 800, 800)
      Valid pixels: 59850/640000 (9.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=283598, num_faces=283600
      Valid probs shape: (37, 59850)
    ✓ Random_6 (pose=(0.867006086798841, -2.6472494221349043, 0.03289879938455398)): shape (37, 800, 800)
      Valid pixels: 94677/640000 (14.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=150, max=283514, num_faces=283600
      Valid probs shape: (37, 94677)
    ✓ Random_7 (pose=(-0.7319463952189995, -0.6945366655340766, -2.5032180011943224)): shape (37, 800, 800)
      Valid pixels: 59677/640000 (9.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=283563, num_faces=283600
      Valid probs shape: (37, 59677)
    ✓ Random_8 (pose=(1.0129979646038016, 1.960642790585731, 0.3068484956716997)): shape (37, 800, 800)
      Valid pixels: 76063/640000 (11.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=288, max=283563, num_faces=283600
      Valid probs shape: (37, 76063)
    ✓ Random_9 (pose=(-0.5770655405872422, -2.769942933203231, -2.5008080912463067)): shape (37, 800, 800)
      Valid pixels: 56296/640000 (8.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1412, max=283574, num_faces=283600
      Valid probs shape: (37, 56296)
    ✓ Random_10 (pose=(-2.2612607847358124, 0.8774319856623842, -1.9950374302914222)): shape (37, 800, 800)
      Valid pixels: 63137/640000 (9.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6190, max=283587, num_faces=283600
      Valid probs shape: (37, 63137)
    ✓ Random_11 (pose=(2.190738175583662, -1.9151450125051792, -2.9736444539041247)): shape (37, 800, 800)
      Valid pixels: 75291/640000 (11.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=0, max=283593, num_faces=283600
      Valid probs shape: (37, 75291)
    ✓ Random_12 (pose=(3.1261704507704433, 0.9115151186188282, 0.7006156337503953)): shape (37, 800, 800)
      Valid pixels: 84881/640000 (13.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=148, max=283513, num_faces=283600
      Valid probs shape: (37, 84881)
    ✓ Random_13 (pose=(3.0965326256656818, -1.4472925480449452, -1.0402853713755573)): shape (37, 800, 800)
      Valid pixels: 90973/640000 (14.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=19, max=283567, num_faces=283600
      Valid probs shape: (37, 90973)
    ✓ Random_14 (pose=(2.9877601337051143, 1.869384938498488, -1.897429562514299)): shape (37, 800, 800)
      Valid pixels: 99741/640000 (15.6%)
      Probs stats: min=0.0000, max=0.9994, mean=0.0270
      Face IDs: min=0, max=283590, num_faces=283600
      Valid probs shape: (37, 99741)
    P stats: min=0.0000, max=1.0000, mean=0.0234
    Non-zero vertices: 122936/141802
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 18866  1321   934  2772     0  2233   966  4813  7315]
  Ground Truth Stats:
    Labels shape: (141802,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-9/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7337
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8151
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8151

  RESULTS:
  RAW:         median(top-10)=0.8821, mean(top-10)=0.8829, median(all)=0.7939, mean(all)=0.7337
  + SMOOTHING: median(top-10)=0.9187, mean(top-10)=0.9160, median(all)=0.8611, mean(all)=0.8151 [+0.0366]
  + MRF:       median(top-10)=0.9193, mean(top-10)=0.9161, median(all)=0.8609, mean(all)=0.8151 [+0.0006]
  TOTAL IMPROVEMENT (median top-10): +0.0372

================================================================================
Subject: OASIS-TRT-20-1
================================================================================
  Step 0: Generating predictions with V2 model (15 random views)...
  Mesh: 149052 vertices, 298100 faces
  Generating 15 random views...
  Generating predictions for 15 views (continuous camera pose)...
    ✓ Random_0 (pose=(2.4027170965885496, -2.149195580777155, 0.7306279219660281)): shape (37, 800, 800)
      Valid pixels: 50850/640000 (7.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6, max=298098, num_faces=298100
      Valid probs shape: (37, 50850)
    ✓ Random_1 (pose=(-0.9488805599076549, -0.8516917997883393, -1.2797683570706875)): shape (37, 800, 800)
      Valid pixels: 76928/640000 (12.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6, max=298098, num_faces=298100
      Valid probs shape: (37, 76928)
    ✓ Random_2 (pose=(2.1487590502830063, 2.097547920802482, 0.9531880573904692)): shape (37, 800, 800)
      Valid pixels: 68630/640000 (10.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7, max=298099, num_faces=298100
      Valid probs shape: (37, 68630)
    ✓ Random_3 (pose=(-2.2186510718909878, 2.3502720734280658, 2.3783015599232655)): shape (37, 800, 800)
      Valid pixels: 80941/640000 (12.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=298099, num_faces=298100
      Valid probs shape: (37, 80941)
    ✓ Random_4 (pose=(1.9951170723213005, -0.2669319895780342, -0.12743257670042585)): shape (37, 800, 800)
      Valid pixels: 76026/640000 (11.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6, max=298099, num_faces=298100
      Valid probs shape: (37, 76026)
    ✓ Random_5 (pose=(1.9146327028006649, 1.5375507656262934, 1.4789347757410551)): shape (37, 800, 800)
      Valid pixels: 56569/640000 (8.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=24, max=298098, num_faces=298100
      Valid probs shape: (37, 56569)
    ✓ Random_6 (pose=(2.8118148908633254, 1.1228657663927413, 2.528151469245575)): shape (37, 800, 800)
      Valid pixels: 52700/640000 (8.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=418, max=298099, num_faces=298100
      Valid probs shape: (37, 52700)
    ✓ Random_7 (pose=(1.4157271094746493, 1.4331024468040257, 2.0023682857510288)): shape (37, 800, 800)
      Valid pixels: 79071/640000 (12.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=298098, num_faces=298100
      Valid probs shape: (37, 79071)
    ✓ Random_8 (pose=(-0.2656497349310083, 1.2238721603215321, 1.3082781931132956)): shape (37, 800, 800)
      Valid pixels: 71769/640000 (11.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=11, max=298096, num_faces=298100
      Valid probs shape: (37, 71769)
    ✓ Random_9 (pose=(0.210175964407473, 1.2563661815824432, -1.5094041738131332)): shape (37, 800, 800)
      Valid pixels: 83321/640000 (13.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=298099, num_faces=298100
      Valid probs shape: (37, 83321)
    ✓ Random_10 (pose=(1.562906366272376, -1.8543597474664888, -0.9644221287587031)): shape (37, 800, 800)
      Valid pixels: 80952/640000 (12.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=298074, num_faces=298100
      Valid probs shape: (37, 80952)
    ✓ Random_11 (pose=(-0.8904335163458246, -2.010346268294618, 1.8618937331523417)): shape (37, 800, 800)
      Valid pixels: 84007/640000 (13.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=298099, num_faces=298100
      Valid probs shape: (37, 84007)
    ✓ Random_12 (pose=(1.7739730725416516, -0.5164970785659437, -2.2399145615783573)): shape (37, 800, 800)
      Valid pixels: 59680/640000 (9.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=15, max=297997, num_faces=298100
      Valid probs shape: (37, 59680)
    ✓ Random_13 (pose=(-0.5924697444551801, 0.09860999897131473, -0.08648344422002907)): shape (37, 800, 800)
      Valid pixels: 54904/640000 (8.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=297828, num_faces=298100
      Valid probs shape: (37, 54904)
    ✓ Random_14 (pose=(-0.11345741269027743, -2.4327251536044643, 0.46650727897577404)): shape (37, 800, 800)
      Valid pixels: 49466/640000 (7.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=801, max=298095, num_faces=298100
      Valid probs shape: (37, 49466)
    P stats: min=0.0000, max=1.0000, mean=0.0234
    Non-zero vertices: 129099/149052
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 19953  1126  1234  3570     0  2398   783  5067  6253]
  Ground Truth Stats:
    Labels shape: (149052,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-1/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
    MRF iteration 5/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7156
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7946
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7948

  RESULTS:
  RAW:         median(top-10)=0.8766, mean(top-10)=0.8838, median(all)=0.7705, mean(all)=0.7156
  + SMOOTHING: median(top-10)=0.9188, mean(top-10)=0.9222, median(all)=0.8360, mean(all)=0.7946 [+0.0421]
  + MRF:       median(top-10)=0.9193, mean(top-10)=0.9223, median(all)=0.8362, mean(all)=0.7948 [+0.0005]
  TOTAL IMPROVEMENT (median top-10): +0.0426

================================================================================
Subject: OASIS-TRT-20-10
================================================================================
  Step 0: Generating predictions with V2 model (15 random views)...
  Mesh: 129540 vertices, 259076 faces
  Generating 15 random views...
  Generating predictions for 15 views (continuous camera pose)...
    ✓ Random_0 (pose=(0.21151418344344863, 2.69585126754417, 2.666479152128404)): shape (37, 800, 800)
      Valid pixels: 53439/640000 (8.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=9634, max=259075, num_faces=259076
      Valid probs shape: (37, 53439)
    ✓ Random_1 (pose=(2.9209166836956735, 0.35323082323085764, 1.8174960503967093)): shape (37, 800, 800)
      Valid pixels: 48586/640000 (7.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=191, max=259075, num_faces=259076
      Valid probs shape: (37, 48586)
    ✓ Random_2 (pose=(-1.8510010794783718, -1.5321912339267507, 2.0846472119794273)): shape (37, 800, 800)
      Valid pixels: 67248/640000 (10.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=10, max=259072, num_faces=259076
      Valid probs shape: (37, 67248)
    ✓ Random_3 (pose=(2.70934534680993, -2.714061363143935, 2.8776704597659677)): shape (37, 800, 800)
      Valid pixels: 54834/640000 (8.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=258983, num_faces=259076
      Valid probs shape: (37, 54834)
    ✓ Random_4 (pose=(1.279584897078677, -1.9993612896512494, -0.4201592559455243)): shape (37, 800, 800)
      Valid pixels: 87537/640000 (13.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=24, max=259075, num_faces=259076
      Valid probs shape: (37, 87537)
    ✓ Random_5 (pose=(1.9743061562344746, 1.723705874778112, -0.5614110361625877)): shape (37, 800, 800)
      Valid pixels: 82771/640000 (12.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=11, max=259072, num_faces=259076
      Valid probs shape: (37, 82771)
    ✓ Random_6 (pose=(-0.07501169977680089, -1.4586646155212792, 2.0201937761838122)): shape (37, 800, 800)
      Valid pixels: 77998/640000 (12.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=259074, num_faces=259076
      Valid probs shape: (37, 77998)
    ✓ Random_7 (pose=(-0.8623796438275706, 1.704769022674757, 1.056472125301939)): shape (37, 800, 800)
      Valid pixels: 72925/640000 (11.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=76, max=259068, num_faces=259076
      Valid probs shape: (37, 72925)
    ✓ Random_8 (pose=(-0.6161531698183134, -1.1624448783232353, 2.807635284965154)): shape (37, 800, 800)
      Valid pixels: 69483/640000 (10.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=259074, num_faces=259076
      Valid probs shape: (37, 69483)
    ✓ Random_9 (pose=(-0.23554686340429587, -1.3259796892637605, 2.847382220043568)): shape (37, 800, 800)
      Valid pixels: 59680/640000 (9.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=259074, num_faces=259076
      Valid probs shape: (37, 59680)
    ✓ Random_10 (pose=(0.5326471433279654, -1.7649287593656044, -2.4404937854871047)): shape (37, 800, 800)
      Valid pixels: 86274/640000 (13.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=66, max=259075, num_faces=259076
      Valid probs shape: (37, 86274)
    ✓ Random_11 (pose=(-3.0114832012981445, 2.9226460634754146, 0.0848838663456819)): shape (37, 800, 800)
      Valid pixels: 44437/640000 (6.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=258999, num_faces=259076
      Valid probs shape: (37, 44437)
    ✓ Random_12 (pose=(0.12698143607369783, 3.047785964082837, -2.8617190302648075)): shape (37, 800, 800)
      Valid pixels: 43056/640000 (6.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=63042, max=259075, num_faces=259076
      Valid probs shape: (37, 43056)
    ✓ Random_13 (pose=(0.36567944513841777, -1.3643106796182227, -1.7254912020009043)): shape (37, 800, 800)
      Valid pixels: 73240/640000 (11.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=259056, num_faces=259076
      Valid probs shape: (37, 73240)
    ✓ Random_14 (pose=(-1.0030738995102348, -1.9013703890527138, 1.4819553459782098)): shape (37, 800, 800)
      Valid pixels: 74466/640000 (11.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=49, max=259072, num_faces=259076
      Valid probs shape: (37, 74466)
    P stats: min=0.0000, max=1.0000, mean=0.0228
    Non-zero vertices: 109478/129540
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 20062  1023  1075  3185     0  2071   667  4184  5480]
  Ground Truth Stats:
    Labels shape: (129540,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-10/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7430
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8207
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8210

  RESULTS:
  RAW:         median(top-10)=0.8761, mean(top-10)=0.8855, median(all)=0.7733, mean(all)=0.7430
  + SMOOTHING: median(top-10)=0.9154, mean(top-10)=0.9218, median(all)=0.8736, mean(all)=0.8207 [+0.0393]
  + MRF:       median(top-10)=0.9156, mean(top-10)=0.9219, median(all)=0.8742, mean(all)=0.8210 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0396

================================================================================
Subject: OASIS-TRT-20-11
================================================================================
  Step 0: Generating predictions with V2 model (15 random views)...
  Mesh: 146531 vertices, 293058 faces
  Generating 15 random views...
  Generating predictions for 15 views (continuous camera pose)...
    ✓ Random_0 (pose=(-0.3498717306683772, -1.1838870174168032, -0.27126047370316364)): shape (37, 800, 800)
      Valid pixels: 67493/640000 (10.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=22, max=293057, num_faces=293058
      Valid probs shape: (37, 67493)
    ✓ Random_1 (pose=(1.1703746369823582, -0.5830288754494046, -1.819564692874046)): shape (37, 800, 800)
      Valid pixels: 65042/640000 (10.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=10, max=293057, num_faces=293058
      Valid probs shape: (37, 65042)
    ✓ Random_2 (pose=(1.5248492829786855, -1.4172695038450673, 0.3472465818737924)): shape (37, 800, 800)
      Valid pixels: 91633/640000 (14.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=13, max=293055, num_faces=293058
      Valid probs shape: (37, 91633)
    ✓ Random_3 (pose=(2.096930250730109, 2.081510959144226, 0.18197891135227273)): shape (37, 800, 800)
      Valid pixels: 97180/640000 (15.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=18, max=293055, num_faces=293058
      Valid probs shape: (37, 97180)
    ✓ Random_4 (pose=(1.060681703374729, 2.895092027662116, 0.15010326107863126)): shape (37, 800, 800)
      Valid pixels: 81808/640000 (12.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=293056, num_faces=293058
      Valid probs shape: (37, 81808)
    ✓ Random_5 (pose=(-2.008445819347138, -1.685688706966807, 1.8965818856429673)): shape (37, 800, 800)
      Valid pixels: 62756/640000 (9.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=18, max=293057, num_faces=293058
      Valid probs shape: (37, 62756)
    ✓ Random_6 (pose=(3.107085185113065, 2.2626499349140126, -2.0629041856825956)): shape (37, 800, 800)
      Valid pixels: 78419/640000 (12.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=292501, num_faces=293058
      Valid probs shape: (37, 78419)
    ✓ Random_7 (pose=(-2.136660579026543, -1.448312376723481, -0.8936336019247588)): shape (37, 800, 800)
      Valid pixels: 62909/640000 (9.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=33, max=291162, num_faces=293058
      Valid probs shape: (37, 62909)
    ✓ Random_8 (pose=(0.9080808989397271, 1.281606347088493, -0.532198306170728)): shape (37, 800, 800)
      Valid pixels: 95258/640000 (14.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=13, max=293055, num_faces=293058
      Valid probs shape: (37, 95258)
    ✓ Random_9 (pose=(1.6378428539740186, -2.2130433061135526, -0.6595308568980629)): shape (37, 800, 800)
      Valid pixels: 96683/640000 (15.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=17, max=293055, num_faces=293058
      Valid probs shape: (37, 96683)
    ✓ Random_10 (pose=(1.4807001049807837, -0.21749546977044343, 1.5873421317204697)): shape (37, 800, 800)
      Valid pixels: 57991/640000 (9.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=291178, num_faces=293058
      Valid probs shape: (37, 57991)
    ✓ Random_11 (pose=(2.6558880046835274, -0.8932816153811927, -1.9866009243561862)): shape (37, 800, 800)
      Valid pixels: 74475/640000 (11.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=28, max=293056, num_faces=293058
      Valid probs shape: (37, 74475)
    ✓ Random_12 (pose=(-1.8510186214209077, 3.087175414881134, -2.688619498145282)): shape (37, 800, 800)
      Valid pixels: 83852/640000 (13.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=293055, num_faces=293058
      Valid probs shape: (37, 83852)
    ✓ Random_13 (pose=(0.42030185004642906, 0.5093563057617545, -2.467668419684217)): shape (37, 800, 800)
      Valid pixels: 50011/640000 (7.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=293057, num_faces=293058
      Valid probs shape: (37, 50011)
    ✓ Random_14 (pose=(1.8845056278397854, -3.1329566378423674, 2.053668698862226)): shape (37, 800, 800)
      Valid pixels: 77690/640000 (12.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=292510, num_faces=293058
      Valid probs shape: (37, 77690)
    P stats: min=0.0000, max=0.9999, mean=0.0210
    Non-zero vertices: 113584/146531
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 32947   740  1123  2261     0  2405   979  4571  6069]
  Ground Truth Stats:
    Labels shape: (146531,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-11/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
    MRF iteration 5/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6845
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7957
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7960

  RESULTS:
  RAW:         median(top-10)=0.8425, mean(top-10)=0.8554, median(all)=0.7434, mean(all)=0.6845
  + SMOOTHING: median(top-10)=0.9082, mean(top-10)=0.9074, median(all)=0.8493, mean(all)=0.7957 [+0.0657]
  + MRF:       median(top-10)=0.9084, mean(top-10)=0.9079, median(all)=0.8493, mean(all)=0.7960 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0659

================================================================================
Subject: OASIS-TRT-20-12
================================================================================
  Step 0: Generating predictions with V2 model (15 random views)...
  Mesh: 144559 vertices, 289114 faces
  Generating 15 random views...
  Generating predictions for 15 views (continuous camera pose)...
    ✓ Random_0 (pose=(-0.2956219269412945, -2.5477060279380517, -0.16768132565578142)): shape (37, 800, 800)
      Valid pixels: 51798/640000 (8.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2495, max=289110, num_faces=289114
      Valid probs shape: (37, 51798)
    ✓ Random_1 (pose=(2.477343083025703, 1.6237800597053242, -2.2174366110182353)): shape (37, 800, 800)
      Valid pixels: 81642/640000 (12.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=26, max=289109, num_faces=289114
      Valid probs shape: (37, 81642)
    ✓ Random_2 (pose=(-2.480766571934958, 2.441292168192625, -1.235734064465395)): shape (37, 800, 800)
      Valid pixels: 67760/640000 (10.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=289054, num_faces=289114
      Valid probs shape: (37, 67760)
    ✓ Random_3 (pose=(-1.3197685823559424, -1.427303990215501, -2.8962363472970867)): shape (37, 800, 800)
      Valid pixels: 74211/640000 (11.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=289084, num_faces=289114
      Valid probs shape: (37, 74211)
    ✓ Random_4 (pose=(2.612115836361487, 2.764247037757551, -2.3403706090117855)): shape (37, 800, 800)
      Valid pixels: 55811/640000 (8.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=10, max=289033, num_faces=289114
      Valid probs shape: (37, 55811)
    ✓ Random_5 (pose=(-0.30349065204774606, 1.425904986462367, -1.4934124543509133)): shape (37, 800, 800)
      Valid pixels: 77041/640000 (12.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=289085, num_faces=289114
      Valid probs shape: (37, 77041)
    ✓ Random_6 (pose=(-1.5167967174792463, 1.7975370812333935, 2.0148774242633314)): shape (37, 800, 800)
      Valid pixels: 71295/640000 (11.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=49, max=289108, num_faces=289114
      Valid probs shape: (37, 71295)
    ✓ Random_7 (pose=(1.326113842436702, 1.4160116305305603, 0.4661953027157999)): shape (37, 800, 800)
      Valid pixels: 67788/640000 (10.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=288984, num_faces=289114
      Valid probs shape: (37, 67788)
    ✓ Random_8 (pose=(0.8357119156463884, 0.5036844853044244, 2.7354176081391257)): shape (37, 800, 800)
      Valid pixels: 67413/640000 (10.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=289066, num_faces=289114
      Valid probs shape: (37, 67413)
    ✓ Random_9 (pose=(-1.5661934977680252, -2.1012046998836493, 2.545552523427978)): shape (37, 800, 800)
      Valid pixels: 87808/640000 (13.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=288988, num_faces=289114
      Valid probs shape: (37, 87808)
    ✓ Random_10 (pose=(0.4356443749405918, -3.02649881619454, 0.9156329069612728)): shape (37, 800, 800)
      Valid pixels: 48525/640000 (7.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2114, max=289112, num_faces=289114
      Valid probs shape: (37, 48525)
    ✓ Random_11 (pose=(2.16511670019894, -2.218152789729281, 1.567352695633602)): shape (37, 800, 800)
      Valid pixels: 67685/640000 (10.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=289067, num_faces=289114
      Valid probs shape: (37, 67685)
    ✓ Random_12 (pose=(2.983519872886556, 0.008745857278238844, -3.13110317772317)): shape (37, 800, 800)
      Valid pixels: 44946/640000 (7.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=78232, max=289113, num_faces=289114
      Valid probs shape: (37, 44946)
    ✓ Random_13 (pose=(2.2838441301147983, 2.5768526832250647, -1.7915652051528628)): shape (37, 800, 800)
      Valid pixels: 60085/640000 (9.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=288950, num_faces=289114
      Valid probs shape: (37, 60085)
    ✓ Random_14 (pose=(2.944479431672236, 1.3094072647885584, -0.080488867886642)): shape (37, 800, 800)
      Valid pixels: 56688/640000 (8.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=111, max=289109, num_faces=289114
      Valid probs shape: (37, 56688)
    P stats: min=0.0000, max=1.0000, mean=0.0231
    Non-zero vertices: 123713/144559
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 20846  1280  1172  2195     0  1936   945  5000  5307]
  Ground Truth Stats:
    Labels shape: (144559,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-12/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7367
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8117
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8122

  RESULTS:
  RAW:         median(top-10)=0.8700, mean(top-10)=0.8735, median(all)=0.7649, mean(all)=0.7367
  + SMOOTHING: median(top-10)=0.9019, mean(top-10)=0.9074, median(all)=0.8521, mean(all)=0.8117 [+0.0319]
  + MRF:       median(top-10)=0.9027, mean(top-10)=0.9078, median(all)=0.8525, mean(all)=0.8122 [+0.0008]
  TOTAL IMPROVEMENT (median top-10): +0.0327

================================================================================
Subject: OASIS-TRT-20-13
================================================================================
  Step 0: Generating predictions with V2 model (15 random views)...
  Mesh: 122339 vertices, 244674 faces
  Generating 15 random views...
  Generating predictions for 15 views (continuous camera pose)...
    ✓ Random_0 (pose=(-1.3117586144158766, 3.00529372613559, 0.3729089625858415)): shape (37, 800, 800)
      Valid pixels: 81918/640000 (12.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=439, max=244673, num_faces=244674
      Valid probs shape: (37, 81918)
    ✓ Random_1 (pose=(1.4726926595187289, 0.4379987302047055, 1.2952781257350239)): shape (37, 800, 800)
      Valid pixels: 61333/640000 (9.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=244596, num_faces=244674
      Valid probs shape: (37, 61333)
    ✓ Random_2 (pose=(0.3368499847139619, -1.601143236681167, -1.757600723940687)): shape (37, 800, 800)
      Valid pixels: 87146/640000 (13.6%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=3, max=244671, num_faces=244674
      Valid probs shape: (37, 87146)
    ✓ Random_3 (pose=(-0.6542042461669664, -2.4937253077518555, -0.15684575129732048)): shape (37, 800, 800)
      Valid pixels: 69167/640000 (10.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1587, max=244673, num_faces=244674
      Valid probs shape: (37, 69167)
    ✓ Random_4 (pose=(0.9015847348104433, 2.301028094101408, -0.10403114157367277)): shape (37, 800, 800)
      Valid pixels: 80705/640000 (12.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=149, max=244603, num_faces=244674
      Valid probs shape: (37, 80705)
    ✓ Random_5 (pose=(1.6008647712740967, -0.938466444915476, 2.418149255289995)): shape (37, 800, 800)
      Valid pixels: 89160/640000 (13.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=244671, num_faces=244674
      Valid probs shape: (37, 89160)
    ✓ Random_6 (pose=(-0.3340601157548826, -1.0711672673634154, -1.279727329008185)): shape (37, 800, 800)
      Valid pixels: 83931/640000 (13.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=244592, num_faces=244674
      Valid probs shape: (37, 83931)
    ✓ Random_7 (pose=(1.399941492306941, -2.614530131871926, 1.980792593413784)): shape (37, 800, 800)
      Valid pixels: 67251/640000 (10.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=244671, num_faces=244674
      Valid probs shape: (37, 67251)
    ✓ Random_8 (pose=(2.687233462273375, 2.1183323659950783, -2.166783381031106)): shape (37, 800, 800)
      Valid pixels: 83424/640000 (13.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=244597, num_faces=244674
      Valid probs shape: (37, 83424)
    ✓ Random_9 (pose=(-0.6692350769371105, 2.758111609846697, 0.7904068978067023)): shape (37, 800, 800)
      Valid pixels: 68259/640000 (10.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8716, max=244673, num_faces=244674
      Valid probs shape: (37, 68259)
    ✓ Random_10 (pose=(0.012002284265488328, 2.496181725378526, 0.7057966345289204)): shape (37, 800, 800)
      Valid pixels: 61349/640000 (9.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=21893, max=244673, num_faces=244674
      Valid probs shape: (37, 61349)
    ✓ Random_11 (pose=(0.8577091326298301, 1.9628961593700138, -0.29888585768582354)): shape (37, 800, 800)
      Valid pixels: 85321/640000 (13.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=32, max=244602, num_faces=244674
      Valid probs shape: (37, 85321)
    ✓ Random_12 (pose=(-1.6122636837353188, 0.1732978833694765, -2.38474456154335)): shape (37, 800, 800)
      Valid pixels: 74516/640000 (11.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=32, max=244602, num_faces=244674
      Valid probs shape: (37, 74516)
    ✓ Random_13 (pose=(-2.684219314155729, 1.1715619883129529, 1.024377646495969)): shape (37, 800, 800)
      Valid pixels: 78433/640000 (12.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=217, max=244673, num_faces=244674
      Valid probs shape: (37, 78433)
    ✓ Random_14 (pose=(0.09513950596778109, 1.5813900748323437, -2.2989110136478854)): shape (37, 800, 800)
      Valid pixels: 88870/640000 (13.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=32, max=244673, num_faces=244674
      Valid probs shape: (37, 88870)
    P stats: min=0.0000, max=1.0000, mean=0.0233
    Non-zero vertices: 105556/122339
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 16783   955  1085  3051     0  1708  1125  3231  4860]
  Ground Truth Stats:
    Labels shape: (122339,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-13/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7383
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8141
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8144

  RESULTS:
  RAW:         median(top-10)=0.8789, mean(top-10)=0.8832, median(all)=0.7724, mean(all)=0.7383
  + SMOOTHING: median(top-10)=0.9080, mean(top-10)=0.9137, median(all)=0.8529, mean(all)=0.8141 [+0.0291]
  + MRF:       median(top-10)=0.9085, mean(top-10)=0.9139, median(all)=0.8526, mean(all)=0.8144 [+0.0005]
  TOTAL IMPROVEMENT (median top-10): +0.0297

================================================================================
Subject: OASIS-TRT-20-14
================================================================================
  Step 0: Generating predictions with V2 model (15 random views)...
  Mesh: 128019 vertices, 256034 faces
  Generating 15 random views...
  Generating predictions for 15 views (continuous camera pose)...
    ✓ Random_0 (pose=(-0.6114819427690592, 1.1582718551043234, -1.485145698035278)): shape (37, 800, 800)
      Valid pixels: 63641/640000 (9.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=255933, num_faces=256034
      Valid probs shape: (37, 63641)
    ✓ Random_1 (pose=(-1.9219428034112243, 0.2850686870430228, -0.1447115926525342)): shape (37, 800, 800)
      Valid pixels: 83718/640000 (13.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=487, max=256030, num_faces=256034
      Valid probs shape: (37, 83718)
    ✓ Random_2 (pose=(-2.0835025615001053, -1.1629766444366734, 1.3263212105420443)): shape (37, 800, 800)
      Valid pixels: 64422/640000 (10.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=105, max=256030, num_faces=256034
      Valid probs shape: (37, 64422)
    ✓ Random_3 (pose=(1.9680194606790904, -1.4175645120452445, -0.3153765672234785)): shape (37, 800, 800)
      Valid pixels: 87937/640000 (13.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=30, max=255933, num_faces=256034
      Valid probs shape: (37, 87937)
    ✓ Random_4 (pose=(-0.07186802201528142, 0.2650855851486904, -0.0008208927337118865)): shape (37, 800, 800)
      Valid pixels: 42283/640000 (6.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=255304, num_faces=256034
      Valid probs shape: (37, 42283)
    ✓ Random_5 (pose=(-0.4537634348253352, -2.454708689051074, 0.1526844390585298)): shape (37, 800, 800)
      Valid pixels: 52800/640000 (8.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=300, max=256030, num_faces=256034
      Valid probs shape: (37, 52800)
    ✓ Random_6 (pose=(3.06806479765181, -2.907193301536938, -2.4933156655155546)): shape (37, 800, 800)
      Valid pixels: 40935/640000 (6.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=255882, num_faces=256034
      Valid probs shape: (37, 40935)
    ✓ Random_7 (pose=(-3.068754506985777, 2.4141001809462814, -0.1373026475989776)): shape (37, 800, 800)
      Valid pixels: 49476/640000 (7.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=256030, num_faces=256034
      Valid probs shape: (37, 49476)
    ✓ Random_8 (pose=(-1.956625343155918, 2.7384280646358263, -0.9455571620352399)): shape (37, 800, 800)
      Valid pixels: 81682/640000 (12.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=255961, num_faces=256034
      Valid probs shape: (37, 81682)
    ✓ Random_9 (pose=(-0.8810044448683918, 3.074944680738369, -0.0028633043509231904)): shape (37, 800, 800)
      Valid pixels: 76427/640000 (11.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4333, max=256028, num_faces=256034
      Valid probs shape: (37, 76427)
    ✓ Random_10 (pose=(2.3707346491986208, 2.175045496460503, -2.098419664650745)): shape (37, 800, 800)
      Valid pixels: 69516/640000 (10.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=256030, num_faces=256034
      Valid probs shape: (37, 69516)
    ✓ Random_11 (pose=(-1.6733373221986696, -2.60546457537367, 0.7332423961750263)): shape (37, 800, 800)
      Valid pixels: 66842/640000 (10.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8, max=256030, num_faces=256034
      Valid probs shape: (37, 66842)
    ✓ Random_12 (pose=(2.47303001108721, 0.9630068389998021, -1.0540937199800156)): shape (37, 800, 800)
      Valid pixels: 56007/640000 (8.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=102, max=256030, num_faces=256034
      Valid probs shape: (37, 56007)
    ✓ Random_13 (pose=(-1.2726195865084398, 1.3966567622878676, -1.4867468261944632)): shape (37, 800, 800)
      Valid pixels: 55921/640000 (8.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=30, max=255980, num_faces=256034
      Valid probs shape: (37, 55921)
    ✓ Random_14 (pose=(-2.990701934881475, -3.078621102777404, -0.2754255672225536)): shape (37, 800, 800)
      Valid pixels: 42562/640000 (6.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=255320, num_faces=256034
      Valid probs shape: (37, 42562)
    P stats: min=0.0000, max=1.0000, mean=0.0240
    Non-zero vertices: 113556/128019
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 14463  1180  1186  3038     0  1908   998  3940  5784]
  Ground Truth Stats:
    Labels shape: (128019,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-14/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7547
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8269
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8275

  RESULTS:
  RAW:         median(top-10)=0.8706, mean(top-10)=0.8733, median(all)=0.8150, mean(all)=0.7547
  + SMOOTHING: median(top-10)=0.9101, mean(top-10)=0.9119, median(all)=0.8779, mean(all)=0.8269 [+0.0395]
  + MRF:       median(top-10)=0.9106, mean(top-10)=0.9120, median(all)=0.8779, mean(all)=0.8275 [+0.0005]
  TOTAL IMPROVEMENT (median top-10): +0.0401

================================================================================
Subject: OASIS-TRT-20-15
================================================================================
  Step 0: Generating predictions with V2 model (15 random views)...
  Mesh: 121081 vertices, 242158 faces
  Generating 15 random views...
  Generating predictions for 15 views (continuous camera pose)...
    ✓ Random_0 (pose=(2.757379030102177, 0.23289514946115242, -1.3379864060738635)): shape (37, 800, 800)
      Valid pixels: 37541/640000 (5.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1883, max=242153, num_faces=242158
      Valid probs shape: (37, 37541)
    ✓ Random_1 (pose=(0.6513568076606848, -2.692718744202076, -1.8078723635175473)): shape (37, 800, 800)
      Valid pixels: 53300/640000 (8.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2028, max=242153, num_faces=242158
      Valid probs shape: (37, 53300)
    ✓ Random_2 (pose=(-0.41315106972810645, 0.7968933799771141, -1.785426065144906)): shape (37, 800, 800)
      Valid pixels: 63888/640000 (10.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=242157, num_faces=242158
      Valid probs shape: (37, 63888)
    ✓ Random_3 (pose=(0.2846042053241349, -0.3659935062891151, -1.8300422679060329)): shape (37, 800, 800)
      Valid pixels: 51167/640000 (8.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=241820, num_faces=242158
      Valid probs shape: (37, 51167)
    ✓ Random_4 (pose=(2.5333253683472234, 2.7244457619600215, -1.4240694272569214)): shape (37, 800, 800)
      Valid pixels: 47821/640000 (7.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=242156, num_faces=242158
      Valid probs shape: (37, 47821)
    ✓ Random_5 (pose=(2.0981983487323603, -1.9455575486265924, 1.5554796586948054)): shape (37, 800, 800)
      Valid pixels: 68335/640000 (10.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=9, max=240823, num_faces=242158
      Valid probs shape: (37, 68335)
    ✓ Random_6 (pose=(-2.331246003137272, -0.9634839286000538, -1.6760205205438046)): shape (37, 800, 800)
      Valid pixels: 61923/640000 (9.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=25, max=242157, num_faces=242158
      Valid probs shape: (37, 61923)
    ✓ Random_7 (pose=(2.138904630194869, -2.9210326411205423, 2.54082789802435)): shape (37, 800, 800)
      Valid pixels: 74037/640000 (11.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=241776, num_faces=242158
      Valid probs shape: (37, 74037)
    ✓ Random_8 (pose=(-0.5649769300233367, -1.1610160911309342, 3.1214281106913324)): shape (37, 800, 800)
      Valid pixels: 56114/640000 (8.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=242157, num_faces=242158
      Valid probs shape: (37, 56114)
    ✓ Random_9 (pose=(0.8642866245345431, -1.438770285643014, -0.8914889927259204)): shape (37, 800, 800)
      Valid pixels: 53720/640000 (8.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=17, max=242156, num_faces=242158
      Valid probs shape: (37, 53720)
    ✓ Random_10 (pose=(0.424679485834802, -1.9403044657615574, 1.546785875550234)): shape (37, 800, 800)
      Valid pixels: 71753/640000 (11.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=242157, num_faces=242158
      Valid probs shape: (37, 71753)
    ✓ Random_11 (pose=(-1.964522957425403, -1.887625110854185, 2.7898644950423783)): shape (37, 800, 800)
      Valid pixels: 81372/640000 (12.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=15, max=242156, num_faces=242158
      Valid probs shape: (37, 81372)
    ✓ Random_12 (pose=(-0.018182960885428923, 2.1993504972663107, -1.0127909728639812)): shape (37, 800, 800)
      Valid pixels: 62502/640000 (9.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=19, max=242157, num_faces=242158
      Valid probs shape: (37, 62502)
    ✓ Random_13 (pose=(0.8849390542794007, -0.686380551807265, 3.1245605809209653)): shape (37, 800, 800)
      Valid pixels: 75052/640000 (11.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=241776, num_faces=242158
      Valid probs shape: (37, 75052)
    ✓ Random_14 (pose=(2.1023685535291508, 2.150319457841344, 2.9640280930160365)): shape (37, 800, 800)
      Valid pixels: 79268/640000 (12.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=241775, num_faces=242158
      Valid probs shape: (37, 79268)
    P stats: min=0.0000, max=1.0000, mean=0.0228
    Non-zero vertices: 102032/121081
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 19049  1004  1031  1936     0  1398   905  4038  4348]
  Ground Truth Stats:
    Labels shape: (121081,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-15/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7132
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7884
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7888

  RESULTS:
  RAW:         median(top-10)=0.8604, mean(top-10)=0.8596, median(all)=0.7678, mean(all)=0.7132
  + SMOOTHING: median(top-10)=0.8976, mean(top-10)=0.9001, median(all)=0.8290, mean(all)=0.7884 [+0.0372]
  + MRF:       median(top-10)=0.8980, mean(top-10)=0.9007, median(all)=0.8297, mean(all)=0.7888 [+0.0004]
  TOTAL IMPROVEMENT (median top-10): +0.0376

================================================================================
Subject: OASIS-TRT-20-16
================================================================================
  Step 0: Generating predictions with V2 model (15 random views)...
  Mesh: 137726 vertices, 275448 faces
  Generating 15 random views...
  Generating predictions for 15 views (continuous camera pose)...
    ✓ Random_0 (pose=(2.510380950568517, 0.4763327729346183, -0.5799392747875785)): shape (37, 800, 800)
      Valid pixels: 81764/640000 (12.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=49, max=275442, num_faces=275448
      Valid probs shape: (37, 81764)
    ✓ Random_1 (pose=(1.2960003791491532, 1.2568248227981087, 2.0158200802398376)): shape (37, 800, 800)
      Valid pixels: 107728/640000 (16.8%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=7, max=275447, num_faces=275448
      Valid probs shape: (37, 107728)
    ✓ Random_2 (pose=(-0.8531348416002444, -1.6792405456440875, -1.4215830360384492)): shape (37, 800, 800)
      Valid pixels: 110353/640000 (17.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=5, max=275446, num_faces=275448
      Valid probs shape: (37, 110353)
    ✓ Random_3 (pose=(0.8150136723876629, 0.909594933160534, 0.20406912953491219)): shape (37, 800, 800)
      Valid pixels: 78523/640000 (12.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=275447, num_faces=275448
      Valid probs shape: (37, 78523)
    ✓ Random_4 (pose=(2.090027432938645, 0.9985206643674482, 0.440687047170647)): shape (37, 800, 800)
      Valid pixels: 111845/640000 (17.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=275444, num_faces=275448
      Valid probs shape: (37, 111845)
    ✓ Random_5 (pose=(2.3667134753931576, 1.4562378184116724, 1.1318258343545127)): shape (37, 800, 800)
      Valid pixels: 100501/640000 (15.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=275447, num_faces=275448
      Valid probs shape: (37, 100501)
    ✓ Random_6 (pose=(3.131096324567614, -0.6708119310540797, 1.868438368801586)): shape (37, 800, 800)
      Valid pixels: 83049/640000 (13.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7409, max=275444, num_faces=275448
      Valid probs shape: (37, 83049)
    ✓ Random_7 (pose=(2.7390171759671746, -1.4602509976510505, -2.9268425518703847)): shape (37, 800, 800)
      Valid pixels: 71170/640000 (11.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=143, max=275342, num_faces=275448
      Valid probs shape: (37, 71170)
    ✓ Random_8 (pose=(-2.898838802772737, 1.370088853134308, -0.9385590550725991)): shape (37, 800, 800)
      Valid pixels: 92031/640000 (14.4%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=113, max=275444, num_faces=275448
      Valid probs shape: (37, 92031)
    ✓ Random_9 (pose=(1.110127133653405, 1.4086957735833208, 1.7200618195466886)): shape (37, 800, 800)
      Valid pixels: 104367/640000 (16.3%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=2, max=275447, num_faces=275448
      Valid probs shape: (37, 104367)
    ✓ Random_10 (pose=(0.8760235562467367, -2.1007763878441628, 2.9528386595698617)): shape (37, 800, 800)
      Valid pixels: 103996/640000 (16.2%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=296, max=275446, num_faces=275448
      Valid probs shape: (37, 103996)
    ✓ Random_11 (pose=(-0.5391180316353701, 3.135056390553763, -2.8847831621794473)): shape (37, 800, 800)
      Valid pixels: 67259/640000 (10.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=250, max=275447, num_faces=275448
      Valid probs shape: (37, 67259)
    ✓ Random_12 (pose=(2.3026262995398863, -1.267867870924188, 2.5853586790487793)): shape (37, 800, 800)
      Valid pixels: 100945/640000 (15.8%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=113, max=275444, num_faces=275448
      Valid probs shape: (37, 100945)
    ✓ Random_13 (pose=(0.5121768288510267, 1.1012260458604501, -1.3888080402208804)): shape (37, 800, 800)
      Valid pixels: 109139/640000 (17.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=275445, num_faces=275448
      Valid probs shape: (37, 109139)
    ✓ Random_14 (pose=(2.8636501999613833, 1.9796977528393835, -2.7402235768103225)): shape (37, 800, 800)
      Valid pixels: 103331/640000 (16.1%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=2, max=275430, num_faces=275448
      Valid probs shape: (37, 103331)
    P stats: min=0.0000, max=0.9998, mean=0.0236
    Non-zero vertices: 120092/137726
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 17634  1115   998  3299     0  1798   961  4482  5262]
  Ground Truth Stats:
    Labels shape: (137726,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-16/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7315
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7998
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8002

  RESULTS:
  RAW:         median(top-10)=0.8662, mean(top-10)=0.8747, median(all)=0.8083, mean(all)=0.7315
  + SMOOTHING: median(top-10)=0.9149, mean(top-10)=0.9177, median(all)=0.8349, mean(all)=0.7998 [+0.0487]
  + MRF:       median(top-10)=0.9149, mean(top-10)=0.9180, median(all)=0.8345, mean(all)=0.8002 [-0.0000]
  TOTAL IMPROVEMENT (median top-10): +0.0487

================================================================================
Subject: OASIS-TRT-20-17
================================================================================
  Step 0: Generating predictions with V2 model (15 random views)...
  Mesh: 148245 vertices, 296486 faces
  Generating 15 random views...
  Generating predictions for 15 views (continuous camera pose)...
    ✓ Random_0 (pose=(-0.8658990457390279, -0.2102909884043167, -2.7562611014124565)): shape (37, 800, 800)
      Valid pixels: 81680/640000 (12.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=296477, num_faces=296486
      Valid probs shape: (37, 81680)
    ✓ Random_1 (pose=(1.2475654444895001, 0.8503452699886291, -1.014440282663415)): shape (37, 800, 800)
      Valid pixels: 103158/640000 (16.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7, max=296485, num_faces=296486
      Valid probs shape: (37, 103158)
    ✓ Random_2 (pose=(-0.5860344258263464, -2.2688680047139784, -2.762895847707034)): shape (37, 800, 800)
      Valid pixels: 59275/640000 (9.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4585, max=296477, num_faces=296486
      Valid probs shape: (37, 59275)
    ✓ Random_3 (pose=(-1.4951462174060555, 0.4444209271797197, 1.66810375282207)): shape (37, 800, 800)
      Valid pixels: 70901/640000 (11.1%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=15, max=296485, num_faces=296486
      Valid probs shape: (37, 70901)
    ✓ Random_4 (pose=(1.3123216921192977, 2.0488493442710256, 0.35414564338927645)): shape (37, 800, 800)
      Valid pixels: 91808/640000 (14.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=10, max=296477, num_faces=296486
      Valid probs shape: (37, 91808)
    ✓ Random_5 (pose=(-2.9462690246013583, 0.8474104755440588, 2.4209585714437987)): shape (37, 800, 800)
      Valid pixels: 74646/640000 (11.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=452, max=296477, num_faces=296486
      Valid probs shape: (37, 74646)
    ✓ Random_6 (pose=(2.7710464195777034, 2.1295458812798307, -0.44879125903608763)): shape (37, 800, 800)
      Valid pixels: 57876/640000 (9.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8, max=296470, num_faces=296486
      Valid probs shape: (37, 57876)
    ✓ Random_7 (pose=(-0.3627123588122694, -3.089123255124189, 1.660589260006514)): shape (37, 800, 800)
      Valid pixels: 63493/640000 (9.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1826, max=296485, num_faces=296486
      Valid probs shape: (37, 63493)
    ✓ Random_8 (pose=(-1.1877775721487989, 0.04649675825349675, 1.2880892701331677)): shape (37, 800, 800)
      Valid pixels: 60962/640000 (9.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=296485, num_faces=296486
      Valid probs shape: (37, 60962)
    ✓ Random_9 (pose=(2.6900320316364006, 1.327411117106509, -3.082261972657427)): shape (37, 800, 800)
      Valid pixels: 94342/640000 (14.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=153, max=296396, num_faces=296486
      Valid probs shape: (37, 94342)
    ✓ Random_10 (pose=(-3.1075853453667475, 3.086160593063534, 1.4427428786539291)): shape (37, 800, 800)
      Valid pixels: 49965/640000 (7.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=294676, num_faces=296486
      Valid probs shape: (37, 49965)
    ✓ Random_11 (pose=(-1.3070196361224122, 0.5314163814621846, 0.07295128434610065)): shape (37, 800, 800)
      Valid pixels: 107879/640000 (16.9%)
      Probs stats: min=0.0000, max=0.9995, mean=0.0270
      Face IDs: min=0, max=296396, num_faces=296486
      Valid probs shape: (37, 107879)
    ✓ Random_12 (pose=(0.067824839503551, 0.6230100725536918, 0.6393792455557263)): shape (37, 800, 800)
      Valid pixels: 80867/640000 (12.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=294676, num_faces=296486
      Valid probs shape: (37, 80867)
    ✓ Random_13 (pose=(2.9089662782824597, 2.2815793682288854, 3.0374029000960014)): shape (37, 800, 800)
      Valid pixels: 77189/640000 (12.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=289426, num_faces=296486
      Valid probs shape: (37, 77189)
    ✓ Random_14 (pose=(-0.6745165043535017, -0.5433104805676887, 2.1668679618023514)): shape (37, 800, 800)
      Valid pixels: 86272/640000 (13.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=296477, num_faces=296486
      Valid probs shape: (37, 86272)
    P stats: min=0.0000, max=0.9998, mean=0.0229
    Non-zero vertices: 125349/148245
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 22896   656  1094  3788     0  1925  1155  4609  5631]
  Ground Truth Stats:
    Labels shape: (148245,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-17/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6847
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7627
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7631

  RESULTS:
  RAW:         median(top-10)=0.8271, mean(top-10)=0.8311, median(all)=0.7445, mean(all)=0.6847
  + SMOOTHING: median(top-10)=0.8815, mean(top-10)=0.8826, median(all)=0.8036, mean(all)=0.7627 [+0.0544]
  + MRF:       median(top-10)=0.8818, mean(top-10)=0.8830, median(all)=0.8036, mean(all)=0.7631 [+0.0004]
  TOTAL IMPROVEMENT (median top-10): +0.0547

================================================================================
Subject: OASIS-TRT-20-18
================================================================================
  Step 0: Generating predictions with V2 model (15 random views)...
  Mesh: 140676 vertices, 281348 faces
  Generating 15 random views...
  Generating predictions for 15 views (continuous camera pose)...
    ✓ Random_0 (pose=(2.813503708509346, 2.33757407598321, -2.948486657875921)): shape (37, 800, 800)
      Valid pixels: 73009/640000 (11.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=279797, num_faces=281348
      Valid probs shape: (37, 73009)
    ✓ Random_1 (pose=(2.797423105042853, 3.0334313323432625, 2.214817968565173)): shape (37, 800, 800)
      Valid pixels: 49440/640000 (7.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=279813, num_faces=281348
      Valid probs shape: (37, 49440)
    ✓ Random_2 (pose=(-1.7824307758321924, 0.5059841210394076, 0.05916425986370344)): shape (37, 800, 800)
      Valid pixels: 77256/640000 (12.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=83, max=281304, num_faces=281348
      Valid probs shape: (37, 77256)
    ✓ Random_3 (pose=(1.6583709056121547, 2.8411671403105547, 1.0776874382712922)): shape (37, 800, 800)
      Valid pixels: 60615/640000 (9.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=281345, num_faces=281348
      Valid probs shape: (37, 60615)
    ✓ Random_4 (pose=(-0.9726213758059035, 1.5676084634158656, 2.575753853616149)): shape (37, 800, 800)
      Valid pixels: 83494/640000 (13.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=20, max=281347, num_faces=281348
      Valid probs shape: (37, 83494)
    ✓ Random_5 (pose=(1.3214709130521847, 1.1298198768126424, 2.115291849139518)): shape (37, 800, 800)
      Valid pixels: 88746/640000 (13.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=11, max=280660, num_faces=281348
      Valid probs shape: (37, 88746)
    ✓ Random_6 (pose=(2.5534670485453637, 2.303636558388546, -1.3013470569648824)): shape (37, 800, 800)
      Valid pixels: 58007/640000 (9.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=281249, num_faces=281348
      Valid probs shape: (37, 58007)
    ✓ Random_7 (pose=(-0.3483587430767874, 0.5306687520603939, 0.34125610797571504)): shape (37, 800, 800)
      Valid pixels: 64797/640000 (10.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=280396, num_faces=281348
      Valid probs shape: (37, 64797)
    ✓ Random_8 (pose=(0.5434966471772489, 0.7908883490761967, 0.7289465466338827)): shape (37, 800, 800)
      Valid pixels: 59059/640000 (9.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=279806, num_faces=281348
      Valid probs shape: (37, 59059)
    ✓ Random_9 (pose=(-1.8305461964994494, -0.31972048786070006, 0.5133093066414216)): shape (37, 800, 800)
      Valid pixels: 70194/640000 (11.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=237, max=281300, num_faces=281348
      Valid probs shape: (37, 70194)
    ✓ Random_10 (pose=(0.6804183672186426, 0.30969181477238417, 0.017948037131990446)): shape (37, 800, 800)
      Valid pixels: 59971/640000 (9.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=281345, num_faces=281348
      Valid probs shape: (37, 59971)
    ✓ Random_11 (pose=(3.1178121477321072, 3.013059769007235, 1.7558163134920868)): shape (37, 800, 800)
      Valid pixels: 38428/640000 (6.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=281344, num_faces=281348
      Valid probs shape: (37, 38428)
    ✓ Random_12 (pose=(-0.17056903431820158, -2.447558563697717, -1.2550178200716244)): shape (37, 800, 800)
      Valid pixels: 67912/640000 (10.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5988, max=281300, num_faces=281348
      Valid probs shape: (37, 67912)
    ✓ Random_13 (pose=(-0.325925807657097, 0.15888726331782266, 1.6305301237848893)): shape (37, 800, 800)
      Valid pixels: 45976/640000 (7.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=281239, num_faces=281348
      Valid probs shape: (37, 45976)
    ✓ Random_14 (pose=(-1.7199745651924123, 0.2886669805510964, -1.3813378754937855)): shape (37, 800, 800)
      Valid pixels: 73572/640000 (11.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=281303, num_faces=281348
      Valid probs shape: (37, 73572)
    P stats: min=0.0000, max=1.0000, mean=0.0227
    Non-zero vertices: 118052/140676
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 22624  1183  1079  3042     0  1842   749  3998  6880]
  Ground Truth Stats:
    Labels shape: (140676,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-18/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
    MRF iteration 5/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7102
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7946
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7950

  RESULTS:
  RAW:         median(top-10)=0.8643, mean(top-10)=0.8623, median(all)=0.7425, mean(all)=0.7102
  + SMOOTHING: median(top-10)=0.9110, mean(top-10)=0.9044, median(all)=0.8180, mean(all)=0.7946 [+0.0467]
  + MRF:       median(top-10)=0.9116, mean(top-10)=0.9046, median(all)=0.8191, mean(all)=0.7950 [+0.0006]
  TOTAL IMPROVEMENT (median top-10): +0.0473

================================================================================
Subject: OASIS-TRT-20-19
================================================================================
  Step 0: Generating predictions with V2 model (15 random views)...
  Mesh: 114731 vertices, 229458 faces
  Generating 15 random views...
  Generating predictions for 15 views (continuous camera pose)...
    ✓ Random_0 (pose=(-0.23902969323392265, 0.016210403179870436, 0.33252397643367804)): shape (37, 800, 800)
      Valid pixels: 58272/640000 (9.1%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=0, max=229270, num_faces=229458
      Valid probs shape: (37, 58272)
    ✓ Random_1 (pose=(0.3198692503895151, 2.7238951149563206, -1.8860608967148456)): shape (37, 800, 800)
      Valid pixels: 70038/640000 (10.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=567, max=229457, num_faces=229458
      Valid probs shape: (37, 70038)
    ✓ Random_2 (pose=(-2.4193710600705702, -0.21062004905589848, 0.591277741573875)): shape (37, 800, 800)
      Valid pixels: 76969/640000 (12.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2913, max=229453, num_faces=229458
      Valid probs shape: (37, 76969)
    ✓ Random_3 (pose=(-2.0078734200060167, 2.216209484753217, -2.681137615291419)): shape (37, 800, 800)
      Valid pixels: 78260/640000 (12.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=229399, num_faces=229458
      Valid probs shape: (37, 78260)
    ✓ Random_4 (pose=(2.4885642216512522, -2.714364933280539, 2.3175951883137245)): shape (37, 800, 800)
      Valid pixels: 88287/640000 (13.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=229447, num_faces=229458
      Valid probs shape: (37, 88287)
    ✓ Random_5 (pose=(-2.435091712660188, -2.4244761746549175, 0.20538507712960952)): shape (37, 800, 800)
      Valid pixels: 97358/640000 (15.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=229453, num_faces=229458
      Valid probs shape: (37, 97358)
    ✓ Random_6 (pose=(-2.0657373887586807, 0.6192635576348429, 1.6786593145043476)): shape (37, 800, 800)
      Valid pixels: 92017/640000 (14.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=290, max=229407, num_faces=229458
      Valid probs shape: (37, 92017)
    ✓ Random_7 (pose=(-0.9786416551883685, -2.535487856136734, 1.5931495602835781)): shape (37, 800, 800)
      Valid pixels: 88994/640000 (13.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=86, max=229407, num_faces=229458
      Valid probs shape: (37, 88994)
    ✓ Random_8 (pose=(1.3438100669182953, -2.5149081416063193, -0.09526705898962717)): shape (37, 800, 800)
      Valid pixels: 113390/640000 (17.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=4, max=229407, num_faces=229458
      Valid probs shape: (37, 113390)
    ✓ Random_9 (pose=(1.198496303363001, -2.6850331217305063, -0.035866572152945864)): shape (37, 800, 800)
      Valid pixels: 110121/640000 (17.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=257, max=229407, num_faces=229458
      Valid probs shape: (37, 110121)
    ✓ Random_10 (pose=(-0.8716432324129335, -1.819553581322775, -0.6676576717468534)): shape (37, 800, 800)
      Valid pixels: 99248/640000 (15.5%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=1, max=229453, num_faces=229458
      Valid probs shape: (37, 99248)
    ✓ Random_11 (pose=(0.2172963907617822, 2.1914991697630954, -2.4114367527510043)): shape (37, 800, 800)
      Valid pixels: 88823/640000 (13.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=87, max=229407, num_faces=229458
      Valid probs shape: (37, 88823)
    ✓ Random_12 (pose=(1.5445639845028554, -1.8122907596180564, -1.5734608633186258)): shape (37, 800, 800)
      Valid pixels: 70220/640000 (11.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=18, max=229407, num_faces=229458
      Valid probs shape: (37, 70220)
    ✓ Random_13 (pose=(-0.26771331462956693, -0.9101482415874296, 0.9901560438471213)): shape (37, 800, 800)
      Valid pixels: 82163/640000 (12.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=229407, num_faces=229458
      Valid probs shape: (37, 82163)
    ✓ Random_14 (pose=(-0.3889459268323838, 1.907960930783756, -2.6868993424107055)): shape (37, 800, 800)
      Valid pixels: 109174/640000 (17.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=95, max=229407, num_faces=229458
      Valid probs shape: (37, 109174)
    P stats: min=0.0000, max=0.9999, mean=0.0224
    Non-zero vertices: 94947/114731
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 19784  1475   961  2082     0  1759   766  3310  5609]
  Ground Truth Stats:
    Labels shape: (114731,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-19/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7121
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7958
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7963

  RESULTS:
  RAW:         median(top-10)=0.8518, mean(top-10)=0.8545, median(all)=0.7525, mean(all)=0.7121
  + SMOOTHING: median(top-10)=0.9157, mean(top-10)=0.9196, median(all)=0.8156, mean(all)=0.7958 [+0.0639]
  + MRF:       median(top-10)=0.9163, mean(top-10)=0.9200, median(all)=0.8158, mean(all)=0.7963 [+0.0006]
  TOTAL IMPROVEMENT (median top-10): +0.0645

================================================================================
Subject: OASIS-TRT-20-2
================================================================================
  Step 0: Generating predictions with V2 model (15 random views)...
  Mesh: 153483 vertices, 306962 faces
  Generating 15 random views...
  Generating predictions for 15 views (continuous camera pose)...
    ✓ Random_0 (pose=(-2.6197203867703314, -3.0553153217438447, 2.1512379085961983)): shape (37, 800, 800)
      Valid pixels: 53315/640000 (8.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=306950, num_faces=306962
      Valid probs shape: (37, 53315)
    ✓ Random_1 (pose=(2.4387919488385856, -2.280138836046091, -3.0252109014073305)): shape (37, 800, 800)
      Valid pixels: 65131/640000 (10.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=306960, num_faces=306962
      Valid probs shape: (37, 65131)
    ✓ Random_2 (pose=(-1.1542401316747841, 0.8236217296751587, 2.1653935986023454)): shape (37, 800, 800)
      Valid pixels: 73324/640000 (11.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=306957, num_faces=306962
      Valid probs shape: (37, 73324)
    ✓ Random_3 (pose=(1.045554390577566, -1.1336506517020268, 2.5563133577946777)): shape (37, 800, 800)
      Valid pixels: 84029/640000 (13.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=305174, num_faces=306962
      Valid probs shape: (37, 84029)
    ✓ Random_4 (pose=(-1.2746858531941427, 3.111941242170089, 0.6589492344332006)): shape (37, 800, 800)
      Valid pixels: 77595/640000 (12.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=495, max=306959, num_faces=306962
      Valid probs shape: (37, 77595)
    ✓ Random_5 (pose=(1.8095495630567484, -0.5742374384253908, -3.0999716580189256)): shape (37, 800, 800)
      Valid pixels: 89090/640000 (13.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=22, max=306957, num_faces=306962
      Valid probs shape: (37, 89090)
    ✓ Random_6 (pose=(-0.34542806498861145, -1.6560355152939417, 2.3850304612888618)): shape (37, 800, 800)
      Valid pixels: 84788/640000 (13.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=306869, num_faces=306962
      Valid probs shape: (37, 84788)
    ✓ Random_7 (pose=(-2.700114924194035, -2.973859657961845, -2.275155166061978)): shape (37, 800, 800)
      Valid pixels: 56288/640000 (8.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=306871, num_faces=306962
      Valid probs shape: (37, 56288)
    ✓ Random_8 (pose=(0.16790869096550143, -2.457158545934179, 1.887493659880918)): shape (37, 800, 800)
      Valid pixels: 61550/640000 (9.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=737, max=306961, num_faces=306962
      Valid probs shape: (37, 61550)
    ✓ Random_9 (pose=(-1.4101467742644005, 2.917028965039581, -2.2909766890056784)): shape (37, 800, 800)
      Valid pixels: 73773/640000 (11.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=60, max=306868, num_faces=306962
      Valid probs shape: (37, 73773)
    ✓ Random_10 (pose=(2.923894568547343, -0.5855999017642541, -2.6880252832530167)): shape (37, 800, 800)
      Valid pixels: 50600/640000 (7.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=879, max=306961, num_faces=306962
      Valid probs shape: (37, 50600)
    ✓ Random_11 (pose=(-2.3458494251818993, 1.0838479044136307, -2.5672232579575134)): shape (37, 800, 800)
      Valid pixels: 61626/640000 (9.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1439, max=306871, num_faces=306962
      Valid probs shape: (37, 61626)
    ✓ Random_12 (pose=(2.3816687151141007, -1.235833502137867, 2.7953877507580174)): shape (37, 800, 800)
      Valid pixels: 82935/640000 (13.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=251, max=306959, num_faces=306962
      Valid probs shape: (37, 82935)
    ✓ Random_13 (pose=(-3.070892646996278, -2.725695692255238, -1.2679060196460359)): shape (37, 800, 800)
      Valid pixels: 54795/640000 (8.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=306871, num_faces=306962
      Valid probs shape: (37, 54795)
    ✓ Random_14 (pose=(0.09490199311165837, -2.5187549883945923, -0.529253197355124)): shape (37, 800, 800)
      Valid pixels: 55942/640000 (8.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4088, max=306960, num_faces=306962
      Valid probs shape: (37, 55942)
    P stats: min=0.0000, max=1.0000, mean=0.0222
    Non-zero vertices: 125836/153483
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 27647  1336  1227  3167     0  2038  1035  4596  6290]
  Ground Truth Stats:
    Labels shape: (153483,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-2/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7171
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7988
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7991

  RESULTS:
  RAW:         median(top-10)=0.8523, mean(top-10)=0.8638, median(all)=0.7811, mean(all)=0.7171
  + SMOOTHING: median(top-10)=0.9147, mean(top-10)=0.9171, median(all)=0.8614, mean(all)=0.7988 [+0.0624]
  + MRF:       median(top-10)=0.9148, mean(top-10)=0.9173, median(all)=0.8618, mean(all)=0.7991 [+0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0625

================================================================================
Subject: OASIS-TRT-20-20
================================================================================
  Step 0: Generating predictions with V2 model (15 random views)...
  Mesh: 124947 vertices, 249890 faces
  Generating 15 random views...
  Generating predictions for 15 views (continuous camera pose)...
    ✓ Random_0 (pose=(-2.063017850170554, 2.4493534141397797, 1.5119002527615022)): shape (37, 800, 800)
      Valid pixels: 80590/640000 (12.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=11, max=249884, num_faces=249890
      Valid probs shape: (37, 80590)
    ✓ Random_1 (pose=(-2.0384879094217645, -0.1709617214080712, 0.31378901639289136)): shape (37, 800, 800)
      Valid pixels: 88535/640000 (13.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=249, max=249889, num_faces=249890
      Valid probs shape: (37, 88535)
    ✓ Random_2 (pose=(1.5332278510365809, 1.2194434138260597, -1.839392060469723)): shape (37, 800, 800)
      Valid pixels: 72692/640000 (11.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=9, max=249888, num_faces=249890
      Valid probs shape: (37, 72692)
    ✓ Random_3 (pose=(-2.701956878006497, -2.140220134502242, -2.3970511913805064)): shape (37, 800, 800)
      Valid pixels: 99201/640000 (15.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=249867, num_faces=249890
      Valid probs shape: (37, 99201)
    ✓ Random_4 (pose=(2.459359364148412, 0.6877167925447605, -1.2015701210859404)): shape (37, 800, 800)
      Valid pixels: 71471/640000 (11.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=16, max=249889, num_faces=249890
      Valid probs shape: (37, 71471)
    ✓ Random_5 (pose=(-0.579328950433903, 1.7446191687092218, 0.6345822441736435)): shape (37, 800, 800)
      Valid pixels: 104258/640000 (16.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=115, max=249889, num_faces=249890
      Valid probs shape: (37, 104258)
    ✓ Random_6 (pose=(-2.272728826249142, 1.0183303424671486, 1.246222986072378)): shape (37, 800, 800)
      Valid pixels: 86194/640000 (13.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=18, max=249888, num_faces=249890
      Valid probs shape: (37, 86194)
    ✓ Random_7 (pose=(-1.0328594880143904, -1.0946779902579804, -2.256534793424612)): shape (37, 800, 800)
      Valid pixels: 70097/640000 (11.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6, max=249755, num_faces=249890
      Valid probs shape: (37, 70097)
    ✓ Random_8 (pose=(-1.4484477523672796, -1.4412683030741702, -2.8105668218770843)): shape (37, 800, 800)
      Valid pixels: 86549/640000 (13.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=21, max=249875, num_faces=249890
      Valid probs shape: (37, 86549)
    ✓ Random_9 (pose=(-1.1634744166551867, 1.6154699340419922, 1.0496136207284321)): shape (37, 800, 800)
      Valid pixels: 78256/640000 (12.2%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=19, max=249888, num_faces=249890
      Valid probs shape: (37, 78256)
    ✓ Random_10 (pose=(1.0629034061235831, -1.4095946614842847, 2.8467526621252963)): shape (37, 800, 800)
      Valid pixels: 102615/640000 (16.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=3, max=249719, num_faces=249890
      Valid probs shape: (37, 102615)
    ✓ Random_11 (pose=(-2.591014403742209, -0.29920185160168566, -0.8362785264674515)): shape (37, 800, 800)
      Valid pixels: 68071/640000 (10.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=11013, max=249889, num_faces=249890
      Valid probs shape: (37, 68071)
    ✓ Random_12 (pose=(0.9658144811605229, -3.1044888548887, -2.536570446413216)): shape (37, 800, 800)
      Valid pixels: 78096/640000 (12.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=3959, max=249889, num_faces=249890
      Valid probs shape: (37, 78096)
    ✓ Random_13 (pose=(1.1167863368107502, 2.906755263439492, -0.393949526516451)): shape (37, 800, 800)
      Valid pixels: 97499/640000 (15.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=19, max=249884, num_faces=249890
      Valid probs shape: (37, 97499)
    ✓ Random_14 (pose=(2.7713663402062467, -0.05702263192757062, 1.1778170873420697)): shape (37, 800, 800)
      Valid pixels: 50738/640000 (7.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=52318, max=249889, num_faces=249890
      Valid probs shape: (37, 50738)
    P stats: min=0.0000, max=1.0000, mean=0.0235
    Non-zero vertices: 108716/124947
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 16231   872   965  2748     0  1410   849  4544  4353]
  Ground Truth Stats:
    Labels shape: (124947,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-20/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7475
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8191
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8192

  RESULTS:
  RAW:         median(top-10)=0.8549, mean(top-10)=0.8684, median(all)=0.8081, mean(all)=0.7475
  + SMOOTHING: median(top-10)=0.9213, mean(top-10)=0.9196, median(all)=0.8668, mean(all)=0.8191 [+0.0663]
  + MRF:       median(top-10)=0.9211, mean(top-10)=0.9197, median(all)=0.8671, mean(all)=0.8192 [-0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0662

================================================================================
Subject: OASIS-TRT-20-3
================================================================================
  Step 0: Generating predictions with V2 model (15 random views)...
  Mesh: 134843 vertices, 269682 faces
  Generating 15 random views...
  Generating predictions for 15 views (continuous camera pose)...
    ✓ Random_0 (pose=(2.4523667067906416, 2.499620609312152, 2.942511481425581)): shape (37, 800, 800)
      Valid pixels: 74123/640000 (11.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=269532, num_faces=269682
      Valid probs shape: (37, 74123)
    ✓ Random_1 (pose=(1.1603391407886416, -0.5132346340270546, -1.3000901207914246)): shape (37, 800, 800)
      Valid pixels: 55968/640000 (8.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=31, max=269639, num_faces=269682
      Valid probs shape: (37, 55968)
    ✓ Random_2 (pose=(0.5980335402742707, 2.7811228005908024, -0.7143355489970467)): shape (37, 800, 800)
      Valid pixels: 67102/640000 (10.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=159, max=269639, num_faces=269682
      Valid probs shape: (37, 67102)
    ✓ Random_3 (pose=(1.502897946861565, 2.257941095702937, -2.7864924962817885)): shape (37, 800, 800)
      Valid pixels: 75060/640000 (11.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=63, max=269638, num_faces=269682
      Valid probs shape: (37, 75060)
    ✓ Random_4 (pose=(3.028432835045402, -1.033971508134131, 0.21405363770928165)): shape (37, 800, 800)
      Valid pixels: 53271/640000 (8.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4310, max=269680, num_faces=269682
      Valid probs shape: (37, 53271)
    ✓ Random_5 (pose=(1.6028130468550437, 1.9269454304301838, -2.1476742150627333)): shape (37, 800, 800)
      Valid pixels: 65144/640000 (10.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=18, max=269638, num_faces=269682
      Valid probs shape: (37, 65144)
    ✓ Random_6 (pose=(-0.7717696517311818, -0.3122038053368992, 0.8431088010044552)): shape (37, 800, 800)
      Valid pixels: 51455/640000 (8.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=269638, num_faces=269682
      Valid probs shape: (37, 51455)
    ✓ Random_7 (pose=(-0.30667567738627843, -0.2575644207787011, -1.1136455448197191)): shape (37, 800, 800)
      Valid pixels: 53729/640000 (8.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=268256, num_faces=269682
      Valid probs shape: (37, 53729)
    ✓ Random_8 (pose=(2.929185738611504, -2.5621559680184465, -1.958916712079734)): shape (37, 800, 800)
      Valid pixels: 57771/640000 (9.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=269639, num_faces=269682
      Valid probs shape: (37, 57771)
    ✓ Random_9 (pose=(-0.5753380816720548, -1.275576174038557, 0.0906031774417202)): shape (37, 800, 800)
      Valid pixels: 61951/640000 (9.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=7, max=269638, num_faces=269682
      Valid probs shape: (37, 61951)
    ✓ Random_10 (pose=(2.1719866747914347, -1.9100041728683839, 1.690161764874353)): shape (37, 800, 800)
      Valid pixels: 83091/640000 (13.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=269680, num_faces=269682
      Valid probs shape: (37, 83091)
    ✓ Random_11 (pose=(-0.2790521909583834, 0.22542690435181623, 3.1356931615855936)): shape (37, 800, 800)
      Valid pixels: 46968/640000 (7.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=269639, num_faces=269682
      Valid probs shape: (37, 46968)
    ✓ Random_12 (pose=(-1.9077797681088577, 0.9266101466704226, -1.469572876140804)): shape (37, 800, 800)
      Valid pixels: 71908/640000 (11.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=269680, num_faces=269682
      Valid probs shape: (37, 71908)
    ✓ Random_13 (pose=(0.14751433557197524, 1.7227148735511308, 0.39423108434700893)): shape (37, 800, 800)
      Valid pixels: 66491/640000 (10.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7, max=269680, num_faces=269682
      Valid probs shape: (37, 66491)
    ✓ Random_14 (pose=(1.6599131749970955, 2.879876505963857, -1.1614853937563363)): shape (37, 800, 800)
      Valid pixels: 74805/640000 (11.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=28, max=269639, num_faces=269682
      Valid probs shape: (37, 74805)
    P stats: min=0.0000, max=1.0000, mean=0.0227
    Non-zero vertices: 113208/134843
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 21635  1213   988  2923     0  1664   989  4040  6482]
  Ground Truth Stats:
    Labels shape: (134843,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-3/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6880
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7765
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7767

  RESULTS:
  RAW:         median(top-10)=0.8379, mean(top-10)=0.8463, median(all)=0.7759, mean(all)=0.6880
  + SMOOTHING: median(top-10)=0.9078, mean(top-10)=0.9065, median(all)=0.8347, mean(all)=0.7765 [+0.0698]
  + MRF:       median(top-10)=0.9080, mean(top-10)=0.9067, median(all)=0.8348, mean(all)=0.7767 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0701

================================================================================
Subject: OASIS-TRT-20-4
================================================================================
  Step 0: Generating predictions with V2 model (15 random views)...
  Mesh: 138101 vertices, 276198 faces
  Generating 15 random views...
  Generating predictions for 15 views (continuous camera pose)...
    ✓ Random_0 (pose=(-1.4682504307053086, -0.7859292377176827, -3.069476900239072)): shape (37, 800, 800)
      Valid pixels: 100583/640000 (15.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=9, max=276195, num_faces=276198
      Valid probs shape: (37, 100583)
    ✓ Random_1 (pose=(1.3723641585388027, -2.0875497828265326, 1.367622619060211)): shape (37, 800, 800)
      Valid pixels: 65926/640000 (10.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=14, max=276194, num_faces=276198
      Valid probs shape: (37, 65926)
    ✓ Random_2 (pose=(2.9950942490845804, -2.374365871218578, 0.1026951740139479)): shape (37, 800, 800)
      Valid pixels: 57484/640000 (9.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=276188, num_faces=276198
      Valid probs shape: (37, 57484)
    ✓ Random_3 (pose=(-2.156944975521438, 1.3147092977167834, -2.8476148319461094)): shape (37, 800, 800)
      Valid pixels: 73761/640000 (11.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=12, max=276195, num_faces=276198
      Valid probs shape: (37, 73761)
    ✓ Random_4 (pose=(2.8831483664939803, -2.543758835141133, -0.40959056363012136)): shape (37, 800, 800)
      Valid pixels: 64653/640000 (10.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=276194, num_faces=276198
      Valid probs shape: (37, 64653)
    ✓ Random_5 (pose=(-1.2760442152004354, 2.390521400178919, 2.5129860667612496)): shape (37, 800, 800)
      Valid pixels: 98479/640000 (15.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=99, max=276197, num_faces=276198
      Valid probs shape: (37, 98479)
    ✓ Random_6 (pose=(-0.44319205668264017, 2.5903388690829896, 2.891574835521017)): shape (37, 800, 800)
      Valid pixels: 70497/640000 (11.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=398, max=276196, num_faces=276198
      Valid probs shape: (37, 70497)
    ✓ Random_7 (pose=(-1.6251667509061452, 0.11750380067122634, 1.7321696798666482)): shape (37, 800, 800)
      Valid pixels: 72387/640000 (11.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=85, max=276195, num_faces=276198
      Valid probs shape: (37, 72387)
    ✓ Random_8 (pose=(1.4620804836029286, 3.081441660617517, 2.6464034515991193)): shape (37, 800, 800)
      Valid pixels: 100118/640000 (15.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=276192, num_faces=276198
      Valid probs shape: (37, 100118)
    ✓ Random_9 (pose=(2.66522153364229, -0.6434052884200043, -1.2374765624517272)): shape (37, 800, 800)
      Valid pixels: 83995/640000 (13.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=398, max=276196, num_faces=276198
      Valid probs shape: (37, 83995)
    ✓ Random_10 (pose=(1.703930429660085, -1.8872165702687531, 1.8047858504570007)): shape (37, 800, 800)
      Valid pixels: 81170/640000 (12.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8, max=275472, num_faces=276198
      Valid probs shape: (37, 81170)
    ✓ Random_11 (pose=(2.6803679559020397, -2.822839526411757, 2.1928843317641578)): shape (37, 800, 800)
      Valid pixels: 71849/640000 (11.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=275898, num_faces=276198
      Valid probs shape: (37, 71849)
    ✓ Random_12 (pose=(-0.8734010438989364, 2.5553181253698742, 1.080550050447064)): shape (37, 800, 800)
      Valid pixels: 77123/640000 (12.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1298, max=276196, num_faces=276198
      Valid probs shape: (37, 77123)
    ✓ Random_13 (pose=(-1.5665307208318253, -2.227633385544953, 2.135474814996096)): shape (37, 800, 800)
      Valid pixels: 92255/640000 (14.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=55, max=276195, num_faces=276198
      Valid probs shape: (37, 92255)
    ✓ Random_14 (pose=(0.6881677114661455, 3.0176846780608173, 2.089303657693085)): shape (37, 800, 800)
      Valid pixels: 72332/640000 (11.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=26808, max=276197, num_faces=276198
      Valid probs shape: (37, 72332)
    P stats: min=0.0000, max=1.0000, mean=0.0235
    Non-zero vertices: 120164/138101
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 17937   684   878  3117     0  2208   872  3968  5562]
  Ground Truth Stats:
    Labels shape: (138101,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-4/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7309
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8070
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8077

  RESULTS:
  RAW:         median(top-10)=0.8870, mean(top-10)=0.8948, median(all)=0.8096, mean(all)=0.7309
  + SMOOTHING: median(top-10)=0.9238, mean(top-10)=0.9253, median(all)=0.8862, mean(all)=0.8070 [+0.0369]
  + MRF:       median(top-10)=0.9240, mean(top-10)=0.9257, median(all)=0.8869, mean(all)=0.8077 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0371

================================================================================
Subject: OASIS-TRT-20-5
================================================================================
  Step 0: Generating predictions with V2 model (15 random views)...
  Mesh: 151342 vertices, 302680 faces
  Generating 15 random views...
  Generating predictions for 15 views (continuous camera pose)...
    ✓ Random_0 (pose=(-0.8617861723241278, -2.533155316048826, 0.2271858009781491)): shape (37, 800, 800)
      Valid pixels: 81967/640000 (12.8%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=5871, max=302679, num_faces=302680
      Valid probs shape: (37, 81967)
    ✓ Random_1 (pose=(1.0117146813823013, 2.040727094674361, -2.167554046108284)): shape (37, 800, 800)
      Valid pixels: 72354/640000 (11.3%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=314, max=302672, num_faces=302680
      Valid probs shape: (37, 72354)
    ✓ Random_2 (pose=(-3.11103235476163, 0.9569047421622381, -1.454744118221222)): shape (37, 800, 800)
      Valid pixels: 92009/640000 (14.4%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=5327, max=302679, num_faces=302680
      Valid probs shape: (37, 92009)
    ✓ Random_3 (pose=(-1.9316316365749109, -0.3255947479348449, -3.0998988694147194)): shape (37, 800, 800)
      Valid pixels: 103880/640000 (16.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=302671, num_faces=302680
      Valid probs shape: (37, 103880)
    ✓ Random_4 (pose=(3.1185689995678896, 2.887792002460472, 1.5452398370156084)): shape (37, 800, 800)
      Valid pixels: 55409/640000 (8.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=302611, num_faces=302680
      Valid probs shape: (37, 55409)
    ✓ Random_5 (pose=(0.5750341764247988, -2.9184847772791684, 0.9023111489699991)): shape (37, 800, 800)
      Valid pixels: 62451/640000 (9.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1092, max=302677, num_faces=302680
      Valid probs shape: (37, 62451)
    ✓ Random_6 (pose=(-1.937820512218358, -2.6612239692201203, 1.5134599521562446)): shape (37, 800, 800)
      Valid pixels: 66150/640000 (10.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=302679, num_faces=302680
      Valid probs shape: (37, 66150)
    ✓ Random_7 (pose=(0.17193227458683769, 1.7710357384453115, 1.8199476783700934)): shape (37, 800, 800)
      Valid pixels: 97011/640000 (15.2%)
      Probs stats: min=0.0000, max=0.9995, mean=0.0270
      Face IDs: min=314, max=302679, num_faces=302680
      Valid probs shape: (37, 97011)
    ✓ Random_8 (pose=(-1.8290574705580027, -1.119433502801864, -1.4284213149005225)): shape (37, 800, 800)
      Valid pixels: 67281/640000 (10.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6, max=302623, num_faces=302680
      Valid probs shape: (37, 67281)
    ✓ Random_9 (pose=(1.764748728398411, -1.0293153930729324, 0.22536323453678175)): shape (37, 800, 800)
      Valid pixels: 95600/640000 (14.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=302626, num_faces=302680
      Valid probs shape: (37, 95600)
    ✓ Random_10 (pose=(2.7293894460143227, 2.2029740605189936, -0.21406232328192853)): shape (37, 800, 800)
      Valid pixels: 66313/640000 (10.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=302477, num_faces=302680
      Valid probs shape: (37, 66313)
    ✓ Random_11 (pose=(2.710457451515029, 0.2254410806380025, -2.221186604734093)): shape (37, 800, 800)
      Valid pixels: 72069/640000 (11.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5953, max=302677, num_faces=302680
      Valid probs shape: (37, 72069)
    ✓ Random_12 (pose=(-2.8573063452189595, -0.6968271228337346, 1.109196571596927)): shape (37, 800, 800)
      Valid pixels: 85601/640000 (13.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7329, max=302679, num_faces=302680
      Valid probs shape: (37, 85601)
    ✓ Random_13 (pose=(-2.631499743771501, 1.1527790315377908, -0.08683809953052535)): shape (37, 800, 800)
      Valid pixels: 79319/640000 (12.4%)
      Probs stats: min=0.0000, max=0.9994, mean=0.0270
      Face IDs: min=1548, max=302677, num_faces=302680
      Valid probs shape: (37, 79319)
    ✓ Random_14 (pose=(0.2869818911041482, -2.075763527358666, -1.6674597206792974)): shape (37, 800, 800)
      Valid pixels: 91792/640000 (14.3%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=2422, max=302679, num_faces=302680
      Valid probs shape: (37, 91792)
    P stats: min=0.0000, max=1.0000, mean=0.0219
    Non-zero vertices: 122886/151342
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 28456   827   913  3118     0  2406  1082  5534  5015]
  Ground Truth Stats:
    Labels shape: (151342,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-5/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7077
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7935
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7942

  RESULTS:
  RAW:         median(top-10)=0.8444, mean(top-10)=0.8471, median(all)=0.7459, mean(all)=0.7077
  + SMOOTHING: median(top-10)=0.9010, mean(top-10)=0.9052, median(all)=0.8436, mean(all)=0.7935 [+0.0565]
  + MRF:       median(top-10)=0.9018, mean(top-10)=0.9058, median(all)=0.8436, mean(all)=0.7942 [+0.0008]
  TOTAL IMPROVEMENT (median top-10): +0.0574

================================================================================
Subject: OASIS-TRT-20-6
================================================================================
  Step 0: Generating predictions with V2 model (15 random views)...
  Mesh: 152023 vertices, 304042 faces
  Generating 15 random views...
  Generating predictions for 15 views (continuous camera pose)...
    ✓ Random_0 (pose=(-0.26892727302924113, 0.04098938712581601, 1.701074534349864)): shape (37, 800, 800)
      Valid pixels: 41671/640000 (6.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=303927, num_faces=304042
      Valid probs shape: (37, 41671)
    ✓ Random_1 (pose=(1.979068538070048, 1.6016426169631153, -2.2472924321536283)): shape (37, 800, 800)
      Valid pixels: 74901/640000 (11.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=21, max=304024, num_faces=304042
      Valid probs shape: (37, 74901)
    ✓ Random_2 (pose=(-0.8695050796798762, 0.40177626103796626, 3.0767322118064815)): shape (37, 800, 800)
      Valid pixels: 78443/640000 (12.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=304040, num_faces=304042
      Valid probs shape: (37, 78443)
    ✓ Random_3 (pose=(-2.679241279241115, -2.2636098628552266, -0.2976420414864158)): shape (37, 800, 800)
      Valid pixels: 65584/640000 (10.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=303979, num_faces=304042
      Valid probs shape: (37, 65584)
    ✓ Random_4 (pose=(-1.6120903075397919, -0.19098084641308377, -0.21886571442114455)): shape (37, 800, 800)
      Valid pixels: 91485/640000 (14.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=42, max=304041, num_faces=304042
      Valid probs shape: (37, 91485)
    ✓ Random_5 (pose=(2.147510382451486, 1.0058207866327136, 0.5547725422900314)): shape (37, 800, 800)
      Valid pixels: 90448/640000 (14.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=304040, num_faces=304042
      Valid probs shape: (37, 90448)
    ✓ Random_6 (pose=(-1.4547161516674842, -1.1131291235202094, 0.04666514697161617)): shape (37, 800, 800)
      Valid pixels: 83812/640000 (13.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=19, max=304024, num_faces=304042
      Valid probs shape: (37, 83812)
    ✓ Random_7 (pose=(2.8422280836303964, 1.6959252547096524, 1.8304854184231028)): shape (37, 800, 800)
      Valid pixels: 76649/640000 (12.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=304040, num_faces=304042
      Valid probs shape: (37, 76649)
    ✓ Random_8 (pose=(1.0539580748524928, -2.5707388886879263, 1.7881334178082104)): shape (37, 800, 800)
      Valid pixels: 56422/640000 (8.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2822, max=304011, num_faces=304042
      Valid probs shape: (37, 56422)
    ✓ Random_9 (pose=(0.7062978650505003, 1.6015995290357372, -1.5260760722648115)): shape (37, 800, 800)
      Valid pixels: 94966/640000 (14.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=304040, num_faces=304042
      Valid probs shape: (37, 94966)
    ✓ Random_10 (pose=(-0.8257731203756173, 1.83705101142524, 1.4292133637128615)): shape (37, 800, 800)
      Valid pixels: 71026/640000 (11.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=92, max=304029, num_faces=304042
      Valid probs shape: (37, 71026)
    ✓ Random_11 (pose=(-2.333181433583091, -0.6662287450342457, -2.74930178197088)): shape (37, 800, 800)
      Valid pixels: 84386/640000 (13.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=24, max=304040, num_faces=304042
      Valid probs shape: (37, 84386)
    ✓ Random_12 (pose=(1.6102219231828672, 2.202048273771685, 1.0500578556211115)): shape (37, 800, 800)
      Valid pixels: 66455/640000 (10.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=304028, num_faces=304042
      Valid probs shape: (37, 66455)
    ✓ Random_13 (pose=(2.8438056143029478, 0.1065063250854692, 0.060802406503164264)): shape (37, 800, 800)
      Valid pixels: 49205/640000 (7.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3964, max=304040, num_faces=304042
      Valid probs shape: (37, 49205)
    ✓ Random_14 (pose=(-1.452437619126395, 1.6061440330829422, -2.0331845482068003)): shape (37, 800, 800)
      Valid pixels: 67049/640000 (10.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=304028, num_faces=304042
      Valid probs shape: (37, 67049)
    P stats: min=0.0000, max=1.0000, mean=0.0232
    Non-zero vertices: 130496/152023
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 21527  1280  1405  3847     0  2090  1213  4828  6015]
  Ground Truth Stats:
    Labels shape: (152023,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-6/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7359
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8182
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8185

  RESULTS:
  RAW:         median(top-10)=0.8445, mean(top-10)=0.8563, median(all)=0.8005, mean(all)=0.7359
  + SMOOTHING: median(top-10)=0.9107, mean(top-10)=0.9084, median(all)=0.8578, mean(all)=0.8182 [+0.0662]
  + MRF:       median(top-10)=0.9109, mean(top-10)=0.9088, median(all)=0.8595, mean(all)=0.8185 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0664

================================================================================
Subject: OASIS-TRT-20-7
================================================================================
  Step 0: Generating predictions with V2 model (15 random views)...
  Mesh: 142612 vertices, 285220 faces
  Generating 15 random views...
  Generating predictions for 15 views (continuous camera pose)...
    ✓ Random_0 (pose=(1.075507655835887, -0.848835052353921, -1.1279176750717501)): shape (37, 800, 800)
      Valid pixels: 64988/640000 (10.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=10, max=285162, num_faces=285220
      Valid probs shape: (37, 64988)
    ✓ Random_1 (pose=(0.275665905559368, -0.4576241223139741, 2.5511678777653204)): shape (37, 800, 800)
      Valid pixels: 60717/640000 (9.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=285109, num_faces=285220
      Valid probs shape: (37, 60717)
    ✓ Random_2 (pose=(-1.3051743285541784, -1.4904220625963243, 2.357919790402736)): shape (37, 800, 800)
      Valid pixels: 111098/640000 (17.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=12, max=285133, num_faces=285220
      Valid probs shape: (37, 111098)
    ✓ Random_3 (pose=(1.5882917443912374, 2.248148781759113, -1.3955307547798685)): shape (37, 800, 800)
      Valid pixels: 77673/640000 (12.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=75, max=285166, num_faces=285220
      Valid probs shape: (37, 77673)
    ✓ Random_4 (pose=(1.2170938320958369, -0.10431315233126481, -0.7534927161163849)): shape (37, 800, 800)
      Valid pixels: 96031/640000 (15.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=285139, num_faces=285220
      Valid probs shape: (37, 96031)
    ✓ Random_5 (pose=(1.426149987962991, 1.0711691505168561, -1.9437130825725228)): shape (37, 800, 800)
      Valid pixels: 69979/640000 (10.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=34, max=285162, num_faces=285220
      Valid probs shape: (37, 69979)
    ✓ Random_6 (pose=(-0.6600430569921985, 2.964264067622575, 2.6063249325711055)): shape (37, 800, 800)
      Valid pixels: 85005/640000 (13.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=453, max=285217, num_faces=285220
      Valid probs shape: (37, 85005)
    ✓ Random_7 (pose=(1.047563063421233, -1.9725604857238401, -2.650014861247948)): shape (37, 800, 800)
      Valid pixels: 100431/640000 (15.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=34, max=285214, num_faces=285220
      Valid probs shape: (37, 100431)
    ✓ Random_8 (pose=(-0.6316620608310366, -0.5704258337815098, 2.822422462702969)): shape (37, 800, 800)
      Valid pixels: 78712/640000 (12.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=284956, num_faces=285220
      Valid probs shape: (37, 78712)
    ✓ Random_9 (pose=(2.2869592191163344, 1.8974733952184666, -0.0781117269172884)): shape (37, 800, 800)
      Valid pixels: 102344/640000 (16.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=285162, num_faces=285220
      Valid probs shape: (37, 102344)
    ✓ Random_10 (pose=(0.6176141857898534, -1.980466444775764, -0.25262014700565816)): shape (37, 800, 800)
      Valid pixels: 92806/640000 (14.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=97, max=285207, num_faces=285220
      Valid probs shape: (37, 92806)
    ✓ Random_11 (pose=(-2.0315788321819612, 2.299938121460202, 2.4870697923637293)): shape (37, 800, 800)
      Valid pixels: 105688/640000 (16.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=284961, num_faces=285220
      Valid probs shape: (37, 105688)
    ✓ Random_12 (pose=(-0.9681993121982777, 2.9959067287448145, 1.032072784956819)): shape (37, 800, 800)
      Valid pixels: 76100/640000 (11.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1588, max=285215, num_faces=285220
      Valid probs shape: (37, 76100)
    ✓ Random_13 (pose=(0.6750183382509247, 2.2835315621379326, -0.8318158779734217)): shape (37, 800, 800)
      Valid pixels: 101066/640000 (15.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=94, max=284967, num_faces=285220
      Valid probs shape: (37, 101066)
    ✓ Random_14 (pose=(-0.2103740865501016, 1.1260430793290723, 3.0338303724997298)): shape (37, 800, 800)
      Valid pixels: 64808/640000 (10.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=10, max=285166, num_faces=285220
      Valid probs shape: (37, 64808)
    P stats: min=0.0000, max=1.0000, mean=0.0208
    Non-zero vertices: 109520/142612
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 33092   816   936  2202     0  1759  1069  4784  5014]
  Ground Truth Stats:
    Labels shape: (142612,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-7/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6828
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7916
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7916

  RESULTS:
  RAW:         median(top-10)=0.8424, mean(top-10)=0.8505, median(all)=0.7117, mean(all)=0.6828
  + SMOOTHING: median(top-10)=0.9027, mean(top-10)=0.9097, median(all)=0.8536, mean(all)=0.7916 [+0.0604]
  + MRF:       median(top-10)=0.9031, mean(top-10)=0.9100, median(all)=0.8537, mean(all)=0.7916 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0607

================================================================================
Subject: OASIS-TRT-20-8
================================================================================
  Step 0: Generating predictions with V2 model (15 random views)...
  Mesh: 139571 vertices, 279138 faces
  Generating 15 random views...
  Generating predictions for 15 views (continuous camera pose)...
    ✓ Random_0 (pose=(2.912848473742123, 2.8008970183880724, -1.119856091529353)): shape (37, 800, 800)
      Valid pixels: 56412/640000 (8.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=0, max=279070, num_faces=279138
      Valid probs shape: (37, 56412)
    ✓ Random_1 (pose=(2.02474202903619, -0.01712387527054915, 2.526225288444298)): shape (37, 800, 800)
      Valid pixels: 106892/640000 (16.7%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=2528, max=279137, num_faces=279138
      Valid probs shape: (37, 106892)
    ✓ Random_2 (pose=(3.0733347719757313, 2.717238528547992, 1.6723326968143812)): shape (37, 800, 800)
      Valid pixels: 73978/640000 (11.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=279068, num_faces=279138
      Valid probs shape: (37, 73978)
    ✓ Random_3 (pose=(-0.9972217645831205, -1.501743566590518, -1.3250662224001728)): shape (37, 800, 800)
      Valid pixels: 108162/640000 (16.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8, max=279134, num_faces=279138
      Valid probs shape: (37, 108162)
    ✓ Random_4 (pose=(0.5647188935034606, 0.8469038264326993, -0.29108343046192875)): shape (37, 800, 800)
      Valid pixels: 90274/640000 (14.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=279070, num_faces=279138
      Valid probs shape: (37, 90274)
    ✓ Random_5 (pose=(-1.0615296836451336, 0.9575838984674903, -1.510515984837802)): shape (37, 800, 800)
      Valid pixels: 76855/640000 (12.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=279066, num_faces=279138
      Valid probs shape: (37, 76855)
    ✓ Random_6 (pose=(1.9962465363999593, 0.520895171688982, -1.2330958160031136)): shape (37, 800, 800)
      Valid pixels: 75488/640000 (11.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=881, max=279072, num_faces=279138
      Valid probs shape: (37, 75488)
    ✓ Random_7 (pose=(-1.5821973951083048, 0.4643365624841702, 1.4081643791096328)): shape (37, 800, 800)
      Valid pixels: 73945/640000 (11.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=274, max=279072, num_faces=279138
      Valid probs shape: (37, 73945)
    ✓ Random_8 (pose=(-1.7546044712759596, 1.9830407981344873, 0.06790719308499416)): shape (37, 800, 800)
      Valid pixels: 101421/640000 (15.8%)
      Probs stats: min=0.0000, max=0.9995, mean=0.0270
      Face IDs: min=8, max=279137, num_faces=279138
      Valid probs shape: (37, 101421)
    ✓ Random_9 (pose=(-0.5329856581773758, -0.5543993409006145, 0.753326756566008)): shape (37, 800, 800)
      Valid pixels: 59048/640000 (9.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=279072, num_faces=279138
      Valid probs shape: (37, 59048)
    ✓ Random_10 (pose=(2.286666885838577, 2.9770836403613785, 2.040346075150036)): shape (37, 800, 800)
      Valid pixels: 74437/640000 (11.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=279127, num_faces=279138
      Valid probs shape: (37, 74437)
    ✓ Random_11 (pose=(-0.021354788735806096, -2.1768825587324336, 2.714603236721291)): shape (37, 800, 800)
      Valid pixels: 68313/640000 (10.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=95, max=279137, num_faces=279138
      Valid probs shape: (37, 68313)
    ✓ Random_12 (pose=(-1.6922075236915288, 0.1088583514129211, 2.2287813423404312)): shape (37, 800, 800)
      Valid pixels: 105838/640000 (16.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=147, max=279068, num_faces=279138
      Valid probs shape: (37, 105838)
    ✓ Random_13 (pose=(0.18907719796712819, -2.048292524792945, -2.0058693654336235)): shape (37, 800, 800)
      Valid pixels: 108928/640000 (17.0%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=1344, max=279137, num_faces=279138
      Valid probs shape: (37, 108928)
    ✓ Random_14 (pose=(-2.4199062483653178, 1.1987413980997923, 2.255410172301823)): shape (37, 800, 800)
      Valid pixels: 116447/640000 (18.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=45, max=279070, num_faces=279138
      Valid probs shape: (37, 116447)
    P stats: min=0.0000, max=0.9998, mean=0.0237
    Non-zero vertices: 122179/139571
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 17392   907  1213  2975     0  2502   791  4902  5683]
  Ground Truth Stats:
    Labels shape: (139571,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-8/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
    MRF iteration 5/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7494
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8186
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8187

  RESULTS:
  RAW:         median(top-10)=0.8663, mean(top-10)=0.8770, median(all)=0.8108, mean(all)=0.7494
  + SMOOTHING: median(top-10)=0.9185, mean(top-10)=0.9237, median(all)=0.8658, mean(all)=0.8186 [+0.0522]
  + MRF:       median(top-10)=0.9187, mean(top-10)=0.9240, median(all)=0.8652, mean(all)=0.8187 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0524

================================================================================
Subject: OASIS-TRT-20-9
================================================================================
  Step 0: Generating predictions with V2 model (15 random views)...
  Mesh: 134960 vertices, 269916 faces
  Generating 15 random views...
  Generating predictions for 15 views (continuous camera pose)...
    ✓ Random_0 (pose=(-2.6113901385725837, -2.36704796557921, -1.2190831244810103)): shape (37, 800, 800)
      Valid pixels: 58491/640000 (9.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=269800, num_faces=269916
      Valid probs shape: (37, 58491)
    ✓ Random_1 (pose=(1.051235478822945, 0.5311065743234868, 0.17413632977596727)): shape (37, 800, 800)
      Valid pixels: 73852/640000 (11.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=269808, num_faces=269916
      Valid probs shape: (37, 73852)
    ✓ Random_2 (pose=(0.6001013092472549, -1.2923111603838924, 1.0461711901698312)): shape (37, 800, 800)
      Valid pixels: 89033/640000 (13.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=8, max=269806, num_faces=269916
      Valid probs shape: (37, 89033)
    ✓ Random_3 (pose=(-2.910308034456102, 0.2474791821493456, -1.607523796688535)): shape (37, 800, 800)
      Valid pixels: 55691/640000 (8.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=53501, max=269914, num_faces=269916
      Valid probs shape: (37, 55691)
    ✓ Random_4 (pose=(-1.3059086539331763, 0.7076543352498614, -2.2252780622514425)): shape (37, 800, 800)
      Valid pixels: 69982/640000 (10.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=269884, num_faces=269916
      Valid probs shape: (37, 69982)
    ✓ Random_5 (pose=(2.828293340675244, -1.7555570995289342, 2.439744341312676)): shape (37, 800, 800)
      Valid pixels: 70646/640000 (11.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=15, max=269915, num_faces=269916
      Valid probs shape: (37, 70646)
    ✓ Random_6 (pose=(0.270626309334987, 2.758882296976366, 0.8477184703642582)): shape (37, 800, 800)
      Valid pixels: 52003/640000 (8.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=42429, max=269911, num_faces=269916
      Valid probs shape: (37, 52003)
    ✓ Random_7 (pose=(3.0029893202315243, -1.0675987861052048, -1.0764149604146196)): shape (37, 800, 800)
      Valid pixels: 74734/640000 (11.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=245, max=269911, num_faces=269916
      Valid probs shape: (37, 74734)
    ✓ Random_8 (pose=(-0.27791068815881026, 2.489319454810171, 1.025730722457923)): shape (37, 800, 800)
      Valid pixels: 74818/640000 (11.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=12530, max=269914, num_faces=269916
      Valid probs shape: (37, 74818)
    ✓ Random_9 (pose=(1.671991647267748, 0.656432663110714, 2.6111665998411633)): shape (37, 800, 800)
      Valid pixels: 91844/640000 (14.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=13, max=269910, num_faces=269916
      Valid probs shape: (37, 91844)
    ✓ Random_10 (pose=(-0.39493995656664493, -0.05331261712817259, 2.6165321516456546)): shape (37, 800, 800)
      Valid pixels: 55245/640000 (8.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=269636, num_faces=269916
      Valid probs shape: (37, 55245)
    ✓ Random_11 (pose=(-2.183029516222408, 2.983342238332332, -1.1214997488588776)): shape (37, 800, 800)
      Valid pixels: 72330/640000 (11.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=269878, num_faces=269916
      Valid probs shape: (37, 72330)
    ✓ Random_12 (pose=(1.0092536067222744, -0.8799123161731104, 0.08005542792610987)): shape (37, 800, 800)
      Valid pixels: 92579/640000 (14.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=269911, num_faces=269916
      Valid probs shape: (37, 92579)
    ✓ Random_13 (pose=(2.767844840225866, -2.5809946286126015, -2.5572797216101413)): shape (37, 800, 800)
      Valid pixels: 49526/640000 (7.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=269805, num_faces=269916
      Valid probs shape: (37, 49526)
    ✓ Random_14 (pose=(1.4983808762618755, -2.4322031165029685, 0.5687649421290342)): shape (37, 800, 800)
      Valid pixels: 76428/640000 (11.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=269808, num_faces=269916
      Valid probs shape: (37, 76428)
    P stats: min=0.0000, max=1.0000, mean=0.0232
    Non-zero vertices: 115939/134960
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 19021   675  1008  2809     0  1843  1131  4363  5383]
  Ground Truth Stats:
    Labels shape: (134960,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-9/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7376
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8200
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8201

  RESULTS:
  RAW:         median(top-10)=0.8822, mean(top-10)=0.8859, median(all)=0.7918, mean(all)=0.7376
  + SMOOTHING: median(top-10)=0.9252, mean(top-10)=0.9275, median(all)=0.8599, mean(all)=0.8200 [+0.0430]
  + MRF:       median(top-10)=0.9253, mean(top-10)=0.9276, median(all)=0.8601, mean(all)=0.8201 [+0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0431

================================================================================
Subject: Twins-2-1
================================================================================
  Step 0: Generating predictions with V2 model (15 random views)...
  Mesh: 145069 vertices, 290134 faces
  Generating 15 random views...
  Generating predictions for 15 views (continuous camera pose)...
    ✓ Random_0 (pose=(-1.7950440175447595, -1.7012552289083867, 0.33557048438420223)): shape (37, 800, 800)
      Valid pixels: 109882/640000 (17.2%)
      Probs stats: min=0.0000, max=0.9994, mean=0.0270
      Face IDs: min=4, max=290132, num_faces=290134
      Valid probs shape: (37, 109882)
    ✓ Random_1 (pose=(-2.4551586162630272, 1.6661762218623961, -1.3559161367618917)): shape (37, 800, 800)
      Valid pixels: 119660/640000 (18.7%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=9, max=290027, num_faces=290134
      Valid probs shape: (37, 119660)
    ✓ Random_2 (pose=(-1.9543032348625264, 2.8819417564657135, 1.6493643790063501)): shape (37, 800, 800)
      Valid pixels: 71993/640000 (11.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=16, max=290133, num_faces=290134
      Valid probs shape: (37, 71993)
    ✓ Random_3 (pose=(-2.139637226788489, -0.9485058210568251, -1.8594665686792151)): shape (37, 800, 800)
      Valid pixels: 89567/640000 (14.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=257, max=290133, num_faces=290134
      Valid probs shape: (37, 89567)
    ✓ Random_4 (pose=(1.1698053804228294, 2.408689562596126, -3.0011756462626047)): shape (37, 800, 800)
      Valid pixels: 100170/640000 (15.7%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=2, max=290133, num_faces=290134
      Valid probs shape: (37, 100170)
    ✓ Random_5 (pose=(2.4244513868121063, -1.477035969849944, 0.286788241797431)): shape (37, 800, 800)
      Valid pixels: 81164/640000 (12.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=2, max=290133, num_faces=290134
      Valid probs shape: (37, 81164)
    ✓ Random_6 (pose=(0.30605043736213977, -1.7301396871942676, -1.7668679335643385)): shape (37, 800, 800)
      Valid pixels: 109523/640000 (17.1%)
      Probs stats: min=0.0000, max=0.9995, mean=0.0270
      Face IDs: min=1, max=290132, num_faces=290134
      Valid probs shape: (37, 109523)
    ✓ Random_7 (pose=(-1.8685660406367368, -3.031402325652268, -1.2888950934428598)): shape (37, 800, 800)
      Valid pixels: 86676/640000 (13.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=289391, num_faces=290134
      Valid probs shape: (37, 86676)
    ✓ Random_8 (pose=(0.32073919912313187, 1.9316265725049462, 0.6377154718564975)): shape (37, 800, 800)
      Valid pixels: 87081/640000 (13.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=3414, max=289393, num_faces=290134
      Valid probs shape: (37, 87081)
    ✓ Random_9 (pose=(-1.6004325760207978, 2.7824409581619065, -0.34130175201549084)): shape (37, 800, 800)
      Valid pixels: 119596/640000 (18.7%)
      Probs stats: min=0.0000, max=0.9994, mean=0.0270
      Face IDs: min=4, max=290131, num_faces=290134
      Valid probs shape: (37, 119596)
    ✓ Random_10 (pose=(-0.798068605081629, 0.9158653322700774, -1.1870381588261611)): shape (37, 800, 800)
      Valid pixels: 78432/640000 (12.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=290133, num_faces=290134
      Valid probs shape: (37, 78432)
    ✓ Random_11 (pose=(0.5493958954543605, -1.2730662211362889, -1.386816754680434)): shape (37, 800, 800)
      Valid pixels: 85887/640000 (13.4%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=22, max=290132, num_faces=290134
      Valid probs shape: (37, 85887)
    ✓ Random_12 (pose=(2.5872372822078544, -1.39294923524544, -2.916507320158088)): shape (37, 800, 800)
      Valid pixels: 82275/640000 (12.9%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=855, max=290133, num_faces=290134
      Valid probs shape: (37, 82275)
    ✓ Random_13 (pose=(0.3756288088754629, 1.585950714583122, -1.6891697053359476)): shape (37, 800, 800)
      Valid pixels: 124712/640000 (19.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=290133, num_faces=290134
      Valid probs shape: (37, 124712)
    ✓ Random_14 (pose=(1.4637177318675043, -0.25078091800833535, 1.5265606355184875)): shape (37, 800, 800)
      Valid pixels: 72246/640000 (11.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=290077, num_faces=290134
      Valid probs shape: (37, 72246)
    P stats: min=0.0000, max=0.9997, mean=0.0228
    Non-zero vertices: 122643/145069
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 22426  1026   939  3895     0  1663   764  4823  5679]
  Ground Truth Stats:
    Labels shape: (145069,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/Twins-2-1/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7337
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8065
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8062

  RESULTS:
  RAW:         median(top-10)=0.8872, mean(top-10)=0.8747, median(all)=0.7908, mean(all)=0.7337
  + SMOOTHING: median(top-10)=0.9291, mean(top-10)=0.9222, median(all)=0.8452, mean(all)=0.8065 [+0.0418]
  + MRF:       median(top-10)=0.9300, mean(top-10)=0.9227, median(all)=0.8454, mean(all)=0.8062 [+0.0010]
  TOTAL IMPROVEMENT (median top-10): +0.0428

================================================================================
Subject: Twins-2-2
================================================================================
  Step 0: Generating predictions with V2 model (15 random views)...
  Mesh: 149751 vertices, 299498 faces
  Generating 15 random views...
  Generating predictions for 15 views (continuous camera pose)...
    ✓ Random_0 (pose=(-2.265749339688864, -1.3220432254708716, 2.9607637335103654)): shape (37, 800, 800)
      Valid pixels: 128915/640000 (20.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=299497, num_faces=299498
      Valid probs shape: (37, 128915)
    ✓ Random_1 (pose=(-1.2543457541353848, 0.3678842776622213, -2.9394041906228305)): shape (37, 800, 800)
      Valid pixels: 129913/640000 (20.3%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=2, max=299497, num_faces=299498
      Valid probs shape: (37, 129913)
    ✓ Random_2 (pose=(-2.5152785109013136, 2.0038085219941504, -0.10349280501248348)): shape (37, 800, 800)
      Valid pixels: 95206/640000 (14.9%)
      Probs stats: min=0.0000, max=0.9995, mean=0.0270
      Face IDs: min=4, max=299446, num_faces=299498
      Valid probs shape: (37, 95206)
    ✓ Random_3 (pose=(-2.084679383636116, 0.15643775397195636, 1.4409958690125926)): shape (37, 800, 800)
      Valid pixels: 91450/640000 (14.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1252, max=299494, num_faces=299498
      Valid probs shape: (37, 91450)
    ✓ Random_4 (pose=(-1.3838995831126633, -2.9133820341714234, 0.833270062238721)): shape (37, 800, 800)
      Valid pixels: 100891/640000 (15.8%)
      Probs stats: min=0.0000, max=0.9994, mean=0.0270
      Face IDs: min=101, max=299459, num_faces=299498
      Valid probs shape: (37, 100891)
    ✓ Random_5 (pose=(1.9640268645167946, -1.4488343271405704, 1.0712528397945622)): shape (37, 800, 800)
      Valid pixels: 80394/640000 (12.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=299462, num_faces=299498
      Valid probs shape: (37, 80394)
    ✓ Random_6 (pose=(-2.604889343522835, 0.4686735043914556, -2.3849527455040347)): shape (37, 800, 800)
      Valid pixels: 61964/640000 (9.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=338, max=299462, num_faces=299498
      Valid probs shape: (37, 61964)
    ✓ Random_7 (pose=(0.15240071129757604, -0.26372649758274447, 2.1825730672537196)): shape (37, 800, 800)
      Valid pixels: 75770/640000 (11.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=298451, num_faces=299498
      Valid probs shape: (37, 75770)
    ✓ Random_8 (pose=(-1.0062567636853346, 1.0895485286848352, 1.3065224462610052)): shape (37, 800, 800)
      Valid pixels: 97214/640000 (15.2%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=2, max=299449, num_faces=299498
      Valid probs shape: (37, 97214)
    ✓ Random_9 (pose=(-1.6437688617002237, -1.188669599546832, -2.712358651996719)): shape (37, 800, 800)
      Valid pixels: 127967/640000 (20.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=8, max=299497, num_faces=299498
      Valid probs shape: (37, 127967)
    ✓ Random_10 (pose=(0.5281631851881525, -3.089058635257574, -1.7616480579806477)): shape (37, 800, 800)
      Valid pixels: 86697/640000 (13.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1167, max=299462, num_faces=299498
      Valid probs shape: (37, 86697)
    ✓ Random_11 (pose=(1.939229109689486, 2.6776074721648007, 0.23803697311153327)): shape (37, 800, 800)
      Valid pixels: 128869/640000 (20.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=2, max=299497, num_faces=299498
      Valid probs shape: (37, 128869)
    ✓ Random_12 (pose=(0.8145566193412592, -0.8173576104098639, -0.3841154310124115)): shape (37, 800, 800)
      Valid pixels: 94129/640000 (14.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=299497, num_faces=299498
      Valid probs shape: (37, 94129)
    ✓ Random_13 (pose=(1.5099956747391072, 1.028128675584111, -0.08433264950669095)): shape (37, 800, 800)
      Valid pixels: 140976/640000 (22.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=0, max=299497, num_faces=299498
      Valid probs shape: (37, 140976)
    ✓ Random_14 (pose=(1.295612906869029, 1.835646898512124, -0.18486182129506812)): shape (37, 800, 800)
      Valid pixels: 139709/640000 (21.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=299497, num_faces=299498
      Valid probs shape: (37, 139709)
    P stats: min=0.0000, max=0.9998, mean=0.0202
    Non-zero vertices: 112039/149751
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 35]
    Pred label counts: [    0 37712   527   976  2174     0  2078   837  4800  5217]
  Ground Truth Stats:
    Labels shape: (149751,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/Twins-2-2/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
    MRF iteration 5/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6259
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7081
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7083

  RESULTS:
  RAW:         median(top-10)=0.8493, mean(top-10)=0.8343, median(all)=0.6603, mean(all)=0.6259
  + SMOOTHING: median(top-10)=0.8981, mean(top-10)=0.8967, median(all)=0.7525, mean(all)=0.7081 [+0.0488]
  + MRF:       median(top-10)=0.8985, mean(top-10)=0.8974, median(all)=0.7515, mean(all)=0.7083 [+0.0004]
  TOTAL IMPROVEMENT (median top-10): +0.0492

================================================================================
AGGREGATE RESULTS ACROSS ALL TEST SUBJECTS
================================================================================
Number of subjects: 101

RAW PREDICTIONS:
  Median(top-10):  0.8613 ± 0.0165  (min: 0.8124, max: 0.8933)
  Mean(top-10):    0.8657 ± 0.0151  (min: 0.8264, max: 0.8948)
  Median(all):     0.7742 ± 0.0312  (min: 0.6503, max: 0.8250)
  Mean(all):       0.7155 ± 0.0277  (min: 0.6259, max: 0.7619)

+ SMOOTHING (α=0.75, 20 iter):
  Median(top-10):  0.9118 ± 0.0107  (min: 0.8815, max: 0.9338)
  Mean(top-10):    0.9131 ± 0.0099  (min: 0.8826, max: 0.9311)
  Median(all):     0.8465 ± 0.0234  (min: 0.7525, max: 0.8929)
  Mean(all):       0.7954 ± 0.0240  (min: 0.7081, max: 0.8409)
  Improvement:     median(top-10) +0.0504, mean(all) +0.0800

+ MRF (β=0.1, 5 iter):
  Median(top-10):  0.9121 ± 0.0107  (min: 0.8818, max: 0.9344)
  Mean(top-10):    0.9134 ± 0.0098  (min: 0.8830, max: 0.9314)
  Median(all):     0.8469 ± 0.0235  (min: 0.7515, max: 0.8929)
  Mean(all):       0.7960 ± 0.0237  (min: 0.7083, max: 0.8413)
  Improvement:     median(top-10) +0.0003, mean(all) +0.0005

TOTAL IMPROVEMENT (RAW → MRF):
  Median(top-10):  +0.0507
  Mean(top-10):    +0.0477
  Median(all):     +0.0726
  Mean(all):       +0.0805
================================================================================
