nohup: ignoring input
[GPU] PyTorch3D loaded - GPU raycasting AVAILABLE (FAST MODE: bin_size=None)
[GPU] PyTorch3D loaded - GPU raycasting AVAILABLE (will be enabled via --raycasting arg)
Using 30 random views for testing
Auto-detected latest checkpoint: last.ckpt

Loading model from: /autofs/space/ballarat_004/users/np341/PRIR_Code/Training/White/prir_x_y_z_conditional_1_unet/models/xyz_random_views_7794326/last.ckpt
✓ Model loaded (using TRAIN mode due to corrupted BN running stats)

================================================================================
Testing VIEW-CONDITIONED model V2 (Arbitrary Views) with PyTorch3D pipeline
Checkpoint: /autofs/space/ballarat_004/users/np341/PRIR_Code/Training/White/prir_x_y_z_conditional_1_unet/models/xyz_random_views_7794326/last.ckpt
Test data: /autofs/space/ballarat_004/users/np341/mindboggle2
Using 30 random views per subject
1. Generate predictions using V2 model (continuous camera pose)
2. Iterative smoothing (α=0.75, 20 iter)
3. MRF with ICM (β=0.1)
================================================================================

Found 101 test subjects

================================================================================
Subject: Afterthought-1
================================================================================
  Step 0: Generating predictions with V2 model (30 random views)...
  Mesh: 130921 vertices, 261838 faces
  Generating 30 random views...
  Generating predictions for 30 views (continuous camera pose)...
    ✓ Random_0 (pose=(2.6117296211566696, 1.086719597980835, -2.5089926430535225)): shape (37, 800, 800)
      Valid pixels: 97021/640000 (15.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=179, max=261832, num_faces=261838
      Valid probs shape: (37, 97021)
    ✓ Random_1 (pose=(-0.7498697959368892, 1.830350258217437, -2.7980289288107936)): shape (37, 800, 800)
      Valid pixels: 108078/640000 (16.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=18, max=261837, num_faces=261838
      Valid probs shape: (37, 108078)
    ✓ Random_2 (pose=(2.0741644073344014, 1.953773849426165, -2.6985438030815683)): shape (37, 800, 800)
      Valid pixels: 94324/640000 (14.7%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=6, max=261782, num_faces=261838
      Valid probs shape: (37, 94324)
    ✓ Random_3 (pose=(-1.7136122539663763, 0.9295551673884868, -0.7571519670479052)): shape (37, 800, 800)
      Valid pixels: 102000/640000 (15.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=10, max=261832, num_faces=261838
      Valid probs shape: (37, 102000)
    ✓ Random_4 (pose=(2.7501111947909322, 0.2918861236822079, -0.26827895274385316)): shape (37, 800, 800)
      Valid pixels: 64100/640000 (10.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1656, max=261837, num_faces=261838
      Valid probs shape: (37, 64100)
    ✓ Random_5 (pose=(-1.604982515052055, -1.452146030453609, 0.42822402353103195)): shape (37, 800, 800)
      Valid pixels: 84616/640000 (13.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=261837, num_faces=261838
      Valid probs shape: (37, 84616)
    ✓ Random_6 (pose=(0.9017945744494522, 0.21063713823837826, 0.11627891264492218)): shape (37, 800, 800)
      Valid pixels: 80623/640000 (12.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=261837, num_faces=261838
      Valid probs shape: (37, 80623)
    ✓ Random_7 (pose=(0.20076274089813895, 0.18876671554647162, 2.018342275530653)): shape (37, 800, 800)
      Valid pixels: 62542/640000 (9.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=261202, num_faces=261838
      Valid probs shape: (37, 62542)
    ✓ Random_8 (pose=(-0.8644893037106112, -0.8220782024770354, -2.5078908023691824)): shape (37, 800, 800)
      Valid pixels: 66889/640000 (10.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=261837, num_faces=261838
      Valid probs shape: (37, 66889)
    ✓ Random_9 (pose=(1.4631513520464106, 0.7660930637926908, 1.9651286315084784)): shape (37, 800, 800)
      Valid pixels: 91610/640000 (14.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=3, max=261777, num_faces=261838
      Valid probs shape: (37, 91610)
    ✓ Random_10 (pose=(-2.885252716692113, 1.4660117392817478, -1.9586740247583871)): shape (37, 800, 800)
      Valid pixels: 101877/640000 (15.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=9, max=261832, num_faces=261838
      Valid probs shape: (37, 101877)
    ✓ Random_11 (pose=(-1.648609461548333, -0.9519826041346588, -1.8111606639040105)): shape (37, 800, 800)
      Valid pixels: 69411/640000 (10.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=19, max=261834, num_faces=261838
      Valid probs shape: (37, 69411)
    ✓ Random_12 (pose=(0.8375989123045349, -0.7572907722046001, -2.844484446152463)): shape (37, 800, 800)
      Valid pixels: 93400/640000 (14.6%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=0, max=261742, num_faces=261838
      Valid probs shape: (37, 93400)
    ✓ Random_13 (pose=(-0.2877485721593249, -2.1010525443208357, 1.265491187736325)): shape (37, 800, 800)
      Valid pixels: 99216/640000 (15.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=541, max=261837, num_faces=261838
      Valid probs shape: (37, 99216)
    ✓ Random_14 (pose=(2.2741597837984635, -0.10819795243633124, -1.0575351226417)): shape (37, 800, 800)
      Valid pixels: 83963/640000 (13.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1585, max=261837, num_faces=261838
      Valid probs shape: (37, 83963)
    ✓ Random_15 (pose=(2.585509927092043, 2.193141675737662, 2.1346520200394252)): shape (37, 800, 800)
      Valid pixels: 65774/640000 (10.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=261837, num_faces=261838
      Valid probs shape: (37, 65774)
    ✓ Random_16 (pose=(0.1492821772137356, -1.2067352293925637, 0.180043007423504)): shape (37, 800, 800)
      Valid pixels: 80590/640000 (12.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=261820, num_faces=261838
      Valid probs shape: (37, 80590)
    ✓ Random_17 (pose=(0.38531930082891463, 0.05387014855931582, 1.7773111726112871)): shape (37, 800, 800)
      Valid pixels: 61402/640000 (9.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=260584, num_faces=261838
      Valid probs shape: (37, 61402)
    ✓ Random_18 (pose=(-0.10009544163200079, 2.357156207585229, -1.4717201193922695)): shape (37, 800, 800)
      Valid pixels: 80145/640000 (12.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=931, max=261837, num_faces=261838
      Valid probs shape: (37, 80145)
    ✓ Random_19 (pose=(-0.8857685324134739, 1.4734684572457581, -2.113820166924718)): shape (37, 800, 800)
      Valid pixels: 91522/640000 (14.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=261837, num_faces=261838
      Valid probs shape: (37, 91522)
    ✓ Random_20 (pose=(1.444610373009298, -2.0943447029583226, -3.015290388302777)): shape (37, 800, 800)
      Valid pixels: 94927/640000 (14.8%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=8, max=261835, num_faces=261838
      Valid probs shape: (37, 94927)
    ✓ Random_21 (pose=(0.3041559078841014, 1.3467326004767965, -1.4462018586725807)): shape (37, 800, 800)
      Valid pixels: 103202/640000 (16.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=261837, num_faces=261838
      Valid probs shape: (37, 103202)
    ✓ Random_22 (pose=(0.17569312993582153, -2.9511347977498246, -0.14107133114514525)): shape (37, 800, 800)
      Valid pixels: 52563/640000 (8.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=694, max=261837, num_faces=261838
      Valid probs shape: (37, 52563)
    ✓ Random_23 (pose=(1.294928077115106, -0.18782124907368214, 0.17830320857002802)): shape (37, 800, 800)
      Valid pixels: 95432/640000 (14.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7, max=261837, num_faces=261838
      Valid probs shape: (37, 95432)
    ✓ Random_24 (pose=(-1.9542430622509868, -0.9444818914437039, -2.4065226027329816)): shape (37, 800, 800)
      Valid pixels: 89608/640000 (14.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=261837, num_faces=261838
      Valid probs shape: (37, 89608)
    ✓ Random_25 (pose=(-0.4119679658822166, -1.0690840691080563, -2.7871980143849)): shape (37, 800, 800)
      Valid pixels: 65052/640000 (10.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=260583, num_faces=261838
      Valid probs shape: (37, 65052)
    ✓ Random_26 (pose=(-1.7204638133701975, -2.9282585374412964, 1.4625016301545681)): shape (37, 800, 800)
      Valid pixels: 69921/640000 (10.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=261836, num_faces=261838
      Valid probs shape: (37, 69921)
    ✓ Random_27 (pose=(-0.5480250288385853, 1.7642914095395517, -2.3360798484542475)): shape (37, 800, 800)
      Valid pixels: 106738/640000 (16.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=10, max=261837, num_faces=261838
      Valid probs shape: (37, 106738)
    ✓ Random_28 (pose=(2.8250459726841717, -2.5892479996802935, -2.0883350208066886)): shape (37, 800, 800)
      Valid pixels: 64321/640000 (10.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=261786, num_faces=261838
      Valid probs shape: (37, 64321)
    ✓ Random_29 (pose=(2.049525293366745, 0.7260468440468433, -2.3054154678869683)): shape (37, 800, 800)
      Valid pixels: 81809/640000 (12.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1130, max=261837, num_faces=261838
      Valid probs shape: (37, 81809)
    P stats: min=0.0000, max=0.9999, mean=0.0256
    Non-zero vertices: 124186/130921
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 6735 1268 1028 3640    0 2095 1184 4043 6350]
  Ground Truth Stats:
    Labels shape: (130921,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/Afterthought-1/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7857
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8389
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8393

  RESULTS:
  RAW:         median(top-10)=0.9140, mean(top-10)=0.9111, median(all)=0.8414, mean(all)=0.7857
  + SMOOTHING: median(top-10)=0.9283, mean(top-10)=0.9330, median(all)=0.8900, mean(all)=0.8389 [+0.0143]
  + MRF:       median(top-10)=0.9285, mean(top-10)=0.9332, median(all)=0.8904, mean(all)=0.8393 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0145

================================================================================
Subject: Colin27-1
================================================================================
  Step 0: Generating predictions with V2 model (30 random views)...
  Mesh: 182414 vertices, 364824 faces
  Generating 30 random views...
  Generating predictions for 30 views (continuous camera pose)...
    ✓ Random_0 (pose=(-2.2331681928958784, 2.6132084002967693, 2.2633910322476813)): shape (37, 800, 800)
      Valid pixels: 86939/640000 (13.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=364820, num_faces=364824
      Valid probs shape: (37, 86939)
    ✓ Random_1 (pose=(2.33321004179016, -0.07846169605406095, -0.7428460782834292)): shape (37, 800, 800)
      Valid pixels: 72516/640000 (11.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=635, max=364816, num_faces=364824
      Valid probs shape: (37, 72516)
    ✓ Random_2 (pose=(-2.315858059197223, 0.9831224058700441, -1.9682585199419855)): shape (37, 800, 800)
      Valid pixels: 65887/640000 (10.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=857, max=364175, num_faces=364824
      Valid probs shape: (37, 65887)
    ✓ Random_3 (pose=(-0.3301172335038087, 1.0826221666025013, 0.6807490596643455)): shape (37, 800, 800)
      Valid pixels: 86499/640000 (13.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=364505, num_faces=364824
      Valid probs shape: (37, 86499)
    ✓ Random_4 (pose=(0.13013837539527406, 3.1311378559512013, -2.4049849322629817)): shape (37, 800, 800)
      Valid pixels: 45674/640000 (7.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=76093, max=364823, num_faces=364824
      Valid probs shape: (37, 45674)
    ✓ Random_5 (pose=(-3.00360523264488, -0.29765080305745073, 2.8789181299115922)): shape (37, 800, 800)
      Valid pixels: 40561/640000 (6.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2815, max=364823, num_faces=364824
      Valid probs shape: (37, 40561)
    ✓ Random_6 (pose=(1.6597930503054066, 0.4581757071115029, -1.2451807049311325)): shape (37, 800, 800)
      Valid pixels: 72005/640000 (11.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=137, max=364821, num_faces=364824
      Valid probs shape: (37, 72005)
    ✓ Random_7 (pose=(1.650442719003565, -2.6780590812608214, -0.6511915918506701)): shape (37, 800, 800)
      Valid pixels: 97249/640000 (15.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=93, max=364820, num_faces=364824
      Valid probs shape: (37, 97249)
    ✓ Random_8 (pose=(-1.6679071178560143, 2.5320494035923113, 0.8348050114583128)): shape (37, 800, 800)
      Valid pixels: 67355/640000 (10.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=43, max=364823, num_faces=364824
      Valid probs shape: (37, 67355)
    ✓ Random_9 (pose=(0.6426089864424211, -0.9399230328230637, -0.5535210344276913)): shape (37, 800, 800)
      Valid pixels: 59981/640000 (9.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=364823, num_faces=364824
      Valid probs shape: (37, 59981)
    ✓ Random_10 (pose=(2.1126273305730106, -2.1242744343708244, 3.0184005721423723)): shape (37, 800, 800)
      Valid pixels: 77945/640000 (12.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=364539, num_faces=364824
      Valid probs shape: (37, 77945)
    ✓ Random_11 (pose=(2.726034067461468, -1.3105769607170212, -2.6280371324409906)): shape (37, 800, 800)
      Valid pixels: 61689/640000 (9.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=173, max=364823, num_faces=364824
      Valid probs shape: (37, 61689)
    ✓ Random_12 (pose=(-2.5938387249156847, -2.9148126211125613, 2.8915442268264213)): shape (37, 800, 800)
      Valid pixels: 65749/640000 (10.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=364820, num_faces=364824
      Valid probs shape: (37, 65749)
    ✓ Random_13 (pose=(-2.9308685184411356, 1.4574170348114102, -2.4258492817470794)): shape (37, 800, 800)
      Valid pixels: 80504/640000 (12.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=21, max=364170, num_faces=364824
      Valid probs shape: (37, 80504)
    ✓ Random_14 (pose=(2.5102536079270976, 2.475142024379667, -1.8818770494749215)): shape (37, 800, 800)
      Valid pixels: 66570/640000 (10.4%)
      Probs stats: min=0.0000, max=0.9994, mean=0.0270
      Face IDs: min=1, max=364544, num_faces=364824
      Valid probs shape: (37, 66570)
    ✓ Random_15 (pose=(0.5543334906095079, 1.813590998773802, 1.5670348819268165)): shape (37, 800, 800)
      Valid pixels: 92845/640000 (14.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=166, max=364173, num_faces=364824
      Valid probs shape: (37, 92845)
    ✓ Random_16 (pose=(0.010835532214348298, -1.5348499175189874, -2.085468434099814)): shape (37, 800, 800)
      Valid pixels: 93756/640000 (14.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=364683, num_faces=364824
      Valid probs shape: (37, 93756)
    ✓ Random_17 (pose=(-1.2265932163959552, -1.9074660930607046, -3.1244046510491716)): shape (37, 800, 800)
      Valid pixels: 86881/640000 (13.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=181, max=364820, num_faces=364824
      Valid probs shape: (37, 86881)
    ✓ Random_18 (pose=(-1.0306039686624655, 1.7083968708209607, -1.5227758012782935)): shape (37, 800, 800)
      Valid pixels: 62638/640000 (9.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=364820, num_faces=364824
      Valid probs shape: (37, 62638)
    ✓ Random_19 (pose=(-0.034872478317058864, 0.1326163540719132, 2.070238451483199)): shape (37, 800, 800)
      Valid pixels: 46840/640000 (7.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=364809, num_faces=364824
      Valid probs shape: (37, 46840)
    ✓ Random_20 (pose=(-2.9915094790676036, 1.8698828046022866, 1.4047548984993066)): shape (37, 800, 800)
      Valid pixels: 96889/640000 (15.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=364820, num_faces=364824
      Valid probs shape: (37, 96889)
    ✓ Random_21 (pose=(1.1592333402569315, -0.5000663797955771, 2.7245179340649583)): shape (37, 800, 800)
      Valid pixels: 87983/640000 (13.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=364503, num_faces=364824
      Valid probs shape: (37, 87983)
    ✓ Random_22 (pose=(2.6647382131503257, 1.8550661859662005, -2.271058855987475)): shape (37, 800, 800)
      Valid pixels: 89790/640000 (14.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=364501, num_faces=364824
      Valid probs shape: (37, 89790)
    ✓ Random_23 (pose=(2.6555711012231322, -2.7575546426567428, -1.5355354782683597)): shape (37, 800, 800)
      Valid pixels: 62075/640000 (9.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=364820, num_faces=364824
      Valid probs shape: (37, 62075)
    ✓ Random_24 (pose=(-2.700950346762295, -2.1507685295442083, -1.3751744318149133)): shape (37, 800, 800)
      Valid pixels: 68359/640000 (10.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=364820, num_faces=364824
      Valid probs shape: (37, 68359)
    ✓ Random_25 (pose=(-1.4101503122293426, -2.9938373289191818, 1.7455399567601688)): shape (37, 800, 800)
      Valid pixels: 66747/640000 (10.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=133, max=364822, num_faces=364824
      Valid probs shape: (37, 66747)
    ✓ Random_26 (pose=(0.8620558402768284, -2.8563492152206083, -3.0529859047329313)): shape (37, 800, 800)
      Valid pixels: 82604/640000 (12.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=4697, max=364678, num_faces=364824
      Valid probs shape: (37, 82604)
    ✓ Random_27 (pose=(0.3117204925918089, 1.3282521015386948, -1.9491055462142495)): shape (37, 800, 800)
      Valid pixels: 94168/640000 (14.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=14, max=364819, num_faces=364824
      Valid probs shape: (37, 94168)
    ✓ Random_28 (pose=(1.4508401592109212, -0.029255915533456633, -1.4786205743538035)): shape (37, 800, 800)
      Valid pixels: 61938/640000 (9.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=94, max=364823, num_faces=364824
      Valid probs shape: (37, 61938)
    ✓ Random_29 (pose=(2.678694752719389, -2.93232221960981, -0.5035662064130091)): shape (37, 800, 800)
      Valid pixels: 62452/640000 (9.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=364819, num_faces=364824
      Valid probs shape: (37, 62452)
    P stats: min=0.0000, max=1.0000, mean=0.0251
    Non-zero vertices: 169708/182414
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 12706  2005  1495  4310     0  2488  1468  5370  9099]
  Ground Truth Stats:
    Labels shape: (182414,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/Colin27-1/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7510
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8032
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8036

  RESULTS:
  RAW:         median(top-10)=0.8726, mean(top-10)=0.8816, median(all)=0.8151, mean(all)=0.7510
  + SMOOTHING: median(top-10)=0.9077, mean(top-10)=0.9103, median(all)=0.8417, mean(all)=0.8032 [+0.0351]
  + MRF:       median(top-10)=0.9086, mean(top-10)=0.9108, median(all)=0.8422, mean(all)=0.8036 [+0.0009]
  TOTAL IMPROVEMENT (median top-10): +0.0360

================================================================================
Subject: HLN-12-1
================================================================================
  Step 0: Generating predictions with V2 model (30 random views)...
  Mesh: 138729 vertices, 277454 faces
  Generating 30 random views...
  Generating predictions for 30 views (continuous camera pose)...
    ✓ Random_0 (pose=(1.5968223007924136, 1.4193968991617059, 0.1137176623601941)): shape (37, 800, 800)
      Valid pixels: 107476/640000 (16.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=277453, num_faces=277454
      Valid probs shape: (37, 107476)
    ✓ Random_1 (pose=(2.763478163643973, -0.6846668867014665, 2.0646202042705637)): shape (37, 800, 800)
      Valid pixels: 94084/640000 (14.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8701, max=277438, num_faces=277454
      Valid probs shape: (37, 94084)
    ✓ Random_2 (pose=(-2.454994169607356, -0.8769888601141655, -0.6145790490191931)): shape (37, 800, 800)
      Valid pixels: 79618/640000 (12.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6964, max=277286, num_faces=277454
      Valid probs shape: (37, 79618)
    ✓ Random_3 (pose=(-2.1262256897879857, 2.8547396634177886, -1.751755401434757)): shape (37, 800, 800)
      Valid pixels: 71801/640000 (11.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=277453, num_faces=277454
      Valid probs shape: (37, 71801)
    ✓ Random_4 (pose=(-1.6898317595362191, -2.650438441551023, 2.275497568977036)): shape (37, 800, 800)
      Valid pixels: 103718/640000 (16.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=13, max=277453, num_faces=277454
      Valid probs shape: (37, 103718)
    ✓ Random_5 (pose=(0.23034168607112804, 1.8553880025009795, 0.9978025212284445)): shape (37, 800, 800)
      Valid pixels: 105133/640000 (16.4%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=200, max=277285, num_faces=277454
      Valid probs shape: (37, 105133)
    ✓ Random_6 (pose=(-2.940823330980981, -2.4450809975716954, 1.3969169908294594)): shape (37, 800, 800)
      Valid pixels: 73494/640000 (11.5%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=5, max=276707, num_faces=277454
      Valid probs shape: (37, 73494)
    ✓ Random_7 (pose=(-1.5268855651022446, 0.9224396565937578, 0.6415960930036553)): shape (37, 800, 800)
      Valid pixels: 83027/640000 (13.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=277453, num_faces=277454
      Valid probs shape: (37, 83027)
    ✓ Random_8 (pose=(-0.7706483253029783, 1.3594208909619434, 2.33007868779512)): shape (37, 800, 800)
      Valid pixels: 72719/640000 (11.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=11, max=277453, num_faces=277454
      Valid probs shape: (37, 72719)
    ✓ Random_9 (pose=(1.5605859051043627, 2.2338699013425547, -1.9637267087310115)): shape (37, 800, 800)
      Valid pixels: 76762/640000 (12.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=31, max=277452, num_faces=277454
      Valid probs shape: (37, 76762)
    ✓ Random_10 (pose=(-0.10141470126837993, 0.10823468693539429, -0.9480987809508319)): shape (37, 800, 800)
      Valid pixels: 59477/640000 (9.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=277333, num_faces=277454
      Valid probs shape: (37, 59477)
    ✓ Random_11 (pose=(-1.0879622831421485, -1.7515455214787214, 2.6670955199504993)): shape (37, 800, 800)
      Valid pixels: 108208/640000 (16.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=4, max=277453, num_faces=277454
      Valid probs shape: (37, 108208)
    ✓ Random_12 (pose=(0.6868436728901224, 3.123244701023327, -2.464403269192388)): shape (37, 800, 800)
      Valid pixels: 81684/640000 (12.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2433, max=277441, num_faces=277454
      Valid probs shape: (37, 81684)
    ✓ Random_13 (pose=(0.3106856374237048, 2.2691801861648413, -2.06459621260291)): shape (37, 800, 800)
      Valid pixels: 85587/640000 (13.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=81, max=277453, num_faces=277454
      Valid probs shape: (37, 85587)
    ✓ Random_14 (pose=(-3.0479095864182297, 1.3482141380017403, -0.49544594860563995)): shape (37, 800, 800)
      Valid pixels: 81091/640000 (12.7%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=92, max=277448, num_faces=277454
      Valid probs shape: (37, 81091)
    ✓ Random_15 (pose=(-0.900422807482534, -1.8299490850329307, -2.668293490844634)): shape (37, 800, 800)
      Valid pixels: 75684/640000 (11.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=12, max=277449, num_faces=277454
      Valid probs shape: (37, 75684)
    ✓ Random_16 (pose=(2.0701846722256265, 3.026898000918351, 1.3273746006131866)): shape (37, 800, 800)
      Valid pixels: 75730/640000 (11.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=277449, num_faces=277454
      Valid probs shape: (37, 75730)
    ✓ Random_17 (pose=(-1.512433148409955, -0.9825127315879101, 2.6359001268701707)): shape (37, 800, 800)
      Valid pixels: 114285/640000 (17.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=277453, num_faces=277454
      Valid probs shape: (37, 114285)
    ✓ Random_18 (pose=(3.0563424577981833, -1.2540053340861073, -2.6763097633930863)): shape (37, 800, 800)
      Valid pixels: 86898/640000 (13.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=36, max=277453, num_faces=277454
      Valid probs shape: (37, 86898)
    ✓ Random_19 (pose=(0.6095862904798772, 0.36570683404488324, -2.214412722132928)): shape (37, 800, 800)
      Valid pixels: 58553/640000 (9.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=277453, num_faces=277454
      Valid probs shape: (37, 58553)
    ✓ Random_20 (pose=(-3.110377556752633, 1.656482780215021, -0.8716141669407387)): shape (37, 800, 800)
      Valid pixels: 80861/640000 (12.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=9, max=277448, num_faces=277454
      Valid probs shape: (37, 80861)
    ✓ Random_21 (pose=(-2.128279112583905, 1.5203922370920555, 1.9679944060426298)): shape (37, 800, 800)
      Valid pixels: 112013/640000 (17.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=15, max=277453, num_faces=277454
      Valid probs shape: (37, 112013)
    ✓ Random_22 (pose=(0.2925061636675861, 0.2797732715022332, -2.032602941368089)): shape (37, 800, 800)
      Valid pixels: 60980/640000 (9.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=277440, num_faces=277454
      Valid probs shape: (37, 60980)
    ✓ Random_23 (pose=(1.3548195258823705, 1.0034325795048717, -1.6056999555527987)): shape (37, 800, 800)
      Valid pixels: 77065/640000 (12.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=277453, num_faces=277454
      Valid probs shape: (37, 77065)
    ✓ Random_24 (pose=(-0.8855111491457626, 1.541183395633066, 1.4242610895650643)): shape (37, 800, 800)
      Valid pixels: 80688/640000 (12.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=10, max=277448, num_faces=277454
      Valid probs shape: (37, 80688)
    ✓ Random_25 (pose=(0.6516664088791573, -1.3103360953241405, -2.425796370357455)): shape (37, 800, 800)
      Valid pixels: 103697/640000 (16.2%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=0, max=277285, num_faces=277454
      Valid probs shape: (37, 103697)
    ✓ Random_26 (pose=(-2.26705853505317, -0.9652283580008376, -0.25734128908262566)): shape (37, 800, 800)
      Valid pixels: 103364/640000 (16.2%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=1880, max=277285, num_faces=277454
      Valid probs shape: (37, 103364)
    ✓ Random_27 (pose=(0.6959202610386703, 2.1012756390517966, 0.4089047381456803)): shape (37, 800, 800)
      Valid pixels: 70293/640000 (11.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2537, max=277449, num_faces=277454
      Valid probs shape: (37, 70293)
    ✓ Random_28 (pose=(-0.2929375050559484, 1.4162448289341887, -1.6871564241961383)): shape (37, 800, 800)
      Valid pixels: 105297/640000 (16.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=277453, num_faces=277454
      Valid probs shape: (37, 105297)
    ✓ Random_29 (pose=(2.7318823584654606, 0.2235908814369556, 1.8835058372715556)): shape (37, 800, 800)
      Valid pixels: 58031/640000 (9.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=46968, max=277453, num_faces=277454
      Valid probs shape: (37, 58031)
    P stats: min=0.0000, max=0.9999, mean=0.0253
    Non-zero vertices: 129981/138729
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 8748 1075 1032 3366    0 1733  991 5224 7026]
  Ground Truth Stats:
    Labels shape: (138729,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/HLN-12-1/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7739
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8311
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8317

  RESULTS:
  RAW:         median(top-10)=0.9031, mean(top-10)=0.9050, median(all)=0.8340, mean(all)=0.7739
  + SMOOTHING: median(top-10)=0.9287, mean(top-10)=0.9292, median(all)=0.8759, mean(all)=0.8311 [+0.0256]
  + MRF:       median(top-10)=0.9289, mean(top-10)=0.9295, median(all)=0.8761, mean(all)=0.8317 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0258

================================================================================
Subject: HLN-12-10
================================================================================
  Step 0: Generating predictions with V2 model (30 random views)...
  Mesh: 134639 vertices, 269274 faces
  Generating 30 random views...
  Generating predictions for 30 views (continuous camera pose)...
    ✓ Random_0 (pose=(-2.370821248596562, 0.6206749797875943, -0.13411729439746622)): shape (37, 800, 800)
      Valid pixels: 81945/640000 (12.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1985, max=269273, num_faces=269274
      Valid probs shape: (37, 81945)
    ✓ Random_1 (pose=(-2.5327388993178315, -2.1470575514455787, 1.2236835630313507)): shape (37, 800, 800)
      Valid pixels: 82957/640000 (13.0%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=2, max=269214, num_faces=269274
      Valid probs shape: (37, 82957)
    ✓ Random_2 (pose=(0.5163986288945703, -0.24541095585330464, -1.9283927546750028)): shape (37, 800, 800)
      Valid pixels: 62299/640000 (9.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=268630, num_faces=269274
      Valid probs shape: (37, 62299)
    ✓ Random_3 (pose=(-1.5118840601959467, -1.09295487688504, 1.014042956984591)): shape (37, 800, 800)
      Valid pixels: 74577/640000 (11.7%)
      Probs stats: min=0.0000, max=0.9995, mean=0.0270
      Face IDs: min=25, max=269210, num_faces=269274
      Valid probs shape: (37, 74577)
    ✓ Random_4 (pose=(-1.678291049739872, 1.3984436851563204, -1.000384913463678)): shape (37, 800, 800)
      Valid pixels: 91565/640000 (14.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8, max=269268, num_faces=269274
      Valid probs shape: (37, 91565)
    ✓ Random_5 (pose=(-1.5164122547925336, 1.925522747998344, -0.3962426138644495)): shape (37, 800, 800)
      Valid pixels: 99944/640000 (15.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=269228, num_faces=269274
      Valid probs shape: (37, 99944)
    ✓ Random_6 (pose=(-1.3691162959282102, 0.8656929871841594, -1.6713076001904292)): shape (37, 800, 800)
      Valid pixels: 67127/640000 (10.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=269272, num_faces=269274
      Valid probs shape: (37, 67127)
    ✓ Random_7 (pose=(2.458068140447514, -1.0713139161496832, 2.6941595025033003)): shape (37, 800, 800)
      Valid pixels: 87149/640000 (13.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=40, max=269270, num_faces=269274
      Valid probs shape: (37, 87149)
    ✓ Random_8 (pose=(-0.8363220436477499, -1.902425101833938, 0.8270502155951971)): shape (37, 800, 800)
      Valid pixels: 67430/640000 (10.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=285, max=269273, num_faces=269274
      Valid probs shape: (37, 67430)
    ✓ Random_9 (pose=(2.2414536337969864, -0.4904459810686159, 2.457822641482063)): shape (37, 800, 800)
      Valid pixels: 91472/640000 (14.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1989, max=269271, num_faces=269274
      Valid probs shape: (37, 91472)
    ✓ Random_10 (pose=(-2.6919224460209388, 1.9319287210754377, 1.019662105878405)): shape (37, 800, 800)
      Valid pixels: 84595/640000 (13.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=269156, num_faces=269274
      Valid probs shape: (37, 84595)
    ✓ Random_11 (pose=(-0.8966671402338422, 1.9114303710122291, -1.827062752535483)): shape (37, 800, 800)
      Valid pixels: 84189/640000 (13.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=89, max=269272, num_faces=269274
      Valid probs shape: (37, 84189)
    ✓ Random_12 (pose=(-1.2110338412162582, -2.162410993724627, 1.8213928239553967)): shape (37, 800, 800)
      Valid pixels: 87692/640000 (13.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=116, max=269161, num_faces=269274
      Valid probs shape: (37, 87692)
    ✓ Random_13 (pose=(2.9843270941973, -2.758224449698842, -0.31093781374381635)): shape (37, 800, 800)
      Valid pixels: 54667/640000 (8.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=268813, num_faces=269274
      Valid probs shape: (37, 54667)
    ✓ Random_14 (pose=(-2.0023705676710177, -0.19655969658817263, 2.26860024261161)): shape (37, 800, 800)
      Valid pixels: 85449/640000 (13.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=112, max=269267, num_faces=269274
      Valid probs shape: (37, 85449)
    ✓ Random_15 (pose=(0.2994711298167383, -2.7390469280142145, 1.4504415746864439)): shape (37, 800, 800)
      Valid pixels: 62042/640000 (9.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=227, max=269273, num_faces=269274
      Valid probs shape: (37, 62042)
    ✓ Random_16 (pose=(0.030510779802070953, 0.6552262307154568, 1.00808010507581)): shape (37, 800, 800)
      Valid pixels: 73497/640000 (11.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=268505, num_faces=269274
      Valid probs shape: (37, 73497)
    ✓ Random_17 (pose=(1.0793760961535774, -0.8683276372580173, -2.8349970644322857)): shape (37, 800, 800)
      Valid pixels: 94004/640000 (14.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=5, max=269228, num_faces=269274
      Valid probs shape: (37, 94004)
    ✓ Random_18 (pose=(-1.2082488683425987, -1.4887383392681577, 1.17339210350388)): shape (37, 800, 800)
      Valid pixels: 67815/640000 (10.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=31, max=269273, num_faces=269274
      Valid probs shape: (37, 67815)
    ✓ Random_19 (pose=(-2.927976032822731, 2.131681935981895, -1.4902972342280938)): shape (37, 800, 800)
      Valid pixels: 88955/640000 (13.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=6, max=269228, num_faces=269274
      Valid probs shape: (37, 88955)
    ✓ Random_20 (pose=(-0.9793698424491497, -1.4524845034154308, 0.5363318793789307)): shape (37, 800, 800)
      Valid pixels: 73758/640000 (11.5%)
      Probs stats: min=0.0000, max=0.9995, mean=0.0270
      Face IDs: min=21, max=269164, num_faces=269274
      Valid probs shape: (37, 73758)
    ✓ Random_21 (pose=(2.266430287758305, -1.5034925208995698, 0.3284905748959912)): shape (37, 800, 800)
      Valid pixels: 75720/640000 (11.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=269272, num_faces=269274
      Valid probs shape: (37, 75720)
    ✓ Random_22 (pose=(-2.640228529234581, 1.1823372658459927, 2.7320379576244793)): shape (37, 800, 800)
      Valid pixels: 83797/640000 (13.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=91, max=269272, num_faces=269274
      Valid probs shape: (37, 83797)
    ✓ Random_23 (pose=(2.5744877311468066, 1.8098490626681825, -0.5588171279443972)): shape (37, 800, 800)
      Valid pixels: 66575/640000 (10.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=18, max=269162, num_faces=269274
      Valid probs shape: (37, 66575)
    ✓ Random_24 (pose=(-1.8464451042972332, -2.538602420340189, -0.4109144517147332)): shape (37, 800, 800)
      Valid pixels: 96989/640000 (15.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=269228, num_faces=269274
      Valid probs shape: (37, 96989)
    ✓ Random_25 (pose=(1.3023568197611048, 2.312919709481549, 1.5786127244096058)): shape (37, 800, 800)
      Valid pixels: 70168/640000 (11.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=50, max=269272, num_faces=269274
      Valid probs shape: (37, 70168)
    ✓ Random_26 (pose=(-0.12640745365702832, -0.6155360181028127, 2.7998720963197155)): shape (37, 800, 800)
      Valid pixels: 59640/640000 (9.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=268811, num_faces=269274
      Valid probs shape: (37, 59640)
    ✓ Random_27 (pose=(-0.17282981333601288, -0.5987688934840123, 2.306171986254249)): shape (37, 800, 800)
      Valid pixels: 67644/640000 (10.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=268823, num_faces=269274
      Valid probs shape: (37, 67644)
    ✓ Random_28 (pose=(1.1689401411745717, -0.652149381145001, -0.6187159331592555)): shape (37, 800, 800)
      Valid pixels: 89924/640000 (14.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=269155, num_faces=269274
      Valid probs shape: (37, 89924)
    ✓ Random_29 (pose=(-2.6515066036878374, 3.0980547221115735, 2.8062299641895967)): shape (37, 800, 800)
      Valid pixels: 65225/640000 (10.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=268823, num_faces=269274
      Valid probs shape: (37, 65225)
    P stats: min=0.0000, max=1.0000, mean=0.0252
    Non-zero vertices: 125703/134639
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 8936 1555 1067 2828    0 2948  971 4089 6339]
  Ground Truth Stats:
    Labels shape: (134639,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/HLN-12-10/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7629
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8092
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8094

  RESULTS:
  RAW:         median(top-10)=0.8888, mean(top-10)=0.8965, median(all)=0.8253, mean(all)=0.7629
  + SMOOTHING: median(top-10)=0.9153, mean(top-10)=0.9198, median(all)=0.8660, mean(all)=0.8092 [+0.0264]
  + MRF:       median(top-10)=0.9158, mean(top-10)=0.9201, median(all)=0.8657, mean(all)=0.8094 [+0.0006]
  TOTAL IMPROVEMENT (median top-10): +0.0270

================================================================================
Subject: HLN-12-11
================================================================================
  Step 0: Generating predictions with V2 model (30 random views)...
  Mesh: 130710 vertices, 261416 faces
  Generating 30 random views...
  Generating predictions for 30 views (continuous camera pose)...
    ✓ Random_0 (pose=(-2.188716765162377, -1.2964113896777212, 1.58326313594287)): shape (37, 800, 800)
      Valid pixels: 82080/640000 (12.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=186, max=261415, num_faces=261416
      Valid probs shape: (37, 82080)
    ✓ Random_1 (pose=(-2.235032153089099, 2.1550154302224325, -1.7283845351737124)): shape (37, 800, 800)
      Valid pixels: 85436/640000 (13.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=10, max=258654, num_faces=261416
      Valid probs shape: (37, 85436)
    ✓ Random_2 (pose=(-0.6060387881826861, 0.7101345853953691, -0.09800523282568063)): shape (37, 800, 800)
      Valid pixels: 86052/640000 (13.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=260917, num_faces=261416
      Valid probs shape: (37, 86052)
    ✓ Random_3 (pose=(-2.730853204074599, 1.5924102567802914, 1.583267422146764)): shape (37, 800, 800)
      Valid pixels: 110947/640000 (17.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=9, max=261329, num_faces=261416
      Valid probs shape: (37, 110947)
    ✓ Random_4 (pose=(-2.6764464422604197, 2.7343450080446354, 2.264504602627799)): shape (37, 800, 800)
      Valid pixels: 76742/640000 (12.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=261233, num_faces=261416
      Valid probs shape: (37, 76742)
    ✓ Random_5 (pose=(-1.047403174336543, -1.6204251219807009, 1.911300830210478)): shape (37, 800, 800)
      Valid pixels: 106160/640000 (16.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=11, max=261411, num_faces=261416
      Valid probs shape: (37, 106160)
    ✓ Random_6 (pose=(2.572333153600323, -2.0506620991255198, -2.7195845779934666)): shape (37, 800, 800)
      Valid pixels: 71121/640000 (11.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=13, max=261415, num_faces=261416
      Valid probs shape: (37, 71121)
    ✓ Random_7 (pose=(-0.30986710422617314, 0.985573510803798, -1.8564251014595017)): shape (37, 800, 800)
      Valid pixels: 95359/640000 (14.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=261235, num_faces=261416
      Valid probs shape: (37, 95359)
    ✓ Random_8 (pose=(2.380502348277674, -2.143408939097532, -2.444177625166402)): shape (37, 800, 800)
      Valid pixels: 70103/640000 (11.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=261415, num_faces=261416
      Valid probs shape: (37, 70103)
    ✓ Random_9 (pose=(0.09470666074210365, -2.472148244143022, -0.5685947158235494)): shape (37, 800, 800)
      Valid pixels: 70059/640000 (10.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=517, max=261415, num_faces=261416
      Valid probs shape: (37, 70059)
    ✓ Random_10 (pose=(-2.457465826088302, 2.66111937115116, 2.7040809075232106)): shape (37, 800, 800)
      Valid pixels: 86418/640000 (13.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=261281, num_faces=261416
      Valid probs shape: (37, 86418)
    ✓ Random_11 (pose=(-2.377285806644258, -2.4895330502273865, 1.6739550851455114)): shape (37, 800, 800)
      Valid pixels: 71301/640000 (11.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=261415, num_faces=261416
      Valid probs shape: (37, 71301)
    ✓ Random_12 (pose=(-1.032513780016203, 3.0601678096385747, 1.2651971734578664)): shape (37, 800, 800)
      Valid pixels: 76198/640000 (11.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=515, max=261415, num_faces=261416
      Valid probs shape: (37, 76198)
    ✓ Random_13 (pose=(2.409870257527543, 0.11440909965675683, -2.589844990525047)): shape (37, 800, 800)
      Valid pixels: 81926/640000 (12.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1615, max=261413, num_faces=261416
      Valid probs shape: (37, 81926)
    ✓ Random_14 (pose=(-0.64217791614226, -0.955794158177445, 1.1812962959462956)): shape (37, 800, 800)
      Valid pixels: 79788/640000 (12.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=261413, num_faces=261416
      Valid probs shape: (37, 79788)
    ✓ Random_15 (pose=(0.2712280169235415, -1.4845063404022378, -2.6544783542039965)): shape (37, 800, 800)
      Valid pixels: 99508/640000 (15.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=35, max=261108, num_faces=261416
      Valid probs shape: (37, 99508)
    ✓ Random_16 (pose=(-2.591405475126685, -0.8005191434566159, -2.3704748158675764)): shape (37, 800, 800)
      Valid pixels: 92210/640000 (14.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=377, max=261193, num_faces=261416
      Valid probs shape: (37, 92210)
    ✓ Random_17 (pose=(1.6362589013687803, 0.9413909478165587, -2.469568942619725)): shape (37, 800, 800)
      Valid pixels: 85803/640000 (13.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=47, max=261119, num_faces=261416
      Valid probs shape: (37, 85803)
    ✓ Random_18 (pose=(0.018200765285779408, 1.3376041401924486, 1.6935630646605961)): shape (37, 800, 800)
      Valid pixels: 95061/640000 (14.9%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=3, max=261119, num_faces=261416
      Valid probs shape: (37, 95061)
    ✓ Random_19 (pose=(-2.8438098299258012, -1.2533808996336362, -2.6240987457694436)): shape (37, 800, 800)
      Valid pixels: 101837/640000 (15.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=12, max=261409, num_faces=261416
      Valid probs shape: (37, 101837)
    ✓ Random_20 (pose=(2.10842880503509, -2.9767601770884253, 0.8545277473703758)): shape (37, 800, 800)
      Valid pixels: 77299/640000 (12.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=260703, num_faces=261416
      Valid probs shape: (37, 77299)
    ✓ Random_21 (pose=(-1.3082204618646482, -1.5601307983606798, 2.8659397958462813)): shape (37, 800, 800)
      Valid pixels: 109097/640000 (17.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=27, max=261410, num_faces=261416
      Valid probs shape: (37, 109097)
    ✓ Random_22 (pose=(1.335501708801596, -1.8065633716191511, 1.3231964983477216)): shape (37, 800, 800)
      Valid pixels: 78873/640000 (12.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=9, max=261133, num_faces=261416
      Valid probs shape: (37, 78873)
    ✓ Random_23 (pose=(-0.3938486110211361, 1.1328566063877314, -0.6389982506080267)): shape (37, 800, 800)
      Valid pixels: 70389/640000 (11.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=258541, num_faces=261416
      Valid probs shape: (37, 70389)
    ✓ Random_24 (pose=(-3.0986692841902075, 2.446923910232327, -2.828692057247992)): shape (37, 800, 800)
      Valid pixels: 68177/640000 (10.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=258539, num_faces=261416
      Valid probs shape: (37, 68177)
    ✓ Random_25 (pose=(2.963410358714457, 1.6140381972838664, -2.0504652705118502)): shape (37, 800, 800)
      Valid pixels: 104172/640000 (16.3%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=16, max=261119, num_faces=261416
      Valid probs shape: (37, 104172)
    ✓ Random_26 (pose=(-2.467100441942159, -1.8101019497221047, -2.4898126171600965)): shape (37, 800, 800)
      Valid pixels: 109706/640000 (17.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=9, max=261410, num_faces=261416
      Valid probs shape: (37, 109706)
    ✓ Random_27 (pose=(-2.3580064464896413, 2.3666068463944763, 1.1405336178713492)): shape (37, 800, 800)
      Valid pixels: 67560/640000 (10.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=261409, num_faces=261416
      Valid probs shape: (37, 67560)
    ✓ Random_28 (pose=(0.25696131030773905, -1.9251490830630666, 0.3609364507926367)): shape (37, 800, 800)
      Valid pixels: 95320/640000 (14.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=208, max=261413, num_faces=261416
      Valid probs shape: (37, 95320)
    ✓ Random_29 (pose=(-1.8435186518237754, 1.3672960503489282, -2.968814639699163)): shape (37, 800, 800)
      Valid pixels: 94574/640000 (14.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=261145, num_faces=261416
      Valid probs shape: (37, 94574)
    P stats: min=0.0000, max=0.9999, mean=0.0252
    Non-zero vertices: 121904/130710
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 8806 1795  967 3018    0 1662 1163 3841 5747]
  Ground Truth Stats:
    Labels shape: (130710,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/HLN-12-11/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7789
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8278
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8283

  RESULTS:
  RAW:         median(top-10)=0.8986, mean(top-10)=0.9062, median(all)=0.8354, mean(all)=0.7789
  + SMOOTHING: median(top-10)=0.9310, mean(top-10)=0.9337, median(all)=0.8801, mean(all)=0.8278 [+0.0324]
  + MRF:       median(top-10)=0.9308, mean(top-10)=0.9338, median(all)=0.8806, mean(all)=0.8283 [-0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0323

================================================================================
Subject: HLN-12-12
================================================================================
  Step 0: Generating predictions with V2 model (30 random views)...
  Mesh: 148128 vertices, 296252 faces
  Generating 30 random views...
  Generating predictions for 30 views (continuous camera pose)...
    ✓ Random_0 (pose=(-1.7767482266275865, -2.0386576104587366, -2.5307538225697717)): shape (37, 800, 800)
      Valid pixels: 77918/640000 (12.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7, max=296202, num_faces=296252
      Valid probs shape: (37, 77918)
    ✓ Random_1 (pose=(0.45658574589285683, 2.126557799771227, 2.381266827110009)): shape (37, 800, 800)
      Valid pixels: 73193/640000 (11.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=415, max=296251, num_faces=296252
      Valid probs shape: (37, 73193)
    ✓ Random_2 (pose=(2.8129020352470224, -0.8237528757153423, 2.227853115091264)): shape (37, 800, 800)
      Valid pixels: 69539/640000 (10.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1472, max=296251, num_faces=296252
      Valid probs shape: (37, 69539)
    ✓ Random_3 (pose=(2.1186063888028706, -0.16258522178027546, 0.14296141156896924)): shape (37, 800, 800)
      Valid pixels: 72420/640000 (11.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=87, max=296248, num_faces=296252
      Valid probs shape: (37, 72420)
    ✓ Random_4 (pose=(1.0662329944100097, 2.6252555240539044, 0.5077803010379425)): shape (37, 800, 800)
      Valid pixels: 65942/640000 (10.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=102, max=296250, num_faces=296252
      Valid probs shape: (37, 65942)
    ✓ Random_5 (pose=(-1.94740778054763, -2.491119722370944, -3.040514059001468)): shape (37, 800, 800)
      Valid pixels: 86509/640000 (13.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=10, max=296203, num_faces=296252
      Valid probs shape: (37, 86509)
    ✓ Random_6 (pose=(-2.5282570535898206, -2.0006116873433832, -2.7146449032317195)): shape (37, 800, 800)
      Valid pixels: 85070/640000 (13.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=11, max=296203, num_faces=296252
      Valid probs shape: (37, 85070)
    ✓ Random_7 (pose=(2.4836752381237135, -2.451870113871938, -2.0855517868295212)): shape (37, 800, 800)
      Valid pixels: 52577/640000 (8.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8, max=296202, num_faces=296252
      Valid probs shape: (37, 52577)
    ✓ Random_8 (pose=(-2.13777479613897, -1.4808014594665793, 1.177839333870213)): shape (37, 800, 800)
      Valid pixels: 70625/640000 (11.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=296203, num_faces=296252
      Valid probs shape: (37, 70625)
    ✓ Random_9 (pose=(-0.2446079648081496, -0.6315951765754391, -1.7036757779683207)): shape (37, 800, 800)
      Valid pixels: 62077/640000 (9.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=295959, num_faces=296252
      Valid probs shape: (37, 62077)
    ✓ Random_10 (pose=(-1.8446580783636848, 0.9040115891625238, 2.053949613305872)): shape (37, 800, 800)
      Valid pixels: 82194/640000 (12.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=77, max=296204, num_faces=296252
      Valid probs shape: (37, 82194)
    ✓ Random_11 (pose=(2.958534453038652, 0.17296730885072664, 3.0232903864516727)): shape (37, 800, 800)
      Valid pixels: 48619/640000 (7.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=57329, max=296250, num_faces=296252
      Valid probs shape: (37, 48619)
    ✓ Random_12 (pose=(2.6168547216652023, 1.7845042268384894, 3.028039419059265)): shape (37, 800, 800)
      Valid pixels: 70703/640000 (11.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=295493, num_faces=296252
      Valid probs shape: (37, 70703)
    ✓ Random_13 (pose=(0.5173584525049955, -0.2019479846569867, -2.6087017609589633)): shape (37, 800, 800)
      Valid pixels: 53987/640000 (8.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=295662, num_faces=296252
      Valid probs shape: (37, 53987)
    ✓ Random_14 (pose=(-1.177707386833655, 0.053049702807342225, -3.134733760510398)): shape (37, 800, 800)
      Valid pixels: 83124/640000 (13.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=8, max=296203, num_faces=296252
      Valid probs shape: (37, 83124)
    ✓ Random_15 (pose=(0.08569235882514192, 2.053188121035305, 3.0507702674059596)): shape (37, 800, 800)
      Valid pixels: 56540/640000 (8.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1167, max=296200, num_faces=296252
      Valid probs shape: (37, 56540)
    ✓ Random_16 (pose=(3.0243000097657307, 1.7832672886665106, 0.8027388761568695)): shape (37, 800, 800)
      Valid pixels: 86071/640000 (13.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=8, max=296204, num_faces=296252
      Valid probs shape: (37, 86071)
    ✓ Random_17 (pose=(-2.6175349925650933, 1.5321281540527654, 1.6753214584621539)): shape (37, 800, 800)
      Valid pixels: 89791/640000 (14.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=62, max=296202, num_faces=296252
      Valid probs shape: (37, 89791)
    ✓ Random_18 (pose=(-0.5359428613787878, -1.0467367818005897, -0.1790015370051985)): shape (37, 800, 800)
      Valid pixels: 63216/640000 (9.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=7, max=296203, num_faces=296252
      Valid probs shape: (37, 63216)
    ✓ Random_19 (pose=(1.3432225053382076, -2.4970419538215207, -1.3049199589468914)): shape (37, 800, 800)
      Valid pixels: 59707/640000 (9.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=77, max=296204, num_faces=296252
      Valid probs shape: (37, 59707)
    ✓ Random_20 (pose=(-0.12321807675812257, -0.9574956214643722, 0.07640056736352863)): shape (37, 800, 800)
      Valid pixels: 51682/640000 (8.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=296198, num_faces=296252
      Valid probs shape: (37, 51682)
    ✓ Random_21 (pose=(0.7718195664130629, -2.5421873953422116, -2.874143168048228)): shape (37, 800, 800)
      Valid pixels: 75460/640000 (11.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=339, max=296251, num_faces=296252
      Valid probs shape: (37, 75460)
    ✓ Random_22 (pose=(-1.789603705587254, 1.6425146669465835, 1.003684317033657)): shape (37, 800, 800)
      Valid pixels: 60856/640000 (9.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=69, max=296203, num_faces=296252
      Valid probs shape: (37, 60856)
    ✓ Random_23 (pose=(0.8393231361459312, 2.5919535991743405, 2.5155718875368116)): shape (37, 800, 800)
      Valid pixels: 75779/640000 (11.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=128, max=296251, num_faces=296252
      Valid probs shape: (37, 75779)
    ✓ Random_24 (pose=(0.4396095866667644, 2.9274723626168235, -2.3117366300103264)): shape (37, 800, 800)
      Valid pixels: 46016/640000 (7.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1607, max=296251, num_faces=296252
      Valid probs shape: (37, 46016)
    ✓ Random_25 (pose=(2.152749247993679, 1.4444018070512445, -2.2819673630587856)): shape (37, 800, 800)
      Valid pixels: 76871/640000 (12.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=2, max=296203, num_faces=296252
      Valid probs shape: (37, 76871)
    ✓ Random_26 (pose=(-0.22092207632534722, 2.876122320891062, -0.9504998004152938)): shape (37, 800, 800)
      Valid pixels: 42060/640000 (6.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=9989, max=296250, num_faces=296252
      Valid probs shape: (37, 42060)
    ✓ Random_27 (pose=(-0.5509608924965614, 0.02535910890784976, 1.1893709194884536)): shape (37, 800, 800)
      Valid pixels: 47530/640000 (7.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=296199, num_faces=296252
      Valid probs shape: (37, 47530)
    ✓ Random_28 (pose=(-0.8337795009206617, -1.2765632757997145, 0.534700591028348)): shape (37, 800, 800)
      Valid pixels: 59872/640000 (9.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=296201, num_faces=296252
      Valid probs shape: (37, 59872)
    ✓ Random_29 (pose=(-1.7687320662988268, -2.668952679750401, -2.039432416018667)): shape (37, 800, 800)
      Valid pixels: 63062/640000 (9.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=296200, num_faces=296252
      Valid probs shape: (37, 63062)
    P stats: min=0.0000, max=1.0000, mean=0.0248
    Non-zero vertices: 135848/148128
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 12280  1565   925  3784     0  2287  1101  6095  6326]
  Ground Truth Stats:
    Labels shape: (148128,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/HLN-12-12/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7707
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8282
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8284

  RESULTS:
  RAW:         median(top-10)=0.8857, mean(top-10)=0.8941, median(all)=0.8276, mean(all)=0.7707
  + SMOOTHING: median(top-10)=0.9250, mean(top-10)=0.9288, median(all)=0.8718, mean(all)=0.8282 [+0.0393]
  + MRF:       median(top-10)=0.9254, mean(top-10)=0.9291, median(all)=0.8720, mean(all)=0.8284 [+0.0004]
  TOTAL IMPROVEMENT (median top-10): +0.0397

================================================================================
Subject: HLN-12-2
================================================================================
  Step 0: Generating predictions with V2 model (30 random views)...
  Mesh: 146833 vertices, 293662 faces
  Generating 30 random views...
  Generating predictions for 30 views (continuous camera pose)...
    ✓ Random_0 (pose=(-2.124252686049412, -2.458685807001835, -1.835386390179779)): shape (37, 800, 800)
      Valid pixels: 73396/640000 (11.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=293616, num_faces=293662
      Valid probs shape: (37, 73396)
    ✓ Random_1 (pose=(1.3935432171237219, 0.37101179000312756, -3.1064397682327645)): shape (37, 800, 800)
      Valid pixels: 93663/640000 (14.6%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=19, max=293660, num_faces=293662
      Valid probs shape: (37, 93663)
    ✓ Random_2 (pose=(1.0025367773068705, 1.5420506326153935, -0.5300343204270379)): shape (37, 800, 800)
      Valid pixels: 102998/640000 (16.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=293617, num_faces=293662
      Valid probs shape: (37, 102998)
    ✓ Random_3 (pose=(-0.5423687341928276, 2.8935255106181392, -3.08761984764256)): shape (37, 800, 800)
      Valid pixels: 73600/640000 (11.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=293655, num_faces=293662
      Valid probs shape: (37, 73600)
    ✓ Random_4 (pose=(1.782914211207264, 0.011569234191206146, -1.0914282586947546)): shape (37, 800, 800)
      Valid pixels: 87315/640000 (13.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=293653, num_faces=293662
      Valid probs shape: (37, 87315)
    ✓ Random_5 (pose=(1.5730751840119446, 0.8649246112168196, -0.037956757041857525)): shape (37, 800, 800)
      Valid pixels: 104540/640000 (16.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=293617, num_faces=293662
      Valid probs shape: (37, 104540)
    ✓ Random_6 (pose=(1.9577164605385429, -1.2506795310601055, 2.743473437410721)): shape (37, 800, 800)
      Valid pixels: 96944/640000 (15.1%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=83, max=293661, num_faces=293662
      Valid probs shape: (37, 96944)
    ✓ Random_7 (pose=(3.010622886642894, 1.9360863775266948, -1.5126462848894828)): shape (37, 800, 800)
      Valid pixels: 88729/640000 (13.9%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=15, max=293634, num_faces=293662
      Valid probs shape: (37, 88729)
    ✓ Random_8 (pose=(-2.945465035270007, 1.3786058615418968, 0.8828584514626288)): shape (37, 800, 800)
      Valid pixels: 96231/640000 (15.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=293653, num_faces=293662
      Valid probs shape: (37, 96231)
    ✓ Random_9 (pose=(-0.16894622704461026, 0.10609154178000768, -2.3976644296193914)): shape (37, 800, 800)
      Valid pixels: 50695/640000 (7.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=293526, num_faces=293662
      Valid probs shape: (37, 50695)
    ✓ Random_10 (pose=(1.1833615232211256, -1.6772640519019433, -0.5236527280758514)): shape (37, 800, 800)
      Valid pixels: 94726/640000 (14.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=293649, num_faces=293662
      Valid probs shape: (37, 94726)
    ✓ Random_11 (pose=(2.8231551555379975, -3.025859541112398, 3.03077576998281)): shape (37, 800, 800)
      Valid pixels: 57372/640000 (9.0%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=1, max=292212, num_faces=293662
      Valid probs shape: (37, 57372)
    ✓ Random_12 (pose=(2.4415435923575233, -0.34883818380425025, 2.4340717634457762)): shape (37, 800, 800)
      Valid pixels: 80292/640000 (12.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5515, max=293660, num_faces=293662
      Valid probs shape: (37, 80292)
    ✓ Random_13 (pose=(2.386247786886919, 2.738268575052528, 2.607522441272594)): shape (37, 800, 800)
      Valid pixels: 79478/640000 (12.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=293467, num_faces=293662
      Valid probs shape: (37, 79478)
    ✓ Random_14 (pose=(0.942567896846044, 1.6038555649691215, -2.201625087383963)): shape (37, 800, 800)
      Valid pixels: 66332/640000 (10.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=77, max=293659, num_faces=293662
      Valid probs shape: (37, 66332)
    ✓ Random_15 (pose=(-2.544719433264091, -3.031090073155313, -2.7019664712032956)): shape (37, 800, 800)
      Valid pixels: 68048/640000 (10.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=293611, num_faces=293662
      Valid probs shape: (37, 68048)
    ✓ Random_16 (pose=(1.2153110858100513, -2.5378606210120207, -2.0427317890006913)): shape (37, 800, 800)
      Valid pixels: 75856/640000 (11.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=427, max=293660, num_faces=293662
      Valid probs shape: (37, 75856)
    ✓ Random_17 (pose=(-2.705004922357332, -3.1097955829010537, 1.5051524597150632)): shape (37, 800, 800)
      Valid pixels: 43761/640000 (6.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=293605, num_faces=293662
      Valid probs shape: (37, 43761)
    ✓ Random_18 (pose=(0.5509313191091567, 2.0299517199124777, -2.5826774817604132)): shape (37, 800, 800)
      Valid pixels: 68333/640000 (10.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=428, max=293659, num_faces=293662
      Valid probs shape: (37, 68333)
    ✓ Random_19 (pose=(-1.6233743808479033, -3.0938200757008265, -2.706904387270595)): shape (37, 800, 800)
      Valid pixels: 90381/640000 (14.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=11, max=293617, num_faces=293662
      Valid probs shape: (37, 90381)
    ✓ Random_20 (pose=(-2.85193190282418, -1.1091197670308754, -0.7600714298394275)): shape (37, 800, 800)
      Valid pixels: 65911/640000 (10.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=293652, num_faces=293662
      Valid probs shape: (37, 65911)
    ✓ Random_21 (pose=(0.9083445702474959, 2.36699001077597, 1.6150461505519633)): shape (37, 800, 800)
      Valid pixels: 81480/640000 (12.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5794, max=293661, num_faces=293662
      Valid probs shape: (37, 81480)
    ✓ Random_22 (pose=(-0.7179047846250439, 1.158107886025947, -0.6848717610179285)): shape (37, 800, 800)
      Valid pixels: 64391/640000 (10.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=293470, num_faces=293662
      Valid probs shape: (37, 64391)
    ✓ Random_23 (pose=(-1.300131358449585, -2.023400650292641, 1.6408587923547389)): shape (37, 800, 800)
      Valid pixels: 78041/640000 (12.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=13, max=293659, num_faces=293662
      Valid probs shape: (37, 78041)
    ✓ Random_24 (pose=(-2.8041111481494365, -1.3245856535831266, -2.82292875032164)): shape (37, 800, 800)
      Valid pixels: 95075/640000 (14.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=293661, num_faces=293662
      Valid probs shape: (37, 95075)
    ✓ Random_25 (pose=(-3.1307142352091315, -2.7592748542242185, 1.7404426021226644)): shape (37, 800, 800)
      Valid pixels: 59605/640000 (9.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=292219, num_faces=293662
      Valid probs shape: (37, 59605)
    ✓ Random_26 (pose=(-2.1139300782021295, -1.4960877906423429, 2.806939546833858)): shape (37, 800, 800)
      Valid pixels: 95915/640000 (15.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=293653, num_faces=293662
      Valid probs shape: (37, 95915)
    ✓ Random_27 (pose=(-0.3897642836163526, 1.2122946272635646, -2.130970198889491)): shape (37, 800, 800)
      Valid pixels: 98561/640000 (15.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6, max=293617, num_faces=293662
      Valid probs shape: (37, 98561)
    ✓ Random_28 (pose=(2.5199957549341647, 2.8484821759425945, 2.702942909700197)): shape (37, 800, 800)
      Valid pixels: 75239/640000 (11.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=293463, num_faces=293662
      Valid probs shape: (37, 75239)
    ✓ Random_29 (pose=(0.03437856332184053, 0.8488213738897992, -1.3611094974820381)): shape (37, 800, 800)
      Valid pixels: 79435/640000 (12.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=293615, num_faces=293662
      Valid probs shape: (37, 79435)
    P stats: min=0.0000, max=1.0000, mean=0.0255
    Non-zero vertices: 138547/146833
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 8286 1029 1083 3826    0 2085 1101 4936 6334]
  Ground Truth Stats:
    Labels shape: (146833,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/HLN-12-2/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7722
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8157
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8155

  RESULTS:
  RAW:         median(top-10)=0.9119, mean(top-10)=0.9082, median(all)=0.8327, mean(all)=0.7722
  + SMOOTHING: median(top-10)=0.9251, mean(top-10)=0.9267, median(all)=0.8672, mean(all)=0.8157 [+0.0132]
  + MRF:       median(top-10)=0.9250, mean(top-10)=0.9269, median(all)=0.8672, mean(all)=0.8155 [-0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0131

================================================================================
Subject: HLN-12-3
================================================================================
  Step 0: Generating predictions with V2 model (30 random views)...
  Mesh: 150991 vertices, 301978 faces
  Generating 30 random views...
  Generating predictions for 30 views (continuous camera pose)...
    ✓ Random_0 (pose=(2.142990332153781, -2.7655347199628135, 1.8024817875999553)): shape (37, 800, 800)
      Valid pixels: 80351/640000 (12.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=301651, num_faces=301978
      Valid probs shape: (37, 80351)
    ✓ Random_1 (pose=(2.9464485726338747, 3.039302378426398, -1.928185145185434)): shape (37, 800, 800)
      Valid pixels: 56467/640000 (8.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=300913, num_faces=301978
      Valid probs shape: (37, 56467)
    ✓ Random_2 (pose=(1.839092127612072, -3.060943011206094, -1.14892874947915)): shape (37, 800, 800)
      Valid pixels: 82425/640000 (12.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=301973, num_faces=301978
      Valid probs shape: (37, 82425)
    ✓ Random_3 (pose=(-2.422503718761007, -2.289503174616403, -1.7089312031595418)): shape (37, 800, 800)
      Valid pixels: 76300/640000 (11.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=301976, num_faces=301978
      Valid probs shape: (37, 76300)
    ✓ Random_4 (pose=(0.6110158610519125, 0.7265456458629007, -2.743798345275559)): shape (37, 800, 800)
      Valid pixels: 68200/640000 (10.7%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=2, max=301976, num_faces=301978
      Valid probs shape: (37, 68200)
    ✓ Random_5 (pose=(2.2561104630050055, 1.751334289513757, 0.6981941598952015)): shape (37, 800, 800)
      Valid pixels: 102386/640000 (16.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6, max=301973, num_faces=301978
      Valid probs shape: (37, 102386)
    ✓ Random_6 (pose=(-1.696269598826243, -0.35056001385503377, 2.6577544207057473)): shape (37, 800, 800)
      Valid pixels: 105548/640000 (16.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=65, max=301975, num_faces=301978
      Valid probs shape: (37, 105548)
    ✓ Random_7 (pose=(-2.105621541398359, -2.7394540018730207, 0.29324945440589234)): shape (37, 800, 800)
      Valid pixels: 87315/640000 (13.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=301889, num_faces=301978
      Valid probs shape: (37, 87315)
    ✓ Random_8 (pose=(0.49273752124145664, 2.4072918619071526, 0.6482254683649118)): shape (37, 800, 800)
      Valid pixels: 64459/640000 (10.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=479, max=301970, num_faces=301978
      Valid probs shape: (37, 64459)
    ✓ Random_9 (pose=(-2.3986476125152434, -0.3519094908577993, -1.0786072831452165)): shape (37, 800, 800)
      Valid pixels: 65054/640000 (10.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=25307, max=301977, num_faces=301978
      Valid probs shape: (37, 65054)
    ✓ Random_10 (pose=(-2.1705874778023904, 1.4835724247763613, 0.21922384870241585)): shape (37, 800, 800)
      Valid pixels: 79109/640000 (12.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=32, max=301977, num_faces=301978
      Valid probs shape: (37, 79109)
    ✓ Random_11 (pose=(1.9909164206608772, 0.879139880281766, 2.4645623193796693)): shape (37, 800, 800)
      Valid pixels: 89059/640000 (13.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=2086, max=301909, num_faces=301978
      Valid probs shape: (37, 89059)
    ✓ Random_12 (pose=(-0.32502344338214284, 2.0306408156912736, 1.9046774469823387)): shape (37, 800, 800)
      Valid pixels: 78388/640000 (12.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=274, max=301976, num_faces=301978
      Valid probs shape: (37, 78388)
    ✓ Random_13 (pose=(1.3988267250620554, 2.4217171628645957, -0.5411982246031997)): shape (37, 800, 800)
      Valid pixels: 106722/640000 (16.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=67, max=301976, num_faces=301978
      Valid probs shape: (37, 106722)
    ✓ Random_14 (pose=(0.08612863035533946, 2.346786186524751, -1.064565945682157)): shape (37, 800, 800)
      Valid pixels: 76368/640000 (11.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=922, max=301976, num_faces=301978
      Valid probs shape: (37, 76368)
    ✓ Random_15 (pose=(-3.1213917107263405, -2.1422617300927933, -2.434073115393257)): shape (37, 800, 800)
      Valid pixels: 82512/640000 (12.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=301926, num_faces=301978
      Valid probs shape: (37, 82512)
    ✓ Random_16 (pose=(-0.48068701787405743, -2.6273872355174674, 0.9193640267169183)): shape (37, 800, 800)
      Valid pixels: 60336/640000 (9.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1988, max=301977, num_faces=301978
      Valid probs shape: (37, 60336)
    ✓ Random_17 (pose=(-0.3078927266074567, -2.6973952374669103, -2.850377620138855)): shape (37, 800, 800)
      Valid pixels: 59082/640000 (9.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1560, max=301976, num_faces=301978
      Valid probs shape: (37, 59082)
    ✓ Random_18 (pose=(2.261026747476784, -1.7053664182414376, -0.9982000264087199)): shape (37, 800, 800)
      Valid pixels: 105866/640000 (16.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=301977, num_faces=301978
      Valid probs shape: (37, 105866)
    ✓ Random_19 (pose=(2.3036297955258442, 0.9374591257689691, -2.218072593801029)): shape (37, 800, 800)
      Valid pixels: 87042/640000 (13.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=194, max=301977, num_faces=301978
      Valid probs shape: (37, 87042)
    ✓ Random_20 (pose=(-2.4028441522587167, -2.1202648317155504, 1.894261228215865)): shape (37, 800, 800)
      Valid pixels: 73763/640000 (11.5%)
      Probs stats: min=0.0000, max=0.9995, mean=0.0270
      Face IDs: min=2, max=301976, num_faces=301978
      Valid probs shape: (37, 73763)
    ✓ Random_21 (pose=(2.2535275150060254, -2.1042420429769977, -1.7412859221447268)): shape (37, 800, 800)
      Valid pixels: 80406/640000 (12.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=301972, num_faces=301978
      Valid probs shape: (37, 80406)
    ✓ Random_22 (pose=(2.983665680431753, 1.0978592733612293, 0.5804084529731082)): shape (37, 800, 800)
      Valid pixels: 93700/640000 (14.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=208, max=301976, num_faces=301978
      Valid probs shape: (37, 93700)
    ✓ Random_23 (pose=(-1.898682467718872, -2.481841098512729, 0.6435197124465941)): shape (37, 800, 800)
      Valid pixels: 82404/640000 (12.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=3, max=301975, num_faces=301978
      Valid probs shape: (37, 82404)
    ✓ Random_24 (pose=(-2.8900498395625105, -0.9249997465376327, 2.1159105158213434)): shape (37, 800, 800)
      Valid pixels: 73167/640000 (11.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3853, max=301977, num_faces=301978
      Valid probs shape: (37, 73167)
    ✓ Random_25 (pose=(0.4696252317558449, -0.10333586775312487, 2.5100884483236268)): shape (37, 800, 800)
      Valid pixels: 64931/640000 (10.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=301346, num_faces=301978
      Valid probs shape: (37, 64931)
    ✓ Random_26 (pose=(1.1761721449911926, -0.16442905434173571, -3.1388976554401538)): shape (37, 800, 800)
      Valid pixels: 92454/640000 (14.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=301889, num_faces=301978
      Valid probs shape: (37, 92454)
    ✓ Random_27 (pose=(-0.6038780323721862, 3.118840397706802, -0.397325251433871)): shape (37, 800, 800)
      Valid pixels: 78003/640000 (12.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=35044, max=301977, num_faces=301978
      Valid probs shape: (37, 78003)
    ✓ Random_28 (pose=(2.1156113771484195, 0.7850681004151268, 2.6760289490863665)): shape (37, 800, 800)
      Valid pixels: 91798/640000 (14.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=2083, max=301940, num_faces=301978
      Valid probs shape: (37, 91798)
    ✓ Random_29 (pose=(-0.9256234343063579, 2.561230957090171, -1.373681779495384)): shape (37, 800, 800)
      Valid pixels: 69986/640000 (10.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=869, max=301975, num_faces=301978
      Valid probs shape: (37, 69986)
    P stats: min=0.0000, max=0.9999, mean=0.0248
    Non-zero vertices: 138487/150991
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 12504  1016  1230  2686     0  2249   941  4470  7345]
  Ground Truth Stats:
    Labels shape: (150991,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/HLN-12-3/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7480
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8034
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8038

  RESULTS:
  RAW:         median(top-10)=0.8969, mean(top-10)=0.8989, median(all)=0.7961, mean(all)=0.7480
  + SMOOTHING: median(top-10)=0.9287, mean(top-10)=0.9283, median(all)=0.8737, mean(all)=0.8034 [+0.0318]
  + MRF:       median(top-10)=0.9292, mean(top-10)=0.9286, median(all)=0.8742, mean(all)=0.8038 [+0.0005]
  TOTAL IMPROVEMENT (median top-10): +0.0323

================================================================================
Subject: HLN-12-4
================================================================================
  Step 0: Generating predictions with V2 model (30 random views)...
  Mesh: 137751 vertices, 275498 faces
  Generating 30 random views...
  Generating predictions for 30 views (continuous camera pose)...
    ✓ Random_0 (pose=(-2.2184747720574354, -1.8973835837121902, -0.6591743361235767)): shape (37, 800, 800)
      Valid pixels: 74245/640000 (11.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=275424, num_faces=275498
      Valid probs shape: (37, 74245)
    ✓ Random_1 (pose=(-0.19199857071175952, -0.9190209090651118, 2.2606573132729517)): shape (37, 800, 800)
      Valid pixels: 76557/640000 (12.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=275497, num_faces=275498
      Valid probs shape: (37, 76557)
    ✓ Random_2 (pose=(2.7521300036278493, 0.5540361096800503, 1.5885023927615913)): shape (37, 800, 800)
      Valid pixels: 64418/640000 (10.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=178, max=275493, num_faces=275498
      Valid probs shape: (37, 64418)
    ✓ Random_3 (pose=(2.9304479248544535, 1.0008981975908888, -1.2177271802411993)): shape (37, 800, 800)
      Valid pixels: 76159/640000 (11.9%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=1896, max=275495, num_faces=275498
      Valid probs shape: (37, 76159)
    ✓ Random_4 (pose=(1.4830895846908598, -2.1987754853690475, 0.755670384953596)): shape (37, 800, 800)
      Valid pixels: 81070/640000 (12.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=49, max=275496, num_faces=275498
      Valid probs shape: (37, 81070)
    ✓ Random_5 (pose=(-2.580656584225161, 0.4525614551040942, 2.0824410516924274)): shape (37, 800, 800)
      Valid pixels: 76629/640000 (12.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=106, max=275497, num_faces=275498
      Valid probs shape: (37, 76629)
    ✓ Random_6 (pose=(-0.002692967031145077, -2.135339810225134, 2.293920955921191)): shape (37, 800, 800)
      Valid pixels: 74201/640000 (11.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=112, max=275497, num_faces=275498
      Valid probs shape: (37, 74201)
    ✓ Random_7 (pose=(0.48163405521408365, -0.6134027117196492, -0.029345280809596197)): shape (37, 800, 800)
      Valid pixels: 68481/640000 (10.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=275491, num_faces=275498
      Valid probs shape: (37, 68481)
    ✓ Random_8 (pose=(0.9011909284853337, 2.004651608067822, 0.69938683428727)): shape (37, 800, 800)
      Valid pixels: 64070/640000 (10.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=114, max=275496, num_faces=275498
      Valid probs shape: (37, 64070)
    ✓ Random_9 (pose=(3.0708635555573958, -2.4783499919120606, 0.9296734347355944)): shape (37, 800, 800)
      Valid pixels: 72511/640000 (11.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=275421, num_faces=275498
      Valid probs shape: (37, 72511)
    ✓ Random_10 (pose=(-1.5814776171101128, -0.7908088368225594, 3.021994675370422)): shape (37, 800, 800)
      Valid pixels: 103524/640000 (16.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=275493, num_faces=275498
      Valid probs shape: (37, 103524)
    ✓ Random_11 (pose=(3.115216958111044, -0.6562192891321916, -3.031089153006774)): shape (37, 800, 800)
      Valid pixels: 54020/640000 (8.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3208, max=275497, num_faces=275498
      Valid probs shape: (37, 54020)
    ✓ Random_12 (pose=(-1.7173852579141176, -1.5113419852479912, -2.0548229049893716)): shape (37, 800, 800)
      Valid pixels: 74553/640000 (11.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=48, max=275497, num_faces=275498
      Valid probs shape: (37, 74553)
    ✓ Random_13 (pose=(0.8535179152258099, 2.924070343210679, 1.488553777487466)): shape (37, 800, 800)
      Valid pixels: 59469/640000 (9.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=21566, max=275423, num_faces=275498
      Valid probs shape: (37, 59469)
    ✓ Random_14 (pose=(-0.39957315108517877, -0.8401973149694095, 2.8102795799187943)): shape (37, 800, 800)
      Valid pixels: 70730/640000 (11.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=275497, num_faces=275498
      Valid probs shape: (37, 70730)
    ✓ Random_15 (pose=(-3.0960430128180034, -1.2229529330933144, 1.833903300780796)): shape (37, 800, 800)
      Valid pixels: 84922/640000 (13.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1453, max=275495, num_faces=275498
      Valid probs shape: (37, 84922)
    ✓ Random_16 (pose=(-1.0754452293607537, -0.8096747425921076, 2.6527977000971825)): shape (37, 800, 800)
      Valid pixels: 96774/640000 (15.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=275493, num_faces=275498
      Valid probs shape: (37, 96774)
    ✓ Random_17 (pose=(2.993374348483411, 3.0647023632545762, -0.9245397738357739)): shape (37, 800, 800)
      Valid pixels: 43214/640000 (6.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=274736, num_faces=275498
      Valid probs shape: (37, 43214)
    ✓ Random_18 (pose=(2.6064491191134724, -0.07197597245573073, 0.8410625244793302)): shape (37, 800, 800)
      Valid pixels: 56386/640000 (8.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=485, max=275497, num_faces=275498
      Valid probs shape: (37, 56386)
    ✓ Random_19 (pose=(2.9143521837033637, -0.9485259157977644, 2.000924955762045)): shape (37, 800, 800)
      Valid pixels: 84188/640000 (13.2%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=1979, max=275494, num_faces=275498
      Valid probs shape: (37, 84188)
    ✓ Random_20 (pose=(3.1233483718405237, -2.980188195655473, -1.4993842899319332)): shape (37, 800, 800)
      Valid pixels: 45050/640000 (7.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=275474, num_faces=275498
      Valid probs shape: (37, 45050)
    ✓ Random_21 (pose=(-0.5786564936424123, 1.5671403065511944, 1.4185698262650908)): shape (37, 800, 800)
      Valid pixels: 82689/640000 (12.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=9, max=275495, num_faces=275498
      Valid probs shape: (37, 82689)
    ✓ Random_22 (pose=(-0.7861134749618075, -0.9823888315326896, -0.1715778243415711)): shape (37, 800, 800)
      Valid pixels: 76775/640000 (12.0%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=4, max=275452, num_faces=275498
      Valid probs shape: (37, 76775)
    ✓ Random_23 (pose=(2.389349682920199, 0.9755213429842602, -0.4520677063144207)): shape (37, 800, 800)
      Valid pixels: 79578/640000 (12.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=243, max=275497, num_faces=275498
      Valid probs shape: (37, 79578)
    ✓ Random_24 (pose=(-2.3147256932957267, -0.7556831754017259, -2.7352978883077186)): shape (37, 800, 800)
      Valid pixels: 93509/640000 (14.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=91, max=275496, num_faces=275498
      Valid probs shape: (37, 93509)
    ✓ Random_25 (pose=(1.1062479570022408, 1.3133380716003389, 0.9456756329994107)): shape (37, 800, 800)
      Valid pixels: 62645/640000 (9.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=9, max=275492, num_faces=275498
      Valid probs shape: (37, 62645)
    ✓ Random_26 (pose=(-1.2426748575856008, -1.813206145499434, -0.9283903571484795)): shape (37, 800, 800)
      Valid pixels: 97542/640000 (15.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=32, max=275424, num_faces=275498
      Valid probs shape: (37, 97542)
    ✓ Random_27 (pose=(0.5697981568324106, 3.0900452388272255, 1.8327359358219804)): shape (37, 800, 800)
      Valid pixels: 59963/640000 (9.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=56550, max=275424, num_faces=275498
      Valid probs shape: (37, 59963)
    ✓ Random_28 (pose=(1.6615862573988762, -0.8534939535196564, -2.467047890013212)): shape (37, 800, 800)
      Valid pixels: 76887/640000 (12.0%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=1, max=275495, num_faces=275498
      Valid probs shape: (37, 76887)
    ✓ Random_29 (pose=(1.0383478169433173, -0.3060632613507801, 0.06814250916820708)): shape (37, 800, 800)
      Valid pixels: 90076/640000 (14.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=275497, num_faces=275498
      Valid probs shape: (37, 90076)
    P stats: min=0.0000, max=0.9999, mean=0.0254
    Non-zero vertices: 129467/137751
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 8284 1242 1153 3870    0 2491 1019 4479 6781]
  Ground Truth Stats:
    Labels shape: (137751,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/HLN-12-4/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7581
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8093
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8093

  RESULTS:
  RAW:         median(top-10)=0.8977, mean(top-10)=0.9001, median(all)=0.8389, mean(all)=0.7581
  + SMOOTHING: median(top-10)=0.9237, mean(top-10)=0.9229, median(all)=0.8705, mean(all)=0.8093 [+0.0260]
  + MRF:       median(top-10)=0.9239, mean(top-10)=0.9231, median(all)=0.8709, mean(all)=0.8093 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0262

================================================================================
Subject: HLN-12-5
================================================================================
  Step 0: Generating predictions with V2 model (30 random views)...
  Mesh: 167182 vertices, 334360 faces
  Generating 30 random views...
  Generating predictions for 30 views (continuous camera pose)...
    ✓ Random_0 (pose=(1.3612773436036543, 0.8465608481068285, 0.0722431624810107)): shape (37, 800, 800)
      Valid pixels: 111171/640000 (17.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8, max=334330, num_faces=334360
      Valid probs shape: (37, 111171)
    ✓ Random_1 (pose=(-2.455973284905955, 2.0114987883601128, -2.818008045379149)): shape (37, 800, 800)
      Valid pixels: 83482/640000 (13.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=333737, num_faces=334360
      Valid probs shape: (37, 83482)
    ✓ Random_2 (pose=(-2.764705163061502, -1.0498118853030665, 1.5739656117680187)): shape (37, 800, 800)
      Valid pixels: 96900/640000 (15.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1638, max=334359, num_faces=334360
      Valid probs shape: (37, 96900)
    ✓ Random_3 (pose=(-2.9152638895429392, -1.0125346941230648, -2.8395615596861443)): shape (37, 800, 800)
      Valid pixels: 100450/640000 (15.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=105, max=334357, num_faces=334360
      Valid probs shape: (37, 100450)
    ✓ Random_4 (pose=(0.4741975440646633, -2.6050900278797213, 1.701009446017376)): shape (37, 800, 800)
      Valid pixels: 71250/640000 (11.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=179, max=334352, num_faces=334360
      Valid probs shape: (37, 71250)
    ✓ Random_5 (pose=(2.3759863849960166, -1.2933209206060594, -2.2729086840723625)): shape (37, 800, 800)
      Valid pixels: 83491/640000 (13.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=105, max=334357, num_faces=334360
      Valid probs shape: (37, 83491)
    ✓ Random_6 (pose=(1.2936835322408466, -0.847994070197994, -1.213931509623436)): shape (37, 800, 800)
      Valid pixels: 79345/640000 (12.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=37, max=334357, num_faces=334360
      Valid probs shape: (37, 79345)
    ✓ Random_7 (pose=(-2.2717085111363806, 0.716366276549341, 2.1927331851367677)): shape (37, 800, 800)
      Valid pixels: 114046/640000 (17.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=28, max=334357, num_faces=334360
      Valid probs shape: (37, 114046)
    ✓ Random_8 (pose=(-3.0250774196094183, 0.8300329142949483, 2.2589080923515183)): shape (37, 800, 800)
      Valid pixels: 82942/640000 (13.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=64, max=334355, num_faces=334360
      Valid probs shape: (37, 82942)
    ✓ Random_9 (pose=(-3.0424976392665126, 3.141160862675564, -0.593332104972514)): shape (37, 800, 800)
      Valid pixels: 62369/640000 (9.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=333779, num_faces=334360
      Valid probs shape: (37, 62369)
    ✓ Random_10 (pose=(2.900696138651319, -1.469113430874096, -1.3156452260872273)): shape (37, 800, 800)
      Valid pixels: 118765/640000 (18.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=334339, num_faces=334360
      Valid probs shape: (37, 118765)
    ✓ Random_11 (pose=(0.8629390243087043, 0.41289585277192753, 0.12600508459923487)): shape (37, 800, 800)
      Valid pixels: 93235/640000 (14.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=334321, num_faces=334360
      Valid probs shape: (37, 93235)
    ✓ Random_12 (pose=(1.95151714637357, -0.6159080576088085, -1.4084018132023204)): shape (37, 800, 800)
      Valid pixels: 97383/640000 (15.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=105, max=334358, num_faces=334360
      Valid probs shape: (37, 97383)
    ✓ Random_13 (pose=(2.6546573309367094, -0.8522924784149248, 2.0351998678991707)): shape (37, 800, 800)
      Valid pixels: 104742/640000 (16.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=8093, max=334359, num_faces=334360
      Valid probs shape: (37, 104742)
    ✓ Random_14 (pose=(-1.8173901966800885, 2.0622131172406846, -3.121760515775152)): shape (37, 800, 800)
      Valid pixels: 111142/640000 (17.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8, max=334330, num_faces=334360
      Valid probs shape: (37, 111142)
    ✓ Random_15 (pose=(-0.656788371174684, -1.0766615650154319, -2.7169207985848)): shape (37, 800, 800)
      Valid pixels: 80702/640000 (12.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=333737, num_faces=334360
      Valid probs shape: (37, 80702)
    ✓ Random_16 (pose=(2.6737643995476077, -1.376562504848752, 1.0595305661083572)): shape (37, 800, 800)
      Valid pixels: 103240/640000 (16.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=2406, max=334358, num_faces=334360
      Valid probs shape: (37, 103240)
    ✓ Random_17 (pose=(0.013374942396551681, 1.6734075686503154, -1.1931576230495669)): shape (37, 800, 800)
      Valid pixels: 106238/640000 (16.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=334330, num_faces=334360
      Valid probs shape: (37, 106238)
    ✓ Random_18 (pose=(0.8480673170323527, -2.045653104154164, 1.5897233215264928)): shape (37, 800, 800)
      Valid pixels: 88645/640000 (13.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=2, max=333737, num_faces=334360
      Valid probs shape: (37, 88645)
    ✓ Random_19 (pose=(-0.08635545972047742, -1.1857089229018276, 2.612132847268093)): shape (37, 800, 800)
      Valid pixels: 88426/640000 (13.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=333737, num_faces=334360
      Valid probs shape: (37, 88426)
    ✓ Random_20 (pose=(-1.5639152231464133, -1.3946785116323384, 1.0671820888296617)): shape (37, 800, 800)
      Valid pixels: 87765/640000 (13.7%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=130, max=334359, num_faces=334360
      Valid probs shape: (37, 87765)
    ✓ Random_21 (pose=(-0.4173714948751259, -1.5104967385576276, -0.746329714272306)): shape (37, 800, 800)
      Valid pixels: 96798/640000 (15.1%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=15, max=334358, num_faces=334360
      Valid probs shape: (37, 96798)
    ✓ Random_22 (pose=(2.4955405377363755, -1.04895908249416, -0.7112819897394806)): shape (37, 800, 800)
      Valid pixels: 107376/640000 (16.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=33, max=334352, num_faces=334360
      Valid probs shape: (37, 107376)
    ✓ Random_23 (pose=(-0.00642010047624364, 2.072358843541365, -0.631141142605331)): shape (37, 800, 800)
      Valid pixels: 83633/640000 (13.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=84, max=333737, num_faces=334360
      Valid probs shape: (37, 83633)
    ✓ Random_24 (pose=(0.5927782409502322, 0.9707556373418997, 0.2161946395309604)): shape (37, 800, 800)
      Valid pixels: 83061/640000 (13.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=333737, num_faces=334360
      Valid probs shape: (37, 83061)
    ✓ Random_25 (pose=(-0.673471287492629, -2.4338320663648823, 2.1136572339770705)): shape (37, 800, 800)
      Valid pixels: 107896/640000 (16.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=105, max=334357, num_faces=334360
      Valid probs shape: (37, 107896)
    ✓ Random_26 (pose=(1.2963904025575976, -0.1053744024916301, 2.4882770956500044)): shape (37, 800, 800)
      Valid pixels: 111509/640000 (17.4%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=2, max=333055, num_faces=334360
      Valid probs shape: (37, 111509)
    ✓ Random_27 (pose=(-1.3517313675328735, 1.6204772655531627, 2.4299521960365826)): shape (37, 800, 800)
      Valid pixels: 110381/640000 (17.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=12, max=334356, num_faces=334360
      Valid probs shape: (37, 110381)
    ✓ Random_28 (pose=(2.0638502718936405, -0.7682139462557238, -0.6932384173885207)): shape (37, 800, 800)
      Valid pixels: 119493/640000 (18.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=51, max=334357, num_faces=334360
      Valid probs shape: (37, 119493)
    ✓ Random_29 (pose=(-1.9619510206070276, -2.444386752130481, 1.9314584156951327)): shape (37, 800, 800)
      Valid pixels: 76192/640000 (11.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=24, max=334356, num_faces=334360
      Valid probs shape: (37, 76192)
    P stats: min=0.0000, max=0.9997, mean=0.0244
    Non-zero vertices: 150648/167182
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 16534  1030  1662  3373     0  2523  1238  5479  7052]
  Ground Truth Stats:
    Labels shape: (167182,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/HLN-12-5/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7450
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8080
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8083

  RESULTS:
  RAW:         median(top-10)=0.8787, mean(top-10)=0.8892, median(all)=0.8072, mean(all)=0.7450
  + SMOOTHING: median(top-10)=0.9255, mean(top-10)=0.9260, median(all)=0.8590, mean(all)=0.8080 [+0.0468]
  + MRF:       median(top-10)=0.9258, mean(top-10)=0.9263, median(all)=0.8602, mean(all)=0.8083 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0470

================================================================================
Subject: HLN-12-6
================================================================================
  Step 0: Generating predictions with V2 model (30 random views)...
  Mesh: 149409 vertices, 298814 faces
  Generating 30 random views...
  Generating predictions for 30 views (continuous camera pose)...
    ✓ Random_0 (pose=(-2.7253358386180917, -1.9402706822414348, -1.169973945793774)): shape (37, 800, 800)
      Valid pixels: 74699/640000 (11.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=298807, num_faces=298814
      Valid probs shape: (37, 74699)
    ✓ Random_1 (pose=(-1.0794025276631447, 2.149243018586822, 1.8098348073593113)): shape (37, 800, 800)
      Valid pixels: 67958/640000 (10.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=215, max=298810, num_faces=298814
      Valid probs shape: (37, 67958)
    ✓ Random_2 (pose=(0.708073643744036, -0.27632820792421553, -1.7606698751334506)): shape (37, 800, 800)
      Valid pixels: 61787/640000 (9.7%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=1, max=298534, num_faces=298814
      Valid probs shape: (37, 61787)
    ✓ Random_3 (pose=(0.7183960308026123, -2.556869584010515, -0.5558939236515323)): shape (37, 800, 800)
      Valid pixels: 76102/640000 (11.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=247, max=298813, num_faces=298814
      Valid probs shape: (37, 76102)
    ✓ Random_4 (pose=(0.3154190075592198, -2.1429639375136675, -2.681785626206193)): shape (37, 800, 800)
      Valid pixels: 90647/640000 (14.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1195, max=298812, num_faces=298814
      Valid probs shape: (37, 90647)
    ✓ Random_5 (pose=(2.18140711382914, 2.0270703337695473, -1.9450792632903473)): shape (37, 800, 800)
      Valid pixels: 78952/640000 (12.3%)
      Probs stats: min=0.0000, max=0.9995, mean=0.0270
      Face IDs: min=8, max=298813, num_faces=298814
      Valid probs shape: (37, 78952)
    ✓ Random_6 (pose=(3.094026567970613, 0.9898032977171001, -0.44804036916017553)): shape (37, 800, 800)
      Valid pixels: 67292/640000 (10.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=794, max=298812, num_faces=298814
      Valid probs shape: (37, 67292)
    ✓ Random_7 (pose=(-0.6747210161475157, -2.4022708204470984, -2.6808032152269763)): shape (37, 800, 800)
      Valid pixels: 65507/640000 (10.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1282, max=298813, num_faces=298814
      Valid probs shape: (37, 65507)
    ✓ Random_8 (pose=(-1.2182340260135054, 1.371230356803908, 3.079552169942189)): shape (37, 800, 800)
      Valid pixels: 108468/640000 (16.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=298812, num_faces=298814
      Valid probs shape: (37, 108468)
    ✓ Random_9 (pose=(0.7834242117158627, 2.4407045211510967, -0.8909133885755214)): shape (37, 800, 800)
      Valid pixels: 96513/640000 (15.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=298813, num_faces=298814
      Valid probs shape: (37, 96513)
    ✓ Random_10 (pose=(-2.028307886109305, 1.2724717777271097, 2.364434088601077)): shape (37, 800, 800)
      Valid pixels: 108953/640000 (17.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=298813, num_faces=298814
      Valid probs shape: (37, 108953)
    ✓ Random_11 (pose=(1.205028008821924, 0.6320586029276787, 2.346967833878777)): shape (37, 800, 800)
      Valid pixels: 100368/640000 (15.7%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=6, max=298804, num_faces=298814
      Valid probs shape: (37, 100368)
    ✓ Random_12 (pose=(2.470592370333561, -2.6858802575488303, 0.3764357237395961)): shape (37, 800, 800)
      Valid pixels: 64520/640000 (10.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=298698, num_faces=298814
      Valid probs shape: (37, 64520)
    ✓ Random_13 (pose=(1.4804613995158071, -0.7229106767356983, 0.761323338209579)): shape (37, 800, 800)
      Valid pixels: 81982/640000 (12.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=298804, num_faces=298814
      Valid probs shape: (37, 81982)
    ✓ Random_14 (pose=(1.602056179866814, 1.2005870312159308, -0.32079984312488197)): shape (37, 800, 800)
      Valid pixels: 109318/640000 (17.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8, max=298812, num_faces=298814
      Valid probs shape: (37, 109318)
    ✓ Random_15 (pose=(-0.028913312138768354, -2.4992998119212153, 2.2216245373292187)): shape (37, 800, 800)
      Valid pixels: 65748/640000 (10.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=244, max=298813, num_faces=298814
      Valid probs shape: (37, 65748)
    ✓ Random_16 (pose=(-1.609867800967977, -0.678767489343246, -2.9383656751202776)): shape (37, 800, 800)
      Valid pixels: 101277/640000 (15.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=11, max=298812, num_faces=298814
      Valid probs shape: (37, 101277)
    ✓ Random_17 (pose=(-1.0618736133766529, 0.3679810984213985, 1.5582291647028548)): shape (37, 800, 800)
      Valid pixels: 62435/640000 (9.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=298747, num_faces=298814
      Valid probs shape: (37, 62435)
    ✓ Random_18 (pose=(0.8580297666536421, 0.18966230087712743, -1.2467740658416762)): shape (37, 800, 800)
      Valid pixels: 70348/640000 (11.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=298697, num_faces=298814
      Valid probs shape: (37, 70348)
    ✓ Random_19 (pose=(-0.32893814286377543, -2.822073306031239, 1.2292431676759659)): shape (37, 800, 800)
      Valid pixels: 56146/640000 (8.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1261, max=298813, num_faces=298814
      Valid probs shape: (37, 56146)
    ✓ Random_20 (pose=(-2.56220531595643, 1.5396988965427827, -3.064511719260905)): shape (37, 800, 800)
      Valid pixels: 72650/640000 (11.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=298808, num_faces=298814
      Valid probs shape: (37, 72650)
    ✓ Random_21 (pose=(1.6560260369930653, 0.7350876545293206, 1.5387249727708552)): shape (37, 800, 800)
      Valid pixels: 63080/640000 (9.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=298812, num_faces=298814
      Valid probs shape: (37, 63080)
    ✓ Random_22 (pose=(0.2933965660686906, 2.609195397973748, -3.0613354968846065)): shape (37, 800, 800)
      Valid pixels: 59593/640000 (9.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1247, max=298812, num_faces=298814
      Valid probs shape: (37, 59593)
    ✓ Random_23 (pose=(1.9108586876880818, -3.102178484465976, -2.3161557841818663)): shape (37, 800, 800)
      Valid pixels: 73973/640000 (11.6%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=1, max=298753, num_faces=298814
      Valid probs shape: (37, 73973)
    ✓ Random_24 (pose=(1.6955463058768787, 1.751010536369428, -0.9194355488536665)): shape (37, 800, 800)
      Valid pixels: 92048/640000 (14.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=298812, num_faces=298814
      Valid probs shape: (37, 92048)
    ✓ Random_25 (pose=(0.20733757097469852, -2.016755364348919, 2.076935460510591)): shape (37, 800, 800)
      Valid pixels: 78367/640000 (12.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=298813, num_faces=298814
      Valid probs shape: (37, 78367)
    ✓ Random_26 (pose=(2.937553548932824, 1.7378470339759762, 2.5511801357233397)): shape (37, 800, 800)
      Valid pixels: 68534/640000 (10.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=298794, num_faces=298814
      Valid probs shape: (37, 68534)
    ✓ Random_27 (pose=(1.1730106858545897, 1.4707218173537893, 2.726510320776577)): shape (37, 800, 800)
      Valid pixels: 98494/640000 (15.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=4, max=298813, num_faces=298814
      Valid probs shape: (37, 98494)
    ✓ Random_28 (pose=(-1.3529846567363446, -2.2519889391680534, 3.1113910467137718)): shape (37, 800, 800)
      Valid pixels: 101965/640000 (15.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6, max=298813, num_faces=298814
      Valid probs shape: (37, 101965)
    ✓ Random_29 (pose=(-2.0136416188598143, -0.976688589740125, -1.6655939385537488)): shape (37, 800, 800)
      Valid pixels: 71405/640000 (11.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=298812, num_faces=298814
      Valid probs shape: (37, 71405)
    P stats: min=0.0000, max=0.9999, mean=0.0239
    Non-zero vertices: 132180/149409
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 17229  1291  1240  3476     0  2164  1037  6101  6228]
  Ground Truth Stats:
    Labels shape: (149409,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/HLN-12-6/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7337
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8021
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8026

  RESULTS:
  RAW:         median(top-10)=0.8853, mean(top-10)=0.8809, median(all)=0.7911, mean(all)=0.7337
  + SMOOTHING: median(top-10)=0.9188, mean(top-10)=0.9205, median(all)=0.8531, mean(all)=0.8021 [+0.0335]
  + MRF:       median(top-10)=0.9196, mean(top-10)=0.9211, median(all)=0.8538, mean(all)=0.8026 [+0.0008]
  TOTAL IMPROVEMENT (median top-10): +0.0343

================================================================================
Subject: HLN-12-7
================================================================================
  Step 0: Generating predictions with V2 model (30 random views)...
  Mesh: 122042 vertices, 244080 faces
  Generating 30 random views...
  Generating predictions for 30 views (continuous camera pose)...
    ✓ Random_0 (pose=(-2.7513787972611414, 0.10919684134244756, 0.7647570306901534)): shape (37, 800, 800)
      Valid pixels: 56804/640000 (8.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1259, max=244079, num_faces=244080
      Valid probs shape: (37, 56804)
    ✓ Random_1 (pose=(-2.1443230741034354, -0.5163077841030499, 2.3120896235864947)): shape (37, 800, 800)
      Valid pixels: 78262/640000 (12.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=112, max=244079, num_faces=244080
      Valid probs shape: (37, 78262)
    ✓ Random_2 (pose=(-0.09644605957889052, 0.4243228282589566, 0.3209481188844161)): shape (37, 800, 800)
      Valid pixels: 60451/640000 (9.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=242575, num_faces=244080
      Valid probs shape: (37, 60451)
    ✓ Random_3 (pose=(-0.16824145446848338, 2.260649385239284, -0.4561740223337183)): shape (37, 800, 800)
      Valid pixels: 64164/640000 (10.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=244076, num_faces=244080
      Valid probs shape: (37, 64164)
    ✓ Random_4 (pose=(0.03885655301870461, -1.9667939597258597, -2.5291921580017043)): shape (37, 800, 800)
      Valid pixels: 87254/640000 (13.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8464, max=244079, num_faces=244080
      Valid probs shape: (37, 87254)
    ✓ Random_5 (pose=(2.2429488555423225, -1.6104236498396047, 0.4424175650577302)): shape (37, 800, 800)
      Valid pixels: 75031/640000 (11.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=243890, num_faces=244080
      Valid probs shape: (37, 75031)
    ✓ Random_6 (pose=(-2.6839591175832753, -2.6658633214375005, 2.152982516838037)): shape (37, 800, 800)
      Valid pixels: 59747/640000 (9.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=243999, num_faces=244080
      Valid probs shape: (37, 59747)
    ✓ Random_7 (pose=(0.8902343543336366, -2.495422181602809, -0.881325063391988)): shape (37, 800, 800)
      Valid pixels: 70060/640000 (10.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=567, max=244079, num_faces=244080
      Valid probs shape: (37, 70060)
    ✓ Random_8 (pose=(-0.7977099824586777, 2.7957278596103166, -2.4654224573538865)): shape (37, 800, 800)
      Valid pixels: 75984/640000 (11.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=244079, num_faces=244080
      Valid probs shape: (37, 75984)
    ✓ Random_9 (pose=(-0.7578832867486103, 0.10439424935641162, 1.7019431636315296)): shape (37, 800, 800)
      Valid pixels: 60539/640000 (9.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=244000, num_faces=244080
      Valid probs shape: (37, 60539)
    ✓ Random_10 (pose=(1.5671674658646921, -0.7374830919541742, 2.0758538974856506)): shape (37, 800, 800)
      Valid pixels: 85553/640000 (13.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=12, max=244076, num_faces=244080
      Valid probs shape: (37, 85553)
    ✓ Random_11 (pose=(2.5414566554841507, -1.5081825121089631, -1.5619479190132055)): shape (37, 800, 800)
      Valid pixels: 99747/640000 (15.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=244078, num_faces=244080
      Valid probs shape: (37, 99747)
    ✓ Random_12 (pose=(0.17095300561681004, 2.7982442371674097, 2.7664384472998895)): shape (37, 800, 800)
      Valid pixels: 58093/640000 (9.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2487, max=244079, num_faces=244080
      Valid probs shape: (37, 58093)
    ✓ Random_13 (pose=(-1.3427223801217594, 0.9592438401061703, -1.8932953015476375)): shape (37, 800, 800)
      Valid pixels: 75327/640000 (11.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=243892, num_faces=244080
      Valid probs shape: (37, 75327)
    ✓ Random_14 (pose=(1.6969435575771419, -0.8605589166942846, 2.32011279843453)): shape (37, 800, 800)
      Valid pixels: 92854/640000 (14.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=244076, num_faces=244080
      Valid probs shape: (37, 92854)
    ✓ Random_15 (pose=(2.6787944010079032, -0.6467981813201629, 1.7013292805934332)): shape (37, 800, 800)
      Valid pixels: 81242/640000 (12.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=17115, max=244079, num_faces=244080
      Valid probs shape: (37, 81242)
    ✓ Random_16 (pose=(-1.858925843313338, -0.8918398634833173, 1.8470812942390493)): shape (37, 800, 800)
      Valid pixels: 70761/640000 (11.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=59, max=244079, num_faces=244080
      Valid probs shape: (37, 70761)
    ✓ Random_17 (pose=(-1.0617388704065251, -1.198648000708514, -2.359650682620526)): shape (37, 800, 800)
      Valid pixels: 71450/640000 (11.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=243889, num_faces=244080
      Valid probs shape: (37, 71450)
    ✓ Random_18 (pose=(3.081182319716892, 3.107967945332903, -1.2490871758552384)): shape (37, 800, 800)
      Valid pixels: 48537/640000 (7.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=243759, num_faces=244080
      Valid probs shape: (37, 48537)
    ✓ Random_19 (pose=(-1.656470034721663, -0.47554094983321527, 1.4908771945685357)): shape (37, 800, 800)
      Valid pixels: 71532/640000 (11.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=44, max=244078, num_faces=244080
      Valid probs shape: (37, 71532)
    ✓ Random_20 (pose=(2.26652373047013, 0.3081570765790609, -1.2841516938046251)): shape (37, 800, 800)
      Valid pixels: 64889/640000 (10.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=708, max=244079, num_faces=244080
      Valid probs shape: (37, 64889)
    ✓ Random_21 (pose=(1.0184925431363236, -2.6576761467082024, 0.8211969137477539)): shape (37, 800, 800)
      Valid pixels: 79791/640000 (12.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=244076, num_faces=244080
      Valid probs shape: (37, 79791)
    ✓ Random_22 (pose=(-2.450364597820229, -2.9882549063091326, 2.9249675097303154)): shape (37, 800, 800)
      Valid pixels: 72898/640000 (11.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=243977, num_faces=244080
      Valid probs shape: (37, 72898)
    ✓ Random_23 (pose=(0.04570314169433365, 2.843030273011993, 1.9185449441714226)): shape (37, 800, 800)
      Valid pixels: 59198/640000 (9.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=24621, max=244079, num_faces=244080
      Valid probs shape: (37, 59198)
    ✓ Random_24 (pose=(0.8997655319697966, -2.4684876420136543, 0.13824525019494516)): shape (37, 800, 800)
      Valid pixels: 93180/640000 (14.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=244078, num_faces=244080
      Valid probs shape: (37, 93180)
    ✓ Random_25 (pose=(2.1290574715911097, 0.022599480365951496, -1.3507517427871911)): shape (37, 800, 800)
      Valid pixels: 68828/640000 (10.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=263, max=244079, num_faces=244080
      Valid probs shape: (37, 68828)
    ✓ Random_26 (pose=(1.6490802734535928, -1.9119439367585092, -1.1208393073237937)): shape (37, 800, 800)
      Valid pixels: 87350/640000 (13.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=30, max=244078, num_faces=244080
      Valid probs shape: (37, 87350)
    ✓ Random_27 (pose=(-2.126111306421082, -0.7604782455832892, 0.07758578690732554)): shape (37, 800, 800)
      Valid pixels: 90355/640000 (14.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1047, max=244079, num_faces=244080
      Valid probs shape: (37, 90355)
    ✓ Random_28 (pose=(-3.0167806215010873, 3.0231159694020358, -0.0481828837283631)): shape (37, 800, 800)
      Valid pixels: 53267/640000 (8.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=243759, num_faces=244080
      Valid probs shape: (37, 53267)
    ✓ Random_29 (pose=(-0.6786737997243093, 1.5188106235584717, -0.11751586145056692)): shape (37, 800, 800)
      Valid pixels: 87496/640000 (13.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=3, max=244076, num_faces=244080
      Valid probs shape: (37, 87496)
    P stats: min=0.0000, max=0.9999, mean=0.0243
    Non-zero vertices: 109917/122042
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 12125   596  1142  3441     0  1995   869  4080  4070]
  Ground Truth Stats:
    Labels shape: (122042,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/HLN-12-7/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7544
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8078
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8083

  RESULTS:
  RAW:         median(top-10)=0.8703, mean(top-10)=0.8766, median(all)=0.8183, mean(all)=0.7544
  + SMOOTHING: median(top-10)=0.9067, mean(top-10)=0.9082, median(all)=0.8603, mean(all)=0.8078 [+0.0365]
  + MRF:       median(top-10)=0.9081, mean(top-10)=0.9089, median(all)=0.8606, mean(all)=0.8083 [+0.0014]
  TOTAL IMPROVEMENT (median top-10): +0.0378

================================================================================
Subject: HLN-12-8
================================================================================
  Step 0: Generating predictions with V2 model (30 random views)...
  Mesh: 163705 vertices, 327406 faces
  Generating 30 random views...
  Generating predictions for 30 views (continuous camera pose)...
    ✓ Random_0 (pose=(0.16970846991720867, 2.351945160390838, -2.7657847985384567)): shape (37, 800, 800)
      Valid pixels: 58455/640000 (9.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=951, max=327388, num_faces=327406
      Valid probs shape: (37, 58455)
    ✓ Random_1 (pose=(0.4417541379287382, -0.8082918445823215, 2.925451796494821)): shape (37, 800, 800)
      Valid pixels: 66961/640000 (10.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=327314, num_faces=327406
      Valid probs shape: (37, 66961)
    ✓ Random_2 (pose=(0.1520864178668644, -0.9602040719060563, -0.14655712941004717)): shape (37, 800, 800)
      Valid pixels: 55819/640000 (8.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=327191, num_faces=327406
      Valid probs shape: (37, 55819)
    ✓ Random_3 (pose=(-2.9268549288303234, -0.1441338831316088, -2.909616666990603)): shape (37, 800, 800)
      Valid pixels: 43456/640000 (6.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4062, max=327405, num_faces=327406
      Valid probs shape: (37, 43456)
    ✓ Random_4 (pose=(-2.136068902377895, 0.46377944850522823, 2.2626084515780214)): shape (37, 800, 800)
      Valid pixels: 90051/640000 (14.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=327273, num_faces=327406
      Valid probs shape: (37, 90051)
    ✓ Random_5 (pose=(2.853394710909292, -2.328141006884733, -0.8736975446844077)): shape (37, 800, 800)
      Valid pixels: 76792/640000 (12.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=327248, num_faces=327406
      Valid probs shape: (37, 76792)
    ✓ Random_6 (pose=(0.7693756388394433, 1.9123265735511241, 1.9612600533291111)): shape (37, 800, 800)
      Valid pixels: 96712/640000 (15.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=208, max=327404, num_faces=327406
      Valid probs shape: (37, 96712)
    ✓ Random_7 (pose=(0.022157466148734706, -1.1673880690491867, 0.11618447563390655)): shape (37, 800, 800)
      Valid pixels: 61504/640000 (9.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=327265, num_faces=327406
      Valid probs shape: (37, 61504)
    ✓ Random_8 (pose=(0.8893119812900885, -0.6960896430867201, 0.008779548010094729)): shape (37, 800, 800)
      Valid pixels: 90899/640000 (14.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=327255, num_faces=327406
      Valid probs shape: (37, 90899)
    ✓ Random_9 (pose=(1.7649778905632303, 2.7254086583780897, 3.104063727417641)): shape (37, 800, 800)
      Valid pixels: 93218/640000 (14.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=327405, num_faces=327406
      Valid probs shape: (37, 93218)
    ✓ Random_10 (pose=(0.03814084252395267, 1.2522156385216396, 1.4658870747088253)): shape (37, 800, 800)
      Valid pixels: 90435/640000 (14.1%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=4, max=327393, num_faces=327406
      Valid probs shape: (37, 90435)
    ✓ Random_11 (pose=(1.4615874059130922, -0.08470212555963208, 0.4624995126016338)): shape (37, 800, 800)
      Valid pixels: 85346/640000 (13.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=327001, num_faces=327406
      Valid probs shape: (37, 85346)
    ✓ Random_12 (pose=(2.6680786580096525, -2.2641385662473064, 2.2715607541876492)): shape (37, 800, 800)
      Valid pixels: 76744/640000 (12.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=5, max=327267, num_faces=327406
      Valid probs shape: (37, 76744)
    ✓ Random_13 (pose=(2.863488897445845, -0.4254130598600345, 1.2499406937747652)): shape (37, 800, 800)
      Valid pixels: 64312/640000 (10.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=14150, max=327405, num_faces=327406
      Valid probs shape: (37, 64312)
    ✓ Random_14 (pose=(-0.31653649046786114, 0.8299158433507077, -2.176406753497326)): shape (37, 800, 800)
      Valid pixels: 83532/640000 (13.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=327271, num_faces=327406
      Valid probs shape: (37, 83532)
    ✓ Random_15 (pose=(0.08286845189085801, -2.711841604368942, -2.891429014731862)): shape (37, 800, 800)
      Valid pixels: 57462/640000 (9.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=49263, max=327405, num_faces=327406
      Valid probs shape: (37, 57462)
    ✓ Random_16 (pose=(0.9661737191372612, 2.112188747160854, -1.980972345848781)): shape (37, 800, 800)
      Valid pixels: 66855/640000 (10.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=48, max=327404, num_faces=327406
      Valid probs shape: (37, 66855)
    ✓ Random_17 (pose=(-1.5222915894319273, 0.6810434459363433, -0.9694053863280923)): shape (37, 800, 800)
      Valid pixels: 86430/640000 (13.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=11, max=327400, num_faces=327406
      Valid probs shape: (37, 86430)
    ✓ Random_18 (pose=(2.5456653513361687, -2.800962047229011, 1.6779790178578153)): shape (37, 800, 800)
      Valid pixels: 63914/640000 (10.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=327314, num_faces=327406
      Valid probs shape: (37, 63914)
    ✓ Random_19 (pose=(-2.5086451631575377, 1.4281368424308765, -2.9082184212328372)): shape (37, 800, 800)
      Valid pixels: 67634/640000 (10.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=12, max=327404, num_faces=327406
      Valid probs shape: (37, 67634)
    ✓ Random_20 (pose=(2.236252989473975, -1.4134110436037426, 2.63535474716283)): shape (37, 800, 800)
      Valid pixels: 90743/640000 (14.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=15, max=327404, num_faces=327406
      Valid probs shape: (37, 90743)
    ✓ Random_21 (pose=(-2.6554035092818613, 0.7184484031868759, -1.3372812590727674)): shape (37, 800, 800)
      Valid pixels: 85135/640000 (13.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=14025, max=327405, num_faces=327406
      Valid probs shape: (37, 85135)
    ✓ Random_22 (pose=(2.301057749602225, -1.8723521384387367, -3.033206554762956)): shape (37, 800, 800)
      Valid pixels: 71417/640000 (11.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=23, max=327389, num_faces=327406
      Valid probs shape: (37, 71417)
    ✓ Random_23 (pose=(-0.31908773522708556, 1.0752779311308807, -2.913559275492058)): shape (37, 800, 800)
      Valid pixels: 80285/640000 (12.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=327213, num_faces=327406
      Valid probs shape: (37, 80285)
    ✓ Random_24 (pose=(-2.8631227116934337, 2.274991293716626, 1.7522367075576408)): shape (37, 800, 800)
      Valid pixels: 84553/640000 (13.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=327254, num_faces=327406
      Valid probs shape: (37, 84553)
    ✓ Random_25 (pose=(0.7340112486717785, 2.350965046211524, 1.325943482813499)): shape (37, 800, 800)
      Valid pixels: 75942/640000 (11.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=10858, max=327403, num_faces=327406
      Valid probs shape: (37, 75942)
    ✓ Random_26 (pose=(1.662496837728411, 0.8641275355918205, 0.39957023015643856)): shape (37, 800, 800)
      Valid pixels: 89572/640000 (14.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=327002, num_faces=327406
      Valid probs shape: (37, 89572)
    ✓ Random_27 (pose=(1.34330801788692, -0.7588860482041899, 0.731253037067765)): shape (37, 800, 800)
      Valid pixels: 80973/640000 (12.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=327002, num_faces=327406
      Valid probs shape: (37, 80973)
    ✓ Random_28 (pose=(-0.21221775211180427, -0.9827872023159485, -1.7227369044981722)): shape (37, 800, 800)
      Valid pixels: 84471/640000 (13.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=19, max=327388, num_faces=327406
      Valid probs shape: (37, 84471)
    ✓ Random_29 (pose=(2.999254047569335, 2.1726498148156317, -1.1239282564026687)): shape (37, 800, 800)
      Valid pixels: 66535/640000 (10.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=17, max=327268, num_faces=327406
      Valid probs shape: (37, 66535)
    P stats: min=0.0000, max=1.0000, mean=0.0254
    Non-zero vertices: 153951/163705
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 9754 1243 1405 4243    0 2283 1244 5524 7301]
  Ground Truth Stats:
    Labels shape: (163705,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/HLN-12-8/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7728
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8279
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8282

  RESULTS:
  RAW:         median(top-10)=0.8935, mean(top-10)=0.8910, median(all)=0.8274, mean(all)=0.7728
  + SMOOTHING: median(top-10)=0.9098, mean(top-10)=0.9139, median(all)=0.8564, mean(all)=0.8279 [+0.0163]
  + MRF:       median(top-10)=0.9101, mean(top-10)=0.9144, median(all)=0.8577, mean(all)=0.8282 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0166

================================================================================
Subject: HLN-12-9
================================================================================
  Step 0: Generating predictions with V2 model (30 random views)...
  Mesh: 137393 vertices, 274782 faces
  Generating 30 random views...
  Generating predictions for 30 views (continuous camera pose)...
    ✓ Random_0 (pose=(3.0015534269240627, -1.2902416963109458, -1.9869061295735257)): shape (37, 800, 800)
      Valid pixels: 105837/640000 (16.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=83, max=274780, num_faces=274782
      Valid probs shape: (37, 105837)
    ✓ Random_1 (pose=(-2.681191404517357, -2.014527077106644, 0.7063035043993513)): shape (37, 800, 800)
      Valid pixels: 97952/640000 (15.3%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=0, max=274759, num_faces=274782
      Valid probs shape: (37, 97952)
    ✓ Random_2 (pose=(2.420325616536588, 2.6546232512479166, -3.037771792627555)): shape (37, 800, 800)
      Valid pixels: 86403/640000 (13.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=274699, num_faces=274782
      Valid probs shape: (37, 86403)
    ✓ Random_3 (pose=(0.3451420944292285, 0.9102959824392203, -2.766669437797061)): shape (37, 800, 800)
      Valid pixels: 59252/640000 (9.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=274778, num_faces=274782
      Valid probs shape: (37, 59252)
    ✓ Random_4 (pose=(1.9214787282108787, 1.6592907749072516, 0.8346537254356838)): shape (37, 800, 800)
      Valid pixels: 87720/640000 (13.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=274781, num_faces=274782
      Valid probs shape: (37, 87720)
    ✓ Random_5 (pose=(-2.601661842323816, -1.7424595428377545, -1.1807301406875368)): shape (37, 800, 800)
      Valid pixels: 77035/640000 (12.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=274781, num_faces=274782
      Valid probs shape: (37, 77035)
    ✓ Random_6 (pose=(1.4647721457133613, 1.3736267080163662, -1.094837931271242)): shape (37, 800, 800)
      Valid pixels: 97331/640000 (15.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=11, max=274780, num_faces=274782
      Valid probs shape: (37, 97331)
    ✓ Random_7 (pose=(-1.6519839557311713, -2.622907243798509, 3.044835967446348)): shape (37, 800, 800)
      Valid pixels: 107325/640000 (16.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=14, max=274781, num_faces=274782
      Valid probs shape: (37, 107325)
    ✓ Random_8 (pose=(-0.5525699317414388, -2.83405162750093, 0.36545551921327846)): shape (37, 800, 800)
      Valid pixels: 68723/640000 (10.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1845, max=274781, num_faces=274782
      Valid probs shape: (37, 68723)
    ✓ Random_9 (pose=(-1.4514966255878459, -2.1226121382111787, 1.9354200671674455)): shape (37, 800, 800)
      Valid pixels: 92166/640000 (14.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=13, max=274780, num_faces=274782
      Valid probs shape: (37, 92166)
    ✓ Random_10 (pose=(0.8388633401685275, 1.3047317739986521, 0.40708116482994283)): shape (37, 800, 800)
      Valid pixels: 73191/640000 (11.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=274781, num_faces=274782
      Valid probs shape: (37, 73191)
    ✓ Random_11 (pose=(-1.813867390073659, 0.8141080113186612, 0.6873204596970219)): shape (37, 800, 800)
      Valid pixels: 77360/640000 (12.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=26, max=274778, num_faces=274782
      Valid probs shape: (37, 77360)
    ✓ Random_12 (pose=(2.686341326954751, 0.9764519684314568, -1.5068310960915272)): shape (37, 800, 800)
      Valid pixels: 79555/640000 (12.4%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=814, max=274781, num_faces=274782
      Valid probs shape: (37, 79555)
    ✓ Random_13 (pose=(-0.8249536180599826, 1.9507067962565037, 2.562147005236687)): shape (37, 800, 800)
      Valid pixels: 83321/640000 (13.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=202, max=274780, num_faces=274782
      Valid probs shape: (37, 83321)
    ✓ Random_14 (pose=(-0.8248037482007033, 2.4636544174483603, 1.5693540126624637)): shape (37, 800, 800)
      Valid pixels: 73731/640000 (11.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=319, max=274781, num_faces=274782
      Valid probs shape: (37, 73731)
    ✓ Random_15 (pose=(2.1654346053764675, -1.3828403117560284, 0.6906731434219799)): shape (37, 800, 800)
      Valid pixels: 70293/640000 (11.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=274781, num_faces=274782
      Valid probs shape: (37, 70293)
    ✓ Random_16 (pose=(-1.8228682088369548, 1.9367544027850068, 1.8921059884516698)): shape (37, 800, 800)
      Valid pixels: 95455/640000 (14.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=274773, num_faces=274782
      Valid probs shape: (37, 95455)
    ✓ Random_17 (pose=(0.12315198259948446, -0.5124789817763249, -0.6673184829972869)): shape (37, 800, 800)
      Valid pixels: 54062/640000 (8.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=0, max=274776, num_faces=274782
      Valid probs shape: (37, 54062)
    ✓ Random_18 (pose=(1.156200031880375, -0.0754803697526536, 0.31554596660286727)): shape (37, 800, 800)
      Valid pixels: 90329/640000 (14.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=274781, num_faces=274782
      Valid probs shape: (37, 90329)
    ✓ Random_19 (pose=(-0.8771342804842894, -1.4143762061981302, -0.6066349113514189)): shape (37, 800, 800)
      Valid pixels: 94022/640000 (14.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=10, max=274775, num_faces=274782
      Valid probs shape: (37, 94022)
    ✓ Random_20 (pose=(-0.8976064525833753, 2.1319090989961467, -1.8330706579223968)): shape (37, 800, 800)
      Valid pixels: 77784/640000 (12.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=109, max=274781, num_faces=274782
      Valid probs shape: (37, 77784)
    ✓ Random_21 (pose=(-0.42450559060336257, -0.4053689887068157, -2.112088394571539)): shape (37, 800, 800)
      Valid pixels: 61329/640000 (9.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=274759, num_faces=274782
      Valid probs shape: (37, 61329)
    ✓ Random_22 (pose=(-0.5836958888820707, -1.3943524941036638, 0.8970386106759092)): shape (37, 800, 800)
      Valid pixels: 81201/640000 (12.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=274776, num_faces=274782
      Valid probs shape: (37, 81201)
    ✓ Random_23 (pose=(-0.0522542319593855, -2.8900455946375847, 2.9042352222575447)): shape (37, 800, 800)
      Valid pixels: 47020/640000 (7.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3959, max=274781, num_faces=274782
      Valid probs shape: (37, 47020)
    ✓ Random_24 (pose=(1.6667111246654365, 0.3824484838546236, 2.7022735561432336)): shape (37, 800, 800)
      Valid pixels: 104057/640000 (16.3%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=1, max=274759, num_faces=274782
      Valid probs shape: (37, 104057)
    ✓ Random_25 (pose=(1.556882937049882, 0.09617944134513312, 1.560014882656171)): shape (37, 800, 800)
      Valid pixels: 67820/640000 (10.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=274759, num_faces=274782
      Valid probs shape: (37, 67820)
    ✓ Random_26 (pose=(1.326664303674355, -0.04365728836856153, -2.156961529859284)): shape (37, 800, 800)
      Valid pixels: 72793/640000 (11.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=274780, num_faces=274782
      Valid probs shape: (37, 72793)
    ✓ Random_27 (pose=(-0.4014347916616985, 2.0671716840491667, 1.9149618714450867)): shape (37, 800, 800)
      Valid pixels: 77308/640000 (12.1%)
      Probs stats: min=0.0000, max=0.9995, mean=0.0270
      Face IDs: min=625, max=274781, num_faces=274782
      Valid probs shape: (37, 77308)
    ✓ Random_28 (pose=(-2.816883136938148, 1.7954300321752736, -2.8905688363361715)): shape (37, 800, 800)
      Valid pixels: 67004/640000 (10.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=274759, num_faces=274782
      Valid probs shape: (37, 67004)
    ✓ Random_29 (pose=(-2.4209128637784643, -0.19374101410068567, 1.8914320659371544)): shape (37, 800, 800)
      Valid pixels: 63658/640000 (9.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1844, max=274780, num_faces=274782
      Valid probs shape: (37, 63658)
    P stats: min=0.0000, max=1.0000, mean=0.0254
    Non-zero vertices: 128929/137393
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 8464 1183 1130 3633    0 2553  911 4629 6370]
  Ground Truth Stats:
    Labels shape: (137393,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/HLN-12-9/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7862
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8345
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8346

  RESULTS:
  RAW:         median(top-10)=0.9176, mean(top-10)=0.9148, median(all)=0.8531, mean(all)=0.7862
  + SMOOTHING: median(top-10)=0.9399, mean(top-10)=0.9420, median(all)=0.8876, mean(all)=0.8345 [+0.0223]
  + MRF:       median(top-10)=0.9401, mean(top-10)=0.9422, median(all)=0.8876, mean(all)=0.8346 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0224

================================================================================
Subject: MMRR-21-1
================================================================================
  Step 0: Generating predictions with V2 model (30 random views)...
  Mesh: 130631 vertices, 261258 faces
  Generating 30 random views...
  Generating predictions for 30 views (continuous camera pose)...
    ✓ Random_0 (pose=(-1.9290980664049233, -0.9783631732240097, -3.136155461882511)): shape (37, 800, 800)
      Valid pixels: 101434/640000 (15.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=261191, num_faces=261258
      Valid probs shape: (37, 101434)
    ✓ Random_1 (pose=(2.2430833540101647, -0.7325799165862663, 1.8188507035846806)): shape (37, 800, 800)
      Valid pixels: 83771/640000 (13.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3553, max=261257, num_faces=261258
      Valid probs shape: (37, 83771)
    ✓ Random_2 (pose=(1.9788306709873105, -0.1739151379522963, 2.6184149868367532)): shape (37, 800, 800)
      Valid pixels: 92043/640000 (14.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=142, max=261257, num_faces=261258
      Valid probs shape: (37, 92043)
    ✓ Random_3 (pose=(2.808751282512069, -0.8941000219959658, -2.4404345358771495)): shape (37, 800, 800)
      Valid pixels: 65197/640000 (10.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=469, max=261253, num_faces=261258
      Valid probs shape: (37, 65197)
    ✓ Random_4 (pose=(-0.5404370598567128, -2.627181413776702, 1.2714241973773897)): shape (37, 800, 800)
      Valid pixels: 62214/640000 (9.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=469, max=261254, num_faces=261258
      Valid probs shape: (37, 62214)
    ✓ Random_5 (pose=(0.2626328575017465, 1.5900948427095134, -1.9677514506611082)): shape (37, 800, 800)
      Valid pixels: 97898/640000 (15.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=40, max=261192, num_faces=261258
      Valid probs shape: (37, 97898)
    ✓ Random_6 (pose=(1.5396671465787106, -0.7645933534537948, -0.23859346046771224)): shape (37, 800, 800)
      Valid pixels: 101854/640000 (15.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=8, max=261192, num_faces=261258
      Valid probs shape: (37, 101854)
    ✓ Random_7 (pose=(2.0039572437872613, -0.9979834268819117, -2.714117675533705)): shape (37, 800, 800)
      Valid pixels: 72344/640000 (11.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=177, max=261257, num_faces=261258
      Valid probs shape: (37, 72344)
    ✓ Random_8 (pose=(-0.8972029167060835, 1.658060150724066, -2.3956930538232664)): shape (37, 800, 800)
      Valid pixels: 98393/640000 (15.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=8, max=261198, num_faces=261258
      Valid probs shape: (37, 98393)
    ✓ Random_9 (pose=(2.7563813866071776, 2.3192569653729658, -1.4364554574533224)): shape (37, 800, 800)
      Valid pixels: 64126/640000 (10.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=261249, num_faces=261258
      Valid probs shape: (37, 64126)
    ✓ Random_10 (pose=(-2.864017177252127, 2.971514020207378, 0.3918404468200527)): shape (37, 800, 800)
      Valid pixels: 46437/640000 (7.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=260783, num_faces=261258
      Valid probs shape: (37, 46437)
    ✓ Random_11 (pose=(1.1446293361555648, 0.9719238426888328, 2.5775215968452097)): shape (37, 800, 800)
      Valid pixels: 94106/640000 (14.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=4, max=261257, num_faces=261258
      Valid probs shape: (37, 94106)
    ✓ Random_12 (pose=(-0.9067461645120178, -0.4382741936336525, 1.520585247662182)): shape (37, 800, 800)
      Valid pixels: 58517/640000 (9.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=261176, num_faces=261258
      Valid probs shape: (37, 58517)
    ✓ Random_13 (pose=(2.5203636796308384, -1.4471230609163999, -0.3641243319217926)): shape (37, 800, 800)
      Valid pixels: 81462/640000 (12.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=261192, num_faces=261258
      Valid probs shape: (37, 81462)
    ✓ Random_14 (pose=(2.2182762236090667, 0.13029838888544543, 0.4633302501102943)): shape (37, 800, 800)
      Valid pixels: 76137/640000 (11.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=152, max=261254, num_faces=261258
      Valid probs shape: (37, 76137)
    ✓ Random_15 (pose=(1.826546898178914, 2.83888554118548, 2.043388796544904)): shape (37, 800, 800)
      Valid pixels: 75702/640000 (11.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=261250, num_faces=261258
      Valid probs shape: (37, 75702)
    ✓ Random_16 (pose=(2.9329146627460094, -0.839460539180009, 0.38084490173688534)): shape (37, 800, 800)
      Valid pixels: 54151/640000 (8.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=16751, max=261257, num_faces=261258
      Valid probs shape: (37, 54151)
    ✓ Random_17 (pose=(1.1576575407498124, -2.1548819956129908, 1.817417828329372)): shape (37, 800, 800)
      Valid pixels: 57563/640000 (9.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=10, max=261254, num_faces=261258
      Valid probs shape: (37, 57563)
    ✓ Random_18 (pose=(1.0949411081851839, -1.8777847344854253, 1.3884572086567024)): shape (37, 800, 800)
      Valid pixels: 70398/640000 (11.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=261198, num_faces=261258
      Valid probs shape: (37, 70398)
    ✓ Random_19 (pose=(-1.661076648973907, -0.6578487504738155, -3.1028054326327013)): shape (37, 800, 800)
      Valid pixels: 100009/640000 (15.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=261196, num_faces=261258
      Valid probs shape: (37, 100009)
    ✓ Random_20 (pose=(-1.600491981864857, -2.7190408914853164, 1.5949277122617254)): shape (37, 800, 800)
      Valid pixels: 61222/640000 (9.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=77, max=261129, num_faces=261258
      Valid probs shape: (37, 61222)
    ✓ Random_21 (pose=(0.18112597077434023, 1.4270291646441642, -2.2576407522064845)): shape (37, 800, 800)
      Valid pixels: 89705/640000 (14.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=261191, num_faces=261258
      Valid probs shape: (37, 89705)
    ✓ Random_22 (pose=(2.398801449669362, -3.022542002177679, 1.7789206515829532)): shape (37, 800, 800)
      Valid pixels: 62825/640000 (9.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=260589, num_faces=261258
      Valid probs shape: (37, 62825)
    ✓ Random_23 (pose=(0.5661155309675929, 0.31289517756509344, 3.083274233531762)): shape (37, 800, 800)
      Valid pixels: 61374/640000 (9.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=260529, num_faces=261258
      Valid probs shape: (37, 61374)
    ✓ Random_24 (pose=(1.1798266012089762, -1.4151316159208474, 3.047604637825085)): shape (37, 800, 800)
      Valid pixels: 96997/640000 (15.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=4, max=261257, num_faces=261258
      Valid probs shape: (37, 96997)
    ✓ Random_25 (pose=(0.49783842608042983, -3.1082281565655983, -1.7759089152798506)): shape (37, 800, 800)
      Valid pixels: 50988/640000 (8.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2019, max=261255, num_faces=261258
      Valid probs shape: (37, 50988)
    ✓ Random_26 (pose=(2.7740337344895414, -2.0581153158499745, -0.44043558487063095)): shape (37, 800, 800)
      Valid pixels: 72644/640000 (11.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=261199, num_faces=261258
      Valid probs shape: (37, 72644)
    ✓ Random_27 (pose=(1.455898045208368, 0.8521417013262425, 2.9803200448300764)): shape (37, 800, 800)
      Valid pixels: 93912/640000 (14.7%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=0, max=261257, num_faces=261258
      Valid probs shape: (37, 93912)
    ✓ Random_28 (pose=(1.71160326244061, -1.3882574761478694, -1.0835745824228997)): shape (37, 800, 800)
      Valid pixels: 88645/640000 (13.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=58, max=261191, num_faces=261258
      Valid probs shape: (37, 88645)
    ✓ Random_29 (pose=(-0.07609113108551036, -1.2069480959182703, -2.9563626625445267)): shape (37, 800, 800)
      Valid pixels: 60038/640000 (9.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=261197, num_faces=261258
      Valid probs shape: (37, 60038)
    P stats: min=0.0000, max=0.9999, mean=0.0254
    Non-zero vertices: 122734/130631
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 7897 1245 1070 3108    0 1676  842 4835 5312]
  Ground Truth Stats:
    Labels shape: (130631,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-1/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7879
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8453
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8455

  RESULTS:
  RAW:         median(top-10)=0.9138, mean(top-10)=0.9195, median(all)=0.8456, mean(all)=0.7879
  + SMOOTHING: median(top-10)=0.9336, mean(top-10)=0.9361, median(all)=0.8876, mean(all)=0.8453 [+0.0198]
  + MRF:       median(top-10)=0.9338, mean(top-10)=0.9363, median(all)=0.8880, mean(all)=0.8455 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0200

================================================================================
Subject: MMRR-21-10
================================================================================
  Step 0: Generating predictions with V2 model (30 random views)...
  Mesh: 148162 vertices, 296320 faces
  Generating 30 random views...
  Generating predictions for 30 views (continuous camera pose)...
    ✓ Random_0 (pose=(-0.1471085911877581, 0.41883176708199343, -1.4369222898366143)): shape (37, 800, 800)
      Valid pixels: 57432/640000 (9.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=296093, num_faces=296320
      Valid probs shape: (37, 57432)
    ✓ Random_1 (pose=(-2.4327709892492524, 0.989880047553906, -0.7726081304101386)): shape (37, 800, 800)
      Valid pixels: 88611/640000 (13.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=331, max=296318, num_faces=296320
      Valid probs shape: (37, 88611)
    ✓ Random_2 (pose=(-1.0099877989644646, -1.5944214906879093, 1.522617853346885)): shape (37, 800, 800)
      Valid pixels: 82761/640000 (12.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=15, max=296301, num_faces=296320
      Valid probs shape: (37, 82761)
    ✓ Random_3 (pose=(2.142766259060604, 2.0113057334066795, -2.204896199333384)): shape (37, 800, 800)
      Valid pixels: 79506/640000 (12.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=10, max=296250, num_faces=296320
      Valid probs shape: (37, 79506)
    ✓ Random_4 (pose=(-1.7532155814994523, 1.4678247543107954, -2.0245576857854037)): shape (37, 800, 800)
      Valid pixels: 65830/640000 (10.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=296312, num_faces=296320
      Valid probs shape: (37, 65830)
    ✓ Random_5 (pose=(-1.990904054053048, -1.2895499253066913, -1.0377420562728714)): shape (37, 800, 800)
      Valid pixels: 61146/640000 (9.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=296313, num_faces=296320
      Valid probs shape: (37, 61146)
    ✓ Random_6 (pose=(-2.1991224879994578, -1.1341506557189849, 1.0100080361487453)): shape (37, 800, 800)
      Valid pixels: 82266/640000 (12.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=379, max=296304, num_faces=296320
      Valid probs shape: (37, 82266)
    ✓ Random_7 (pose=(1.2320349335555694, 0.9572721798624677, -0.6041989745214389)): shape (37, 800, 800)
      Valid pixels: 97830/640000 (15.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=296304, num_faces=296320
      Valid probs shape: (37, 97830)
    ✓ Random_8 (pose=(-0.8430871899930037, -0.6145307444026118, -2.4523326963591776)): shape (37, 800, 800)
      Valid pixels: 64305/640000 (10.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=296204, num_faces=296320
      Valid probs shape: (37, 64305)
    ✓ Random_9 (pose=(-1.283874817810823, 2.39913615890282, 1.2079616570965372)): shape (37, 800, 800)
      Valid pixels: 72081/640000 (11.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=16, max=296268, num_faces=296320
      Valid probs shape: (37, 72081)
    ✓ Random_10 (pose=(2.1053677268806537, 0.9292562181597104, -2.110851521079595)): shape (37, 800, 800)
      Valid pixels: 78545/640000 (12.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=554, max=296318, num_faces=296320
      Valid probs shape: (37, 78545)
    ✓ Random_11 (pose=(0.5530369599627494, -2.3261669487986905, -0.9608597416005438)): shape (37, 800, 800)
      Valid pixels: 64502/640000 (10.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=103, max=296319, num_faces=296320
      Valid probs shape: (37, 64502)
    ✓ Random_12 (pose=(1.038120139893417, 2.3609346499681987, 1.9394530122752132)): shape (37, 800, 800)
      Valid pixels: 86942/640000 (13.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=533, max=296313, num_faces=296320
      Valid probs shape: (37, 86942)
    ✓ Random_13 (pose=(0.8004863899033943, 1.9486234361098207, 1.327050985938313)): shape (37, 800, 800)
      Valid pixels: 78805/640000 (12.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=113, max=296313, num_faces=296320
      Valid probs shape: (37, 78805)
    ✓ Random_14 (pose=(-0.6144526002494524, -2.7710321854092514, -1.3283588764222716)): shape (37, 800, 800)
      Valid pixels: 71139/640000 (11.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=27856, max=296315, num_faces=296320
      Valid probs shape: (37, 71139)
    ✓ Random_15 (pose=(0.6245525068810678, 0.8575478231286557, 2.069300409377904)): shape (37, 800, 800)
      Valid pixels: 85325/640000 (13.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=296264, num_faces=296320
      Valid probs shape: (37, 85325)
    ✓ Random_16 (pose=(1.23096972073336, -1.2890092782044593, 2.5571160636049477)): shape (37, 800, 800)
      Valid pixels: 87175/640000 (13.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=296313, num_faces=296320
      Valid probs shape: (37, 87175)
    ✓ Random_17 (pose=(3.025479715386729, 2.2410564933676413, 2.108516029549718)): shape (37, 800, 800)
      Valid pixels: 70959/640000 (11.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=296093, num_faces=296320
      Valid probs shape: (37, 70959)
    ✓ Random_18 (pose=(-0.9882018063160509, 0.9627829864098398, 0.38836035373501154)): shape (37, 800, 800)
      Valid pixels: 89673/640000 (14.0%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=5, max=296313, num_faces=296320
      Valid probs shape: (37, 89673)
    ✓ Random_19 (pose=(3.01448958064202, 0.6274638725503658, 1.328416633201508)): shape (37, 800, 800)
      Valid pixels: 67318/640000 (10.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=102, max=296319, num_faces=296320
      Valid probs shape: (37, 67318)
    ✓ Random_20 (pose=(0.441427399612377, 1.9329179596014567, -2.037238232534045)): shape (37, 800, 800)
      Valid pixels: 85850/640000 (13.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=13, max=296318, num_faces=296320
      Valid probs shape: (37, 85850)
    ✓ Random_21 (pose=(0.984371447555886, 0.9870248513912809, 2.2364797033639316)): shape (37, 800, 800)
      Valid pixels: 92531/640000 (14.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=296313, num_faces=296320
      Valid probs shape: (37, 92531)
    ✓ Random_22 (pose=(2.435964634412171, -1.5671242110820265, 2.1311502576774437)): shape (37, 800, 800)
      Valid pixels: 94084/640000 (14.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=10, max=296313, num_faces=296320
      Valid probs shape: (37, 94084)
    ✓ Random_23 (pose=(-3.114469611026752, 0.1852499300137036, -1.5367903044708622)): shape (37, 800, 800)
      Valid pixels: 50987/640000 (8.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=9556, max=296319, num_faces=296320
      Valid probs shape: (37, 50987)
    ✓ Random_24 (pose=(2.982042135888795, -0.8770993871093271, 2.434761097681692)): shape (37, 800, 800)
      Valid pixels: 73093/640000 (11.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1337, max=296319, num_faces=296320
      Valid probs shape: (37, 73093)
    ✓ Random_25 (pose=(2.8941309323816444, 1.950541544535434, -0.31776103497475416)): shape (37, 800, 800)
      Valid pixels: 59426/640000 (9.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=296097, num_faces=296320
      Valid probs shape: (37, 59426)
    ✓ Random_26 (pose=(-0.13927611774247906, 0.8771677828495692, -0.8788801252500686)): shape (37, 800, 800)
      Valid pixels: 67273/640000 (10.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=296093, num_faces=296320
      Valid probs shape: (37, 67273)
    ✓ Random_27 (pose=(0.9508096228294605, -1.9612870310815083, 0.4875338325475358)): shape (37, 800, 800)
      Valid pixels: 97199/640000 (15.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=8, max=296319, num_faces=296320
      Valid probs shape: (37, 97199)
    ✓ Random_28 (pose=(2.8305978404370107, -1.7020875220164926, 0.7405165030700225)): shape (37, 800, 800)
      Valid pixels: 76702/640000 (12.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=296313, num_faces=296320
      Valid probs shape: (37, 76702)
    ✓ Random_29 (pose=(-1.23101766143166, -0.6754926749963368, -1.9367291327601777)): shape (37, 800, 800)
      Valid pixels: 62809/640000 (9.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=296312, num_faces=296320
      Valid probs shape: (37, 62809)
    P stats: min=0.0000, max=1.0000, mean=0.0256
    Non-zero vertices: 140229/148162
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 7933 1571  970 3831    0 2676 1347 5183 8237]
  Ground Truth Stats:
    Labels shape: (148162,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-10/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7912
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8419
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8423

  RESULTS:
  RAW:         median(top-10)=0.9166, mean(top-10)=0.9146, median(all)=0.8511, mean(all)=0.7912
  + SMOOTHING: median(top-10)=0.9351, mean(top-10)=0.9345, median(all)=0.8821, mean(all)=0.8419 [+0.0184]
  + MRF:       median(top-10)=0.9355, mean(top-10)=0.9347, median(all)=0.8825, mean(all)=0.8423 [+0.0004]
  TOTAL IMPROVEMENT (median top-10): +0.0188

================================================================================
Subject: MMRR-21-11
================================================================================
  Step 0: Generating predictions with V2 model (30 random views)...
  Mesh: 136982 vertices, 273960 faces
  Generating 30 random views...
  Generating predictions for 30 views (continuous camera pose)...
    ✓ Random_0 (pose=(-2.8505786904116928, 0.9605017719656095, -0.5229669725493817)): shape (37, 800, 800)
      Valid pixels: 81359/640000 (12.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=2129, max=273957, num_faces=273960
      Valid probs shape: (37, 81359)
    ✓ Random_1 (pose=(-2.2913257370867197, -0.050946338043757144, -1.4891253293453177)): shape (37, 800, 800)
      Valid pixels: 60276/640000 (9.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=22211, max=273958, num_faces=273960
      Valid probs shape: (37, 60276)
    ✓ Random_2 (pose=(2.9671715593462835, -0.7717281219789194, -3.0723092893644632)): shape (37, 800, 800)
      Valid pixels: 72262/640000 (11.3%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=2871, max=273959, num_faces=273960
      Valid probs shape: (37, 72262)
    ✓ Random_3 (pose=(2.431323082017329, -2.255169511179518, -0.1998405296964112)): shape (37, 800, 800)
      Valid pixels: 85328/640000 (13.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=273959, num_faces=273960
      Valid probs shape: (37, 85328)
    ✓ Random_4 (pose=(-1.2444205790859717, -1.3574561853371736, 2.476934845735207)): shape (37, 800, 800)
      Valid pixels: 113336/640000 (17.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=273956, num_faces=273960
      Valid probs shape: (37, 113336)
    ✓ Random_5 (pose=(0.3203863695385234, -0.5197203048204306, -0.7028106727477241)): shape (37, 800, 800)
      Valid pixels: 55632/640000 (8.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=273847, num_faces=273960
      Valid probs shape: (37, 55632)
    ✓ Random_6 (pose=(-3.0825530086932456, 0.985016092378121, -2.360075670082594)): shape (37, 800, 800)
      Valid pixels: 91358/640000 (14.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=6640, max=273953, num_faces=273960
      Valid probs shape: (37, 91358)
    ✓ Random_7 (pose=(-2.45130102362251, -2.564830545521947, 0.42601014590996344)): shape (37, 800, 800)
      Valid pixels: 92571/640000 (14.5%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=1, max=273950, num_faces=273960
      Valid probs shape: (37, 92571)
    ✓ Random_8 (pose=(-0.6322839628934682, 0.8287736677359003, 1.845327198794287)): shape (37, 800, 800)
      Valid pixels: 65445/640000 (10.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=273951, num_faces=273960
      Valid probs shape: (37, 65445)
    ✓ Random_9 (pose=(-2.6016271309384544, -3.013224573815787, 0.789183172852904)): shape (37, 800, 800)
      Valid pixels: 65660/640000 (10.3%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=1, max=273227, num_faces=273960
      Valid probs shape: (37, 65660)
    ✓ Random_10 (pose=(-0.40718827193043916, -0.7758658244293204, 0.7174362562672658)): shape (37, 800, 800)
      Valid pixels: 59689/640000 (9.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8, max=273849, num_faces=273960
      Valid probs shape: (37, 59689)
    ✓ Random_11 (pose=(1.0177680052041342, -2.673196078919502, 1.868888990925356)): shape (37, 800, 800)
      Valid pixels: 64250/640000 (10.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=14242, max=273958, num_faces=273960
      Valid probs shape: (37, 64250)
    ✓ Random_12 (pose=(0.48909113870418697, 1.9858830824702158, 1.8917138661167208)): shape (37, 800, 800)
      Valid pixels: 102419/640000 (16.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1093, max=273955, num_faces=273960
      Valid probs shape: (37, 102419)
    ✓ Random_13 (pose=(-2.377333564134008, -0.5263317189124992, 2.3766353152106436)): shape (37, 800, 800)
      Valid pixels: 80361/640000 (12.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=749, max=273953, num_faces=273960
      Valid probs shape: (37, 80361)
    ✓ Random_14 (pose=(-0.7439276470422618, 2.6110216090189597, -1.2314439659709564)): shape (37, 800, 800)
      Valid pixels: 59821/640000 (9.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2234, max=273956, num_faces=273960
      Valid probs shape: (37, 59821)
    ✓ Random_15 (pose=(-0.624940695645555, -2.996463679275287, -2.1379875830834694)): shape (37, 800, 800)
      Valid pixels: 55975/640000 (8.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=780, max=273956, num_faces=273960
      Valid probs shape: (37, 55975)
    ✓ Random_16 (pose=(-2.921819558787904, 2.1258194711431893, -0.18138165947638285)): shape (37, 800, 800)
      Valid pixels: 64890/640000 (10.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8, max=273951, num_faces=273960
      Valid probs shape: (37, 64890)
    ✓ Random_17 (pose=(0.9277878209605639, -2.565078919568122, 2.395961474720721)): shape (37, 800, 800)
      Valid pixels: 82396/640000 (12.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=16788, max=273956, num_faces=273960
      Valid probs shape: (37, 82396)
    ✓ Random_18 (pose=(2.968075651158288, 1.1679888983275548, 2.9990025929943185)): shape (37, 800, 800)
      Valid pixels: 66452/640000 (10.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3990, max=273955, num_faces=273960
      Valid probs shape: (37, 66452)
    ✓ Random_19 (pose=(0.3516086647081509, -1.3221156731137331, -2.4287700196229802)): shape (37, 800, 800)
      Valid pixels: 108123/640000 (16.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=4, max=273950, num_faces=273960
      Valid probs shape: (37, 108123)
    ✓ Random_20 (pose=(2.094489131188431, -0.2980133442366695, -0.40343987448267793)): shape (37, 800, 800)
      Valid pixels: 107101/640000 (16.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=81, max=273958, num_faces=273960
      Valid probs shape: (37, 107101)
    ✓ Random_21 (pose=(-2.3660231494025497, 2.895110333539347, -1.6084706219539597)): shape (37, 800, 800)
      Valid pixels: 73668/640000 (11.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=272480, num_faces=273960
      Valid probs shape: (37, 73668)
    ✓ Random_22 (pose=(0.26326069328143165, 2.3820509666191656, -1.4433389238564327)): shape (37, 800, 800)
      Valid pixels: 93227/640000 (14.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=110, max=273956, num_faces=273960
      Valid probs shape: (37, 93227)
    ✓ Random_23 (pose=(0.0824296715920636, 0.4694945175034757, -1.1454333800223326)): shape (37, 800, 800)
      Valid pixels: 67619/640000 (10.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=273761, num_faces=273960
      Valid probs shape: (37, 67619)
    ✓ Random_24 (pose=(-2.7541435300971715, -1.2283833917829077, -0.4308563599658788)): shape (37, 800, 800)
      Valid pixels: 66221/640000 (10.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2144, max=273957, num_faces=273960
      Valid probs shape: (37, 66221)
    ✓ Random_25 (pose=(1.1441098832522743, 1.9892882183448082, -0.2952175071990726)): shape (37, 800, 800)
      Valid pixels: 107151/640000 (16.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=273959, num_faces=273960
      Valid probs shape: (37, 107151)
    ✓ Random_26 (pose=(3.0287086435031467, -1.0585045804881577, -0.1512555741888706)): shape (37, 800, 800)
      Valid pixels: 66468/640000 (10.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=944, max=273956, num_faces=273960
      Valid probs shape: (37, 66468)
    ✓ Random_27 (pose=(1.3608103228283204, -2.5278323656183295, -1.698289977512433)): shape (37, 800, 800)
      Valid pixels: 75852/640000 (11.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=16, max=273954, num_faces=273960
      Valid probs shape: (37, 75852)
    ✓ Random_28 (pose=(-1.382963740099644, 1.5416952973322156, -2.9495907047959156)): shape (37, 800, 800)
      Valid pixels: 110233/640000 (17.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=273955, num_faces=273960
      Valid probs shape: (37, 110233)
    ✓ Random_29 (pose=(2.1358153766112906, 0.8995809815848537, 1.8422149747215437)): shape (37, 800, 800)
      Valid pixels: 67615/640000 (10.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=788, max=273955, num_faces=273960
      Valid probs shape: (37, 67615)
    P stats: min=0.0000, max=0.9999, mean=0.0249
    Non-zero vertices: 126304/136982
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 10678  1381   848  2351     0  2008   864  4728  6521]
  Ground Truth Stats:
    Labels shape: (136982,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-11/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6810
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7304
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7305

  RESULTS:
  RAW:         median(top-10)=0.8797, mean(top-10)=0.8787, median(all)=0.7616, mean(all)=0.6810
  + SMOOTHING: median(top-10)=0.9105, mean(top-10)=0.9085, median(all)=0.8059, mean(all)=0.7304 [+0.0308]
  + MRF:       median(top-10)=0.9107, mean(top-10)=0.9088, median(all)=0.8062, mean(all)=0.7305 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0311

================================================================================
Subject: MMRR-21-12
================================================================================
  Step 0: Generating predictions with V2 model (30 random views)...
  Mesh: 102602 vertices, 205200 faces
  Generating 30 random views...
  Generating predictions for 30 views (continuous camera pose)...
    ✓ Random_0 (pose=(2.527342559723192, -1.717683061553471, 1.219663128548949)): shape (37, 800, 800)
      Valid pixels: 87453/640000 (13.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=205115, num_faces=205200
      Valid probs shape: (37, 87453)
    ✓ Random_1 (pose=(3.0056712105820163, 1.576615204486913, 0.9629399400952696)): shape (37, 800, 800)
      Valid pixels: 101688/640000 (15.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=25, max=205196, num_faces=205200
      Valid probs shape: (37, 101688)
    ✓ Random_2 (pose=(2.0927567606332067, -0.6509333568292122, 0.15559359955228258)): shape (37, 800, 800)
      Valid pixels: 80589/640000 (12.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=107, max=205196, num_faces=205200
      Valid probs shape: (37, 80589)
    ✓ Random_3 (pose=(-0.6245684663420685, 2.3668377216257284, -1.6990302678471179)): shape (37, 800, 800)
      Valid pixels: 72081/640000 (11.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=132, max=205198, num_faces=205200
      Valid probs shape: (37, 72081)
    ✓ Random_4 (pose=(0.4218268966976759, 1.6613277708444114, -2.285750816057736)): shape (37, 800, 800)
      Valid pixels: 83444/640000 (13.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=9, max=205196, num_faces=205200
      Valid probs shape: (37, 83444)
    ✓ Random_5 (pose=(0.9539704782111054, 2.36455001482212, 1.5188225578630528)): shape (37, 800, 800)
      Valid pixels: 78135/640000 (12.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=244, max=205114, num_faces=205200
      Valid probs shape: (37, 78135)
    ✓ Random_6 (pose=(0.976321775157853, -2.9872466057564955, -2.8693318806282613)): shape (37, 800, 800)
      Valid pixels: 84784/640000 (13.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=456, max=205199, num_faces=205200
      Valid probs shape: (37, 84784)
    ✓ Random_7 (pose=(2.142578824194606, 1.9319302470786512, -1.1530041456756936)): shape (37, 800, 800)
      Valid pixels: 66424/640000 (10.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=205020, num_faces=205200
      Valid probs shape: (37, 66424)
    ✓ Random_8 (pose=(-1.8799483110032589, 1.6993359680712752, -2.613109862618639)): shape (37, 800, 800)
      Valid pixels: 75671/640000 (11.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=205196, num_faces=205200
      Valid probs shape: (37, 75671)
    ✓ Random_9 (pose=(-0.6370782924996146, -2.3909341191822655, -2.3305512951605207)): shape (37, 800, 800)
      Valid pixels: 61333/640000 (9.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6979, max=205194, num_faces=205200
      Valid probs shape: (37, 61333)
    ✓ Random_10 (pose=(1.939215495065799, -0.5305393338707831, 2.1497550880292255)): shape (37, 800, 800)
      Valid pixels: 92676/640000 (14.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=65, max=205115, num_faces=205200
      Valid probs shape: (37, 92676)
    ✓ Random_11 (pose=(2.2689836601141327, -2.366268513762318, 2.948208613183528)): shape (37, 800, 800)
      Valid pixels: 76810/640000 (12.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=205023, num_faces=205200
      Valid probs shape: (37, 76810)
    ✓ Random_12 (pose=(-1.1498958996024813, 0.5352973190263421, -0.052040170147631404)): shape (37, 800, 800)
      Valid pixels: 90786/640000 (14.2%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=1, max=205108, num_faces=205200
      Valid probs shape: (37, 90786)
    ✓ Random_13 (pose=(-2.9636743584542513, -0.5605141733885937, -0.13534956415935628)): shape (37, 800, 800)
      Valid pixels: 60442/640000 (9.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=22845, max=205198, num_faces=205200
      Valid probs shape: (37, 60442)
    ✓ Random_14 (pose=(-0.4660959873502146, -0.43255579964615753, -0.23148626159720154)): shape (37, 800, 800)
      Valid pixels: 64774/640000 (10.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=204477, num_faces=205200
      Valid probs shape: (37, 64774)
    ✓ Random_15 (pose=(2.9847824221538435, 1.4450347667142944, 0.1327163439681427)): shape (37, 800, 800)
      Valid pixels: 76108/640000 (11.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=12, max=205194, num_faces=205200
      Valid probs shape: (37, 76108)
    ✓ Random_16 (pose=(1.3811652745274268, -2.259148344402717, 2.0253012107756403)): shape (37, 800, 800)
      Valid pixels: 75398/640000 (11.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=26, max=205114, num_faces=205200
      Valid probs shape: (37, 75398)
    ✓ Random_17 (pose=(2.2150652670823074, 2.0889523901078118, 2.760286711792485)): shape (37, 800, 800)
      Valid pixels: 85272/640000 (13.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=205115, num_faces=205200
      Valid probs shape: (37, 85272)
    ✓ Random_18 (pose=(-2.640756236495455, -1.5941988006281602, 1.177617052205707)): shape (37, 800, 800)
      Valid pixels: 89596/640000 (14.0%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=2, max=205115, num_faces=205200
      Valid probs shape: (37, 89596)
    ✓ Random_19 (pose=(-3.049642456979471, 3.13377683101955, 0.778706954608837)): shape (37, 800, 800)
      Valid pixels: 49871/640000 (7.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=204917, num_faces=205200
      Valid probs shape: (37, 49871)
    ✓ Random_20 (pose=(-2.2457009015550358, 2.3805882693140017, 0.2773501454192462)): shape (37, 800, 800)
      Valid pixels: 70546/640000 (11.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=205023, num_faces=205200
      Valid probs shape: (37, 70546)
    ✓ Random_21 (pose=(-1.0571989128612596, 0.06839807852078694, 1.9104473949279965)): shape (37, 800, 800)
      Valid pixels: 68611/640000 (10.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=15, max=205196, num_faces=205200
      Valid probs shape: (37, 68611)
    ✓ Random_22 (pose=(-3.110591637312797, 1.3341200864669451, 2.6604632635586025)): shape (37, 800, 800)
      Valid pixels: 71376/640000 (11.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=205196, num_faces=205200
      Valid probs shape: (37, 71376)
    ✓ Random_23 (pose=(-1.7597299153835273, -1.5844843493077427, -1.6024136853314634)): shape (37, 800, 800)
      Valid pixels: 65644/640000 (10.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=205195, num_faces=205200
      Valid probs shape: (37, 65644)
    ✓ Random_24 (pose=(-3.106125910175845, 1.7952496842749515, -2.5810875666124797)): shape (37, 800, 800)
      Valid pixels: 83565/640000 (13.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=205115, num_faces=205200
      Valid probs shape: (37, 83565)
    ✓ Random_25 (pose=(-1.0450136264086844, 2.115266172238252, -2.7705129752328546)): shape (37, 800, 800)
      Valid pixels: 96986/640000 (15.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=9, max=205196, num_faces=205200
      Valid probs shape: (37, 96986)
    ✓ Random_26 (pose=(2.4853854487655473, -0.14901533833376224, 1.969560376337581)): shape (37, 800, 800)
      Valid pixels: 73795/640000 (11.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=18385, max=205198, num_faces=205200
      Valid probs shape: (37, 73795)
    ✓ Random_27 (pose=(1.7928540987382675, 2.365225989084424, -0.3100698317892179)): shape (37, 800, 800)
      Valid pixels: 100886/640000 (15.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=205196, num_faces=205200
      Valid probs shape: (37, 100886)
    ✓ Random_28 (pose=(-3.0558912278105974, -0.5666651835787202, 0.5045606842155097)): shape (37, 800, 800)
      Valid pixels: 71186/640000 (11.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=22811, max=205198, num_faces=205200
      Valid probs shape: (37, 71186)
    ✓ Random_29 (pose=(3.0065894891329794, -0.43855225599802106, -1.2466112780391676)): shape (37, 800, 800)
      Valid pixels: 59403/640000 (9.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=108, max=205199, num_faces=205200
      Valid probs shape: (37, 59403)
    P stats: min=0.0000, max=0.9999, mean=0.0255
    Non-zero vertices: 96690/102602
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 5912 1059  828 2180    0 1666  823 3449 4339]
  Ground Truth Stats:
    Labels shape: (102602,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-12/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7621
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8094
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8097

  RESULTS:
  RAW:         median(top-10)=0.9002, mean(top-10)=0.9045, median(all)=0.8525, mean(all)=0.7621
  + SMOOTHING: median(top-10)=0.9249, mean(top-10)=0.9252, median(all)=0.8778, mean(all)=0.8094 [+0.0247]
  + MRF:       median(top-10)=0.9252, mean(top-10)=0.9255, median(all)=0.8791, mean(all)=0.8097 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0250

================================================================================
Subject: MMRR-21-13
================================================================================
  Step 0: Generating predictions with V2 model (30 random views)...
  Mesh: 128887 vertices, 257770 faces
  Generating 30 random views...
  Generating predictions for 30 views (continuous camera pose)...
    ✓ Random_0 (pose=(-1.5482007124500055, 1.8808493840776483, -0.9132012042821875)): shape (37, 800, 800)
      Valid pixels: 115022/640000 (18.0%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=1, max=257574, num_faces=257770
      Valid probs shape: (37, 115022)
    ✓ Random_1 (pose=(-0.04597481922898439, 2.8830864554495683, 0.5949643106488685)): shape (37, 800, 800)
      Valid pixels: 71878/640000 (11.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=59565, max=257767, num_faces=257770
      Valid probs shape: (37, 71878)
    ✓ Random_2 (pose=(-1.1014923087948056, -0.8803487922314299, -0.6018056477727725)): shape (37, 800, 800)
      Valid pixels: 121641/640000 (19.0%)
      Probs stats: min=0.0000, max=0.9995, mean=0.0270
      Face IDs: min=4, max=257574, num_faces=257770
      Valid probs shape: (37, 121641)
    ✓ Random_3 (pose=(-2.8532897687160155, -0.16978281225867375, 1.969275714085307)): shape (37, 800, 800)
      Valid pixels: 72949/640000 (11.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3076, max=257767, num_faces=257770
      Valid probs shape: (37, 72949)
    ✓ Random_4 (pose=(2.905205620767024, 1.3107138505929985, 0.6787418003139267)): shape (37, 800, 800)
      Valid pixels: 127613/640000 (19.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=55, max=257769, num_faces=257770
      Valid probs shape: (37, 127613)
    ✓ Random_5 (pose=(2.9876783189605627, -2.8192315117956976, 2.895066036821058)): shape (37, 800, 800)
      Valid pixels: 72148/640000 (11.3%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=0, max=256798, num_faces=257770
      Valid probs shape: (37, 72148)
    ✓ Random_6 (pose=(-0.31806871204799325, -1.4933566193975294, 3.0035523856047783)): shape (37, 800, 800)
      Valid pixels: 90648/640000 (14.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=257769, num_faces=257770
      Valid probs shape: (37, 90648)
    ✓ Random_7 (pose=(-2.7584988874638943, 1.286192523208225, -1.1334736780337784)): shape (37, 800, 800)
      Valid pixels: 113912/640000 (17.8%)
      Probs stats: min=0.0000, max=0.9995, mean=0.0270
      Face IDs: min=113, max=257767, num_faces=257770
      Valid probs shape: (37, 113912)
    ✓ Random_8 (pose=(-2.60231393250264, 2.3761881330680517, -0.18861941574883367)): shape (37, 800, 800)
      Valid pixels: 85832/640000 (13.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=0, max=257161, num_faces=257770
      Valid probs shape: (37, 85832)
    ✓ Random_9 (pose=(2.8011823030245093, -0.44926651194387857, -2.8164910934041947)): shape (37, 800, 800)
      Valid pixels: 83041/640000 (13.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1607, max=257767, num_faces=257770
      Valid probs shape: (37, 83041)
    ✓ Random_10 (pose=(0.4456706869884286, -0.04689327153225298, 0.9701260216898833)): shape (37, 800, 800)
      Valid pixels: 78285/640000 (12.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=257766, num_faces=257770
      Valid probs shape: (37, 78285)
    ✓ Random_11 (pose=(-1.1597977321554271, -0.6515419214177758, 0.8934544754506355)): shape (37, 800, 800)
      Valid pixels: 82278/640000 (12.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=257633, num_faces=257770
      Valid probs shape: (37, 82278)
    ✓ Random_12 (pose=(-2.6448137760586574, -2.87247449449255, 2.86962040141419)): shape (37, 800, 800)
      Valid pixels: 77599/640000 (12.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=257766, num_faces=257770
      Valid probs shape: (37, 77599)
    ✓ Random_13 (pose=(2.1678290643623095, -2.0576006849957658, -1.6609188939727126)): shape (37, 800, 800)
      Valid pixels: 97471/640000 (15.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=257636, num_faces=257770
      Valid probs shape: (37, 97471)
    ✓ Random_14 (pose=(-3.053223784868357, -2.3196852473350464, -0.814502316914858)): shape (37, 800, 800)
      Valid pixels: 88700/640000 (13.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=257769, num_faces=257770
      Valid probs shape: (37, 88700)
    ✓ Random_15 (pose=(0.6088345751326547, -2.781939348487024, 0.09456764171346466)): shape (37, 800, 800)
      Valid pixels: 102611/640000 (16.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=770, max=257769, num_faces=257770
      Valid probs shape: (37, 102611)
    ✓ Random_16 (pose=(-2.6115697116817724, -0.7779520523051358, 2.651572906360119)): shape (37, 800, 800)
      Valid pixels: 91063/640000 (14.2%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=1595, max=257767, num_faces=257770
      Valid probs shape: (37, 91063)
    ✓ Random_17 (pose=(2.0311132452614036, 0.48799566680919026, -0.5245573211224803)): shape (37, 800, 800)
      Valid pixels: 122284/640000 (19.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=74, max=257769, num_faces=257770
      Valid probs shape: (37, 122284)
    ✓ Random_18 (pose=(1.432377633825621, -0.9019296740498972, -2.153001796918874)): shape (37, 800, 800)
      Valid pixels: 91079/640000 (14.2%)
      Probs stats: min=0.0000, max=0.9994, mean=0.0270
      Face IDs: min=5, max=257765, num_faces=257770
      Valid probs shape: (37, 91079)
    ✓ Random_19 (pose=(1.2422389229477773, -0.6219245802685496, 0.7432516715338444)): shape (37, 800, 800)
      Valid pixels: 105019/640000 (16.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=5, max=257769, num_faces=257770
      Valid probs shape: (37, 105019)
    ✓ Random_20 (pose=(2.4646627560573764, -1.5015459735999015, 1.0200705689330603)): shape (37, 800, 800)
      Valid pixels: 98717/640000 (15.4%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=361, max=257699, num_faces=257770
      Valid probs shape: (37, 98717)
    ✓ Random_21 (pose=(-2.697890910191556, 0.21186210301383301, 2.6302373621573283)): shape (37, 800, 800)
      Valid pixels: 84785/640000 (13.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=758, max=257769, num_faces=257770
      Valid probs shape: (37, 84785)
    ✓ Random_22 (pose=(-2.8613490650738447, -1.4664183237356911, 2.7194380983725797)): shape (37, 800, 800)
      Valid pixels: 87749/640000 (13.7%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=50, max=257765, num_faces=257770
      Valid probs shape: (37, 87749)
    ✓ Random_23 (pose=(1.7763614832282313, 2.336082066628859, -0.4291841743197691)): shape (37, 800, 800)
      Valid pixels: 124282/640000 (19.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=257769, num_faces=257770
      Valid probs shape: (37, 124282)
    ✓ Random_24 (pose=(-1.9392477945807363, -2.759836854426489, 0.5031260488339666)): shape (37, 800, 800)
      Valid pixels: 102073/640000 (15.9%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=5, max=257575, num_faces=257770
      Valid probs shape: (37, 102073)
    ✓ Random_25 (pose=(-2.48303522738822, -2.650356058717507, 0.5601518181595853)): shape (37, 800, 800)
      Valid pixels: 102434/640000 (16.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=257158, num_faces=257770
      Valid probs shape: (37, 102434)
    ✓ Random_26 (pose=(2.6784836395127307, 2.7442568165807177, 2.951702679902678)): shape (37, 800, 800)
      Valid pixels: 95543/640000 (14.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=257019, num_faces=257770
      Valid probs shape: (37, 95543)
    ✓ Random_27 (pose=(2.142207869290723, 1.6815955218257255, 0.38842534417581787)): shape (37, 800, 800)
      Valid pixels: 130446/640000 (20.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=257769, num_faces=257770
      Valid probs shape: (37, 130446)
    ✓ Random_28 (pose=(0.3433434726032236, -2.454557432363277, -1.813381864786639)): shape (37, 800, 800)
      Valid pixels: 97529/640000 (15.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8653, max=257767, num_faces=257770
      Valid probs shape: (37, 97529)
    ✓ Random_29 (pose=(-2.486775099888312, 2.732285537436197, -2.5361396862478456)): shape (37, 800, 800)
      Valid pixels: 84324/640000 (13.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=257769, num_faces=257770
      Valid probs shape: (37, 84324)
    P stats: min=0.0000, max=0.9999, mean=0.0257
    Non-zero vertices: 122553/128887
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 6334 1073 1060 2776    0 1740  656 4939 6096]
  Ground Truth Stats:
    Labels shape: (128887,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-13/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7696
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8152
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8157

  RESULTS:
  RAW:         median(top-10)=0.9022, mean(top-10)=0.9016, median(all)=0.8460, mean(all)=0.7696
  + SMOOTHING: median(top-10)=0.9191, mean(top-10)=0.9206, median(all)=0.8709, mean(all)=0.8152 [+0.0169]
  + MRF:       median(top-10)=0.9189, mean(top-10)=0.9207, median(all)=0.8706, mean(all)=0.8157 [-0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0167

================================================================================
Subject: MMRR-21-14
================================================================================
  Step 0: Generating predictions with V2 model (30 random views)...
  Mesh: 127387 vertices, 254770 faces
  Generating 30 random views...
  Generating predictions for 30 views (continuous camera pose)...
    ✓ Random_0 (pose=(-0.11627606583656735, -1.795353790136551, 2.24541226179337)): shape (37, 800, 800)
      Valid pixels: 83206/640000 (13.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=38, max=254638, num_faces=254770
      Valid probs shape: (37, 83206)
    ✓ Random_1 (pose=(2.6517269022319576, 0.0789258250022784, 2.0340432241634394)): shape (37, 800, 800)
      Valid pixels: 57696/640000 (9.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=50600, max=254768, num_faces=254770
      Valid probs shape: (37, 57696)
    ✓ Random_2 (pose=(2.837011331241979, -2.981054393209458, 3.049581742472398)): shape (37, 800, 800)
      Valid pixels: 54538/640000 (8.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=253830, num_faces=254770
      Valid probs shape: (37, 54538)
    ✓ Random_3 (pose=(-2.8444835239304846, -0.6448973161263383, -0.5428666608968831)): shape (37, 800, 800)
      Valid pixels: 52056/640000 (8.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6434, max=254632, num_faces=254770
      Valid probs shape: (37, 52056)
    ✓ Random_4 (pose=(0.3490324369972919, 2.6555136310181453, -2.034121159901056)): shape (37, 800, 800)
      Valid pixels: 63107/640000 (9.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=437, max=254769, num_faces=254770
      Valid probs shape: (37, 63107)
    ✓ Random_5 (pose=(2.043127956435127, 1.438998915420303, 2.349095815008451)): shape (37, 800, 800)
      Valid pixels: 80154/640000 (12.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=252424, num_faces=254770
      Valid probs shape: (37, 80154)
    ✓ Random_6 (pose=(-1.6852489642945057, 1.488309767737296, -0.6585338260913924)): shape (37, 800, 800)
      Valid pixels: 99976/640000 (15.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=253389, num_faces=254770
      Valid probs shape: (37, 99976)
    ✓ Random_7 (pose=(1.7500661546729281, -0.2057761064942758, -2.2012953987897275)): shape (37, 800, 800)
      Valid pixels: 73718/640000 (11.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=10, max=254769, num_faces=254770
      Valid probs shape: (37, 73718)
    ✓ Random_8 (pose=(2.8491990824695863, 2.446334595937656, 1.3287562740944834)): shape (37, 800, 800)
      Valid pixels: 74451/640000 (11.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=254638, num_faces=254770
      Valid probs shape: (37, 74451)
    ✓ Random_9 (pose=(-3.059591867570531, -1.9124777183247772, 1.0663341895508704)): shape (37, 800, 800)
      Valid pixels: 97126/640000 (15.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=3, max=252424, num_faces=254770
      Valid probs shape: (37, 97126)
    ✓ Random_10 (pose=(2.8282342411466193, 0.3761067869467203, 1.8293180039608021)): shape (37, 800, 800)
      Valid pixels: 50884/640000 (8.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4086, max=254666, num_faces=254770
      Valid probs shape: (37, 50884)
    ✓ Random_11 (pose=(1.9245431898991914, -1.4752260116293205, 1.1970194885018266)): shape (37, 800, 800)
      Valid pixels: 63071/640000 (9.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=252424, num_faces=254770
      Valid probs shape: (37, 63071)
    ✓ Random_12 (pose=(2.9751340719516177, 1.0831506794847225, -2.5273154701739684)): shape (37, 800, 800)
      Valid pixels: 91153/640000 (14.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=4627, max=252417, num_faces=254770
      Valid probs shape: (37, 91153)
    ✓ Random_13 (pose=(1.6345516535140048, -2.43879890857635, -1.5355146256925614)): shape (37, 800, 800)
      Valid pixels: 68656/640000 (10.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=254767, num_faces=254770
      Valid probs shape: (37, 68656)
    ✓ Random_14 (pose=(-1.4289110995433274, -3.0636113492640473, 0.4696375674197095)): shape (37, 800, 800)
      Valid pixels: 81530/640000 (12.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=21, max=254768, num_faces=254770
      Valid probs shape: (37, 81530)
    ✓ Random_15 (pose=(-1.233400605447914, -3.072284308492262, 0.18481217800352256)): shape (37, 800, 800)
      Valid pixels: 87199/640000 (13.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=124, max=254769, num_faces=254770
      Valid probs shape: (37, 87199)
    ✓ Random_16 (pose=(2.1912624836849286, 0.8765725235628077, 2.6719746615357245)): shape (37, 800, 800)
      Valid pixels: 88584/640000 (13.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=3753, max=252421, num_faces=254770
      Valid probs shape: (37, 88584)
    ✓ Random_17 (pose=(-1.626631531418518, -1.998807703329924, -2.7053670480401912)): shape (37, 800, 800)
      Valid pixels: 90401/640000 (14.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=36, max=254638, num_faces=254770
      Valid probs shape: (37, 90401)
    ✓ Random_18 (pose=(-1.6288535225021428, -1.615215164630644, 0.05838241902105379)): shape (37, 800, 800)
      Valid pixels: 93700/640000 (14.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=254769, num_faces=254770
      Valid probs shape: (37, 93700)
    ✓ Random_19 (pose=(1.953664444122576, 0.6474541360877866, -0.49520244905442423)): shape (37, 800, 800)
      Valid pixels: 98673/640000 (15.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=78, max=254767, num_faces=254770
      Valid probs shape: (37, 98673)
    ✓ Random_20 (pose=(0.5592250969346724, -0.41926174215554646, -1.0910184209493168)): shape (37, 800, 800)
      Valid pixels: 52357/640000 (8.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=254767, num_faces=254770
      Valid probs shape: (37, 52357)
    ✓ Random_21 (pose=(-1.9765677511100441, 2.9525281081195125, -1.1819414426610118)): shape (37, 800, 800)
      Valid pixels: 84128/640000 (13.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=252424, num_faces=254770
      Valid probs shape: (37, 84128)
    ✓ Random_22 (pose=(-0.17600958241046216, 2.9151282624163377, -0.8042773926770161)): shape (37, 800, 800)
      Valid pixels: 45759/640000 (7.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=70156, max=254766, num_faces=254770
      Valid probs shape: (37, 45759)
    ✓ Random_23 (pose=(2.263992716886844, 2.199900859974001, 0.36463448753842664)): shape (37, 800, 800)
      Valid pixels: 96569/640000 (15.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=254767, num_faces=254770
      Valid probs shape: (37, 96569)
    ✓ Random_24 (pose=(-2.9251776828423592, -0.8662748980469241, -2.273643254531084)): shape (37, 800, 800)
      Valid pixels: 88350/640000 (13.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=79, max=254767, num_faces=254770
      Valid probs shape: (37, 88350)
    ✓ Random_25 (pose=(0.3540782923474821, 2.5079148865092282, 2.6160624049160734)): shape (37, 800, 800)
      Valid pixels: 71928/640000 (11.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3504, max=254769, num_faces=254770
      Valid probs shape: (37, 71928)
    ✓ Random_26 (pose=(-1.6319531042494848, -2.993015272808846, -0.13094918421745927)): shape (37, 800, 800)
      Valid pixels: 96352/640000 (15.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=254756, num_faces=254770
      Valid probs shape: (37, 96352)
    ✓ Random_27 (pose=(2.1745049882512646, 0.3887852300818868, -2.7813525840101723)): shape (37, 800, 800)
      Valid pixels: 86067/640000 (13.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1418, max=254769, num_faces=254770
      Valid probs shape: (37, 86067)
    ✓ Random_28 (pose=(2.1862866063006443, -2.6407408963021552, 1.613192950911004)): shape (37, 800, 800)
      Valid pixels: 77696/640000 (12.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=252502, num_faces=254770
      Valid probs shape: (37, 77696)
    ✓ Random_29 (pose=(-3.1229917251489625, 0.028734902879086643, -1.2917505348486977)): shape (37, 800, 800)
      Valid pixels: 44034/640000 (6.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=8188, max=254768, num_faces=254770
      Valid probs shape: (37, 44034)
    P stats: min=0.0000, max=0.9999, mean=0.0256
    Non-zero vertices: 120763/127387
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 6624  993 1088 3547    0 1910 1208 4763 5432]
  Ground Truth Stats:
    Labels shape: (127387,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-14/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7597
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8042
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8044

  RESULTS:
  RAW:         median(top-10)=0.9154, mean(top-10)=0.9140, median(all)=0.8025, mean(all)=0.7597
  + SMOOTHING: median(top-10)=0.9319, mean(top-10)=0.9357, median(all)=0.8501, mean(all)=0.8042 [+0.0165]
  + MRF:       median(top-10)=0.9323, mean(top-10)=0.9359, median(all)=0.8501, mean(all)=0.8044 [+0.0004]
  TOTAL IMPROVEMENT (median top-10): +0.0169

================================================================================
Subject: MMRR-21-15
================================================================================
  Step 0: Generating predictions with V2 model (30 random views)...
  Mesh: 137028 vertices, 274052 faces
  Generating 30 random views...
  Generating predictions for 30 views (continuous camera pose)...
    ✓ Random_0 (pose=(-1.2647501159168049, -2.608928606076854, 1.340899472674816)): shape (37, 800, 800)
      Valid pixels: 60032/640000 (9.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1506, max=274051, num_faces=274052
      Valid probs shape: (37, 60032)
    ✓ Random_1 (pose=(1.6948696909404735, -0.4456841405134324, 1.1356408698304303)): shape (37, 800, 800)
      Valid pixels: 62739/640000 (9.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=273971, num_faces=274052
      Valid probs shape: (37, 62739)
    ✓ Random_2 (pose=(1.2147970169847477, 2.562089896025305, 1.7780565923480047)): shape (37, 800, 800)
      Valid pixels: 73581/640000 (11.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=67, max=274049, num_faces=274052
      Valid probs shape: (37, 73581)
    ✓ Random_3 (pose=(1.1184511798014505, 1.9933331024965941, -1.1547314670998465)): shape (37, 800, 800)
      Valid pixels: 87504/640000 (13.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=25, max=273971, num_faces=274052
      Valid probs shape: (37, 87504)
    ✓ Random_4 (pose=(1.9793428297657494, 1.9886294795422117, -2.959360157865958)): shape (37, 800, 800)
      Valid pixels: 84944/640000 (13.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=274044, num_faces=274052
      Valid probs shape: (37, 84944)
    ✓ Random_5 (pose=(2.032565276943342, -0.9980052453575419, 2.2643578356669654)): shape (37, 800, 800)
      Valid pixels: 87555/640000 (13.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=19, max=274051, num_faces=274052
      Valid probs shape: (37, 87555)
    ✓ Random_6 (pose=(0.7551993695040826, -2.095143377201257, -0.7888194589799014)): shape (37, 800, 800)
      Valid pixels: 58103/640000 (9.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1530, max=274051, num_faces=274052
      Valid probs shape: (37, 58103)
    ✓ Random_7 (pose=(-2.19730666032642, -2.3369430887624896, 2.3509070163987937)): shape (37, 800, 800)
      Valid pixels: 64779/640000 (10.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=274051, num_faces=274052
      Valid probs shape: (37, 64779)
    ✓ Random_8 (pose=(0.46408610910472126, -2.5722880834231407, 2.607467596794324)): shape (37, 800, 800)
      Valid pixels: 55016/640000 (8.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=30149, max=274051, num_faces=274052
      Valid probs shape: (37, 55016)
    ✓ Random_9 (pose=(2.9176182699782958, 0.6256485351885659, 1.067458810917005)): shape (37, 800, 800)
      Valid pixels: 61669/640000 (9.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=140, max=274051, num_faces=274052
      Valid probs shape: (37, 61669)
    ✓ Random_10 (pose=(2.3973038486522062, 2.3048421139564352, -2.7394387252670382)): shape (37, 800, 800)
      Valid pixels: 77987/640000 (12.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=0, max=273341, num_faces=274052
      Valid probs shape: (37, 77987)
    ✓ Random_11 (pose=(0.964412657953746, -1.6719563597814875, 2.6959194776950266)): shape (37, 800, 800)
      Valid pixels: 78521/640000 (12.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=274050, num_faces=274052
      Valid probs shape: (37, 78521)
    ✓ Random_12 (pose=(3.088665933893772, -3.0942309067186007, 0.22757545670097645)): shape (37, 800, 800)
      Valid pixels: 35818/640000 (5.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=272897, num_faces=274052
      Valid probs shape: (37, 35818)
    ✓ Random_13 (pose=(-0.6455863138401439, 1.5765492551325258, 1.3418937409994474)): shape (37, 800, 800)
      Valid pixels: 74680/640000 (11.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=58, max=274047, num_faces=274052
      Valid probs shape: (37, 74680)
    ✓ Random_14 (pose=(-2.80620978251895, 2.5604847715167685, 1.6294923137459785)): shape (37, 800, 800)
      Valid pixels: 62738/640000 (9.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=273971, num_faces=274052
      Valid probs shape: (37, 62738)
    ✓ Random_15 (pose=(2.783996969199648, -2.6273580869179662, -2.577998211523025)): shape (37, 800, 800)
      Valid pixels: 46299/640000 (7.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=273970, num_faces=274052
      Valid probs shape: (37, 46299)
    ✓ Random_16 (pose=(1.9567673804626615, -0.25910790921681626, 1.9311633604622926)): shape (37, 800, 800)
      Valid pixels: 74295/640000 (11.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=70, max=274049, num_faces=274052
      Valid probs shape: (37, 74295)
    ✓ Random_17 (pose=(2.6822953121704165, -1.3126161325810113, 0.26212241510245926)): shape (37, 800, 800)
      Valid pixels: 59042/640000 (9.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=274051, num_faces=274052
      Valid probs shape: (37, 59042)
    ✓ Random_18 (pose=(2.4570939073874047, -3.1410490882806132, 2.0278733242127087)): shape (37, 800, 800)
      Valid pixels: 55647/640000 (8.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=272670, num_faces=274052
      Valid probs shape: (37, 55647)
    ✓ Random_19 (pose=(1.0555778064707377, 2.345754725577052, -1.0875934942614283)): shape (37, 800, 800)
      Valid pixels: 84491/640000 (13.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=123, max=273971, num_faces=274052
      Valid probs shape: (37, 84491)
    ✓ Random_20 (pose=(3.0277848814995556, -1.9592318396275308, 3.028213511861594)): shape (37, 800, 800)
      Valid pixels: 59230/640000 (9.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=274047, num_faces=274052
      Valid probs shape: (37, 59230)
    ✓ Random_21 (pose=(-0.8894994834646632, 0.9577984220054807, -0.6930240507783889)): shape (37, 800, 800)
      Valid pixels: 64935/640000 (10.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=274011, num_faces=274052
      Valid probs shape: (37, 64935)
    ✓ Random_22 (pose=(2.359793386153564, -1.9380470809788068, -1.2319148177228285)): shape (37, 800, 800)
      Valid pixels: 88796/640000 (13.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=9, max=273971, num_faces=274052
      Valid probs shape: (37, 88796)
    ✓ Random_23 (pose=(0.6467866476593, 2.9964828704680766, 1.95284958573614)): shape (37, 800, 800)
      Valid pixels: 63046/640000 (9.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=17356, max=274051, num_faces=274052
      Valid probs shape: (37, 63046)
    ✓ Random_24 (pose=(-0.8038269760692405, 3.017059824932919, -1.196219818493863)): shape (37, 800, 800)
      Valid pixels: 59057/640000 (9.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=12741, max=274049, num_faces=274052
      Valid probs shape: (37, 59057)
    ✓ Random_25 (pose=(2.9272466652734828, -0.7789970057090341, -1.3201812780546958)): shape (37, 800, 800)
      Valid pixels: 68444/640000 (10.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=120, max=274051, num_faces=274052
      Valid probs shape: (37, 68444)
    ✓ Random_26 (pose=(0.3972338936651232, -2.920709426866556, -0.8798835034158969)): shape (37, 800, 800)
      Valid pixels: 40612/640000 (6.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=9232, max=274051, num_faces=274052
      Valid probs shape: (37, 40612)
    ✓ Random_27 (pose=(1.1187318155898023, 0.0005752863581029999, 1.808593905394944)): shape (37, 800, 800)
      Valid pixels: 60647/640000 (9.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=273342, num_faces=274052
      Valid probs shape: (37, 60647)
    ✓ Random_28 (pose=(2.6688083990465747, 0.6319376919185529, -0.6497700840897185)): shape (37, 800, 800)
      Valid pixels: 49679/640000 (7.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2885, max=274051, num_faces=274052
      Valid probs shape: (37, 49679)
    ✓ Random_29 (pose=(1.0080370815949093, -1.162169551021367, -1.8111446752572002)): shape (37, 800, 800)
      Valid pixels: 67630/640000 (10.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=274047, num_faces=274052
      Valid probs shape: (37, 67630)
    P stats: min=0.0000, max=1.0000, mean=0.0249
    Non-zero vertices: 126319/137028
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 10709   973  1183  3498     0  2073  1146  4207  6195]
  Ground Truth Stats:
    Labels shape: (137028,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-15/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7643
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8186
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8186

  RESULTS:
  RAW:         median(top-10)=0.8891, mean(top-10)=0.8943, median(all)=0.8196, mean(all)=0.7643
  + SMOOTHING: median(top-10)=0.9128, mean(top-10)=0.9206, median(all)=0.8717, mean(all)=0.8186 [+0.0236]
  + MRF:       median(top-10)=0.9130, mean(top-10)=0.9208, median(all)=0.8721, mean(all)=0.8186 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0239

================================================================================
Subject: MMRR-21-16
================================================================================
  Step 0: Generating predictions with V2 model (30 random views)...
  Mesh: 147500 vertices, 294996 faces
  Generating 30 random views...
  Generating predictions for 30 views (continuous camera pose)...
    ✓ Random_0 (pose=(-2.0096618067494543, 1.1232594953620305, 0.528079430848297)): shape (37, 800, 800)
      Valid pixels: 67296/640000 (10.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=240, max=294991, num_faces=294996
      Valid probs shape: (37, 67296)
    ✓ Random_1 (pose=(2.6368629029876143, 1.3877930557859885, -1.4353626871385332)): shape (37, 800, 800)
      Valid pixels: 72044/640000 (11.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=61, max=294995, num_faces=294996
      Valid probs shape: (37, 72044)
    ✓ Random_2 (pose=(0.5772974128305681, 0.1416752107901087, 1.8304102734805383)): shape (37, 800, 800)
      Valid pixels: 58357/640000 (9.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=294726, num_faces=294996
      Valid probs shape: (37, 58357)
    ✓ Random_3 (pose=(-0.7540159263206467, -1.0670941016134758, -0.5928764694754274)): shape (37, 800, 800)
      Valid pixels: 78861/640000 (12.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=294821, num_faces=294996
      Valid probs shape: (37, 78861)
    ✓ Random_4 (pose=(-1.9260964343341076, 2.870010018384235, 1.013267268790675)): shape (37, 800, 800)
      Valid pixels: 62507/640000 (9.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=4, max=294924, num_faces=294996
      Valid probs shape: (37, 62507)
    ✓ Random_5 (pose=(1.7812912089292166, -0.005881040728551223, -3.0604733972726716)): shape (37, 800, 800)
      Valid pixels: 85150/640000 (13.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=39, max=294991, num_faces=294996
      Valid probs shape: (37, 85150)
    ✓ Random_6 (pose=(-2.898233987065275, -0.8364230917325148, -0.8967664254074279)): shape (37, 800, 800)
      Valid pixels: 58778/640000 (9.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=85, max=294995, num_faces=294996
      Valid probs shape: (37, 58778)
    ✓ Random_7 (pose=(0.16472433828364563, -2.517506788252607, 2.005506156078291)): shape (37, 800, 800)
      Valid pixels: 55423/640000 (8.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=516, max=294995, num_faces=294996
      Valid probs shape: (37, 55423)
    ✓ Random_8 (pose=(-1.534436340413577, -3.1054748805159393, -0.46392925583242395)): shape (37, 800, 800)
      Valid pixels: 92325/640000 (14.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=294991, num_faces=294996
      Valid probs shape: (37, 92325)
    ✓ Random_9 (pose=(0.02545618580126563, 1.7779002160967545, -2.2317094127081374)): shape (37, 800, 800)
      Valid pixels: 92737/640000 (14.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=294925, num_faces=294996
      Valid probs shape: (37, 92737)
    ✓ Random_10 (pose=(-2.9843701715468334, 2.027952055722623, -2.224742731370037)): shape (37, 800, 800)
      Valid pixels: 82427/640000 (12.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=294983, num_faces=294996
      Valid probs shape: (37, 82427)
    ✓ Random_11 (pose=(-0.4977066740276008, -0.4486454753218321, 0.0700874108877021)): shape (37, 800, 800)
      Valid pixels: 55337/640000 (8.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=294473, num_faces=294996
      Valid probs shape: (37, 55337)
    ✓ Random_12 (pose=(-1.8599475322417363, 0.6483766220010572, -0.010725893035699041)): shape (37, 800, 800)
      Valid pixels: 82955/640000 (13.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=65, max=294991, num_faces=294996
      Valid probs shape: (37, 82955)
    ✓ Random_13 (pose=(-2.6300194165226904, -2.0072833237998666, -1.9901665267985305)): shape (37, 800, 800)
      Valid pixels: 85161/640000 (13.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=294925, num_faces=294996
      Valid probs shape: (37, 85161)
    ✓ Random_14 (pose=(0.9699506490694718, 2.1564977580742966, 2.2722530038513424)): shape (37, 800, 800)
      Valid pixels: 88959/640000 (13.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=273, max=294995, num_faces=294996
      Valid probs shape: (37, 88959)
    ✓ Random_15 (pose=(-2.7125312304817877, -2.0609176035586967, 0.8346681183939162)): shape (37, 800, 800)
      Valid pixels: 84897/640000 (13.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=5, max=294982, num_faces=294996
      Valid probs shape: (37, 84897)
    ✓ Random_16 (pose=(3.0113111053404324, 0.7244434172238559, -0.7720754685006996)): shape (37, 800, 800)
      Valid pixels: 57467/640000 (9.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=567, max=294991, num_faces=294996
      Valid probs shape: (37, 57467)
    ✓ Random_17 (pose=(0.16582970648280826, -0.08886545448633587, 0.9969942854505263)): shape (37, 800, 800)
      Valid pixels: 41099/640000 (6.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=294917, num_faces=294996
      Valid probs shape: (37, 41099)
    ✓ Random_18 (pose=(2.446541186460543, 1.896447314693753, 2.5198050640101464)): shape (37, 800, 800)
      Valid pixels: 62396/640000 (9.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=294994, num_faces=294996
      Valid probs shape: (37, 62396)
    ✓ Random_19 (pose=(0.8811626811004585, 1.740533007436368, 0.02697631670608036)): shape (37, 800, 800)
      Valid pixels: 72550/640000 (11.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=294994, num_faces=294996
      Valid probs shape: (37, 72550)
    ✓ Random_20 (pose=(1.3268186190929256, 1.7751615327029429, -2.0952434446461723)): shape (37, 800, 800)
      Valid pixels: 63470/640000 (9.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=51, max=294995, num_faces=294996
      Valid probs shape: (37, 63470)
    ✓ Random_21 (pose=(-1.6873209909586797, 1.0436177526326267, -1.3583753511412804)): shape (37, 800, 800)
      Valid pixels: 72857/640000 (11.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=13, max=294995, num_faces=294996
      Valid probs shape: (37, 72857)
    ✓ Random_22 (pose=(-2.1070512283649387, 2.7194576340513947, -0.8805465207981222)): shape (37, 800, 800)
      Valid pixels: 84097/640000 (13.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=294821, num_faces=294996
      Valid probs shape: (37, 84097)
    ✓ Random_23 (pose=(-0.30402720246891635, -0.6200574870144142, 3.030949885289945)): shape (37, 800, 800)
      Valid pixels: 54424/640000 (8.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=294921, num_faces=294996
      Valid probs shape: (37, 54424)
    ✓ Random_24 (pose=(3.0754069842949203, -1.6744105903634714, -2.105848617830328)): shape (37, 800, 800)
      Valid pixels: 93781/640000 (14.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=294925, num_faces=294996
      Valid probs shape: (37, 93781)
    ✓ Random_25 (pose=(1.9205025958217679, -1.3038525253885527, 0.1313428745969869)): shape (37, 800, 800)
      Valid pixels: 80097/640000 (12.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=15, max=294925, num_faces=294996
      Valid probs shape: (37, 80097)
    ✓ Random_26 (pose=(1.8281483178550468, 0.07874550279849357, -0.3213431068655286)): shape (37, 800, 800)
      Valid pixels: 94894/640000 (14.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=294925, num_faces=294996
      Valid probs shape: (37, 94894)
    ✓ Random_27 (pose=(-1.7522345548215807, 1.1401389917151166, 0.12233191209732386)): shape (37, 800, 800)
      Valid pixels: 80364/640000 (12.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=40, max=294991, num_faces=294996
      Valid probs shape: (37, 80364)
    ✓ Random_28 (pose=(1.2577697497780829, -2.542766446236218, -2.1877912079866273)): shape (37, 800, 800)
      Valid pixels: 69593/640000 (10.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=575, max=294995, num_faces=294996
      Valid probs shape: (37, 69593)
    ✓ Random_29 (pose=(-3.1289345617498845, -2.6472130201862036, 2.64400871028349)): shape (37, 800, 800)
      Valid pixels: 48379/640000 (7.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=294735, num_faces=294996
      Valid probs shape: (37, 48379)
    P stats: min=0.0000, max=1.0000, mean=0.0254
    Non-zero vertices: 138686/147500
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 8814 1266 1322 3133    0 2324  928 4823 7143]
  Ground Truth Stats:
    Labels shape: (147500,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-16/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7774
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8227
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8227

  RESULTS:
  RAW:         median(top-10)=0.9033, mean(top-10)=0.9042, median(all)=0.8520, mean(all)=0.7774
  + SMOOTHING: median(top-10)=0.9237, mean(top-10)=0.9294, median(all)=0.8691, mean(all)=0.8227 [+0.0204]
  + MRF:       median(top-10)=0.9241, mean(top-10)=0.9294, median(all)=0.8695, mean(all)=0.8227 [+0.0004]
  TOTAL IMPROVEMENT (median top-10): +0.0208

================================================================================
Subject: MMRR-21-17
================================================================================
  Step 0: Generating predictions with V2 model (30 random views)...
  Mesh: 126138 vertices, 252272 faces
  Generating 30 random views...
  Generating predictions for 30 views (continuous camera pose)...
    ✓ Random_0 (pose=(1.8942302245923663, -2.033384933507416, -2.7146406492671984)): shape (37, 800, 800)
      Valid pixels: 72804/640000 (11.4%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=1, max=252268, num_faces=252272
      Valid probs shape: (37, 72804)
    ✓ Random_1 (pose=(0.0858041366198865, -2.954561537452515, -0.11775405390650295)): shape (37, 800, 800)
      Valid pixels: 46216/640000 (7.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3767, max=252268, num_faces=252272
      Valid probs shape: (37, 46216)
    ✓ Random_2 (pose=(-0.3606078406451032, 2.645292996943229, 0.20630933383801553)): shape (37, 800, 800)
      Valid pixels: 74471/640000 (11.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2010, max=252268, num_faces=252272
      Valid probs shape: (37, 74471)
    ✓ Random_3 (pose=(-1.768503984709787, -0.7171257949179113, 1.6790140342375066)): shape (37, 800, 800)
      Valid pixels: 68364/640000 (10.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=252203, num_faces=252272
      Valid probs shape: (37, 68364)
    ✓ Random_4 (pose=(0.6031935964750978, -0.17116551818178394, -1.900418410693455)): shape (37, 800, 800)
      Valid pixels: 56169/640000 (8.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=252200, num_faces=252272
      Valid probs shape: (37, 56169)
    ✓ Random_5 (pose=(-0.6864810519364877, 0.36598382644950034, -0.7546200806348371)): shape (37, 800, 800)
      Valid pixels: 72844/640000 (11.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=252268, num_faces=252272
      Valid probs shape: (37, 72844)
    ✓ Random_6 (pose=(-1.9630672433202114, -0.7897283297110209, -2.510614540987054)): shape (37, 800, 800)
      Valid pixels: 88452/640000 (13.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=19, max=252270, num_faces=252272
      Valid probs shape: (37, 88452)
    ✓ Random_7 (pose=(-1.6729613199736089, -1.2075643780118306, 1.0765074820024179)): shape (37, 800, 800)
      Valid pixels: 69761/640000 (10.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=11, max=252127, num_faces=252272
      Valid probs shape: (37, 69761)
    ✓ Random_8 (pose=(1.1482511667580395, -0.027226519533277038, 1.0511899452457145)): shape (37, 800, 800)
      Valid pixels: 67679/640000 (10.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=252270, num_faces=252272
      Valid probs shape: (37, 67679)
    ✓ Random_9 (pose=(-2.374849582902795, 3.1404852393504443, -1.8784360778756137)): shape (37, 800, 800)
      Valid pixels: 59070/640000 (9.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=252002, num_faces=252272
      Valid probs shape: (37, 59070)
    ✓ Random_10 (pose=(2.1412571820139013, -1.7019741563348418, 2.7796921093404254)): shape (37, 800, 800)
      Valid pixels: 87912/640000 (13.7%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=12, max=252271, num_faces=252272
      Valid probs shape: (37, 87912)
    ✓ Random_11 (pose=(-0.6532042388064783, 1.5445975899817634, -2.701601165948546)): shape (37, 800, 800)
      Valid pixels: 106229/640000 (16.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=252204, num_faces=252272
      Valid probs shape: (37, 106229)
    ✓ Random_12 (pose=(1.718834731376596, -1.245304298998146, -2.56778134666453)): shape (37, 800, 800)
      Valid pixels: 74955/640000 (11.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=16, max=252271, num_faces=252272
      Valid probs shape: (37, 74955)
    ✓ Random_13 (pose=(-3.0167892840356463, -1.1273479216905309, -2.081662978573605)): shape (37, 800, 800)
      Valid pixels: 99188/640000 (15.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=169, max=252204, num_faces=252272
      Valid probs shape: (37, 99188)
    ✓ Random_14 (pose=(-0.3999287501176121, 0.3711538642659318, -0.5765956738165441)): shape (37, 800, 800)
      Valid pixels: 62219/640000 (9.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=251948, num_faces=252272
      Valid probs shape: (37, 62219)
    ✓ Random_15 (pose=(-2.2847848711918393, -1.3205901352737746, -1.648256039822415)): shape (37, 800, 800)
      Valid pixels: 74815/640000 (11.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=19, max=252270, num_faces=252272
      Valid probs shape: (37, 74815)
    ✓ Random_16 (pose=(2.7592545474670507, 2.6505658655636575, 2.9350559475798947)): shape (37, 800, 800)
      Valid pixels: 69436/640000 (10.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=251966, num_faces=252272
      Valid probs shape: (37, 69436)
    ✓ Random_17 (pose=(-1.0483119251495365, 0.1722000171681053, 0.6659248250111118)): shape (37, 800, 800)
      Valid pixels: 70792/640000 (11.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=252198, num_faces=252272
      Valid probs shape: (37, 70792)
    ✓ Random_18 (pose=(-1.9053313621607446, -0.14083831069872987, -2.3017206498291065)): shape (37, 800, 800)
      Valid pixels: 72687/640000 (11.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=34, max=252270, num_faces=252272
      Valid probs shape: (37, 72687)
    ✓ Random_19 (pose=(-0.2808062681020229, -1.3739762212724884, 1.7932096754067954)): shape (37, 800, 800)
      Valid pixels: 102528/640000 (16.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=252204, num_faces=252272
      Valid probs shape: (37, 102528)
    ✓ Random_20 (pose=(1.1470070488592254, 0.6582015126907512, 1.136394657708565)): shape (37, 800, 800)
      Valid pixels: 61115/640000 (9.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=252270, num_faces=252272
      Valid probs shape: (37, 61115)
    ✓ Random_21 (pose=(-3.0315820541663316, 1.8167016174917263, -2.1957891469954123)): shape (37, 800, 800)
      Valid pixels: 99008/640000 (15.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=252270, num_faces=252272
      Valid probs shape: (37, 99008)
    ✓ Random_22 (pose=(2.803062503990188, -0.10075276321365889, 0.57148939807302)): shape (37, 800, 800)
      Valid pixels: 50748/640000 (7.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1267, max=252268, num_faces=252272
      Valid probs shape: (37, 50748)
    ✓ Random_23 (pose=(0.9514125476343294, -2.2014262545520085, -1.9211532400176838)): shape (37, 800, 800)
      Valid pixels: 75886/640000 (11.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=206, max=252271, num_faces=252272
      Valid probs shape: (37, 75886)
    ✓ Random_24 (pose=(1.1619615472601224, -0.1983294338268209, 0.9836953240729471)): shape (37, 800, 800)
      Valid pixels: 71538/640000 (11.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=252267, num_faces=252272
      Valid probs shape: (37, 71538)
    ✓ Random_25 (pose=(0.6510800265627377, 2.4618880025736782, -1.126854036267051)): shape (37, 800, 800)
      Valid pixels: 90478/640000 (14.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=182, max=252204, num_faces=252272
      Valid probs shape: (37, 90478)
    ✓ Random_26 (pose=(-1.8587102031979819, 1.7131781293877362, -0.4055918840141217)): shape (37, 800, 800)
      Valid pixels: 97828/640000 (15.3%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=14, max=252271, num_faces=252272
      Valid probs shape: (37, 97828)
    ✓ Random_27 (pose=(2.0409498632259284, 1.2198016088019905, -3.107721282809366)): shape (37, 800, 800)
      Valid pixels: 101608/640000 (15.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=28, max=252271, num_faces=252272
      Valid probs shape: (37, 101608)
    ✓ Random_28 (pose=(1.2547903500735673, 2.6069688430716873, -2.878238551802614)): shape (37, 800, 800)
      Valid pixels: 81660/640000 (12.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=103, max=252271, num_faces=252272
      Valid probs shape: (37, 81660)
    ✓ Random_29 (pose=(0.059772537735078846, 0.5013330568831673, 0.2265406209202685)): shape (37, 800, 800)
      Valid pixels: 56919/640000 (8.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=251932, num_faces=252272
      Valid probs shape: (37, 56919)
    P stats: min=0.0000, max=1.0000, mean=0.0260
    Non-zero vertices: 121295/126138
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 4843 1328 1253 2865    0 2841 1072 5014 5566]
  Ground Truth Stats:
    Labels shape: (126138,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-17/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7884
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8316
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8317

  RESULTS:
  RAW:         median(top-10)=0.9156, mean(top-10)=0.9147, median(all)=0.8591, mean(all)=0.7884
  + SMOOTHING: median(top-10)=0.9317, mean(top-10)=0.9316, median(all)=0.8910, mean(all)=0.8316 [+0.0161]
  + MRF:       median(top-10)=0.9315, mean(top-10)=0.9318, median(all)=0.8914, mean(all)=0.8317 [-0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0159

================================================================================
Subject: MMRR-21-18
================================================================================
  Step 0: Generating predictions with V2 model (30 random views)...
  Mesh: 131379 vertices, 262754 faces
  Generating 30 random views...
  Generating predictions for 30 views (continuous camera pose)...
    ✓ Random_0 (pose=(0.8120870443185497, -1.8681358431157202, -2.946274528929813)): shape (37, 800, 800)
      Valid pixels: 89797/640000 (14.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=15, max=262751, num_faces=262754
      Valid probs shape: (37, 89797)
    ✓ Random_1 (pose=(2.145627208970928, 0.7112256523307701, 1.2672391732229462)): shape (37, 800, 800)
      Valid pixels: 70065/640000 (10.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=262753, num_faces=262754
      Valid probs shape: (37, 70065)
    ✓ Random_2 (pose=(0.4559817650165243, -0.8103112798894374, 2.0052857605501835)): shape (37, 800, 800)
      Valid pixels: 61029/640000 (9.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=262709, num_faces=262754
      Valid probs shape: (37, 61029)
    ✓ Random_3 (pose=(-2.7017522253308903, -1.5489227442909281, -0.2528916188588748)): shape (37, 800, 800)
      Valid pixels: 69438/640000 (10.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6, max=262751, num_faces=262754
      Valid probs shape: (37, 69438)
    ✓ Random_4 (pose=(1.4420686956013062, 0.5299191547619886, -0.24547061422273586)): shape (37, 800, 800)
      Valid pixels: 94147/640000 (14.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=262753, num_faces=262754
      Valid probs shape: (37, 94147)
    ✓ Random_5 (pose=(-2.6073729282374596, 0.09616785616873047, -2.2122064963369046)): shape (37, 800, 800)
      Valid pixels: 52022/640000 (8.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1433, max=262753, num_faces=262754
      Valid probs shape: (37, 52022)
    ✓ Random_6 (pose=(0.900718131759521, -0.7224504525641424, -2.663072569501659)): shape (37, 800, 800)
      Valid pixels: 78436/640000 (12.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=262440, num_faces=262754
      Valid probs shape: (37, 78436)
    ✓ Random_7 (pose=(-2.0751027932801516, -2.9865257703717507, -0.2919525453416516)): shape (37, 800, 800)
      Valid pixels: 83376/640000 (13.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=260804, num_faces=262754
      Valid probs shape: (37, 83376)
    ✓ Random_8 (pose=(1.9663029774761318, -3.1092465155726186, -2.5391272773862132)): shape (37, 800, 800)
      Valid pixels: 70171/640000 (11.0%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=0, max=262445, num_faces=262754
      Valid probs shape: (37, 70171)
    ✓ Random_9 (pose=(-0.6034564685270611, -2.6589341156178388, -1.1226973607591701)): shape (37, 800, 800)
      Valid pixels: 75613/640000 (11.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=17848, max=262751, num_faces=262754
      Valid probs shape: (37, 75613)
    ✓ Random_10 (pose=(0.30417742502255063, -2.450582724211009, 2.8688265060366556)): shape (37, 800, 800)
      Valid pixels: 59339/640000 (9.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=13331, max=262751, num_faces=262754
      Valid probs shape: (37, 59339)
    ✓ Random_11 (pose=(-2.8211086551294153, 2.350170334654835, 0.5669931478404959)): shape (37, 800, 800)
      Valid pixels: 55629/640000 (8.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=262643, num_faces=262754
      Valid probs shape: (37, 55629)
    ✓ Random_12 (pose=(-0.32967936103644435, 2.41922102357986, -0.4043708887277475)): shape (37, 800, 800)
      Valid pixels: 57279/640000 (8.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=21217, max=262753, num_faces=262754
      Valid probs shape: (37, 57279)
    ✓ Random_13 (pose=(-1.639574106020411, -1.534075434110138, -0.09915406582887831)): shape (37, 800, 800)
      Valid pixels: 88234/640000 (13.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=11, max=262751, num_faces=262754
      Valid probs shape: (37, 88234)
    ✓ Random_14 (pose=(-3.116882715986097, -0.1341099801497907, 1.9928274285975354)): shape (37, 800, 800)
      Valid pixels: 44907/640000 (7.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=8444, max=262751, num_faces=262754
      Valid probs shape: (37, 44907)
    ✓ Random_15 (pose=(1.443886918040417, 0.6746443386997694, -3.019259883024445)): shape (37, 800, 800)
      Valid pixels: 79675/640000 (12.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=9, max=262751, num_faces=262754
      Valid probs shape: (37, 79675)
    ✓ Random_16 (pose=(-1.1439124093215465, -2.385593106677083, -1.9939736697577868)): shape (37, 800, 800)
      Valid pixels: 62243/640000 (9.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=262753, num_faces=262754
      Valid probs shape: (37, 62243)
    ✓ Random_17 (pose=(-0.688694030321098, -2.211805172874975, -0.9360761877790469)): shape (37, 800, 800)
      Valid pixels: 83383/640000 (13.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=86, max=262751, num_faces=262754
      Valid probs shape: (37, 83383)
    ✓ Random_18 (pose=(0.7058771977166138, 1.2719775946003056, -1.8611715690905661)): shape (37, 800, 800)
      Valid pixels: 82549/640000 (12.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=262747, num_faces=262754
      Valid probs shape: (37, 82549)
    ✓ Random_19 (pose=(-2.712723942132014, 2.804808582926719, -2.7476303075256427)): shape (37, 800, 800)
      Valid pixels: 51807/640000 (8.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=262650, num_faces=262754
      Valid probs shape: (37, 51807)
    ✓ Random_20 (pose=(0.997590559115519, 0.4536101067992555, 1.740004838504544)): shape (37, 800, 800)
      Valid pixels: 73608/640000 (11.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=260873, num_faces=262754
      Valid probs shape: (37, 73608)
    ✓ Random_21 (pose=(0.6149391201454106, -2.8023245372546364, -2.0489335891535685)): shape (37, 800, 800)
      Valid pixels: 62289/640000 (9.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3885, max=262751, num_faces=262754
      Valid probs shape: (37, 62289)
    ✓ Random_22 (pose=(-1.1391208945186317, -2.4344297985375447, 2.485925022657236)): shape (37, 800, 800)
      Valid pixels: 92320/640000 (14.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=31, max=262753, num_faces=262754
      Valid probs shape: (37, 92320)
    ✓ Random_23 (pose=(0.15879657403794445, 3.0087678986045363, -2.044628539596478)): shape (37, 800, 800)
      Valid pixels: 39932/640000 (6.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=641, max=262751, num_faces=262754
      Valid probs shape: (37, 39932)
    ✓ Random_24 (pose=(0.595286126581732, -0.8057220364796516, 1.0738788386144007)): shape (37, 800, 800)
      Valid pixels: 74499/640000 (11.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=262753, num_faces=262754
      Valid probs shape: (37, 74499)
    ✓ Random_25 (pose=(0.22289294186668007, -0.40921879838744024, 0.01543682106621036)): shape (37, 800, 800)
      Valid pixels: 52437/640000 (8.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=262643, num_faces=262754
      Valid probs shape: (37, 52437)
    ✓ Random_26 (pose=(-1.2021137189636104, -2.4192646307304075, 2.7388607299840464)): shape (37, 800, 800)
      Valid pixels: 91671/640000 (14.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=262753, num_faces=262754
      Valid probs shape: (37, 91671)
    ✓ Random_27 (pose=(-2.8591876141604184, 2.700949194029562, 1.7932948504988655)): shape (37, 800, 800)
      Valid pixels: 59110/640000 (9.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=262753, num_faces=262754
      Valid probs shape: (37, 59110)
    ✓ Random_28 (pose=(-0.44611623674791545, -1.1963437477741603, -1.2101216256128278)): shape (37, 800, 800)
      Valid pixels: 83681/640000 (13.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=262705, num_faces=262754
      Valid probs shape: (37, 83681)
    ✓ Random_29 (pose=(-2.4390851074271382, 2.7382833578688395, 0.6010731801665803)): shape (37, 800, 800)
      Valid pixels: 57527/640000 (9.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=262643, num_faces=262754
      Valid probs shape: (37, 57527)
    P stats: min=0.0000, max=1.0000, mean=0.0256
    Non-zero vertices: 124364/131379
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 7015  959 1404 3269    0 1883  910 4059 5867]
  Ground Truth Stats:
    Labels shape: (131379,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-18/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7782
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8282
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8289

  RESULTS:
  RAW:         median(top-10)=0.9128, mean(top-10)=0.9098, median(all)=0.8172, mean(all)=0.7782
  + SMOOTHING: median(top-10)=0.9307, mean(top-10)=0.9323, median(all)=0.8536, mean(all)=0.8282 [+0.0179]
  + MRF:       median(top-10)=0.9308, mean(top-10)=0.9326, median(all)=0.8547, mean(all)=0.8289 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0181

================================================================================
Subject: MMRR-21-19
================================================================================
  Step 0: Generating predictions with V2 model (30 random views)...
  Mesh: 145253 vertices, 290502 faces
  Generating 30 random views...
  Generating predictions for 30 views (continuous camera pose)...
    ✓ Random_0 (pose=(-1.353660433277696, 0.9029469622965252, -2.678165692161163)): shape (37, 800, 800)
      Valid pixels: 94586/640000 (14.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=290497, num_faces=290502
      Valid probs shape: (37, 94586)
    ✓ Random_1 (pose=(0.572144818172641, 2.623968773681784, 2.8852462195792317)): shape (37, 800, 800)
      Valid pixels: 74078/640000 (11.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5217, max=290501, num_faces=290502
      Valid probs shape: (37, 74078)
    ✓ Random_2 (pose=(-1.6198033142176225, 0.7396550576890562, 1.1450136664812023)): shape (37, 800, 800)
      Valid pixels: 72864/640000 (11.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=53, max=290501, num_faces=290502
      Valid probs shape: (37, 72864)
    ✓ Random_3 (pose=(1.645932841688019, 2.8219618892228047, -2.9176169012535786)): shape (37, 800, 800)
      Valid pixels: 91765/640000 (14.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=10, max=290501, num_faces=290502
      Valid probs shape: (37, 91765)
    ✓ Random_4 (pose=(-0.08202098500550647, 0.816862804001222, -2.6528263567928922)): shape (37, 800, 800)
      Valid pixels: 68300/640000 (10.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=290500, num_faces=290502
      Valid probs shape: (37, 68300)
    ✓ Random_5 (pose=(-1.6076646361281217, -1.17235830000445, 0.6947015030080235)): shape (37, 800, 800)
      Valid pixels: 78356/640000 (12.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=290499, num_faces=290502
      Valid probs shape: (37, 78356)
    ✓ Random_6 (pose=(2.44609135298363, -0.07259112285192115, -1.6851146619999564)): shape (37, 800, 800)
      Valid pixels: 70541/640000 (11.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2519, max=290501, num_faces=290502
      Valid probs shape: (37, 70541)
    ✓ Random_7 (pose=(1.7362243763532463, 0.17601036848154727, 2.6360652846588533)): shape (37, 800, 800)
      Valid pixels: 102498/640000 (16.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=290138, num_faces=290502
      Valid probs shape: (37, 102498)
    ✓ Random_8 (pose=(-1.9699365110375724, -0.2230992034367909, -0.8615231385754147)): shape (37, 800, 800)
      Valid pixels: 89581/640000 (14.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=834, max=290501, num_faces=290502
      Valid probs shape: (37, 89581)
    ✓ Random_9 (pose=(-1.776814624511657, 2.5539624335266558, 0.8125016383092336)): shape (37, 800, 800)
      Valid pixels: 71599/640000 (11.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=290499, num_faces=290502
      Valid probs shape: (37, 71599)
    ✓ Random_10 (pose=(-0.6854470579289389, 2.3295006395263513, 1.9260263920308098)): shape (37, 800, 800)
      Valid pixels: 75455/640000 (11.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=802, max=290501, num_faces=290502
      Valid probs shape: (37, 75455)
    ✓ Random_11 (pose=(2.362770133450087, -1.1750245408138054, 2.079536160501224)): shape (37, 800, 800)
      Valid pixels: 98513/640000 (15.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=3, max=290499, num_faces=290502
      Valid probs shape: (37, 98513)
    ✓ Random_12 (pose=(1.0447160229040557, 0.07313389558503225, 2.178511709350915)): shape (37, 800, 800)
      Valid pixels: 96092/640000 (15.0%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=0, max=290133, num_faces=290502
      Valid probs shape: (37, 96092)
    ✓ Random_13 (pose=(-2.081959453053992, 0.06714895189672898, 1.8037500719364479)): shape (37, 800, 800)
      Valid pixels: 84404/640000 (13.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=65, max=290501, num_faces=290502
      Valid probs shape: (37, 84404)
    ✓ Random_14 (pose=(-2.452127054242511, 0.8301753207449383, 0.3337417494860806)): shape (37, 800, 800)
      Valid pixels: 75947/640000 (11.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=802, max=290501, num_faces=290502
      Valid probs shape: (37, 75947)
    ✓ Random_15 (pose=(1.6304141116700661, 1.9606416991369429, 2.195047261693195)): shape (37, 800, 800)
      Valid pixels: 97390/640000 (15.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=9, max=290144, num_faces=290502
      Valid probs shape: (37, 97390)
    ✓ Random_16 (pose=(-1.5999208609583044, 2.6329196911965136, 1.903448175778876)): shape (37, 800, 800)
      Valid pixels: 86505/640000 (13.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=34, max=290501, num_faces=290502
      Valid probs shape: (37, 86505)
    ✓ Random_17 (pose=(1.9347783867172463, -1.745763017801816, -1.2441600553310717)): shape (37, 800, 800)
      Valid pixels: 100284/640000 (15.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=34, max=290501, num_faces=290502
      Valid probs shape: (37, 100284)
    ✓ Random_18 (pose=(2.062215905394523, -0.8729413451691617, -0.4684323859918571)): shape (37, 800, 800)
      Valid pixels: 105379/640000 (16.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=5, max=290501, num_faces=290502
      Valid probs shape: (37, 105379)
    ✓ Random_19 (pose=(-1.7028269803509926, 2.5609271250926637, -1.9830635220460298)): shape (37, 800, 800)
      Valid pixels: 71189/640000 (11.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=290438, num_faces=290502
      Valid probs shape: (37, 71189)
    ✓ Random_20 (pose=(2.7261325764119544, -2.607277216934848, -2.49385220991501)): shape (37, 800, 800)
      Valid pixels: 49116/640000 (7.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=290499, num_faces=290502
      Valid probs shape: (37, 49116)
    ✓ Random_21 (pose=(-0.10487067577178921, 3.003882445211688, -1.9222352211114166)): shape (37, 800, 800)
      Valid pixels: 48732/640000 (7.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4817, max=290501, num_faces=290502
      Valid probs shape: (37, 48732)
    ✓ Random_22 (pose=(-1.3416531500222224, -0.6319430000633095, -2.377747833991116)): shape (37, 800, 800)
      Valid pixels: 76914/640000 (12.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=290437, num_faces=290502
      Valid probs shape: (37, 76914)
    ✓ Random_23 (pose=(-2.797671068026855, -2.5226570931202317, 1.7996305561566288)): shape (37, 800, 800)
      Valid pixels: 61681/640000 (9.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=290058, num_faces=290502
      Valid probs shape: (37, 61681)
    ✓ Random_24 (pose=(1.6700347291036932, 0.427417191004964, 2.0904821447461277)): shape (37, 800, 800)
      Valid pixels: 92511/640000 (14.5%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=6, max=290031, num_faces=290502
      Valid probs shape: (37, 92511)
    ✓ Random_25 (pose=(-2.6123170856330655, 2.8903027291634187, -3.077250532226902)): shape (37, 800, 800)
      Valid pixels: 67253/640000 (10.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=290438, num_faces=290502
      Valid probs shape: (37, 67253)
    ✓ Random_26 (pose=(-3.014291153046788, 3.1216779823556937, -1.2999607586490038)): shape (37, 800, 800)
      Valid pixels: 56183/640000 (8.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=288277, num_faces=290502
      Valid probs shape: (37, 56183)
    ✓ Random_27 (pose=(2.7738234791866336, -0.8328727060335219, -0.9304251943430475)): shape (37, 800, 800)
      Valid pixels: 86947/640000 (13.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=245, max=290501, num_faces=290502
      Valid probs shape: (37, 86947)
    ✓ Random_28 (pose=(1.0402346222285521, 2.729935508927947, -1.2439024434124382)): shape (37, 800, 800)
      Valid pixels: 96872/640000 (15.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=49, max=290501, num_faces=290502
      Valid probs shape: (37, 96872)
    ✓ Random_29 (pose=(0.24441807316054964, 1.4858257463810975, -0.8811411154247875)): shape (37, 800, 800)
      Valid pixels: 89356/640000 (14.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=290493, num_faces=290502
      Valid probs shape: (37, 89356)
    P stats: min=0.0000, max=1.0000, mean=0.0255
    Non-zero vertices: 136879/145253
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 8374 1157 1028 3661    0 1780 1239 5056 7874]
  Ground Truth Stats:
    Labels shape: (145253,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-19/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7661
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8126
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8128

  RESULTS:
  RAW:         median(top-10)=0.8997, mean(top-10)=0.9013, median(all)=0.8515, mean(all)=0.7661
  + SMOOTHING: median(top-10)=0.9279, mean(top-10)=0.9284, median(all)=0.8739, mean(all)=0.8126 [+0.0282]
  + MRF:       median(top-10)=0.9284, mean(top-10)=0.9288, median(all)=0.8738, mean(all)=0.8128 [+0.0005]
  TOTAL IMPROVEMENT (median top-10): +0.0287

================================================================================
Subject: MMRR-21-2
================================================================================
  Step 0: Generating predictions with V2 model (30 random views)...
  Mesh: 148593 vertices, 297182 faces
  Generating 30 random views...
  Generating predictions for 30 views (continuous camera pose)...
    ✓ Random_0 (pose=(0.3209078407577768, -0.983896229165067, -2.950315274422792)): shape (37, 800, 800)
      Valid pixels: 79232/640000 (12.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=297129, num_faces=297182
      Valid probs shape: (37, 79232)
    ✓ Random_1 (pose=(2.070306695936016, 1.2864233246094425, 2.054464237579433)): shape (37, 800, 800)
      Valid pixels: 62456/640000 (9.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=27, max=297130, num_faces=297182
      Valid probs shape: (37, 62456)
    ✓ Random_2 (pose=(-2.1641044031929626, 2.763283289363768, -1.9773199516289695)): shape (37, 800, 800)
      Valid pixels: 59036/640000 (9.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=296915, num_faces=297182
      Valid probs shape: (37, 59036)
    ✓ Random_3 (pose=(2.458543966255286, 1.3795723181646995, 1.4008142376995085)): shape (37, 800, 800)
      Valid pixels: 86098/640000 (13.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=54, max=297178, num_faces=297182
      Valid probs shape: (37, 86098)
    ✓ Random_4 (pose=(2.728408471687758, 1.5023699987613828, -1.264438562000037)): shape (37, 800, 800)
      Valid pixels: 77528/640000 (12.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=31, max=297181, num_faces=297182
      Valid probs shape: (37, 77528)
    ✓ Random_5 (pose=(2.312385615466833, 1.951632305124214, -2.557389954604173)): shape (37, 800, 800)
      Valid pixels: 94053/640000 (14.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=2, max=297130, num_faces=297182
      Valid probs shape: (37, 94053)
    ✓ Random_6 (pose=(-3.007943742482204, -1.7644281120924945, 1.0676029459661764)): shape (37, 800, 800)
      Valid pixels: 97571/640000 (15.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=7, max=297131, num_faces=297182
      Valid probs shape: (37, 97571)
    ✓ Random_7 (pose=(1.2921459191466882, 1.0634405828900286, -2.5875079065091615)): shape (37, 800, 800)
      Valid pixels: 75405/640000 (11.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=13, max=297181, num_faces=297182
      Valid probs shape: (37, 75405)
    ✓ Random_8 (pose=(-0.16282151054001925, 0.6945779808567738, 2.9877574301898147)): shape (37, 800, 800)
      Valid pixels: 54046/640000 (8.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=296849, num_faces=297182
      Valid probs shape: (37, 54046)
    ✓ Random_9 (pose=(0.6948853374876109, -0.4207269751788889, 1.4234925928069257)): shape (37, 800, 800)
      Valid pixels: 61727/640000 (9.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=296839, num_faces=297182
      Valid probs shape: (37, 61727)
    ✓ Random_10 (pose=(1.247046981964897, 3.023167545097726, 0.43524698456691224)): shape (37, 800, 800)
      Valid pixels: 85164/640000 (13.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=21, max=297178, num_faces=297182
      Valid probs shape: (37, 85164)
    ✓ Random_11 (pose=(-1.534574295614487, 1.5870629302343362, -1.3659532001246417)): shape (37, 800, 800)
      Valid pixels: 68507/640000 (10.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=26, max=297130, num_faces=297182
      Valid probs shape: (37, 68507)
    ✓ Random_12 (pose=(1.3581199942201287, 2.695607446231625, -1.31967315866777)): shape (37, 800, 800)
      Valid pixels: 78836/640000 (12.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=20, max=297181, num_faces=297182
      Valid probs shape: (37, 78836)
    ✓ Random_13 (pose=(2.2028915538371487, 2.585736559935154, -2.419679150368083)): shape (37, 800, 800)
      Valid pixels: 78171/640000 (12.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=297168, num_faces=297182
      Valid probs shape: (37, 78171)
    ✓ Random_14 (pose=(2.6119972759521897, 2.4254852231361683, -0.14124269793119115)): shape (37, 800, 800)
      Valid pixels: 72183/640000 (11.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=297181, num_faces=297182
      Valid probs shape: (37, 72183)
    ✓ Random_15 (pose=(-1.3860853329670908, 0.3474260574023895, -0.525426791202686)): shape (37, 800, 800)
      Valid pixels: 96722/640000 (15.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=297178, num_faces=297182
      Valid probs shape: (37, 96722)
    ✓ Random_16 (pose=(-1.1785948881045514, 2.4647256292791413, -2.2857192489563123)): shape (37, 800, 800)
      Valid pixels: 82055/640000 (12.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=21, max=297178, num_faces=297182
      Valid probs shape: (37, 82055)
    ✓ Random_17 (pose=(-1.7534440858310738, 1.9601194193711402, 0.1487276563180484)): shape (37, 800, 800)
      Valid pixels: 86943/640000 (13.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=16, max=297181, num_faces=297182
      Valid probs shape: (37, 86943)
    ✓ Random_18 (pose=(1.3017545576369134, 2.058653011324667, -2.10186491926617)): shape (37, 800, 800)
      Valid pixels: 68916/640000 (10.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=29, max=297181, num_faces=297182
      Valid probs shape: (37, 68916)
    ✓ Random_19 (pose=(2.6959595142668418, 0.4296173240758665, -0.0322204668922641)): shape (37, 800, 800)
      Valid pixels: 65777/640000 (10.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=770, max=297181, num_faces=297182
      Valid probs shape: (37, 65777)
    ✓ Random_20 (pose=(-2.6170872108211585, -1.006167536194602, 0.6502365421857075)): shape (37, 800, 800)
      Valid pixels: 92842/640000 (14.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=324, max=297178, num_faces=297182
      Valid probs shape: (37, 92842)
    ✓ Random_21 (pose=(0.5810526272022352, -1.1032896922344668, -0.5865250257579748)): shape (37, 800, 800)
      Valid pixels: 62133/640000 (9.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=297181, num_faces=297182
      Valid probs shape: (37, 62133)
    ✓ Random_22 (pose=(-1.677241157805993, -1.6986433184548575, -1.7732114477973506)): shape (37, 800, 800)
      Valid pixels: 66537/640000 (10.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=297178, num_faces=297182
      Valid probs shape: (37, 66537)
    ✓ Random_23 (pose=(1.1543869051688365, 2.2862165721253866, 1.4479316212731872)): shape (37, 800, 800)
      Valid pixels: 69246/640000 (10.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=316, max=297178, num_faces=297182
      Valid probs shape: (37, 69246)
    ✓ Random_24 (pose=(0.11672139772403689, -1.0580026659216277, -0.03118819870863687)): shape (37, 800, 800)
      Valid pixels: 60545/640000 (9.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=297180, num_faces=297182
      Valid probs shape: (37, 60545)
    ✓ Random_25 (pose=(-1.6232226097408782, -0.20151922714453985, -0.06336359813947956)): shape (37, 800, 800)
      Valid pixels: 96267/640000 (15.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=64, max=297181, num_faces=297182
      Valid probs shape: (37, 96267)
    ✓ Random_26 (pose=(2.746937056809137, -2.0787679710531863, -1.2966019080695736)): shape (37, 800, 800)
      Valid pixels: 93920/640000 (14.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=297181, num_faces=297182
      Valid probs shape: (37, 93920)
    ✓ Random_27 (pose=(0.6708075464534757, 1.1243342901117366, 2.6905932362450677)): shape (37, 800, 800)
      Valid pixels: 81134/640000 (12.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=2, max=297181, num_faces=297182
      Valid probs shape: (37, 81134)
    ✓ Random_28 (pose=(-1.56324784373527, -0.16539716810713045, 0.6628247419471958)): shape (37, 800, 800)
      Valid pixels: 78485/640000 (12.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=28, max=297181, num_faces=297182
      Valid probs shape: (37, 78485)
    ✓ Random_29 (pose=(-1.903204686991295, -1.4902220420647556, 2.185329854832027)): shape (37, 800, 800)
      Valid pixels: 75653/640000 (11.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=18, max=297181, num_faces=297182
      Valid probs shape: (37, 75653)
    P stats: min=0.0000, max=1.0000, mean=0.0248
    Non-zero vertices: 136452/148593
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 12141  1331  1070  4084     0  2155  1205  4735  6970]
  Ground Truth Stats:
    Labels shape: (148593,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-2/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7738
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8306
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8310

  RESULTS:
  RAW:         median(top-10)=0.8907, mean(top-10)=0.8983, median(all)=0.8471, mean(all)=0.7738
  + SMOOTHING: median(top-10)=0.9241, mean(top-10)=0.9297, median(all)=0.8765, mean(all)=0.8306 [+0.0334]
  + MRF:       median(top-10)=0.9247, mean(top-10)=0.9300, median(all)=0.8767, mean(all)=0.8310 [+0.0005]
  TOTAL IMPROVEMENT (median top-10): +0.0340

================================================================================
Subject: MMRR-21-20
================================================================================
  Step 0: Generating predictions with V2 model (30 random views)...
  Mesh: 149927 vertices, 299850 faces
  Generating 30 random views...
  Generating predictions for 30 views (continuous camera pose)...
    ✓ Random_0 (pose=(1.1765171415436821, -0.6405750047875944, 1.4162693508259299)): shape (37, 800, 800)
      Valid pixels: 58723/640000 (9.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=299608, num_faces=299850
      Valid probs shape: (37, 58723)
    ✓ Random_1 (pose=(2.474411964344676, 1.0239730604591966, -2.4151131241439314)): shape (37, 800, 800)
      Valid pixels: 87047/640000 (13.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=55, max=299845, num_faces=299850
      Valid probs shape: (37, 87047)
    ✓ Random_2 (pose=(2.975290269523967, 2.239051980327541, 1.5255570605341306)): shape (37, 800, 800)
      Valid pixels: 76839/640000 (12.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=299849, num_faces=299850
      Valid probs shape: (37, 76839)
    ✓ Random_3 (pose=(-2.754156799371652, 2.2418505620223383, -1.5419458545548377)): shape (37, 800, 800)
      Valid pixels: 75073/640000 (11.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=299800, num_faces=299850
      Valid probs shape: (37, 75073)
    ✓ Random_4 (pose=(-1.1186571793424847, -2.5337173587132598, 2.209965909461003)): shape (37, 800, 800)
      Valid pixels: 84397/640000 (13.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=299849, num_faces=299850
      Valid probs shape: (37, 84397)
    ✓ Random_5 (pose=(1.4672873867324139, -0.027104088434586338, -0.5715425198832387)): shape (37, 800, 800)
      Valid pixels: 92865/640000 (14.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=299849, num_faces=299850
      Valid probs shape: (37, 92865)
    ✓ Random_6 (pose=(-1.0140116874861742, 2.574153357490448, -1.2537431689991547)): shape (37, 800, 800)
      Valid pixels: 53508/640000 (8.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1606, max=299435, num_faces=299850
      Valid probs shape: (37, 53508)
    ✓ Random_7 (pose=(1.9713672980180315, 2.0127657705096826, 2.7141187955794175)): shape (37, 800, 800)
      Valid pixels: 84164/640000 (13.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=12, max=299824, num_faces=299850
      Valid probs shape: (37, 84164)
    ✓ Random_8 (pose=(-2.251992005338549, -1.758561944374571, 1.6277154320244875)): shape (37, 800, 800)
      Valid pixels: 66468/640000 (10.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=299848, num_faces=299850
      Valid probs shape: (37, 66468)
    ✓ Random_9 (pose=(-2.9153467864324822, 1.5769321103964264, 0.5340802582978257)): shape (37, 800, 800)
      Valid pixels: 68291/640000 (10.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=299849, num_faces=299850
      Valid probs shape: (37, 68291)
    ✓ Random_10 (pose=(1.7916770405176505, -0.6601069993317399, -1.1842808888841374)): shape (37, 800, 800)
      Valid pixels: 76741/640000 (12.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=31, max=299849, num_faces=299850
      Valid probs shape: (37, 76741)
    ✓ Random_11 (pose=(0.29072485657063574, 1.611159622372762, -2.880545736703849)): shape (37, 800, 800)
      Valid pixels: 58134/640000 (9.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=30, max=299849, num_faces=299850
      Valid probs shape: (37, 58134)
    ✓ Random_12 (pose=(-2.688766861101382, 2.597389526231578, -0.1252571495465835)): shape (37, 800, 800)
      Valid pixels: 55130/640000 (8.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=299847, num_faces=299850
      Valid probs shape: (37, 55130)
    ✓ Random_13 (pose=(-2.7247153288378807, -3.113290187271738, 0.6344475014236313)): shape (37, 800, 800)
      Valid pixels: 47627/640000 (7.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=299357, num_faces=299850
      Valid probs shape: (37, 47627)
    ✓ Random_14 (pose=(2.0873395568609556, -0.6996595211794845, 3.1356224174425726)): shape (37, 800, 800)
      Valid pixels: 80512/640000 (12.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=365, max=299847, num_faces=299850
      Valid probs shape: (37, 80512)
    ✓ Random_15 (pose=(0.02069957727641647, -2.0256321351701523, -1.0191309330420086)): shape (37, 800, 800)
      Valid pixels: 74229/640000 (11.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=419, max=299846, num_faces=299850
      Valid probs shape: (37, 74229)
    ✓ Random_16 (pose=(1.7456188606348233, -1.8822148493043263, -1.8926390631905419)): shape (37, 800, 800)
      Valid pixels: 59103/640000 (9.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=12, max=299849, num_faces=299850
      Valid probs shape: (37, 59103)
    ✓ Random_17 (pose=(0.1619963225994221, -0.5235263693975014, -0.4535318273119735)): shape (37, 800, 800)
      Valid pixels: 45262/640000 (7.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=299849, num_faces=299850
      Valid probs shape: (37, 45262)
    ✓ Random_18 (pose=(-2.96262556316878, -3.026301828109439, -1.7609668374421734)): shape (37, 800, 800)
      Valid pixels: 39179/640000 (6.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=299594, num_faces=299850
      Valid probs shape: (37, 39179)
    ✓ Random_19 (pose=(2.6196656105422775, -0.057929921981261234, -2.0279235277851964)): shape (37, 800, 800)
      Valid pixels: 46220/640000 (7.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6983, max=299846, num_faces=299850
      Valid probs shape: (37, 46220)
    ✓ Random_20 (pose=(2.033947296540992, 0.41486118224732715, 1.8000801652998373)): shape (37, 800, 800)
      Valid pixels: 54365/640000 (8.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1622, max=299435, num_faces=299850
      Valid probs shape: (37, 54365)
    ✓ Random_21 (pose=(1.5162743443389939, -0.3743753093802433, -0.9269228965003942)): shape (37, 800, 800)
      Valid pixels: 82706/640000 (12.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=16, max=299849, num_faces=299850
      Valid probs shape: (37, 82706)
    ✓ Random_22 (pose=(-0.7520089378397787, -1.9786864690097417, 2.805759971920674)): shape (37, 800, 800)
      Valid pixels: 79450/640000 (12.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=60, max=299608, num_faces=299850
      Valid probs shape: (37, 79450)
    ✓ Random_23 (pose=(-2.0307473211282114, 1.039301172335346, 2.836395373409138)): shape (37, 800, 800)
      Valid pixels: 89596/640000 (14.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=299849, num_faces=299850
      Valid probs shape: (37, 89596)
    ✓ Random_24 (pose=(-1.3861323519956612, 1.772596561404625, -0.5207034957271466)): shape (37, 800, 800)
      Valid pixels: 88162/640000 (13.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=299824, num_faces=299850
      Valid probs shape: (37, 88162)
    ✓ Random_25 (pose=(1.7208943321435957, 1.738305823226165, 2.1978425159670065)): shape (37, 800, 800)
      Valid pixels: 75452/640000 (11.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=8, max=299801, num_faces=299850
      Valid probs shape: (37, 75452)
    ✓ Random_26 (pose=(0.2487298425495248, -2.1537753975977845, -2.4732655627578333)): shape (37, 800, 800)
      Valid pixels: 83386/640000 (13.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3585, max=299824, num_faces=299850
      Valid probs shape: (37, 83386)
    ✓ Random_27 (pose=(-0.3857749389859664, -2.6909275972631033, -1.6049633131814904)): shape (37, 800, 800)
      Valid pixels: 65822/640000 (10.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=17709, max=299837, num_faces=299850
      Valid probs shape: (37, 65822)
    ✓ Random_28 (pose=(3.0019978803791716, 1.920348962667819, 1.9094776963847728)): shape (37, 800, 800)
      Valid pixels: 78445/640000 (12.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=299608, num_faces=299850
      Valid probs shape: (37, 78445)
    ✓ Random_29 (pose=(0.7948617090530599, -2.8794369131182, -1.6225815657555636)): shape (37, 800, 800)
      Valid pixels: 52617/640000 (8.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=583, max=299848, num_faces=299850
      Valid probs shape: (37, 52617)
    P stats: min=0.0000, max=1.0000, mean=0.0252
    Non-zero vertices: 139706/149927
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 10221  1388  1218  3070     0  2468  1020  5470  6720]
  Ground Truth Stats:
    Labels shape: (149927,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-20/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7700
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8250
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8254

  RESULTS:
  RAW:         median(top-10)=0.8996, mean(top-10)=0.9039, median(all)=0.8404, mean(all)=0.7700
  + SMOOTHING: median(top-10)=0.9264, mean(top-10)=0.9290, median(all)=0.8667, mean(all)=0.8250 [+0.0269]
  + MRF:       median(top-10)=0.9272, mean(top-10)=0.9295, median(all)=0.8669, mean(all)=0.8254 [+0.0008]
  TOTAL IMPROVEMENT (median top-10): +0.0277

================================================================================
Subject: MMRR-21-21
================================================================================
  Step 0: Generating predictions with V2 model (30 random views)...
  Mesh: 137496 vertices, 274988 faces
  Generating 30 random views...
  Generating predictions for 30 views (continuous camera pose)...
    ✓ Random_0 (pose=(-0.3006284972687996, 1.5059854766673428, 3.0253355612568704)): shape (37, 800, 800)
      Valid pixels: 69935/640000 (10.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=16, max=274984, num_faces=274988
      Valid probs shape: (37, 69935)
    ✓ Random_1 (pose=(0.02147154955680186, 1.299333011037601, 1.1377685692116497)): shape (37, 800, 800)
      Valid pixels: 94619/640000 (14.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=10, max=274959, num_faces=274988
      Valid probs shape: (37, 94619)
    ✓ Random_2 (pose=(-2.499576183952997, 0.7969525603447805, 1.554496888345839)): shape (37, 800, 800)
      Valid pixels: 84251/640000 (13.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=30, max=274985, num_faces=274988
      Valid probs shape: (37, 84251)
    ✓ Random_3 (pose=(-1.075339500058885, -1.439886709003745, -2.765282053076855)): shape (37, 800, 800)
      Valid pixels: 74199/640000 (11.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=21, max=274985, num_faces=274988
      Valid probs shape: (37, 74199)
    ✓ Random_4 (pose=(-1.8157500617907087, -1.1956398430737543, -2.054475251877159)): shape (37, 800, 800)
      Valid pixels: 74738/640000 (11.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=28, max=274985, num_faces=274988
      Valid probs shape: (37, 74738)
    ✓ Random_5 (pose=(0.11888448841853405, 1.0725344193259234, 0.23587093223868338)): shape (37, 800, 800)
      Valid pixels: 65041/640000 (10.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=273331, num_faces=274988
      Valid probs shape: (37, 65041)
    ✓ Random_6 (pose=(-1.1184075006792975, -0.9452637559482837, 2.1730969198718455)): shape (37, 800, 800)
      Valid pixels: 94897/640000 (14.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=274985, num_faces=274988
      Valid probs shape: (37, 94897)
    ✓ Random_7 (pose=(2.5271401741692365, -0.4200298449615545, -0.8061336531614449)): shape (37, 800, 800)
      Valid pixels: 76794/640000 (12.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=28, max=274987, num_faces=274988
      Valid probs shape: (37, 76794)
    ✓ Random_8 (pose=(0.0678681517347699, 0.7227428575592918, 2.6898418765100436)): shape (37, 800, 800)
      Valid pixels: 58167/640000 (9.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=274947, num_faces=274988
      Valid probs shape: (37, 58167)
    ✓ Random_9 (pose=(-0.6730554559667552, 2.3701482971639507, -0.9012374696281529)): shape (37, 800, 800)
      Valid pixels: 57906/640000 (9.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5162, max=274987, num_faces=274988
      Valid probs shape: (37, 57906)
    ✓ Random_10 (pose=(1.8679369880553853, 2.1775504468387217, -0.3577020905810002)): shape (37, 800, 800)
      Valid pixels: 97157/640000 (15.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=274985, num_faces=274988
      Valid probs shape: (37, 97157)
    ✓ Random_11 (pose=(-2.558332982846241, -0.8900812161048814, 1.5751089445741542)): shape (37, 800, 800)
      Valid pixels: 71892/640000 (11.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1651, max=274984, num_faces=274988
      Valid probs shape: (37, 71892)
    ✓ Random_12 (pose=(2.6421320595218436, -2.6767584947935905, -3.0161191936037874)): shape (37, 800, 800)
      Valid pixels: 61374/640000 (9.6%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=0, max=274952, num_faces=274988
      Valid probs shape: (37, 61374)
    ✓ Random_13 (pose=(1.0363279856213872, -0.7784964592354977, -1.0687040613776055)): shape (37, 800, 800)
      Valid pixels: 60999/640000 (9.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8, max=274984, num_faces=274988
      Valid probs shape: (37, 60999)
    ✓ Random_14 (pose=(-1.0066850963956937, -2.3405838178782616, -1.494822552791554)): shape (37, 800, 800)
      Valid pixels: 79436/640000 (12.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=836, max=274959, num_faces=274988
      Valid probs shape: (37, 79436)
    ✓ Random_15 (pose=(1.9301890869054583, -0.5743264208976706, -1.2539241306565798)): shape (37, 800, 800)
      Valid pixels: 85696/640000 (13.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=30, max=274985, num_faces=274988
      Valid probs shape: (37, 85696)
    ✓ Random_16 (pose=(1.3566970450789606, 0.33334487051491735, 2.282304660861181)): shape (37, 800, 800)
      Valid pixels: 91697/640000 (14.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=5, max=274959, num_faces=274988
      Valid probs shape: (37, 91697)
    ✓ Random_17 (pose=(1.9253268496868872, 0.7828722983602714, -2.2235089969110664)): shape (37, 800, 800)
      Valid pixels: 75342/640000 (11.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=47, max=274984, num_faces=274988
      Valid probs shape: (37, 75342)
    ✓ Random_18 (pose=(0.07088483359658815, -1.014816734783651, -2.059969937610074)): shape (37, 800, 800)
      Valid pixels: 88034/640000 (13.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=2, max=274948, num_faces=274988
      Valid probs shape: (37, 88034)
    ✓ Random_19 (pose=(2.4481801921549424, 0.6750568137444768, -2.324241745599985)): shape (37, 800, 800)
      Valid pixels: 79186/640000 (12.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3084, max=274987, num_faces=274988
      Valid probs shape: (37, 79186)
    ✓ Random_20 (pose=(-1.9124676929417195, -0.6676297266344413, -2.829555871034559)): shape (37, 800, 800)
      Valid pixels: 93383/640000 (14.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=274985, num_faces=274988
      Valid probs shape: (37, 93383)
    ✓ Random_21 (pose=(-1.9196440046535306, -0.978909141987732, -0.793098381727313)): shape (37, 800, 800)
      Valid pixels: 81643/640000 (12.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=274959, num_faces=274988
      Valid probs shape: (37, 81643)
    ✓ Random_22 (pose=(2.1826868264947032, -2.3375945702110243, 0.7309195855840254)): shape (37, 800, 800)
      Valid pixels: 64975/640000 (10.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=274987, num_faces=274988
      Valid probs shape: (37, 64975)
    ✓ Random_23 (pose=(-0.5027081536566285, -2.2062387365484373, 1.9973890346784122)): shape (37, 800, 800)
      Valid pixels: 89893/640000 (14.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=31, max=274987, num_faces=274988
      Valid probs shape: (37, 89893)
    ✓ Random_24 (pose=(0.11316143459195871, 1.1856193977274083, -2.1984901850670764)): shape (37, 800, 800)
      Valid pixels: 88339/640000 (13.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=274985, num_faces=274988
      Valid probs shape: (37, 88339)
    ✓ Random_25 (pose=(-1.1471089730893567, -1.5804420625552853, -2.379597892705707)): shape (37, 800, 800)
      Valid pixels: 68290/640000 (10.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8, max=274985, num_faces=274988
      Valid probs shape: (37, 68290)
    ✓ Random_26 (pose=(-2.225570865736129, -1.9233184566548087, 2.5353785026448445)): shape (37, 800, 800)
      Valid pixels: 74533/640000 (11.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=274985, num_faces=274988
      Valid probs shape: (37, 74533)
    ✓ Random_27 (pose=(-0.9427650823959239, -1.8255561711694965, 0.8079658744094007)): shape (37, 800, 800)
      Valid pixels: 67150/640000 (10.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=274985, num_faces=274988
      Valid probs shape: (37, 67150)
    ✓ Random_28 (pose=(2.803299685072365, -0.6462833372464449, -1.508231872279439)): shape (37, 800, 800)
      Valid pixels: 76486/640000 (12.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=29, max=274987, num_faces=274988
      Valid probs shape: (37, 76486)
    ✓ Random_29 (pose=(1.4328565170719116, 1.6001201740426332, 0.6268966594629699)): shape (37, 800, 800)
      Valid pixels: 76315/640000 (11.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=10, max=274985, num_faces=274988
      Valid probs shape: (37, 76315)
    P stats: min=0.0000, max=1.0000, mean=0.0250
    Non-zero vertices: 127098/137496
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 10398  1265  1095  2718     0  2179  1401  5276  6561]
  Ground Truth Stats:
    Labels shape: (137496,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-21/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7612
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8209
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8210

  RESULTS:
  RAW:         median(top-10)=0.8863, mean(top-10)=0.8934, median(all)=0.8280, mean(all)=0.7612
  + SMOOTHING: median(top-10)=0.9130, mean(top-10)=0.9200, median(all)=0.8688, mean(all)=0.8209 [+0.0267]
  + MRF:       median(top-10)=0.9132, mean(top-10)=0.9202, median(all)=0.8693, mean(all)=0.8210 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0268

================================================================================
Subject: MMRR-21-3
================================================================================
  Step 0: Generating predictions with V2 model (30 random views)...
  Mesh: 144159 vertices, 288314 faces
  Generating 30 random views...
  Generating predictions for 30 views (continuous camera pose)...
    ✓ Random_0 (pose=(0.09686739713583048, -1.0859407984688456, 1.3639178035232975)): shape (37, 800, 800)
      Valid pixels: 86773/640000 (13.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=288313, num_faces=288314
      Valid probs shape: (37, 86773)
    ✓ Random_1 (pose=(-1.9682806433688729, 0.9561879091903647, 0.37138831268109085)): shape (37, 800, 800)
      Valid pixels: 71319/640000 (11.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=92, max=288308, num_faces=288314
      Valid probs shape: (37, 71319)
    ✓ Random_2 (pose=(-1.297628287601871, 1.490292694016416, -0.8944027292143026)): shape (37, 800, 800)
      Valid pixels: 78502/640000 (12.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=15, max=288266, num_faces=288314
      Valid probs shape: (37, 78502)
    ✓ Random_3 (pose=(-2.0269372612269416, 2.06513051330686, -1.6451539692067785)): shape (37, 800, 800)
      Valid pixels: 74374/640000 (11.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=287561, num_faces=288314
      Valid probs shape: (37, 74374)
    ✓ Random_4 (pose=(-2.1654431992229592, -2.773884932556035, 2.8355145989073556)): shape (37, 800, 800)
      Valid pixels: 83644/640000 (13.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=288313, num_faces=288314
      Valid probs shape: (37, 83644)
    ✓ Random_5 (pose=(-1.7591214933213135, 0.8494957548667221, 0.2254154129147472)): shape (37, 800, 800)
      Valid pixels: 78532/640000 (12.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=68, max=288307, num_faces=288314
      Valid probs shape: (37, 78532)
    ✓ Random_6 (pose=(-0.11478644316251163, 1.5914252931471955, -1.9170609349979806)): shape (37, 800, 800)
      Valid pixels: 98503/640000 (15.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=288313, num_faces=288314
      Valid probs shape: (37, 98503)
    ✓ Random_7 (pose=(1.1853044303350595, 0.16221388609746334, 2.2002512024510343)): shape (37, 800, 800)
      Valid pixels: 85847/640000 (13.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=287561, num_faces=288314
      Valid probs shape: (37, 85847)
    ✓ Random_8 (pose=(0.6726465393209442, 2.604710769561481, 1.820941142975748)): shape (37, 800, 800)
      Valid pixels: 77890/640000 (12.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6623, max=288306, num_faces=288314
      Valid probs shape: (37, 77890)
    ✓ Random_9 (pose=(0.5249123888499647, -1.8459236595383695, -1.2845555990122206)): shape (37, 800, 800)
      Valid pixels: 69367/640000 (10.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=110, max=288312, num_faces=288314
      Valid probs shape: (37, 69367)
    ✓ Random_10 (pose=(0.7044548922837768, -2.90479608519629, 0.23874624146963042)): shape (37, 800, 800)
      Valid pixels: 70398/640000 (11.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=130, max=288313, num_faces=288314
      Valid probs shape: (37, 70398)
    ✓ Random_11 (pose=(-1.299589473117005, 1.0855100564299436, 2.529331073183279)): shape (37, 800, 800)
      Valid pixels: 91284/640000 (14.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=288313, num_faces=288314
      Valid probs shape: (37, 91284)
    ✓ Random_12 (pose=(-1.738225430888633, 0.4321283034859009, -1.3568327803442346)): shape (37, 800, 800)
      Valid pixels: 71484/640000 (11.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=147, max=288266, num_faces=288314
      Valid probs shape: (37, 71484)
    ✓ Random_13 (pose=(1.672734430472464, 1.906116799860456, -1.9460047397697033)): shape (37, 800, 800)
      Valid pixels: 65669/640000 (10.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=41, max=288307, num_faces=288314
      Valid probs shape: (37, 65669)
    ✓ Random_14 (pose=(0.6789774152728554, -3.0181027517409906, -2.104335069174246)): shape (37, 800, 800)
      Valid pixels: 61553/640000 (9.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1701, max=288311, num_faces=288314
      Valid probs shape: (37, 61553)
    ✓ Random_15 (pose=(-2.2863987936566024, 2.7705682512420857, 0.547083300220903)): shape (37, 800, 800)
      Valid pixels: 58863/640000 (9.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=288306, num_faces=288314
      Valid probs shape: (37, 58863)
    ✓ Random_16 (pose=(0.6158304881331511, -1.8112504716468634, -2.68091843332088)): shape (37, 800, 800)
      Valid pixels: 93484/640000 (14.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=148, max=288266, num_faces=288314
      Valid probs shape: (37, 93484)
    ✓ Random_17 (pose=(2.7382414257427063, -1.5053238157897135, -0.46526444072106443)): shape (37, 800, 800)
      Valid pixels: 74624/640000 (11.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7, max=288277, num_faces=288314
      Valid probs shape: (37, 74624)
    ✓ Random_18 (pose=(1.4169006804625566, 2.1180539363992112, -0.08435670944236184)): shape (37, 800, 800)
      Valid pixels: 94329/640000 (14.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=288313, num_faces=288314
      Valid probs shape: (37, 94329)
    ✓ Random_19 (pose=(-1.0716300952020021, -1.992029863388815, 0.33442206986586154)): shape (37, 800, 800)
      Valid pixels: 69965/640000 (10.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=105, max=288311, num_faces=288314
      Valid probs shape: (37, 69965)
    ✓ Random_20 (pose=(-3.1341152456147787, 2.40210761098637, -1.0393675249480205)): shape (37, 800, 800)
      Valid pixels: 60222/640000 (9.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=287869, num_faces=288314
      Valid probs shape: (37, 60222)
    ✓ Random_21 (pose=(2.0810461894904932, 0.6450636489687107, -0.45379031753224597)): shape (37, 800, 800)
      Valid pixels: 90020/640000 (14.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=13, max=288313, num_faces=288314
      Valid probs shape: (37, 90020)
    ✓ Random_22 (pose=(2.613896737935238, 0.27590900424233267, 1.9683553247751897)): shape (37, 800, 800)
      Valid pixels: 47152/640000 (7.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=36853, max=288272, num_faces=288314
      Valid probs shape: (37, 47152)
    ✓ Random_23 (pose=(0.8298019682447415, 0.5533071864086483, 0.9076835526624683)): shape (37, 800, 800)
      Valid pixels: 58482/640000 (9.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=288277, num_faces=288314
      Valid probs shape: (37, 58482)
    ✓ Random_24 (pose=(1.8863792122220895, 2.4606469564405806, 0.6330618953649392)): shape (37, 800, 800)
      Valid pixels: 81444/640000 (12.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=288312, num_faces=288314
      Valid probs shape: (37, 81444)
    ✓ Random_25 (pose=(-1.9497321735922153, -0.5524800121928566, 1.367595419402245)): shape (37, 800, 800)
      Valid pixels: 65621/640000 (10.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=108, max=288309, num_faces=288314
      Valid probs shape: (37, 65621)
    ✓ Random_26 (pose=(1.6565174375608285, 2.545077503053321, -1.8368954963028337)): shape (37, 800, 800)
      Valid pixels: 63575/640000 (9.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=38, max=288309, num_faces=288314
      Valid probs shape: (37, 63575)
    ✓ Random_27 (pose=(-0.374044989293568, -2.950360742779457, -0.15914387798762375)): shape (37, 800, 800)
      Valid pixels: 58638/640000 (9.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4108, max=288305, num_faces=288314
      Valid probs shape: (37, 58638)
    ✓ Random_28 (pose=(0.0482813052493678, -2.302336595053625, 3.0809958924393035)): shape (37, 800, 800)
      Valid pixels: 52276/640000 (8.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=16935, max=288274, num_faces=288314
      Valid probs shape: (37, 52276)
    ✓ Random_29 (pose=(0.11382106128949188, -1.5433257354917136, -0.8943364475746085)): shape (37, 800, 800)
      Valid pixels: 69670/640000 (10.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=93, max=288312, num_faces=288314
      Valid probs shape: (37, 69670)
    P stats: min=0.0000, max=1.0000, mean=0.0254
    Non-zero vertices: 135280/144159
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 8879 1183 1091 3424    0 2046 1429 4514 6105]
  Ground Truth Stats:
    Labels shape: (144159,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-3/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7827
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8410
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8412

  RESULTS:
  RAW:         median(top-10)=0.9184, mean(top-10)=0.9168, median(all)=0.8535, mean(all)=0.7827
  + SMOOTHING: median(top-10)=0.9375, mean(top-10)=0.9385, median(all)=0.8874, mean(all)=0.8410 [+0.0191]
  + MRF:       median(top-10)=0.9376, mean(top-10)=0.9388, median(all)=0.8877, mean(all)=0.8412 [+0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0192

================================================================================
Subject: MMRR-21-4
================================================================================
  Step 0: Generating predictions with V2 model (30 random views)...
  Mesh: 118034 vertices, 236064 faces
  Generating 30 random views...
  Generating predictions for 30 views (continuous camera pose)...
    ✓ Random_0 (pose=(-0.30645300239827256, -1.5444081357316903, -2.4252013700545327)): shape (37, 800, 800)
      Valid pixels: 78019/640000 (12.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=236063, num_faces=236064
      Valid probs shape: (37, 78019)
    ✓ Random_1 (pose=(0.5020484970747541, -0.4133360047523942, -0.7517970442782227)): shape (37, 800, 800)
      Valid pixels: 46148/640000 (7.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=236010, num_faces=236064
      Valid probs shape: (37, 46148)
    ✓ Random_2 (pose=(-0.9260748087374662, -0.7060905425762458, -2.463680869241009)): shape (37, 800, 800)
      Valid pixels: 63980/640000 (10.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=236062, num_faces=236064
      Valid probs shape: (37, 63980)
    ✓ Random_3 (pose=(-1.2263262038180862, 1.3044160195410095, -2.4784868012510755)): shape (37, 800, 800)
      Valid pixels: 88450/640000 (13.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=236015, num_faces=236064
      Valid probs shape: (37, 88450)
    ✓ Random_4 (pose=(1.4084583620540556, 1.6348959786398334, -0.06939388452805417)): shape (37, 800, 800)
      Valid pixels: 95322/640000 (14.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=236016, num_faces=236064
      Valid probs shape: (37, 95322)
    ✓ Random_5 (pose=(2.2891394043486466, -0.7834091541612804, -2.786158163988784)): shape (37, 800, 800)
      Valid pixels: 69138/640000 (10.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=915, max=236058, num_faces=236064
      Valid probs shape: (37, 69138)
    ✓ Random_6 (pose=(1.0433923789920039, -3.0137723636259026, -0.9564934051348066)): shape (37, 800, 800)
      Valid pixels: 80543/640000 (12.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=294, max=236016, num_faces=236064
      Valid probs shape: (37, 80543)
    ✓ Random_7 (pose=(-0.5907241963698859, -0.7744117588026902, -0.6546862924944414)): shape (37, 800, 800)
      Valid pixels: 78342/640000 (12.2%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=6, max=234903, num_faces=236064
      Valid probs shape: (37, 78342)
    ✓ Random_8 (pose=(-1.9820039914915788, -3.020593175769151, -1.024321327553365)): shape (37, 800, 800)
      Valid pixels: 79476/640000 (12.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=236063, num_faces=236064
      Valid probs shape: (37, 79476)
    ✓ Random_9 (pose=(1.4152846141798818, -1.449106198809085, 2.290568202304658)): shape (37, 800, 800)
      Valid pixels: 84404/640000 (13.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=9, max=236063, num_faces=236064
      Valid probs shape: (37, 84404)
    ✓ Random_10 (pose=(2.8331463872210483, 1.4826625836504626, -2.7633354794337617)): shape (37, 800, 800)
      Valid pixels: 87785/640000 (13.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=9, max=236063, num_faces=236064
      Valid probs shape: (37, 87785)
    ✓ Random_11 (pose=(3.017242928564798, 2.270173875633052, 2.8234492548333305)): shape (37, 800, 800)
      Valid pixels: 56565/640000 (8.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=235025, num_faces=236064
      Valid probs shape: (37, 56565)
    ✓ Random_12 (pose=(1.3084047551597422, -2.989434484725669, 1.6654884893508592)): shape (37, 800, 800)
      Valid pixels: 59185/640000 (9.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=206, max=236063, num_faces=236064
      Valid probs shape: (37, 59185)
    ✓ Random_13 (pose=(2.140479209638497, -0.9889725962585239, 2.0559786581052206)): shape (37, 800, 800)
      Valid pixels: 88820/640000 (13.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=113, max=236063, num_faces=236064
      Valid probs shape: (37, 88820)
    ✓ Random_14 (pose=(-2.3677893637714247, 0.5193916576165156, 0.7856735761647062)): shape (37, 800, 800)
      Valid pixels: 62172/640000 (9.7%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=2497, max=235908, num_faces=236064
      Valid probs shape: (37, 62172)
    ✓ Random_15 (pose=(-0.032221645408485156, 1.259815368822335, -1.9114139384343456)): shape (37, 800, 800)
      Valid pixels: 92283/640000 (14.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=236016, num_faces=236064
      Valid probs shape: (37, 92283)
    ✓ Random_16 (pose=(1.1862666819666021, 2.631773250454552, 3.0427848507440753)): shape (37, 800, 800)
      Valid pixels: 85251/640000 (13.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=132, max=236061, num_faces=236064
      Valid probs shape: (37, 85251)
    ✓ Random_17 (pose=(2.5811108348810725, 0.14425734439339255, 1.3449110213196347)): shape (37, 800, 800)
      Valid pixels: 50129/640000 (7.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1075, max=236062, num_faces=236064
      Valid probs shape: (37, 50129)
    ✓ Random_18 (pose=(-2.886747880346317, -2.6633669305415717, 0.32378163732625476)): shape (37, 800, 800)
      Valid pixels: 66406/640000 (10.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=235062, num_faces=236064
      Valid probs shape: (37, 66406)
    ✓ Random_19 (pose=(-0.8610597263636732, 0.7313864018583698, -0.23409974015866863)): shape (37, 800, 800)
      Valid pixels: 85501/640000 (13.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=236054, num_faces=236064
      Valid probs shape: (37, 85501)
    ✓ Random_20 (pose=(0.7951441836883535, 0.4127223222808474, -0.7839038263553202)): shape (37, 800, 800)
      Valid pixels: 73564/640000 (11.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=236015, num_faces=236064
      Valid probs shape: (37, 73564)
    ✓ Random_21 (pose=(0.7833337619399825, -1.0994190201186176, -0.48378463765171986)): shape (37, 800, 800)
      Valid pixels: 68483/640000 (10.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=236010, num_faces=236064
      Valid probs shape: (37, 68483)
    ✓ Random_22 (pose=(0.38741461796461163, 1.9730817951866282, -1.2045638541968036)): shape (37, 800, 800)
      Valid pixels: 94529/640000 (14.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=236016, num_faces=236064
      Valid probs shape: (37, 94529)
    ✓ Random_23 (pose=(2.7522320299845893, -1.6809111092401545, -0.9850399063411426)): shape (37, 800, 800)
      Valid pixels: 92066/640000 (14.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=236016, num_faces=236064
      Valid probs shape: (37, 92066)
    ✓ Random_24 (pose=(-2.68354418867216, 0.5701850364772896, -1.5107345349000618)): shape (37, 800, 800)
      Valid pixels: 69449/640000 (10.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=11206, max=236063, num_faces=236064
      Valid probs shape: (37, 69449)
    ✓ Random_25 (pose=(-1.1770549573465028, -0.6781564828179638, 0.8026023675403731)): shape (37, 800, 800)
      Valid pixels: 65944/640000 (10.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=4, max=236010, num_faces=236064
      Valid probs shape: (37, 65944)
    ✓ Random_26 (pose=(1.455352263155893, 0.9368830303211686, -0.94509218539836)): shape (37, 800, 800)
      Valid pixels: 89367/640000 (14.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=236016, num_faces=236064
      Valid probs shape: (37, 89367)
    ✓ Random_27 (pose=(-2.345814874637386, -0.5811269936592738, 2.245162379794941)): shape (37, 800, 800)
      Valid pixels: 64698/640000 (10.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=906, max=235903, num_faces=236064
      Valid probs shape: (37, 64698)
    ✓ Random_28 (pose=(-0.46388263442851896, -2.3225258894310667, -1.611822581819759)): shape (37, 800, 800)
      Valid pixels: 77730/640000 (12.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=10424, max=236063, num_faces=236064
      Valid probs shape: (37, 77730)
    ✓ Random_29 (pose=(-1.1224450128291399, -1.4991382294436906, 1.1569593427680767)): shape (37, 800, 800)
      Valid pixels: 63268/640000 (9.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=7, max=236010, num_faces=236064
      Valid probs shape: (37, 63268)
    P stats: min=0.0000, max=1.0000, mean=0.0256
    Non-zero vertices: 111843/118034
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 6191  994 1041 2901    0 2019  943 3874 4905]
  Ground Truth Stats:
    Labels shape: (118034,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-4/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7790
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8222
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8226

  RESULTS:
  RAW:         median(top-10)=0.9229, mean(top-10)=0.9255, median(all)=0.8443, mean(all)=0.7790
  + SMOOTHING: median(top-10)=0.9395, mean(top-10)=0.9393, median(all)=0.8726, mean(all)=0.8222 [+0.0166]
  + MRF:       median(top-10)=0.9396, mean(top-10)=0.9395, median(all)=0.8737, mean(all)=0.8226 [+0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0167

================================================================================
Subject: MMRR-21-5
================================================================================
  Step 0: Generating predictions with V2 model (30 random views)...
  Mesh: 145215 vertices, 290426 faces
  Generating 30 random views...
  Generating predictions for 30 views (continuous camera pose)...
    ✓ Random_0 (pose=(-2.5576704754135093, -2.8068222752612435, 0.752463280570705)): shape (37, 800, 800)
      Valid pixels: 70852/640000 (11.1%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=1, max=290343, num_faces=290426
      Valid probs shape: (37, 70852)
    ✓ Random_1 (pose=(-2.355280068577113, 3.0157726470659156, -2.6858336253195976)): shape (37, 800, 800)
      Valid pixels: 72061/640000 (11.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=290423, num_faces=290426
      Valid probs shape: (37, 72061)
    ✓ Random_2 (pose=(1.7783081129974958, 3.004751053878282, 0.21771882204892012)): shape (37, 800, 800)
      Valid pixels: 98552/640000 (15.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=290423, num_faces=290426
      Valid probs shape: (37, 98552)
    ✓ Random_3 (pose=(-0.7654071555774462, 0.07010197101458093, 1.3219500729524158)): shape (37, 800, 800)
      Valid pixels: 59308/640000 (9.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=3, max=290351, num_faces=290426
      Valid probs shape: (37, 59308)
    ✓ Random_4 (pose=(3.0434429126730773, -2.211785151081804, 1.3288614802998948)): shape (37, 800, 800)
      Valid pixels: 92309/640000 (14.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=2, max=288849, num_faces=290426
      Valid probs shape: (37, 92309)
    ✓ Random_5 (pose=(-0.3170849099910251, 1.1732393192543835, 1.0190538872304709)): shape (37, 800, 800)
      Valid pixels: 98188/640000 (15.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=288953, num_faces=290426
      Valid probs shape: (37, 98188)
    ✓ Random_6 (pose=(-0.2385567289652184, 1.691469673281314, 0.8975881574713629)): shape (37, 800, 800)
      Valid pixels: 104828/640000 (16.4%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=1, max=288855, num_faces=290426
      Valid probs shape: (37, 104828)
    ✓ Random_7 (pose=(2.199385399278489, -1.8503599324215017, 2.1030920851487886)): shape (37, 800, 800)
      Valid pixels: 104633/640000 (16.3%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=2, max=289887, num_faces=290426
      Valid probs shape: (37, 104633)
    ✓ Random_8 (pose=(-0.7898081221016398, 0.6256411910241617, -2.2340803666704745)): shape (37, 800, 800)
      Valid pixels: 81800/640000 (12.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=290423, num_faces=290426
      Valid probs shape: (37, 81800)
    ✓ Random_9 (pose=(0.279244884386769, -3.0671436936572998, -0.02287512351750509)): shape (37, 800, 800)
      Valid pixels: 53993/640000 (8.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=968, max=290423, num_faces=290426
      Valid probs shape: (37, 53993)
    ✓ Random_10 (pose=(1.9483950507842858, -0.25776501343883673, 1.801073955960252)): shape (37, 800, 800)
      Valid pixels: 80255/640000 (12.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4386, max=288564, num_faces=290426
      Valid probs shape: (37, 80255)
    ✓ Random_11 (pose=(1.9566229669484656, -0.9955766797640768, 0.3415894417475984)): shape (37, 800, 800)
      Valid pixels: 82480/640000 (12.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8, max=290412, num_faces=290426
      Valid probs shape: (37, 82480)
    ✓ Random_12 (pose=(-3.00800639769796, -1.7590499285947694, 2.070216040693155)): shape (37, 800, 800)
      Valid pixels: 78965/640000 (12.3%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=0, max=288563, num_faces=290426
      Valid probs shape: (37, 78965)
    ✓ Random_13 (pose=(-1.7509217988428123, 0.024639650140374947, 0.08507325660125176)): shape (37, 800, 800)
      Valid pixels: 95900/640000 (15.0%)
      Probs stats: min=0.0000, max=0.9995, mean=0.0270
      Face IDs: min=54, max=290139, num_faces=290426
      Valid probs shape: (37, 95900)
    ✓ Random_14 (pose=(-0.9518758065009969, 0.5296052103210989, 0.34520022620736013)): shape (37, 800, 800)
      Valid pixels: 89258/640000 (13.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=288855, num_faces=290426
      Valid probs shape: (37, 89258)
    ✓ Random_15 (pose=(-2.628575586663142, 3.1172265757164332, 1.20115348386922)): shape (37, 800, 800)
      Valid pixels: 55584/640000 (8.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=290351, num_faces=290426
      Valid probs shape: (37, 55584)
    ✓ Random_16 (pose=(-0.14879921577626032, -2.538210618086134, 2.8896753489456053)): shape (37, 800, 800)
      Valid pixels: 57280/640000 (8.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=667, max=290412, num_faces=290426
      Valid probs shape: (37, 57280)
    ✓ Random_17 (pose=(-1.2311357505621379, 0.6575435842516466, 0.6587820230878658)): shape (37, 800, 800)
      Valid pixels: 81937/640000 (12.8%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=7, max=288563, num_faces=290426
      Valid probs shape: (37, 81937)
    ✓ Random_18 (pose=(2.8667533468628523, 0.22790331909222195, 2.7792551887569443)): shape (37, 800, 800)
      Valid pixels: 58230/640000 (9.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=43876, max=288853, num_faces=290426
      Valid probs shape: (37, 58230)
    ✓ Random_19 (pose=(-1.3168465600529857, 1.1483166049944202, -1.2363981281571852)): shape (37, 800, 800)
      Valid pixels: 71120/640000 (11.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=288850, num_faces=290426
      Valid probs shape: (37, 71120)
    ✓ Random_20 (pose=(0.9868056145953066, 2.4499726281611824, 3.0605608520766934)): shape (37, 800, 800)
      Valid pixels: 87503/640000 (13.7%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=686, max=290299, num_faces=290426
      Valid probs shape: (37, 87503)
    ✓ Random_21 (pose=(1.9076164386290602, 0.3636543241501209, -0.7419710556451564)): shape (37, 800, 800)
      Valid pixels: 100306/640000 (15.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=113, max=290425, num_faces=290426
      Valid probs shape: (37, 100306)
    ✓ Random_22 (pose=(-2.5895028140837386, -0.7610246484477785, -1.722404736031059)): shape (37, 800, 800)
      Valid pixels: 75004/640000 (11.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=281, max=290418, num_faces=290426
      Valid probs shape: (37, 75004)
    ✓ Random_23 (pose=(0.2545216080557271, 1.4026561139594804, -0.5636834290981998)): shape (37, 800, 800)
      Valid pixels: 80023/640000 (12.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=290421, num_faces=290426
      Valid probs shape: (37, 80023)
    ✓ Random_24 (pose=(-2.816080769916281, -0.9861437448995627, -0.3802824874668378)): shape (37, 800, 800)
      Valid pixels: 62201/640000 (9.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3861, max=290415, num_faces=290426
      Valid probs shape: (37, 62201)
    ✓ Random_25 (pose=(-0.9374620255749737, -1.315223336559753, 0.5021664896267763)): shape (37, 800, 800)
      Valid pixels: 72922/640000 (11.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=54, max=290351, num_faces=290426
      Valid probs shape: (37, 72922)
    ✓ Random_26 (pose=(-0.5550847589672929, 2.7868868724103386, 0.7935473964251609)): shape (37, 800, 800)
      Valid pixels: 75545/640000 (11.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5570, max=290286, num_faces=290426
      Valid probs shape: (37, 75545)
    ✓ Random_27 (pose=(-1.951402587772307, 2.9186069222975606, 1.8599403962210301)): shape (37, 800, 800)
      Valid pixels: 77679/640000 (12.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=31, max=290425, num_faces=290426
      Valid probs shape: (37, 77679)
    ✓ Random_28 (pose=(-0.5369030124133234, 2.881499309145025, -2.18996852641136)): shape (37, 800, 800)
      Valid pixels: 63928/640000 (10.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=282, max=290412, num_faces=290426
      Valid probs shape: (37, 63928)
    ✓ Random_29 (pose=(-1.6878038516534983, 0.43073898225453533, 2.109152800623848)): shape (37, 800, 800)
      Valid pixels: 97955/640000 (15.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=13, max=290425, num_faces=290426
      Valid probs shape: (37, 97955)
    P stats: min=0.0000, max=1.0000, mean=0.0251
    Non-zero vertices: 135058/145215
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 10157  1193  1074  4372     0  2052  1318  3699  5946]
  Ground Truth Stats:
    Labels shape: (145215,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-5/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7808
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8297
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8300

  RESULTS:
  RAW:         median(top-10)=0.9139, mean(top-10)=0.9124, median(all)=0.8527, mean(all)=0.7808
  + SMOOTHING: median(top-10)=0.9328, mean(top-10)=0.9340, median(all)=0.8755, mean(all)=0.8297 [+0.0189]
  + MRF:       median(top-10)=0.9331, mean(top-10)=0.9341, median(all)=0.8756, mean(all)=0.8300 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0192

================================================================================
Subject: MMRR-21-6
================================================================================
  Step 0: Generating predictions with V2 model (30 random views)...
  Mesh: 128994 vertices, 257984 faces
  Generating 30 random views...
  Generating predictions for 30 views (continuous camera pose)...
    ✓ Random_0 (pose=(2.909580532647748, -1.307756310692117, 2.9139837004132625)): shape (37, 800, 800)
      Valid pixels: 69554/640000 (10.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=195, max=257983, num_faces=257984
      Valid probs shape: (37, 69554)
    ✓ Random_1 (pose=(0.441461198584741, -0.688833851517479, -0.20647559794842563)): shape (37, 800, 800)
      Valid pixels: 67157/640000 (10.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=257982, num_faces=257984
      Valid probs shape: (37, 67157)
    ✓ Random_2 (pose=(-1.7972839324996428, 1.474338168255919, 1.4032299251649079)): shape (37, 800, 800)
      Valid pixels: 66209/640000 (10.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=2, max=257983, num_faces=257984
      Valid probs shape: (37, 66209)
    ✓ Random_3 (pose=(2.411507848830965, 0.6455960740754048, -1.6860342504495442)): shape (37, 800, 800)
      Valid pixels: 68786/640000 (10.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=201, max=257983, num_faces=257984
      Valid probs shape: (37, 68786)
    ✓ Random_4 (pose=(2.361577225743229, 2.545465876153159, -0.3902859856454737)): shape (37, 800, 800)
      Valid pixels: 80620/640000 (12.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=257982, num_faces=257984
      Valid probs shape: (37, 80620)
    ✓ Random_5 (pose=(1.3112938265735021, -1.7042000534726391, -2.4781448777456325)): shape (37, 800, 800)
      Valid pixels: 82874/640000 (12.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=21, max=257980, num_faces=257984
      Valid probs shape: (37, 82874)
    ✓ Random_6 (pose=(1.3110544148313066, 0.9997273764526184, -1.7021033500758729)): shape (37, 800, 800)
      Valid pixels: 66061/640000 (10.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=257982, num_faces=257984
      Valid probs shape: (37, 66061)
    ✓ Random_7 (pose=(1.6700916602868983, -1.404576476440873, -3.1388690604029783)): shape (37, 800, 800)
      Valid pixels: 92078/640000 (14.4%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=7, max=257967, num_faces=257984
      Valid probs shape: (37, 92078)
    ✓ Random_8 (pose=(0.8254665988683612, -1.4525775996641839, 3.0167487748768833)): shape (37, 800, 800)
      Valid pixels: 91889/640000 (14.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=257843, num_faces=257984
      Valid probs shape: (37, 91889)
    ✓ Random_9 (pose=(0.2841907013175051, 0.6167933485471981, 3.1061787075545064)): shape (37, 800, 800)
      Valid pixels: 56172/640000 (8.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=257968, num_faces=257984
      Valid probs shape: (37, 56172)
    ✓ Random_10 (pose=(-0.07128875202856522, -0.12549232496214557, -0.30683215918945983)): shape (37, 800, 800)
      Valid pixels: 47333/640000 (7.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=0, max=257943, num_faces=257984
      Valid probs shape: (37, 47333)
    ✓ Random_11 (pose=(1.3194657205393163, -0.066988146829984, -1.646278617621278)): shape (37, 800, 800)
      Valid pixels: 63793/640000 (10.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=257982, num_faces=257984
      Valid probs shape: (37, 63793)
    ✓ Random_12 (pose=(-1.6322154511503262, 1.6118818786100393, -1.9832777304961198)): shape (37, 800, 800)
      Valid pixels: 65910/640000 (10.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=257852, num_faces=257984
      Valid probs shape: (37, 65910)
    ✓ Random_13 (pose=(0.5279513071538222, -2.9549438246778017, 0.5553770338507351)): shape (37, 800, 800)
      Valid pixels: 61201/640000 (9.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=932, max=257983, num_faces=257984
      Valid probs shape: (37, 61201)
    ✓ Random_14 (pose=(-1.1105951544795052, 2.855722414814049, 2.067991644284917)): shape (37, 800, 800)
      Valid pixels: 72187/640000 (11.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=119, max=257982, num_faces=257984
      Valid probs shape: (37, 72187)
    ✓ Random_15 (pose=(0.4831458738978567, 2.695104302860984, 0.21075682780094818)): shape (37, 800, 800)
      Valid pixels: 59166/640000 (9.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1455, max=257983, num_faces=257984
      Valid probs shape: (37, 59166)
    ✓ Random_16 (pose=(0.7645172717064472, 2.301549267104348, 2.30650336861384)): shape (37, 800, 800)
      Valid pixels: 93051/640000 (14.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=722, max=257980, num_faces=257984
      Valid probs shape: (37, 93051)
    ✓ Random_17 (pose=(0.7723864995312142, -0.6004046333431914, 1.1769849012036682)): shape (37, 800, 800)
      Valid pixels: 72015/640000 (11.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=257940, num_faces=257984
      Valid probs shape: (37, 72015)
    ✓ Random_18 (pose=(3.077726865561451, -1.5491770229976953, -1.6537599208584883)): shape (37, 800, 800)
      Valid pixels: 103275/640000 (16.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=257982, num_faces=257984
      Valid probs shape: (37, 103275)
    ✓ Random_19 (pose=(-2.641749949923999, -1.4321392022934907, -2.932617065135149)): shape (37, 800, 800)
      Valid pixels: 93203/640000 (14.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=42, max=257982, num_faces=257984
      Valid probs shape: (37, 93203)
    ✓ Random_20 (pose=(1.5484531131081942, -0.9831246864037038, 1.7985994834340566)): shape (37, 800, 800)
      Valid pixels: 69789/640000 (10.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=256956, num_faces=257984
      Valid probs shape: (37, 69789)
    ✓ Random_21 (pose=(-0.10419016568287365, 1.7102526178336905, -1.9553694795682357)): shape (37, 800, 800)
      Valid pixels: 102516/640000 (16.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=48, max=257982, num_faces=257984
      Valid probs shape: (37, 102516)
    ✓ Random_22 (pose=(2.9517645232412324, -1.3964660244872424, -0.1300600903525213)): shape (37, 800, 800)
      Valid pixels: 65333/640000 (10.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=10, max=257852, num_faces=257984
      Valid probs shape: (37, 65333)
    ✓ Random_23 (pose=(0.3936196981882216, -0.22478885031500973, -1.3511177737377014)): shape (37, 800, 800)
      Valid pixels: 51494/640000 (8.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=257975, num_faces=257984
      Valid probs shape: (37, 51494)
    ✓ Random_24 (pose=(-0.017423008554909192, 0.2818416740609062, 2.001401835924674)): shape (37, 800, 800)
      Valid pixels: 51237/640000 (8.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=0, max=257846, num_faces=257984
      Valid probs shape: (37, 51237)
    ✓ Random_25 (pose=(0.3498987347212559, 2.324385767630382, -0.6942515082081608)): shape (37, 800, 800)
      Valid pixels: 72996/640000 (11.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=67, max=257983, num_faces=257984
      Valid probs shape: (37, 72996)
    ✓ Random_26 (pose=(-1.8423720271838115, -1.3527351757421782, -0.21553822534717115)): shape (37, 800, 800)
      Valid pixels: 98893/640000 (15.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=257979, num_faces=257984
      Valid probs shape: (37, 98893)
    ✓ Random_27 (pose=(-1.5767884135393548, 3.0849681656913495, 2.050801309368623)): shape (37, 800, 800)
      Valid pixels: 85119/640000 (13.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=257983, num_faces=257984
      Valid probs shape: (37, 85119)
    ✓ Random_28 (pose=(0.33527335870103236, 1.6348348090424123, 1.8935370111977257)): shape (37, 800, 800)
      Valid pixels: 94912/640000 (14.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=20, max=257965, num_faces=257984
      Valid probs shape: (37, 94912)
    ✓ Random_29 (pose=(2.777122556732654, 0.7632770018879724, -1.0852955511545916)): shape (37, 800, 800)
      Valid pixels: 64608/640000 (10.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=199, max=257983, num_faces=257984
      Valid probs shape: (37, 64608)
    P stats: min=0.0000, max=0.9999, mean=0.0250
    Non-zero vertices: 119377/128994
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 9617 1621 1139 3597    0 1964  841 4962 4836]
  Ground Truth Stats:
    Labels shape: (128994,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-6/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7771
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8316
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8319

  RESULTS:
  RAW:         median(top-10)=0.8974, mean(top-10)=0.8970, median(all)=0.8280, mean(all)=0.7771
  + SMOOTHING: median(top-10)=0.9337, mean(top-10)=0.9316, median(all)=0.8651, mean(all)=0.8316 [+0.0363]
  + MRF:       median(top-10)=0.9336, mean(top-10)=0.9317, median(all)=0.8648, mean(all)=0.8319 [-0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0362

================================================================================
Subject: MMRR-21-7
================================================================================
  Step 0: Generating predictions with V2 model (30 random views)...
  Mesh: 148998 vertices, 297992 faces
  Generating 30 random views...
  Generating predictions for 30 views (continuous camera pose)...
    ✓ Random_0 (pose=(2.778969573901053, 0.5183859120635503, -2.044306139114191)): shape (37, 800, 800)
      Valid pixels: 66019/640000 (10.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=10159, max=297991, num_faces=297992
      Valid probs shape: (37, 66019)
    ✓ Random_1 (pose=(0.025340255501932862, -0.6074177712062396, -1.7186091633055833)): shape (37, 800, 800)
      Valid pixels: 62793/640000 (9.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=297949, num_faces=297992
      Valid probs shape: (37, 62793)
    ✓ Random_2 (pose=(0.5265105702684272, -2.299911586478497, 0.23049376350346584)): shape (37, 800, 800)
      Valid pixels: 77345/640000 (12.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=28, max=297956, num_faces=297992
      Valid probs shape: (37, 77345)
    ✓ Random_3 (pose=(-2.8695428337487496, 3.1169902228907596, -1.2015962569411969)): shape (37, 800, 800)
      Valid pixels: 44354/640000 (6.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=224301, num_faces=297992
      Valid probs shape: (37, 44354)
    ✓ Random_4 (pose=(2.667825676476422, 2.9740791820713754, -0.6559735294439304)): shape (37, 800, 800)
      Valid pixels: 51293/640000 (8.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=297825, num_faces=297992
      Valid probs shape: (37, 51293)
    ✓ Random_5 (pose=(-0.26645130659646377, -2.9615790951737755, -1.497488548428806)): shape (37, 800, 800)
      Valid pixels: 50891/640000 (8.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=43558, max=297991, num_faces=297992
      Valid probs shape: (37, 50891)
    ✓ Random_6 (pose=(-3.1117950822065494, 1.6767295988306667, 2.9616005238909144)): shape (37, 800, 800)
      Valid pixels: 55532/640000 (8.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=15, max=297878, num_faces=297992
      Valid probs shape: (37, 55532)
    ✓ Random_7 (pose=(1.0915934044582372, -1.574188883982769, 2.7080407583148443)): shape (37, 800, 800)
      Valid pixels: 82535/640000 (12.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=297951, num_faces=297992
      Valid probs shape: (37, 82535)
    ✓ Random_8 (pose=(0.5452883520690133, -1.2757137285801943, -0.4119696095882426)): shape (37, 800, 800)
      Valid pixels: 59020/640000 (9.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=297956, num_faces=297992
      Valid probs shape: (37, 59020)
    ✓ Random_9 (pose=(2.4389963330396993, 0.3693203830671017, 1.135466549162774)): shape (37, 800, 800)
      Valid pixels: 57969/640000 (9.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=54, max=297986, num_faces=297992
      Valid probs shape: (37, 57969)
    ✓ Random_10 (pose=(2.098498865693746, -1.8410012600539416, 1.3009699577863962)): shape (37, 800, 800)
      Valid pixels: 64163/640000 (10.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=9, max=297878, num_faces=297992
      Valid probs shape: (37, 64163)
    ✓ Random_11 (pose=(-0.5779922306419456, 1.6404988025204101, 0.1987557715130399)): shape (37, 800, 800)
      Valid pixels: 85804/640000 (13.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=297980, num_faces=297992
      Valid probs shape: (37, 85804)
    ✓ Random_12 (pose=(2.778556317484105, 1.3402486275772816, 0.17008307553872637)): shape (37, 800, 800)
      Valid pixels: 79294/640000 (12.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=398, max=297956, num_faces=297992
      Valid probs shape: (37, 79294)
    ✓ Random_13 (pose=(-2.9243136942585, -2.836402670666555, 2.4181881999249883)): shape (37, 800, 800)
      Valid pixels: 42969/640000 (6.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=297822, num_faces=297992
      Valid probs shape: (37, 42969)
    ✓ Random_14 (pose=(1.1917859956131016, 1.2051018131238163, 2.2747867611905734)): shape (37, 800, 800)
      Valid pixels: 88507/640000 (13.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=297980, num_faces=297992
      Valid probs shape: (37, 88507)
    ✓ Random_15 (pose=(-2.2117845788519914, 0.6303814853694658, 0.5547853279325774)): shape (37, 800, 800)
      Valid pixels: 61467/640000 (9.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3223, max=297955, num_faces=297992
      Valid probs shape: (37, 61467)
    ✓ Random_16 (pose=(0.6394597284064427, 1.316714656368017, 0.32281463053641746)): shape (37, 800, 800)
      Valid pixels: 57379/640000 (9.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=9, max=297878, num_faces=297992
      Valid probs shape: (37, 57379)
    ✓ Random_17 (pose=(2.7075179981583313, 1.8795059013290603, -2.418306399558294)): shape (37, 800, 800)
      Valid pixels: 86978/640000 (13.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=297954, num_faces=297992
      Valid probs shape: (37, 86978)
    ✓ Random_18 (pose=(1.698355581887748, 0.9300681259335564, -2.5620123556588634)): shape (37, 800, 800)
      Valid pixels: 73759/640000 (11.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=31, max=297991, num_faces=297992
      Valid probs shape: (37, 73759)
    ✓ Random_19 (pose=(1.1901998545766572, 1.0202789960545209, -2.792077372833129)): shape (37, 800, 800)
      Valid pixels: 67535/640000 (10.6%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=5, max=297954, num_faces=297992
      Valid probs shape: (37, 67535)
    ✓ Random_20 (pose=(1.2355629604362797, 1.360803506744313, 2.312157845528567)): shape (37, 800, 800)
      Valid pixels: 88986/640000 (13.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=19, max=297980, num_faces=297992
      Valid probs shape: (37, 88986)
    ✓ Random_21 (pose=(1.588534802063653, 0.20409194891720972, 0.4735892770199861)): shape (37, 800, 800)
      Valid pixels: 78954/640000 (12.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=297724, num_faces=297992
      Valid probs shape: (37, 78954)
    ✓ Random_22 (pose=(2.762439127060584, 0.6245024487905386, 2.7944526753472587)): shape (37, 800, 800)
      Valid pixels: 55047/640000 (8.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=30434, max=297989, num_faces=297992
      Valid probs shape: (37, 55047)
    ✓ Random_23 (pose=(1.3293047417974462, -1.038754312284158, 1.0133695887766487)): shape (37, 800, 800)
      Valid pixels: 68683/640000 (10.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=9, max=297721, num_faces=297992
      Valid probs shape: (37, 68683)
    ✓ Random_24 (pose=(-2.3761703855261325, -1.2609062537260343, -1.1056715209261418)): shape (37, 800, 800)
      Valid pixels: 57295/640000 (9.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=10, max=297986, num_faces=297992
      Valid probs shape: (37, 57295)
    ✓ Random_25 (pose=(1.2019668218884672, 2.7340509841367933, 2.459360988604687)): shape (37, 800, 800)
      Valid pixels: 86191/640000 (13.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=53, max=297991, num_faces=297992
      Valid probs shape: (37, 86191)
    ✓ Random_26 (pose=(0.552254925204196, 2.961476683574091, -2.521717384266023)): shape (37, 800, 800)
      Valid pixels: 54584/640000 (8.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4074, max=297991, num_faces=297992
      Valid probs shape: (37, 54584)
    ✓ Random_27 (pose=(2.3808715968549867, 3.0348657817666345, 0.19853333824514596)): shape (37, 800, 800)
      Valid pixels: 69766/640000 (10.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=297827, num_faces=297992
      Valid probs shape: (37, 69766)
    ✓ Random_28 (pose=(1.8901701654229495, -1.824572205927444, 0.3088898729793361)): shape (37, 800, 800)
      Valid pixels: 74348/640000 (11.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=297828, num_faces=297992
      Valid probs shape: (37, 74348)
    ✓ Random_29 (pose=(1.028727015090933, 1.2050972191873628, 1.18602058752721)): shape (37, 800, 800)
      Valid pixels: 58603/640000 (9.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=9, max=297878, num_faces=297992
      Valid probs shape: (37, 58603)
    P stats: min=0.0000, max=1.0000, mean=0.0254
    Non-zero vertices: 139769/148998
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 9229 1184 1428 3378    0 2094 1011 5293 6628]
  Ground Truth Stats:
    Labels shape: (148998,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-7/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7874
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8327
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8329

  RESULTS:
  RAW:         median(top-10)=0.9120, mean(top-10)=0.9129, median(all)=0.8506, mean(all)=0.7874
  + SMOOTHING: median(top-10)=0.9328, mean(top-10)=0.9333, median(all)=0.8989, mean(all)=0.8327 [+0.0208]
  + MRF:       median(top-10)=0.9328, mean(top-10)=0.9334, median(all)=0.8990, mean(all)=0.8329 [+0.0000]
  TOTAL IMPROVEMENT (median top-10): +0.0208

================================================================================
Subject: MMRR-21-8
================================================================================
  Step 0: Generating predictions with V2 model (30 random views)...
  Mesh: 124399 vertices, 248794 faces
  Generating 30 random views...
  Generating predictions for 30 views (continuous camera pose)...
    ✓ Random_0 (pose=(0.6719262897101115, -2.8009366918570446, 0.2445605194432381)): shape (37, 800, 800)
      Valid pixels: 74776/640000 (11.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=39, max=248793, num_faces=248794
      Valid probs shape: (37, 74776)
    ✓ Random_1 (pose=(-2.493017620806858, -0.4685667122327861, -2.693813811197423)): shape (37, 800, 800)
      Valid pixels: 76356/640000 (11.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=57, max=248793, num_faces=248794
      Valid probs shape: (37, 76356)
    ✓ Random_2 (pose=(2.8669981845778345, 1.4000282834758533, -1.4328234660081556)): shape (37, 800, 800)
      Valid pixels: 81899/640000 (12.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=120, max=248788, num_faces=248794
      Valid probs shape: (37, 81899)
    ✓ Random_3 (pose=(-0.345686994469677, -2.1918102301318103, 1.761831169439997)): shape (37, 800, 800)
      Valid pixels: 89556/640000 (14.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=39, max=248793, num_faces=248794
      Valid probs shape: (37, 89556)
    ✓ Random_4 (pose=(-0.9757606489930457, -2.354356036414874, -0.9003228190882719)): shape (37, 800, 800)
      Valid pixels: 92908/640000 (14.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=128, max=248789, num_faces=248794
      Valid probs shape: (37, 92908)
    ✓ Random_5 (pose=(0.3593223902690177, 2.908293377126773, 2.559223573808315)): shape (37, 800, 800)
      Valid pixels: 63648/640000 (9.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=31167, max=248759, num_faces=248794
      Valid probs shape: (37, 63648)
    ✓ Random_6 (pose=(0.8848533626237431, -2.46380527010853, 1.7282033792676703)): shape (37, 800, 800)
      Valid pixels: 59885/640000 (9.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=39, max=248739, num_faces=248794
      Valid probs shape: (37, 59885)
    ✓ Random_7 (pose=(1.8249318456744055, 2.8842382689946273, -0.9407383585641234)): shape (37, 800, 800)
      Valid pixels: 84208/640000 (13.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=18, max=248793, num_faces=248794
      Valid probs shape: (37, 84208)
    ✓ Random_8 (pose=(-1.4013389295398675, 0.7231900346732258, 2.57979952436286)): shape (37, 800, 800)
      Valid pixels: 97713/640000 (15.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=19, max=248793, num_faces=248794
      Valid probs shape: (37, 97713)
    ✓ Random_9 (pose=(0.4723884463861485, -0.211747863872636, 0.957116570874847)): shape (37, 800, 800)
      Valid pixels: 58870/640000 (9.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=248778, num_faces=248794
      Valid probs shape: (37, 58870)
    ✓ Random_10 (pose=(2.915705200390722, -2.2130550490128225, -0.9743259714784402)): shape (37, 800, 800)
      Valid pixels: 79410/640000 (12.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=248777, num_faces=248794
      Valid probs shape: (37, 79410)
    ✓ Random_11 (pose=(0.7347585899988376, -2.655263985566389, 3.1336143849510707)): shape (37, 800, 800)
      Valid pixels: 83096/640000 (13.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=5894, max=248573, num_faces=248794
      Valid probs shape: (37, 83096)
    ✓ Random_12 (pose=(-2.32902437291869, -1.91987603931304, -3.0592015553436482)): shape (37, 800, 800)
      Valid pixels: 95821/640000 (15.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=10, max=248793, num_faces=248794
      Valid probs shape: (37, 95821)
    ✓ Random_13 (pose=(-2.8500703328288988, -1.78940617417755, -2.083920646309184)): shape (37, 800, 800)
      Valid pixels: 101006/640000 (15.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=248793, num_faces=248794
      Valid probs shape: (37, 101006)
    ✓ Random_14 (pose=(-1.652851634847436, 2.0553588309269273, 1.8124269255727468)): shape (37, 800, 800)
      Valid pixels: 74133/640000 (11.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=57, max=248793, num_faces=248794
      Valid probs shape: (37, 74133)
    ✓ Random_15 (pose=(-2.688287892548934, 2.6583024238751705, 2.8880210560864548)): shape (37, 800, 800)
      Valid pixels: 64518/640000 (10.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=248777, num_faces=248794
      Valid probs shape: (37, 64518)
    ✓ Random_16 (pose=(0.5314814090756461, 0.7719490504756168, 1.1793769492741832)): shape (37, 800, 800)
      Valid pixels: 71328/640000 (11.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=248567, num_faces=248794
      Valid probs shape: (37, 71328)
    ✓ Random_17 (pose=(0.015195230009148464, -2.7769503006219827, 2.7054527490403535)): shape (37, 800, 800)
      Valid pixels: 45782/640000 (7.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=58, max=248793, num_faces=248794
      Valid probs shape: (37, 45782)
    ✓ Random_18 (pose=(-0.33711497579321215, -1.9811704684301776, 1.8880813321499064)): shape (37, 800, 800)
      Valid pixels: 95623/640000 (14.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=55, max=248793, num_faces=248794
      Valid probs shape: (37, 95623)
    ✓ Random_19 (pose=(-2.1449623715667716, -1.8169312801799065, -0.7164335520877922)): shape (37, 800, 800)
      Valid pixels: 71110/640000 (11.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=248557, num_faces=248794
      Valid probs shape: (37, 71110)
    ✓ Random_20 (pose=(0.1474545111750345, 0.11696820872739, 3.052758380984324)): shape (37, 800, 800)
      Valid pixels: 48080/640000 (7.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=247416, num_faces=248794
      Valid probs shape: (37, 48080)
    ✓ Random_21 (pose=(2.0862121382436616, -0.6919283981590509, 0.85371787222092)): shape (37, 800, 800)
      Valid pixels: 62701/640000 (9.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=80, max=248776, num_faces=248794
      Valid probs shape: (37, 62701)
    ✓ Random_22 (pose=(0.2962392471053463, 2.2763445242940143, -0.6521584539682665)): shape (37, 800, 800)
      Valid pixels: 70855/640000 (11.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=39, max=248793, num_faces=248794
      Valid probs shape: (37, 70855)
    ✓ Random_23 (pose=(1.1189431922089383, 1.3963822639833063, 0.9580350820073811)): shape (37, 800, 800)
      Valid pixels: 59379/640000 (9.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=248768, num_faces=248794
      Valid probs shape: (37, 59379)
    ✓ Random_24 (pose=(-2.3097815565468887, -2.253313388997612, 0.4561892591111891)): shape (37, 800, 800)
      Valid pixels: 89551/640000 (14.0%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=5, max=248789, num_faces=248794
      Valid probs shape: (37, 89551)
    ✓ Random_25 (pose=(0.9019344469754254, -2.76468249274518, -0.1563150292781068)): shape (37, 800, 800)
      Valid pixels: 88203/640000 (13.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=39, max=248793, num_faces=248794
      Valid probs shape: (37, 88203)
    ✓ Random_26 (pose=(2.137270870655909, -0.5427252547716819, -2.7069935026192917)): shape (37, 800, 800)
      Valid pixels: 71987/640000 (11.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1192, max=248793, num_faces=248794
      Valid probs shape: (37, 71987)
    ✓ Random_27 (pose=(0.05155196139720575, 1.1773755791636038, -1.4052329945038093)): shape (37, 800, 800)
      Valid pixels: 91517/640000 (14.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=248778, num_faces=248794
      Valid probs shape: (37, 91517)
    ✓ Random_28 (pose=(-3.0468351400699922, 1.4463567425768318, -2.93750191958442)): shape (37, 800, 800)
      Valid pixels: 61634/640000 (9.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=19, max=248571, num_faces=248794
      Valid probs shape: (37, 61634)
    ✓ Random_29 (pose=(3.0910062526592856, -1.5344906063789603, -2.476893391544708)): shape (37, 800, 800)
      Valid pixels: 89533/640000 (14.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=60, max=248793, num_faces=248794
      Valid probs shape: (37, 89533)
    P stats: min=0.0000, max=0.9999, mean=0.0253
    Non-zero vertices: 116469/124399
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 7930 1017 1102 3078    0 2145 1218 4144 6192]
  Ground Truth Stats:
    Labels shape: (124399,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-8/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7770
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8389
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8392

  RESULTS:
  RAW:         median(top-10)=0.9090, mean(top-10)=0.9087, median(all)=0.8288, mean(all)=0.7770
  + SMOOTHING: median(top-10)=0.9301, mean(top-10)=0.9318, median(all)=0.8802, mean(all)=0.8389 [+0.0211]
  + MRF:       median(top-10)=0.9300, mean(top-10)=0.9318, median(all)=0.8813, mean(all)=0.8392 [-0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0210

================================================================================
Subject: MMRR-21-9
================================================================================
  Step 0: Generating predictions with V2 model (30 random views)...
  Mesh: 131827 vertices, 263650 faces
  Generating 30 random views...
  Generating predictions for 30 views (continuous camera pose)...
    ✓ Random_0 (pose=(3.0852323529869183, 2.2347540692618626, 1.1228569907210035)): shape (37, 800, 800)
      Valid pixels: 85663/640000 (13.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=263648, num_faces=263650
      Valid probs shape: (37, 85663)
    ✓ Random_1 (pose=(1.4583588670218397, 0.9122206234707315, -1.9635089972499198)): shape (37, 800, 800)
      Valid pixels: 68658/640000 (10.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=263649, num_faces=263650
      Valid probs shape: (37, 68658)
    ✓ Random_2 (pose=(0.6423585217128691, -0.4717665844291199, 1.5147864664682222)): shape (37, 800, 800)
      Valid pixels: 63783/640000 (10.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=263640, num_faces=263650
      Valid probs shape: (37, 63783)
    ✓ Random_3 (pose=(-0.4319370269765246, -1.0483496482632773, -0.8710823672105956)): shape (37, 800, 800)
      Valid pixels: 82035/640000 (12.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=263639, num_faces=263650
      Valid probs shape: (37, 82035)
    ✓ Random_4 (pose=(2.3751690890022523, 0.5260413740959122, -0.9029121125852662)): shape (37, 800, 800)
      Valid pixels: 66198/640000 (10.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=751, max=263649, num_faces=263650
      Valid probs shape: (37, 66198)
    ✓ Random_5 (pose=(-2.7854183292862063, 2.3290342798709807, 0.6366614374532089)): shape (37, 800, 800)
      Valid pixels: 58494/640000 (9.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=263534, num_faces=263650
      Valid probs shape: (37, 58494)
    ✓ Random_6 (pose=(-1.5795282431669124, 1.2435385052375922, -1.502082537383315)): shape (37, 800, 800)
      Valid pixels: 66528/640000 (10.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8, max=263645, num_faces=263650
      Valid probs shape: (37, 66528)
    ✓ Random_7 (pose=(1.989899785723888, 1.5223618127110772, 0.9723616499424645)): shape (37, 800, 800)
      Valid pixels: 84594/640000 (13.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=26, max=263647, num_faces=263650
      Valid probs shape: (37, 84594)
    ✓ Random_8 (pose=(-2.3354477718175572, 2.0944429561339755, -0.8965056390412558)): shape (37, 800, 800)
      Valid pixels: 94294/640000 (14.7%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=1, max=263639, num_faces=263650
      Valid probs shape: (37, 94294)
    ✓ Random_9 (pose=(0.0946164682542956, -1.660704106338898, -0.9095222102782659)): shape (37, 800, 800)
      Valid pixels: 76329/640000 (11.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=6, max=263643, num_faces=263650
      Valid probs shape: (37, 76329)
    ✓ Random_10 (pose=(2.5946774976083864, 1.341810151755137, 0.9091556053366974)): shape (37, 800, 800)
      Valid pixels: 102936/640000 (16.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=65, max=263645, num_faces=263650
      Valid probs shape: (37, 102936)
    ✓ Random_11 (pose=(2.93245016731157, 1.6283720062058435, 0.11740791171099918)): shape (37, 800, 800)
      Valid pixels: 80819/640000 (12.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=263641, num_faces=263650
      Valid probs shape: (37, 80819)
    ✓ Random_12 (pose=(-1.9253590774167628, -1.4884057199247873, -2.7964760553956722)): shape (37, 800, 800)
      Valid pixels: 102897/640000 (16.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=21, max=263642, num_faces=263650
      Valid probs shape: (37, 102897)
    ✓ Random_13 (pose=(1.2446104890128504, 3.0217639818515813, -1.2256482368752488)): shape (37, 800, 800)
      Valid pixels: 82252/640000 (12.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=165, max=263646, num_faces=263650
      Valid probs shape: (37, 82252)
    ✓ Random_14 (pose=(1.9989990610462876, -1.5348731745707962, -2.8479831119777117)): shape (37, 800, 800)
      Valid pixels: 76671/640000 (12.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=263648, num_faces=263650
      Valid probs shape: (37, 76671)
    ✓ Random_15 (pose=(3.0923523875774572, 1.3118311279567747, -0.5058777368855645)): shape (37, 800, 800)
      Valid pixels: 71367/640000 (11.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=7, max=263647, num_faces=263650
      Valid probs shape: (37, 71367)
    ✓ Random_16 (pose=(1.9746399898250182, -3.08975563836194, -0.8616520086130879)): shape (37, 800, 800)
      Valid pixels: 90071/640000 (14.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=263647, num_faces=263650
      Valid probs shape: (37, 90071)
    ✓ Random_17 (pose=(-0.29725911043800357, -2.5894258914807544, -3.0883800325184882)): shape (37, 800, 800)
      Valid pixels: 56247/640000 (8.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=777, max=263649, num_faces=263650
      Valid probs shape: (37, 56247)
    ✓ Random_18 (pose=(-2.3774027615560684, -1.2383076519258676, -1.8385909637877789)): shape (37, 800, 800)
      Valid pixels: 84243/640000 (13.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=61, max=263647, num_faces=263650
      Valid probs shape: (37, 84243)
    ✓ Random_19 (pose=(0.2754327657837563, 1.2904814585799373, 0.10219073830149705)): shape (37, 800, 800)
      Valid pixels: 63542/640000 (9.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=263649, num_faces=263650
      Valid probs shape: (37, 63542)
    ✓ Random_20 (pose=(-1.6390861288091176, 2.920791183674565, -2.9804813308072244)): shape (37, 800, 800)
      Valid pixels: 97824/640000 (15.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=263643, num_faces=263650
      Valid probs shape: (37, 97824)
    ✓ Random_21 (pose=(1.1744772504635916, -2.9223494850081955, -2.6539697186624847)): shape (37, 800, 800)
      Valid pixels: 83799/640000 (13.1%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=377, max=263646, num_faces=263650
      Valid probs shape: (37, 83799)
    ✓ Random_22 (pose=(-1.9647090164518461, -1.9473357599510488, 1.9596364235898012)): shape (37, 800, 800)
      Valid pixels: 64872/640000 (10.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=263640, num_faces=263650
      Valid probs shape: (37, 64872)
    ✓ Random_23 (pose=(3.031594107829684, 2.6924966097968968, 0.02162570646392803)): shape (37, 800, 800)
      Valid pixels: 51430/640000 (8.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=263534, num_faces=263650
      Valid probs shape: (37, 51430)
    ✓ Random_24 (pose=(-0.47649182061020445, -0.7057318005823379, -2.1343920569546153)): shape (37, 800, 800)
      Valid pixels: 69406/640000 (10.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=263622, num_faces=263650
      Valid probs shape: (37, 69406)
    ✓ Random_25 (pose=(1.830141467404471, 2.5292001807443327, 0.6452200671678816)): shape (37, 800, 800)
      Valid pixels: 85386/640000 (13.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=263645, num_faces=263650
      Valid probs shape: (37, 85386)
    ✓ Random_26 (pose=(0.7286904851409286, -2.665504519505612, 2.279875405850639)): shape (37, 800, 800)
      Valid pixels: 66001/640000 (10.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=23519, max=263647, num_faces=263650
      Valid probs shape: (37, 66001)
    ✓ Random_27 (pose=(0.6019112676626199, 0.9699255056999991, -1.269982438979091)): shape (37, 800, 800)
      Valid pixels: 93370/640000 (14.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=263644, num_faces=263650
      Valid probs shape: (37, 93370)
    ✓ Random_28 (pose=(-0.46590775864185296, -3.0785370387815143, 1.3094627966682753)): shape (37, 800, 800)
      Valid pixels: 52846/640000 (8.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1064, max=263649, num_faces=263650
      Valid probs shape: (37, 52846)
    ✓ Random_29 (pose=(-1.3136239708129893, -2.566634414698045, 1.4935234695127821)): shape (37, 800, 800)
      Valid pixels: 67759/640000 (10.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=43, max=263647, num_faces=263650
      Valid probs shape: (37, 67759)
    P stats: min=0.0000, max=1.0000, mean=0.0249
    Non-zero vertices: 121513/131827
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 10314  1211  1181  3174     0  1793  1029  4492  5957]
  Ground Truth Stats:
    Labels shape: (131827,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-9/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7769
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8344
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8345

  RESULTS:
  RAW:         median(top-10)=0.9117, mean(top-10)=0.9086, median(all)=0.8257, mean(all)=0.7769
  + SMOOTHING: median(top-10)=0.9292, mean(top-10)=0.9323, median(all)=0.8773, mean(all)=0.8344 [+0.0175]
  + MRF:       median(top-10)=0.9296, mean(top-10)=0.9323, median(all)=0.8783, mean(all)=0.8345 [+0.0004]
  TOTAL IMPROVEMENT (median top-10): +0.0180

================================================================================
Subject: MMRR-3T7T-2-1
================================================================================
  Step 0: Generating predictions with V2 model (30 random views)...
  Mesh: 150156 vertices, 300308 faces
  Generating 30 random views...
  Generating predictions for 30 views (continuous camera pose)...
    ✓ Random_0 (pose=(-1.1062065382137964, 2.331890062686994, -0.7193400857902912)): shape (37, 800, 800)
      Valid pixels: 92784/640000 (14.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=4005, max=300280, num_faces=300308
      Valid probs shape: (37, 92784)
    ✓ Random_1 (pose=(-0.033102261836290836, 2.6412038403533247, 0.7626919848997589)): shape (37, 800, 800)
      Valid pixels: 72755/640000 (11.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=35666, max=300280, num_faces=300308
      Valid probs shape: (37, 72755)
    ✓ Random_2 (pose=(2.987311176141337, -2.436658153630541, -1.4512511239502601)): shape (37, 800, 800)
      Valid pixels: 82425/640000 (12.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=300304, num_faces=300308
      Valid probs shape: (37, 82425)
    ✓ Random_3 (pose=(-0.30181900271825857, 0.41180557798114936, -1.941018202563377)): shape (37, 800, 800)
      Valid pixels: 69235/640000 (10.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=300291, num_faces=300308
      Valid probs shape: (37, 69235)
    ✓ Random_4 (pose=(2.992839855803637, 2.2784972516275195, 1.178383433960379)): shape (37, 800, 800)
      Valid pixels: 90380/640000 (14.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=300296, num_faces=300308
      Valid probs shape: (37, 90380)
    ✓ Random_5 (pose=(1.827648575420854, 2.764942559302354, 1.0660565883388724)): shape (37, 800, 800)
      Valid pixels: 76876/640000 (12.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=300300, num_faces=300308
      Valid probs shape: (37, 76876)
    ✓ Random_6 (pose=(0.8175062608280608, -1.9449155213152045, 2.8647812479091828)): shape (37, 800, 800)
      Valid pixels: 96543/640000 (15.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=704, max=300280, num_faces=300308
      Valid probs shape: (37, 96543)
    ✓ Random_7 (pose=(-1.7258737399020176, -0.07056666998332162, 0.2842316249665542)): shape (37, 800, 800)
      Valid pixels: 94460/640000 (14.8%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=7, max=300279, num_faces=300308
      Valid probs shape: (37, 94460)
    ✓ Random_8 (pose=(-0.23792753081222662, -2.1258573466948425, -0.17284725276479973)): shape (37, 800, 800)
      Valid pixels: 73344/640000 (11.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=2900, max=300279, num_faces=300308
      Valid probs shape: (37, 73344)
    ✓ Random_9 (pose=(-1.2840450096436915, 2.844157239725112, 2.564591511556162)): shape (37, 800, 800)
      Valid pixels: 111976/640000 (17.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=42, max=300307, num_faces=300308
      Valid probs shape: (37, 111976)
    ✓ Random_10 (pose=(1.1207837553720408, 2.069595837575677, -2.289480784111008)): shape (37, 800, 800)
      Valid pixels: 71954/640000 (11.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=975, max=300279, num_faces=300308
      Valid probs shape: (37, 71954)
    ✓ Random_11 (pose=(0.8092262675611934, 0.38949038334440145, -1.5896652960606155)): shape (37, 800, 800)
      Valid pixels: 66623/640000 (10.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=300284, num_faces=300308
      Valid probs shape: (37, 66623)
    ✓ Random_12 (pose=(-1.213719532474687, -2.822773948686578, -3.074243293874465)): shape (37, 800, 800)
      Valid pixels: 103641/640000 (16.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=15, max=300307, num_faces=300308
      Valid probs shape: (37, 103641)
    ✓ Random_13 (pose=(0.5320068785285672, -0.5689727765296113, 1.7686759532378744)): shape (37, 800, 800)
      Valid pixels: 67326/640000 (10.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=300044, num_faces=300308
      Valid probs shape: (37, 67326)
    ✓ Random_14 (pose=(1.4553165916399795, 0.9306824386285175, 1.6026223148262941)): shape (37, 800, 800)
      Valid pixels: 73961/640000 (11.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=299501, num_faces=300308
      Valid probs shape: (37, 73961)
    ✓ Random_15 (pose=(0.1870956765501024, -0.612198691740335, 2.96854265296426)): shape (37, 800, 800)
      Valid pixels: 65332/640000 (10.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=299357, num_faces=300308
      Valid probs shape: (37, 65332)
    ✓ Random_16 (pose=(-0.6453382841755055, -0.978259820477136, -2.769344640653487)): shape (37, 800, 800)
      Valid pixels: 69294/640000 (10.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=300281, num_faces=300308
      Valid probs shape: (37, 69294)
    ✓ Random_17 (pose=(3.052034174057054, 1.9576688422593458, 1.8005616384247007)): shape (37, 800, 800)
      Valid pixels: 96050/640000 (15.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=300307, num_faces=300308
      Valid probs shape: (37, 96050)
    ✓ Random_18 (pose=(-0.40625866844111913, 2.966737564686656, -0.6244260287412438)): shape (37, 800, 800)
      Valid pixels: 65227/640000 (10.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=64458, max=300280, num_faces=300308
      Valid probs shape: (37, 65227)
    ✓ Random_19 (pose=(2.3146802185914677, -1.9939282015338589, -0.8520764803689262)): shape (37, 800, 800)
      Valid pixels: 110473/640000 (17.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=300304, num_faces=300308
      Valid probs shape: (37, 110473)
    ✓ Random_20 (pose=(-0.684562447364228, -0.26296972425990006, -2.3403145973302624)): shape (37, 800, 800)
      Valid pixels: 65315/640000 (10.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=300284, num_faces=300308
      Valid probs shape: (37, 65315)
    ✓ Random_21 (pose=(-0.045717856485611996, -1.873151921935652, -2.5890848186785256)): shape (37, 800, 800)
      Valid pixels: 92226/640000 (14.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=4010, max=300280, num_faces=300308
      Valid probs shape: (37, 92226)
    ✓ Random_22 (pose=(2.8222517384409818, 0.3277973898167552, 1.5100905849398432)): shape (37, 800, 800)
      Valid pixels: 57397/640000 (9.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=323, max=300307, num_faces=300308
      Valid probs shape: (37, 57397)
    ✓ Random_23 (pose=(-1.093026093907389, -1.274400186367705, -1.4132158101168268)): shape (37, 800, 800)
      Valid pixels: 101370/640000 (15.8%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=33, max=300280, num_faces=300308
      Valid probs shape: (37, 101370)
    ✓ Random_24 (pose=(1.4614190903551973, 0.27442466392121956, 2.3186608842311207)): shape (37, 800, 800)
      Valid pixels: 107268/640000 (16.8%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=11, max=300280, num_faces=300308
      Valid probs shape: (37, 107268)
    ✓ Random_25 (pose=(0.5736992650640405, 2.726918099768911, -0.9176905313959236)): shape (37, 800, 800)
      Valid pixels: 88294/640000 (13.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=76, max=300307, num_faces=300308
      Valid probs shape: (37, 88294)
    ✓ Random_26 (pose=(-2.8111084295197406, 2.1018373729075037, -3.0754509753138577)): shape (37, 800, 800)
      Valid pixels: 67657/640000 (10.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=300282, num_faces=300308
      Valid probs shape: (37, 67657)
    ✓ Random_27 (pose=(2.4723506851166936, -0.9572001341467447, -0.3615093141149903)): shape (37, 800, 800)
      Valid pixels: 89991/640000 (14.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=26, max=300307, num_faces=300308
      Valid probs shape: (37, 89991)
    ✓ Random_28 (pose=(-0.5844088897139561, -0.595465412967902, -3.120419438662994)): shape (37, 800, 800)
      Valid pixels: 74167/640000 (11.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=300306, num_faces=300308
      Valid probs shape: (37, 74167)
    ✓ Random_29 (pose=(-2.5286077081594156, 0.3511184565157768, -0.7551465050097868)): shape (37, 800, 800)
      Valid pixels: 85320/640000 (13.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=20895, max=300280, num_faces=300308
      Valid probs shape: (37, 85320)
    P stats: min=0.0000, max=0.9999, mean=0.0246
    Non-zero vertices: 136560/150156
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 13596   929  1118  4157     0  1792   960  5477  6538]
  Ground Truth Stats:
    Labels shape: (150156,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-3T7T-2-1/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7335
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7990
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7992

  RESULTS:
  RAW:         median(top-10)=0.8990, mean(top-10)=0.9019, median(all)=0.8084, mean(all)=0.7335
  + SMOOTHING: median(top-10)=0.9275, mean(top-10)=0.9271, median(all)=0.8515, mean(all)=0.7990 [+0.0285]
  + MRF:       median(top-10)=0.9276, mean(top-10)=0.9272, median(all)=0.8523, mean(all)=0.7992 [+0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0286

================================================================================
Subject: MMRR-3T7T-2-2
================================================================================
  Step 0: Generating predictions with V2 model (30 random views)...
  Mesh: 135252 vertices, 270500 faces
  Generating 30 random views...
  Generating predictions for 30 views (continuous camera pose)...
    ✓ Random_0 (pose=(2.7896314987946003, -3.1095834942623686, -1.9085489779632279)): shape (37, 800, 800)
      Valid pixels: 56012/640000 (8.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=270262, num_faces=270500
      Valid probs shape: (37, 56012)
    ✓ Random_1 (pose=(-1.9790221725406292, -2.4282596255159468, -1.9897071420767958)): shape (37, 800, 800)
      Valid pixels: 69786/640000 (10.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=270404, num_faces=270500
      Valid probs shape: (37, 69786)
    ✓ Random_2 (pose=(-1.2159246474184233, -0.1219539497013562, -0.535650800930155)): shape (37, 800, 800)
      Valid pixels: 94111/640000 (14.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=270499, num_faces=270500
      Valid probs shape: (37, 94111)
    ✓ Random_3 (pose=(0.26390415913666576, 0.47946150561476486, -0.3571581246114177)): shape (37, 800, 800)
      Valid pixels: 57076/640000 (8.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=270404, num_faces=270500
      Valid probs shape: (37, 57076)
    ✓ Random_4 (pose=(-2.7780674403438086, -2.7535360056899423, -1.7330775454380623)): shape (37, 800, 800)
      Valid pixels: 56903/640000 (8.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=270404, num_faces=270500
      Valid probs shape: (37, 56903)
    ✓ Random_5 (pose=(0.39154135857447425, -0.09197913297729254, -1.9872910616984363)): shape (37, 800, 800)
      Valid pixels: 59663/640000 (9.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=270397, num_faces=270500
      Valid probs shape: (37, 59663)
    ✓ Random_6 (pose=(-1.873625145768439, 1.7137449435495, 0.9206154826811153)): shape (37, 800, 800)
      Valid pixels: 68116/640000 (10.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=30, max=270441, num_faces=270500
      Valid probs shape: (37, 68116)
    ✓ Random_7 (pose=(2.9653310014445937, -2.7386433804472547, -2.5518596053463964)): shape (37, 800, 800)
      Valid pixels: 52753/640000 (8.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=270436, num_faces=270500
      Valid probs shape: (37, 52753)
    ✓ Random_8 (pose=(-0.2708213694280879, 2.009973486890101, -0.29473775082803666)): shape (37, 800, 800)
      Valid pixels: 61082/640000 (9.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=129, max=270498, num_faces=270500
      Valid probs shape: (37, 61082)
    ✓ Random_9 (pose=(-2.169661000101363, -1.9279989136032163, 1.170037114210432)): shape (37, 800, 800)
      Valid pixels: 77000/640000 (12.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=270498, num_faces=270500
      Valid probs shape: (37, 77000)
    ✓ Random_10 (pose=(-2.6491091735917114, -2.1532102985031303, -2.109759858393234)): shape (37, 800, 800)
      Valid pixels: 86505/640000 (13.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=270404, num_faces=270500
      Valid probs shape: (37, 86505)
    ✓ Random_11 (pose=(0.12588411836750124, -3.104902408479254, 0.7583703589282909)): shape (37, 800, 800)
      Valid pixels: 50889/640000 (8.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=907, max=270499, num_faces=270500
      Valid probs shape: (37, 50889)
    ✓ Random_12 (pose=(-3.03432018993021, 0.1732221348684062, -2.0378574455786245)): shape (37, 800, 800)
      Valid pixels: 52448/640000 (8.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=83742, max=270499, num_faces=270500
      Valid probs shape: (37, 52448)
    ✓ Random_13 (pose=(-2.1917916619629203, 1.1253992987086576, 0.963520222593214)): shape (37, 800, 800)
      Valid pixels: 65179/640000 (10.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1213, max=270491, num_faces=270500
      Valid probs shape: (37, 65179)
    ✓ Random_14 (pose=(-0.2787061666116144, 2.265308097573431, -1.12107386054892)): shape (37, 800, 800)
      Valid pixels: 69959/640000 (10.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=127, max=270498, num_faces=270500
      Valid probs shape: (37, 69959)
    ✓ Random_15 (pose=(-1.9848508426560656, 3.0876240499121472, 2.579258370053358)): shape (37, 800, 800)
      Valid pixels: 90756/640000 (14.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=270436, num_faces=270500
      Valid probs shape: (37, 90756)
    ✓ Random_16 (pose=(2.6602221641835673, 0.19407718146747044, -1.1864955455105253)): shape (37, 800, 800)
      Valid pixels: 51570/640000 (8.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2069, max=270491, num_faces=270500
      Valid probs shape: (37, 51570)
    ✓ Random_17 (pose=(-2.6098234207732327, 0.03256313830863711, 1.9069222795014271)): shape (37, 800, 800)
      Valid pixels: 57431/640000 (9.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=870, max=270491, num_faces=270500
      Valid probs shape: (37, 57431)
    ✓ Random_18 (pose=(1.431132220354324, -1.3097221731446063, -1.8358268524337193)): shape (37, 800, 800)
      Valid pixels: 68715/640000 (10.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=80, max=270438, num_faces=270500
      Valid probs shape: (37, 68715)
    ✓ Random_19 (pose=(-2.0376848800650933, 2.4734552709442488, 2.0016628710505335)): shape (37, 800, 800)
      Valid pixels: 87614/640000 (13.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=270442, num_faces=270500
      Valid probs shape: (37, 87614)
    ✓ Random_20 (pose=(0.9926715405167252, -1.2582276253793978, 0.14870660206928754)): shape (37, 800, 800)
      Valid pixels: 99960/640000 (15.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=270436, num_faces=270500
      Valid probs shape: (37, 99960)
    ✓ Random_21 (pose=(-2.145194949825999, 2.0653338107252504, -1.0928588199412483)): shape (37, 800, 800)
      Valid pixels: 95033/640000 (14.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=270499, num_faces=270500
      Valid probs shape: (37, 95033)
    ✓ Random_22 (pose=(-2.342540315126298, 0.48484234492758826, -2.4782517132393385)): shape (37, 800, 800)
      Valid pixels: 65953/640000 (10.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=366, max=270498, num_faces=270500
      Valid probs shape: (37, 65953)
    ✓ Random_23 (pose=(-2.150801427872038, -0.16584955227301723, 0.07444149900245778)): shape (37, 800, 800)
      Valid pixels: 84613/640000 (13.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=706, max=270499, num_faces=270500
      Valid probs shape: (37, 84613)
    ✓ Random_24 (pose=(-2.8699112989810236, -1.038901536705271, -2.0201988968937012)): shape (37, 800, 800)
      Valid pixels: 93024/640000 (14.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=17, max=270466, num_faces=270500
      Valid probs shape: (37, 93024)
    ✓ Random_25 (pose=(1.5106803309036998, 2.5862289959776668, 3.1208224211945588)): shape (37, 800, 800)
      Valid pixels: 91415/640000 (14.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=36, max=270499, num_faces=270500
      Valid probs shape: (37, 91415)
    ✓ Random_26 (pose=(2.4991243625531965, -1.8329938405582584, 0.20356529145254054)): shape (37, 800, 800)
      Valid pixels: 67180/640000 (10.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=270464, num_faces=270500
      Valid probs shape: (37, 67180)
    ✓ Random_27 (pose=(0.10091129246000152, -2.301761046207179, 2.7710252013721286)): shape (37, 800, 800)
      Valid pixels: 61398/640000 (9.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=366, max=270496, num_faces=270500
      Valid probs shape: (37, 61398)
    ✓ Random_28 (pose=(-2.7973393306487084, 2.335401066361774, -0.3127369628379246)): shape (37, 800, 800)
      Valid pixels: 67838/640000 (10.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=270436, num_faces=270500
      Valid probs shape: (37, 67838)
    ✓ Random_29 (pose=(0.7056363836261581, 1.3197796963854591, 1.3906998029896451)): shape (37, 800, 800)
      Valid pixels: 90183/640000 (14.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=270499, num_faces=270500
      Valid probs shape: (37, 90183)
    P stats: min=0.0000, max=1.0000, mean=0.0251
    Non-zero vertices: 125707/135252
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 9545 1039  933 2603    0 1500  946 4262 6671]
  Ground Truth Stats:
    Labels shape: (135252,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-3T7T-2-2/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7570
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7998
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8001

  RESULTS:
  RAW:         median(top-10)=0.8951, mean(top-10)=0.8981, median(all)=0.8289, mean(all)=0.7570
  + SMOOTHING: median(top-10)=0.9231, mean(top-10)=0.9219, median(all)=0.8620, mean(all)=0.7998 [+0.0280]
  + MRF:       median(top-10)=0.9229, mean(top-10)=0.9220, median(all)=0.8620, mean(all)=0.8001 [-0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0278

================================================================================
Subject: NKI-RS-22-1
================================================================================
  Step 0: Generating predictions with V2 model (30 random views)...
  Mesh: 137338 vertices, 274672 faces
  Generating 30 random views...
  Generating predictions for 30 views (continuous camera pose)...
    ✓ Random_0 (pose=(-1.66710026433652, 0.7761679877228045, 1.8048488015177284)): shape (37, 800, 800)
      Valid pixels: 79165/640000 (12.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=122, max=274670, num_faces=274672
      Valid probs shape: (37, 79165)
    ✓ Random_1 (pose=(-2.743920401781451, 0.3421185594467975, -1.0173394140832555)): shape (37, 800, 800)
      Valid pixels: 70039/640000 (10.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=17977, max=274671, num_faces=274672
      Valid probs shape: (37, 70039)
    ✓ Random_2 (pose=(2.3003822242739203, 1.771763233923357, -2.3679049110827894)): shape (37, 800, 800)
      Valid pixels: 93036/640000 (14.5%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=12, max=274667, num_faces=274672
      Valid probs shape: (37, 93036)
    ✓ Random_3 (pose=(0.04934033025337392, -0.6903044838404493, 0.21457370909770646)): shape (37, 800, 800)
      Valid pixels: 53010/640000 (8.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=274668, num_faces=274672
      Valid probs shape: (37, 53010)
    ✓ Random_4 (pose=(1.193315540931419, -2.7590947326474695, -0.2444370625236263)): shape (37, 800, 800)
      Valid pixels: 102801/640000 (16.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=48, max=274671, num_faces=274672
      Valid probs shape: (37, 102801)
    ✓ Random_5 (pose=(2.5289800890157474, 0.5136103079089471, 2.464389803322609)): shape (37, 800, 800)
      Valid pixels: 62952/640000 (9.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=26521, max=274671, num_faces=274672
      Valid probs shape: (37, 62952)
    ✓ Random_6 (pose=(-1.7377185052078135, 0.2719889263204238, -1.371930422314788)): shape (37, 800, 800)
      Valid pixels: 72871/640000 (11.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=21, max=273780, num_faces=274672
      Valid probs shape: (37, 72871)
    ✓ Random_7 (pose=(0.45610462377299665, 0.19049771213714628, -1.6293414388279346)): shape (37, 800, 800)
      Valid pixels: 48037/640000 (7.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=274605, num_faces=274672
      Valid probs shape: (37, 48037)
    ✓ Random_8 (pose=(1.8442486546319143, -2.30267340120899, -1.2664879202942771)): shape (37, 800, 800)
      Valid pixels: 85581/640000 (13.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=19, max=274669, num_faces=274672
      Valid probs shape: (37, 85581)
    ✓ Random_9 (pose=(-2.962882790822176, -1.471172564763209, -0.6534178634394605)): shape (37, 800, 800)
      Valid pixels: 70331/640000 (11.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=274116, num_faces=274672
      Valid probs shape: (37, 70331)
    ✓ Random_10 (pose=(-1.46256275040494, -1.8354114310815453, 0.6846462810425646)): shape (37, 800, 800)
      Valid pixels: 76132/640000 (11.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=117, max=274671, num_faces=274672
      Valid probs shape: (37, 76132)
    ✓ Random_11 (pose=(0.16581725248326373, 0.42590951802531185, -0.4462202802923292)): shape (37, 800, 800)
      Valid pixels: 58919/640000 (9.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=274141, num_faces=274672
      Valid probs shape: (37, 58919)
    ✓ Random_12 (pose=(-1.7212101965138427, 0.5600969901107256, 1.7107106083635806)): shape (37, 800, 800)
      Valid pixels: 74844/640000 (11.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=287, max=274671, num_faces=274672
      Valid probs shape: (37, 74844)
    ✓ Random_13 (pose=(1.9878042428511238, -0.8842887891891462, 0.6253566995710349)): shape (37, 800, 800)
      Valid pixels: 72849/640000 (11.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=21, max=274113, num_faces=274672
      Valid probs shape: (37, 72849)
    ✓ Random_14 (pose=(-2.009345612225556, 1.8516707414703646, 1.6884716283637173)): shape (37, 800, 800)
      Valid pixels: 88393/640000 (13.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=64, max=274669, num_faces=274672
      Valid probs shape: (37, 88393)
    ✓ Random_15 (pose=(2.3031229247209035, -3.1169825917111087, -2.1981447302432264)): shape (37, 800, 800)
      Valid pixels: 60711/640000 (9.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=0, max=274600, num_faces=274672
      Valid probs shape: (37, 60711)
    ✓ Random_16 (pose=(1.1756976259497423, 1.6765538066628807, 0.23376364578277098)): shape (37, 800, 800)
      Valid pixels: 83613/640000 (13.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=274116, num_faces=274672
      Valid probs shape: (37, 83613)
    ✓ Random_17 (pose=(2.4867071742227225, 2.356100147963091, -1.6497721497195155)): shape (37, 800, 800)
      Valid pixels: 68002/640000 (10.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=0, max=274669, num_faces=274672
      Valid probs shape: (37, 68002)
    ✓ Random_18 (pose=(2.113351576937843, 2.3523985179703883, 2.0493760140826085)): shape (37, 800, 800)
      Valid pixels: 65482/640000 (10.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=273779, num_faces=274672
      Valid probs shape: (37, 65482)
    ✓ Random_19 (pose=(-1.5478656546388796, -0.7711977537731762, -2.9653828841506087)): shape (37, 800, 800)
      Valid pixels: 99018/640000 (15.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=274588, num_faces=274672
      Valid probs shape: (37, 99018)
    ✓ Random_20 (pose=(-0.8698710190086354, 2.4076592704167394, 1.500150263911178)): shape (37, 800, 800)
      Valid pixels: 73220/640000 (11.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1775, max=274670, num_faces=274672
      Valid probs shape: (37, 73220)
    ✓ Random_21 (pose=(-0.1581839366937725, -0.9696098243402602, -1.670184746244098)): shape (37, 800, 800)
      Valid pixels: 90646/640000 (14.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=274165, num_faces=274672
      Valid probs shape: (37, 90646)
    ✓ Random_22 (pose=(-2.3600216854483516, -3.1068768423646356, -0.37885983471486684)): shape (37, 800, 800)
      Valid pixels: 82578/640000 (12.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=273554, num_faces=274672
      Valid probs shape: (37, 82578)
    ✓ Random_23 (pose=(-0.5380578013048058, -1.0519351565346016, -2.2652553721874176)): shape (37, 800, 800)
      Valid pixels: 73070/640000 (11.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=273780, num_faces=274672
      Valid probs shape: (37, 73070)
    ✓ Random_24 (pose=(-2.939892745659841, 1.2441535276242535, -2.8869874845201533)): shape (37, 800, 800)
      Valid pixels: 60129/640000 (9.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8209, max=274670, num_faces=274672
      Valid probs shape: (37, 60129)
    ✓ Random_25 (pose=(0.06947338476864662, 1.7521225516837635, -0.4611155149644248)): shape (37, 800, 800)
      Valid pixels: 71066/640000 (11.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=20, max=274116, num_faces=274672
      Valid probs shape: (37, 71066)
    ✓ Random_26 (pose=(-2.1834039859041097, -1.122829687215654, -0.14560025722001324)): shape (37, 800, 800)
      Valid pixels: 95872/640000 (15.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=304, max=274671, num_faces=274672
      Valid probs shape: (37, 95872)
    ✓ Random_27 (pose=(-0.7446493790178326, -0.38340414318760496, -2.5544906066547495)): shape (37, 800, 800)
      Valid pixels: 67003/640000 (10.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=274116, num_faces=274672
      Valid probs shape: (37, 67003)
    ✓ Random_28 (pose=(2.321718104023317, -2.2881182750943445, 1.828356549304723)): shape (37, 800, 800)
      Valid pixels: 93010/640000 (14.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=3, max=273771, num_faces=274672
      Valid probs shape: (37, 93010)
    ✓ Random_29 (pose=(2.5327795749737714, 1.7217414446450423, 1.7246670153033028)): shape (37, 800, 800)
      Valid pixels: 78947/640000 (12.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=274116, num_faces=274672
      Valid probs shape: (37, 78947)
    P stats: min=0.0000, max=0.9999, mean=0.0255
    Non-zero vertices: 129752/137338
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 7586 1113  795 3401    0 2396 1088 4424 6567]
  Ground Truth Stats:
    Labels shape: (137338,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-1/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7734
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8215
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8217

  RESULTS:
  RAW:         median(top-10)=0.9195, mean(top-10)=0.9139, median(all)=0.8411, mean(all)=0.7734
  + SMOOTHING: median(top-10)=0.9363, mean(top-10)=0.9333, median(all)=0.8671, mean(all)=0.8215 [+0.0168]
  + MRF:       median(top-10)=0.9364, mean(top-10)=0.9335, median(all)=0.8663, mean(all)=0.8217 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0169

================================================================================
Subject: NKI-RS-22-10
================================================================================
  Step 0: Generating predictions with V2 model (30 random views)...
  Mesh: 130448 vertices, 260892 faces
  Generating 30 random views...
  Generating predictions for 30 views (continuous camera pose)...
    ✓ Random_0 (pose=(-0.5149350369548205, -2.7670844973183826, 1.935845482619337)): shape (37, 800, 800)
      Valid pixels: 76777/640000 (12.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=28, max=260891, num_faces=260892
      Valid probs shape: (37, 76777)
    ✓ Random_1 (pose=(-2.6739939739756258, -0.20687209820222208, 2.5892464657272916)): shape (37, 800, 800)
      Valid pixels: 64302/640000 (10.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2886, max=260890, num_faces=260892
      Valid probs shape: (37, 64302)
    ✓ Random_2 (pose=(-1.8456003361057596, 2.999731951228875, -0.5695739524497001)): shape (37, 800, 800)
      Valid pixels: 103476/640000 (16.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=6, max=260804, num_faces=260892
      Valid probs shape: (37, 103476)
    ✓ Random_3 (pose=(0.5251578936566235, 1.2189487123970437, -0.796711722524488)): shape (37, 800, 800)
      Valid pixels: 99256/640000 (15.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=260885, num_faces=260892
      Valid probs shape: (37, 99256)
    ✓ Random_4 (pose=(-1.7195523104917967, 0.03982492896130552, -1.974892172056341)): shape (37, 800, 800)
      Valid pixels: 71205/640000 (11.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=16, max=260885, num_faces=260892
      Valid probs shape: (37, 71205)
    ✓ Random_5 (pose=(-2.6489236321580565, -0.10030260928015089, -1.0583758656229385)): shape (37, 800, 800)
      Valid pixels: 61659/640000 (9.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=47067, max=260837, num_faces=260892
      Valid probs shape: (37, 61659)
    ✓ Random_6 (pose=(1.7281540496713435, -1.3646111539385055, 2.5775952647501637)): shape (37, 800, 800)
      Valid pixels: 106454/640000 (16.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=13, max=260804, num_faces=260892
      Valid probs shape: (37, 106454)
    ✓ Random_7 (pose=(-0.9124707952300009, 0.9508850992687945, 1.586492690074449)): shape (37, 800, 800)
      Valid pixels: 69823/640000 (10.9%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=7, max=260891, num_faces=260892
      Valid probs shape: (37, 69823)
    ✓ Random_8 (pose=(-2.1371520715133507, -2.7053375156910273, -2.626088305406736)): shape (37, 800, 800)
      Valid pixels: 91869/640000 (14.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=260885, num_faces=260892
      Valid probs shape: (37, 91869)
    ✓ Random_9 (pose=(-1.012490952908574, 0.09703185593874153, -2.8509682241171705)): shape (37, 800, 800)
      Valid pixels: 90851/640000 (14.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=260885, num_faces=260892
      Valid probs shape: (37, 90851)
    ✓ Random_10 (pose=(3.081493716104693, -0.16748572260218442, 0.5879947961985326)): shape (37, 800, 800)
      Valid pixels: 50932/640000 (8.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=79951, max=260831, num_faces=260892
      Valid probs shape: (37, 50932)
    ✓ Random_11 (pose=(0.1236044700643979, 0.37097670688441875, -2.375934418499244)): shape (37, 800, 800)
      Valid pixels: 53643/640000 (8.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=260858, num_faces=260892
      Valid probs shape: (37, 53643)
    ✓ Random_12 (pose=(1.9272270433135743, -0.4318790368237493, 0.3530385966277634)): shape (37, 800, 800)
      Valid pixels: 90111/640000 (14.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=89, max=260885, num_faces=260892
      Valid probs shape: (37, 90111)
    ✓ Random_13 (pose=(-0.42686128224994, 2.500693941245631, 0.48506106370826796)): shape (37, 800, 800)
      Valid pixels: 86815/640000 (13.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=13091, max=260805, num_faces=260892
      Valid probs shape: (37, 86815)
    ✓ Random_14 (pose=(-1.6073855733857927, -0.42196876277445083, -0.11380318442292348)): shape (37, 800, 800)
      Valid pixels: 104683/640000 (16.4%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=5, max=260804, num_faces=260892
      Valid probs shape: (37, 104683)
    ✓ Random_15 (pose=(3.0210992012768303, -1.858340387607957, -2.590036151768852)): shape (37, 800, 800)
      Valid pixels: 83304/640000 (13.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=260889, num_faces=260892
      Valid probs shape: (37, 83304)
    ✓ Random_16 (pose=(1.4015259269537115, 1.7550001775523931, -2.4678949451344496)): shape (37, 800, 800)
      Valid pixels: 79283/640000 (12.4%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=127, max=260883, num_faces=260892
      Valid probs shape: (37, 79283)
    ✓ Random_17 (pose=(-1.6300657647279144, 1.1546808041149967, 1.7679765487216557)): shape (37, 800, 800)
      Valid pixels: 80233/640000 (12.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=52, max=260891, num_faces=260892
      Valid probs shape: (37, 80233)
    ✓ Random_18 (pose=(2.138072828184163, 3.0631203082127163, -0.07783294291803244)): shape (37, 800, 800)
      Valid pixels: 95831/640000 (15.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=260885, num_faces=260892
      Valid probs shape: (37, 95831)
    ✓ Random_19 (pose=(0.9156205044130656, -3.014383306686492, -1.1060746318913504)): shape (37, 800, 800)
      Valid pixels: 77491/640000 (12.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=626, max=260891, num_faces=260892
      Valid probs shape: (37, 77491)
    ✓ Random_20 (pose=(-0.9826330745698573, 1.9509285248812933, -1.4591124963615474)): shape (37, 800, 800)
      Valid pixels: 71975/640000 (11.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=56, max=260885, num_faces=260892
      Valid probs shape: (37, 71975)
    ✓ Random_21 (pose=(-0.6339137789525284, -1.9396386874784104, -2.159182526511918)): shape (37, 800, 800)
      Valid pixels: 78551/640000 (12.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=252, max=260771, num_faces=260892
      Valid probs shape: (37, 78551)
    ✓ Random_22 (pose=(1.5559794424209024, 0.4739595246620336, 2.512846177539731)): shape (37, 800, 800)
      Valid pixels: 104769/640000 (16.4%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=5, max=260805, num_faces=260892
      Valid probs shape: (37, 104769)
    ✓ Random_23 (pose=(2.448450098463441, -2.8389574038036764, 0.08609726104053994)): shape (37, 800, 800)
      Valid pixels: 77427/640000 (12.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=260885, num_faces=260892
      Valid probs shape: (37, 77427)
    ✓ Random_24 (pose=(-0.07761373643508529, 2.056091999188067, -1.758433148087121)): shape (37, 800, 800)
      Valid pixels: 102281/640000 (16.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=381, max=260891, num_faces=260892
      Valid probs shape: (37, 102281)
    ✓ Random_25 (pose=(0.8162263168838173, 2.837779644274697, 2.5266485835498234)): shape (37, 800, 800)
      Valid pixels: 91208/640000 (14.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=4383, max=260805, num_faces=260892
      Valid probs shape: (37, 91208)
    ✓ Random_26 (pose=(0.5701578207530411, 0.7589179271580413, 1.4065649715968593)): shape (37, 800, 800)
      Valid pixels: 86047/640000 (13.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=260800, num_faces=260892
      Valid probs shape: (37, 86047)
    ✓ Random_27 (pose=(2.7852622236388997, 2.961051090374358, -1.8559616644529902)): shape (37, 800, 800)
      Valid pixels: 57441/640000 (9.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=0, max=259796, num_faces=260892
      Valid probs shape: (37, 57441)
    ✓ Random_28 (pose=(-1.6052556208028934, 2.7818779184968507, 1.0616026205675206)): shape (37, 800, 800)
      Valid pixels: 74288/640000 (11.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=127, max=260891, num_faces=260892
      Valid probs shape: (37, 74288)
    ✓ Random_29 (pose=(2.6324126195941364, 1.1353566129663832, -0.8871639431450524)): shape (37, 800, 800)
      Valid pixels: 73497/640000 (11.5%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=143, max=260891, num_faces=260892
      Valid probs shape: (37, 73497)
    P stats: min=0.0000, max=1.0000, mean=0.0255
    Non-zero vertices: 123058/130448
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 7390 1079  957 2876    0 1848  986 4570 6335]
  Ground Truth Stats:
    Labels shape: (130448,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-10/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7779
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8310
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8313

  RESULTS:
  RAW:         median(top-10)=0.9072, mean(top-10)=0.9121, median(all)=0.8420, mean(all)=0.7779
  + SMOOTHING: median(top-10)=0.9275, mean(top-10)=0.9332, median(all)=0.8720, mean(all)=0.8310 [+0.0203]
  + MRF:       median(top-10)=0.9278, mean(top-10)=0.9335, median(all)=0.8725, mean(all)=0.8313 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0206

================================================================================
Subject: NKI-RS-22-11
================================================================================
  Step 0: Generating predictions with V2 model (30 random views)...
  Mesh: 138161 vertices, 276318 faces
  Generating 30 random views...
  Generating predictions for 30 views (continuous camera pose)...
    ✓ Random_0 (pose=(2.3569413444591474, 0.5701742164322492, 0.6044241084058766)): shape (37, 800, 800)
      Valid pixels: 81135/640000 (12.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=117, max=276235, num_faces=276318
      Valid probs shape: (37, 81135)
    ✓ Random_1 (pose=(-1.9893120199619758, -2.2718308797059423, 0.28182381359340836)): shape (37, 800, 800)
      Valid pixels: 89796/640000 (14.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=6, max=276257, num_faces=276318
      Valid probs shape: (37, 89796)
    ✓ Random_2 (pose=(2.527846549744803, 0.5864038052962166, 1.0411908796408271)): shape (37, 800, 800)
      Valid pixels: 71956/640000 (11.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=383, max=276242, num_faces=276318
      Valid probs shape: (37, 71956)
    ✓ Random_3 (pose=(-0.7158675943464634, 2.811767034556018, -2.474351130262618)): shape (37, 800, 800)
      Valid pixels: 70812/640000 (11.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=118, max=276235, num_faces=276318
      Valid probs shape: (37, 70812)
    ✓ Random_4 (pose=(0.14896730646434175, 0.7959181882861235, -2.4113921331166255)): shape (37, 800, 800)
      Valid pixels: 65238/640000 (10.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=276317, num_faces=276318
      Valid probs shape: (37, 65238)
    ✓ Random_5 (pose=(2.6976688516375322, 1.2932864926599112, -1.6541378436488963)): shape (37, 800, 800)
      Valid pixels: 84465/640000 (13.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=363, max=276313, num_faces=276318
      Valid probs shape: (37, 84465)
    ✓ Random_6 (pose=(-0.24427987656198047, -2.2917923417181543, -0.7468880286135722)): shape (37, 800, 800)
      Valid pixels: 76412/640000 (11.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5679, max=276313, num_faces=276318
      Valid probs shape: (37, 76412)
    ✓ Random_7 (pose=(-0.7073079225977454, 3.1002630059340293, 0.6776651549708057)): shape (37, 800, 800)
      Valid pixels: 69879/640000 (10.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7894, max=276313, num_faces=276318
      Valid probs shape: (37, 69879)
    ✓ Random_8 (pose=(1.1453313316419012, -2.006828310839127, -1.9520595529869431)): shape (37, 800, 800)
      Valid pixels: 75236/640000 (11.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=407, max=276314, num_faces=276318
      Valid probs shape: (37, 75236)
    ✓ Random_9 (pose=(1.743370530730119, -2.8963402831580463, -2.5272849658017043)): shape (37, 800, 800)
      Valid pixels: 76639/640000 (12.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=276313, num_faces=276318
      Valid probs shape: (37, 76639)
    ✓ Random_10 (pose=(-2.313785707433307, -2.879280679807958, -1.181013344671773)): shape (37, 800, 800)
      Valid pixels: 56531/640000 (8.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=273260, num_faces=276318
      Valid probs shape: (37, 56531)
    ✓ Random_11 (pose=(0.9727862954022894, -0.35196603195832976, 0.9461712075862998)): shape (37, 800, 800)
      Valid pixels: 73027/640000 (11.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=276235, num_faces=276318
      Valid probs shape: (37, 73027)
    ✓ Random_12 (pose=(-1.397716184974846, 2.505463854296603, -3.0001811298068106)): shape (37, 800, 800)
      Valid pixels: 98586/640000 (15.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=81, max=276283, num_faces=276318
      Valid probs shape: (37, 98586)
    ✓ Random_13 (pose=(-1.8389243395702464, -0.09591383705344603, -1.3991054377993128)): shape (37, 800, 800)
      Valid pixels: 62869/640000 (9.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=146, max=273260, num_faces=276318
      Valid probs shape: (37, 62869)
    ✓ Random_14 (pose=(0.5658389705076949, -3.011817492355559, -0.48600853899368834)): shape (37, 800, 800)
      Valid pixels: 61555/640000 (9.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=497, max=276313, num_faces=276318
      Valid probs shape: (37, 61555)
    ✓ Random_15 (pose=(0.8897784555543309, 0.8176632289224304, 2.260224113431189)): shape (37, 800, 800)
      Valid pixels: 89268/640000 (13.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=276184, num_faces=276318
      Valid probs shape: (37, 89268)
    ✓ Random_16 (pose=(-2.09450901479266, -1.7018873925233178, -1.2279893537121838)): shape (37, 800, 800)
      Valid pixels: 61740/640000 (9.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=17, max=276235, num_faces=276318
      Valid probs shape: (37, 61740)
    ✓ Random_17 (pose=(-1.9957113866820235, 1.4133777412275128, -1.0431313608508388)): shape (37, 800, 800)
      Valid pixels: 95673/640000 (14.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=65, max=276314, num_faces=276318
      Valid probs shape: (37, 95673)
    ✓ Random_18 (pose=(2.1766335526071963, -2.5120689409293373, 2.699752016057616)): shape (37, 800, 800)
      Valid pixels: 84914/640000 (13.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=276184, num_faces=276318
      Valid probs shape: (37, 84914)
    ✓ Random_19 (pose=(-1.656317128615923, -2.0284965084747606, -1.119154626199863)): shape (37, 800, 800)
      Valid pixels: 75553/640000 (11.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=17, max=276145, num_faces=276318
      Valid probs shape: (37, 75553)
    ✓ Random_20 (pose=(1.1501770334332955, 2.2736097716228967, -0.013947334222748076)): shape (37, 800, 800)
      Valid pixels: 89684/640000 (14.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=81, max=276242, num_faces=276318
      Valid probs shape: (37, 89684)
    ✓ Random_21 (pose=(-3.1193003989927663, 0.23028278720358308, -2.232247264822944)): shape (37, 800, 800)
      Valid pixels: 53676/640000 (8.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=68527, max=276313, num_faces=276318
      Valid probs shape: (37, 53676)
    ✓ Random_22 (pose=(2.689825008342619, -0.7600254343414434, 0.48899272560327)): shape (37, 800, 800)
      Valid pixels: 54972/640000 (8.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=339, max=276236, num_faces=276318
      Valid probs shape: (37, 54972)
    ✓ Random_23 (pose=(1.9241592736725526, 1.5564826521653181, -0.9626596075139897)): shape (37, 800, 800)
      Valid pixels: 71597/640000 (11.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=16, max=276317, num_faces=276318
      Valid probs shape: (37, 71597)
    ✓ Random_24 (pose=(-3.1362786104780915, -2.3798543227086393, -1.687209951172479)): shape (37, 800, 800)
      Valid pixels: 77308/640000 (12.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=276250, num_faces=276318
      Valid probs shape: (37, 77308)
    ✓ Random_25 (pose=(-1.0861638411137458, -1.6115294332473007, 1.9291555158108205)): shape (37, 800, 800)
      Valid pixels: 95742/640000 (15.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=32, max=276313, num_faces=276318
      Valid probs shape: (37, 95742)
    ✓ Random_26 (pose=(-5.35466969533438e-05, -1.763787453655224, -1.693396807918212)): shape (37, 800, 800)
      Valid pixels: 95374/640000 (14.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=293, max=276313, num_faces=276318
      Valid probs shape: (37, 95374)
    ✓ Random_27 (pose=(-0.9736744638605153, 0.9981287316102403, 2.4864952600219885)): shape (37, 800, 800)
      Valid pixels: 74381/640000 (11.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6, max=276316, num_faces=276318
      Valid probs shape: (37, 74381)
    ✓ Random_28 (pose=(-2.9985815957079556, 1.1839439976715287, -1.4740049736525969)): shape (37, 800, 800)
      Valid pixels: 92409/640000 (14.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=490, max=276313, num_faces=276318
      Valid probs shape: (37, 92409)
    ✓ Random_29 (pose=(-0.5892178155015362, 2.704412315492088, 1.8642020664346903)): shape (37, 800, 800)
      Valid pixels: 58004/640000 (9.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1630, max=276313, num_faces=276318
      Valid probs shape: (37, 58004)
    P stats: min=0.0000, max=0.9999, mean=0.0256
    Non-zero vertices: 130660/138161
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 7501 1539 1325 3570    0 2441 1181 4210 5630]
  Ground Truth Stats:
    Labels shape: (138161,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-11/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7912
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8447
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8451

  RESULTS:
  RAW:         median(top-10)=0.9273, mean(top-10)=0.9239, median(all)=0.8499, mean(all)=0.7912
  + SMOOTHING: median(top-10)=0.9384, mean(top-10)=0.9397, median(all)=0.8793, mean(all)=0.8447 [+0.0112]
  + MRF:       median(top-10)=0.9384, mean(top-10)=0.9398, median(all)=0.8797, mean(all)=0.8451 [-0.0000]
  TOTAL IMPROVEMENT (median top-10): +0.0111

================================================================================
Subject: NKI-RS-22-12
================================================================================
  Step 0: Generating predictions with V2 model (30 random views)...
  Mesh: 144832 vertices, 289660 faces
  Generating 30 random views...
  Generating predictions for 30 views (continuous camera pose)...
    ✓ Random_0 (pose=(-2.484091598135254, -1.0393144309485614, -2.8622880048007704)): shape (37, 800, 800)
      Valid pixels: 90551/640000 (14.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=97, max=289657, num_faces=289660
      Valid probs shape: (37, 90551)
    ✓ Random_1 (pose=(0.17079597820667436, -0.5304230507591616, 2.4565735983344545)): shape (37, 800, 800)
      Valid pixels: 50411/640000 (7.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=289438, num_faces=289660
      Valid probs shape: (37, 50411)
    ✓ Random_2 (pose=(-2.958360998324913, -1.8542696043432125, 1.603580313592282)): shape (37, 800, 800)
      Valid pixels: 76181/640000 (11.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=7, max=289561, num_faces=289660
      Valid probs shape: (37, 76181)
    ✓ Random_3 (pose=(-0.5890889006146804, -2.4095022285598406, 1.4904086192556685)): shape (37, 800, 800)
      Valid pixels: 77948/640000 (12.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=988, max=289658, num_faces=289660
      Valid probs shape: (37, 77948)
    ✓ Random_4 (pose=(1.3625912337547925, 1.1861657474461227, -0.321408237447558)): shape (37, 800, 800)
      Valid pixels: 94735/640000 (14.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=8, max=289646, num_faces=289660
      Valid probs shape: (37, 94735)
    ✓ Random_5 (pose=(1.2370227830216152, -2.7109902950483535, -1.2637328917531285)): shape (37, 800, 800)
      Valid pixels: 70121/640000 (11.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=85, max=289658, num_faces=289660
      Valid probs shape: (37, 70121)
    ✓ Random_6 (pose=(0.5215074797095829, 2.5535661978198654, -1.5921041613564302)): shape (37, 800, 800)
      Valid pixels: 71349/640000 (11.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1880, max=289648, num_faces=289660
      Valid probs shape: (37, 71349)
    ✓ Random_7 (pose=(1.306323237202732, 1.4831080189212162, 1.612885329179048)): shape (37, 800, 800)
      Valid pixels: 77555/640000 (12.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=289654, num_faces=289660
      Valid probs shape: (37, 77555)
    ✓ Random_8 (pose=(-2.076438587443291, -0.827434198397675, -0.6716461582975732)): shape (37, 800, 800)
      Valid pixels: 81822/640000 (12.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=436, max=289650, num_faces=289660
      Valid probs shape: (37, 81822)
    ✓ Random_9 (pose=(1.9709855974053534, -2.1110467503537125, -2.6599911526103086)): shape (37, 800, 800)
      Valid pixels: 66765/640000 (10.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8, max=289658, num_faces=289660
      Valid probs shape: (37, 66765)
    ✓ Random_10 (pose=(-0.1656794305672178, 0.8143395380748668, -2.3482849404678827)): shape (37, 800, 800)
      Valid pixels: 75339/640000 (11.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=289646, num_faces=289660
      Valid probs shape: (37, 75339)
    ✓ Random_11 (pose=(-0.27366322697057255, 1.0223672968590582, -1.9963944783693002)): shape (37, 800, 800)
      Valid pixels: 83652/640000 (13.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=289646, num_faces=289660
      Valid probs shape: (37, 83652)
    ✓ Random_12 (pose=(-0.7923979817459221, -2.8411227527206315, 1.7151980030789513)): shape (37, 800, 800)
      Valid pixels: 68938/640000 (10.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1947, max=289658, num_faces=289660
      Valid probs shape: (37, 68938)
    ✓ Random_13 (pose=(1.8171287416256163, 0.7308221507019792, -0.9176393054253769)): shape (37, 800, 800)
      Valid pixels: 85637/640000 (13.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=62, max=289646, num_faces=289660
      Valid probs shape: (37, 85637)
    ✓ Random_14 (pose=(0.9582860475093273, -0.3105009400286809, 1.8108753266489774)): shape (37, 800, 800)
      Valid pixels: 60012/640000 (9.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=289659, num_faces=289660
      Valid probs shape: (37, 60012)
    ✓ Random_15 (pose=(-3.141519556931479, 3.049938628221735, 1.2286508203148179)): shape (37, 800, 800)
      Valid pixels: 41743/640000 (6.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=288204, num_faces=289660
      Valid probs shape: (37, 41743)
    ✓ Random_16 (pose=(0.783889445784208, -1.6733670627330115, -0.9199571215904547)): shape (37, 800, 800)
      Valid pixels: 65223/640000 (10.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=46, max=289658, num_faces=289660
      Valid probs shape: (37, 65223)
    ✓ Random_17 (pose=(0.8287466153817662, 0.9533954708255115, -2.7829402026895926)): shape (37, 800, 800)
      Valid pixels: 62237/640000 (9.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=289658, num_faces=289660
      Valid probs shape: (37, 62237)
    ✓ Random_18 (pose=(2.0985341616974074, -1.6538981433452014, -1.9448666488425677)): shape (37, 800, 800)
      Valid pixels: 70189/640000 (11.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=33, max=289546, num_faces=289660
      Valid probs shape: (37, 70189)
    ✓ Random_19 (pose=(-0.6449638796387207, 1.8554421616258203, -1.3603745082164007)): shape (37, 800, 800)
      Valid pixels: 67661/640000 (10.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=289648, num_faces=289660
      Valid probs shape: (37, 67661)
    ✓ Random_20 (pose=(-0.2861100746819001, -0.9542219424458485, 0.6342561828300153)): shape (37, 800, 800)
      Valid pixels: 64346/640000 (10.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=289646, num_faces=289660
      Valid probs shape: (37, 64346)
    ✓ Random_21 (pose=(-0.7665431666101057, -3.1114131276172796, 0.7900586498175906)): shape (37, 800, 800)
      Valid pixels: 61944/640000 (9.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3130, max=289657, num_faces=289660
      Valid probs shape: (37, 61944)
    ✓ Random_22 (pose=(1.6019788505597656, -1.8716984143115059, -0.14288731357744577)): shape (37, 800, 800)
      Valid pixels: 94966/640000 (14.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=19, max=289648, num_faces=289660
      Valid probs shape: (37, 94966)
    ✓ Random_23 (pose=(-3.035087114483711, 0.2675419220151172, 0.9803322794833571)): shape (37, 800, 800)
      Valid pixels: 44912/640000 (7.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4823, max=289656, num_faces=289660
      Valid probs shape: (37, 44912)
    ✓ Random_24 (pose=(-1.1385134582212242, 2.8665591082001445, 0.7581990318207037)): shape (37, 800, 800)
      Valid pixels: 69174/640000 (10.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=253, max=289657, num_faces=289660
      Valid probs shape: (37, 69174)
    ✓ Random_25 (pose=(-0.034946465792446535, -1.1474044131957597, 0.7623567403715446)): shape (37, 800, 800)
      Valid pixels: 84852/640000 (13.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=289646, num_faces=289660
      Valid probs shape: (37, 84852)
    ✓ Random_26 (pose=(1.489948194566046, 1.1577608335788518, 3.0933884110822953)): shape (37, 800, 800)
      Valid pixels: 84063/640000 (13.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=15, max=289550, num_faces=289660
      Valid probs shape: (37, 84063)
    ✓ Random_27 (pose=(0.3092413195453281, 2.343200495872799, 2.9330902608646854)): shape (37, 800, 800)
      Valid pixels: 61737/640000 (9.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1770, max=289657, num_faces=289660
      Valid probs shape: (37, 61737)
    ✓ Random_28 (pose=(1.6313082590214396, -2.3279314732649303, -3.1123325380231566)): shape (37, 800, 800)
      Valid pixels: 83073/640000 (13.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=10, max=289562, num_faces=289660
      Valid probs shape: (37, 83073)
    ✓ Random_29 (pose=(0.4772859686042983, -2.904615469612426, 0.1861562123490348)): shape (37, 800, 800)
      Valid pixels: 58618/640000 (9.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=342, max=289652, num_faces=289660
      Valid probs shape: (37, 58618)
    P stats: min=0.0000, max=0.9999, mean=0.0249
    Non-zero vertices: 133648/144832
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 11184  1032  1268  2665     0  2758  1131  4489  5816]
  Ground Truth Stats:
    Labels shape: (144832,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-12/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7666
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8245
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8250

  RESULTS:
  RAW:         median(top-10)=0.8954, mean(top-10)=0.8975, median(all)=0.8333, mean(all)=0.7666
  + SMOOTHING: median(top-10)=0.9306, mean(top-10)=0.9320, median(all)=0.8755, mean(all)=0.8245 [+0.0352]
  + MRF:       median(top-10)=0.9305, mean(top-10)=0.9320, median(all)=0.8768, mean(all)=0.8250 [-0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0351

================================================================================
Subject: NKI-RS-22-13
================================================================================
  Step 0: Generating predictions with V2 model (30 random views)...
  Mesh: 121451 vertices, 242898 faces
  Generating 30 random views...
  Generating predictions for 30 views (continuous camera pose)...
    ✓ Random_0 (pose=(2.4617040806945765, -3.1208060239537136, 1.4827677179949719)): shape (37, 800, 800)
      Valid pixels: 47412/640000 (7.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=241469, num_faces=242898
      Valid probs shape: (37, 47412)
    ✓ Random_1 (pose=(-1.0267779114738596, -0.7671610772400639, -2.642501022632635)): shape (37, 800, 800)
      Valid pixels: 64748/640000 (10.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=15, max=242200, num_faces=242898
      Valid probs shape: (37, 64748)
    ✓ Random_2 (pose=(0.54407441558567, 2.080320545172973, 0.3005129969587874)): shape (37, 800, 800)
      Valid pixels: 56143/640000 (8.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=130, max=242200, num_faces=242898
      Valid probs shape: (37, 56143)
    ✓ Random_3 (pose=(2.5424042420413917, 0.5877321227819894, -0.016065963891454427)): shape (37, 800, 800)
      Valid pixels: 72239/640000 (11.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=506, max=242887, num_faces=242898
      Valid probs shape: (37, 72239)
    ✓ Random_4 (pose=(-0.7444531214181991, -2.720752547601056, 1.8118246358751362)): shape (37, 800, 800)
      Valid pixels: 67970/640000 (10.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=777, max=242887, num_faces=242898
      Valid probs shape: (37, 67970)
    ✓ Random_5 (pose=(-0.5507725590366954, 2.9008369624781514, 0.36406932854310803)): shape (37, 800, 800)
      Valid pixels: 64715/640000 (10.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3149, max=242897, num_faces=242898
      Valid probs shape: (37, 64715)
    ✓ Random_6 (pose=(2.48002620970069, 2.345512521800406, 2.9150229479941956)): shape (37, 800, 800)
      Valid pixels: 71497/640000 (11.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=241820, num_faces=242898
      Valid probs shape: (37, 71497)
    ✓ Random_7 (pose=(-0.8258253927252333, -0.6752199761648625, -1.140079620332214)): shape (37, 800, 800)
      Valid pixels: 79928/640000 (12.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=242435, num_faces=242898
      Valid probs shape: (37, 79928)
    ✓ Random_8 (pose=(2.2673418414739803, -0.39038478489218864, -2.877520528250238)): shape (37, 800, 800)
      Valid pixels: 68082/640000 (10.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2124, max=242897, num_faces=242898
      Valid probs shape: (37, 68082)
    ✓ Random_9 (pose=(2.2265020672608253, -2.981764692981976, -3.046839887808338)): shape (37, 800, 800)
      Valid pixels: 69440/640000 (10.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=242895, num_faces=242898
      Valid probs shape: (37, 69440)
    ✓ Random_10 (pose=(2.857260996634613, 2.924764983696999, 2.423041025285281)): shape (37, 800, 800)
      Valid pixels: 43603/640000 (6.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=241466, num_faces=242898
      Valid probs shape: (37, 43603)
    ✓ Random_11 (pose=(0.728669385350976, -2.6478631198508094, 2.1919375217113304)): shape (37, 800, 800)
      Valid pixels: 53193/640000 (8.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=18375, max=241824, num_faces=242898
      Valid probs shape: (37, 53193)
    ✓ Random_12 (pose=(-2.224724355851091, 3.0898762908430184, -0.7051329058011184)): shape (37, 800, 800)
      Valid pixels: 75055/640000 (11.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=241821, num_faces=242898
      Valid probs shape: (37, 75055)
    ✓ Random_13 (pose=(-0.5223719217260339, -2.6520210721943935, 2.374616699163596)): shape (37, 800, 800)
      Valid pixels: 66351/640000 (10.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=508, max=242887, num_faces=242898
      Valid probs shape: (37, 66351)
    ✓ Random_14 (pose=(-2.0489813172473843, 2.942009675459788, 3.024442066831477)): shape (37, 800, 800)
      Valid pixels: 82888/640000 (13.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=33, max=242714, num_faces=242898
      Valid probs shape: (37, 82888)
    ✓ Random_15 (pose=(-1.1478223862818766, -1.7246144015307603, 1.8580775478454887)): shape (37, 800, 800)
      Valid pixels: 85645/640000 (13.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=47, max=242887, num_faces=242898
      Valid probs shape: (37, 85645)
    ✓ Random_16 (pose=(-0.563282716729991, 2.458826916729019, -0.20797023169397022)): shape (37, 800, 800)
      Valid pixels: 68544/640000 (10.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5284, max=242320, num_faces=242898
      Valid probs shape: (37, 68544)
    ✓ Random_17 (pose=(2.633564780791313, -1.5805418085311422, -0.5035616818290594)): shape (37, 800, 800)
      Valid pixels: 76842/640000 (12.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=242563, num_faces=242898
      Valid probs shape: (37, 76842)
    ✓ Random_18 (pose=(-2.673045029076989, 0.8740130606984096, 2.121094135062582)): shape (37, 800, 800)
      Valid pixels: 78668/640000 (12.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=312, max=242887, num_faces=242898
      Valid probs shape: (37, 78668)
    ✓ Random_19 (pose=(-1.653648130391272, -2.4195128812119533, -1.5388484131190332)): shape (37, 800, 800)
      Valid pixels: 54670/640000 (8.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=35, max=241701, num_faces=242898
      Valid probs shape: (37, 54670)
    ✓ Random_20 (pose=(0.9657443823052061, 1.5980554639289037, 0.674791261059787)): shape (37, 800, 800)
      Valid pixels: 58233/640000 (9.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=45, max=242200, num_faces=242898
      Valid probs shape: (37, 58233)
    ✓ Random_21 (pose=(3.066811119326532, -0.5281199116925119, -0.7009530110452911)): shape (37, 800, 800)
      Valid pixels: 48722/640000 (7.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=687, max=242887, num_faces=242898
      Valid probs shape: (37, 48722)
    ✓ Random_22 (pose=(-1.2001650130533243, -0.23882520136509822, -1.5961045257721393)): shape (37, 800, 800)
      Valid pixels: 55516/640000 (8.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=241467, num_faces=242898
      Valid probs shape: (37, 55516)
    ✓ Random_23 (pose=(2.9418179763805457, 2.7322316949804577, -2.3421752371319124)): shape (37, 800, 800)
      Valid pixels: 54700/640000 (8.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=241625, num_faces=242898
      Valid probs shape: (37, 54700)
    ✓ Random_24 (pose=(-1.518167760751178, -2.6700948019213233, -1.8926013468122838)): shape (37, 800, 800)
      Valid pixels: 58633/640000 (9.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=20, max=242199, num_faces=242898
      Valid probs shape: (37, 58633)
    ✓ Random_25 (pose=(0.3785107723392578, -1.5010228175455047, 0.30237928656771107)): shape (37, 800, 800)
      Valid pixels: 84313/640000 (13.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=242887, num_faces=242898
      Valid probs shape: (37, 84313)
    ✓ Random_26 (pose=(-0.8389220377364763, 1.7841109236702017, 2.884948888305865)): shape (37, 800, 800)
      Valid pixels: 82166/640000 (12.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=41, max=242887, num_faces=242898
      Valid probs shape: (37, 82166)
    ✓ Random_27 (pose=(1.584330910495856, 2.3176990430684032, -1.4535249881890464)): shape (37, 800, 800)
      Valid pixels: 60909/640000 (9.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=32, max=242891, num_faces=242898
      Valid probs shape: (37, 60909)
    ✓ Random_28 (pose=(-0.04843220265501991, 2.713231041136705, 2.1777572162348484)): shape (37, 800, 800)
      Valid pixels: 50980/640000 (8.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1273, max=242897, num_faces=242898
      Valid probs shape: (37, 50980)
    ✓ Random_29 (pose=(-1.497221515579944, 3.011097330077982, 0.9169426341177207)): shape (37, 800, 800)
      Valid pixels: 66853/640000 (10.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=30, max=242897, num_faces=242898
      Valid probs shape: (37, 66853)
    P stats: min=0.0000, max=0.9999, mean=0.0254
    Non-zero vertices: 114308/121451
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 7143  929  944 2605    0 2301  809 4130 5213]
  Ground Truth Stats:
    Labels shape: (121451,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-13/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7648
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8225
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8232

  RESULTS:
  RAW:         median(top-10)=0.8922, mean(top-10)=0.9018, median(all)=0.8390, mean(all)=0.7648
  + SMOOTHING: median(top-10)=0.9194, mean(top-10)=0.9240, median(all)=0.8819, mean(all)=0.8225 [+0.0272]
  + MRF:       median(top-10)=0.9196, mean(top-10)=0.9242, median(all)=0.8823, mean(all)=0.8232 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0274

================================================================================
Subject: NKI-RS-22-14
================================================================================
  Step 0: Generating predictions with V2 model (30 random views)...
  Mesh: 142823 vertices, 285642 faces
  Generating 30 random views...
  Generating predictions for 30 views (continuous camera pose)...
    ✓ Random_0 (pose=(2.573620623651599, -2.6133219512060735, 1.2779063692058736)): shape (37, 800, 800)
      Valid pixels: 54904/640000 (8.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=284208, num_faces=285642
      Valid probs shape: (37, 54904)
    ✓ Random_1 (pose=(1.4462815645361937, 0.48398485528218727, 1.0921572927299374)): shape (37, 800, 800)
      Valid pixels: 63087/640000 (9.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=285637, num_faces=285642
      Valid probs shape: (37, 63087)
    ✓ Random_2 (pose=(0.8924844030121468, 0.34996983485282707, -2.919507475032232)): shape (37, 800, 800)
      Valid pixels: 63239/640000 (9.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=11, max=285641, num_faces=285642
      Valid probs shape: (37, 63239)
    ✓ Random_3 (pose=(2.941249732214774, 2.2905977988092623, -1.1195330029376551)): shape (37, 800, 800)
      Valid pixels: 59655/640000 (9.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=285641, num_faces=285642
      Valid probs shape: (37, 59655)
    ✓ Random_4 (pose=(-0.9062112735998222, -0.5355806842036297, 0.823609901197464)): shape (37, 800, 800)
      Valid pixels: 59957/640000 (9.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=285641, num_faces=285642
      Valid probs shape: (37, 59957)
    ✓ Random_5 (pose=(-3.071110691244968, 1.8854156624576568, 0.4748467928499598)): shape (37, 800, 800)
      Valid pixels: 70218/640000 (11.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=285641, num_faces=285642
      Valid probs shape: (37, 70218)
    ✓ Random_6 (pose=(0.9581846621690184, 1.9472827747537638, 1.3501502753414565)): shape (37, 800, 800)
      Valid pixels: 70176/640000 (11.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7, max=285117, num_faces=285642
      Valid probs shape: (37, 70176)
    ✓ Random_7 (pose=(0.7024279946273846, -2.843425931239989, 1.2907130066386125)): shape (37, 800, 800)
      Valid pixels: 57141/640000 (8.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=458, max=285638, num_faces=285642
      Valid probs shape: (37, 57141)
    ✓ Random_8 (pose=(1.0910099222906577, 0.6457585144544011, -0.8662705697603545)): shape (37, 800, 800)
      Valid pixels: 84626/640000 (13.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=285641, num_faces=285642
      Valid probs shape: (37, 84626)
    ✓ Random_9 (pose=(-1.8165516530548014, -2.389983379173622, 0.6849777570158868)): shape (37, 800, 800)
      Valid pixels: 70423/640000 (11.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=285641, num_faces=285642
      Valid probs shape: (37, 70423)
    ✓ Random_10 (pose=(-2.5649471536919206, 0.45652418942870776, 1.1232832237881638)): shape (37, 800, 800)
      Valid pixels: 45882/640000 (7.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1224, max=285639, num_faces=285642
      Valid probs shape: (37, 45882)
    ✓ Random_11 (pose=(-0.017599491021508484, -1.2255222441069797, -1.364806705792732)): shape (37, 800, 800)
      Valid pixels: 74319/640000 (11.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=285641, num_faces=285642
      Valid probs shape: (37, 74319)
    ✓ Random_12 (pose=(-2.8535779875804486, 0.6237247475153214, 0.7508867411923492)): shape (37, 800, 800)
      Valid pixels: 47674/640000 (7.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1914, max=285639, num_faces=285642
      Valid probs shape: (37, 47674)
    ✓ Random_13 (pose=(1.3636083588155063, 0.9755507956909186, 2.9929786112765537)): shape (37, 800, 800)
      Valid pixels: 81275/640000 (12.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=15, max=285641, num_faces=285642
      Valid probs shape: (37, 81275)
    ✓ Random_14 (pose=(1.8905770205766288, 2.901056583203621, -3.04590806140879)): shape (37, 800, 800)
      Valid pixels: 78731/640000 (12.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=11, max=285584, num_faces=285642
      Valid probs shape: (37, 78731)
    ✓ Random_15 (pose=(1.3983459690428015, 3.0489432081112815, -0.7413122987155498)): shape (37, 800, 800)
      Valid pixels: 86539/640000 (13.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=285641, num_faces=285642
      Valid probs shape: (37, 86539)
    ✓ Random_16 (pose=(2.7312030073964557, -0.6775573979867127, -2.1535931043262617)): shape (37, 800, 800)
      Valid pixels: 54063/640000 (8.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1238, max=285641, num_faces=285642
      Valid probs shape: (37, 54063)
    ✓ Random_17 (pose=(-1.5394390694911524, -1.14469707160467, -1.0267832734794462)): shape (37, 800, 800)
      Valid pixels: 78929/640000 (12.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=285122, num_faces=285642
      Valid probs shape: (37, 78929)
    ✓ Random_18 (pose=(-1.0609838072367244, 1.1101569579564252, -1.1400277381542514)): shape (37, 800, 800)
      Valid pixels: 56003/640000 (8.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7, max=285634, num_faces=285642
      Valid probs shape: (37, 56003)
    ✓ Random_19 (pose=(3.0833782955856384, -0.9362043020921882, 1.25637977733268)): shape (37, 800, 800)
      Valid pixels: 78742/640000 (12.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=547, max=285593, num_faces=285642
      Valid probs shape: (37, 78742)
    ✓ Random_20 (pose=(-0.8369207296968639, 3.0325867861107785, 0.34860544984043074)): shape (37, 800, 800)
      Valid pixels: 69899/640000 (10.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=554, max=285641, num_faces=285642
      Valid probs shape: (37, 69899)
    ✓ Random_21 (pose=(-0.033776540189570436, 0.9044775380739027, 0.9899326756748223)): shape (37, 800, 800)
      Valid pixels: 72295/640000 (11.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=285569, num_faces=285642
      Valid probs shape: (37, 72295)
    ✓ Random_22 (pose=(-1.3879146565140377, 0.9626275945269169, -2.2186720119834136)): shape (37, 800, 800)
      Valid pixels: 69493/640000 (10.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7, max=285638, num_faces=285642
      Valid probs shape: (37, 69493)
    ✓ Random_23 (pose=(1.2826734525641479, -0.36334955464093177, 2.286998897055021)): shape (37, 800, 800)
      Valid pixels: 77383/640000 (12.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=285122, num_faces=285642
      Valid probs shape: (37, 77383)
    ✓ Random_24 (pose=(1.5128952532862643, -2.8412596957123064, 2.1845905546898736)): shape (37, 800, 800)
      Valid pixels: 80097/640000 (12.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=285195, num_faces=285642
      Valid probs shape: (37, 80097)
    ✓ Random_25 (pose=(-0.8256188106872795, 1.4803872789156625, 0.2099514702700902)): shape (37, 800, 800)
      Valid pixels: 87818/640000 (13.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=285581, num_faces=285642
      Valid probs shape: (37, 87818)
    ✓ Random_26 (pose=(1.7839760382906507, 2.6266428306272873, -2.4262312723747854)): shape (37, 800, 800)
      Valid pixels: 69356/640000 (10.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=24, max=285641, num_faces=285642
      Valid probs shape: (37, 69356)
    ✓ Random_27 (pose=(2.9958294110587307, -0.42657832336989276, -2.5534209495591647)): shape (37, 800, 800)
      Valid pixels: 38174/640000 (6.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1959, max=285634, num_faces=285642
      Valid probs shape: (37, 38174)
    ✓ Random_28 (pose=(-0.3461576106318929, 2.6366479824018683, 0.0037702397430585677)): shape (37, 800, 800)
      Valid pixels: 61746/640000 (9.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=20393, max=285593, num_faces=285642
      Valid probs shape: (37, 61746)
    ✓ Random_29 (pose=(-0.07251063344485598, -2.2433674131903363, -0.059351264478081145)): shape (37, 800, 800)
      Valid pixels: 53058/640000 (8.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1291, max=285641, num_faces=285642
      Valid probs shape: (37, 53058)
    P stats: min=0.0000, max=0.9999, mean=0.0251
    Non-zero vertices: 132747/142823
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 10076  1485  1038  2842     0  2233   977  4853  6626]
  Ground Truth Stats:
    Labels shape: (142823,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-14/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7559
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7999
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8000

  RESULTS:
  RAW:         median(top-10)=0.9252, mean(top-10)=0.9193, median(all)=0.8404, mean(all)=0.7559
  + SMOOTHING: median(top-10)=0.9301, mean(top-10)=0.9312, median(all)=0.8596, mean(all)=0.7999 [+0.0049]
  + MRF:       median(top-10)=0.9302, mean(top-10)=0.9314, median(all)=0.8599, mean(all)=0.8000 [+0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0050

================================================================================
Subject: NKI-RS-22-15
================================================================================
  Step 0: Generating predictions with V2 model (30 random views)...
  Mesh: 158740 vertices, 317476 faces
  Generating 30 random views...
  Generating predictions for 30 views (continuous camera pose)...
    ✓ Random_0 (pose=(0.88367648615049, -0.9970630860240015, -2.7053999070035237)): shape (37, 800, 800)
      Valid pixels: 100074/640000 (15.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=10, max=316451, num_faces=317476
      Valid probs shape: (37, 100074)
    ✓ Random_1 (pose=(-3.0008428426117306, -0.08817590663500496, 1.5633571206526078)): shape (37, 800, 800)
      Valid pixels: 55192/640000 (8.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3696, max=317475, num_faces=317476
      Valid probs shape: (37, 55192)
    ✓ Random_2 (pose=(1.3231275644277325, 2.2913183797234282, 0.84741484695228)): shape (37, 800, 800)
      Valid pixels: 74649/640000 (11.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=239, max=317470, num_faces=317476
      Valid probs shape: (37, 74649)
    ✓ Random_3 (pose=(-0.6805762509827558, 3.047773520773335, 0.2922326771201864)): shape (37, 800, 800)
      Valid pixels: 81282/640000 (12.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=14570, max=317475, num_faces=317476
      Valid probs shape: (37, 81282)
    ✓ Random_4 (pose=(1.4876812770367716, 2.2679854055522135, -1.0543291726737363)): shape (37, 800, 800)
      Valid pixels: 99313/640000 (15.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=77, max=317475, num_faces=317476
      Valid probs shape: (37, 99313)
    ✓ Random_5 (pose=(-0.3758771776519332, -1.8148129217516389, 1.1066386003334259)): shape (37, 800, 800)
      Valid pixels: 104004/640000 (16.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=272, max=317475, num_faces=317476
      Valid probs shape: (37, 104004)
    ✓ Random_6 (pose=(-0.3114330429092953, -3.0449514977359797, -1.3781828773013467)): shape (37, 800, 800)
      Valid pixels: 56888/640000 (8.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=73645, max=317403, num_faces=317476
      Valid probs shape: (37, 56888)
    ✓ Random_7 (pose=(-2.2334184963103603, 2.823432749861845, 0.8874412709552217)): shape (37, 800, 800)
      Valid pixels: 60153/640000 (9.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=11, max=317475, num_faces=317476
      Valid probs shape: (37, 60153)
    ✓ Random_8 (pose=(-2.9098672686816416, -1.4204290242313906, 2.437927073541222)): shape (37, 800, 800)
      Valid pixels: 77410/640000 (12.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=317474, num_faces=317476
      Valid probs shape: (37, 77410)
    ✓ Random_9 (pose=(2.222281265532974, 0.5878665411967132, 3.11808849718928)): shape (37, 800, 800)
      Valid pixels: 96709/640000 (15.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=4496, max=317399, num_faces=317476
      Valid probs shape: (37, 96709)
    ✓ Random_10 (pose=(1.6999378364624649, -1.6848476151043215, 0.8117849875963796)): shape (37, 800, 800)
      Valid pixels: 78806/640000 (12.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=18, max=317475, num_faces=317476
      Valid probs shape: (37, 78806)
    ✓ Random_11 (pose=(1.674085782758409, 0.16648743137767807, 0.04804163536673256)): shape (37, 800, 800)
      Valid pixels: 107176/640000 (16.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=238, max=317474, num_faces=317476
      Valid probs shape: (37, 107176)
    ✓ Random_12 (pose=(-1.3118309033372342, 2.775739091699255, -0.40119196897689324)): shape (37, 800, 800)
      Valid pixels: 102990/640000 (16.1%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=0, max=317384, num_faces=317476
      Valid probs shape: (37, 102990)
    ✓ Random_13 (pose=(-1.3280908498364068, 1.537199874893286, -0.6954429356255281)): shape (37, 800, 800)
      Valid pixels: 99120/640000 (15.5%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=92, max=317067, num_faces=317476
      Valid probs shape: (37, 99120)
    ✓ Random_14 (pose=(0.13025797499658465, 1.0554526160338042, -2.460238909763689)): shape (37, 800, 800)
      Valid pixels: 80673/640000 (12.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=317475, num_faces=317476
      Valid probs shape: (37, 80673)
    ✓ Random_15 (pose=(-2.529611629807504, 0.03938613326328122, 1.816356696539681)): shape (37, 800, 800)
      Valid pixels: 70669/640000 (11.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4782, max=317474, num_faces=317476
      Valid probs shape: (37, 70669)
    ✓ Random_16 (pose=(-2.104451094093183, -2.771440432204003, 1.5889803002791139)): shape (37, 800, 800)
      Valid pixels: 61917/640000 (9.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=15, max=317475, num_faces=317476
      Valid probs shape: (37, 61917)
    ✓ Random_17 (pose=(-3.1138447686055426, 0.5580160925057247, -1.324409855767615)): shape (37, 800, 800)
      Valid pixels: 75848/640000 (11.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=13001, max=317475, num_faces=317476
      Valid probs shape: (37, 75848)
    ✓ Random_18 (pose=(2.5077551237400533, -0.9359356973485258, 1.070553508831158)): shape (37, 800, 800)
      Valid pixels: 77422/640000 (12.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7324, max=316255, num_faces=317476
      Valid probs shape: (37, 77422)
    ✓ Random_19 (pose=(2.353227513780288, 0.4022435651933369, 0.20866176438286033)): shape (37, 800, 800)
      Valid pixels: 94578/640000 (14.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=77, max=317474, num_faces=317476
      Valid probs shape: (37, 94578)
    ✓ Random_20 (pose=(0.5682192660178478, -1.1818821241155035, -1.3204989987179248)): shape (37, 800, 800)
      Valid pixels: 72599/640000 (11.3%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=3, max=317474, num_faces=317476
      Valid probs shape: (37, 72599)
    ✓ Random_21 (pose=(0.38646781298961086, -0.7817690627142544, -2.5793886595273547)): shape (37, 800, 800)
      Valid pixels: 93683/640000 (14.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=7, max=316451, num_faces=317476
      Valid probs shape: (37, 93683)
    ✓ Random_22 (pose=(1.8372903653702757, 2.809405665822031, 0.8794570885582011)): shape (37, 800, 800)
      Valid pixels: 81728/640000 (12.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=317471, num_faces=317476
      Valid probs shape: (37, 81728)
    ✓ Random_23 (pose=(-0.19381614467091834, -0.5089199878837394, 0.6489287121430318)): shape (37, 800, 800)
      Valid pixels: 52293/640000 (8.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=317475, num_faces=317476
      Valid probs shape: (37, 52293)
    ✓ Random_24 (pose=(2.41276523710758, 0.390869214947835, 2.7421496166702095)): shape (37, 800, 800)
      Valid pixels: 84285/640000 (13.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=14824, max=317384, num_faces=317476
      Valid probs shape: (37, 84285)
    ✓ Random_25 (pose=(-2.428363708135715, 1.5018717993160449, 1.8283553439061873)): shape (37, 800, 800)
      Valid pixels: 111443/640000 (17.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=82, max=317474, num_faces=317476
      Valid probs shape: (37, 111443)
    ✓ Random_26 (pose=(0.8871807143681787, -2.135433478936922, -2.061699797272107)): shape (37, 800, 800)
      Valid pixels: 86057/640000 (13.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=5, max=317474, num_faces=317476
      Valid probs shape: (37, 86057)
    ✓ Random_27 (pose=(2.7680245971406237, 0.5841367236013526, 0.9463732075005895)): shape (37, 800, 800)
      Valid pixels: 81727/640000 (12.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=801, max=317474, num_faces=317476
      Valid probs shape: (37, 81727)
    ✓ Random_28 (pose=(-1.3906904157235436, -2.164787310671733, -1.8734937129312903)): shape (37, 800, 800)
      Valid pixels: 67699/640000 (10.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=96, max=317449, num_faces=317476
      Valid probs shape: (37, 67699)
    ✓ Random_29 (pose=(2.7001924287457637, -0.5133815429819992, 0.054674863008516095)): shape (37, 800, 800)
      Valid pixels: 59723/640000 (9.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1810, max=317470, num_faces=317476
      Valid probs shape: (37, 59723)
    P stats: min=0.0000, max=0.9998, mean=0.0252
    Non-zero vertices: 147931/158740
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 10809   926  1400  4626     0  2047  1370  5806  6791]
  Ground Truth Stats:
    Labels shape: (158740,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-15/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7622
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8144
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8146

  RESULTS:
  RAW:         median(top-10)=0.8876, mean(top-10)=0.8931, median(all)=0.8208, mean(all)=0.7622
  + SMOOTHING: median(top-10)=0.9081, mean(top-10)=0.9118, median(all)=0.8743, mean(all)=0.8144 [+0.0205]
  + MRF:       median(top-10)=0.9086, mean(top-10)=0.9123, median(all)=0.8742, mean(all)=0.8146 [+0.0005]
  TOTAL IMPROVEMENT (median top-10): +0.0210

================================================================================
Subject: NKI-RS-22-16
================================================================================
  Step 0: Generating predictions with V2 model (30 random views)...
  Mesh: 137370 vertices, 274736 faces
  Generating 30 random views...
  Generating predictions for 30 views (continuous camera pose)...
    ✓ Random_0 (pose=(1.7831662486252213, -1.836790470868651, 0.7276391041759465)): shape (37, 800, 800)
      Valid pixels: 87058/640000 (13.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=274711, num_faces=274736
      Valid probs shape: (37, 87058)
    ✓ Random_1 (pose=(-0.43499082845781434, -0.7266668177613154, 2.3464838903307204)): shape (37, 800, 800)
      Valid pixels: 95628/640000 (14.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=274733, num_faces=274736
      Valid probs shape: (37, 95628)
    ✓ Random_2 (pose=(2.1572086812040467, -0.4013477726678487, -0.4064382635025212)): shape (37, 800, 800)
      Valid pixels: 111076/640000 (17.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=172, max=274735, num_faces=274736
      Valid probs shape: (37, 111076)
    ✓ Random_3 (pose=(1.7759813319294189, -2.8304029984016963, 1.1843171289511618)): shape (37, 800, 800)
      Valid pixels: 77808/640000 (12.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=274710, num_faces=274736
      Valid probs shape: (37, 77808)
    ✓ Random_4 (pose=(2.5528772657597436, 0.47017167800952464, -1.4848391419267681)): shape (37, 800, 800)
      Valid pixels: 78057/640000 (12.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2875, max=274734, num_faces=274736
      Valid probs shape: (37, 78057)
    ✓ Random_5 (pose=(0.1374683006957933, -2.569014184151528, 2.949398744200649)): shape (37, 800, 800)
      Valid pixels: 65840/640000 (10.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=35854, max=274735, num_faces=274736
      Valid probs shape: (37, 65840)
    ✓ Random_6 (pose=(-2.8263901923467336, -0.6799169276662065, 1.5903115132460126)): shape (37, 800, 800)
      Valid pixels: 90501/640000 (14.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=7053, max=274735, num_faces=274736
      Valid probs shape: (37, 90501)
    ✓ Random_7 (pose=(-0.7418388922542887, 0.8997842119591901, 0.6709260590412947)): shape (37, 800, 800)
      Valid pixels: 102967/640000 (16.1%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=9, max=274655, num_faces=274736
      Valid probs shape: (37, 102967)
    ✓ Random_8 (pose=(1.9742553219507233, -3.1313794331269618, 2.6674390679303484)): shape (37, 800, 800)
      Valid pixels: 110753/640000 (17.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=274536, num_faces=274736
      Valid probs shape: (37, 110753)
    ✓ Random_9 (pose=(-3.0699473801128665, -1.2274645922068605, -2.1186515245192634)): shape (37, 800, 800)
      Valid pixels: 120326/640000 (18.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=19, max=274733, num_faces=274736
      Valid probs shape: (37, 120326)
    ✓ Random_10 (pose=(2.7002247038652563, -2.519972706001131, 2.4505324791144494)): shape (37, 800, 800)
      Valid pixels: 86278/640000 (13.5%)
      Probs stats: min=0.0000, max=0.9995, mean=0.0270
      Face IDs: min=1, max=273269, num_faces=274736
      Valid probs shape: (37, 86278)
    ✓ Random_11 (pose=(0.005585018760239535, -0.18451572876245903, 2.974096851186485)): shape (37, 800, 800)
      Valid pixels: 60624/640000 (9.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=272347, num_faces=274736
      Valid probs shape: (37, 60624)
    ✓ Random_12 (pose=(0.5843596184586155, -0.5309264948802315, -1.5553755827261564)): shape (37, 800, 800)
      Valid pixels: 72991/640000 (11.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=274450, num_faces=274736
      Valid probs shape: (37, 72991)
    ✓ Random_13 (pose=(-2.389630866762295, 1.6214858840276314, 0.2041029631533413)): shape (37, 800, 800)
      Valid pixels: 85528/640000 (13.4%)
      Probs stats: min=0.0000, max=0.9995, mean=0.0270
      Face IDs: min=37, max=274708, num_faces=274736
      Valid probs shape: (37, 85528)
    ✓ Random_14 (pose=(0.23959884156050437, 2.087319414373763, -2.442771504990911)): shape (37, 800, 800)
      Valid pixels: 94263/640000 (14.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1497, max=274733, num_faces=274736
      Valid probs shape: (37, 94263)
    ✓ Random_15 (pose=(1.1762648029309721, -0.28726307796226136, -0.622112491473088)): shape (37, 800, 800)
      Valid pixels: 107530/640000 (16.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=4, max=274733, num_faces=274736
      Valid probs shape: (37, 107530)
    ✓ Random_16 (pose=(-0.04107845543192301, 1.8780132569094867, -0.8886366337950533)): shape (37, 800, 800)
      Valid pixels: 92402/640000 (14.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=274722, num_faces=274736
      Valid probs shape: (37, 92402)
    ✓ Random_17 (pose=(2.467157318046125, 0.2637610794189693, -2.7185088764583067)): shape (37, 800, 800)
      Valid pixels: 96990/640000 (15.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=14984, max=274735, num_faces=274736
      Valid probs shape: (37, 96990)
    ✓ Random_18 (pose=(-0.2144197606452103, 2.528216062699723, -2.884512142391501)): shape (37, 800, 800)
      Valid pixels: 80548/640000 (12.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2302, max=274735, num_faces=274736
      Valid probs shape: (37, 80548)
    ✓ Random_19 (pose=(-0.25729941931565925, 2.365107541766214, 1.0022122294096132)): shape (37, 800, 800)
      Valid pixels: 103801/640000 (16.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=12291, max=274735, num_faces=274736
      Valid probs shape: (37, 103801)
    ✓ Random_20 (pose=(0.5886243535587137, -1.6870526855586139, 1.1996623388210912)): shape (37, 800, 800)
      Valid pixels: 113972/640000 (17.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=274733, num_faces=274736
      Valid probs shape: (37, 113972)
    ✓ Random_21 (pose=(-2.67398111021288, -0.4884246466560396, -0.9846281929899185)): shape (37, 800, 800)
      Valid pixels: 65536/640000 (10.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4719, max=274735, num_faces=274736
      Valid probs shape: (37, 65536)
    ✓ Random_22 (pose=(2.7577011974072105, 0.40587980345401986, -0.12103300406590511)): shape (37, 800, 800)
      Valid pixels: 75738/640000 (11.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3044, max=274734, num_faces=274736
      Valid probs shape: (37, 75738)
    ✓ Random_23 (pose=(-1.402235952141008, 1.7250744496004788, -0.3292012392405361)): shape (37, 800, 800)
      Valid pixels: 116893/640000 (18.3%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=8, max=274729, num_faces=274736
      Valid probs shape: (37, 116893)
    ✓ Random_24 (pose=(-1.0341680196470024, 1.1419388560321595, -1.5058530994551278)): shape (37, 800, 800)
      Valid pixels: 80396/640000 (12.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=274711, num_faces=274736
      Valid probs shape: (37, 80396)
    ✓ Random_25 (pose=(2.8954632494231713, -1.8170379919539181, -2.8457356960515616)): shape (37, 800, 800)
      Valid pixels: 74522/640000 (11.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=5, max=274733, num_faces=274736
      Valid probs shape: (37, 74522)
    ✓ Random_26 (pose=(2.8298484548475615, 1.0066315821914582, 2.161705193270123)): shape (37, 800, 800)
      Valid pixels: 82714/640000 (12.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1418, max=274723, num_faces=274736
      Valid probs shape: (37, 82714)
    ✓ Random_27 (pose=(-0.059465249667434605, -1.4300083563034798, 0.8423362226137305)): shape (37, 800, 800)
      Valid pixels: 113853/640000 (17.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=274733, num_faces=274736
      Valid probs shape: (37, 113853)
    ✓ Random_28 (pose=(2.3319099787671593, 0.7238649837179607, 0.3801079623204564)): shape (37, 800, 800)
      Valid pixels: 110744/640000 (17.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=171, max=274733, num_faces=274736
      Valid probs shape: (37, 110744)
    ✓ Random_29 (pose=(-3.0668877404215533, -1.601285913854735, -1.1555765549614319)): shape (37, 800, 800)
      Valid pixels: 103031/640000 (16.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=274733, num_faces=274736
      Valid probs shape: (37, 103031)
    P stats: min=0.0000, max=0.9999, mean=0.0251
    Non-zero vertices: 127798/137370
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 9572 1027 1218 2906    0 2091  994 4915 5315]
  Ground Truth Stats:
    Labels shape: (137370,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-16/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7620
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8165
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8168

  RESULTS:
  RAW:         median(top-10)=0.8927, mean(top-10)=0.8930, median(all)=0.8289, mean(all)=0.7620
  + SMOOTHING: median(top-10)=0.9196, mean(top-10)=0.9204, median(all)=0.8585, mean(all)=0.8165 [+0.0269]
  + MRF:       median(top-10)=0.9203, mean(top-10)=0.9208, median(all)=0.8591, mean(all)=0.8168 [+0.0007]
  TOTAL IMPROVEMENT (median top-10): +0.0276

================================================================================
Subject: NKI-RS-22-17
================================================================================
  Step 0: Generating predictions with V2 model (30 random views)...
  Mesh: 161773 vertices, 323542 faces
  Generating 30 random views...
  Generating predictions for 30 views (continuous camera pose)...
    ✓ Random_0 (pose=(1.9737632143108925, -1.000703700162302, 1.8622021543319178)): shape (37, 800, 800)
      Valid pixels: 93874/640000 (14.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=106, max=323474, num_faces=323542
      Valid probs shape: (37, 93874)
    ✓ Random_1 (pose=(2.1229738254632586, -0.9678288932732584, -1.1339621347494449)): shape (37, 800, 800)
      Valid pixels: 103589/640000 (16.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=253, max=323540, num_faces=323542
      Valid probs shape: (37, 103589)
    ✓ Random_2 (pose=(2.7584725823000875, 0.17555304579473896, -1.7936806427519025)): shape (37, 800, 800)
      Valid pixels: 57583/640000 (9.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4488, max=323541, num_faces=323542
      Valid probs shape: (37, 57583)
    ✓ Random_3 (pose=(-1.0784115446547178, -2.6436781204087696, -2.279061532487682)): shape (37, 800, 800)
      Valid pixels: 68656/640000 (10.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1873, max=322962, num_faces=323542
      Valid probs shape: (37, 68656)
    ✓ Random_4 (pose=(1.2120519264626184, 0.04898608278573757, 0.5087022144470223)): shape (37, 800, 800)
      Valid pixels: 82469/640000 (12.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=323341, num_faces=323542
      Valid probs shape: (37, 82469)
    ✓ Random_5 (pose=(-1.9522027298354472, -1.7390245744988289, -0.16361358036278206)): shape (37, 800, 800)
      Valid pixels: 102513/640000 (16.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=76, max=323473, num_faces=323542
      Valid probs shape: (37, 102513)
    ✓ Random_6 (pose=(2.548833173925736, -0.30906646094611956, -0.013713578334443532)): shape (37, 800, 800)
      Valid pixels: 68903/640000 (10.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1838, max=323478, num_faces=323542
      Valid probs shape: (37, 68903)
    ✓ Random_7 (pose=(0.32876172230394474, -2.789786865870035, 2.9150309438581354)): shape (37, 800, 800)
      Valid pixels: 66736/640000 (10.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=52846, max=323534, num_faces=323542
      Valid probs shape: (37, 66736)
    ✓ Random_8 (pose=(1.7722318409652091, 2.1693887427313117, 2.4451906251053748)): shape (37, 800, 800)
      Valid pixels: 97312/640000 (15.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=103, max=323477, num_faces=323542
      Valid probs shape: (37, 97312)
    ✓ Random_9 (pose=(-0.9383903178676527, 2.1126823182788117, 0.8832811676620871)): shape (37, 800, 800)
      Valid pixels: 86811/640000 (13.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=150, max=323528, num_faces=323542
      Valid probs shape: (37, 86811)
    ✓ Random_10 (pose=(-2.785434136433531, 1.4516271939356864, -1.7835086123233737)): shape (37, 800, 800)
      Valid pixels: 102578/640000 (16.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=100, max=323475, num_faces=323542
      Valid probs shape: (37, 102578)
    ✓ Random_11 (pose=(0.6112110406364129, 2.0693963190575166, -2.096281714788956)): shape (37, 800, 800)
      Valid pixels: 83205/640000 (13.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=839, max=323537, num_faces=323542
      Valid probs shape: (37, 83205)
    ✓ Random_12 (pose=(-0.5526699551502228, 2.337161127091373, -0.9029086628071648)): shape (37, 800, 800)
      Valid pixels: 62050/640000 (9.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3032, max=322968, num_faces=323542
      Valid probs shape: (37, 62050)
    ✓ Random_13 (pose=(1.4986426619717532, 0.013935523755199686, 3.047159464257178)): shape (37, 800, 800)
      Valid pixels: 98424/640000 (15.4%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=29, max=323504, num_faces=323542
      Valid probs shape: (37, 98424)
    ✓ Random_14 (pose=(0.8036124289358701, 1.2005697408519342, 3.026945959763638)): shape (37, 800, 800)
      Valid pixels: 76711/640000 (12.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=11, max=323541, num_faces=323542
      Valid probs shape: (37, 76711)
    ✓ Random_15 (pose=(2.3845295780912794, -1.5270970521241471, 0.4879190038088934)): shape (37, 800, 800)
      Valid pixels: 64831/640000 (10.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=8, max=322962, num_faces=323542
      Valid probs shape: (37, 64831)
    ✓ Random_16 (pose=(-1.6654305353628271, -1.6982883772260375, 0.6254043879775217)): shape (37, 800, 800)
      Valid pixels: 81449/640000 (12.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=27, max=323541, num_faces=323542
      Valid probs shape: (37, 81449)
    ✓ Random_17 (pose=(-0.20584655373734373, -0.538012234573952, 2.793239477018961)): shape (37, 800, 800)
      Valid pixels: 60504/640000 (9.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=323108, num_faces=323542
      Valid probs shape: (37, 60504)
    ✓ Random_18 (pose=(-0.30015590521373303, 1.4356514189109122, -3.0255089615232724)): shape (37, 800, 800)
      Valid pixels: 87559/640000 (13.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=11, max=323541, num_faces=323542
      Valid probs shape: (37, 87559)
    ✓ Random_19 (pose=(-1.71868234275298, 2.2880240513782466, 3.0898800132912303)): shape (37, 800, 800)
      Valid pixels: 102570/640000 (16.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=323478, num_faces=323542
      Valid probs shape: (37, 102570)
    ✓ Random_20 (pose=(-1.0624022918629303, -2.8682535103429325, 2.892444227314752)): shape (37, 800, 800)
      Valid pixels: 97703/640000 (15.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1362, max=323478, num_faces=323542
      Valid probs shape: (37, 97703)
    ✓ Random_21 (pose=(3.064086141897284, 2.4220256659523036, 3.0960868436792826)): shape (37, 800, 800)
      Valid pixels: 59678/640000 (9.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=321667, num_faces=323542
      Valid probs shape: (37, 59678)
    ✓ Random_22 (pose=(2.425656111821831, -0.11776463539797133, -3.0592892445643525)): shape (37, 800, 800)
      Valid pixels: 78879/640000 (12.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=14335, max=323541, num_faces=323542
      Valid probs shape: (37, 78879)
    ✓ Random_23 (pose=(-0.5453242238087892, 2.289696242181332, -1.6273327624095308)): shape (37, 800, 800)
      Valid pixels: 76052/640000 (11.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=459, max=322968, num_faces=323542
      Valid probs shape: (37, 76052)
    ✓ Random_24 (pose=(-0.9211518992587671, 0.4148749793264206, -1.6116553555917408)): shape (37, 800, 800)
      Valid pixels: 60632/640000 (9.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=322962, num_faces=323542
      Valid probs shape: (37, 60632)
    ✓ Random_25 (pose=(-0.3306015061176306, 1.6788161469494405, 2.6642647940409727)): shape (37, 800, 800)
      Valid pixels: 67556/640000 (10.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=24, max=323541, num_faces=323542
      Valid probs shape: (37, 67556)
    ✓ Random_26 (pose=(0.4837364917538678, -2.1138258161779193, -2.604319506592543)): shape (37, 800, 800)
      Valid pixels: 96109/640000 (15.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1121, max=323478, num_faces=323542
      Valid probs shape: (37, 96109)
    ✓ Random_27 (pose=(2.7399592006068056, -0.8239089720318566, -3.0889141750704927)): shape (37, 800, 800)
      Valid pixels: 65342/640000 (10.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2370, max=323535, num_faces=323542
      Valid probs shape: (37, 65342)
    ✓ Random_28 (pose=(2.556289205690941, 0.572656724408426, -2.2443620523300374)): shape (37, 800, 800)
      Valid pixels: 80935/640000 (12.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=9371, max=323534, num_faces=323542
      Valid probs shape: (37, 80935)
    ✓ Random_29 (pose=(-1.6147732136311959, -2.4514700706459744, -2.8796567663004615)): shape (37, 800, 800)
      Valid pixels: 97822/640000 (15.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=323341, num_faces=323542
      Valid probs shape: (37, 97822)
    P stats: min=0.0000, max=1.0000, mean=0.0256
    Non-zero vertices: 153250/161773
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 8523 1359 1031 5530    0 2726 1308 5045 8117]
  Ground Truth Stats:
    Labels shape: (161773,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-17/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7804
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8231
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8226

  RESULTS:
  RAW:         median(top-10)=0.9124, mean(top-10)=0.9178, median(all)=0.8520, mean(all)=0.7804
  + SMOOTHING: median(top-10)=0.9342, mean(top-10)=0.9361, median(all)=0.8972, mean(all)=0.8231 [+0.0218]
  + MRF:       median(top-10)=0.9346, mean(top-10)=0.9363, median(all)=0.8972, mean(all)=0.8226 [+0.0004]
  TOTAL IMPROVEMENT (median top-10): +0.0222

================================================================================
Subject: NKI-RS-22-18
================================================================================
  Step 0: Generating predictions with V2 model (30 random views)...
  Mesh: 147633 vertices, 295262 faces
  Generating 30 random views...
  Generating predictions for 30 views (continuous camera pose)...
    ✓ Random_0 (pose=(2.923514169316176, 1.2655020249356443, 3.0265778156549876)): shape (37, 800, 800)
      Valid pixels: 60835/640000 (9.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=838, max=295253, num_faces=295262
      Valid probs shape: (37, 60835)
    ✓ Random_1 (pose=(-0.795173833418517, -0.07858300423233011, 2.8614558713011062)): shape (37, 800, 800)
      Valid pixels: 76436/640000 (11.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=295261, num_faces=295262
      Valid probs shape: (37, 76436)
    ✓ Random_2 (pose=(-2.3645405830703075, -1.4919777731255965, 1.2913661965951837)): shape (37, 800, 800)
      Valid pixels: 78768/640000 (12.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=295254, num_faces=295262
      Valid probs shape: (37, 78768)
    ✓ Random_3 (pose=(2.374770523521585, 2.949888334769475, 0.8181434694423473)): shape (37, 800, 800)
      Valid pixels: 63565/640000 (9.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=295261, num_faces=295262
      Valid probs shape: (37, 63565)
    ✓ Random_4 (pose=(1.9689419636371506, 0.8527404896891402, 2.9341673756691966)): shape (37, 800, 800)
      Valid pixels: 95168/640000 (14.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=7, max=295259, num_faces=295262
      Valid probs shape: (37, 95168)
    ✓ Random_5 (pose=(-2.225367081814323, -1.3709381038963335, -0.7878167814162347)): shape (37, 800, 800)
      Valid pixels: 62595/640000 (9.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=14, max=294688, num_faces=295262
      Valid probs shape: (37, 62595)
    ✓ Random_6 (pose=(-0.5140703606873069, 0.3498062052806583, -2.47925685175734)): shape (37, 800, 800)
      Valid pixels: 64250/640000 (10.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=295261, num_faces=295262
      Valid probs shape: (37, 64250)
    ✓ Random_7 (pose=(1.8703499496858456, -1.0451599117354728, 2.305232424336266)): shape (37, 800, 800)
      Valid pixels: 96081/640000 (15.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=17, max=295258, num_faces=295262
      Valid probs shape: (37, 96081)
    ✓ Random_8 (pose=(0.7672211505831217, 1.2993466116969374, -1.641111003377307)): shape (37, 800, 800)
      Valid pixels: 90874/640000 (14.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=295261, num_faces=295262
      Valid probs shape: (37, 90874)
    ✓ Random_9 (pose=(1.2553489218595857, 2.62948218051085, -0.06198826637769983)): shape (37, 800, 800)
      Valid pixels: 93545/640000 (14.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=67, max=295261, num_faces=295262
      Valid probs shape: (37, 93545)
    ✓ Random_10 (pose=(-0.6587111368803633, 2.875602144254371, 1.146445645555617)): shape (37, 800, 800)
      Valid pixels: 61016/640000 (9.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2351, max=295260, num_faces=295262
      Valid probs shape: (37, 61016)
    ✓ Random_11 (pose=(-2.7789693856120894, 1.6269613036892787, 2.6873912058498988)): shape (37, 800, 800)
      Valid pixels: 74147/640000 (11.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=295251, num_faces=295262
      Valid probs shape: (37, 74147)
    ✓ Random_12 (pose=(0.9877499422352694, -0.687243647450182, 2.8188312111021947)): shape (37, 800, 800)
      Valid pixels: 88478/640000 (13.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=295199, num_faces=295262
      Valid probs shape: (37, 88478)
    ✓ Random_13 (pose=(-2.73117492567099, -2.834961150711227, -0.6124583454731245)): shape (37, 800, 800)
      Valid pixels: 54432/640000 (8.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=293398, num_faces=295262
      Valid probs shape: (37, 54432)
    ✓ Random_14 (pose=(-0.9620671617770444, 1.3046343994062362, -3.018850198912141)): shape (37, 800, 800)
      Valid pixels: 100293/640000 (15.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=12, max=295261, num_faces=295262
      Valid probs shape: (37, 100293)
    ✓ Random_15 (pose=(2.23973405222488, 1.1695837179290587, 2.432127979454674)): shape (37, 800, 800)
      Valid pixels: 67460/640000 (10.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=48, max=295199, num_faces=295262
      Valid probs shape: (37, 67460)
    ✓ Random_16 (pose=(-1.5993158570940889, -3.0546410369892247, 1.1315875128044324)): shape (37, 800, 800)
      Valid pixels: 65485/640000 (10.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=59, max=295259, num_faces=295262
      Valid probs shape: (37, 65485)
    ✓ Random_17 (pose=(1.3177095834560664, -1.8372836253233003, -1.945583193836445)): shape (37, 800, 800)
      Valid pixels: 68540/640000 (10.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=57, max=295218, num_faces=295262
      Valid probs shape: (37, 68540)
    ✓ Random_18 (pose=(-2.67243976717771, -1.8630434706131778, 2.2176090854604587)): shape (37, 800, 800)
      Valid pixels: 63961/640000 (10.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=295260, num_faces=295262
      Valid probs shape: (37, 63961)
    ✓ Random_19 (pose=(1.1830446231890246, 0.9824016386995549, 2.34910825605059)): shape (37, 800, 800)
      Valid pixels: 96296/640000 (15.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=295199, num_faces=295262
      Valid probs shape: (37, 96296)
    ✓ Random_20 (pose=(1.760885267135615, 3.0542643120596322, -0.27347634032013257)): shape (37, 800, 800)
      Valid pixels: 100873/640000 (15.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=295261, num_faces=295262
      Valid probs shape: (37, 100873)
    ✓ Random_21 (pose=(-2.318481113920147, -0.6457175606533072, -0.8109034442898246)): shape (37, 800, 800)
      Valid pixels: 63914/640000 (10.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=9295, max=295253, num_faces=295262
      Valid probs shape: (37, 63914)
    ✓ Random_22 (pose=(-0.6837041544411524, 1.822967276890222, -0.6400062324820412)): shape (37, 800, 800)
      Valid pixels: 58701/640000 (9.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=13, max=295259, num_faces=295262
      Valid probs shape: (37, 58701)
    ✓ Random_23 (pose=(1.0002385758829355, -1.1220043421926662, 2.984378692443876)): shape (37, 800, 800)
      Valid pixels: 93764/640000 (14.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=10, max=295207, num_faces=295262
      Valid probs shape: (37, 93764)
    ✓ Random_24 (pose=(-1.2502086870994515, -0.015499952060834765, -2.90032158150794)): shape (37, 800, 800)
      Valid pixels: 88121/640000 (13.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=295261, num_faces=295262
      Valid probs shape: (37, 88121)
    ✓ Random_25 (pose=(2.5094584322933686, 0.4580703910100903, -2.1887226555765817)): shape (37, 800, 800)
      Valid pixels: 69531/640000 (10.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3757, max=295259, num_faces=295262
      Valid probs shape: (37, 69531)
    ✓ Random_26 (pose=(1.5825104943073782, -2.7967141580761, -0.03454531998730914)): shape (37, 800, 800)
      Valid pixels: 99820/640000 (15.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=295261, num_faces=295262
      Valid probs shape: (37, 99820)
    ✓ Random_27 (pose=(2.6723164135208135, -0.32620095587656195, -2.868725900297807)): shape (37, 800, 800)
      Valid pixels: 57551/640000 (9.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2982, max=295260, num_faces=295262
      Valid probs shape: (37, 57551)
    ✓ Random_28 (pose=(1.7182661112669262, -0.5314516524095616, -0.30375344453697073)): shape (37, 800, 800)
      Valid pixels: 101914/640000 (15.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=295261, num_faces=295262
      Valid probs shape: (37, 101914)
    ✓ Random_29 (pose=(-2.7528651152086097, 0.38142750387490976, -2.57100704985898)): shape (37, 800, 800)
      Valid pixels: 46611/640000 (7.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4020, max=295260, num_faces=295262
      Valid probs shape: (37, 46611)
    P stats: min=0.0000, max=1.0000, mean=0.0250
    Non-zero vertices: 136563/147633
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 11070  1827  1067  3753     0  2294   903  5200  7623]
  Ground Truth Stats:
    Labels shape: (147633,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-18/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7505
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8013
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8016

  RESULTS:
  RAW:         median(top-10)=0.8976, mean(top-10)=0.8960, median(all)=0.8096, mean(all)=0.7505
  + SMOOTHING: median(top-10)=0.9218, mean(top-10)=0.9227, median(all)=0.8504, mean(all)=0.8013 [+0.0242]
  + MRF:       median(top-10)=0.9219, mean(top-10)=0.9229, median(all)=0.8502, mean(all)=0.8016 [+0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0243

================================================================================
Subject: NKI-RS-22-19
================================================================================
  Step 0: Generating predictions with V2 model (30 random views)...
  Mesh: 141397 vertices, 282790 faces
  Generating 30 random views...
  Generating predictions for 30 views (continuous camera pose)...
    ✓ Random_0 (pose=(3.052892340490767, -1.509002850228217, 2.247956752170353)): shape (37, 800, 800)
      Valid pixels: 72667/640000 (11.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=22, max=282789, num_faces=282790
      Valid probs shape: (37, 72667)
    ✓ Random_1 (pose=(-2.3971481078917867, 0.3405664519025966, -0.0817799315784864)): shape (37, 800, 800)
      Valid pixels: 71976/640000 (11.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2732, max=282789, num_faces=282790
      Valid probs shape: (37, 71976)
    ✓ Random_2 (pose=(0.4245660979388828, -1.8704921912694972, -0.7969336213182836)): shape (37, 800, 800)
      Valid pixels: 61316/640000 (9.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=593, max=282787, num_faces=282790
      Valid probs shape: (37, 61316)
    ✓ Random_3 (pose=(-0.0464439514933761, 2.7940461169306836, 2.4023382091218908)): shape (37, 800, 800)
      Valid pixels: 46220/640000 (7.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=52544, max=282789, num_faces=282790
      Valid probs shape: (37, 46220)
    ✓ Random_4 (pose=(1.6524928962418057, 2.0546368359809346, -0.38478694022077375)): shape (37, 800, 800)
      Valid pixels: 92207/640000 (14.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=32, max=282781, num_faces=282790
      Valid probs shape: (37, 92207)
    ✓ Random_5 (pose=(-0.004049792777551353, 2.999451515495899, -0.2688490207073637)): shape (37, 800, 800)
      Valid pixels: 41461/640000 (6.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=44702, max=282789, num_faces=282790
      Valid probs shape: (37, 41461)
    ✓ Random_6 (pose=(1.265769465216791, -2.7101250466417195, 2.8692570626818688)): shape (37, 800, 800)
      Valid pixels: 87396/640000 (13.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=20, max=282789, num_faces=282790
      Valid probs shape: (37, 87396)
    ✓ Random_7 (pose=(-2.7636457886131662, -0.7352333695554734, -1.2189867550869247)): shape (37, 800, 800)
      Valid pixels: 59001/640000 (9.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=492, max=282775, num_faces=282790
      Valid probs shape: (37, 59001)
    ✓ Random_8 (pose=(-2.338489538812819, 2.2525478449921854, 2.1519071846479783)): shape (37, 800, 800)
      Valid pixels: 86296/640000 (13.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=282781, num_faces=282790
      Valid probs shape: (37, 86296)
    ✓ Random_9 (pose=(2.9676306711519223, -2.977845950042177, -1.3422713320123358)): shape (37, 800, 800)
      Valid pixels: 46426/640000 (7.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=282685, num_faces=282790
      Valid probs shape: (37, 46426)
    ✓ Random_10 (pose=(-1.7195973480728046, -0.8048001313799129, 2.4936622391991357)): shape (37, 800, 800)
      Valid pixels: 86085/640000 (13.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=144, max=282781, num_faces=282790
      Valid probs shape: (37, 86085)
    ✓ Random_11 (pose=(2.627499269949424, 0.08234570235841732, 0.19787511619296128)): shape (37, 800, 800)
      Valid pixels: 54808/640000 (8.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1475, max=282786, num_faces=282790
      Valid probs shape: (37, 54808)
    ✓ Random_12 (pose=(2.8757129382014286, -2.516823874338124, 0.7105491058639708)): shape (37, 800, 800)
      Valid pixels: 49196/640000 (7.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=281832, num_faces=282790
      Valid probs shape: (37, 49196)
    ✓ Random_13 (pose=(1.5426876368706814, 2.8566062464267823, -1.9176583662996536)): shape (37, 800, 800)
      Valid pixels: 62321/640000 (9.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=23, max=282787, num_faces=282790
      Valid probs shape: (37, 62321)
    ✓ Random_14 (pose=(-2.2040559636612946, -2.1994123618070116, -2.0360275639376657)): shape (37, 800, 800)
      Valid pixels: 72851/640000 (11.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=282685, num_faces=282790
      Valid probs shape: (37, 72851)
    ✓ Random_15 (pose=(-2.504420732326461, 0.1505115809574349, -3.13452055603612)): shape (37, 800, 800)
      Valid pixels: 59445/640000 (9.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1474, max=282781, num_faces=282790
      Valid probs shape: (37, 59445)
    ✓ Random_16 (pose=(-1.143384264633924, -1.4521263234648947, -0.6927607972921415)): shape (37, 800, 800)
      Valid pixels: 87076/640000 (13.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=31, max=282789, num_faces=282790
      Valid probs shape: (37, 87076)
    ✓ Random_17 (pose=(0.4708572454603366, -2.619344854587542, -1.79895600439444)): shape (37, 800, 800)
      Valid pixels: 63508/640000 (9.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2177, max=282789, num_faces=282790
      Valid probs shape: (37, 63508)
    ✓ Random_18 (pose=(-0.04053856549458068, 1.447282400658743, -2.469644903256066)): shape (37, 800, 800)
      Valid pixels: 84539/640000 (13.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=126, max=282781, num_faces=282790
      Valid probs shape: (37, 84539)
    ✓ Random_19 (pose=(1.1433138835846428, -0.6178151268004743, 1.5450452184535584)): shape (37, 800, 800)
      Valid pixels: 55935/640000 (8.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=282685, num_faces=282790
      Valid probs shape: (37, 55935)
    ✓ Random_20 (pose=(-2.6749204240134183, 2.744518975041104, -2.5784406750158024)): shape (37, 800, 800)
      Valid pixels: 45966/640000 (7.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=282685, num_faces=282790
      Valid probs shape: (37, 45966)
    ✓ Random_21 (pose=(2.9944562067942444, 2.3287619651856293, 0.579647735165838)): shape (37, 800, 800)
      Valid pixels: 70309/640000 (11.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=282781, num_faces=282790
      Valid probs shape: (37, 70309)
    ✓ Random_22 (pose=(0.14725265287538924, -2.4701515361885256, -2.789068368555262)): shape (37, 800, 800)
      Valid pixels: 65977/640000 (10.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=22080, max=282789, num_faces=282790
      Valid probs shape: (37, 65977)
    ✓ Random_23 (pose=(1.7523610900231823, -1.7916420340184462, 0.9075324341468738)): shape (37, 800, 800)
      Valid pixels: 63152/640000 (9.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=282681, num_faces=282790
      Valid probs shape: (37, 63152)
    ✓ Random_24 (pose=(-0.8932798631778622, -1.588295653615304, -2.4538168186198486)): shape (37, 800, 800)
      Valid pixels: 57573/640000 (9.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=282721, num_faces=282790
      Valid probs shape: (37, 57573)
    ✓ Random_25 (pose=(2.7275698341331287, 0.4152943772923292, 3.1356437748350796)): shape (37, 800, 800)
      Valid pixels: 66681/640000 (10.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=35163, max=282789, num_faces=282790
      Valid probs shape: (37, 66681)
    ✓ Random_26 (pose=(-0.31784278086547024, 2.8430643859907754, 2.5450856956347527)): shape (37, 800, 800)
      Valid pixels: 38661/640000 (6.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1449, max=282787, num_faces=282790
      Valid probs shape: (37, 38661)
    ✓ Random_27 (pose=(-0.7518793444745806, 0.42344227283811264, 1.9125344828168895)): shape (37, 800, 800)
      Valid pixels: 52325/640000 (8.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=282747, num_faces=282790
      Valid probs shape: (37, 52325)
    ✓ Random_28 (pose=(-2.0284322615863375, 2.515090316815214, 2.4847092483556157)): shape (37, 800, 800)
      Valid pixels: 88552/640000 (13.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6, max=282781, num_faces=282790
      Valid probs shape: (37, 88552)
    ✓ Random_29 (pose=(1.9357489438153532, -0.10320085837465642, 1.5594925847889147)): shape (37, 800, 800)
      Valid pixels: 55329/640000 (8.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=21, max=282740, num_faces=282790
      Valid probs shape: (37, 55329)
    P stats: min=0.0000, max=1.0000, mean=0.0250
    Non-zero vertices: 130583/141397
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 10814  1383  1234  3605     0  1821  1122  4626  5691]
  Ground Truth Stats:
    Labels shape: (141397,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-19/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7732
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8284
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8286

  RESULTS:
  RAW:         median(top-10)=0.9078, mean(top-10)=0.9059, median(all)=0.8308, mean(all)=0.7732
  + SMOOTHING: median(top-10)=0.9259, mean(top-10)=0.9267, median(all)=0.8737, mean(all)=0.8284 [+0.0182]
  + MRF:       median(top-10)=0.9259, mean(top-10)=0.9269, median(all)=0.8739, mean(all)=0.8286 [-0.0000]
  TOTAL IMPROVEMENT (median top-10): +0.0182

================================================================================
Subject: NKI-RS-22-2
================================================================================
  Step 0: Generating predictions with V2 model (30 random views)...
  Mesh: 137791 vertices, 275578 faces
  Generating 30 random views...
  Generating predictions for 30 views (continuous camera pose)...
    ✓ Random_0 (pose=(0.01046217850606146, -2.9477027266134623, 2.468608771472571)): shape (37, 800, 800)
      Valid pixels: 44105/640000 (6.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2926, max=275574, num_faces=275578
      Valid probs shape: (37, 44105)
    ✓ Random_1 (pose=(0.4948212928139366, -1.8299142548100173, 0.06277804204869852)): shape (37, 800, 800)
      Valid pixels: 87634/640000 (13.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=208, max=275479, num_faces=275578
      Valid probs shape: (37, 87634)
    ✓ Random_2 (pose=(1.025025505652355, 2.619336439685849, -2.354807982342642)): shape (37, 800, 800)
      Valid pixels: 64481/640000 (10.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=830, max=275509, num_faces=275578
      Valid probs shape: (37, 64481)
    ✓ Random_3 (pose=(-1.6958681312819954, -0.8848912893496257, -0.17438068051226496)): shape (37, 800, 800)
      Valid pixels: 96296/640000 (15.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=51, max=275577, num_faces=275578
      Valid probs shape: (37, 96296)
    ✓ Random_4 (pose=(2.2730495601246536, -2.46686665548457, -1.4748271155067727)): shape (37, 800, 800)
      Valid pixels: 78703/640000 (12.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=9, max=275500, num_faces=275578
      Valid probs shape: (37, 78703)
    ✓ Random_5 (pose=(-1.204437664982323, -2.738035477633916, -0.8638309033271074)): shape (37, 800, 800)
      Valid pixels: 92002/640000 (14.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=734, max=275577, num_faces=275578
      Valid probs shape: (37, 92002)
    ✓ Random_6 (pose=(1.2684023205359365, 1.0830170683991005, 1.1460600054351966)): shape (37, 800, 800)
      Valid pixels: 58986/640000 (9.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=275575, num_faces=275578
      Valid probs shape: (37, 58986)
    ✓ Random_7 (pose=(-1.651224811011192, -0.03867142539616886, -2.4087888448360295)): shape (37, 800, 800)
      Valid pixels: 74342/640000 (11.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=275575, num_faces=275578
      Valid probs shape: (37, 74342)
    ✓ Random_8 (pose=(1.7420817305884135, -0.8138769633930902, -0.31671724142167035)): shape (37, 800, 800)
      Valid pixels: 100931/640000 (15.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=11, max=275500, num_faces=275578
      Valid probs shape: (37, 100931)
    ✓ Random_9 (pose=(-2.096980232553088, 0.10137083875203112, -0.6795004168862837)): shape (37, 800, 800)
      Valid pixels: 88392/640000 (13.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2079, max=275577, num_faces=275578
      Valid probs shape: (37, 88392)
    ✓ Random_10 (pose=(2.0612835161673964, -0.14919236406411773, 3.0131501238696448)): shape (37, 800, 800)
      Valid pixels: 88501/640000 (13.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1219, max=275577, num_faces=275578
      Valid probs shape: (37, 88501)
    ✓ Random_11 (pose=(-1.560367781381577, 1.4661793546320316, -0.685891045437141)): shape (37, 800, 800)
      Valid pixels: 95434/640000 (14.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=275577, num_faces=275578
      Valid probs shape: (37, 95434)
    ✓ Random_12 (pose=(0.5879298337599899, -2.0089170003938124, -0.9375681506216491)): shape (37, 800, 800)
      Valid pixels: 64443/640000 (10.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=667, max=275477, num_faces=275578
      Valid probs shape: (37, 64443)
    ✓ Random_13 (pose=(-3.094282680681199, 0.580085888459672, -0.8931756869510652)): shape (37, 800, 800)
      Valid pixels: 61863/640000 (9.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1809, max=275576, num_faces=275578
      Valid probs shape: (37, 61863)
    ✓ Random_14 (pose=(1.2276190306951067, 2.8278193749393052, 1.4181163951369191)): shape (37, 800, 800)
      Valid pixels: 58656/640000 (9.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=887, max=275575, num_faces=275578
      Valid probs shape: (37, 58656)
    ✓ Random_15 (pose=(-1.5524851941963387, 0.3159846404354476, 1.1088632159503753)): shape (37, 800, 800)
      Valid pixels: 67167/640000 (10.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=146, max=275412, num_faces=275578
      Valid probs shape: (37, 67167)
    ✓ Random_16 (pose=(2.7571988574184907, 2.701498640429321, 0.3112570318167691)): shape (37, 800, 800)
      Valid pixels: 66610/640000 (10.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=275500, num_faces=275578
      Valid probs shape: (37, 66610)
    ✓ Random_17 (pose=(2.3145699929766748, -0.13653128133292247, 0.7420186801762223)): shape (37, 800, 800)
      Valid pixels: 62688/640000 (9.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=370, max=275577, num_faces=275578
      Valid probs shape: (37, 62688)
    ✓ Random_18 (pose=(3.0778771818112656, 0.43565019372312097, -1.2910212679896986)): shape (37, 800, 800)
      Valid pixels: 58985/640000 (9.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6242, max=275571, num_faces=275578
      Valid probs shape: (37, 58985)
    ✓ Random_19 (pose=(-1.1800896640124885, 0.14263460266533778, 1.7209038289103766)): shape (37, 800, 800)
      Valid pixels: 61739/640000 (9.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=26, max=275493, num_faces=275578
      Valid probs shape: (37, 61739)
    ✓ Random_20 (pose=(0.04022856260610341, -2.1406368179354844, -0.6523657432929859)): shape (37, 800, 800)
      Valid pixels: 64552/640000 (10.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=835, max=275571, num_faces=275578
      Valid probs shape: (37, 64552)
    ✓ Random_21 (pose=(2.5189547522397033, 0.08999360631063968, -1.5738014067131572)): shape (37, 800, 800)
      Valid pixels: 50298/640000 (7.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1171, max=275537, num_faces=275578
      Valid probs shape: (37, 50298)
    ✓ Random_22 (pose=(1.4864219586624774, -0.029703472797524277, -1.9134006868314282)): shape (37, 800, 800)
      Valid pixels: 65314/640000 (10.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=120, max=275412, num_faces=275578
      Valid probs shape: (37, 65314)
    ✓ Random_23 (pose=(0.9236075347324455, -2.075579413558282, -1.164037839417077)): shape (37, 800, 800)
      Valid pixels: 63709/640000 (10.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=666, max=275473, num_faces=275578
      Valid probs shape: (37, 63709)
    ✓ Random_24 (pose=(0.8493298883924378, 2.1928959982726433, 2.714649093942385)): shape (37, 800, 800)
      Valid pixels: 84157/640000 (13.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=769, max=275577, num_faces=275578
      Valid probs shape: (37, 84157)
    ✓ Random_25 (pose=(-2.017676638411422, -1.9887108162701628, -2.518185941512359)): shape (37, 800, 800)
      Valid pixels: 91337/640000 (14.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=275480, num_faces=275578
      Valid probs shape: (37, 91337)
    ✓ Random_26 (pose=(-1.835363659104175, 0.32081605105148325, 0.4386402525908224)): shape (37, 800, 800)
      Valid pixels: 75824/640000 (11.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=258, max=275577, num_faces=275578
      Valid probs shape: (37, 75824)
    ✓ Random_27 (pose=(-1.9714018279618295, -1.9550874576118664, -2.5432157743831754)): shape (37, 800, 800)
      Valid pixels: 91188/640000 (14.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=275477, num_faces=275578
      Valid probs shape: (37, 91188)
    ✓ Random_28 (pose=(-2.175277905447588, -1.8738248039683743, 0.44532696379555725)): shape (37, 800, 800)
      Valid pixels: 92209/640000 (14.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=2, max=275577, num_faces=275578
      Valid probs shape: (37, 92209)
    ✓ Random_29 (pose=(0.9800822445859216, -2.559098860546364, 0.2601799627859833)): shape (37, 800, 800)
      Valid pixels: 88574/640000 (13.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=45, max=275453, num_faces=275578
      Valid probs shape: (37, 88574)
    P stats: min=0.0000, max=1.0000, mean=0.0247
    Non-zero vertices: 125808/137791
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 11983  1287  1081  3446     0  1495  1055  4460  5380]
  Ground Truth Stats:
    Labels shape: (137791,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-2/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7686
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8195
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8197

  RESULTS:
  RAW:         median(top-10)=0.9027, mean(top-10)=0.9020, median(all)=0.8338, mean(all)=0.7686
  + SMOOTHING: median(top-10)=0.9178, mean(top-10)=0.9204, median(all)=0.8662, mean(all)=0.8195 [+0.0152]
  + MRF:       median(top-10)=0.9181, mean(top-10)=0.9207, median(all)=0.8665, mean(all)=0.8197 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0154

================================================================================
Subject: NKI-RS-22-20
================================================================================
  Step 0: Generating predictions with V2 model (30 random views)...
  Mesh: 140825 vertices, 281646 faces
  Generating 30 random views...
  Generating predictions for 30 views (continuous camera pose)...
    ✓ Random_0 (pose=(0.3151895266133504, -1.2057767396829207, 0.24148582007328256)): shape (37, 800, 800)
      Valid pixels: 86277/640000 (13.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=281540, num_faces=281646
      Valid probs shape: (37, 86277)
    ✓ Random_1 (pose=(2.4174602129280114, 2.0677055872403116, -2.8544618049557284)): shape (37, 800, 800)
      Valid pixels: 95071/640000 (14.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=281484, num_faces=281646
      Valid probs shape: (37, 95071)
    ✓ Random_2 (pose=(1.9118344144209365, -2.5094788906260903, 0.4562119175452848)): shape (37, 800, 800)
      Valid pixels: 77074/640000 (12.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=281553, num_faces=281646
      Valid probs shape: (37, 77074)
    ✓ Random_3 (pose=(0.21036618493795567, -1.2844013477774219, 2.7861895125715046)): shape (37, 800, 800)
      Valid pixels: 62655/640000 (9.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=281475, num_faces=281646
      Valid probs shape: (37, 62655)
    ✓ Random_4 (pose=(2.091518865856796, 1.5847366697407326, -1.8995145636429545)): shape (37, 800, 800)
      Valid pixels: 75688/640000 (11.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=14, max=281643, num_faces=281646
      Valid probs shape: (37, 75688)
    ✓ Random_5 (pose=(2.7999587020086416, -2.3680070250202436, 1.3438678629422052)): shape (37, 800, 800)
      Valid pixels: 80395/640000 (12.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=281477, num_faces=281646
      Valid probs shape: (37, 80395)
    ✓ Random_6 (pose=(2.4616326497563543, 2.499426383338789, -0.5028595330343726)): shape (37, 800, 800)
      Valid pixels: 68215/640000 (10.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=281533, num_faces=281646
      Valid probs shape: (37, 68215)
    ✓ Random_7 (pose=(-3.0158251192290337, 1.4537562138250033, 1.0846175236489373)): shape (37, 800, 800)
      Valid pixels: 103011/640000 (16.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=281623, num_faces=281646
      Valid probs shape: (37, 103011)
    ✓ Random_8 (pose=(3.022334989101851, 2.639632512510329, 2.2841279038879794)): shape (37, 800, 800)
      Valid pixels: 56129/640000 (8.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=281534, num_faces=281646
      Valid probs shape: (37, 56129)
    ✓ Random_9 (pose=(-1.9133909964612983, -0.0033837043555617896, -1.9177061521273593)): shape (37, 800, 800)
      Valid pixels: 66588/640000 (10.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=342, max=281636, num_faces=281646
      Valid probs shape: (37, 66588)
    ✓ Random_10 (pose=(1.3171488328484848, 0.7532500359330503, 2.300676463130805)): shape (37, 800, 800)
      Valid pixels: 97099/640000 (15.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=6, max=281478, num_faces=281646
      Valid probs shape: (37, 97099)
    ✓ Random_11 (pose=(2.459172800986712, -1.9101054795948214, 2.919518490552722)): shape (37, 800, 800)
      Valid pixels: 74260/640000 (11.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=18, max=281592, num_faces=281646
      Valid probs shape: (37, 74260)
    ✓ Random_12 (pose=(2.142239132796866, 3.087999954295423, -0.9965364977879774)): shape (37, 800, 800)
      Valid pixels: 76236/640000 (11.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=281540, num_faces=281646
      Valid probs shape: (37, 76236)
    ✓ Random_13 (pose=(0.3176113541182124, 0.4159816533388545, -2.2748397514134804)): shape (37, 800, 800)
      Valid pixels: 50711/640000 (7.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=280934, num_faces=281646
      Valid probs shape: (37, 50711)
    ✓ Random_14 (pose=(1.378909068122188, 1.2402554177206122, 2.4310393710349505)): shape (37, 800, 800)
      Valid pixels: 99004/640000 (15.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=28, max=281477, num_faces=281646
      Valid probs shape: (37, 99004)
    ✓ Random_15 (pose=(2.8772647410588377, -2.0019682382761266, -1.1049180033787578)): shape (37, 800, 800)
      Valid pixels: 87764/640000 (13.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=281535, num_faces=281646
      Valid probs shape: (37, 87764)
    ✓ Random_16 (pose=(-2.724508192032498, 1.598887426883799, -2.3328586776876925)): shape (37, 800, 800)
      Valid pixels: 84303/640000 (13.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=281636, num_faces=281646
      Valid probs shape: (37, 84303)
    ✓ Random_17 (pose=(0.31750759001352513, -2.0864776243829257, -0.9641405467366084)): shape (37, 800, 800)
      Valid pixels: 71061/640000 (11.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=529, max=281645, num_faces=281646
      Valid probs shape: (37, 71061)
    ✓ Random_18 (pose=(-1.446518015393874, 2.523694073456152, -0.5569367564707708)): shape (37, 800, 800)
      Valid pixels: 98265/640000 (15.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=14, max=281635, num_faces=281646
      Valid probs shape: (37, 98265)
    ✓ Random_19 (pose=(-0.11665228116187443, -1.047384026866912, -2.633445968545085)): shape (37, 800, 800)
      Valid pixels: 77049/640000 (12.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=281467, num_faces=281646
      Valid probs shape: (37, 77049)
    ✓ Random_20 (pose=(1.7718719456500267, 0.3760623087886241, 1.0812408900761685)): shape (37, 800, 800)
      Valid pixels: 71157/640000 (11.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=27, max=281535, num_faces=281646
      Valid probs shape: (37, 71157)
    ✓ Random_21 (pose=(-0.8207514158603595, 2.723192918020911, -2.3118750698713417)): shape (37, 800, 800)
      Valid pixels: 73345/640000 (11.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=400, max=281636, num_faces=281646
      Valid probs shape: (37, 73345)
    ✓ Random_22 (pose=(-1.844811495828974, -1.2610404463620433, 2.6883301017606644)): shape (37, 800, 800)
      Valid pixels: 101274/640000 (15.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=281619, num_faces=281646
      Valid probs shape: (37, 101274)
    ✓ Random_23 (pose=(-2.328985641133813, -1.3137422291434695, 2.775297108994006)): shape (37, 800, 800)
      Valid pixels: 89118/640000 (13.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=10, max=281644, num_faces=281646
      Valid probs shape: (37, 89118)
    ✓ Random_24 (pose=(2.7616995938940985, -2.7419807158450036, 1.4466329383160215)): shape (37, 800, 800)
      Valid pixels: 65182/640000 (10.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=281478, num_faces=281646
      Valid probs shape: (37, 65182)
    ✓ Random_25 (pose=(0.9556900112071869, 1.6838655389843513, 0.037153963496491915)): shape (37, 800, 800)
      Valid pixels: 78676/640000 (12.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=9, max=281535, num_faces=281646
      Valid probs shape: (37, 78676)
    ✓ Random_26 (pose=(2.2251162919618643, -2.8486989764503874, 0.2360779053093176)): shape (37, 800, 800)
      Valid pixels: 75914/640000 (11.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=281631, num_faces=281646
      Valid probs shape: (37, 75914)
    ✓ Random_27 (pose=(2.4176375379868675, 0.6223946052319, 2.994620775259052)): shape (37, 800, 800)
      Valid pixels: 85172/640000 (13.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=8748, max=281645, num_faces=281646
      Valid probs shape: (37, 85172)
    ✓ Random_28 (pose=(-2.57660419656565, -2.123429168214634, 0.43712452651469125)): shape (37, 800, 800)
      Valid pixels: 92364/640000 (14.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=281470, num_faces=281646
      Valid probs shape: (37, 92364)
    ✓ Random_29 (pose=(-1.7043851494041509, 1.9358007360365095, 2.2481799557639057)): shape (37, 800, 800)
      Valid pixels: 100040/640000 (15.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=281589, num_faces=281646
      Valid probs shape: (37, 100040)
    P stats: min=0.0000, max=0.9999, mean=0.0252
    Non-zero vertices: 131553/140825
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 9272 1135  902 3308    0 2753 1022 4710 6942]
  Ground Truth Stats:
    Labels shape: (140825,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-20/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7455
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7928
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7930

  RESULTS:
  RAW:         median(top-10)=0.8935, mean(top-10)=0.9013, median(all)=0.7951, mean(all)=0.7455
  + SMOOTHING: median(top-10)=0.9208, mean(top-10)=0.9234, median(all)=0.8279, mean(all)=0.7928 [+0.0274]
  + MRF:       median(top-10)=0.9214, mean(top-10)=0.9236, median(all)=0.8284, mean(all)=0.7930 [+0.0006]
  TOTAL IMPROVEMENT (median top-10): +0.0280

================================================================================
Subject: NKI-RS-22-21
================================================================================
  Step 0: Generating predictions with V2 model (30 random views)...
  Mesh: 138920 vertices, 277836 faces
  Generating 30 random views...
  Generating predictions for 30 views (continuous camera pose)...
    ✓ Random_0 (pose=(3.009491150276509, 1.8611409112162676, -2.0207124214692542)): shape (37, 800, 800)
      Valid pixels: 85701/640000 (13.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8, max=277216, num_faces=277836
      Valid probs shape: (37, 85701)
    ✓ Random_1 (pose=(1.361662906621497, -0.9176312589543776, 1.6278351383723306)): shape (37, 800, 800)
      Valid pixels: 56284/640000 (8.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=14, max=277817, num_faces=277836
      Valid probs shape: (37, 56284)
    ✓ Random_2 (pose=(2.2281853786639934, -1.5698841692711063, -0.4254610289031655)): shape (37, 800, 800)
      Valid pixels: 85156/640000 (13.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=54, max=277829, num_faces=277836
      Valid probs shape: (37, 85156)
    ✓ Random_3 (pose=(3.054006641417553, 2.899870642220728, -0.6701969092813189)): shape (37, 800, 800)
      Valid pixels: 42367/640000 (6.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=277835, num_faces=277836
      Valid probs shape: (37, 42367)
    ✓ Random_4 (pose=(-2.3814248996663925, -2.109302153943992, 0.03883256202530738)): shape (37, 800, 800)
      Valid pixels: 82944/640000 (13.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=277103, num_faces=277836
      Valid probs shape: (37, 82944)
    ✓ Random_5 (pose=(2.4608678567648026, -2.0357769257312297, 2.9002140306704387)): shape (37, 800, 800)
      Valid pixels: 66621/640000 (10.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=8, max=277824, num_faces=277836
      Valid probs shape: (37, 66621)
    ✓ Random_6 (pose=(-0.4481689703121159, -0.8654651554949564, 0.28232706068132796)): shape (37, 800, 800)
      Valid pixels: 55195/640000 (8.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=277834, num_faces=277836
      Valid probs shape: (37, 55195)
    ✓ Random_7 (pose=(-0.3653930255629083, -3.0883934686930585, -2.076081074943035)): shape (37, 800, 800)
      Valid pixels: 43208/640000 (6.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=572, max=277835, num_faces=277836
      Valid probs shape: (37, 43208)
    ✓ Random_8 (pose=(-1.4299926620221781, 2.1103135335416967, 2.6374000711974412)): shape (37, 800, 800)
      Valid pixels: 93169/640000 (14.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=277830, num_faces=277836
      Valid probs shape: (37, 93169)
    ✓ Random_9 (pose=(-2.7735808039989185, -1.4859214716732876, -0.8259721562885529)): shape (37, 800, 800)
      Valid pixels: 62421/640000 (9.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7, max=277830, num_faces=277836
      Valid probs shape: (37, 62421)
    ✓ Random_10 (pose=(-1.6152121841594098, 1.0550855277827482, 0.8465135442943099)): shape (37, 800, 800)
      Valid pixels: 66028/640000 (10.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=322, max=277834, num_faces=277836
      Valid probs shape: (37, 66028)
    ✓ Random_11 (pose=(-0.03902213886982819, 0.9057818844132077, -3.051434630344192)): shape (37, 800, 800)
      Valid pixels: 54713/640000 (8.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=277834, num_faces=277836
      Valid probs shape: (37, 54713)
    ✓ Random_12 (pose=(-0.43586985888217633, -0.4745765210280011, 0.8731678862636283)): shape (37, 800, 800)
      Valid pixels: 47936/640000 (7.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=277834, num_faces=277836
      Valid probs shape: (37, 47936)
    ✓ Random_13 (pose=(1.145958195529028, 2.7721623446018615, 2.179136355659632)): shape (37, 800, 800)
      Valid pixels: 85056/640000 (13.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1094, max=277591, num_faces=277836
      Valid probs shape: (37, 85056)
    ✓ Random_14 (pose=(2.935679053006634, 1.0193108103368598, 0.4852501335878521)): shape (37, 800, 800)
      Valid pixels: 77743/640000 (12.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=133, max=277835, num_faces=277836
      Valid probs shape: (37, 77743)
    ✓ Random_15 (pose=(-2.5661329989656023, -1.714914597968474, 2.1532436118598977)): shape (37, 800, 800)
      Valid pixels: 62983/640000 (9.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=95, max=277834, num_faces=277836
      Valid probs shape: (37, 62983)
    ✓ Random_16 (pose=(-0.6747841242680455, 2.242489987597068, -2.3528296876197516)): shape (37, 800, 800)
      Valid pixels: 79216/640000 (12.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=57, max=277831, num_faces=277836
      Valid probs shape: (37, 79216)
    ✓ Random_17 (pose=(3.0720440937148137, -0.32178257143538724, -0.9445253492701475)): shape (37, 800, 800)
      Valid pixels: 44091/640000 (6.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=535, max=277835, num_faces=277836
      Valid probs shape: (37, 44091)
    ✓ Random_18 (pose=(-0.336429382410258, 1.0972175295458504, -0.6170732026747703)): shape (37, 800, 800)
      Valid pixels: 54689/640000 (8.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=23, max=277830, num_faces=277836
      Valid probs shape: (37, 54689)
    ✓ Random_19 (pose=(-1.886908535638986, -1.7454578510815257, 0.5463752765588152)): shape (37, 800, 800)
      Valid pixels: 77576/640000 (12.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=13, max=277834, num_faces=277836
      Valid probs shape: (37, 77576)
    ✓ Random_20 (pose=(2.989034100593808, -3.13999782968034, 3.1013414077885084)): shape (37, 800, 800)
      Valid pixels: 41506/640000 (6.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=277574, num_faces=277836
      Valid probs shape: (37, 41506)
    ✓ Random_21 (pose=(1.6543747256455, -1.7861697076876273, 0.9892945226167003)): shape (37, 800, 800)
      Valid pixels: 63018/640000 (9.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=277831, num_faces=277836
      Valid probs shape: (37, 63018)
    ✓ Random_22 (pose=(-3.050461733006628, 0.5139263314585079, 3.014381639906988)): shape (37, 800, 800)
      Valid pixels: 46295/640000 (7.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=539, max=277835, num_faces=277836
      Valid probs shape: (37, 46295)
    ✓ Random_23 (pose=(-2.0281223040182104, 1.8003475112841576, 0.7951200891029879)): shape (37, 800, 800)
      Valid pixels: 62161/640000 (9.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=152, max=277834, num_faces=277836
      Valid probs shape: (37, 62161)
    ✓ Random_24 (pose=(0.4624935011430291, 1.0976179661107741, -1.1347086294927706)): shape (37, 800, 800)
      Valid pixels: 86909/640000 (13.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=12, max=277829, num_faces=277836
      Valid probs shape: (37, 86909)
    ✓ Random_25 (pose=(-0.2937780587116743, -1.5021409734530062, -0.3140402955462709)): shape (37, 800, 800)
      Valid pixels: 65113/640000 (10.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=239, max=277833, num_faces=277836
      Valid probs shape: (37, 65113)
    ✓ Random_26 (pose=(-1.6754790609975574, 2.400530447733315, -2.6916062030269168)): shape (37, 800, 800)
      Valid pixels: 75581/640000 (11.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=8, max=277833, num_faces=277836
      Valid probs shape: (37, 75581)
    ✓ Random_27 (pose=(0.24863073086997955, -2.0566626010908795, 2.329974333530881)): shape (37, 800, 800)
      Valid pixels: 61456/640000 (9.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=277817, num_faces=277836
      Valid probs shape: (37, 61456)
    ✓ Random_28 (pose=(2.7522955734383006, -3.041389659066486, 1.3753248339413533)): shape (37, 800, 800)
      Valid pixels: 41079/640000 (6.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=277002, num_faces=277836
      Valid probs shape: (37, 41079)
    ✓ Random_29 (pose=(2.0850388488881135, -0.01536468449221351, -0.7484350218896392)): shape (37, 800, 800)
      Valid pixels: 81159/640000 (12.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=277835, num_faces=277836
      Valid probs shape: (37, 81159)
    P stats: min=0.0000, max=1.0000, mean=0.0247
    Non-zero vertices: 126986/138920
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 11934  1256  1322  3420     0  2673   944  5253  5909]
  Ground Truth Stats:
    Labels shape: (138920,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-21/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7638
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8255
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8257

  RESULTS:
  RAW:         median(top-10)=0.8836, mean(top-10)=0.8841, median(all)=0.8219, mean(all)=0.7638
  + SMOOTHING: median(top-10)=0.9124, mean(top-10)=0.9141, median(all)=0.8700, mean(all)=0.8255 [+0.0287]
  + MRF:       median(top-10)=0.9124, mean(top-10)=0.9142, median(all)=0.8713, mean(all)=0.8257 [+0.0000]
  TOTAL IMPROVEMENT (median top-10): +0.0288

================================================================================
Subject: NKI-RS-22-22
================================================================================
  Step 0: Generating predictions with V2 model (30 random views)...
  Mesh: 129976 vertices, 259948 faces
  Generating 30 random views...
  Generating predictions for 30 views (continuous camera pose)...
    ✓ Random_0 (pose=(-1.1585010225349333, 1.3856216017419074, -2.520597143989672)): shape (37, 800, 800)
      Valid pixels: 83907/640000 (13.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=10, max=259946, num_faces=259948
      Valid probs shape: (37, 83907)
    ✓ Random_1 (pose=(-1.8580957800136622, 1.3926543934094724, -0.3244541860451893)): shape (37, 800, 800)
      Valid pixels: 83439/640000 (13.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=259944, num_faces=259948
      Valid probs shape: (37, 83439)
    ✓ Random_2 (pose=(-0.01545179478407599, 0.8619754691774402, 2.354635209294745)): shape (37, 800, 800)
      Valid pixels: 58649/640000 (9.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=259888, num_faces=259948
      Valid probs shape: (37, 58649)
    ✓ Random_3 (pose=(-1.9869392896840317, -0.8024672298381414, -1.713530136846195)): shape (37, 800, 800)
      Valid pixels: 64841/640000 (10.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=53, max=259938, num_faces=259948
      Valid probs shape: (37, 64841)
    ✓ Random_4 (pose=(2.9303807812340477, 1.4678649857887507, 2.4272927353531317)): shape (37, 800, 800)
      Valid pixels: 66166/640000 (10.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=57, max=259850, num_faces=259948
      Valid probs shape: (37, 66166)
    ✓ Random_5 (pose=(2.38238884592646, -1.882049310795364, 2.5707686509157854)): shape (37, 800, 800)
      Valid pixels: 75028/640000 (11.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8, max=259943, num_faces=259948
      Valid probs shape: (37, 75028)
    ✓ Random_6 (pose=(0.8333682594799741, -0.7435174011252097, -1.819127954299817)): shape (37, 800, 800)
      Valid pixels: 62868/640000 (9.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=3, max=259888, num_faces=259948
      Valid probs shape: (37, 62868)
    ✓ Random_7 (pose=(1.4316491215728684, -0.32176896863538706, 2.9535539634566828)): shape (37, 800, 800)
      Valid pixels: 85864/640000 (13.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=8, max=259806, num_faces=259948
      Valid probs shape: (37, 85864)
    ✓ Random_8 (pose=(2.587673652493761, -0.6974179279058905, 2.7417846693883527)): shape (37, 800, 800)
      Valid pixels: 68995/640000 (10.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7054, max=259944, num_faces=259948
      Valid probs shape: (37, 68995)
    ✓ Random_9 (pose=(-2.257743197106889, 0.9939615049119164, -3.1337882026738186)): shape (37, 800, 800)
      Valid pixels: 70985/640000 (11.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=53, max=259945, num_faces=259948
      Valid probs shape: (37, 70985)
    ✓ Random_10 (pose=(2.5030624363022937, 3.119229246530554, 0.5365518684347128)): shape (37, 800, 800)
      Valid pixels: 59443/640000 (9.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=259934, num_faces=259948
      Valid probs shape: (37, 59443)
    ✓ Random_11 (pose=(-0.04728739352362066, 2.7610698946755132, -1.4361978501148769)): shape (37, 800, 800)
      Valid pixels: 48534/640000 (7.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=475, max=259947, num_faces=259948
      Valid probs shape: (37, 48534)
    ✓ Random_12 (pose=(1.530417861950288, -2.509193703538106, 1.709439663889361)): shape (37, 800, 800)
      Valid pixels: 64201/640000 (10.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=20, max=258567, num_faces=259948
      Valid probs shape: (37, 64201)
    ✓ Random_13 (pose=(-1.879213512317711, 1.9733176615694408, -1.1792976124603378)): shape (37, 800, 800)
      Valid pixels: 85392/640000 (13.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8, max=258567, num_faces=259948
      Valid probs shape: (37, 85392)
    ✓ Random_14 (pose=(-0.05864711347299423, -2.3909169484148367, 1.674328954924989)): shape (37, 800, 800)
      Valid pixels: 66959/640000 (10.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=439, max=259946, num_faces=259948
      Valid probs shape: (37, 66959)
    ✓ Random_15 (pose=(-2.992150007613423, 2.785817147879241, -0.7969907969868788)): shape (37, 800, 800)
      Valid pixels: 51165/640000 (8.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=259733, num_faces=259948
      Valid probs shape: (37, 51165)
    ✓ Random_16 (pose=(-1.0710670448599457, 1.8832758672533094, -1.043019767749028)): shape (37, 800, 800)
      Valid pixels: 61623/640000 (9.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=108, max=258561, num_faces=259948
      Valid probs shape: (37, 61623)
    ✓ Random_17 (pose=(-1.764419816168901, -0.08547149997711223, 1.2176766998240582)): shape (37, 800, 800)
      Valid pixels: 65388/640000 (10.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=44, max=259946, num_faces=259948
      Valid probs shape: (37, 65388)
    ✓ Random_18 (pose=(1.425478105473779, 2.4882174253103644, 0.19480725556765366)): shape (37, 800, 800)
      Valid pixels: 81487/640000 (12.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=29, max=259946, num_faces=259948
      Valid probs shape: (37, 81487)
    ✓ Random_19 (pose=(1.831519668444062, -1.7249090862190606, 1.178862694689963)): shape (37, 800, 800)
      Valid pixels: 59930/640000 (9.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=31, max=259036, num_faces=259948
      Valid probs shape: (37, 59930)
    ✓ Random_20 (pose=(-2.9488537056104986, 0.5716026699155026, -2.463467202229549)): shape (37, 800, 800)
      Valid pixels: 58751/640000 (9.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=17983, max=259947, num_faces=259948
      Valid probs shape: (37, 58751)
    ✓ Random_21 (pose=(0.9347675911339755, -2.8486141685138677, -3.0340557481001786)): shape (37, 800, 800)
      Valid pixels: 78968/640000 (12.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2561, max=259944, num_faces=259948
      Valid probs shape: (37, 78968)
    ✓ Random_22 (pose=(-1.5837485555307553, 1.6193682070500195, 2.8478934816031867)): shape (37, 800, 800)
      Valid pixels: 93438/640000 (14.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=17, max=259946, num_faces=259948
      Valid probs shape: (37, 93438)
    ✓ Random_23 (pose=(0.7335623526042174, -2.8542914055056836, 2.3181433541848175)): shape (37, 800, 800)
      Valid pixels: 66402/640000 (10.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=17698, max=259947, num_faces=259948
      Valid probs shape: (37, 66402)
    ✓ Random_24 (pose=(2.7861567955995357, -2.439464503308069, -1.993321061139028)): shape (37, 800, 800)
      Valid pixels: 65619/640000 (10.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=259946, num_faces=259948
      Valid probs shape: (37, 65619)
    ✓ Random_25 (pose=(-1.672358950670149, -3.0697217066313565, -1.3228174520275424)): shape (37, 800, 800)
      Valid pixels: 70251/640000 (11.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=8, max=258567, num_faces=259948
      Valid probs shape: (37, 70251)
    ✓ Random_26 (pose=(3.0249339581825687, -2.656332621124279, -1.6339397935423148)): shape (37, 800, 800)
      Valid pixels: 58364/640000 (9.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=259945, num_faces=259948
      Valid probs shape: (37, 58364)
    ✓ Random_27 (pose=(-0.08278249602776144, -2.740025635469455, -0.1914195881642673)): shape (37, 800, 800)
      Valid pixels: 47699/640000 (7.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5085, max=259947, num_faces=259948
      Valid probs shape: (37, 47699)
    ✓ Random_28 (pose=(1.325562494223182, -2.442797796202692, -1.8036301655568827)): shape (37, 800, 800)
      Valid pixels: 65690/640000 (10.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=241, max=259946, num_faces=259948
      Valid probs shape: (37, 65690)
    ✓ Random_29 (pose=(-0.5515461549375194, 0.9618769621342862, 2.488156967687619)): shape (37, 800, 800)
      Valid pixels: 57612/640000 (9.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=259946, num_faces=259948
      Valid probs shape: (37, 57612)
    P stats: min=0.0000, max=0.9999, mean=0.0254
    Non-zero vertices: 122264/129976
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 7712 1203  885 3292    0 1816 1120 4415 5591]
  Ground Truth Stats:
    Labels shape: (129976,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-22/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7800
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8307
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8306

  RESULTS:
  RAW:         median(top-10)=0.9132, mean(top-10)=0.9101, median(all)=0.8355, mean(all)=0.7800
  + SMOOTHING: median(top-10)=0.9268, mean(top-10)=0.9294, median(all)=0.8799, mean(all)=0.8307 [+0.0137]
  + MRF:       median(top-10)=0.9271, mean(top-10)=0.9295, median(all)=0.8803, mean(all)=0.8306 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0139

================================================================================
Subject: NKI-RS-22-3
================================================================================
  Step 0: Generating predictions with V2 model (30 random views)...
  Mesh: 136714 vertices, 273424 faces
  Generating 30 random views...
  Generating predictions for 30 views (continuous camera pose)...
    ✓ Random_0 (pose=(-2.826266210875954, -3.1175696183413573, 2.474321808062066)): shape (37, 800, 800)
      Valid pixels: 55520/640000 (8.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=273411, num_faces=273424
      Valid probs shape: (37, 55520)
    ✓ Random_1 (pose=(1.9280546859630991, 2.7456936459929597, -0.13299233506370367)): shape (37, 800, 800)
      Valid pixels: 102358/640000 (16.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=273419, num_faces=273424
      Valid probs shape: (37, 102358)
    ✓ Random_2 (pose=(-1.3541362816878177, -2.250084445471191, 2.083725024154523)): shape (37, 800, 800)
      Valid pixels: 95281/640000 (14.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=273422, num_faces=273424
      Valid probs shape: (37, 95281)
    ✓ Random_3 (pose=(-0.32962226459834465, 1.4618671106998873, 1.0358185524172407)): shape (37, 800, 800)
      Valid pixels: 98874/640000 (15.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=11, max=273373, num_faces=273424
      Valid probs shape: (37, 98874)
    ✓ Random_4 (pose=(2.433662669442077, -1.9297362035579626, 3.0883023468867714)): shape (37, 800, 800)
      Valid pixels: 77908/640000 (12.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=6, max=273372, num_faces=273424
      Valid probs shape: (37, 77908)
    ✓ Random_5 (pose=(-1.4062592928551303, 2.41280081345729, 0.9790698416955568)): shape (37, 800, 800)
      Valid pixels: 78255/640000 (12.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=107, max=273373, num_faces=273424
      Valid probs shape: (37, 78255)
    ✓ Random_6 (pose=(0.8505992347142897, 1.3855454090692607, 0.5573339646941871)): shape (37, 800, 800)
      Valid pixels: 69319/640000 (10.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=273419, num_faces=273424
      Valid probs shape: (37, 69319)
    ✓ Random_7 (pose=(1.0539771554995703, 2.5335857423654184, -2.0821863256977555)): shape (37, 800, 800)
      Valid pixels: 69342/640000 (10.8%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=95, max=273373, num_faces=273424
      Valid probs shape: (37, 69342)
    ✓ Random_8 (pose=(0.10360797996250692, -3.1381005791599605, 1.4891596273553898)): shape (37, 800, 800)
      Valid pixels: 47096/640000 (7.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=93667, max=273422, num_faces=273424
      Valid probs shape: (37, 47096)
    ✓ Random_9 (pose=(1.1747114138241246, 0.8140730454792844, 1.1981201168446205)): shape (37, 800, 800)
      Valid pixels: 63946/640000 (10.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=273411, num_faces=273424
      Valid probs shape: (37, 63946)
    ✓ Random_10 (pose=(2.46057069893589, 0.08026187334229373, 2.738537435985652)): shape (37, 800, 800)
      Valid pixels: 82357/640000 (12.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=28882, max=273373, num_faces=273424
      Valid probs shape: (37, 82357)
    ✓ Random_11 (pose=(-1.2444953370339191, 2.5423403196243575, -0.6526788819834928)): shape (37, 800, 800)
      Valid pixels: 93757/640000 (14.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=251, max=273373, num_faces=273424
      Valid probs shape: (37, 93757)
    ✓ Random_12 (pose=(-2.538364850949078, 2.494217472057321, -2.807014312668347)): shape (37, 800, 800)
      Valid pixels: 63535/640000 (9.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=273419, num_faces=273424
      Valid probs shape: (37, 63535)
    ✓ Random_13 (pose=(-0.4891691357570296, -0.527221371483479, -1.4268282598481508)): shape (37, 800, 800)
      Valid pixels: 72762/640000 (11.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=0, max=272264, num_faces=273424
      Valid probs shape: (37, 72762)
    ✓ Random_14 (pose=(0.35944947862011567, -0.8723635187262833, 0.48483523236503556)): shape (37, 800, 800)
      Valid pixels: 86051/640000 (13.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=273419, num_faces=273424
      Valid probs shape: (37, 86051)
    ✓ Random_15 (pose=(2.35882429543768, 2.484971284272093, -0.029808502612672427)): shape (37, 800, 800)
      Valid pixels: 89761/640000 (14.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=273419, num_faces=273424
      Valid probs shape: (37, 89761)
    ✓ Random_16 (pose=(-1.8791227104224293, 0.14929244178374557, -0.6192150474358238)): shape (37, 800, 800)
      Valid pixels: 97696/640000 (15.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=247, max=273373, num_faces=273424
      Valid probs shape: (37, 97696)
    ✓ Random_17 (pose=(-0.9402678781960718, 3.0332661040784696, -0.13716980395888756)): shape (37, 800, 800)
      Valid pixels: 91762/640000 (14.3%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=3523, max=273373, num_faces=273424
      Valid probs shape: (37, 91762)
    ✓ Random_18 (pose=(-0.22884225406181535, -2.494297197209568, 2.2388716452239743)): shape (37, 800, 800)
      Valid pixels: 70863/640000 (11.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=799, max=273423, num_faces=273424
      Valid probs shape: (37, 70863)
    ✓ Random_19 (pose=(-1.8449007759448786, 0.9877345817000753, -1.2546088344586241)): shape (37, 800, 800)
      Valid pixels: 88347/640000 (13.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=14, max=273373, num_faces=273424
      Valid probs shape: (37, 88347)
    ✓ Random_20 (pose=(-2.8422482510951235, -0.5325384754947708, -2.2090567073882528)): shape (37, 800, 800)
      Valid pixels: 68989/640000 (10.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=769, max=273423, num_faces=273424
      Valid probs shape: (37, 68989)
    ✓ Random_21 (pose=(0.023357566047838674, 0.9569201478377494, -2.253955578820249)): shape (37, 800, 800)
      Valid pixels: 86593/640000 (13.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=273419, num_faces=273424
      Valid probs shape: (37, 86593)
    ✓ Random_22 (pose=(2.1720678341578505, -1.009237114176032, 2.1657461749394384)): shape (37, 800, 800)
      Valid pixels: 98807/640000 (15.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=34, max=273373, num_faces=273424
      Valid probs shape: (37, 98807)
    ✓ Random_23 (pose=(3.1075332737864, -0.2937349417376556, -1.8689801898868226)): shape (37, 800, 800)
      Valid pixels: 50824/640000 (7.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6748, max=273422, num_faces=273424
      Valid probs shape: (37, 50824)
    ✓ Random_24 (pose=(-2.4558922954242974, -2.1514751802782546, -1.073912065996788)): shape (37, 800, 800)
      Valid pixels: 65325/640000 (10.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=273419, num_faces=273424
      Valid probs shape: (37, 65325)
    ✓ Random_25 (pose=(-2.100250231052409, 2.220311846977914, -1.7051009121954277)): shape (37, 800, 800)
      Valid pixels: 74757/640000 (11.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=12, max=272263, num_faces=273424
      Valid probs shape: (37, 74757)
    ✓ Random_26 (pose=(-1.224183092841698, 2.872326518645181, 1.9072692011351888)): shape (37, 800, 800)
      Valid pixels: 73052/640000 (11.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=149, max=273422, num_faces=273424
      Valid probs shape: (37, 73052)
    ✓ Random_27 (pose=(-2.330685018371944, -2.8226548542893792, -2.6355275542566847)): shape (37, 800, 800)
      Valid pixels: 81211/640000 (12.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=273419, num_faces=273424
      Valid probs shape: (37, 81211)
    ✓ Random_28 (pose=(1.128020415411366, 1.4560742011250323, -2.9932607110372396)): shape (37, 800, 800)
      Valid pixels: 82640/640000 (12.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=12, max=273372, num_faces=273424
      Valid probs shape: (37, 82640)
    ✓ Random_29 (pose=(2.6591746025417304, 1.1042471132193343, -2.5991210432343523)): shape (37, 800, 800)
      Valid pixels: 96561/640000 (15.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=387, max=273373, num_faces=273424
      Valid probs shape: (37, 96561)
    P stats: min=0.0000, max=0.9999, mean=0.0251
    Non-zero vertices: 126858/136714
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 9856 1458 1144 3518    0 2461  894 4804 7310]
  Ground Truth Stats:
    Labels shape: (136714,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-3/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7676
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8078
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8080

  RESULTS:
  RAW:         median(top-10)=0.9005, mean(top-10)=0.8993, median(all)=0.8350, mean(all)=0.7676
  + SMOOTHING: median(top-10)=0.9170, mean(top-10)=0.9209, median(all)=0.8562, mean(all)=0.8078 [+0.0166]
  + MRF:       median(top-10)=0.9172, mean(top-10)=0.9212, median(all)=0.8566, mean(all)=0.8080 [+0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0167

================================================================================
Subject: NKI-RS-22-4
================================================================================
  Step 0: Generating predictions with V2 model (30 random views)...
  Mesh: 169171 vertices, 338338 faces
  Generating 30 random views...
  Generating predictions for 30 views (continuous camera pose)...
    ✓ Random_0 (pose=(-0.7211242080613731, -2.985255022087863, 2.025315716759553)): shape (37, 800, 800)
      Valid pixels: 61125/640000 (9.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=555, max=338337, num_faces=338338
      Valid probs shape: (37, 61125)
    ✓ Random_1 (pose=(-0.7599821326275329, -2.510072628238677, 2.1147768996602707)): shape (37, 800, 800)
      Valid pixels: 80244/640000 (12.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=522, max=338337, num_faces=338338
      Valid probs shape: (37, 80244)
    ✓ Random_2 (pose=(1.044268318985777, 0.4436269152514818, 1.688089449381124)): shape (37, 800, 800)
      Valid pixels: 68061/640000 (10.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=338267, num_faces=338338
      Valid probs shape: (37, 68061)
    ✓ Random_3 (pose=(-1.4223310368302822, 2.2005185606767297, -2.703312715014631)): shape (37, 800, 800)
      Valid pixels: 86191/640000 (13.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=338337, num_faces=338338
      Valid probs shape: (37, 86191)
    ✓ Random_4 (pose=(2.6248809433629186, -2.6233108375045644, 2.1918342923413396)): shape (37, 800, 800)
      Valid pixels: 66219/640000 (10.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=337453, num_faces=338338
      Valid probs shape: (37, 66219)
    ✓ Random_5 (pose=(-2.380566448786457, -1.0141255896202925, 2.704009483458658)): shape (37, 800, 800)
      Valid pixels: 72273/640000 (11.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=199, max=338337, num_faces=338338
      Valid probs shape: (37, 72273)
    ✓ Random_6 (pose=(0.8777435021983546, 2.397619090708228, 2.742892479126345)): shape (37, 800, 800)
      Valid pixels: 86055/640000 (13.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=526, max=338336, num_faces=338338
      Valid probs shape: (37, 86055)
    ✓ Random_7 (pose=(1.5670977989323305, 1.8927127505659964, -2.279487962728889)): shape (37, 800, 800)
      Valid pixels: 70548/640000 (11.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=25, max=338334, num_faces=338338
      Valid probs shape: (37, 70548)
    ✓ Random_8 (pose=(1.3652932513760359, 1.4886441291011367, -2.866970269126117)): shape (37, 800, 800)
      Valid pixels: 77532/640000 (12.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=22, max=338334, num_faces=338338
      Valid probs shape: (37, 77532)
    ✓ Random_9 (pose=(2.6992788264711036, 2.6823344062584438, -3.10334034931458)): shape (37, 800, 800)
      Valid pixels: 60587/640000 (9.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=338090, num_faces=338338
      Valid probs shape: (37, 60587)
    ✓ Random_10 (pose=(-2.7638658930348106, -0.08781927437695636, -2.6095722158350463)): shape (37, 800, 800)
      Valid pixels: 49729/640000 (7.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=886, max=338337, num_faces=338338
      Valid probs shape: (37, 49729)
    ✓ Random_11 (pose=(2.325220595103418, -0.11175489018745477, -1.4805308082269257)): shape (37, 800, 800)
      Valid pixels: 52490/640000 (8.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=569, max=338337, num_faces=338338
      Valid probs shape: (37, 52490)
    ✓ Random_12 (pose=(1.4554898269971472, 1.6552983855796608, -2.5090971527889296)): shape (37, 800, 800)
      Valid pixels: 72644/640000 (11.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=25, max=338334, num_faces=338338
      Valid probs shape: (37, 72644)
    ✓ Random_13 (pose=(-3.138575370813049, 2.7774270031718338, -2.7539560516610044)): shape (37, 800, 800)
      Valid pixels: 44858/640000 (7.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=337369, num_faces=338338
      Valid probs shape: (37, 44858)
    ✓ Random_14 (pose=(0.45354729059614884, 2.7963063567437825, -0.1946941383211307)): shape (37, 800, 800)
      Valid pixels: 56399/640000 (8.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=864, max=338337, num_faces=338338
      Valid probs shape: (37, 56399)
    ✓ Random_15 (pose=(1.4403647527913623, 0.953784782170441, -1.2949295656044744)): shape (37, 800, 800)
      Valid pixels: 80446/640000 (12.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=25, max=338209, num_faces=338338
      Valid probs shape: (37, 80446)
    ✓ Random_16 (pose=(2.0338659308277407, 2.5523194288530817, -0.40162588802923826)): shape (37, 800, 800)
      Valid pixels: 93539/640000 (14.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=16, max=338329, num_faces=338338
      Valid probs shape: (37, 93539)
    ✓ Random_17 (pose=(-1.7354141573200026, 0.957652242393503, -0.0066025317550648666)): shape (37, 800, 800)
      Valid pixels: 87099/640000 (13.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=23, max=338334, num_faces=338338
      Valid probs shape: (37, 87099)
    ✓ Random_18 (pose=(0.8286324854108718, -0.02176339587690812, -2.525562314681898)): shape (37, 800, 800)
      Valid pixels: 62542/640000 (9.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=10, max=337570, num_faces=338338
      Valid probs shape: (37, 62542)
    ✓ Random_19 (pose=(-2.05862052956864, 1.5538150206138912, 1.4150540715010367)): shape (37, 800, 800)
      Valid pixels: 77256/640000 (12.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=23, max=338205, num_faces=338338
      Valid probs shape: (37, 77256)
    ✓ Random_20 (pose=(-0.9531202059185171, -1.0812522479176527, 0.040350431578237256)): shape (37, 800, 800)
      Valid pixels: 72636/640000 (11.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=0, max=338152, num_faces=338338
      Valid probs shape: (37, 72636)
    ✓ Random_21 (pose=(3.120540068460868, 2.5804011456255633, -1.9577898117988877)): shape (37, 800, 800)
      Valid pixels: 59568/640000 (9.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=337453, num_faces=338338
      Valid probs shape: (37, 59568)
    ✓ Random_22 (pose=(-1.7874119703958624, -2.2730823711927663, 1.3099052079928493)): shape (37, 800, 800)
      Valid pixels: 65208/640000 (10.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=22, max=338152, num_faces=338338
      Valid probs shape: (37, 65208)
    ✓ Random_23 (pose=(-2.8104065747441958, -2.5560921139657014, -0.7516736801877926)): shape (37, 800, 800)
      Valid pixels: 46079/640000 (7.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=338207, num_faces=338338
      Valid probs shape: (37, 46079)
    ✓ Random_24 (pose=(-2.7213803267252166, -2.565938918567479, -0.06947029995251919)): shape (37, 800, 800)
      Valid pixels: 59489/640000 (9.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=338090, num_faces=338338
      Valid probs shape: (37, 59489)
    ✓ Random_25 (pose=(1.4147436195638878, -2.0386891167204206, -2.818664046222369)): shape (37, 800, 800)
      Valid pixels: 85727/640000 (13.4%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=30, max=338334, num_faces=338338
      Valid probs shape: (37, 85727)
    ✓ Random_26 (pose=(0.9973818259292395, -2.8881272011255357, 0.7948187514658742)): shape (37, 800, 800)
      Valid pixels: 69921/640000 (10.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=322, max=338337, num_faces=338338
      Valid probs shape: (37, 69921)
    ✓ Random_27 (pose=(2.8158438873206384, -1.6011445215960303, 1.8691029725076733)): shape (37, 800, 800)
      Valid pixels: 89593/640000 (14.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=29, max=338334, num_faces=338338
      Valid probs shape: (37, 89593)
    ✓ Random_28 (pose=(1.6223211868833243, 0.24534371135626998, 1.7061731590957114)): shape (37, 800, 800)
      Valid pixels: 64634/640000 (10.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=20, max=338294, num_faces=338338
      Valid probs shape: (37, 64634)
    ✓ Random_29 (pose=(-2.0223113358790776, 3.097012969715692, -0.17206839561628984)): shape (37, 800, 800)
      Valid pixels: 81307/640000 (12.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=11, max=338099, num_faces=338338
      Valid probs shape: (37, 81307)
    P stats: min=0.0000, max=0.9999, mean=0.0247
    Non-zero vertices: 154717/169171
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 14454  1459  1149  3870     0  2951  1187  5406  7998]
  Ground Truth Stats:
    Labels shape: (169171,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-4/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7445
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8149
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8156

  RESULTS:
  RAW:         median(top-10)=0.8794, mean(top-10)=0.8825, median(all)=0.8061, mean(all)=0.7445
  + SMOOTHING: median(top-10)=0.9150, mean(top-10)=0.9156, median(all)=0.8377, mean(all)=0.8149 [+0.0356]
  + MRF:       median(top-10)=0.9157, mean(top-10)=0.9161, median(all)=0.8382, mean(all)=0.8156 [+0.0008]
  TOTAL IMPROVEMENT (median top-10): +0.0363

================================================================================
Subject: NKI-RS-22-5
================================================================================
  Step 0: Generating predictions with V2 model (30 random views)...
  Mesh: 138967 vertices, 277930 faces
  Generating 30 random views...
  Generating predictions for 30 views (continuous camera pose)...
    ✓ Random_0 (pose=(2.697160042597445, 1.3186115159595042, -1.7841813014471026)): shape (37, 800, 800)
      Valid pixels: 81979/640000 (12.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=52, max=277928, num_faces=277930
      Valid probs shape: (37, 81979)
    ✓ Random_1 (pose=(2.158599480923791, -2.523201588735579, -1.4056039456509535)): shape (37, 800, 800)
      Valid pixels: 81493/640000 (12.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=10, max=277915, num_faces=277930
      Valid probs shape: (37, 81493)
    ✓ Random_2 (pose=(1.1794577624609124, 2.24917087270879, -0.4294897367978856)): shape (37, 800, 800)
      Valid pixels: 92302/640000 (14.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=277929, num_faces=277930
      Valid probs shape: (37, 92302)
    ✓ Random_3 (pose=(-0.9990590819927307, -1.3044276843073463, 2.1260278060830267)): shape (37, 800, 800)
      Valid pixels: 97118/640000 (15.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=277929, num_faces=277930
      Valid probs shape: (37, 97118)
    ✓ Random_4 (pose=(-0.015556786121913913, -2.7938231374413056, 1.963464532365748)): shape (37, 800, 800)
      Valid pixels: 46036/640000 (7.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3585, max=277915, num_faces=277930
      Valid probs shape: (37, 46036)
    ✓ Random_5 (pose=(0.7399677786232632, -3.076000861391606, -0.074352063772408)): shape (37, 800, 800)
      Valid pixels: 65289/640000 (10.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1157, max=277929, num_faces=277930
      Valid probs shape: (37, 65289)
    ✓ Random_6 (pose=(-1.9624332324739147, -0.26537320036355894, 0.8663646181607207)): shape (37, 800, 800)
      Valid pixels: 70018/640000 (10.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=883, max=277928, num_faces=277930
      Valid probs shape: (37, 70018)
    ✓ Random_7 (pose=(-2.4654804635057785, 0.3735234286378786, 1.1901988859839774)): shape (37, 800, 800)
      Valid pixels: 50470/640000 (7.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2247, max=277926, num_faces=277930
      Valid probs shape: (37, 50470)
    ✓ Random_8 (pose=(2.8158323266926795, 1.2880882608221418, 0.9645619736398192)): shape (37, 800, 800)
      Valid pixels: 92855/640000 (14.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=277928, num_faces=277930
      Valid probs shape: (37, 92855)
    ✓ Random_9 (pose=(-2.337612375350003, -0.39302662115193376, -1.2513326902858701)): shape (37, 800, 800)
      Valid pixels: 56628/640000 (8.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5275, max=277578, num_faces=277930
      Valid probs shape: (37, 56628)
    ✓ Random_10 (pose=(2.6162174096950332, 2.243695019219193, -1.0462363493282916)): shape (37, 800, 800)
      Valid pixels: 58134/640000 (9.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=277921, num_faces=277930
      Valid probs shape: (37, 58134)
    ✓ Random_11 (pose=(0.6636455304872801, -0.23708492233379408, 1.9605245500859025)): shape (37, 800, 800)
      Valid pixels: 50009/640000 (7.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=276638, num_faces=277930
      Valid probs shape: (37, 50009)
    ✓ Random_12 (pose=(-1.0558588322894877, -0.9367667856473498, -0.5730207606158491)): shape (37, 800, 800)
      Valid pixels: 83926/640000 (13.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=7, max=277925, num_faces=277930
      Valid probs shape: (37, 83926)
    ✓ Random_13 (pose=(-1.0711868186845517, 3.0798231452889757, -1.347967836794181)): shape (37, 800, 800)
      Valid pixels: 69732/640000 (10.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=549, max=277693, num_faces=277930
      Valid probs shape: (37, 69732)
    ✓ Random_14 (pose=(0.24749622076766764, 3.0999917134912724, 0.7644036411392916)): shape (37, 800, 800)
      Valid pixels: 42724/640000 (6.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7776, max=277862, num_faces=277930
      Valid probs shape: (37, 42724)
    ✓ Random_15 (pose=(-2.185750668172205, -2.9105545418896703, 2.048828465217434)): shape (37, 800, 800)
      Valid pixels: 70364/640000 (11.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=277919, num_faces=277930
      Valid probs shape: (37, 70364)
    ✓ Random_16 (pose=(2.8872458694501013, -2.2654958865337447, -1.1312015200562384)): shape (37, 800, 800)
      Valid pixels: 78340/640000 (12.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=277917, num_faces=277930
      Valid probs shape: (37, 78340)
    ✓ Random_17 (pose=(-2.2098350902810475, 1.1605708856931036, 0.6554194873102732)): shape (37, 800, 800)
      Valid pixels: 64383/640000 (10.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=862, max=277927, num_faces=277930
      Valid probs shape: (37, 64383)
    ✓ Random_18 (pose=(-2.5580219967354765, -2.151167127909588, 2.446326671672267)): shape (37, 800, 800)
      Valid pixels: 60665/640000 (9.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=9, max=277925, num_faces=277930
      Valid probs shape: (37, 60665)
    ✓ Random_19 (pose=(2.529552764026576, 0.5867793387244085, -1.8581055602316048)): shape (37, 800, 800)
      Valid pixels: 68792/640000 (10.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3285, max=277929, num_faces=277930
      Valid probs shape: (37, 68792)
    ✓ Random_20 (pose=(0.6310854782879911, -0.07116835595503535, 2.112357373072552)): shape (37, 800, 800)
      Valid pixels: 55363/640000 (8.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=276638, num_faces=277930
      Valid probs shape: (37, 55363)
    ✓ Random_21 (pose=(0.008379285338039555, -2.601814723485893, -1.0979371927785522)): shape (37, 800, 800)
      Valid pixels: 64231/640000 (10.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4224, max=277927, num_faces=277930
      Valid probs shape: (37, 64231)
    ✓ Random_22 (pose=(1.619457169313261, 0.14695965082981566, 0.9231957842774428)): shape (37, 800, 800)
      Valid pixels: 68002/640000 (10.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=19, max=277754, num_faces=277930
      Valid probs shape: (37, 68002)
    ✓ Random_23 (pose=(1.4422011498014617, -0.2934703354655164, 2.535006189636725)): shape (37, 800, 800)
      Valid pixels: 90627/640000 (14.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=9, max=277861, num_faces=277930
      Valid probs shape: (37, 90627)
    ✓ Random_24 (pose=(-0.8822134653853833, 0.8512606443030917, 0.937287252254932)): shape (37, 800, 800)
      Valid pixels: 69933/640000 (10.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=277927, num_faces=277930
      Valid probs shape: (37, 69933)
    ✓ Random_25 (pose=(2.2423917701264093, -0.11541890190478377, 1.8450199488907701)): shape (37, 800, 800)
      Valid pixels: 73851/640000 (11.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5407, max=277861, num_faces=277930
      Valid probs shape: (37, 73851)
    ✓ Random_26 (pose=(-0.27680597483532665, 0.4407963579834999, -2.6824523008145498)): shape (37, 800, 800)
      Valid pixels: 64719/640000 (10.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=277917, num_faces=277930
      Valid probs shape: (37, 64719)
    ✓ Random_27 (pose=(-2.1579180610843185, -1.7705415841720205, 0.2196794374092561)): shape (37, 800, 800)
      Valid pixels: 90457/640000 (14.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=18, max=277862, num_faces=277930
      Valid probs shape: (37, 90457)
    ✓ Random_28 (pose=(-0.6789932449809579, -0.5997947453140715, 0.16367519262205432)): shape (37, 800, 800)
      Valid pixels: 58153/640000 (9.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=277925, num_faces=277930
      Valid probs shape: (37, 58153)
    ✓ Random_29 (pose=(2.91803924596434, -0.490365005510911, -2.0535166712474338)): shape (37, 800, 800)
      Valid pixels: 50103/640000 (7.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3063, max=277928, num_faces=277930
      Valid probs shape: (37, 50103)
    P stats: min=0.0000, max=1.0000, mean=0.0256
    Non-zero vertices: 131568/138967
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 7399 1576 1004 3972    0 2081 1386 4520 4890]
  Ground Truth Stats:
    Labels shape: (138967,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-5/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7810
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8316
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8320

  RESULTS:
  RAW:         median(top-10)=0.8984, mean(top-10)=0.9037, median(all)=0.8383, mean(all)=0.7810
  + SMOOTHING: median(top-10)=0.9243, mean(top-10)=0.9277, median(all)=0.8706, mean(all)=0.8316 [+0.0260]
  + MRF:       median(top-10)=0.9243, mean(top-10)=0.9280, median(all)=0.8705, mean(all)=0.8320 [-0.0000]
  TOTAL IMPROVEMENT (median top-10): +0.0259

================================================================================
Subject: NKI-RS-22-6
================================================================================
  Step 0: Generating predictions with V2 model (30 random views)...
  Mesh: 185380 vertices, 370756 faces
  Generating 30 random views...
  Generating predictions for 30 views (continuous camera pose)...
    ✓ Random_0 (pose=(0.508729377420039, 0.14703013437658008, -0.8255820106273277)): shape (37, 800, 800)
      Valid pixels: 57040/640000 (8.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=370715, num_faces=370756
      Valid probs shape: (37, 57040)
    ✓ Random_1 (pose=(0.17789057761142413, -1.3083567624510983, -0.46933054966907095)): shape (37, 800, 800)
      Valid pixels: 62106/640000 (9.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=13, max=370715, num_faces=370756
      Valid probs shape: (37, 62106)
    ✓ Random_2 (pose=(1.9757300960284372, -0.7607886616176796, 2.644440661391216)): shape (37, 800, 800)
      Valid pixels: 89617/640000 (14.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=46, max=370753, num_faces=370756
      Valid probs shape: (37, 89617)
    ✓ Random_3 (pose=(-0.04411302788844873, -3.0630327696945234, -0.1287117241183795)): shape (37, 800, 800)
      Valid pixels: 39682/640000 (6.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=11526, max=370755, num_faces=370756
      Valid probs shape: (37, 39682)
    ✓ Random_4 (pose=(-1.84522505401648, -0.6120507816552516, 1.4713120619193534)): shape (37, 800, 800)
      Valid pixels: 65017/640000 (10.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=215, max=370753, num_faces=370756
      Valid probs shape: (37, 65017)
    ✓ Random_5 (pose=(-2.6583482645960146, 2.450010671479351, 1.1936856906598132)): shape (37, 800, 800)
      Valid pixels: 61765/640000 (9.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=370715, num_faces=370756
      Valid probs shape: (37, 61765)
    ✓ Random_6 (pose=(0.7340953958549856, -0.40335323394090317, 2.49257521080109)): shape (37, 800, 800)
      Valid pixels: 65236/640000 (10.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=370727, num_faces=370756
      Valid probs shape: (37, 65236)
    ✓ Random_7 (pose=(-2.1522967693980197, -2.7813650244250683, -0.4880972779468724)): shape (37, 800, 800)
      Valid pixels: 80491/640000 (12.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=370727, num_faces=370756
      Valid probs shape: (37, 80491)
    ✓ Random_8 (pose=(-2.4812674647521504, -2.712873035437987, 1.7750862382410357)): shape (37, 800, 800)
      Valid pixels: 49321/640000 (7.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=370714, num_faces=370756
      Valid probs shape: (37, 49321)
    ✓ Random_9 (pose=(1.040123276690716, -2.905942913132787, 2.850829386527172)): shape (37, 800, 800)
      Valid pixels: 85189/640000 (13.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=460, max=370753, num_faces=370756
      Valid probs shape: (37, 85189)
    ✓ Random_10 (pose=(0.675043009617474, -1.7043463132685612, 2.859219997136921)): shape (37, 800, 800)
      Valid pixels: 75280/640000 (11.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=39, max=370751, num_faces=370756
      Valid probs shape: (37, 75280)
    ✓ Random_11 (pose=(0.8193174788611262, -2.710156591031579, -0.17341258434315154)): shape (37, 800, 800)
      Valid pixels: 80532/640000 (12.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=141, max=370751, num_faces=370756
      Valid probs shape: (37, 80532)
    ✓ Random_12 (pose=(3.0264901995919473, 0.1807990124363612, 2.720476489174575)): shape (37, 800, 800)
      Valid pixels: 41413/640000 (6.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=114808, max=370754, num_faces=370756
      Valid probs shape: (37, 41413)
    ✓ Random_13 (pose=(2.278314705910547, 2.8349610335272093, -2.203548073275387)): shape (37, 800, 800)
      Valid pixels: 61181/640000 (9.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=370632, num_faces=370756
      Valid probs shape: (37, 61181)
    ✓ Random_14 (pose=(-2.307208789292752, -0.022547443215854113, -2.7418963618086423)): shape (37, 800, 800)
      Valid pixels: 67134/640000 (10.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=83, max=370729, num_faces=370756
      Valid probs shape: (37, 67134)
    ✓ Random_15 (pose=(-2.5908076865160323, 1.0384036387435769, 0.7926851804467776)): shape (37, 800, 800)
      Valid pixels: 63499/640000 (9.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=113, max=370740, num_faces=370756
      Valid probs shape: (37, 63499)
    ✓ Random_16 (pose=(-2.7885098464728286, -2.6679612911694743, -2.7564136311239005)): shape (37, 800, 800)
      Valid pixels: 60730/640000 (9.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=370715, num_faces=370756
      Valid probs shape: (37, 60730)
    ✓ Random_17 (pose=(3.0668717496422264, 0.36370140940503326, -0.6690954742477109)): shape (37, 800, 800)
      Valid pixels: 46907/640000 (7.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=631, max=370754, num_faces=370756
      Valid probs shape: (37, 46907)
    ✓ Random_18 (pose=(-0.2905908877713226, -0.3815785507564686, -2.7104290617074795)): shape (37, 800, 800)
      Valid pixels: 47263/640000 (7.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=368688, num_faces=370756
      Valid probs shape: (37, 47263)
    ✓ Random_19 (pose=(1.4832986320132706, 2.9218636077122735, 1.2601102073381325)): shape (37, 800, 800)
      Valid pixels: 61788/640000 (9.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=370750, num_faces=370756
      Valid probs shape: (37, 61788)
    ✓ Random_20 (pose=(1.9386653395396527, -0.3522281735530841, 0.30965646567255645)): shape (37, 800, 800)
      Valid pixels: 78430/640000 (12.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=57, max=370715, num_faces=370756
      Valid probs shape: (37, 78430)
    ✓ Random_21 (pose=(1.0317078154123278, 2.6549115111480592, -0.35625489547432787)): shape (37, 800, 800)
      Valid pixels: 87463/640000 (13.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=78, max=370715, num_faces=370756
      Valid probs shape: (37, 87463)
    ✓ Random_22 (pose=(2.0299760426547655, 0.1325568913164945, -1.6194118090560272)): shape (37, 800, 800)
      Valid pixels: 61624/640000 (9.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=656, max=370754, num_faces=370756
      Valid probs shape: (37, 61624)
    ✓ Random_23 (pose=(2.750478074627825, -2.583053616929555, -1.0288256218753902)): shape (37, 800, 800)
      Valid pixels: 67961/640000 (10.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=370715, num_faces=370756
      Valid probs shape: (37, 67961)
    ✓ Random_24 (pose=(2.7410655076158994, 1.425075110631309, 2.2528970275055684)): shape (37, 800, 800)
      Valid pixels: 65790/640000 (10.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=370744, num_faces=370756
      Valid probs shape: (37, 65790)
    ✓ Random_25 (pose=(-1.8805063879502275, -0.38009274120081216, -0.7598424529846941)): shape (37, 800, 800)
      Valid pixels: 84840/640000 (13.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=38, max=370736, num_faces=370756
      Valid probs shape: (37, 84840)
    ✓ Random_26 (pose=(-2.5888307168317968, 0.2509701521107064, 1.1417650713915792)): shape (37, 800, 800)
      Valid pixels: 48342/640000 (7.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=917, max=370755, num_faces=370756
      Valid probs shape: (37, 48342)
    ✓ Random_27 (pose=(0.4944487028455491, -2.549727509086649, -2.370279132165039)): shape (37, 800, 800)
      Valid pixels: 74783/640000 (11.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=12737, max=370755, num_faces=370756
      Valid probs shape: (37, 74783)
    ✓ Random_28 (pose=(2.3328676353938924, -0.19699443507078707, -0.7575018180827322)): shape (37, 800, 800)
      Valid pixels: 77107/640000 (12.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=78, max=370751, num_faces=370756
      Valid probs shape: (37, 77107)
    ✓ Random_29 (pose=(0.7840036822840277, -2.4235924619740885, 2.5587223232627663)): shape (37, 800, 800)
      Valid pixels: 69514/640000 (10.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=11625, max=370753, num_faces=370756
      Valid probs shape: (37, 69514)
    P stats: min=0.0000, max=1.0000, mean=0.0244
    Non-zero vertices: 167343/185380
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 18037  1379  1748  3999     0  3200  1230  6666  8099]
  Ground Truth Stats:
    Labels shape: (185380,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-6/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7473
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8054
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8057

  RESULTS:
  RAW:         median(top-10)=0.8917, mean(top-10)=0.8974, median(all)=0.8265, mean(all)=0.7473
  + SMOOTHING: median(top-10)=0.9296, mean(top-10)=0.9259, median(all)=0.8506, mean(all)=0.8054 [+0.0379]
  + MRF:       median(top-10)=0.9297, mean(top-10)=0.9263, median(all)=0.8513, mean(all)=0.8057 [+0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0380

================================================================================
Subject: NKI-RS-22-7
================================================================================
  Step 0: Generating predictions with V2 model (30 random views)...
  Mesh: 153181 vertices, 306358 faces
  Generating 30 random views...
  Generating predictions for 30 views (continuous camera pose)...
    ✓ Random_0 (pose=(0.5680056844519075, 1.8621476711267908, -0.8698489529803073)): shape (37, 800, 800)
      Valid pixels: 107529/640000 (16.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=7, max=306250, num_faces=306358
      Valid probs shape: (37, 107529)
    ✓ Random_1 (pose=(2.2961159894666743, -2.6264949037550407, 0.8987824015996004)): shape (37, 800, 800)
      Valid pixels: 67106/640000 (10.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=306249, num_faces=306358
      Valid probs shape: (37, 67106)
    ✓ Random_2 (pose=(-0.5018473411128301, -1.6387819049386736, 0.5592286998723206)): shape (37, 800, 800)
      Valid pixels: 69185/640000 (10.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=636, max=306328, num_faces=306358
      Valid probs shape: (37, 69185)
    ✓ Random_3 (pose=(-1.6387574020158837, -1.6124317514788762, -0.5982845876070741)): shape (37, 800, 800)
      Valid pixels: 105146/640000 (16.4%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=40, max=306357, num_faces=306358
      Valid probs shape: (37, 105146)
    ✓ Random_4 (pose=(1.3930122234968865, -0.5303455090217088, -0.22912280765764592)): shape (37, 800, 800)
      Valid pixels: 112764/640000 (17.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=7, max=306250, num_faces=306358
      Valid probs shape: (37, 112764)
    ✓ Random_5 (pose=(-1.7040012582938222, -0.6093494129785073, 1.3802946844776498)): shape (37, 800, 800)
      Valid pixels: 73561/640000 (11.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=673, max=306349, num_faces=306358
      Valid probs shape: (37, 73561)
    ✓ Random_6 (pose=(-2.671452636525924, -2.8628712373215164, 2.120906919217056)): shape (37, 800, 800)
      Valid pixels: 49135/640000 (7.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=306153, num_faces=306358
      Valid probs shape: (37, 49135)
    ✓ Random_7 (pose=(1.7780683428930883, -2.267082150985882, 0.03908150756641149)): shape (37, 800, 800)
      Valid pixels: 107598/640000 (16.8%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=10, max=306250, num_faces=306358
      Valid probs shape: (37, 107598)
    ✓ Random_8 (pose=(0.4665641194233179, 0.8245056155590289, -1.6287823689222796)): shape (37, 800, 800)
      Valid pixels: 86167/640000 (13.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=306250, num_faces=306358
      Valid probs shape: (37, 86167)
    ✓ Random_9 (pose=(2.863337136017438, 3.0551462047599536, -1.4277570783519764)): shape (37, 800, 800)
      Valid pixels: 45600/640000 (7.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=305965, num_faces=306358
      Valid probs shape: (37, 45600)
    ✓ Random_10 (pose=(-2.193178069201318, 0.08193774489815553, -2.4805156796361802)): shape (37, 800, 800)
      Valid pixels: 74644/640000 (11.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=465, max=306357, num_faces=306358
      Valid probs shape: (37, 74644)
    ✓ Random_11 (pose=(0.24688857143162624, -2.60444239088129, 1.3919861131597049)): shape (37, 800, 800)
      Valid pixels: 68011/640000 (10.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=765, max=306357, num_faces=306358
      Valid probs shape: (37, 68011)
    ✓ Random_12 (pose=(0.2673778148685768, -1.9693124944259282, 2.77484958258753)): shape (37, 800, 800)
      Valid pixels: 61097/640000 (9.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=8203, max=306357, num_faces=306358
      Valid probs shape: (37, 61097)
    ✓ Random_13 (pose=(2.1868557347946442, -0.46805533256956755, -1.3302628919533768)): shape (37, 800, 800)
      Valid pixels: 87260/640000 (13.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=211, max=306353, num_faces=306358
      Valid probs shape: (37, 87260)
    ✓ Random_14 (pose=(0.15184253590933183, -0.11848617565085506, -2.5073894151232565)): shape (37, 800, 800)
      Valid pixels: 52013/640000 (8.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=305245, num_faces=306358
      Valid probs shape: (37, 52013)
    ✓ Random_15 (pose=(2.2351311530799842, 0.9836419647314409, -1.6129929835178551)): shape (37, 800, 800)
      Valid pixels: 80793/640000 (12.6%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=1340, max=306349, num_faces=306358
      Valid probs shape: (37, 80793)
    ✓ Random_16 (pose=(-0.568538651861985, 2.644897669372348, 0.01898891898607813)): shape (37, 800, 800)
      Valid pixels: 85918/640000 (13.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=13746, max=306349, num_faces=306358
      Valid probs shape: (37, 85918)
    ✓ Random_17 (pose=(1.7499266719947393, -0.8555471271251154, -0.5226243316487951)): shape (37, 800, 800)
      Valid pixels: 113344/640000 (17.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=7, max=306250, num_faces=306358
      Valid probs shape: (37, 113344)
    ✓ Random_18 (pose=(-2.1846023560900623, 0.03392570707965081, 0.01618458675705181)): shape (37, 800, 800)
      Valid pixels: 95701/640000 (15.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=634, max=306353, num_faces=306358
      Valid probs shape: (37, 95701)
    ✓ Random_19 (pose=(-1.8575585323119275, -2.888056353432393, 0.08573125544589866)): shape (37, 800, 800)
      Valid pixels: 100606/640000 (15.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=17, max=306349, num_faces=306358
      Valid probs shape: (37, 100606)
    ✓ Random_20 (pose=(-1.399471248727344, 0.6087493015143131, -0.650225015025756)): shape (37, 800, 800)
      Valid pixels: 102981/640000 (16.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=16, max=306355, num_faces=306358
      Valid probs shape: (37, 102981)
    ✓ Random_21 (pose=(-1.2831289706715785, 3.062697594802886, -2.1338407604313874)): shape (37, 800, 800)
      Valid pixels: 76097/640000 (11.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=306357, num_faces=306358
      Valid probs shape: (37, 76097)
    ✓ Random_22 (pose=(-0.511236978308204, 2.922535319273279, 2.4803961441719906)): shape (37, 800, 800)
      Valid pixels: 66261/640000 (10.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2131, max=306351, num_faces=306358
      Valid probs shape: (37, 66261)
    ✓ Random_23 (pose=(-0.4120592608594329, 1.0128662780258146, 1.2515668804628683)): shape (37, 800, 800)
      Valid pixels: 90635/640000 (14.2%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=7, max=306282, num_faces=306358
      Valid probs shape: (37, 90635)
    ✓ Random_24 (pose=(-2.0947319994643983, -2.075372264894099, 2.8092047076209576)): shape (37, 800, 800)
      Valid pixels: 98695/640000 (15.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=9, max=306250, num_faces=306358
      Valid probs shape: (37, 98695)
    ✓ Random_25 (pose=(0.4212956082433581, -1.2008974072381438, 1.6475833319838822)): shape (37, 800, 800)
      Valid pixels: 92635/640000 (14.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=17, max=306250, num_faces=306358
      Valid probs shape: (37, 92635)
    ✓ Random_26 (pose=(-0.8355835396849782, -1.223940763790213, -0.15461513149221906)): shape (37, 800, 800)
      Valid pixels: 86182/640000 (13.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=306295, num_faces=306358
      Valid probs shape: (37, 86182)
    ✓ Random_27 (pose=(1.3964006858731839, -0.8452288724942458, 2.9099247863289275)): shape (37, 800, 800)
      Valid pixels: 107803/640000 (16.8%)
      Probs stats: min=0.0000, max=0.9995, mean=0.0270
      Face IDs: min=17, max=306356, num_faces=306358
      Valid probs shape: (37, 107803)
    ✓ Random_28 (pose=(0.5556378069495982, -0.6311003606186136, 1.3267130678988073)): shape (37, 800, 800)
      Valid pixels: 79283/640000 (12.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=306250, num_faces=306358
      Valid probs shape: (37, 79283)
    ✓ Random_29 (pose=(-2.342727205985863, 0.32433991442416676, 1.1011865672962822)): shape (37, 800, 800)
      Valid pixels: 68575/640000 (10.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1533, max=306353, num_faces=306358
      Valid probs shape: (37, 68575)
    P stats: min=0.0000, max=1.0000, mean=0.0255
    Non-zero vertices: 144402/153181
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 8779 1341 1214 4035    0 3401 1107 4669 6181]
  Ground Truth Stats:
    Labels shape: (153181,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-7/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7760
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8241
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8242

  RESULTS:
  RAW:         median(top-10)=0.9029, mean(top-10)=0.9095, median(all)=0.8450, mean(all)=0.7760
  + SMOOTHING: median(top-10)=0.9283, mean(top-10)=0.9311, median(all)=0.8886, mean(all)=0.8241 [+0.0255]
  + MRF:       median(top-10)=0.9290, mean(top-10)=0.9315, median(all)=0.8887, mean(all)=0.8242 [+0.0006]
  TOTAL IMPROVEMENT (median top-10): +0.0261

================================================================================
Subject: NKI-RS-22-8
================================================================================
  Step 0: Generating predictions with V2 model (30 random views)...
  Mesh: 158049 vertices, 316094 faces
  Generating 30 random views...
  Generating predictions for 30 views (continuous camera pose)...
    ✓ Random_0 (pose=(0.1772434752471539, 0.4148256984886487, 2.9629966777310264)): shape (37, 800, 800)
      Valid pixels: 52881/640000 (8.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=316040, num_faces=316094
      Valid probs shape: (37, 52881)
    ✓ Random_1 (pose=(-1.7844566663542063, -0.6830288608701003, 0.6495610058897792)): shape (37, 800, 800)
      Valid pixels: 83214/640000 (13.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=32, max=316092, num_faces=316094
      Valid probs shape: (37, 83214)
    ✓ Random_2 (pose=(-0.027798783689782613, -2.239287416450127, 2.6166683670131548)): shape (37, 800, 800)
      Valid pixels: 63717/640000 (10.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=228, max=315774, num_faces=316094
      Valid probs shape: (37, 63717)
    ✓ Random_3 (pose=(-2.8043064604293377, -2.3709923240710236, -0.5552469639875874)): shape (37, 800, 800)
      Valid pixels: 56726/640000 (8.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=315774, num_faces=316094
      Valid probs shape: (37, 56726)
    ✓ Random_4 (pose=(-2.381390571803936, -1.7194898084618875, -1.1349357194877787)): shape (37, 800, 800)
      Valid pixels: 68157/640000 (10.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=315774, num_faces=316094
      Valid probs shape: (37, 68157)
    ✓ Random_5 (pose=(0.6738215306631048, -1.1569826741817468, -1.781316580205675)): shape (37, 800, 800)
      Valid pixels: 80079/640000 (12.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=0, max=316093, num_faces=316094
      Valid probs shape: (37, 80079)
    ✓ Random_6 (pose=(-0.8591100900079098, 0.8508295710825338, 2.1613384046595083)): shape (37, 800, 800)
      Valid pixels: 56307/640000 (8.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=11, max=316093, num_faces=316094
      Valid probs shape: (37, 56307)
    ✓ Random_7 (pose=(-2.0760912088059493, 2.2821413010952343, 0.8634328790548826)): shape (37, 800, 800)
      Valid pixels: 63868/640000 (10.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=13, max=316093, num_faces=316094
      Valid probs shape: (37, 63868)
    ✓ Random_8 (pose=(-0.8317477413911907, 2.4309129455260603, 2.3063206704269534)): shape (37, 800, 800)
      Valid pixels: 68040/640000 (10.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1169, max=316093, num_faces=316094
      Valid probs shape: (37, 68040)
    ✓ Random_9 (pose=(2.2583033596107587, -2.2880304698864613, 0.4490136077081468)): shape (37, 800, 800)
      Valid pixels: 70051/640000 (10.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=315841, num_faces=316094
      Valid probs shape: (37, 70051)
    ✓ Random_10 (pose=(-0.7425752630805751, -2.270078712031059, -0.6540133700051931)): shape (37, 800, 800)
      Valid pixels: 89651/640000 (14.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1009, max=316093, num_faces=316094
      Valid probs shape: (37, 89651)
    ✓ Random_11 (pose=(-0.4331743856799992, 2.645839923990863, -0.8529345402807968)): shape (37, 800, 800)
      Valid pixels: 47180/640000 (7.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3602, max=315771, num_faces=316094
      Valid probs shape: (37, 47180)
    ✓ Random_12 (pose=(-2.387741281591081, -2.472765992222186, 0.5127960828367102)): shape (37, 800, 800)
      Valid pixels: 85497/640000 (13.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=9, max=315491, num_faces=316094
      Valid probs shape: (37, 85497)
    ✓ Random_13 (pose=(2.1205435189138377, 0.17305550088514643, -2.52306548245041)): shape (37, 800, 800)
      Valid pixels: 80103/640000 (12.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1104, max=316092, num_faces=316094
      Valid probs shape: (37, 80103)
    ✓ Random_14 (pose=(-2.455171246933607, -0.18067129689001105, -2.9590237515849727)): shape (37, 800, 800)
      Valid pixels: 77044/640000 (12.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=427, max=316093, num_faces=316094
      Valid probs shape: (37, 77044)
    ✓ Random_15 (pose=(2.0200854065669853, 1.9793067306905563, -0.5914292621937336)): shape (37, 800, 800)
      Valid pixels: 84150/640000 (13.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=15, max=316093, num_faces=316094
      Valid probs shape: (37, 84150)
    ✓ Random_16 (pose=(0.917780671675148, -0.669833738789809, -1.932005295416005)): shape (37, 800, 800)
      Valid pixels: 70715/640000 (11.0%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=7, max=316092, num_faces=316094
      Valid probs shape: (37, 70715)
    ✓ Random_17 (pose=(2.710108027628201, 1.4490984771450899, 1.5955710117350215)): shape (37, 800, 800)
      Valid pixels: 90079/640000 (14.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=10, max=315775, num_faces=316094
      Valid probs shape: (37, 90079)
    ✓ Random_18 (pose=(-1.1066408889617403, 0.6177216592656616, -1.1851857424516308)): shape (37, 800, 800)
      Valid pixels: 63785/640000 (10.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=314948, num_faces=316094
      Valid probs shape: (37, 63785)
    ✓ Random_19 (pose=(-2.9279327071702452, 0.6064868533635752, 2.4103480109084403)): shape (37, 800, 800)
      Valid pixels: 65115/640000 (10.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=493, max=315775, num_faces=316094
      Valid probs shape: (37, 65115)
    ✓ Random_20 (pose=(0.48698337610249665, 0.3048346290658155, 2.349088819749256)): shape (37, 800, 800)
      Valid pixels: 70904/640000 (11.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=315491, num_faces=316094
      Valid probs shape: (37, 70904)
    ✓ Random_21 (pose=(2.256030756936503, 2.4596962626232237, -2.088333483096113)): shape (37, 800, 800)
      Valid pixels: 74752/640000 (11.7%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=7, max=316092, num_faces=316094
      Valid probs shape: (37, 74752)
    ✓ Random_22 (pose=(-2.675313625197155, 0.5746159872954837, 0.08673586184250803)): shape (37, 800, 800)
      Valid pixels: 66881/640000 (10.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=771, max=316093, num_faces=316094
      Valid probs shape: (37, 66881)
    ✓ Random_23 (pose=(-2.1497479540635482, 2.5681244581838394, -0.7328402646868355)): shape (37, 800, 800)
      Valid pixels: 91991/640000 (14.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=10, max=314969, num_faces=316094
      Valid probs shape: (37, 91991)
    ✓ Random_24 (pose=(0.15414884396807205, 1.9592714035757002, 2.4569754788538978)): shape (37, 800, 800)
      Valid pixels: 77787/640000 (12.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1092, max=316092, num_faces=316094
      Valid probs shape: (37, 77787)
    ✓ Random_25 (pose=(-2.4693569352502447, -1.1310998306956246, -0.7690918880691688)): shape (37, 800, 800)
      Valid pixels: 57673/640000 (9.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=514, max=315774, num_faces=316094
      Valid probs shape: (37, 57673)
    ✓ Random_26 (pose=(-1.0707616301369005, -2.8136718605252335, -0.4143329193211027)): shape (37, 800, 800)
      Valid pixels: 92161/640000 (14.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=689, max=316092, num_faces=316094
      Valid probs shape: (37, 92161)
    ✓ Random_27 (pose=(2.096694463710188, 3.0084914184051224, 1.4952429317772173)): shape (37, 800, 800)
      Valid pixels: 60500/640000 (9.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=315774, num_faces=316094
      Valid probs shape: (37, 60500)
    ✓ Random_28 (pose=(3.1187969473970707, 2.954357723910503, -1.3184259157588074)): shape (37, 800, 800)
      Valid pixels: 51248/640000 (8.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=315496, num_faces=316094
      Valid probs shape: (37, 51248)
    ✓ Random_29 (pose=(-2.5116627333929125, -2.9880197879864108, -1.9293293812414791)): shape (37, 800, 800)
      Valid pixels: 60222/640000 (9.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=315777, num_faces=316094
      Valid probs shape: (37, 60222)
    P stats: min=0.0000, max=1.0000, mean=0.0251
    Non-zero vertices: 146490/158049
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 11559  1195  1280  3756     0  2832  1312  4909  6426]
  Ground Truth Stats:
    Labels shape: (158049,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-8/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7667
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8187
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8192

  RESULTS:
  RAW:         median(top-10)=0.9037, mean(top-10)=0.9039, median(all)=0.8254, mean(all)=0.7667
  + SMOOTHING: median(top-10)=0.9259, mean(top-10)=0.9265, median(all)=0.8703, mean(all)=0.8187 [+0.0222]
  + MRF:       median(top-10)=0.9263, mean(top-10)=0.9267, median(all)=0.8710, mean(all)=0.8192 [+0.0004]
  TOTAL IMPROVEMENT (median top-10): +0.0226

================================================================================
Subject: NKI-RS-22-9
================================================================================
  Step 0: Generating predictions with V2 model (30 random views)...
  Mesh: 129746 vertices, 259488 faces
  Generating 30 random views...
  Generating predictions for 30 views (continuous camera pose)...
    ✓ Random_0 (pose=(-2.2162690639878107, -0.5841289858485741, 1.0116211426314852)): shape (37, 800, 800)
      Valid pixels: 69853/640000 (10.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1595, max=259487, num_faces=259488
      Valid probs shape: (37, 69853)
    ✓ Random_1 (pose=(-2.603045910711816, -2.6915485540810753, -2.2263184853261713)): shape (37, 800, 800)
      Valid pixels: 65631/640000 (10.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=259244, num_faces=259488
      Valid probs shape: (37, 65631)
    ✓ Random_2 (pose=(-0.6272876282098534, -3.022640500785076, 1.5914932836481102)): shape (37, 800, 800)
      Valid pixels: 49416/640000 (7.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1233, max=259487, num_faces=259488
      Valid probs shape: (37, 49416)
    ✓ Random_3 (pose=(-1.4696875113857453, -3.0057133493795662, -2.1074422306315888)): shape (37, 800, 800)
      Valid pixels: 64584/640000 (10.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=259474, num_faces=259488
      Valid probs shape: (37, 64584)
    ✓ Random_4 (pose=(3.137610710745819, 1.1285480856841579, 0.7633926673532527)): shape (37, 800, 800)
      Valid pixels: 85418/640000 (13.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=85, max=259432, num_faces=259488
      Valid probs shape: (37, 85418)
    ✓ Random_5 (pose=(2.135264238424565, 0.711367797664034, 2.169967056132222)): shape (37, 800, 800)
      Valid pixels: 64434/640000 (10.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=395, max=259486, num_faces=259488
      Valid probs shape: (37, 64434)
    ✓ Random_6 (pose=(1.2108566251605533, -0.37859922392443135, 0.09258489034505946)): shape (37, 800, 800)
      Valid pixels: 91618/640000 (14.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=259426, num_faces=259488
      Valid probs shape: (37, 91618)
    ✓ Random_7 (pose=(-0.056104172434633615, -1.1479787042394032, -0.09943175783600378)): shape (37, 800, 800)
      Valid pixels: 56171/640000 (8.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=259438, num_faces=259488
      Valid probs shape: (37, 56171)
    ✓ Random_8 (pose=(0.9822200603183422, -2.88876063756547, -2.3553681949972347)): shape (37, 800, 800)
      Valid pixels: 69262/640000 (10.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5208, max=259486, num_faces=259488
      Valid probs shape: (37, 69262)
    ✓ Random_9 (pose=(-0.45316695043649613, -0.4402966049949941, 2.4243509147793434)): shape (37, 800, 800)
      Valid pixels: 65957/640000 (10.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=259245, num_faces=259488
      Valid probs shape: (37, 65957)
    ✓ Random_10 (pose=(-1.2039918104575764, 0.36224051688934633, -2.2032893201643162)): shape (37, 800, 800)
      Valid pixels: 68135/640000 (10.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=259259, num_faces=259488
      Valid probs shape: (37, 68135)
    ✓ Random_11 (pose=(-1.7282071409797986, -2.9778785216525607, 2.156270710542146)): shape (37, 800, 800)
      Valid pixels: 84003/640000 (13.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=259432, num_faces=259488
      Valid probs shape: (37, 84003)
    ✓ Random_12 (pose=(2.2388265897880126, 1.634523651849931, 1.6723252061776233)): shape (37, 800, 800)
      Valid pixels: 65484/640000 (10.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=259459, num_faces=259488
      Valid probs shape: (37, 65484)
    ✓ Random_13 (pose=(0.24968486499971254, 0.8735030716938041, -2.571515555044746)): shape (37, 800, 800)
      Valid pixels: 57300/640000 (9.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=259425, num_faces=259488
      Valid probs shape: (37, 57300)
    ✓ Random_14 (pose=(-2.499956729956617, 1.8709936816836166, -2.9618011646405553)): shape (37, 800, 800)
      Valid pixels: 63113/640000 (9.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=259483, num_faces=259488
      Valid probs shape: (37, 63113)
    ✓ Random_15 (pose=(-1.5609361652625653, -0.9757348840593187, -0.6540594589878324)): shape (37, 800, 800)
      Valid pixels: 92374/640000 (14.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=259485, num_faces=259488
      Valid probs shape: (37, 92374)
    ✓ Random_16 (pose=(-2.41968023789661, -2.861875217188307, -3.1029177459199335)): shape (37, 800, 800)
      Valid pixels: 73764/640000 (11.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=259417, num_faces=259488
      Valid probs shape: (37, 73764)
    ✓ Random_17 (pose=(3.018168816915466, 2.220103544138187, 1.4155200644975166)): shape (37, 800, 800)
      Valid pixels: 80115/640000 (12.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=259243, num_faces=259488
      Valid probs shape: (37, 80115)
    ✓ Random_18 (pose=(1.814872992165883, -0.13558727351630484, 0.5827447504661767)): shape (37, 800, 800)
      Valid pixels: 73490/640000 (11.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=10, max=259474, num_faces=259488
      Valid probs shape: (37, 73490)
    ✓ Random_19 (pose=(0.6044553795592895, -2.988313255585897, 2.454804491965355)): shape (37, 800, 800)
      Valid pixels: 66054/640000 (10.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=18920, max=259486, num_faces=259488
      Valid probs shape: (37, 66054)
    ✓ Random_20 (pose=(2.9136594466542567, 0.005912315296874304, 0.7926749394413348)): shape (37, 800, 800)
      Valid pixels: 40581/640000 (6.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2319, max=259486, num_faces=259488
      Valid probs shape: (37, 40581)
    ✓ Random_21 (pose=(-1.469054695711669, 0.28505275518160245, -0.048862056386794084)): shape (37, 800, 800)
      Valid pixels: 88828/640000 (13.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=28, max=259486, num_faces=259488
      Valid probs shape: (37, 88828)
    ✓ Random_22 (pose=(-0.5340232865182326, 0.5887970554950814, 2.432606401497682)): shape (37, 800, 800)
      Valid pixels: 49119/640000 (7.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=259430, num_faces=259488
      Valid probs shape: (37, 49119)
    ✓ Random_23 (pose=(2.5509982861529723, -3.087022341052927, -0.34739603834911437)): shape (37, 800, 800)
      Valid pixels: 64956/640000 (10.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=259243, num_faces=259488
      Valid probs shape: (37, 64956)
    ✓ Random_24 (pose=(-2.716024468059767, -0.46171072690557935, 0.6475364659047331)): shape (37, 800, 800)
      Valid pixels: 70664/640000 (11.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=18128, max=259486, num_faces=259488
      Valid probs shape: (37, 70664)
    ✓ Random_25 (pose=(-2.387454002564086, 2.3718562961763707, 1.3640426792371185)): shape (37, 800, 800)
      Valid pixels: 68311/640000 (10.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7, max=259432, num_faces=259488
      Valid probs shape: (37, 68311)
    ✓ Random_26 (pose=(2.9438582313438824, -1.5456456766022655, 3.0034266739580904)): shape (37, 800, 800)
      Valid pixels: 63141/640000 (9.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=75, max=259479, num_faces=259488
      Valid probs shape: (37, 63141)
    ✓ Random_27 (pose=(2.7221885677972244, -2.5833583093870227, 1.5168662054389737)): shape (37, 800, 800)
      Valid pixels: 66041/640000 (10.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=259350, num_faces=259488
      Valid probs shape: (37, 66041)
    ✓ Random_28 (pose=(-1.763439718494314, 1.2845857950667385, 0.47885812324806487)): shape (37, 800, 800)
      Valid pixels: 70520/640000 (11.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=71, max=259485, num_faces=259488
      Valid probs shape: (37, 70520)
    ✓ Random_29 (pose=(0.08046505706795415, 2.6043696442146027, -2.047761441172112)): shape (37, 800, 800)
      Valid pixels: 57820/640000 (9.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=264, max=259487, num_faces=259488
      Valid probs shape: (37, 57820)
    P stats: min=0.0000, max=1.0000, mean=0.0253
    Non-zero vertices: 121650/129746
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 8096 1076  980 3045    0 2232 1208 4399 5241]
  Ground Truth Stats:
    Labels shape: (129746,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-9/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7841
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8412
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8415

  RESULTS:
  RAW:         median(top-10)=0.9113, mean(top-10)=0.9192, median(all)=0.8407, mean(all)=0.7841
  + SMOOTHING: median(top-10)=0.9382, mean(top-10)=0.9386, median(all)=0.8723, mean(all)=0.8412 [+0.0269]
  + MRF:       median(top-10)=0.9385, mean(top-10)=0.9389, median(all)=0.8722, mean(all)=0.8415 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0272

================================================================================
Subject: NKI-TRT-20-1
================================================================================
  Step 0: Generating predictions with V2 model (30 random views)...
  Mesh: 143932 vertices, 287860 faces
  Generating 30 random views...
  Generating predictions for 30 views (continuous camera pose)...
    ✓ Random_0 (pose=(0.3462717065985528, 3.12886623714717, -2.1260154773818964)): shape (37, 800, 800)
      Valid pixels: 78585/640000 (12.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3919, max=287857, num_faces=287860
      Valid probs shape: (37, 78585)
    ✓ Random_1 (pose=(-2.806440936191663, 2.168317194047246, -2.46250285127386)): shape (37, 800, 800)
      Valid pixels: 93217/640000 (14.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=287807, num_faces=287860
      Valid probs shape: (37, 93217)
    ✓ Random_2 (pose=(-1.5709905447814736, 1.6769052252086976, -0.2568680106722234)): shape (37, 800, 800)
      Valid pixels: 130005/640000 (20.3%)
      Probs stats: min=0.0000, max=0.9995, mean=0.0270
      Face IDs: min=14, max=287856, num_faces=287860
      Valid probs shape: (37, 130005)
    ✓ Random_3 (pose=(-2.120033342874323, -3.025819224779526, 2.6744198087447533)): shape (37, 800, 800)
      Valid pixels: 110179/640000 (17.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=287848, num_faces=287860
      Valid probs shape: (37, 110179)
    ✓ Random_4 (pose=(1.454826467816397, -2.759184564107594, 2.5311429870644737)): shape (37, 800, 800)
      Valid pixels: 124765/640000 (19.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=75, max=287855, num_faces=287860
      Valid probs shape: (37, 124765)
    ✓ Random_5 (pose=(0.21816329965957015, 0.8907532580686066, -0.17084345594341022)): shape (37, 800, 800)
      Valid pixels: 87674/640000 (13.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=287786, num_faces=287860
      Valid probs shape: (37, 87674)
    ✓ Random_6 (pose=(2.179735545054079, -1.3739210481945663, -0.8670756082908673)): shape (37, 800, 800)
      Valid pixels: 139868/640000 (21.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=26, max=287851, num_faces=287860
      Valid probs shape: (37, 139868)
    ✓ Random_7 (pose=(0.01884249036160357, -1.761793085117115, 2.8021517366826743)): shape (37, 800, 800)
      Valid pixels: 87447/640000 (13.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=287859, num_faces=287860
      Valid probs shape: (37, 87447)
    ✓ Random_8 (pose=(2.200028911197421, -1.9557789935159233, 0.3886391062884531)): shape (37, 800, 800)
      Valid pixels: 96778/640000 (15.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=11, max=287812, num_faces=287860
      Valid probs shape: (37, 96778)
    ✓ Random_9 (pose=(-0.24748637726965628, -0.43877516549238615, -0.8460091954305073)): shape (37, 800, 800)
      Valid pixels: 92017/640000 (14.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=6, max=287578, num_faces=287860
      Valid probs shape: (37, 92017)
    ✓ Random_10 (pose=(2.5086174333480855, -1.9423275091943062, -2.1102031366000196)): shape (37, 800, 800)
      Valid pixels: 90121/640000 (14.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=287858, num_faces=287860
      Valid probs shape: (37, 90121)
    ✓ Random_11 (pose=(2.3137592508657514, -2.1143295651646516, 2.0957520992507135)): shape (37, 800, 800)
      Valid pixels: 127702/640000 (20.0%)
      Probs stats: min=0.0000, max=0.9994, mean=0.0270
      Face IDs: min=2, max=287856, num_faces=287860
      Valid probs shape: (37, 127702)
    ✓ Random_12 (pose=(2.4381996121790745, 2.08752486934491, 3.0879446197835456)): shape (37, 800, 800)
      Valid pixels: 117636/640000 (18.4%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=6, max=287855, num_faces=287860
      Valid probs shape: (37, 117636)
    ✓ Random_13 (pose=(1.586864831909307, 2.0270927265293777, -2.976598398491093)): shape (37, 800, 800)
      Valid pixels: 121667/640000 (19.0%)
      Probs stats: min=0.0000, max=0.9991, mean=0.0270
      Face IDs: min=8, max=287856, num_faces=287860
      Valid probs shape: (37, 121667)
    ✓ Random_14 (pose=(1.3657227851758247, 1.1896113666335006, 1.1967124139265053)): shape (37, 800, 800)
      Valid pixels: 84377/640000 (13.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=11, max=287859, num_faces=287860
      Valid probs shape: (37, 84377)
    ✓ Random_15 (pose=(1.6983559202862608, -0.5752780254198946, 1.4258096009107506)): shape (37, 800, 800)
      Valid pixels: 81119/640000 (12.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=12, max=287852, num_faces=287860
      Valid probs shape: (37, 81119)
    ✓ Random_16 (pose=(2.63386720613037, 1.2060657426741939, -2.929342195657616)): shape (37, 800, 800)
      Valid pixels: 116880/640000 (18.3%)
      Probs stats: min=0.0000, max=0.9995, mean=0.0270
      Face IDs: min=2772, max=287853, num_faces=287860
      Valid probs shape: (37, 116880)
    ✓ Random_17 (pose=(2.8989596668099686, 0.18173849708669776, -2.0898496732134246)): shape (37, 800, 800)
      Valid pixels: 80584/640000 (12.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3934, max=287859, num_faces=287860
      Valid probs shape: (37, 80584)
    ✓ Random_18 (pose=(-1.5817367122059394, -3.038527761231148, -1.9294363981013394)): shape (37, 800, 800)
      Valid pixels: 89850/640000 (14.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=14, max=287856, num_faces=287860
      Valid probs shape: (37, 89850)
    ✓ Random_19 (pose=(2.6309554201355203, 2.579311183414636, 2.6615080618754146)): shape (37, 800, 800)
      Valid pixels: 90306/640000 (14.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=0, max=287807, num_faces=287860
      Valid probs shape: (37, 90306)
    ✓ Random_20 (pose=(-2.837956016534856, 3.0145488454319267, -0.25509795229554477)): shape (37, 800, 800)
      Valid pixels: 82934/640000 (13.0%)
      Probs stats: min=0.0000, max=0.9995, mean=0.0270
      Face IDs: min=1, max=287237, num_faces=287860
      Valid probs shape: (37, 82934)
    ✓ Random_21 (pose=(3.0027253899587407, 0.06670290675678059, 2.161770744573957)): shape (37, 800, 800)
      Valid pixels: 63124/640000 (9.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7050, max=287857, num_faces=287860
      Valid probs shape: (37, 63124)
    ✓ Random_22 (pose=(-1.8166876940519292, 1.6614919759992786, -1.0359469907787386)): shape (37, 800, 800)
      Valid pixels: 121827/640000 (19.0%)
      Probs stats: min=0.0000, max=0.9995, mean=0.0270
      Face IDs: min=23, max=287855, num_faces=287860
      Valid probs shape: (37, 121827)
    ✓ Random_23 (pose=(-2.8349085139456998, -2.47851772480796, -0.6834749055892031)): shape (37, 800, 800)
      Valid pixels: 80700/640000 (12.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=287804, num_faces=287860
      Valid probs shape: (37, 80700)
    ✓ Random_24 (pose=(-1.0905936212753713, 0.6100881378046963, -2.288306462690687)): shape (37, 800, 800)
      Valid pixels: 107731/640000 (16.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=15, max=287849, num_faces=287860
      Valid probs shape: (37, 107731)
    ✓ Random_25 (pose=(0.7868272761203401, 2.3527324846599225, -2.6437358645966187)): shape (37, 800, 800)
      Valid pixels: 94507/640000 (14.8%)
      Probs stats: min=0.0000, max=0.9993, mean=0.0270
      Face IDs: min=884, max=287858, num_faces=287860
      Valid probs shape: (37, 94507)
    ✓ Random_26 (pose=(1.8940214280280436, -0.4040622911440055, -2.7002753592737463)): shape (37, 800, 800)
      Valid pixels: 106221/640000 (16.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=282, max=287858, num_faces=287860
      Valid probs shape: (37, 106221)
    ✓ Random_27 (pose=(-0.3994337208455905, 2.5980817948851076, 2.008662088358548)): shape (37, 800, 800)
      Valid pixels: 88421/640000 (13.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6894, max=287859, num_faces=287860
      Valid probs shape: (37, 88421)
    ✓ Random_28 (pose=(-0.20589120541054395, -0.05664361649419991, -1.4669999475183817)): shape (37, 800, 800)
      Valid pixels: 74343/640000 (11.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=287518, num_faces=287860
      Valid probs shape: (37, 74343)
    ✓ Random_29 (pose=(-0.6224555400281262, -0.016552626410796467, -0.6075626801802314)): shape (37, 800, 800)
      Valid pixels: 102853/640000 (16.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=287804, num_faces=287860
      Valid probs shape: (37, 102853)
    P stats: min=0.0000, max=0.9998, mean=0.0254
    Non-zero vertices: 135211/143932
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 8721 1413 1088 3608    0 1861  821 4294 7246]
  Ground Truth Stats:
    Labels shape: (143932,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-1/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7621
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8138
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8139

  RESULTS:
  RAW:         median(top-10)=0.8982, mean(top-10)=0.8951, median(all)=0.8336, mean(all)=0.7621
  + SMOOTHING: median(top-10)=0.9249, mean(top-10)=0.9255, median(all)=0.8702, mean(all)=0.8138 [+0.0267]
  + MRF:       median(top-10)=0.9250, mean(top-10)=0.9257, median(all)=0.8705, mean(all)=0.8139 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0269

================================================================================
Subject: NKI-TRT-20-10
================================================================================
  Step 0: Generating predictions with V2 model (30 random views)...
  Mesh: 122978 vertices, 245952 faces
  Generating 30 random views...
  Generating predictions for 30 views (continuous camera pose)...
    ✓ Random_0 (pose=(0.3048496740005162, 2.8528679108615753, -0.8531507123237239)): shape (37, 800, 800)
      Valid pixels: 47455/640000 (7.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=18, max=245942, num_faces=245952
      Valid probs shape: (37, 47455)
    ✓ Random_1 (pose=(2.752796149144622, -1.052192145122807, 0.16544420980453678)): shape (37, 800, 800)
      Valid pixels: 53227/640000 (8.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=34, max=245943, num_faces=245952
      Valid probs shape: (37, 53227)
    ✓ Random_2 (pose=(1.7662054627295456, 2.6437430792574643, 0.5426038555494066)): shape (37, 800, 800)
      Valid pixels: 75218/640000 (11.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7, max=245944, num_faces=245952
      Valid probs shape: (37, 75218)
    ✓ Random_3 (pose=(1.8973069152224014, 2.8886328273254103, -0.3955888302143289)): shape (37, 800, 800)
      Valid pixels: 81681/640000 (12.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=21, max=245942, num_faces=245952
      Valid probs shape: (37, 81681)
    ✓ Random_4 (pose=(-0.06802634525107676, 0.25165735863874783, 2.4804852674895894)): shape (37, 800, 800)
      Valid pixels: 38476/640000 (6.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=245900, num_faces=245952
      Valid probs shape: (37, 38476)
    ✓ Random_5 (pose=(-2.7808522266111444, 1.5452816934327354, -2.4211771802805684)): shape (37, 800, 800)
      Valid pixels: 66470/640000 (10.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6, max=245945, num_faces=245952
      Valid probs shape: (37, 66470)
    ✓ Random_6 (pose=(-0.9937167826614544, 0.44278715277463787, -2.1111997787529315)): shape (37, 800, 800)
      Valid pixels: 62469/640000 (9.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=10, max=245944, num_faces=245952
      Valid probs shape: (37, 62469)
    ✓ Random_7 (pose=(-1.4192807737616822, -0.2587865822962039, -0.833931413118846)): shape (37, 800, 800)
      Valid pixels: 78039/640000 (12.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7, max=245764, num_faces=245952
      Valid probs shape: (37, 78039)
    ✓ Random_8 (pose=(-3.1185508280856924, -1.2062298765017014, 0.10951733286202758)): shape (37, 800, 800)
      Valid pixels: 53836/640000 (8.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=15, max=245581, num_faces=245952
      Valid probs shape: (37, 53836)
    ✓ Random_9 (pose=(-0.97979174875735, 1.0233038623979853, 2.276461355442912)): shape (37, 800, 800)
      Valid pixels: 57325/640000 (9.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=34, max=245903, num_faces=245952
      Valid probs shape: (37, 57325)
    ✓ Random_10 (pose=(-1.3514015803980277, 0.2279553536809682, -2.1071197167091196)): shape (37, 800, 800)
      Valid pixels: 62643/640000 (9.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=10, max=245944, num_faces=245952
      Valid probs shape: (37, 62643)
    ✓ Random_11 (pose=(-2.128986380155907, 2.5503755610756285, 0.3011472257852832)): shape (37, 800, 800)
      Valid pixels: 61897/640000 (9.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=245766, num_faces=245952
      Valid probs shape: (37, 61897)
    ✓ Random_12 (pose=(2.6145312542544294, 0.4903650218610629, -2.3447062872336506)): shape (37, 800, 800)
      Valid pixels: 65323/640000 (10.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4374, max=245951, num_faces=245952
      Valid probs shape: (37, 65323)
    ✓ Random_13 (pose=(-2.6392815329466828, -2.7196731592917964, 2.6193299141716757)): shape (37, 800, 800)
      Valid pixels: 47938/640000 (7.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=245934, num_faces=245952
      Valid probs shape: (37, 47938)
    ✓ Random_14 (pose=(1.1052257163807324, -2.744845149683187, 0.8162391081337197)): shape (37, 800, 800)
      Valid pixels: 66545/640000 (10.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=245947, num_faces=245952
      Valid probs shape: (37, 66545)
    ✓ Random_15 (pose=(0.27700654525481383, 2.3114114612066725, 2.8750374149475153)): shape (37, 800, 800)
      Valid pixels: 58253/640000 (9.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2758, max=245950, num_faces=245952
      Valid probs shape: (37, 58253)
    ✓ Random_16 (pose=(0.002088480137343307, -0.27478627624236207, 2.5769351164822343)): shape (37, 800, 800)
      Valid pixels: 38630/640000 (6.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=244763, num_faces=245952
      Valid probs shape: (37, 38630)
    ✓ Random_17 (pose=(0.4944391895638036, -0.6938843516930526, 2.3509589983752104)): shape (37, 800, 800)
      Valid pixels: 48480/640000 (7.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=244761, num_faces=245952
      Valid probs shape: (37, 48480)
    ✓ Random_18 (pose=(-0.4593350958138269, -0.5459837992697527, 1.4650871631587243)): shape (37, 800, 800)
      Valid pixels: 55677/640000 (8.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=245942, num_faces=245952
      Valid probs shape: (37, 55677)
    ✓ Random_19 (pose=(-0.1315428465855737, -0.6314306872107003, -2.2981290855439367)): shape (37, 800, 800)
      Valid pixels: 55430/640000 (8.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=245626, num_faces=245952
      Valid probs shape: (37, 55430)
    ✓ Random_20 (pose=(0.35303552608029776, 2.6210760027676487, -0.11891386686276073)): shape (37, 800, 800)
      Valid pixels: 48014/640000 (7.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=55, max=245943, num_faces=245952
      Valid probs shape: (37, 48014)
    ✓ Random_21 (pose=(1.2491616788899886, 0.6839841616778872, 0.5519476672671879)): shape (37, 800, 800)
      Valid pixels: 66564/640000 (10.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=13, max=245944, num_faces=245952
      Valid probs shape: (37, 66564)
    ✓ Random_22 (pose=(-1.123874061209475, 1.3619771186090164, 2.502032744654705)): shape (37, 800, 800)
      Valid pixels: 71883/640000 (11.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=32, max=245943, num_faces=245952
      Valid probs shape: (37, 71883)
    ✓ Random_23 (pose=(0.13004728949782596, 1.2487373423716859, -0.2754603919228833)): shape (37, 800, 800)
      Valid pixels: 57893/640000 (9.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=10, max=244762, num_faces=245952
      Valid probs shape: (37, 57893)
    ✓ Random_24 (pose=(2.2981157877917555, 0.2952612691001093, 2.3121286263856344)): shape (37, 800, 800)
      Valid pixels: 62034/640000 (9.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=14843, max=245951, num_faces=245952
      Valid probs shape: (37, 62034)
    ✓ Random_25 (pose=(2.8054341908203453, 2.183810828176492, -0.522897826867724)): shape (37, 800, 800)
      Valid pixels: 49194/640000 (7.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=245899, num_faces=245952
      Valid probs shape: (37, 49194)
    ✓ Random_26 (pose=(0.5891259540388938, 2.052412379712485, 0.26479412102400746)): shape (37, 800, 800)
      Valid pixels: 56094/640000 (8.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=17, max=245946, num_faces=245952
      Valid probs shape: (37, 56094)
    ✓ Random_27 (pose=(3.006832607064463, -1.5266827892618786, -1.792052226863965)): shape (37, 800, 800)
      Valid pixels: 86986/640000 (13.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=245944, num_faces=245952
      Valid probs shape: (37, 86986)
    ✓ Random_28 (pose=(0.7719057066306885, -0.8699291108644434, -2.453420323517256)): shape (37, 800, 800)
      Valid pixels: 72231/640000 (11.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=245626, num_faces=245952
      Valid probs shape: (37, 72231)
    ✓ Random_29 (pose=(2.2278857086825186, 0.03678135926077708, -1.6059251871176072)): shape (37, 800, 800)
      Valid pixels: 52730/640000 (8.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2019, max=245950, num_faces=245952
      Valid probs shape: (37, 52730)
    P stats: min=0.0000, max=1.0000, mean=0.0255
    Non-zero vertices: 116062/122978
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 6916 1170  786 2320    0 2528 1006 4165 6180]
  Ground Truth Stats:
    Labels shape: (122978,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-10/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7745
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8195
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8199

  RESULTS:
  RAW:         median(top-10)=0.9195, mean(top-10)=0.9141, median(all)=0.8623, mean(all)=0.7745
  + SMOOTHING: median(top-10)=0.9313, mean(top-10)=0.9309, median(all)=0.8803, mean(all)=0.8195 [+0.0119]
  + MRF:       median(top-10)=0.9318, mean(top-10)=0.9312, median(all)=0.8807, mean(all)=0.8199 [+0.0005]
  TOTAL IMPROVEMENT (median top-10): +0.0123

================================================================================
Subject: NKI-TRT-20-11
================================================================================
  Step 0: Generating predictions with V2 model (30 random views)...
  Mesh: 146103 vertices, 292202 faces
  Generating 30 random views...
  Generating predictions for 30 views (continuous camera pose)...
    ✓ Random_0 (pose=(2.8973881780199386, 2.637479593487134, -2.1839772923608316)): shape (37, 800, 800)
      Valid pixels: 84266/640000 (13.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=0, max=291880, num_faces=292202
      Valid probs shape: (37, 84266)
    ✓ Random_1 (pose=(-0.21073220383777613, 2.4623363606188455, -2.656019922161266)): shape (37, 800, 800)
      Valid pixels: 93623/640000 (14.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=528, max=292201, num_faces=292202
      Valid probs shape: (37, 93623)
    ✓ Random_2 (pose=(2.1064387638122675, 1.4975421877334183, 0.29677581699178335)): shape (37, 800, 800)
      Valid pixels: 117306/640000 (18.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=69, max=292199, num_faces=292202
      Valid probs shape: (37, 117306)
    ✓ Random_3 (pose=(2.3945249631886085, 1.6949725469342658, 1.6768123458723343)): shape (37, 800, 800)
      Valid pixels: 86438/640000 (13.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=45, max=292002, num_faces=292202
      Valid probs shape: (37, 86438)
    ✓ Random_4 (pose=(-2.447720526644878, 2.95026177647407, -0.5701595437357039)): shape (37, 800, 800)
      Valid pixels: 93783/640000 (14.7%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=0, max=291876, num_faces=292202
      Valid probs shape: (37, 93783)
    ✓ Random_5 (pose=(-1.8874221721363371, -3.1331812876832794, 0.4273168275808339)): shape (37, 800, 800)
      Valid pixels: 90251/640000 (14.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=292138, num_faces=292202
      Valid probs shape: (37, 90251)
    ✓ Random_6 (pose=(2.51279688543009, 0.0665382251043316, -1.7659604050298736)): shape (37, 800, 800)
      Valid pixels: 73341/640000 (11.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8161, max=292201, num_faces=292202
      Valid probs shape: (37, 73341)
    ✓ Random_7 (pose=(-0.5603373667710541, 2.5209191675857667, 1.4309426038029969)): shape (37, 800, 800)
      Valid pixels: 81196/640000 (12.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7097, max=292200, num_faces=292202
      Valid probs shape: (37, 81196)
    ✓ Random_8 (pose=(1.5096626159607913, 2.0702055020824233, -0.6830470801558626)): shape (37, 800, 800)
      Valid pixels: 112479/640000 (17.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=19, max=292199, num_faces=292202
      Valid probs shape: (37, 112479)
    ✓ Random_9 (pose=(-1.7434990621723048, -1.1078207153071093, 2.503108800060277)): shape (37, 800, 800)
      Valid pixels: 109025/640000 (17.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=71, max=292199, num_faces=292202
      Valid probs shape: (37, 109025)
    ✓ Random_10 (pose=(-0.5012802525057025, -3.0242043368250293, -2.814355745611962)): shape (37, 800, 800)
      Valid pixels: 69951/640000 (10.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=679, max=292201, num_faces=292202
      Valid probs shape: (37, 69951)
    ✓ Random_11 (pose=(-2.782344558417167, 1.016324683244048, 2.670280676930192)): shape (37, 800, 800)
      Valid pixels: 84164/640000 (13.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=163, max=292199, num_faces=292202
      Valid probs shape: (37, 84164)
    ✓ Random_12 (pose=(-1.31248614903548, -1.7756463167191865, -1.5422560308900777)): shape (37, 800, 800)
      Valid pixels: 84576/640000 (13.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=67, max=290659, num_faces=292202
      Valid probs shape: (37, 84576)
    ✓ Random_13 (pose=(-1.4311906581839204, -0.4992033262241917, 1.2218971893358326)): shape (37, 800, 800)
      Valid pixels: 75005/640000 (11.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=292138, num_faces=292202
      Valid probs shape: (37, 75005)
    ✓ Random_14 (pose=(0.4479451187108361, -2.2966053969397398, 0.6781099575121634)): shape (37, 800, 800)
      Valid pixels: 107451/640000 (16.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=108, max=292201, num_faces=292202
      Valid probs shape: (37, 107451)
    ✓ Random_15 (pose=(-2.0394533968305524, -1.0090627146856863, -0.5598319711028199)): shape (37, 800, 800)
      Valid pixels: 97292/640000 (15.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=106, max=292095, num_faces=292202
      Valid probs shape: (37, 97292)
    ✓ Random_16 (pose=(3.034379361952305, -1.709549611050066, -2.9993830147130285)): shape (37, 800, 800)
      Valid pixels: 73903/640000 (11.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=39, max=292138, num_faces=292202
      Valid probs shape: (37, 73903)
    ✓ Random_17 (pose=(-0.2592481635252324, -0.5468005404300373, -0.48615878463145634)): shape (37, 800, 800)
      Valid pixels: 71956/640000 (11.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=0, max=291880, num_faces=292202
      Valid probs shape: (37, 71956)
    ✓ Random_18 (pose=(-0.8198147505810254, 1.0945197687418302, -0.0800716058930746)): shape (37, 800, 800)
      Valid pixels: 108165/640000 (16.9%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=6, max=291860, num_faces=292202
      Valid probs shape: (37, 108165)
    ✓ Random_19 (pose=(-2.518091887566438, 1.5603420557456547, 1.960644965013226)): shape (37, 800, 800)
      Valid pixels: 116895/640000 (18.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=20, max=292199, num_faces=292202
      Valid probs shape: (37, 116895)
    ✓ Random_20 (pose=(2.0041680669997817, -1.352882633032058, 1.7582449904127317)): shape (37, 800, 800)
      Valid pixels: 100649/640000 (15.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=291876, num_faces=292202
      Valid probs shape: (37, 100649)
    ✓ Random_21 (pose=(1.7200281911850972, -2.9817677740760895, 0.7799757118282566)): shape (37, 800, 800)
      Valid pixels: 87507/640000 (13.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=23, max=292004, num_faces=292202
      Valid probs shape: (37, 87507)
    ✓ Random_22 (pose=(-1.1282886468027722, 2.547429762546816, 2.012628565778747)): shape (37, 800, 800)
      Valid pixels: 84745/640000 (13.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=81, max=292201, num_faces=292202
      Valid probs shape: (37, 84745)
    ✓ Random_23 (pose=(2.5691908752872186, -1.8524563849243585, 0.980196718703791)): shape (37, 800, 800)
      Valid pixels: 93006/640000 (14.5%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=27, max=291166, num_faces=292202
      Valid probs shape: (37, 93006)
    ✓ Random_24 (pose=(0.7618341443910919, 1.909967206636245, -1.7870369135614437)): shape (37, 800, 800)
      Valid pixels: 103497/640000 (16.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=80, max=292199, num_faces=292202
      Valid probs shape: (37, 103497)
    ✓ Random_25 (pose=(1.4152780980411812, 0.21621028733602854, -2.570011149163802)): shape (37, 800, 800)
      Valid pixels: 86281/640000 (13.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=4, max=292138, num_faces=292202
      Valid probs shape: (37, 86281)
    ✓ Random_26 (pose=(0.33410533872921366, 0.6515472014631105, 1.1978175867017757)): shape (37, 800, 800)
      Valid pixels: 90506/640000 (14.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=291058, num_faces=292202
      Valid probs shape: (37, 90506)
    ✓ Random_27 (pose=(-0.39522731864001637, -1.9181445610782226, -0.43558430292869454)): shape (37, 800, 800)
      Valid pixels: 87141/640000 (13.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=34, max=292200, num_faces=292202
      Valid probs shape: (37, 87141)
    ✓ Random_28 (pose=(1.3069839833111168, 2.817714231131454, 2.0904820049439854)): shape (37, 800, 800)
      Valid pixels: 97555/640000 (15.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=105, max=292186, num_faces=292202
      Valid probs shape: (37, 97555)
    ✓ Random_29 (pose=(2.250260768579154, -1.4468494323705858, 0.4390762504336059)): shape (37, 800, 800)
      Valid pixels: 79631/640000 (12.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=72, max=292002, num_faces=292202
      Valid probs shape: (37, 79631)
    P stats: min=0.0000, max=0.9999, mean=0.0249
    Non-zero vertices: 134462/146103
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 11641   599  1059  3693     0  2193   813  4400  5300]
  Ground Truth Stats:
    Labels shape: (146103,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-11/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7149
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7578
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7579

  RESULTS:
  RAW:         median(top-10)=0.8950, mean(top-10)=0.8986, median(all)=0.7645, mean(all)=0.7149
  + SMOOTHING: median(top-10)=0.9202, mean(top-10)=0.9170, median(all)=0.8150, mean(all)=0.7578 [+0.0251]
  + MRF:       median(top-10)=0.9206, mean(top-10)=0.9174, median(all)=0.8151, mean(all)=0.7579 [+0.0005]
  TOTAL IMPROVEMENT (median top-10): +0.0256

================================================================================
Subject: NKI-TRT-20-12
================================================================================
  Step 0: Generating predictions with V2 model (30 random views)...
  Mesh: 117868 vertices, 235732 faces
  Generating 30 random views...
  Generating predictions for 30 views (continuous camera pose)...
    ✓ Random_0 (pose=(-1.4502048713936455, -0.6632600070026959, 1.0335999187477043)): shape (37, 800, 800)
      Valid pixels: 76975/640000 (12.0%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=270, max=235731, num_faces=235732
      Valid probs shape: (37, 76975)
    ✓ Random_1 (pose=(2.005249522854289, -0.9719673752791382, -0.3872370841621118)): shape (37, 800, 800)
      Valid pixels: 108125/640000 (16.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=235539, num_faces=235732
      Valid probs shape: (37, 108125)
    ✓ Random_2 (pose=(-1.7886840665776138, 2.238332148513633, -2.739942685346431)): shape (37, 800, 800)
      Valid pixels: 88459/640000 (13.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=235591, num_faces=235732
      Valid probs shape: (37, 88459)
    ✓ Random_3 (pose=(-1.7140266848339458, 2.2244253022045157, -1.9057531957088636)): shape (37, 800, 800)
      Valid pixels: 69759/640000 (10.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=56, max=235591, num_faces=235732
      Valid probs shape: (37, 69759)
    ✓ Random_4 (pose=(-2.4337368006210904, 1.049265185578756, 1.136577404880044)): shape (37, 800, 800)
      Valid pixels: 87267/640000 (13.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=71, max=235731, num_faces=235732
      Valid probs shape: (37, 87267)
    ✓ Random_5 (pose=(-0.44206939775716014, -2.681987721282549, 1.981991844539265)): shape (37, 800, 800)
      Valid pixels: 79958/640000 (12.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=68, max=235731, num_faces=235732
      Valid probs shape: (37, 79958)
    ✓ Random_6 (pose=(-1.8279301790102427, -0.7343387017144529, -2.085875364659321)): shape (37, 800, 800)
      Valid pixels: 80975/640000 (12.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=10, max=235592, num_faces=235732
      Valid probs shape: (37, 80975)
    ✓ Random_7 (pose=(2.4142484365564734, 2.429642748797616, -2.462384728335351)): shape (37, 800, 800)
      Valid pixels: 89846/640000 (14.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=235559, num_faces=235732
      Valid probs shape: (37, 89846)
    ✓ Random_8 (pose=(2.112236366585453, -1.9128418225501138, 2.7726027504755075)): shape (37, 800, 800)
      Valid pixels: 95860/640000 (15.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=6, max=235731, num_faces=235732
      Valid probs shape: (37, 95860)
    ✓ Random_9 (pose=(1.4364988928113274, 2.252242222556627, -1.8152058498387527)): shape (37, 800, 800)
      Valid pixels: 73306/640000 (11.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=300, max=235731, num_faces=235732
      Valid probs shape: (37, 73306)
    ✓ Random_10 (pose=(-0.5133633535706363, -0.6724141058602338, -0.9429193307426109)): shape (37, 800, 800)
      Valid pixels: 87462/640000 (13.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=235587, num_faces=235732
      Valid probs shape: (37, 87462)
    ✓ Random_11 (pose=(-2.4015475512535556, -0.28673030200625504, 0.40594243617133996)): shape (37, 800, 800)
      Valid pixels: 88222/640000 (13.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3203, max=235731, num_faces=235732
      Valid probs shape: (37, 88222)
    ✓ Random_12 (pose=(-3.0327249825020632, -2.089004066745998, -2.5096974479635024)): shape (37, 800, 800)
      Valid pixels: 92077/640000 (14.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=235721, num_faces=235732
      Valid probs shape: (37, 92077)
    ✓ Random_13 (pose=(0.9527481912419029, -0.45862179750366794, 2.0209678998915575)): shape (37, 800, 800)
      Valid pixels: 71922/640000 (11.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=235591, num_faces=235732
      Valid probs shape: (37, 71922)
    ✓ Random_14 (pose=(-2.230129211603108, 2.4437017103442695, 2.47829167546025)): shape (37, 800, 800)
      Valid pixels: 100941/640000 (15.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=235672, num_faces=235732
      Valid probs shape: (37, 100941)
    ✓ Random_15 (pose=(0.7864591628408055, 2.7558213958760147, 0.229035344078091)): shape (37, 800, 800)
      Valid pixels: 78029/640000 (12.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=12, max=235731, num_faces=235732
      Valid probs shape: (37, 78029)
    ✓ Random_16 (pose=(-1.845836889626573, -2.4920388738802233, 1.4666997825173445)): shape (37, 800, 800)
      Valid pixels: 71957/640000 (11.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=235730, num_faces=235732
      Valid probs shape: (37, 71957)
    ✓ Random_17 (pose=(0.8648092307484365, 1.5112711440944224, 0.06413554975095348)): shape (37, 800, 800)
      Valid pixels: 83513/640000 (13.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=235592, num_faces=235732
      Valid probs shape: (37, 83513)
    ✓ Random_18 (pose=(0.19226652868766791, -1.4672440777875673, 0.3642868022645227)): shape (37, 800, 800)
      Valid pixels: 98506/640000 (15.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=235729, num_faces=235732
      Valid probs shape: (37, 98506)
    ✓ Random_19 (pose=(-2.3306639922535526, 1.5058390839081355, 0.09537201612906676)): shape (37, 800, 800)
      Valid pixels: 80973/640000 (12.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=21, max=235731, num_faces=235732
      Valid probs shape: (37, 80973)
    ✓ Random_20 (pose=(-1.4922770923974356, 0.6031946733316191, 0.5700862769578352)): shape (37, 800, 800)
      Valid pixels: 86373/640000 (13.5%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=4, max=235731, num_faces=235732
      Valid probs shape: (37, 86373)
    ✓ Random_21 (pose=(-0.3763456596774364, -0.021970371538304168, -1.646999835959367)): shape (37, 800, 800)
      Valid pixels: 57542/640000 (9.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=234563, num_faces=235732
      Valid probs shape: (37, 57542)
    ✓ Random_22 (pose=(-0.8186582160938527, -0.8809033732770626, 1.1518527581337183)): shape (37, 800, 800)
      Valid pixels: 70043/640000 (10.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=235728, num_faces=235732
      Valid probs shape: (37, 70043)
    ✓ Random_23 (pose=(-1.3475941220105923, 2.674711992368577, -1.4891173548121426)): shape (37, 800, 800)
      Valid pixels: 67575/640000 (10.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=235731, num_faces=235732
      Valid probs shape: (37, 67575)
    ✓ Random_24 (pose=(-1.5812033555668905, 0.2936962129771592, -1.7428033967405612)): shape (37, 800, 800)
      Valid pixels: 69035/640000 (10.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=56, max=235591, num_faces=235732
      Valid probs shape: (37, 69035)
    ✓ Random_25 (pose=(2.4024895658475263, 2.9285181532186364, 2.4277968158249204)): shape (37, 800, 800)
      Valid pixels: 81273/640000 (12.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=235591, num_faces=235732
      Valid probs shape: (37, 81273)
    ✓ Random_26 (pose=(1.1223349035435364, 0.9403255358027227, -2.587701531947056)): shape (37, 800, 800)
      Valid pixels: 77374/640000 (12.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=235731, num_faces=235732
      Valid probs shape: (37, 77374)
    ✓ Random_27 (pose=(-2.0599373275911432, -1.8335956750868347, -2.398776528579922)): shape (37, 800, 800)
      Valid pixels: 100481/640000 (15.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=235538, num_faces=235732
      Valid probs shape: (37, 100481)
    ✓ Random_28 (pose=(-2.489771906817097, -0.06400920577132663, -1.460438477890493)): shape (37, 800, 800)
      Valid pixels: 61355/640000 (9.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=32234, max=235728, num_faces=235732
      Valid probs shape: (37, 61355)
    ✓ Random_29 (pose=(2.796591920925459, -1.1149879462305954, 1.1288201829287807)): shape (37, 800, 800)
      Valid pixels: 97227/640000 (15.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=281, max=235719, num_faces=235732
      Valid probs shape: (37, 97227)
    P stats: min=0.0000, max=0.9998, mean=0.0258
    Non-zero vertices: 112342/117868
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 5526  923  905 3437    0 2457 1002 3410 5731]
  Ground Truth Stats:
    Labels shape: (117868,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-12/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7650
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8188
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8194

  RESULTS:
  RAW:         median(top-10)=0.8902, mean(top-10)=0.9041, median(all)=0.8233, mean(all)=0.7650
  + SMOOTHING: median(top-10)=0.9081, mean(top-10)=0.9209, median(all)=0.8502, mean(all)=0.8188 [+0.0179]
  + MRF:       median(top-10)=0.9092, mean(top-10)=0.9214, median(all)=0.8506, mean(all)=0.8194 [+0.0011]
  TOTAL IMPROVEMENT (median top-10): +0.0190

================================================================================
Subject: NKI-TRT-20-13
================================================================================
  Step 0: Generating predictions with V2 model (30 random views)...
  Mesh: 168760 vertices, 337516 faces
  Generating 30 random views...
  Generating predictions for 30 views (continuous camera pose)...
    ✓ Random_0 (pose=(2.188215721466353, -2.8113124725614385, 2.621742431421966)): shape (37, 800, 800)
      Valid pixels: 91837/640000 (14.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=336988, num_faces=337516
      Valid probs shape: (37, 91837)
    ✓ Random_1 (pose=(2.8882472354790307, 1.7743410929795047, 1.0976786731762518)): shape (37, 800, 800)
      Valid pixels: 104071/640000 (16.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=11, max=337515, num_faces=337516
      Valid probs shape: (37, 104071)
    ✓ Random_2 (pose=(1.3269282233381512, 1.6749832322575227, -2.3295281846163616)): shape (37, 800, 800)
      Valid pixels: 73607/640000 (11.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=40, max=337512, num_faces=337516
      Valid probs shape: (37, 73607)
    ✓ Random_3 (pose=(0.4818074975731701, 0.26277764289622585, 2.9920523807711277)): shape (37, 800, 800)
      Valid pixels: 66060/640000 (10.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=336876, num_faces=337516
      Valid probs shape: (37, 66060)
    ✓ Random_4 (pose=(-3.0661481718561645, -0.9335006069722005, -2.332743685540089)): shape (37, 800, 800)
      Valid pixels: 90241/640000 (14.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=660, max=337512, num_faces=337516
      Valid probs shape: (37, 90241)
    ✓ Random_5 (pose=(2.085598500701929, 1.9057454037057697, -2.766376746305921)): shape (37, 800, 800)
      Valid pixels: 98442/640000 (15.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=4, max=337511, num_faces=337516
      Valid probs shape: (37, 98442)
    ✓ Random_6 (pose=(2.963329963158399, -0.9246896034060499, -2.018079650675107)): shape (37, 800, 800)
      Valid pixels: 90285/640000 (14.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=525, max=337512, num_faces=337516
      Valid probs shape: (37, 90285)
    ✓ Random_7 (pose=(2.905209727098983, 0.5899343492621694, 2.2271392505533223)): shape (37, 800, 800)
      Valid pixels: 57542/640000 (9.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1054, max=337515, num_faces=337516
      Valid probs shape: (37, 57542)
    ✓ Random_8 (pose=(-1.6072152410325828, -1.2599452360545103, -0.42648788128376847)): shape (37, 800, 800)
      Valid pixels: 101360/640000 (15.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=20, max=337437, num_faces=337516
      Valid probs shape: (37, 101360)
    ✓ Random_9 (pose=(0.39273555922306924, 2.914229042022357, 0.9259113454387098)): shape (37, 800, 800)
      Valid pixels: 47307/640000 (7.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1694, max=337515, num_faces=337516
      Valid probs shape: (37, 47307)
    ✓ Random_10 (pose=(-0.47566899358688364, 1.412058953040737, 0.5098399897397923)): shape (37, 800, 800)
      Valid pixels: 99969/640000 (15.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=9, max=337434, num_faces=337516
      Valid probs shape: (37, 99969)
    ✓ Random_11 (pose=(1.7111276284328314, -1.4228786986946276, -2.1003231676792202)): shape (37, 800, 800)
      Valid pixels: 71890/640000 (11.2%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=32, max=337511, num_faces=337516
      Valid probs shape: (37, 71890)
    ✓ Random_12 (pose=(-1.2340388696089286, 2.7029220877779103, -1.8998559742859162)): shape (37, 800, 800)
      Valid pixels: 70885/640000 (11.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=337515, num_faces=337516
      Valid probs shape: (37, 70885)
    ✓ Random_13 (pose=(-2.5334257112843286, 2.0248718447635463, -0.638922804294674)): shape (37, 800, 800)
      Valid pixels: 86823/640000 (13.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=10, max=337514, num_faces=337516
      Valid probs shape: (37, 86823)
    ✓ Random_14 (pose=(1.5924369781987853, 1.4947081000232068, -2.4510991213255178)): shape (37, 800, 800)
      Valid pixels: 80724/640000 (12.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=35, max=337512, num_faces=337516
      Valid probs shape: (37, 80724)
    ✓ Random_15 (pose=(1.54669658668241, 0.7029563619971664, -0.8557830831660826)): shape (37, 800, 800)
      Valid pixels: 95471/640000 (14.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=32, max=337511, num_faces=337516
      Valid probs shape: (37, 95471)
    ✓ Random_16 (pose=(0.3553133365561707, -0.10134773180626411, -2.0878322928881543)): shape (37, 800, 800)
      Valid pixels: 54320/640000 (8.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=336876, num_faces=337516
      Valid probs shape: (37, 54320)
    ✓ Random_17 (pose=(-1.367910308036489, 2.8054139956089665, -1.3434323100342118)): shape (37, 800, 800)
      Valid pixels: 65526/640000 (10.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=96, max=337435, num_faces=337516
      Valid probs shape: (37, 65526)
    ✓ Random_18 (pose=(2.2585196745933027, 2.998265998901167, 0.114190701327479)): shape (37, 800, 800)
      Valid pixels: 83706/640000 (13.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=337514, num_faces=337516
      Valid probs shape: (37, 83706)
    ✓ Random_19 (pose=(0.4438423586567568, -0.23851851732051932, 1.121676821518136)): shape (37, 800, 800)
      Valid pixels: 59310/640000 (9.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=337505, num_faces=337516
      Valid probs shape: (37, 59310)
    ✓ Random_20 (pose=(0.7369448355105361, 0.6714270099766035, 0.7516298573221407)): shape (37, 800, 800)
      Valid pixels: 60984/640000 (9.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=337515, num_faces=337516
      Valid probs shape: (37, 60984)
    ✓ Random_21 (pose=(1.2745831758228112, 0.0813283519269854, -2.475644727179624)): shape (37, 800, 800)
      Valid pixels: 77128/640000 (12.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=3, max=337512, num_faces=337516
      Valid probs shape: (37, 77128)
    ✓ Random_22 (pose=(0.04338786735362987, -1.8772004524553108, 2.6334453194363574)): shape (37, 800, 800)
      Valid pixels: 70431/640000 (11.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=381, max=337515, num_faces=337516
      Valid probs shape: (37, 70431)
    ✓ Random_23 (pose=(2.023645756760044, 2.404554616892497, -2.8770987824154792)): shape (37, 800, 800)
      Valid pixels: 94647/640000 (14.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=9, max=337509, num_faces=337516
      Valid probs shape: (37, 94647)
    ✓ Random_24 (pose=(-0.33815967570159033, 0.9942295008206576, 1.244769550149475)): shape (37, 800, 800)
      Valid pixels: 87420/640000 (13.7%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=1, max=337505, num_faces=337516
      Valid probs shape: (37, 87420)
    ✓ Random_25 (pose=(3.0072281781832446, 0.6215692470439933, 1.6483992176423952)): shape (37, 800, 800)
      Valid pixels: 70351/640000 (11.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=100, max=337515, num_faces=337516
      Valid probs shape: (37, 70351)
    ✓ Random_26 (pose=(-1.8816548004436624, -2.7095237741824074, 2.043645718187923)): shape (37, 800, 800)
      Valid pixels: 72407/640000 (11.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8, max=337513, num_faces=337516
      Valid probs shape: (37, 72407)
    ✓ Random_27 (pose=(-2.314018368115639, -1.3016253536938167, 0.39112825051485123)): shape (37, 800, 800)
      Valid pixels: 100410/640000 (15.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=337510, num_faces=337516
      Valid probs shape: (37, 100410)
    ✓ Random_28 (pose=(0.06803279015470443, -2.551417795145714, -1.7998940533253727)): shape (37, 800, 800)
      Valid pixels: 73660/640000 (11.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=26802, max=337514, num_faces=337516
      Valid probs shape: (37, 73660)
    ✓ Random_29 (pose=(0.23307195127543645, -2.5226131664985876, -0.42629210124786265)): shape (37, 800, 800)
      Valid pixels: 56643/640000 (8.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1813, max=337512, num_faces=337516
      Valid probs shape: (37, 56643)
    P stats: min=0.0000, max=0.9999, mean=0.0253
    Non-zero vertices: 157953/168760
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 10807  1672  1683  3853     0  2488  1047  5217  9079]
  Ground Truth Stats:
    Labels shape: (168760,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-13/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7739
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8273
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8277

  RESULTS:
  RAW:         median(top-10)=0.8919, mean(top-10)=0.9056, median(all)=0.8204, mean(all)=0.7739
  + SMOOTHING: median(top-10)=0.9247, mean(top-10)=0.9294, median(all)=0.8499, mean(all)=0.8273 [+0.0328]
  + MRF:       median(top-10)=0.9247, mean(top-10)=0.9296, median(all)=0.8504, mean(all)=0.8277 [+0.0000]
  TOTAL IMPROVEMENT (median top-10): +0.0328

================================================================================
Subject: NKI-TRT-20-14
================================================================================
  Step 0: Generating predictions with V2 model (30 random views)...
  Mesh: 142909 vertices, 285814 faces
  Generating 30 random views...
  Generating predictions for 30 views (continuous camera pose)...
    ✓ Random_0 (pose=(-2.0829271369399134, -2.467392072608349, 2.859061503458305)): shape (37, 800, 800)
      Valid pixels: 83399/640000 (13.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6, max=285812, num_faces=285814
      Valid probs shape: (37, 83399)
    ✓ Random_1 (pose=(2.4797146794990574, -2.751311548067321, 2.3409887951109827)): shape (37, 800, 800)
      Valid pixels: 66181/640000 (10.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=285291, num_faces=285814
      Valid probs shape: (37, 66181)
    ✓ Random_2 (pose=(0.41290177079120705, 0.76593210377216, -1.3926906378612534)): shape (37, 800, 800)
      Valid pixels: 72327/640000 (11.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=285813, num_faces=285814
      Valid probs shape: (37, 72327)
    ✓ Random_3 (pose=(0.7662109065511364, 2.027467652101511, -0.6099232453458225)): shape (37, 800, 800)
      Valid pixels: 82129/640000 (12.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7, max=285813, num_faces=285814
      Valid probs shape: (37, 82129)
    ✓ Random_4 (pose=(1.771396509842278, 0.9671801471184942, -2.1453689724673235)): shape (37, 800, 800)
      Valid pixels: 67622/640000 (10.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=26, max=285812, num_faces=285814
      Valid probs shape: (37, 67622)
    ✓ Random_5 (pose=(0.8079814819925994, -2.47363026179414, 1.883274074328102)): shape (37, 800, 800)
      Valid pixels: 58631/640000 (9.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1599, max=285813, num_faces=285814
      Valid probs shape: (37, 58631)
    ✓ Random_6 (pose=(-1.0262915289196672, 1.8334715448280958, -2.4961123071091285)): shape (37, 800, 800)
      Valid pixels: 86254/640000 (13.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7, max=285813, num_faces=285814
      Valid probs shape: (37, 86254)
    ✓ Random_7 (pose=(1.7866389747944655, 0.9386006814829431, -0.1309670777359191)): shape (37, 800, 800)
      Valid pixels: 90999/640000 (14.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7, max=285812, num_faces=285814
      Valid probs shape: (37, 90999)
    ✓ Random_8 (pose=(-1.2532778735083188, 1.4727792864034486, 1.2335905678374015)): shape (37, 800, 800)
      Valid pixels: 67244/640000 (10.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=26, max=285812, num_faces=285814
      Valid probs shape: (37, 67244)
    ✓ Random_9 (pose=(-2.137152832189308, -1.3173743679725083, -1.5066341601130506)): shape (37, 800, 800)
      Valid pixels: 65587/640000 (10.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=285813, num_faces=285814
      Valid probs shape: (37, 65587)
    ✓ Random_10 (pose=(2.238166851496076, 1.9868438816114313, -0.1869289937176699)): shape (37, 800, 800)
      Valid pixels: 83704/640000 (13.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6, max=285812, num_faces=285814
      Valid probs shape: (37, 83704)
    ✓ Random_11 (pose=(2.551607222051917, 2.32774121345619, -0.8166009010287594)): shape (37, 800, 800)
      Valid pixels: 55582/640000 (8.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=285810, num_faces=285814
      Valid probs shape: (37, 55582)
    ✓ Random_12 (pose=(-1.7463931303430464, 2.8200717184417963, 2.095228519368926)): shape (37, 800, 800)
      Valid pixels: 79599/640000 (12.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7, max=285812, num_faces=285814
      Valid probs shape: (37, 79599)
    ✓ Random_13 (pose=(-2.0829320544039804, -1.376993500629683, 2.2983309678167823)): shape (37, 800, 800)
      Valid pixels: 64286/640000 (10.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=11, max=285813, num_faces=285814
      Valid probs shape: (37, 64286)
    ✓ Random_14 (pose=(3.0747265272742457, -1.3211727210246502, 1.889443842944873)): shape (37, 800, 800)
      Valid pixels: 77150/640000 (12.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=69, max=285812, num_faces=285814
      Valid probs shape: (37, 77150)
    ✓ Random_15 (pose=(2.4170593910517093, -2.013349014552186, -2.108115756485102)): shape (37, 800, 800)
      Valid pixels: 63533/640000 (9.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=9, max=285813, num_faces=285814
      Valid probs shape: (37, 63533)
    ✓ Random_16 (pose=(-2.2923489228140035, 2.69549933893423, -2.843728760791583)): shape (37, 800, 800)
      Valid pixels: 62042/640000 (9.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=285813, num_faces=285814
      Valid probs shape: (37, 62042)
    ✓ Random_17 (pose=(2.6579450761828936, 1.5059525110485152, 1.4885283953945416)): shape (37, 800, 800)
      Valid pixels: 79191/640000 (12.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6, max=285812, num_faces=285814
      Valid probs shape: (37, 79191)
    ✓ Random_18 (pose=(-0.25362053370504567, 0.42930204501708324, 2.6950512699246003)): shape (37, 800, 800)
      Valid pixels: 46337/640000 (7.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=285746, num_faces=285814
      Valid probs shape: (37, 46337)
    ✓ Random_19 (pose=(-2.328146365777094, -2.9715129678232564, -2.4618794747171417)): shape (37, 800, 800)
      Valid pixels: 61849/640000 (9.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=285809, num_faces=285814
      Valid probs shape: (37, 61849)
    ✓ Random_20 (pose=(0.1403263709597775, 1.646684609087668, -2.534057953356645)): shape (37, 800, 800)
      Valid pixels: 76323/640000 (11.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=9, max=285813, num_faces=285814
      Valid probs shape: (37, 76323)
    ✓ Random_21 (pose=(-2.820445121226994, -2.5598449566788544, 2.275816614032701)): shape (37, 800, 800)
      Valid pixels: 50925/640000 (8.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=285735, num_faces=285814
      Valid probs shape: (37, 50925)
    ✓ Random_22 (pose=(1.3497651090714093, 2.08713890989016, 1.0777087462738724)): shape (37, 800, 800)
      Valid pixels: 62523/640000 (9.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=285813, num_faces=285814
      Valid probs shape: (37, 62523)
    ✓ Random_23 (pose=(0.03348703415479859, 1.6846577883674732, 0.9581490730525548)): shape (37, 800, 800)
      Valid pixels: 87124/640000 (13.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=285423, num_faces=285814
      Valid probs shape: (37, 87124)
    ✓ Random_24 (pose=(2.20111142923178, 0.21704628941331494, 0.6204859939061462)): shape (37, 800, 800)
      Valid pixels: 67785/640000 (10.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=39, max=285812, num_faces=285814
      Valid probs shape: (37, 67785)
    ✓ Random_25 (pose=(-1.8275518185860085, 1.9836749492342953, -2.459240039625674)): shape (37, 800, 800)
      Valid pixels: 66610/640000 (10.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6, max=285813, num_faces=285814
      Valid probs shape: (37, 66610)
    ✓ Random_26 (pose=(2.0445110289007484, -1.3442951814085684, -0.46544699872464124)): shape (37, 800, 800)
      Valid pixels: 89013/640000 (13.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=285812, num_faces=285814
      Valid probs shape: (37, 89013)
    ✓ Random_27 (pose=(-0.1949355793048535, -0.6578110848016756, 1.126195347297192)): shape (37, 800, 800)
      Valid pixels: 61573/640000 (9.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=285813, num_faces=285814
      Valid probs shape: (37, 61573)
    ✓ Random_28 (pose=(0.23221287853314587, 0.27342963808187903, 1.6226905857339151)): shape (37, 800, 800)
      Valid pixels: 46380/640000 (7.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=285284, num_faces=285814
      Valid probs shape: (37, 46380)
    ✓ Random_29 (pose=(-3.042604807559181, 2.0785263716934494, 2.484315412717165)): shape (37, 800, 800)
      Valid pixels: 62597/640000 (9.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=285813, num_faces=285814
      Valid probs shape: (37, 62597)
    P stats: min=0.0000, max=1.0000, mean=0.0243
    Non-zero vertices: 128504/142909
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 14405  1192  1184  2541     0  2508  1180  4948  6293]
  Ground Truth Stats:
    Labels shape: (142909,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-14/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7496
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8048
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8051

  RESULTS:
  RAW:         median(top-10)=0.8955, mean(top-10)=0.8955, median(all)=0.8314, mean(all)=0.7496
  + SMOOTHING: median(top-10)=0.9193, mean(top-10)=0.9224, median(all)=0.8715, mean(all)=0.8048 [+0.0238]
  + MRF:       median(top-10)=0.9195, mean(top-10)=0.9228, median(all)=0.8719, mean(all)=0.8051 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0240

================================================================================
Subject: NKI-TRT-20-15
================================================================================
  Step 0: Generating predictions with V2 model (30 random views)...
  Mesh: 133351 vertices, 266698 faces
  Generating 30 random views...
  Generating predictions for 30 views (continuous camera pose)...
    ✓ Random_0 (pose=(-0.5814340406912626, -2.6794009910574075, 1.0114588439825614)): shape (37, 800, 800)
      Valid pixels: 70050/640000 (10.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7163, max=266694, num_faces=266698
      Valid probs shape: (37, 70050)
    ✓ Random_1 (pose=(-1.3715467640947168, 0.4750355251198135, -0.28013059679713637)): shape (37, 800, 800)
      Valid pixels: 111756/640000 (17.5%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=9, max=266694, num_faces=266698
      Valid probs shape: (37, 111756)
    ✓ Random_2 (pose=(-0.21616375603955174, -0.22199282473270232, -0.3721046904837668)): shape (37, 800, 800)
      Valid pixels: 63637/640000 (9.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=265863, num_faces=266698
      Valid probs shape: (37, 63637)
    ✓ Random_3 (pose=(-0.9771232238731788, -1.9910131639777198, 3.1101097804362006)): shape (37, 800, 800)
      Valid pixels: 98692/640000 (15.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=191, max=266697, num_faces=266698
      Valid probs shape: (37, 98692)
    ✓ Random_4 (pose=(-0.668045321148393, -1.319710930500591, 2.876960741223656)): shape (37, 800, 800)
      Valid pixels: 94198/640000 (14.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=20, max=266663, num_faces=266698
      Valid probs shape: (37, 94198)
    ✓ Random_5 (pose=(-0.9840668896035627, 1.3991074348092836, 0.449426410083154)): shape (37, 800, 800)
      Valid pixels: 109944/640000 (17.2%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=43, max=266691, num_faces=266698
      Valid probs shape: (37, 109944)
    ✓ Random_6 (pose=(-0.04080470557534621, 2.736482660597172, -2.8825072767076216)): shape (37, 800, 800)
      Valid pixels: 63052/640000 (9.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4115, max=266697, num_faces=266698
      Valid probs shape: (37, 63052)
    ✓ Random_7 (pose=(-1.0012610227791687, -1.4876176438430195, 2.941000795812119)): shape (37, 800, 800)
      Valid pixels: 105931/640000 (16.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=189, max=266694, num_faces=266698
      Valid probs shape: (37, 105931)
    ✓ Random_8 (pose=(-2.3753889364456846, -2.0842862843995347, 2.323928767516551)): shape (37, 800, 800)
      Valid pixels: 64897/640000 (10.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=266663, num_faces=266698
      Valid probs shape: (37, 64897)
    ✓ Random_9 (pose=(0.4848306151526951, -1.6777900883869454, -1.5744314525693575)): shape (37, 800, 800)
      Valid pixels: 94739/640000 (14.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=11, max=266693, num_faces=266698
      Valid probs shape: (37, 94739)
    ✓ Random_10 (pose=(0.046426705450889116, -2.934144507230579, -0.627700442972146)): shape (37, 800, 800)
      Valid pixels: 56979/640000 (8.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8549, max=266697, num_faces=266698
      Valid probs shape: (37, 56979)
    ✓ Random_11 (pose=(0.4791262939632186, 2.7560925734059545, -0.6245036831978021)): shape (37, 800, 800)
      Valid pixels: 80668/640000 (12.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=490, max=266697, num_faces=266698
      Valid probs shape: (37, 80668)
    ✓ Random_12 (pose=(-0.16106245050217893, 2.7606030630684355, 1.468913825622617)): shape (37, 800, 800)
      Valid pixels: 71214/640000 (11.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=9969, max=266696, num_faces=266698
      Valid probs shape: (37, 71214)
    ✓ Random_13 (pose=(0.9056870117271858, -1.8213907769590134, 2.5969261448064174)): shape (37, 800, 800)
      Valid pixels: 86479/640000 (13.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=200, max=266697, num_faces=266698
      Valid probs shape: (37, 86479)
    ✓ Random_14 (pose=(-2.370201479628556, 2.3381428332432037, 2.393693341876035)): shape (37, 800, 800)
      Valid pixels: 101545/640000 (15.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=266663, num_faces=266698
      Valid probs shape: (37, 101545)
    ✓ Random_15 (pose=(-2.542652948535263, 0.03945632105537156, 1.6255271513878933)): shape (37, 800, 800)
      Valid pixels: 66643/640000 (10.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4786, max=266697, num_faces=266698
      Valid probs shape: (37, 66643)
    ✓ Random_16 (pose=(-2.364266889392218, 1.6667519066688392, -1.4633438667966652)): shape (37, 800, 800)
      Valid pixels: 110322/640000 (17.2%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=21, max=266694, num_faces=266698
      Valid probs shape: (37, 110322)
    ✓ Random_17 (pose=(1.2325267325931533, -1.980424130158883, -1.182664447308622)): shape (37, 800, 800)
      Valid pixels: 73994/640000 (11.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=110, max=266663, num_faces=266698
      Valid probs shape: (37, 73994)
    ✓ Random_18 (pose=(0.8244524915233598, 1.8495161973286711, 2.558481395105991)): shape (37, 800, 800)
      Valid pixels: 104017/640000 (16.3%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=46, max=266693, num_faces=266698
      Valid probs shape: (37, 104017)
    ✓ Random_19 (pose=(3.0511907714679065, 2.9723166898906204, -0.22594750032050293)): shape (37, 800, 800)
      Valid pixels: 47454/640000 (7.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=265957, num_faces=266698
      Valid probs shape: (37, 47454)
    ✓ Random_20 (pose=(1.6848647924112345, -2.5048173523528727, -1.1680213276510614)): shape (37, 800, 800)
      Valid pixels: 92736/640000 (14.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=266663, num_faces=266698
      Valid probs shape: (37, 92736)
    ✓ Random_21 (pose=(-0.954015494714822, -1.3658114615302752, -0.19395304257299317)): shape (37, 800, 800)
      Valid pixels: 95659/640000 (14.9%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=42, max=266693, num_faces=266698
      Valid probs shape: (37, 95659)
    ✓ Random_22 (pose=(-0.6484255841020792, 0.5930521123091856, 2.8158644722760373)): shape (37, 800, 800)
      Valid pixels: 75021/640000 (11.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=266663, num_faces=266698
      Valid probs shape: (37, 75021)
    ✓ Random_23 (pose=(1.8062786254702505, 0.45091228307083764, 1.1814462127784955)): shape (37, 800, 800)
      Valid pixels: 78850/640000 (12.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=193, max=266695, num_faces=266698
      Valid probs shape: (37, 78850)
    ✓ Random_24 (pose=(1.0623464875819213, 2.52686058958934, 2.2748664690995923)): shape (37, 800, 800)
      Valid pixels: 104424/640000 (16.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1552, max=266697, num_faces=266698
      Valid probs shape: (37, 104424)
    ✓ Random_25 (pose=(1.0158976678400267, -0.5717281659659603, 0.45669547376915887)): shape (37, 800, 800)
      Valid pixels: 101896/640000 (15.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=266507, num_faces=266698
      Valid probs shape: (37, 101896)
    ✓ Random_26 (pose=(2.853725419333343, 1.6976129010196148, 1.375061041116016)): shape (37, 800, 800)
      Valid pixels: 113525/640000 (17.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=18, max=266684, num_faces=266698
      Valid probs shape: (37, 113525)
    ✓ Random_27 (pose=(0.1398910375292708, -0.41812053313327624, -2.9433323211978473)): shape (37, 800, 800)
      Valid pixels: 69524/640000 (10.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=265389, num_faces=266698
      Valid probs shape: (37, 69524)
    ✓ Random_28 (pose=(0.09279308407769493, 0.9938767714068186, -1.9813473603263996)): shape (37, 800, 800)
      Valid pixels: 94843/640000 (14.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=266663, num_faces=266698
      Valid probs shape: (37, 94843)
    ✓ Random_29 (pose=(-0.4298501569751316, 1.6646958748901337, 1.8720426780324342)): shape (37, 800, 800)
      Valid pixels: 87474/640000 (13.7%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=15, max=266693, num_faces=266698
      Valid probs shape: (37, 87474)
    P stats: min=0.0000, max=0.9999, mean=0.0258
    Non-zero vertices: 127378/133351
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 5973 1234  978 3047    0 1809  940 4935 5673]
  Ground Truth Stats:
    Labels shape: (133351,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-15/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7868
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8344
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8347

  RESULTS:
  RAW:         median(top-10)=0.9193, mean(top-10)=0.9137, median(all)=0.8260, mean(all)=0.7868
  + SMOOTHING: median(top-10)=0.9415, mean(top-10)=0.9376, median(all)=0.8596, mean(all)=0.8344 [+0.0222]
  + MRF:       median(top-10)=0.9420, mean(top-10)=0.9381, median(all)=0.8595, mean(all)=0.8347 [+0.0006]
  TOTAL IMPROVEMENT (median top-10): +0.0228

================================================================================
Subject: NKI-TRT-20-16
================================================================================
  Step 0: Generating predictions with V2 model (30 random views)...
  Mesh: 157852 vertices, 315700 faces
  Generating 30 random views...
  Generating predictions for 30 views (continuous camera pose)...
    ✓ Random_0 (pose=(-3.03870970807822, -1.6295920121066059, -1.7373651343422807)): shape (37, 800, 800)
      Valid pixels: 103185/640000 (16.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=15, max=315627, num_faces=315700
      Valid probs shape: (37, 103185)
    ✓ Random_1 (pose=(0.5454724273533293, -0.3617286353811169, 0.8489150626854354)): shape (37, 800, 800)
      Valid pixels: 69823/640000 (10.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=18, max=315625, num_faces=315700
      Valid probs shape: (37, 69823)
    ✓ Random_2 (pose=(-1.7816841570319777, -0.4212773849236391, 2.0945510118963595)): shape (37, 800, 800)
      Valid pixels: 84774/640000 (13.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=34, max=315699, num_faces=315700
      Valid probs shape: (37, 84774)
    ✓ Random_3 (pose=(-0.02146688611402192, -1.2224418246705906, 1.497423391269491)): shape (37, 800, 800)
      Valid pixels: 97438/640000 (15.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=315625, num_faces=315700
      Valid probs shape: (37, 97438)
    ✓ Random_4 (pose=(1.3252182005243096, -0.0470349218047712, 2.0395293392333675)): shape (37, 800, 800)
      Valid pixels: 82818/640000 (12.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=315557, num_faces=315700
      Valid probs shape: (37, 82818)
    ✓ Random_5 (pose=(-0.17338435153256082, -2.2311217209074266, -1.4022998181965416)): shape (37, 800, 800)
      Valid pixels: 87188/640000 (13.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5405, max=315698, num_faces=315700
      Valid probs shape: (37, 87188)
    ✓ Random_6 (pose=(-0.8400401284965833, 2.216672143029366, 1.9487095670497716)): shape (37, 800, 800)
      Valid pixels: 69991/640000 (10.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=703, max=315699, num_faces=315700
      Valid probs shape: (37, 69991)
    ✓ Random_7 (pose=(1.8523166401276754, -1.4430244418194669, -2.944020709017385)): shape (37, 800, 800)
      Valid pixels: 82525/640000 (12.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=45, max=315699, num_faces=315700
      Valid probs shape: (37, 82525)
    ✓ Random_8 (pose=(-1.9513536981309387, -0.7049320557546377, -0.5149068361677491)): shape (37, 800, 800)
      Valid pixels: 91633/640000 (14.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=417, max=315696, num_faces=315700
      Valid probs shape: (37, 91633)
    ✓ Random_9 (pose=(-2.2233438042181737, 0.38157415276177975, -0.20219079942555496)): shape (37, 800, 800)
      Valid pixels: 87314/640000 (13.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5412, max=315696, num_faces=315700
      Valid probs shape: (37, 87314)
    ✓ Random_10 (pose=(-0.29283347068927723, 3.0494078745161364, -2.130957417436224)): shape (37, 800, 800)
      Valid pixels: 48381/640000 (7.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=700, max=315627, num_faces=315700
      Valid probs shape: (37, 48381)
    ✓ Random_11 (pose=(-0.58364591467604, -1.6916959121385189, 2.9805815311436383)): shape (37, 800, 800)
      Valid pixels: 78060/640000 (12.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=21, max=315627, num_faces=315700
      Valid probs shape: (37, 78060)
    ✓ Random_12 (pose=(3.042271219138705, -2.3771832926487315, -2.785307036637025)): shape (37, 800, 800)
      Valid pixels: 52352/640000 (8.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=28, max=315625, num_faces=315700
      Valid probs shape: (37, 52352)
    ✓ Random_13 (pose=(-2.9102810773962826, 3.055349104781735, 2.758077534149475)): shape (37, 800, 800)
      Valid pixels: 50761/640000 (7.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=17, max=315615, num_faces=315700
      Valid probs shape: (37, 50761)
    ✓ Random_14 (pose=(-2.9302842592143516, -1.3236782221211414, 0.0060673914182385325)): shape (37, 800, 800)
      Valid pixels: 69555/640000 (10.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=383, max=315688, num_faces=315700
      Valid probs shape: (37, 69555)
    ✓ Random_15 (pose=(-2.343077466389889, 2.848261451599398, 0.48903258548528505)): shape (37, 800, 800)
      Valid pixels: 64297/640000 (10.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=19, max=315698, num_faces=315700
      Valid probs shape: (37, 64297)
    ✓ Random_16 (pose=(2.418417298554715, 1.788506576302841, 2.4966156807734965)): shape (37, 800, 800)
      Valid pixels: 66262/640000 (10.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=39, max=315557, num_faces=315700
      Valid probs shape: (37, 66262)
    ✓ Random_17 (pose=(-2.4482967070374517, 1.6168975210570302, -0.5017279681626783)): shape (37, 800, 800)
      Valid pixels: 84110/640000 (13.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=45, max=315699, num_faces=315700
      Valid probs shape: (37, 84110)
    ✓ Random_18 (pose=(-1.9333767566239797, -2.685402618203833, 2.892574660905807)): shape (37, 800, 800)
      Valid pixels: 96563/640000 (15.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=25, max=315625, num_faces=315700
      Valid probs shape: (37, 96563)
    ✓ Random_19 (pose=(-2.8613415735697045, 1.0207631603618292, 0.9482425681184417)): shape (37, 800, 800)
      Valid pixels: 87154/640000 (13.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=22, max=315699, num_faces=315700
      Valid probs shape: (37, 87154)
    ✓ Random_20 (pose=(-1.3475751712501, 2.461932656582462, -0.6399755714223971)): shape (37, 800, 800)
      Valid pixels: 93326/640000 (14.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=145, max=315696, num_faces=315700
      Valid probs shape: (37, 93326)
    ✓ Random_21 (pose=(1.6692508719491892, -2.7903690287105682, 0.9900119916796326)): shape (37, 800, 800)
      Valid pixels: 73792/640000 (11.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=31, max=315625, num_faces=315700
      Valid probs shape: (37, 73792)
    ✓ Random_22 (pose=(1.521281436473557, -0.4574782114173055, -1.3256216577475457)): shape (37, 800, 800)
      Valid pixels: 71812/640000 (11.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=32, max=315699, num_faces=315700
      Valid probs shape: (37, 71812)
    ✓ Random_23 (pose=(0.023692479310634784, 0.5231555932310452, 0.29169465218931023)): shape (37, 800, 800)
      Valid pixels: 59934/640000 (9.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=313690, num_faces=315700
      Valid probs shape: (37, 59934)
    ✓ Random_24 (pose=(-1.0457844818168551, -0.5945206273852524, -2.547406008974091)): shape (37, 800, 800)
      Valid pixels: 73747/640000 (11.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=315625, num_faces=315700
      Valid probs shape: (37, 73747)
    ✓ Random_25 (pose=(0.08473447038885196, -1.6502570746264247, -2.8153476747296393)): shape (37, 800, 800)
      Valid pixels: 80574/640000 (12.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=121, max=315685, num_faces=315700
      Valid probs shape: (37, 80574)
    ✓ Random_26 (pose=(0.3735266510643984, 1.6618616386185323, -2.3457464142779743)): shape (37, 800, 800)
      Valid pixels: 84073/640000 (13.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=34, max=315699, num_faces=315700
      Valid probs shape: (37, 84073)
    ✓ Random_27 (pose=(0.5293159696996401, -1.3309258609752839, 2.372316480542226)): shape (37, 800, 800)
      Valid pixels: 66040/640000 (10.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=40, max=315620, num_faces=315700
      Valid probs shape: (37, 66040)
    ✓ Random_28 (pose=(3.0202362004204124, -0.9418228101198713, 1.1594229047655853)): shape (37, 800, 800)
      Valid pixels: 86404/640000 (13.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=10739, max=315696, num_faces=315700
      Valid probs shape: (37, 86404)
    ✓ Random_29 (pose=(-2.6044928563630814, -1.2393854333680594, -1.489482068368627)): shape (37, 800, 800)
      Valid pixels: 80410/640000 (12.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=22, max=315627, num_faces=315700
      Valid probs shape: (37, 80410)
    P stats: min=0.0000, max=1.0000, mean=0.0253
    Non-zero vertices: 147686/157852
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 10166  1366  1143  3901     0  2298   883  5428  6462]
  Ground Truth Stats:
    Labels shape: (157852,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-16/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7874
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8407
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8411

  RESULTS:
  RAW:         median(top-10)=0.9000, mean(top-10)=0.9050, median(all)=0.8514, mean(all)=0.7874
  + SMOOTHING: median(top-10)=0.9307, mean(top-10)=0.9290, median(all)=0.8640, mean(all)=0.8407 [+0.0308]
  + MRF:       median(top-10)=0.9305, mean(top-10)=0.9291, median(all)=0.8653, mean(all)=0.8411 [-0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0305

================================================================================
Subject: NKI-TRT-20-17
================================================================================
  Step 0: Generating predictions with V2 model (30 random views)...
  Mesh: 135896 vertices, 271788 faces
  Generating 30 random views...
  Generating predictions for 30 views (continuous camera pose)...
    ✓ Random_0 (pose=(-2.902607161385351, -2.42507372036511, -1.0064235634328127)): shape (37, 800, 800)
      Valid pixels: 58642/640000 (9.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=271777, num_faces=271788
      Valid probs shape: (37, 58642)
    ✓ Random_1 (pose=(-2.6206204401154585, -0.9656913388206587, -2.150916070102711)): shape (37, 800, 800)
      Valid pixels: 80088/640000 (12.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=421, max=271787, num_faces=271788
      Valid probs shape: (37, 80088)
    ✓ Random_2 (pose=(0.634200147231966, 2.18020647019413, 2.190857826568249)): shape (37, 800, 800)
      Valid pixels: 84652/640000 (13.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1151, max=271760, num_faces=271788
      Valid probs shape: (37, 84652)
    ✓ Random_3 (pose=(1.8257528075831209, -2.840473353099221, -1.8124019099857382)): shape (37, 800, 800)
      Valid pixels: 64276/640000 (10.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=69, max=271779, num_faces=271788
      Valid probs shape: (37, 64276)
    ✓ Random_4 (pose=(-0.7278562285284793, -2.921895382243049, -0.7048880023361965)): shape (37, 800, 800)
      Valid pixels: 78708/640000 (12.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=12817, max=271781, num_faces=271788
      Valid probs shape: (37, 78708)
    ✓ Random_5 (pose=(1.9273919421953467, -2.5189773891497635, 2.18536193923166)): shape (37, 800, 800)
      Valid pixels: 86135/640000 (13.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=271717, num_faces=271788
      Valid probs shape: (37, 86135)
    ✓ Random_6 (pose=(-2.6242302797099697, 1.2994942894481705, -1.849216808125354)): shape (37, 800, 800)
      Valid pixels: 89723/640000 (14.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=271785, num_faces=271788
      Valid probs shape: (37, 89723)
    ✓ Random_7 (pose=(2.6098685589789072, -2.409617791487223, -0.231111073310454)): shape (37, 800, 800)
      Valid pixels: 66711/640000 (10.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=271785, num_faces=271788
      Valid probs shape: (37, 66711)
    ✓ Random_8 (pose=(1.5615322999784595, 0.016789818351033325, 1.1741390999060428)): shape (37, 800, 800)
      Valid pixels: 65579/640000 (10.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=271779, num_faces=271788
      Valid probs shape: (37, 65579)
    ✓ Random_9 (pose=(-2.392464681662779, -1.487326159155701, 1.7592954652452182)): shape (37, 800, 800)
      Valid pixels: 70818/640000 (11.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=175, max=271778, num_faces=271788
      Valid probs shape: (37, 70818)
    ✓ Random_10 (pose=(2.222803720624019, 1.017322914695158, -1.0853750601230874)): shape (37, 800, 800)
      Valid pixels: 63776/640000 (10.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=189, max=271787, num_faces=271788
      Valid probs shape: (37, 63776)
    ✓ Random_11 (pose=(-0.011267345296951614, 2.8848834953653197, 2.176640077311694)): shape (37, 800, 800)
      Valid pixels: 48767/640000 (7.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=16547, max=271779, num_faces=271788
      Valid probs shape: (37, 48767)
    ✓ Random_12 (pose=(1.0021519880298566, 1.1675914425711271, 1.5505039897545236)): shape (37, 800, 800)
      Valid pixels: 81682/640000 (12.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=271715, num_faces=271788
      Valid probs shape: (37, 81682)
    ✓ Random_13 (pose=(1.1661931413184057, -1.9254598110504084, -1.006040908951972)): shape (37, 800, 800)
      Valid pixels: 69898/640000 (10.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=88, max=271787, num_faces=271788
      Valid probs shape: (37, 69898)
    ✓ Random_14 (pose=(-2.64422722735384, 0.2811507448808692, 2.0876557311343458)): shape (37, 800, 800)
      Valid pixels: 57016/640000 (8.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1816, max=271787, num_faces=271788
      Valid probs shape: (37, 57016)
    ✓ Random_15 (pose=(1.6596894770343225, -0.3344640983816509, -2.3302333722661848)): shape (37, 800, 800)
      Valid pixels: 71614/640000 (11.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=248, max=271719, num_faces=271788
      Valid probs shape: (37, 71614)
    ✓ Random_16 (pose=(-0.975628936826102, -2.2337109887440043, 0.26402897068842357)): shape (37, 800, 800)
      Valid pixels: 71872/640000 (11.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=204, max=271765, num_faces=271788
      Valid probs shape: (37, 71872)
    ✓ Random_17 (pose=(0.500387768637609, -2.9775198628302957, 1.9581681069017076)): shape (37, 800, 800)
      Valid pixels: 52141/640000 (8.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=28894, max=271785, num_faces=271788
      Valid probs shape: (37, 52141)
    ✓ Random_18 (pose=(0.22598401532646406, -2.482519874507071, -2.9451991576794065)): shape (37, 800, 800)
      Valid pixels: 69747/640000 (10.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=15169, max=271785, num_faces=271788
      Valid probs shape: (37, 69747)
    ✓ Random_19 (pose=(0.4685906668549018, 1.0337189562504507, 0.01344846634844199)): shape (37, 800, 800)
      Valid pixels: 63860/640000 (10.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=271786, num_faces=271788
      Valid probs shape: (37, 63860)
    ✓ Random_20 (pose=(-3.0597052464972854, 2.235596724000204, -3.020709292684105)): shape (37, 800, 800)
      Valid pixels: 56802/640000 (8.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=271626, num_faces=271788
      Valid probs shape: (37, 56802)
    ✓ Random_21 (pose=(1.8034359480043136, 0.9980097912136134, -1.1740534121026114)): shape (37, 800, 800)
      Valid pixels: 71652/640000 (11.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=89, max=271787, num_faces=271788
      Valid probs shape: (37, 71652)
    ✓ Random_22 (pose=(0.5192685384908211, -3.0468136842911737, 1.054220401042624)): shape (37, 800, 800)
      Valid pixels: 51142/640000 (8.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3753, max=271787, num_faces=271788
      Valid probs shape: (37, 51142)
    ✓ Random_23 (pose=(-2.610452130174842, 1.730566661614465, -0.3030334108801296)): shape (37, 800, 800)
      Valid pixels: 70991/640000 (11.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=26, max=271719, num_faces=271788
      Valid probs shape: (37, 70991)
    ✓ Random_24 (pose=(2.2541741218944864, -0.4865172841431824, 1.5065290396709354)): shape (37, 800, 800)
      Valid pixels: 69885/640000 (10.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3645, max=271785, num_faces=271788
      Valid probs shape: (37, 69885)
    ✓ Random_25 (pose=(3.099546884576811, 0.44353539503065065, -0.9701885427611558)): shape (37, 800, 800)
      Valid pixels: 54629/640000 (8.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2292, max=271787, num_faces=271788
      Valid probs shape: (37, 54629)
    ✓ Random_26 (pose=(2.8634525554390287, -2.4516620074588973, 2.798229797383966)): shape (37, 800, 800)
      Valid pixels: 56174/640000 (8.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=271713, num_faces=271788
      Valid probs shape: (37, 56174)
    ✓ Random_27 (pose=(1.6355328632796517, 1.165863525388188, 2.4967259967265143)): shape (37, 800, 800)
      Valid pixels: 90922/640000 (14.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=271785, num_faces=271788
      Valid probs shape: (37, 90922)
    ✓ Random_28 (pose=(-1.9985892457832983, 2.793702397121943, -1.544080240160806)): shape (37, 800, 800)
      Valid pixels: 66388/640000 (10.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=271627, num_faces=271788
      Valid probs shape: (37, 66388)
    ✓ Random_29 (pose=(1.3186519862090371, 2.982995454622543, -0.5302181914428612)): shape (37, 800, 800)
      Valid pixels: 93291/640000 (14.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=93, max=271787, num_faces=271788
      Valid probs shape: (37, 93291)
    P stats: min=0.0000, max=0.9999, mean=0.0252
    Non-zero vertices: 126616/135896
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 9280  745 1335 3351    0 1895 1168 4718 6000]
  Ground Truth Stats:
    Labels shape: (135896,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-17/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7604
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8164
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8165

  RESULTS:
  RAW:         median(top-10)=0.9016, mean(top-10)=0.9069, median(all)=0.8290, mean(all)=0.7604
  + SMOOTHING: median(top-10)=0.9262, mean(top-10)=0.9286, median(all)=0.8716, mean(all)=0.8164 [+0.0246]
  + MRF:       median(top-10)=0.9264, mean(top-10)=0.9288, median(all)=0.8718, mean(all)=0.8165 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0248

================================================================================
Subject: NKI-TRT-20-18
================================================================================
  Step 0: Generating predictions with V2 model (30 random views)...
  Mesh: 132036 vertices, 264068 faces
  Generating 30 random views...
  Generating predictions for 30 views (continuous camera pose)...
    ✓ Random_0 (pose=(-2.850841567717175, 1.27466177922531, 1.846018910386257)): shape (37, 800, 800)
      Valid pixels: 103766/640000 (16.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=264063, num_faces=264068
      Valid probs shape: (37, 103766)
    ✓ Random_1 (pose=(0.8310820517302462, -2.9977512277298435, 2.7409754975728573)): shape (37, 800, 800)
      Valid pixels: 85891/640000 (13.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=12419, max=264063, num_faces=264068
      Valid probs shape: (37, 85891)
    ✓ Random_2 (pose=(-2.670424279142934, -1.2446251316006236, -0.943099430655201)): shape (37, 800, 800)
      Valid pixels: 69385/640000 (10.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=264055, num_faces=264068
      Valid probs shape: (37, 69385)
    ✓ Random_3 (pose=(2.0298829418096105, 3.1225279104382606, 1.8951660337699376)): shape (37, 800, 800)
      Valid pixels: 77415/640000 (12.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=263809, num_faces=264068
      Valid probs shape: (37, 77415)
    ✓ Random_4 (pose=(-1.4160786681681876, -2.6852788106509875, -0.5933665783956341)): shape (37, 800, 800)
      Valid pixels: 102343/640000 (16.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=37, max=264013, num_faces=264068
      Valid probs shape: (37, 102343)
    ✓ Random_5 (pose=(-1.9840801503892775, -0.039513017354018576, -1.862740635507451)): shape (37, 800, 800)
      Valid pixels: 65097/640000 (10.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=85, max=263811, num_faces=264068
      Valid probs shape: (37, 65097)
    ✓ Random_6 (pose=(-1.589776008250457, 0.08823847930869455, -2.8326735964164964)): shape (37, 800, 800)
      Valid pixels: 95282/640000 (14.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=17, max=264055, num_faces=264068
      Valid probs shape: (37, 95282)
    ✓ Random_7 (pose=(-2.415915113766859, -2.332954171007084, -2.603268800571441)): shape (37, 800, 800)
      Valid pixels: 92126/640000 (14.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=264055, num_faces=264068
      Valid probs shape: (37, 92126)
    ✓ Random_8 (pose=(-1.2446880083953362, 2.746929129282096, -1.6703582094711231)): shape (37, 800, 800)
      Valid pixels: 65209/640000 (10.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=14, max=263811, num_faces=264068
      Valid probs shape: (37, 65209)
    ✓ Random_9 (pose=(-0.23260147329908865, 2.4906073626362435, -0.9436601895200583)): shape (37, 800, 800)
      Valid pixels: 57998/640000 (9.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=192, max=263804, num_faces=264068
      Valid probs shape: (37, 57998)
    ✓ Random_10 (pose=(-2.4392558145716765, 0.6392644343471989, 0.1650159757289531)): shape (37, 800, 800)
      Valid pixels: 73071/640000 (11.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3193, max=264066, num_faces=264068
      Valid probs shape: (37, 73071)
    ✓ Random_11 (pose=(2.988699198822343, 2.629087885058282, 0.16592215063610105)): shape (37, 800, 800)
      Valid pixels: 55060/640000 (8.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=264064, num_faces=264068
      Valid probs shape: (37, 55060)
    ✓ Random_12 (pose=(1.1138639682758527, -2.642484242218029, 0.6405535755815563)): shape (37, 800, 800)
      Valid pixels: 86731/640000 (13.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=40, max=264065, num_faces=264068
      Valid probs shape: (37, 86731)
    ✓ Random_13 (pose=(-0.8052145277128648, 0.5891662723709921, -1.2690500165976166)): shape (37, 800, 800)
      Valid pixels: 63176/640000 (9.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=263809, num_faces=264068
      Valid probs shape: (37, 63176)
    ✓ Random_14 (pose=(0.539384578312625, -2.713345843231703, -2.1641201785439286)): shape (37, 800, 800)
      Valid pixels: 73420/640000 (11.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4417, max=264064, num_faces=264068
      Valid probs shape: (37, 73420)
    ✓ Random_15 (pose=(0.05237632390652802, 0.892975160092158, -2.3956889016004306)): shape (37, 800, 800)
      Valid pixels: 75683/640000 (11.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=264065, num_faces=264068
      Valid probs shape: (37, 75683)
    ✓ Random_16 (pose=(-1.5881818392279654, -1.479007181261532, -2.9235716444485624)): shape (37, 800, 800)
      Valid pixels: 99916/640000 (15.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=264062, num_faces=264068
      Valid probs shape: (37, 99916)
    ✓ Random_17 (pose=(-0.4284883770398511, -1.5126538241533876, -1.6244549792546032)): shape (37, 800, 800)
      Valid pixels: 103612/640000 (16.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=25, max=264013, num_faces=264068
      Valid probs shape: (37, 103612)
    ✓ Random_18 (pose=(0.5249721698590797, 1.7230902821166652, 1.8177526151415346)): shape (37, 800, 800)
      Valid pixels: 102901/640000 (16.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=37, max=264062, num_faces=264068
      Valid probs shape: (37, 102901)
    ✓ Random_19 (pose=(2.075144430652233, 2.6142092391690444, 1.522661624786804)): shape (37, 800, 800)
      Valid pixels: 66596/640000 (10.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=264055, num_faces=264068
      Valid probs shape: (37, 66596)
    ✓ Random_20 (pose=(2.6149522652618815, 0.27334122249068216, 0.07689783776424441)): shape (37, 800, 800)
      Valid pixels: 74205/640000 (11.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=62, max=264067, num_faces=264068
      Valid probs shape: (37, 74205)
    ✓ Random_21 (pose=(1.039814321767997, 1.900717177295995, 2.477687046859775)): shape (37, 800, 800)
      Valid pixels: 101296/640000 (15.8%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=36, max=264067, num_faces=264068
      Valid probs shape: (37, 101296)
    ✓ Random_22 (pose=(2.658736242708861, -2.2973715949442033, 1.7747877761734214)): shape (37, 800, 800)
      Valid pixels: 92395/640000 (14.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=263923, num_faces=264068
      Valid probs shape: (37, 92395)
    ✓ Random_23 (pose=(3.081030197954049, 2.7153248146533535, 1.597329391435907)): shape (37, 800, 800)
      Valid pixels: 58688/640000 (9.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=263793, num_faces=264068
      Valid probs shape: (37, 58688)
    ✓ Random_24 (pose=(-2.5878793189603573, -2.3027458929008686, -0.02065261885147196)): shape (37, 800, 800)
      Valid pixels: 86571/640000 (13.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=263922, num_faces=264068
      Valid probs shape: (37, 86571)
    ✓ Random_25 (pose=(0.41234767703731734, -1.526197298903344, -0.8102167809666869)): shape (37, 800, 800)
      Valid pixels: 71051/640000 (11.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=2, max=264065, num_faces=264068
      Valid probs shape: (37, 71051)
    ✓ Random_26 (pose=(-1.2810199326173073, 2.073368313183755, 1.650959988230703)): shape (37, 800, 800)
      Valid pixels: 69965/640000 (10.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=143, max=264065, num_faces=264068
      Valid probs shape: (37, 69965)
    ✓ Random_27 (pose=(-2.6254512129273637, -0.1380797587025806, -1.4315777100859632)): shape (37, 800, 800)
      Valid pixels: 50143/640000 (7.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=8055, max=264063, num_faces=264068
      Valid probs shape: (37, 50143)
    ✓ Random_28 (pose=(1.3924110575713895, 2.1362820010591914, -1.1207368715507404)): shape (37, 800, 800)
      Valid pixels: 96444/640000 (15.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=40, max=264065, num_faces=264068
      Valid probs shape: (37, 96444)
    ✓ Random_29 (pose=(1.9067822987977046, -0.12705061489199565, 2.876331167300453)): shape (37, 800, 800)
      Valid pixels: 99538/640000 (15.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=213, max=264067, num_faces=264068
      Valid probs shape: (37, 99538)
    P stats: min=0.0000, max=0.9999, mean=0.0256
    Non-zero vertices: 125207/132036
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 6829 1051  902 3702    0 2155  958 4167 5848]
  Ground Truth Stats:
    Labels shape: (132036,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-18/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7761
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8218
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8219

  RESULTS:
  RAW:         median(top-10)=0.9105, mean(top-10)=0.9075, median(all)=0.8347, mean(all)=0.7761
  + SMOOTHING: median(top-10)=0.9257, mean(top-10)=0.9262, median(all)=0.8746, mean(all)=0.8218 [+0.0152]
  + MRF:       median(top-10)=0.9257, mean(top-10)=0.9263, median(all)=0.8746, mean(all)=0.8219 [-0.0000]
  TOTAL IMPROVEMENT (median top-10): +0.0152

================================================================================
Subject: NKI-TRT-20-19
================================================================================
  Step 0: Generating predictions with V2 model (30 random views)...
  Mesh: 131542 vertices, 263080 faces
  Generating 30 random views...
  Generating predictions for 30 views (continuous camera pose)...
    ✓ Random_0 (pose=(-2.7259354836260394, 1.9909022091422672, -3.0256765993073316)): shape (37, 800, 800)
      Valid pixels: 55651/640000 (8.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=16, max=262997, num_faces=263080
      Valid probs shape: (37, 55651)
    ✓ Random_1 (pose=(0.7356454869325146, -1.5980016734727354, -2.7175198133652856)): shape (37, 800, 800)
      Valid pixels: 88024/640000 (13.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=263070, num_faces=263080
      Valid probs shape: (37, 88024)
    ✓ Random_2 (pose=(-1.214226632046199, 0.9647805393290332, -0.7396373885583922)): shape (37, 800, 800)
      Valid pixels: 79450/640000 (12.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=262997, num_faces=263080
      Valid probs shape: (37, 79450)
    ✓ Random_3 (pose=(-2.090570894639475, 2.368350325392723, -2.9776476863606796)): shape (37, 800, 800)
      Valid pixels: 66619/640000 (10.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=16, max=262833, num_faces=263080
      Valid probs shape: (37, 66619)
    ✓ Random_4 (pose=(0.5708747662776599, -0.12728206546610066, 2.492315738478001)): shape (37, 800, 800)
      Valid pixels: 57814/640000 (9.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=261680, num_faces=263080
      Valid probs shape: (37, 57814)
    ✓ Random_5 (pose=(-0.9044147707254173, 1.2684873654610787, 2.0352310768912076)): shape (37, 800, 800)
      Valid pixels: 59468/640000 (9.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=263077, num_faces=263080
      Valid probs shape: (37, 59468)
    ✓ Random_6 (pose=(1.7447589539225312, -0.812832692110109, 1.2350651962683754)): shape (37, 800, 800)
      Valid pixels: 57444/640000 (9.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=41, max=262998, num_faces=263080
      Valid probs shape: (37, 57444)
    ✓ Random_7 (pose=(-0.5819994162051847, -1.4793886017597737, 2.980167599700164)): shape (37, 800, 800)
      Valid pixels: 64669/640000 (10.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=16, max=262834, num_faces=263080
      Valid probs shape: (37, 64669)
    ✓ Random_8 (pose=(-2.9828896010497394, 2.7774697463195688, 0.9013561261532024)): shape (37, 800, 800)
      Valid pixels: 45202/640000 (7.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=263013, num_faces=263080
      Valid probs shape: (37, 45202)
    ✓ Random_9 (pose=(-1.6637346027048547, -0.11550359906344987, -2.4030328324217187)): shape (37, 800, 800)
      Valid pixels: 66987/640000 (10.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=39, max=262833, num_faces=263080
      Valid probs shape: (37, 66987)
    ✓ Random_10 (pose=(1.3244708043690023, -1.5927838298618808, -0.6931594325785175)): shape (37, 800, 800)
      Valid pixels: 84640/640000 (13.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=263076, num_faces=263080
      Valid probs shape: (37, 84640)
    ✓ Random_11 (pose=(2.792086250955383, -1.7235162633949432, -2.7720364479608497)): shape (37, 800, 800)
      Valid pixels: 60892/640000 (9.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=263078, num_faces=263080
      Valid probs shape: (37, 60892)
    ✓ Random_12 (pose=(-0.4606425208787104, 2.1493168446089204, -2.6708208045386828)): shape (37, 800, 800)
      Valid pixels: 82753/640000 (12.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=122, max=263074, num_faces=263080
      Valid probs shape: (37, 82753)
    ✓ Random_13 (pose=(2.872499302131936, -1.3171152972073434, 1.9915613314029565)): shape (37, 800, 800)
      Valid pixels: 77124/640000 (12.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=263078, num_faces=263080
      Valid probs shape: (37, 77124)
    ✓ Random_14 (pose=(1.006392906586849, 1.001608356260551, 2.6245071269296982)): shape (37, 800, 800)
      Valid pixels: 77978/640000 (12.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=263008, num_faces=263080
      Valid probs shape: (37, 77978)
    ✓ Random_15 (pose=(1.9529286071361902, -0.9381189022956717, -1.8127666666649864)): shape (37, 800, 800)
      Valid pixels: 62265/640000 (9.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=124, max=263076, num_faces=263080
      Valid probs shape: (37, 62265)
    ✓ Random_16 (pose=(2.1305204745867012, 2.9863584274753254, 0.5350265801339567)): shape (37, 800, 800)
      Valid pixels: 65846/640000 (10.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=16, max=262834, num_faces=263080
      Valid probs shape: (37, 65846)
    ✓ Random_17 (pose=(-2.2206574280218137, 1.7972876315567712, -2.665943686406415)): shape (37, 800, 800)
      Valid pixels: 59933/640000 (9.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=15, max=262977, num_faces=263080
      Valid probs shape: (37, 59933)
    ✓ Random_18 (pose=(-1.7407861661017912, -1.2725492272042918, 0.12295095972082404)): shape (37, 800, 800)
      Valid pixels: 82226/640000 (12.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=263072, num_faces=263080
      Valid probs shape: (37, 82226)
    ✓ Random_19 (pose=(-2.1306115345836765, 0.11330227073857824, -1.6154292459826853)): shape (37, 800, 800)
      Valid pixels: 54736/640000 (8.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=214, max=263079, num_faces=263080
      Valid probs shape: (37, 54736)
    ✓ Random_20 (pose=(1.5204476877779918, -1.424130207472984, 2.7337604776690245)): shape (37, 800, 800)
      Valid pixels: 88301/640000 (13.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=12, max=263057, num_faces=263080
      Valid probs shape: (37, 88301)
    ✓ Random_21 (pose=(-2.155450077991479, -0.2860984466173826, -2.236255044078278)): shape (37, 800, 800)
      Valid pixels: 62699/640000 (9.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=29, max=263076, num_faces=263080
      Valid probs shape: (37, 62699)
    ✓ Random_22 (pose=(-1.0002967604348676, -2.1670053173877317, 0.7394273211281313)): shape (37, 800, 800)
      Valid pixels: 60123/640000 (9.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=119, max=263078, num_faces=263080
      Valid probs shape: (37, 60123)
    ✓ Random_23 (pose=(-1.869037549885582, -1.7314498398634948, -3.031535561226561)): shape (37, 800, 800)
      Valid pixels: 90681/640000 (14.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=263015, num_faces=263080
      Valid probs shape: (37, 90681)
    ✓ Random_24 (pose=(-0.07311943178574776, 0.49177652433885566, 1.8988613918911872)): shape (37, 800, 800)
      Valid pixels: 51050/640000 (8.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6, max=262533, num_faces=263080
      Valid probs shape: (37, 51050)
    ✓ Random_25 (pose=(-0.33847389474070244, -0.9274971980200251, -2.994116645861632)): shape (37, 800, 800)
      Valid pixels: 51352/640000 (8.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=18, max=262997, num_faces=263080
      Valid probs shape: (37, 51352)
    ✓ Random_26 (pose=(-1.9144888014556505, 2.8477906480248842, -0.5908194256383763)): shape (37, 800, 800)
      Valid pixels: 84905/640000 (13.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=262998, num_faces=263080
      Valid probs shape: (37, 84905)
    ✓ Random_27 (pose=(1.1224887444834675, -1.6173877706596584, -0.5938137888719641)): shape (37, 800, 800)
      Valid pixels: 81430/640000 (12.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=15, max=263076, num_faces=263080
      Valid probs shape: (37, 81430)
    ✓ Random_28 (pose=(0.18768489251819043, -0.12637554793456474, -2.891355134584989)): shape (37, 800, 800)
      Valid pixels: 44075/640000 (6.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=262783, num_faces=263080
      Valid probs shape: (37, 44075)
    ✓ Random_29 (pose=(-0.8352551266570725, -3.020350301492916, 1.3363713834054805)): shape (37, 800, 800)
      Valid pixels: 51288/640000 (8.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=146, max=263078, num_faces=263080
      Valid probs shape: (37, 51288)
    P stats: min=0.0000, max=1.0000, mean=0.0251
    Non-zero vertices: 122357/131542
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 9185 1233 1038 2905    0 2275  858 4101 6179]
  Ground Truth Stats:
    Labels shape: (131542,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-19/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7887
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8442
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8444

  RESULTS:
  RAW:         median(top-10)=0.9124, mean(top-10)=0.9094, median(all)=0.8577, mean(all)=0.7887
  + SMOOTHING: median(top-10)=0.9311, mean(top-10)=0.9312, median(all)=0.8779, mean(all)=0.8442 [+0.0187]
  + MRF:       median(top-10)=0.9311, mean(top-10)=0.9315, median(all)=0.8781, mean(all)=0.8444 [-0.0000]
  TOTAL IMPROVEMENT (median top-10): +0.0187

================================================================================
Subject: NKI-TRT-20-2
================================================================================
  Step 0: Generating predictions with V2 model (30 random views)...
  Mesh: 174172 vertices, 348340 faces
  Generating 30 random views...
  Generating predictions for 30 views (continuous camera pose)...
    ✓ Random_0 (pose=(1.7699659948704385, -1.6586238550377113, -0.24912674967662607)): shape (37, 800, 800)
      Valid pixels: 92630/640000 (14.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=12, max=348273, num_faces=348340
      Valid probs shape: (37, 92630)
    ✓ Random_1 (pose=(2.6704675761990284, 1.2418951940827823, -0.9667295410260004)): shape (37, 800, 800)
      Valid pixels: 65966/640000 (10.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=349, max=348335, num_faces=348340
      Valid probs shape: (37, 65966)
    ✓ Random_2 (pose=(-2.56181784607598, 1.9643701972557235, -2.674908028703238)): shape (37, 800, 800)
      Valid pixels: 58210/640000 (9.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=348271, num_faces=348340
      Valid probs shape: (37, 58210)
    ✓ Random_3 (pose=(-1.9469342379305392, 0.7618629079399599, 2.4911743937362845)): shape (37, 800, 800)
      Valid pixels: 92318/640000 (14.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=152, max=348339, num_faces=348340
      Valid probs shape: (37, 92318)
    ✓ Random_4 (pose=(-2.4947869157357068, 0.9028320915262915, 0.7756498220548376)): shape (37, 800, 800)
      Valid pixels: 58446/640000 (9.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=580, max=348339, num_faces=348340
      Valid probs shape: (37, 58446)
    ✓ Random_5 (pose=(0.17560120227869946, -0.01598622341220679, 2.619485226805578)): shape (37, 800, 800)
      Valid pixels: 43407/640000 (6.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=347057, num_faces=348340
      Valid probs shape: (37, 43407)
    ✓ Random_6 (pose=(0.18815567770243868, 0.15551571529616126, -1.7557420674598752)): shape (37, 800, 800)
      Valid pixels: 43469/640000 (6.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=348266, num_faces=348340
      Valid probs shape: (37, 43469)
    ✓ Random_7 (pose=(-0.8697421058952273, -0.6540023787885434, -2.4965063668357876)): shape (37, 800, 800)
      Valid pixels: 60517/640000 (9.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=348268, num_faces=348340
      Valid probs shape: (37, 60517)
    ✓ Random_8 (pose=(-2.939698557384686, -0.747533425348037, 0.17886469423685813)): shape (37, 800, 800)
      Valid pixels: 64186/640000 (10.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=33019, max=348338, num_faces=348340
      Valid probs shape: (37, 64186)
    ✓ Random_9 (pose=(0.6559995420464224, -1.2970004648221107, 0.6002189490015133)): shape (37, 800, 800)
      Valid pixels: 92210/640000 (14.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=348273, num_faces=348340
      Valid probs shape: (37, 92210)
    ✓ Random_10 (pose=(-0.02791402451959657, -2.665704513039836, 2.751165995943021)): shape (37, 800, 800)
      Valid pixels: 45052/640000 (7.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=245, max=348339, num_faces=348340
      Valid probs shape: (37, 45052)
    ✓ Random_11 (pose=(-0.9413343034951587, -0.25847775884695245, -2.9301068651439865)): shape (37, 800, 800)
      Valid pixels: 73094/640000 (11.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=348270, num_faces=348340
      Valid probs shape: (37, 73094)
    ✓ Random_12 (pose=(2.5776186722892342, -0.7136164038512289, -1.863403233989702)): shape (37, 800, 800)
      Valid pixels: 66651/640000 (10.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=153, max=348339, num_faces=348340
      Valid probs shape: (37, 66651)
    ✓ Random_13 (pose=(1.8326184626296218, -2.75402268465656, 1.9974874586408653)): shape (37, 800, 800)
      Valid pixels: 77242/640000 (12.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=348216, num_faces=348340
      Valid probs shape: (37, 77242)
    ✓ Random_14 (pose=(2.6195274189497395, 1.8989348261086914, -0.5793428086916386)): shape (37, 800, 800)
      Valid pixels: 57755/640000 (9.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=4, max=348334, num_faces=348340
      Valid probs shape: (37, 57755)
    ✓ Random_15 (pose=(-2.151109251767891, -2.775564066930458, 0.012561839616660908)): shape (37, 800, 800)
      Valid pixels: 79393/640000 (12.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=348175, num_faces=348340
      Valid probs shape: (37, 79393)
    ✓ Random_16 (pose=(-1.7079359214188572, -0.7782313875841269, -2.553059312370948)): shape (37, 800, 800)
      Valid pixels: 77829/640000 (12.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=13, max=348273, num_faces=348340
      Valid probs shape: (37, 77829)
    ✓ Random_17 (pose=(-2.9481368415066287, -0.08106580839071276, 1.1269687577465435)): shape (37, 800, 800)
      Valid pixels: 46730/640000 (7.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=23273, max=348339, num_faces=348340
      Valid probs shape: (37, 46730)
    ✓ Random_18 (pose=(-0.7456095414775965, 2.8268969017178947, 1.04216246897147)): shape (37, 800, 800)
      Valid pixels: 66020/640000 (10.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3107, max=348338, num_faces=348340
      Valid probs shape: (37, 66020)
    ✓ Random_19 (pose=(-0.5772319687805632, -1.8577733288285183, -0.7821935990625648)): shape (37, 800, 800)
      Valid pixels: 81143/640000 (12.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=37, max=348339, num_faces=348340
      Valid probs shape: (37, 81143)
    ✓ Random_20 (pose=(1.283308314694593, 3.1131080369247455, 3.0569757164365843)): shape (37, 800, 800)
      Valid pixels: 85396/640000 (13.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=117, max=348339, num_faces=348340
      Valid probs shape: (37, 85396)
    ✓ Random_21 (pose=(2.41562553137513, 0.18656667647988456, 2.2559389939544747)): shape (37, 800, 800)
      Valid pixels: 64126/640000 (10.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=27982, max=348336, num_faces=348340
      Valid probs shape: (37, 64126)
    ✓ Random_22 (pose=(-2.8941460816895974, 0.21234568565377243, -0.8919916893210305)): shape (37, 800, 800)
      Valid pixels: 56503/640000 (8.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=66166, max=348339, num_faces=348340
      Valid probs shape: (37, 56503)
    ✓ Random_23 (pose=(1.2236242504418158, 0.1759570425144812, -3.1038560869939995)): shape (37, 800, 800)
      Valid pixels: 78520/640000 (12.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=348338, num_faces=348340
      Valid probs shape: (37, 78520)
    ✓ Random_24 (pose=(1.9032754378868244, -1.731199906535794, -2.2467256758010357)): shape (37, 800, 800)
      Valid pixels: 63713/640000 (10.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=28, max=348335, num_faces=348340
      Valid probs shape: (37, 63713)
    ✓ Random_25 (pose=(2.602069019791034, 2.8010253608986133, 3.027117546271427)): shape (37, 800, 800)
      Valid pixels: 62758/640000 (9.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=346950, num_faces=348340
      Valid probs shape: (37, 62758)
    ✓ Random_26 (pose=(1.4124010488091843, 0.38545718148406705, 1.6870068345046922)): shape (37, 800, 800)
      Valid pixels: 63846/640000 (10.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=346945, num_faces=348340
      Valid probs shape: (37, 63846)
    ✓ Random_27 (pose=(2.9695614876403393, -1.7836236639332008, -0.4981464383830394)): shape (37, 800, 800)
      Valid pixels: 67831/640000 (10.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=12, max=348271, num_faces=348340
      Valid probs shape: (37, 67831)
    ✓ Random_28 (pose=(0.6107469407897788, 1.4642689194845007, 3.0403635505975037)): shape (37, 800, 800)
      Valid pixels: 67847/640000 (10.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=8, max=348336, num_faces=348340
      Valid probs shape: (37, 67847)
    ✓ Random_29 (pose=(-2.901823171516174, 1.8195390982974278, 2.051727271105843)): shape (37, 800, 800)
      Valid pixels: 84277/640000 (13.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=348273, num_faces=348340
      Valid probs shape: (37, 84277)
    P stats: min=0.0000, max=1.0000, mean=0.0253
    Non-zero vertices: 162824/174172
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 11348  1949  1457  4335     0  2696  1097  5619  9312]
  Ground Truth Stats:
    Labels shape: (174172,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-2/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7590
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8178
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8179

  RESULTS:
  RAW:         median(top-10)=0.8825, mean(top-10)=0.8880, median(all)=0.8355, mean(all)=0.7590
  + SMOOTHING: median(top-10)=0.9202, mean(top-10)=0.9204, median(all)=0.8767, mean(all)=0.8178 [+0.0376]
  + MRF:       median(top-10)=0.9205, mean(top-10)=0.9206, median(all)=0.8772, mean(all)=0.8179 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0379

================================================================================
Subject: NKI-TRT-20-20
================================================================================
  Step 0: Generating predictions with V2 model (30 random views)...
  Mesh: 147840 vertices, 295676 faces
  Generating 30 random views...
  Generating predictions for 30 views (continuous camera pose)...
    ✓ Random_0 (pose=(-1.6308148739245516, 1.2968283416441393, -0.7349854930819637)): shape (37, 800, 800)
      Valid pixels: 115946/640000 (18.1%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=20, max=295608, num_faces=295676
      Valid probs shape: (37, 115946)
    ✓ Random_1 (pose=(-0.7760319980667654, 1.9603272543822818, 2.7756760870898782)): shape (37, 800, 800)
      Valid pixels: 102230/640000 (16.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=491, max=295668, num_faces=295676
      Valid probs shape: (37, 102230)
    ✓ Random_2 (pose=(2.36885626243195, 0.25061505814419327, 2.247561876814225)): shape (37, 800, 800)
      Valid pixels: 81009/640000 (12.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=16687, max=295673, num_faces=295676
      Valid probs shape: (37, 81009)
    ✓ Random_3 (pose=(-1.8051414840440934, -2.24205224419065, -1.5147050528420298)): shape (37, 800, 800)
      Valid pixels: 76472/640000 (11.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=32, max=295669, num_faces=295676
      Valid probs shape: (37, 76472)
    ✓ Random_4 (pose=(0.26478809697667316, -2.1094083311938063, -0.7985168642094171)): shape (37, 800, 800)
      Valid pixels: 89303/640000 (14.0%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=3792, max=295675, num_faces=295676
      Valid probs shape: (37, 89303)
    ✓ Random_5 (pose=(2.7359817147116443, -1.554406578695975, -2.242712787081799)): shape (37, 800, 800)
      Valid pixels: 102181/640000 (16.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=295668, num_faces=295676
      Valid probs shape: (37, 102181)
    ✓ Random_6 (pose=(-2.8484819238009935, 2.6637552657930472, -2.8833340228897173)): shape (37, 800, 800)
      Valid pixels: 70601/640000 (11.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=295669, num_faces=295676
      Valid probs shape: (37, 70601)
    ✓ Random_7 (pose=(-2.1511180744674303, 1.046815761252537, -2.704954286810014)): shape (37, 800, 800)
      Valid pixels: 85921/640000 (13.4%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=29, max=295667, num_faces=295676
      Valid probs shape: (37, 85921)
    ✓ Random_8 (pose=(-1.1521980210796614, 2.9429148469816644, -0.28707263199442856)): shape (37, 800, 800)
      Valid pixels: 110287/640000 (17.2%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=1477, max=295675, num_faces=295676
      Valid probs shape: (37, 110287)
    ✓ Random_9 (pose=(1.795822171203021, 2.9544558450779785, -2.8095821449739473)): shape (37, 800, 800)
      Valid pixels: 100845/640000 (15.8%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=4, max=295584, num_faces=295676
      Valid probs shape: (37, 100845)
    ✓ Random_10 (pose=(2.7066711272535677, 0.08582266318709086, 2.4206191311872)): shape (37, 800, 800)
      Valid pixels: 70228/640000 (11.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=29688, max=295674, num_faces=295676
      Valid probs shape: (37, 70228)
    ✓ Random_11 (pose=(0.31415541374944933, -0.19920790092238816, -0.01300676947223467)): shape (37, 800, 800)
      Valid pixels: 62614/640000 (9.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=295672, num_faces=295676
      Valid probs shape: (37, 62614)
    ✓ Random_12 (pose=(1.918715577317486, 0.6738989866754879, 1.6840318972243349)): shape (37, 800, 800)
      Valid pixels: 72636/640000 (11.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1168, max=295669, num_faces=295676
      Valid probs shape: (37, 72636)
    ✓ Random_13 (pose=(0.1003008577446094, 2.7813792162423274, -1.9035245146357578)): shape (37, 800, 800)
      Valid pixels: 71397/640000 (11.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2039, max=295675, num_faces=295676
      Valid probs shape: (37, 71397)
    ✓ Random_14 (pose=(-3.114836706319014, -3.1390365210853823, 1.704360672245242)): shape (37, 800, 800)
      Valid pixels: 57214/640000 (8.9%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=0, max=292903, num_faces=295676
      Valid probs shape: (37, 57214)
    ✓ Random_15 (pose=(-1.4759389729618928, 2.764402765272097, 1.4798756566024753)): shape (37, 800, 800)
      Valid pixels: 81149/640000 (12.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=76, max=295675, num_faces=295676
      Valid probs shape: (37, 81149)
    ✓ Random_16 (pose=(1.927660791965657, 2.860053667067884, 2.7226711854665826)): shape (37, 800, 800)
      Valid pixels: 115874/640000 (18.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=6, max=295602, num_faces=295676
      Valid probs shape: (37, 115874)
    ✓ Random_17 (pose=(-0.9417359567886052, 2.284422560200839, 0.8706196651395208)): shape (37, 800, 800)
      Valid pixels: 100378/640000 (15.7%)
      Probs stats: min=0.0000, max=0.9995, mean=0.0270
      Face IDs: min=23, max=295675, num_faces=295676
      Valid probs shape: (37, 100378)
    ✓ Random_18 (pose=(-2.2697533234441236, 2.3585012910879986, 0.08418449904239855)): shape (37, 800, 800)
      Valid pixels: 85325/640000 (13.3%)
      Probs stats: min=0.0000, max=0.9995, mean=0.0270
      Face IDs: min=0, max=295463, num_faces=295676
      Valid probs shape: (37, 85325)
    ✓ Random_19 (pose=(-2.6140152253907267, -1.2093108987998364, 1.0439798375521505)): shape (37, 800, 800)
      Valid pixels: 107691/640000 (16.8%)
      Probs stats: min=0.0000, max=0.9994, mean=0.0270
      Face IDs: min=302, max=295675, num_faces=295676
      Valid probs shape: (37, 107691)
    ✓ Random_20 (pose=(-2.7205310704314014, -2.9921162852651815, 0.4415636123985962)): shape (37, 800, 800)
      Valid pixels: 76157/640000 (11.9%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=0, max=292936, num_faces=295676
      Valid probs shape: (37, 76157)
    ✓ Random_21 (pose=(0.300290622459924, 0.6939358814540468, 0.32870137958019185)): shape (37, 800, 800)
      Valid pixels: 72264/640000 (11.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=295669, num_faces=295676
      Valid probs shape: (37, 72264)
    ✓ Random_22 (pose=(-1.1863932573535567, 0.879552893830752, -0.6685063801093194)): shape (37, 800, 800)
      Valid pixels: 106559/640000 (16.6%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=3, max=295579, num_faces=295676
      Valid probs shape: (37, 106559)
    ✓ Random_23 (pose=(-2.3864455445169193, 2.630398891718949, -1.8139965011481192)): shape (37, 800, 800)
      Valid pixels: 82558/640000 (12.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=293980, num_faces=295676
      Valid probs shape: (37, 82558)
    ✓ Random_24 (pose=(-0.12087466991560492, 1.8219795424020262, 2.642914516774283)): shape (37, 800, 800)
      Valid pixels: 87149/640000 (13.6%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=539, max=295675, num_faces=295676
      Valid probs shape: (37, 87149)
    ✓ Random_25 (pose=(-0.7601437004378471, 0.6516905347045663, -2.825495931321078)): shape (37, 800, 800)
      Valid pixels: 100206/640000 (15.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=295667, num_faces=295676
      Valid probs shape: (37, 100206)
    ✓ Random_26 (pose=(-1.9472658948423744, -0.3513963229424806, -1.178530657091142)): shape (37, 800, 800)
      Valid pixels: 83233/640000 (13.0%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=646, max=295671, num_faces=295676
      Valid probs shape: (37, 83233)
    ✓ Random_27 (pose=(0.29488671614182715, 0.7270484169759004, -2.3085148684789627)): shape (37, 800, 800)
      Valid pixels: 69441/640000 (10.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=295656, num_faces=295676
      Valid probs shape: (37, 69441)
    ✓ Random_28 (pose=(-2.456048570403922, -0.4568700500331486, 0.14837411008150747)): shape (37, 800, 800)
      Valid pixels: 96721/640000 (15.1%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=15635, max=295675, num_faces=295676
      Valid probs shape: (37, 96721)
    ✓ Random_29 (pose=(-2.884472727735587, -0.3048935182639667, 0.17941204987945447)): shape (37, 800, 800)
      Valid pixels: 70539/640000 (11.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=21671, max=295675, num_faces=295676
      Valid probs shape: (37, 70539)
    P stats: min=0.0000, max=1.0000, mean=0.0251
    Non-zero vertices: 137421/147840
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 10419  1349  1397  4351     0  1911   881  4399  5681]
  Ground Truth Stats:
    Labels shape: (147840,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-20/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7739
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8332
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8338

  RESULTS:
  RAW:         median(top-10)=0.8979, mean(top-10)=0.8933, median(all)=0.8303, mean(all)=0.7739
  + SMOOTHING: median(top-10)=0.9193, mean(top-10)=0.9228, median(all)=0.8822, mean(all)=0.8332 [+0.0214]
  + MRF:       median(top-10)=0.9193, mean(top-10)=0.9230, median(all)=0.8826, mean(all)=0.8338 [-0.0000]
  TOTAL IMPROVEMENT (median top-10): +0.0214

================================================================================
Subject: NKI-TRT-20-3
================================================================================
  Step 0: Generating predictions with V2 model (30 random views)...
  Mesh: 123781 vertices, 247558 faces
  Generating 30 random views...
  Generating predictions for 30 views (continuous camera pose)...
    ✓ Random_0 (pose=(2.3215625962141244, -0.5370266176356315, 1.6940262231067846)): shape (37, 800, 800)
      Valid pixels: 90488/640000 (14.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6241, max=247543, num_faces=247558
      Valid probs shape: (37, 90488)
    ✓ Random_1 (pose=(-2.792455943187545, 0.68728495409326, 2.0028229852910693)): shape (37, 800, 800)
      Valid pixels: 96109/640000 (15.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=166, max=247553, num_faces=247558
      Valid probs shape: (37, 96109)
    ✓ Random_2 (pose=(0.2853619151633797, 2.670268544905217, 2.1083261705716883)): shape (37, 800, 800)
      Valid pixels: 84557/640000 (13.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=18634, max=247557, num_faces=247558
      Valid probs shape: (37, 84557)
    ✓ Random_3 (pose=(1.3972605225008312, -1.6120214984060868, 1.1631278444218696)): shape (37, 800, 800)
      Valid pixels: 87217/640000 (13.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=24, max=247553, num_faces=247558
      Valid probs shape: (37, 87217)
    ✓ Random_4 (pose=(1.7563899583263796, -0.1695225005318335, 1.5632542319388687)): shape (37, 800, 800)
      Valid pixels: 72024/640000 (11.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=165, max=245091, num_faces=247558
      Valid probs shape: (37, 72024)
    ✓ Random_5 (pose=(-1.4737394112100572, 1.3237483761732536, 0.14491317332855402)): shape (37, 800, 800)
      Valid pixels: 108104/640000 (16.9%)
      Probs stats: min=0.0000, max=0.9994, mean=0.0270
      Face IDs: min=5, max=247557, num_faces=247558
      Valid probs shape: (37, 108104)
    ✓ Random_6 (pose=(2.829683848155561, 1.6647205742435522, -1.3941310654905097)): shape (37, 800, 800)
      Valid pixels: 93707/640000 (14.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=17, max=247557, num_faces=247558
      Valid probs shape: (37, 93707)
    ✓ Random_7 (pose=(-0.14468423702594757, -0.4139252383017231, 2.929010739792761)): shape (37, 800, 800)
      Valid pixels: 69776/640000 (10.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=247546, num_faces=247558
      Valid probs shape: (37, 69776)
    ✓ Random_8 (pose=(-0.5368511343565472, 2.0711548665012787, -2.666946153301028)): shape (37, 800, 800)
      Valid pixels: 117292/640000 (18.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=60, max=247553, num_faces=247558
      Valid probs shape: (37, 117292)
    ✓ Random_9 (pose=(-2.2403289293495194, -3.058523587488344, 3.119867808560768)): shape (37, 800, 800)
      Valid pixels: 96816/640000 (15.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=247553, num_faces=247558
      Valid probs shape: (37, 96816)
    ✓ Random_10 (pose=(-2.548635949796129, -1.1169565650312365, 0.612236356760385)): shape (37, 800, 800)
      Valid pixels: 110333/640000 (17.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=2020, max=247557, num_faces=247558
      Valid probs shape: (37, 110333)
    ✓ Random_11 (pose=(1.4484814609165682, -2.718617896012374, 1.6981868964690463)): shape (37, 800, 800)
      Valid pixels: 75402/640000 (11.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=160, max=245459, num_faces=247558
      Valid probs shape: (37, 75402)
    ✓ Random_12 (pose=(-1.834036619885968, -1.4209623650353154, 0.2695381240494723)): shape (37, 800, 800)
      Valid pixels: 109727/640000 (17.1%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=30, max=247557, num_faces=247558
      Valid probs shape: (37, 109727)
    ✓ Random_13 (pose=(-0.48289867364921957, 2.233340744759569, -0.9963148904001669)): shape (37, 800, 800)
      Valid pixels: 70270/640000 (11.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1810, max=247552, num_faces=247558
      Valid probs shape: (37, 70270)
    ✓ Random_14 (pose=(1.9857020738571673, -0.0923337309122867, -0.4381151217494108)): shape (37, 800, 800)
      Valid pixels: 118057/640000 (18.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=60, max=247553, num_faces=247558
      Valid probs shape: (37, 118057)
    ✓ Random_15 (pose=(0.5008119936339352, 1.291326865049788, 2.7316499431704973)): shape (37, 800, 800)
      Valid pixels: 87044/640000 (13.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=35, max=247544, num_faces=247558
      Valid probs shape: (37, 87044)
    ✓ Random_16 (pose=(-0.18062896770609882, -0.797747737577001, 0.11125553558192314)): shape (37, 800, 800)
      Valid pixels: 60740/640000 (9.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=247302, num_faces=247558
      Valid probs shape: (37, 60740)
    ✓ Random_17 (pose=(0.6674680895724401, 1.5560909230261162, 3.108637102875816)): shape (37, 800, 800)
      Valid pixels: 86962/640000 (13.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=247557, num_faces=247558
      Valid probs shape: (37, 86962)
    ✓ Random_18 (pose=(-0.3512937918543697, -2.078313757033644, -2.213904937583754)): shape (37, 800, 800)
      Valid pixels: 94172/640000 (14.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3139, max=247541, num_faces=247558
      Valid probs shape: (37, 94172)
    ✓ Random_19 (pose=(-1.540653162866286, 1.7395679447512888, 1.446400008756294)): shape (37, 800, 800)
      Valid pixels: 77748/640000 (12.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=35, max=247557, num_faces=247558
      Valid probs shape: (37, 77748)
    ✓ Random_20 (pose=(2.1357920181122285, -1.006760948253143, 2.9212828876822314)): shape (37, 800, 800)
      Valid pixels: 101232/640000 (15.8%)
      Probs stats: min=0.0000, max=0.9995, mean=0.0270
      Face IDs: min=106, max=247557, num_faces=247558
      Valid probs shape: (37, 101232)
    ✓ Random_21 (pose=(1.5777172150888878, -1.911780968767824, 2.8439169742496944)): shape (37, 800, 800)
      Valid pixels: 114985/640000 (18.0%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=5, max=247557, num_faces=247558
      Valid probs shape: (37, 114985)
    ✓ Random_22 (pose=(2.721265243791592, -0.9482607875588438, 1.6103404679390065)): shape (37, 800, 800)
      Valid pixels: 104383/640000 (16.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=7403, max=247557, num_faces=247558
      Valid probs shape: (37, 104383)
    ✓ Random_23 (pose=(-2.7207843867524115, -1.881443947109632, -1.0587267215572256)): shape (37, 800, 800)
      Valid pixels: 88437/640000 (13.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=3, max=247552, num_faces=247558
      Valid probs shape: (37, 88437)
    ✓ Random_24 (pose=(0.8507806912399869, -1.2326005915757274, -1.4571227955081187)): shape (37, 800, 800)
      Valid pixels: 80559/640000 (12.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=15, max=247557, num_faces=247558
      Valid probs shape: (37, 80559)
    ✓ Random_25 (pose=(-1.7440451159023387, -1.8092081136241085, 1.6363536979953874)): shape (37, 800, 800)
      Valid pixels: 76592/640000 (12.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=11, max=247557, num_faces=247558
      Valid probs shape: (37, 76592)
    ✓ Random_26 (pose=(-2.00186056583619, -1.7036344950540698, -1.566793782841695)): shape (37, 800, 800)
      Valid pixels: 83261/640000 (13.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=58, max=247553, num_faces=247558
      Valid probs shape: (37, 83261)
    ✓ Random_27 (pose=(-1.3403191232426679, 2.583067493149491, -0.06625871355987156)): shape (37, 800, 800)
      Valid pixels: 112820/640000 (17.6%)
      Probs stats: min=0.0000, max=0.9994, mean=0.0270
      Face IDs: min=14, max=247557, num_faces=247558
      Valid probs shape: (37, 112820)
    ✓ Random_28 (pose=(0.404196198771142, 1.3168719084750506, -1.3427064809603926)): shape (37, 800, 800)
      Valid pixels: 116859/640000 (18.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=247553, num_faces=247558
      Valid probs shape: (37, 116859)
    ✓ Random_29 (pose=(1.1010994090033055, -1.7578417488738607, -1.8021124551244732)): shape (37, 800, 800)
      Valid pixels: 88594/640000 (13.8%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=34, max=247557, num_faces=247558
      Valid probs shape: (37, 88594)
    P stats: min=0.0000, max=0.9999, mean=0.0249
    Non-zero vertices: 113930/123781
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 9851 1205  928 3877    0 1638  731 4247 4870]
  Ground Truth Stats:
    Labels shape: (123781,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-3/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7834
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8343
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8345

  RESULTS:
  RAW:         median(top-10)=0.9005, mean(top-10)=0.9000, median(all)=0.8201, mean(all)=0.7834
  + SMOOTHING: median(top-10)=0.9200, mean(top-10)=0.9193, median(all)=0.8777, mean(all)=0.8343 [+0.0195]
  + MRF:       median(top-10)=0.9201, mean(top-10)=0.9195, median(all)=0.8777, mean(all)=0.8345 [+0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0196

================================================================================
Subject: NKI-TRT-20-4
================================================================================
  Step 0: Generating predictions with V2 model (30 random views)...
  Mesh: 158207 vertices, 316410 faces
  Generating 30 random views...
  Generating predictions for 30 views (continuous camera pose)...
    ✓ Random_0 (pose=(-1.8971701742900682, -2.06978425194455, -0.5609084718675641)): shape (37, 800, 800)
      Valid pixels: 109578/640000 (17.1%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=12, max=316396, num_faces=316410
      Valid probs shape: (37, 109578)
    ✓ Random_1 (pose=(-0.8737903920311401, 1.567773288359061, -2.382019871437247)): shape (37, 800, 800)
      Valid pixels: 112854/640000 (17.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=15, max=316409, num_faces=316410
      Valid probs shape: (37, 112854)
    ✓ Random_2 (pose=(-0.10382534628374884, -1.0076606789847138, -0.029290655385488584)): shape (37, 800, 800)
      Valid pixels: 66685/640000 (10.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=11, max=316311, num_faces=316410
      Valid probs shape: (37, 66685)
    ✓ Random_3 (pose=(1.27302501647726, -1.8627542926620775, 0.7745639776120252)): shape (37, 800, 800)
      Valid pixels: 96515/640000 (15.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=40, max=316409, num_faces=316410
      Valid probs shape: (37, 96515)
    ✓ Random_4 (pose=(0.1050697813584609, 2.8148317453665674, 1.8161047654428266)): shape (37, 800, 800)
      Valid pixels: 69899/640000 (10.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=23173, max=316409, num_faces=316410
      Valid probs shape: (37, 69899)
    ✓ Random_5 (pose=(-0.8997477231907016, -0.5866923155919066, -2.858488271604797)): shape (37, 800, 800)
      Valid pixels: 82811/640000 (12.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=316409, num_faces=316410
      Valid probs shape: (37, 82811)
    ✓ Random_6 (pose=(1.9547465136796136, 2.798744951714637, 1.2848589376684423)): shape (37, 800, 800)
      Valid pixels: 76761/640000 (12.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=316409, num_faces=316410
      Valid probs shape: (37, 76761)
    ✓ Random_7 (pose=(0.19520655981680335, -0.49214678634798137, 0.7068053655469244)): shape (37, 800, 800)
      Valid pixels: 70992/640000 (11.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=316404, num_faces=316410
      Valid probs shape: (37, 70992)
    ✓ Random_8 (pose=(-3.0954585324032418, 2.5280344516554347, 0.31258219741277715)): shape (37, 800, 800)
      Valid pixels: 61603/640000 (9.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=316403, num_faces=316410
      Valid probs shape: (37, 61603)
    ✓ Random_9 (pose=(-0.6611435087313904, -0.1591299885112143, 0.7665049535672028)): shape (37, 800, 800)
      Valid pixels: 68215/640000 (10.7%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=1, max=315835, num_faces=316410
      Valid probs shape: (37, 68215)
    ✓ Random_10 (pose=(-1.4816372941463898, 2.1469879714100566, 1.4770520451492057)): shape (37, 800, 800)
      Valid pixels: 76548/640000 (12.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=29, max=316325, num_faces=316410
      Valid probs shape: (37, 76548)
    ✓ Random_11 (pose=(-1.7947453516153133, -1.1993093746768255, -2.316826928881654)): shape (37, 800, 800)
      Valid pixels: 91829/640000 (14.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=11, max=316409, num_faces=316410
      Valid probs shape: (37, 91829)
    ✓ Random_12 (pose=(2.9180679325284933, 1.2504675048289764, 1.7208907343841462)): shape (37, 800, 800)
      Valid pixels: 97791/640000 (15.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=316409, num_faces=316410
      Valid probs shape: (37, 97791)
    ✓ Random_13 (pose=(2.405548212553021, 2.4920657171698615, -0.006287421797690929)): shape (37, 800, 800)
      Valid pixels: 93979/640000 (14.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=316404, num_faces=316410
      Valid probs shape: (37, 93979)
    ✓ Random_14 (pose=(1.318103475619142, -0.6682506545543796, 1.9424547028028654)): shape (37, 800, 800)
      Valid pixels: 85315/640000 (13.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=316393, num_faces=316410
      Valid probs shape: (37, 85315)
    ✓ Random_15 (pose=(1.8840000289844907, 0.6984609891985256, 1.3592549366583677)): shape (37, 800, 800)
      Valid pixels: 76846/640000 (12.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=70, max=316409, num_faces=316410
      Valid probs shape: (37, 76846)
    ✓ Random_16 (pose=(1.0720502991950482, -2.1698243096478858, -1.5901977277116084)): shape (37, 800, 800)
      Valid pixels: 81255/640000 (12.7%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=1462, max=316396, num_faces=316410
      Valid probs shape: (37, 81255)
    ✓ Random_17 (pose=(3.0587909485259805, -0.3612721549823541, -1.7730188172192867)): shape (37, 800, 800)
      Valid pixels: 69549/640000 (10.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=756, max=316409, num_faces=316410
      Valid probs shape: (37, 69549)
    ✓ Random_18 (pose=(-0.5956585060798729, -0.7525014569285644, -2.693833080255215)): shape (37, 800, 800)
      Valid pixels: 72645/640000 (11.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=316409, num_faces=316410
      Valid probs shape: (37, 72645)
    ✓ Random_19 (pose=(-0.07199505167811049, -2.9416669210953517, -0.7782517085649232)): shape (37, 800, 800)
      Valid pixels: 62238/640000 (9.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8158, max=316409, num_faces=316410
      Valid probs shape: (37, 62238)
    ✓ Random_20 (pose=(1.1847037290623224, -0.34579509048059043, -2.24733358643055)): shape (37, 800, 800)
      Valid pixels: 79692/640000 (12.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=10, max=316311, num_faces=316410
      Valid probs shape: (37, 79692)
    ✓ Random_21 (pose=(2.9405107165449937, -1.368295505180558, -1.6421404825335102)): shape (37, 800, 800)
      Valid pixels: 119184/640000 (18.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=39, max=316409, num_faces=316410
      Valid probs shape: (37, 119184)
    ✓ Random_22 (pose=(0.5463174214449289, -0.5397929459684354, 2.4985934875354987)): shape (37, 800, 800)
      Valid pixels: 78410/640000 (12.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=316220, num_faces=316410
      Valid probs shape: (37, 78410)
    ✓ Random_23 (pose=(-1.2795716467225362, 0.7111279702498678, -2.0319527245312092)): shape (37, 800, 800)
      Valid pixels: 82541/640000 (12.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=18, max=316409, num_faces=316410
      Valid probs shape: (37, 82541)
    ✓ Random_24 (pose=(-2.1508923482086373, -2.502613957090148, 2.719594663180964)): shape (37, 800, 800)
      Valid pixels: 97659/640000 (15.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=13, max=316403, num_faces=316410
      Valid probs shape: (37, 97659)
    ✓ Random_25 (pose=(-0.5201560508930956, -0.5628049520548424, -0.4095072518747416)): shape (37, 800, 800)
      Valid pixels: 81874/640000 (12.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=316207, num_faces=316410
      Valid probs shape: (37, 81874)
    ✓ Random_26 (pose=(-0.5700841875215374, -1.2468763621639631, -1.163270140220949)): shape (37, 800, 800)
      Valid pixels: 108468/640000 (16.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=0, max=316303, num_faces=316410
      Valid probs shape: (37, 108468)
    ✓ Random_27 (pose=(2.050906572416822, -0.07492444312468871, 1.3341588122632855)): shape (37, 800, 800)
      Valid pixels: 69105/640000 (10.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=449, max=316409, num_faces=316410
      Valid probs shape: (37, 69105)
    ✓ Random_28 (pose=(-1.5294982070011924, 2.9327767508447273, 2.3484048489374594)): shape (37, 800, 800)
      Valid pixels: 113878/640000 (17.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=40, max=316409, num_faces=316410
      Valid probs shape: (37, 113878)
    ✓ Random_29 (pose=(-0.6874480203154518, -0.4275964759170847, -0.8895185642138781)): shape (37, 800, 800)
      Valid pixels: 97012/640000 (15.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=316213, num_faces=316410
      Valid probs shape: (37, 97012)
    P stats: min=0.0000, max=0.9999, mean=0.0248
    Non-zero vertices: 145172/158207
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 13035   923  1072  3605     0  2859  1108  5728  7352]
  Ground Truth Stats:
    Labels shape: (158207,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-4/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7358
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7898
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7902

  RESULTS:
  RAW:         median(top-10)=0.8858, mean(top-10)=0.8880, median(all)=0.7994, mean(all)=0.7358
  + SMOOTHING: median(top-10)=0.9084, mean(top-10)=0.9117, median(all)=0.8459, mean(all)=0.7898 [+0.0226]
  + MRF:       median(top-10)=0.9089, mean(top-10)=0.9120, median(all)=0.8472, mean(all)=0.7902 [+0.0004]
  TOTAL IMPROVEMENT (median top-10): +0.0231

================================================================================
Subject: NKI-TRT-20-5
================================================================================
  Step 0: Generating predictions with V2 model (30 random views)...
  Mesh: 137753 vertices, 275502 faces
  Generating 30 random views...
  Generating predictions for 30 views (continuous camera pose)...
    ✓ Random_0 (pose=(-1.6075639886169675, 0.7154769370207519, -0.8493952965869309)): shape (37, 800, 800)
      Valid pixels: 95183/640000 (14.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=275116, num_faces=275502
      Valid probs shape: (37, 95183)
    ✓ Random_1 (pose=(0.6103218716607306, -1.478063519434449, 0.022783628219042118)): shape (37, 800, 800)
      Valid pixels: 93613/640000 (14.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=275501, num_faces=275502
      Valid probs shape: (37, 93613)
    ✓ Random_2 (pose=(2.6376894237688484, -2.431049616765528, -1.1239273384682704)): shape (37, 800, 800)
      Valid pixels: 85228/640000 (13.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=275499, num_faces=275502
      Valid probs shape: (37, 85228)
    ✓ Random_3 (pose=(-0.1638199530882578, 2.200471399134326, -0.816474436763241)): shape (37, 800, 800)
      Valid pixels: 72355/640000 (11.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1229, max=275501, num_faces=275502
      Valid probs shape: (37, 72355)
    ✓ Random_4 (pose=(0.905821433165678, -1.553124601601659, 2.7386874251271305)): shape (37, 800, 800)
      Valid pixels: 85998/640000 (13.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=273940, num_faces=275502
      Valid probs shape: (37, 85998)
    ✓ Random_5 (pose=(-2.5799600405162812, -2.096385471294472, -0.7466355450497786)): shape (37, 800, 800)
      Valid pixels: 62063/640000 (9.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=275497, num_faces=275502
      Valid probs shape: (37, 62063)
    ✓ Random_6 (pose=(1.8606220966628433, -2.431317439715621, 2.1177433758641255)): shape (37, 800, 800)
      Valid pixels: 92418/640000 (14.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=14, max=273938, num_faces=275502
      Valid probs shape: (37, 92418)
    ✓ Random_7 (pose=(1.4915714399887934, -0.26467900672432343, 0.16175964610019555)): shape (37, 800, 800)
      Valid pixels: 100229/640000 (15.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=275501, num_faces=275502
      Valid probs shape: (37, 100229)
    ✓ Random_8 (pose=(-2.528249079406046, -2.9398298236283926, 1.006060056196338)): shape (37, 800, 800)
      Valid pixels: 63108/640000 (9.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=3, max=275285, num_faces=275502
      Valid probs shape: (37, 63108)
    ✓ Random_9 (pose=(-3.058160016155695, 1.1142417894860284, 1.3124625335639788)): shape (37, 800, 800)
      Valid pixels: 96792/640000 (15.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=61, max=275501, num_faces=275502
      Valid probs shape: (37, 96792)
    ✓ Random_10 (pose=(-0.32236826967030074, -0.6707908265840818, -1.1609988543403327)): shape (37, 800, 800)
      Valid pixels: 75389/640000 (11.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=274429, num_faces=275502
      Valid probs shape: (37, 75389)
    ✓ Random_11 (pose=(-0.36744828953619635, 2.5301630747858184, 1.5934031648174463)): shape (37, 800, 800)
      Valid pixels: 72852/640000 (11.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4128, max=275462, num_faces=275502
      Valid probs shape: (37, 72852)
    ✓ Random_12 (pose=(-2.3214935569718307, 1.1624307284159983, 3.0601561242344513)): shape (37, 800, 800)
      Valid pixels: 83824/640000 (13.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=66, max=275501, num_faces=275502
      Valid probs shape: (37, 83824)
    ✓ Random_13 (pose=(2.9945601797807564, 1.2833302191511402, -0.8096921252446561)): shape (37, 800, 800)
      Valid pixels: 76952/640000 (12.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=130, max=275460, num_faces=275502
      Valid probs shape: (37, 76952)
    ✓ Random_14 (pose=(2.157996812139044, 3.104007143449129, 2.6476168998972334)): shape (37, 800, 800)
      Valid pixels: 87922/640000 (13.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=275106, num_faces=275502
      Valid probs shape: (37, 87922)
    ✓ Random_15 (pose=(-1.1804850330023142, 2.318349054320554, 0.5137245107791077)): shape (37, 800, 800)
      Valid pixels: 91088/640000 (14.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=170, max=275454, num_faces=275502
      Valid probs shape: (37, 91088)
    ✓ Random_16 (pose=(-1.904309320920042, 0.5808147054185735, 0.23493543012680806)): shape (37, 800, 800)
      Valid pixels: 86010/640000 (13.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=199, max=275460, num_faces=275502
      Valid probs shape: (37, 86010)
    ✓ Random_17 (pose=(-1.5111805101036673, 1.7476490218910907, 1.281711965324817)): shape (37, 800, 800)
      Valid pixels: 73810/640000 (11.5%)
      Probs stats: min=0.0000, max=0.9995, mean=0.0270
      Face IDs: min=56, max=275460, num_faces=275502
      Valid probs shape: (37, 73810)
    ✓ Random_18 (pose=(0.8401650540624832, 1.3169550816739237, 1.406302233748078)): shape (37, 800, 800)
      Valid pixels: 86954/640000 (13.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=4, max=273939, num_faces=275502
      Valid probs shape: (37, 86954)
    ✓ Random_19 (pose=(-1.6687148882550393, -0.9500633974160064, -0.8038624593685513)): shape (37, 800, 800)
      Valid pixels: 93259/640000 (14.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=275091, num_faces=275502
      Valid probs shape: (37, 93259)
    ✓ Random_20 (pose=(-1.0141305068118007, -2.457384248416667, -0.6143709825262063)): shape (37, 800, 800)
      Valid pixels: 96411/640000 (15.1%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=465, max=275459, num_faces=275502
      Valid probs shape: (37, 96411)
    ✓ Random_21 (pose=(0.6961552800144424, -0.40763137026348817, 0.13197699494075588)): shape (37, 800, 800)
      Valid pixels: 82190/640000 (12.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=275501, num_faces=275502
      Valid probs shape: (37, 82190)
    ✓ Random_22 (pose=(2.3184424458938357, 1.369220441155437, 0.5238824895437668)): shape (37, 800, 800)
      Valid pixels: 105737/640000 (16.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=275499, num_faces=275502
      Valid probs shape: (37, 105737)
    ✓ Random_23 (pose=(-1.4790111403929957, 2.793701273216307, 1.179031973081032)): shape (37, 800, 800)
      Valid pixels: 74919/640000 (11.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=62, max=275460, num_faces=275502
      Valid probs shape: (37, 74919)
    ✓ Random_24 (pose=(2.6866672327443917, -2.056916073894965, -2.6798141833618567)): shape (37, 800, 800)
      Valid pixels: 65235/640000 (10.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=275462, num_faces=275502
      Valid probs shape: (37, 65235)
    ✓ Random_25 (pose=(-0.9627690755572376, -2.1562053499860205, 1.6239213260913026)): shape (37, 800, 800)
      Valid pixels: 88059/640000 (13.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=113, max=275500, num_faces=275502
      Valid probs shape: (37, 88059)
    ✓ Random_26 (pose=(3.1382238454869746, -2.5640678116946276, -1.8401185725275282)): shape (37, 800, 800)
      Valid pixels: 71127/640000 (11.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=275497, num_faces=275502
      Valid probs shape: (37, 71127)
    ✓ Random_27 (pose=(-2.3254969908141536, 1.3446648683946432, 1.481596598292625)): shape (37, 800, 800)
      Valid pixels: 93875/640000 (14.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6, max=275500, num_faces=275502
      Valid probs shape: (37, 93875)
    ✓ Random_28 (pose=(-1.7131378546350569, -1.9763729596999766, 0.49257214697882956)): shape (37, 800, 800)
      Valid pixels: 86841/640000 (13.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=4, max=275454, num_faces=275502
      Valid probs shape: (37, 86841)
    ✓ Random_29 (pose=(1.3043483810797323, 1.8598989655846285, -0.3268657255884926)): shape (37, 800, 800)
      Valid pixels: 104845/640000 (16.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=19, max=275501, num_faces=275502
      Valid probs shape: (37, 104845)
    P stats: min=0.0000, max=0.9999, mean=0.0250
    Non-zero vertices: 127324/137753
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 10429  1696  1170  3062     0  2563   887  4663  7070]
  Ground Truth Stats:
    Labels shape: (137753,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-5/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7661
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8096
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8095

  RESULTS:
  RAW:         median(top-10)=0.8966, mean(top-10)=0.8938, median(all)=0.8254, mean(all)=0.7661
  + SMOOTHING: median(top-10)=0.9272, mean(top-10)=0.9235, median(all)=0.8537, mean(all)=0.8096 [+0.0306]
  + MRF:       median(top-10)=0.9276, mean(top-10)=0.9239, median(all)=0.8554, mean(all)=0.8095 [+0.0004]
  TOTAL IMPROVEMENT (median top-10): +0.0310

================================================================================
Subject: NKI-TRT-20-6
================================================================================
  Step 0: Generating predictions with V2 model (30 random views)...
  Mesh: 158025 vertices, 316046 faces
  Generating 30 random views...
  Generating predictions for 30 views (continuous camera pose)...
    ✓ Random_0 (pose=(-0.8259859708794619, -0.5541956674793105, 1.4567012011664158)): shape (37, 800, 800)
      Valid pixels: 65091/640000 (10.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=316009, num_faces=316046
      Valid probs shape: (37, 65091)
    ✓ Random_1 (pose=(-0.9995125380944301, -1.9990365267613308, -2.647954517211457)): shape (37, 800, 800)
      Valid pixels: 73012/640000 (11.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=12, max=316035, num_faces=316046
      Valid probs shape: (37, 73012)
    ✓ Random_2 (pose=(2.2087830201639855, 2.7091139202404335, -2.1818383970075965)): shape (37, 800, 800)
      Valid pixels: 73196/640000 (11.4%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=9, max=315949, num_faces=316046
      Valid probs shape: (37, 73196)
    ✓ Random_3 (pose=(-1.1401233630485672, -2.3729427482624637, -1.3581212113299381)): shape (37, 800, 800)
      Valid pixels: 89371/640000 (14.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1246, max=316022, num_faces=316046
      Valid probs shape: (37, 89371)
    ✓ Random_4 (pose=(1.171918243953617, 0.4881450251086701, -1.915823422197232)): shape (37, 800, 800)
      Valid pixels: 60894/640000 (9.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=21, max=316045, num_faces=316046
      Valid probs shape: (37, 60894)
    ✓ Random_5 (pose=(-0.3231062079493161, 1.4481996617200732, -2.0678838013349496)): shape (37, 800, 800)
      Valid pixels: 110866/640000 (17.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=11, max=316043, num_faces=316046
      Valid probs shape: (37, 110866)
    ✓ Random_6 (pose=(-0.3650498670768747, 0.7578306613998302, 0.2254486831203497)): shape (37, 800, 800)
      Valid pixels: 89942/640000 (14.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=314995, num_faces=316046
      Valid probs shape: (37, 89942)
    ✓ Random_7 (pose=(0.9123269539276455, 1.1797413910719872, 1.486688274861451)): shape (37, 800, 800)
      Valid pixels: 95112/640000 (14.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=20, max=314908, num_faces=316046
      Valid probs shape: (37, 95112)
    ✓ Random_8 (pose=(0.47973358037858693, 2.694069727608915, -1.6652155515924418)): shape (37, 800, 800)
      Valid pixels: 78333/640000 (12.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=166, max=316045, num_faces=316046
      Valid probs shape: (37, 78333)
    ✓ Random_9 (pose=(-1.5263512643086141, 2.7751408636979322, -0.4753374669126713)): shape (37, 800, 800)
      Valid pixels: 107659/640000 (16.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=2, max=315767, num_faces=316046
      Valid probs shape: (37, 107659)
    ✓ Random_10 (pose=(-1.4638771188149087, -1.6382973765910156, -0.9518601693907582)): shape (37, 800, 800)
      Valid pixels: 101750/640000 (15.9%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=12, max=315793, num_faces=316046
      Valid probs shape: (37, 101750)
    ✓ Random_11 (pose=(0.3862966351903938, -1.3471339825053543, 1.999354621494124)): shape (37, 800, 800)
      Valid pixels: 79729/640000 (12.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=316043, num_faces=316046
      Valid probs shape: (37, 79729)
    ✓ Random_12 (pose=(-1.8062812441735834, -0.4098915033402215, -0.003048231215564634)): shape (37, 800, 800)
      Valid pixels: 102272/640000 (16.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=181, max=316041, num_faces=316046
      Valid probs shape: (37, 102272)
    ✓ Random_13 (pose=(-1.6004780885450272, -0.16457625604442372, -1.7396884229044989)): shape (37, 800, 800)
      Valid pixels: 65223/640000 (10.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=23, max=316029, num_faces=316046
      Valid probs shape: (37, 65223)
    ✓ Random_14 (pose=(0.42669872436424594, 1.4359932737614658, 1.9334698058430497)): shape (37, 800, 800)
      Valid pixels: 103348/640000 (16.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=8, max=316035, num_faces=316046
      Valid probs shape: (37, 103348)
    ✓ Random_15 (pose=(0.9410418955146058, -1.9703171087430398, 2.153142024273114)): shape (37, 800, 800)
      Valid pixels: 61731/640000 (9.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=810, max=316029, num_faces=316046
      Valid probs shape: (37, 61731)
    ✓ Random_16 (pose=(0.7344778848744462, -0.38151133077739985, 1.1454331192033838)): shape (37, 800, 800)
      Valid pixels: 71814/640000 (11.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=316043, num_faces=316046
      Valid probs shape: (37, 71814)
    ✓ Random_17 (pose=(0.4786182443566527, -2.3452147426463408, 2.2048174412687542)): shape (37, 800, 800)
      Valid pixels: 58627/640000 (9.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2977, max=316029, num_faces=316046
      Valid probs shape: (37, 58627)
    ✓ Random_18 (pose=(2.8242844060058347, -3.0961990899413503, 0.4148335204555762)): shape (37, 800, 800)
      Valid pixels: 57889/640000 (9.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=316043, num_faces=316046
      Valid probs shape: (37, 57889)
    ✓ Random_19 (pose=(2.587701227166198, -1.682727696452512, 1.875658466600484)): shape (37, 800, 800)
      Valid pixels: 107308/640000 (16.8%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=12, max=315816, num_faces=316046
      Valid probs shape: (37, 107308)
    ✓ Random_20 (pose=(0.2187756748947951, 1.2283640002439116, -0.6270815155146381)): shape (37, 800, 800)
      Valid pixels: 81104/640000 (12.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=316043, num_faces=316046
      Valid probs shape: (37, 81104)
    ✓ Random_21 (pose=(2.3443569756841587, 1.9247050996948323, -0.38449284913641213)): shape (37, 800, 800)
      Valid pixels: 84972/640000 (13.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=18, max=316045, num_faces=316046
      Valid probs shape: (37, 84972)
    ✓ Random_22 (pose=(-1.659014345323284, 3.014669080807052, -0.6636564290714655)): shape (37, 800, 800)
      Valid pixels: 106739/640000 (16.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=13, max=315788, num_faces=316046
      Valid probs shape: (37, 106739)
    ✓ Random_23 (pose=(-2.735311661796441, -0.37179450243027645, 2.5466540659756145)): shape (37, 800, 800)
      Valid pixels: 64839/640000 (10.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3819, max=316045, num_faces=316046
      Valid probs shape: (37, 64839)
    ✓ Random_24 (pose=(0.5590669008783311, -0.5777842982367574, -2.9325885460864654)): shape (37, 800, 800)
      Valid pixels: 91640/640000 (14.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=2, max=315011, num_faces=316046
      Valid probs shape: (37, 91640)
    ✓ Random_25 (pose=(0.9399919148941454, -0.5154590140533379, -1.5158904055999458)): shape (37, 800, 800)
      Valid pixels: 58934/640000 (9.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=10, max=316044, num_faces=316046
      Valid probs shape: (37, 58934)
    ✓ Random_26 (pose=(-0.4590558485206895, -2.7195690564923294, -0.6527891182854804)): shape (37, 800, 800)
      Valid pixels: 76467/640000 (11.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=13254, max=316044, num_faces=316046
      Valid probs shape: (37, 76467)
    ✓ Random_27 (pose=(-2.8055484625281633, 0.050354318102659334, 0.25625266189789997)): shape (37, 800, 800)
      Valid pixels: 61177/640000 (9.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=9644, max=316045, num_faces=316046
      Valid probs shape: (37, 61177)
    ✓ Random_28 (pose=(-0.6847492142236531, -2.3536374927882386, 2.817590927752148)): shape (37, 800, 800)
      Valid pixels: 85461/640000 (13.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=316043, num_faces=316046
      Valid probs shape: (37, 85461)
    ✓ Random_29 (pose=(1.6409474982827792, 2.9634900825613695, -2.892856428916326)): shape (37, 800, 800)
      Valid pixels: 94191/640000 (14.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=34, max=316041, num_faces=316046
      Valid probs shape: (37, 94191)
    P stats: min=0.0000, max=0.9999, mean=0.0254
    Non-zero vertices: 148318/158025
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 9707 1347 1021 3592    0 2277  980 5569 8215]
  Ground Truth Stats:
    Labels shape: (158025,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-6/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7880
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8377
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8385

  RESULTS:
  RAW:         median(top-10)=0.9049, mean(top-10)=0.9098, median(all)=0.8486, mean(all)=0.7880
  + SMOOTHING: median(top-10)=0.9263, mean(top-10)=0.9307, median(all)=0.8909, mean(all)=0.8377 [+0.0215]
  + MRF:       median(top-10)=0.9268, mean(top-10)=0.9310, median(all)=0.8914, mean(all)=0.8385 [+0.0005]
  TOTAL IMPROVEMENT (median top-10): +0.0219

================================================================================
Subject: NKI-TRT-20-7
================================================================================
  Step 0: Generating predictions with V2 model (30 random views)...
  Mesh: 145017 vertices, 290030 faces
  Generating 30 random views...
  Generating predictions for 30 views (continuous camera pose)...
    ✓ Random_0 (pose=(2.6177391016977847, -0.049983002048079594, -3.0492601330361135)): shape (37, 800, 800)
      Valid pixels: 69284/640000 (10.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8736, max=290029, num_faces=290030
      Valid probs shape: (37, 69284)
    ✓ Random_1 (pose=(0.8213343460581433, 0.7822201554293766, -2.0432376870941775)): shape (37, 800, 800)
      Valid pixels: 58520/640000 (9.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=290029, num_faces=290030
      Valid probs shape: (37, 58520)
    ✓ Random_2 (pose=(2.890936339927988, 1.937311048091459, -0.1372568777775709)): shape (37, 800, 800)
      Valid pixels: 63201/640000 (9.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=18, max=290028, num_faces=290030
      Valid probs shape: (37, 63201)
    ✓ Random_3 (pose=(2.0300394422480563, -0.9027332378230235, -0.002628657079776886)): shape (37, 800, 800)
      Valid pixels: 87892/640000 (13.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=289950, num_faces=290030
      Valid probs shape: (37, 87892)
    ✓ Random_4 (pose=(-0.36211512275204427, 1.2898121888234, 0.5507529307021692)): shape (37, 800, 800)
      Valid pixels: 96612/640000 (15.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=4, max=290021, num_faces=290030
      Valid probs shape: (37, 96612)
    ✓ Random_5 (pose=(1.192688048658776, 0.8190207785124297, -1.2643757583901047)): shape (37, 800, 800)
      Valid pixels: 85220/640000 (13.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=15, max=290027, num_faces=290030
      Valid probs shape: (37, 85220)
    ✓ Random_6 (pose=(1.41814397625222, 2.8616426386071545, 1.6950988750524836)): shape (37, 800, 800)
      Valid pixels: 69533/640000 (10.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=290011, num_faces=290030
      Valid probs shape: (37, 69533)
    ✓ Random_7 (pose=(-2.356107594759276, -2.625423758550967, -2.7308411194756586)): shape (37, 800, 800)
      Valid pixels: 81829/640000 (12.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=289952, num_faces=290030
      Valid probs shape: (37, 81829)
    ✓ Random_8 (pose=(0.8020404957480647, -0.3476497005785699, -3.001018919222136)): shape (37, 800, 800)
      Valid pixels: 82828/640000 (12.9%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=4, max=290028, num_faces=290030
      Valid probs shape: (37, 82828)
    ✓ Random_9 (pose=(2.4137985776991835, 1.6672158767528247, -0.44150589127540707)): shape (37, 800, 800)
      Valid pixels: 76025/640000 (11.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=28, max=290028, num_faces=290030
      Valid probs shape: (37, 76025)
    ✓ Random_10 (pose=(-2.2125258972415383, 1.3940239425461787, -0.44490228717395564)): shape (37, 800, 800)
      Valid pixels: 88381/640000 (13.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=11, max=290029, num_faces=290030
      Valid probs shape: (37, 88381)
    ✓ Random_11 (pose=(1.4050231146737477, -2.2997861076239667, 2.560472441285441)): shape (37, 800, 800)
      Valid pixels: 95704/640000 (15.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=16, max=290028, num_faces=290030
      Valid probs shape: (37, 95704)
    ✓ Random_12 (pose=(1.044605779553204, -1.0510547565482975, 1.784938755579307)): shape (37, 800, 800)
      Valid pixels: 68999/640000 (10.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=288698, num_faces=290030
      Valid probs shape: (37, 68999)
    ✓ Random_13 (pose=(-2.24504368188314, -0.05571162090787274, 1.2149736330617023)): shape (37, 800, 800)
      Valid pixels: 70694/640000 (11.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1901, max=290029, num_faces=290030
      Valid probs shape: (37, 70694)
    ✓ Random_14 (pose=(0.6952769200949178, -2.2564365539783036, -2.3064546368706003)): shape (37, 800, 800)
      Valid pixels: 86368/640000 (13.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1562, max=290029, num_faces=290030
      Valid probs shape: (37, 86368)
    ✓ Random_15 (pose=(-1.4012556569790882, -2.679052052040853, -2.6953442679399133)): shape (37, 800, 800)
      Valid pixels: 84209/640000 (13.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=289636, num_faces=290030
      Valid probs shape: (37, 84209)
    ✓ Random_16 (pose=(-0.07622388035272554, 3.1214142794141155, -0.8951505347633928)): shape (37, 800, 800)
      Valid pixels: 46131/640000 (7.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=14318, max=290029, num_faces=290030
      Valid probs shape: (37, 46131)
    ✓ Random_17 (pose=(-0.028223660093637193, -2.664186417203223, -1.6745758751572022)): shape (37, 800, 800)
      Valid pixels: 67241/640000 (10.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=28472, max=290029, num_faces=290030
      Valid probs shape: (37, 67241)
    ✓ Random_18 (pose=(-1.3718043872767063, 2.494316345247676, -2.039173063419791)): shape (37, 800, 800)
      Valid pixels: 74188/640000 (11.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=289864, num_faces=290030
      Valid probs shape: (37, 74188)
    ✓ Random_19 (pose=(-2.2851284578632445, 1.7443162484548989, -0.5528722644519086)): shape (37, 800, 800)
      Valid pixels: 88485/640000 (13.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=11, max=290027, num_faces=290030
      Valid probs shape: (37, 88485)
    ✓ Random_20 (pose=(1.9571437024734557, 1.5057178643874929, 1.7423621555383093)): shape (37, 800, 800)
      Valid pixels: 68211/640000 (10.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=289864, num_faces=290030
      Valid probs shape: (37, 68211)
    ✓ Random_21 (pose=(1.73621376701922, -0.46279447698011955, -2.340776997833429)): shape (37, 800, 800)
      Valid pixels: 77037/640000 (12.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=7, max=290029, num_faces=290030
      Valid probs shape: (37, 77037)
    ✓ Random_22 (pose=(-1.0878425052452614, 0.452473176638998, 1.8897012099435306)): shape (37, 800, 800)
      Valid pixels: 60732/640000 (9.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=17, max=290027, num_faces=290030
      Valid probs shape: (37, 60732)
    ✓ Random_23 (pose=(-0.5921945268841102, -2.8588510268414127, -1.9573888812324174)): shape (37, 800, 800)
      Valid pixels: 50851/640000 (7.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=33006, max=290028, num_faces=290030
      Valid probs shape: (37, 50851)
    ✓ Random_24 (pose=(0.6022933477622359, 0.8616412953306183, -2.0973961747356586)): shape (37, 800, 800)
      Valid pixels: 62481/640000 (9.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=289974, num_faces=290030
      Valid probs shape: (37, 62481)
    ✓ Random_25 (pose=(0.3853828320517336, -2.0314656393188892, 2.124811347552722)): shape (37, 800, 800)
      Valid pixels: 70014/640000 (10.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=420, max=289374, num_faces=290030
      Valid probs shape: (37, 70014)
    ✓ Random_26 (pose=(-2.877530763621701, 0.19020808920579402, -2.0169871042626752)): shape (37, 800, 800)
      Valid pixels: 48300/640000 (7.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=77215, max=290029, num_faces=290030
      Valid probs shape: (37, 48300)
    ✓ Random_27 (pose=(-2.6419864615190622, -2.5926553947702553, 2.865914252664817)): shape (37, 800, 800)
      Valid pixels: 60410/640000 (9.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=289970, num_faces=290030
      Valid probs shape: (37, 60410)
    ✓ Random_28 (pose=(0.8000839877309152, 0.9514503772020806, 0.5041126056814762)): shape (37, 800, 800)
      Valid pixels: 70097/640000 (11.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=289864, num_faces=290030
      Valid probs shape: (37, 70097)
    ✓ Random_29 (pose=(0.7486893809383974, 3.0930671375812118, 1.350789392308311)): shape (37, 800, 800)
      Valid pixels: 53010/640000 (8.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6512, max=290021, num_faces=290030
      Valid probs shape: (37, 53010)
    P stats: min=0.0000, max=1.0000, mean=0.0244
    Non-zero vertices: 130813/145017
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 14204  1383  1013  4028     0  1850   929  4938  5076]
  Ground Truth Stats:
    Labels shape: (145017,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-7/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7691
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8290
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8292

  RESULTS:
  RAW:         median(top-10)=0.9015, mean(top-10)=0.8948, median(all)=0.8312, mean(all)=0.7691
  + SMOOTHING: median(top-10)=0.9243, mean(top-10)=0.9272, median(all)=0.8660, mean(all)=0.8290 [+0.0229]
  + MRF:       median(top-10)=0.9247, mean(top-10)=0.9275, median(all)=0.8669, mean(all)=0.8292 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0232

================================================================================
Subject: NKI-TRT-20-8
================================================================================
  Step 0: Generating predictions with V2 model (30 random views)...
  Mesh: 147404 vertices, 294804 faces
  Generating 30 random views...
  Generating predictions for 30 views (continuous camera pose)...
    ✓ Random_0 (pose=(-2.034390436433354, -0.9876442737778395, 1.7699603096100462)): shape (37, 800, 800)
      Valid pixels: 66041/640000 (10.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=155, max=294801, num_faces=294804
      Valid probs shape: (37, 66041)
    ✓ Random_1 (pose=(2.192889199297678, -0.5931932626206584, 1.9642033395076899)): shape (37, 800, 800)
      Valid pixels: 84587/640000 (13.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=438, max=294780, num_faces=294804
      Valid probs shape: (37, 84587)
    ✓ Random_2 (pose=(-2.6794993996322414, -1.5457873997353029, 1.1520451311807118)): shape (37, 800, 800)
      Valid pixels: 88464/640000 (13.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=15, max=294692, num_faces=294804
      Valid probs shape: (37, 88464)
    ✓ Random_3 (pose=(-1.9107580955789851, -1.3884625278989542, 2.1252172208860207)): shape (37, 800, 800)
      Valid pixels: 70527/640000 (11.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=13, max=294800, num_faces=294804
      Valid probs shape: (37, 70527)
    ✓ Random_4 (pose=(2.9566543198951836, 1.095260333829513, 0.6395046700640021)): shape (37, 800, 800)
      Valid pixels: 84873/640000 (13.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=12, max=294801, num_faces=294804
      Valid probs shape: (37, 84873)
    ✓ Random_5 (pose=(1.0053732052156832, 2.183485676163202, -1.2885843047809211)): shape (37, 800, 800)
      Valid pixels: 87637/640000 (13.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=12, max=294792, num_faces=294804
      Valid probs shape: (37, 87637)
    ✓ Random_6 (pose=(0.7624420054184835, 0.8497217683683278, 0.2019764049687458)): shape (37, 800, 800)
      Valid pixels: 69112/640000 (10.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=294761, num_faces=294804
      Valid probs shape: (37, 69112)
    ✓ Random_7 (pose=(-2.731979462412641, -0.4273287265508494, -2.3293281487772557)): shape (37, 800, 800)
      Valid pixels: 59691/640000 (9.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3264, max=294777, num_faces=294804
      Valid probs shape: (37, 59691)
    ✓ Random_8 (pose=(2.8234118232939975, 3.0643079591194526, -0.07934356168924284)): shape (37, 800, 800)
      Valid pixels: 55378/640000 (8.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=294685, num_faces=294804
      Valid probs shape: (37, 55378)
    ✓ Random_9 (pose=(2.096317371595413, 1.1553118234853486, 0.8341852316020724)): shape (37, 800, 800)
      Valid pixels: 84120/640000 (13.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=32, max=294762, num_faces=294804
      Valid probs shape: (37, 84120)
    ✓ Random_10 (pose=(-0.45044529343046147, -2.2418930255060916, -0.48667873906677883)): shape (37, 800, 800)
      Valid pixels: 75908/640000 (11.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=522, max=294794, num_faces=294804
      Valid probs shape: (37, 75908)
    ✓ Random_11 (pose=(-2.493596172900402, -1.6362049457281902, 2.213382514549747)): shape (37, 800, 800)
      Valid pixels: 66131/640000 (10.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=16, max=294779, num_faces=294804
      Valid probs shape: (37, 66131)
    ✓ Random_12 (pose=(2.9436869365346414, -0.9723665691737824, 0.6325052957693456)): shape (37, 800, 800)
      Valid pixels: 71807/640000 (11.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6779, max=294789, num_faces=294804
      Valid probs shape: (37, 71807)
    ✓ Random_13 (pose=(1.138187440848827, -2.1476054409298255, 1.2104831994240532)): shape (37, 800, 800)
      Valid pixels: 72247/640000 (11.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=10, max=294762, num_faces=294804
      Valid probs shape: (37, 72247)
    ✓ Random_14 (pose=(3.0840658734182576, 1.4787584400566898, -0.38620160756890654)): shape (37, 800, 800)
      Valid pixels: 67346/640000 (10.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=54, max=294801, num_faces=294804
      Valid probs shape: (37, 67346)
    ✓ Random_15 (pose=(-0.494290915844672, -2.983005941629135, 2.2839786756475444)): shape (37, 800, 800)
      Valid pixels: 58362/640000 (9.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2291, max=294797, num_faces=294804
      Valid probs shape: (37, 58362)
    ✓ Random_16 (pose=(-2.399985875190308, 0.5424998737385569, -2.7689116247270187)): shape (37, 800, 800)
      Valid pixels: 63521/640000 (9.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2312, max=294801, num_faces=294804
      Valid probs shape: (37, 63521)
    ✓ Random_17 (pose=(2.281609641156985, 1.6974210623853532, 2.803372600929616)): shape (37, 800, 800)
      Valid pixels: 82927/640000 (13.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=294788, num_faces=294804
      Valid probs shape: (37, 82927)
    ✓ Random_18 (pose=(-2.9147228446707403, 3.0054483987239013, -0.9863050849954642)): shape (37, 800, 800)
      Valid pixels: 51303/640000 (8.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=293992, num_faces=294804
      Valid probs shape: (37, 51303)
    ✓ Random_19 (pose=(2.340281123358582, -1.9213085326479793, -0.2963189878237764)): shape (37, 800, 800)
      Valid pixels: 83272/640000 (13.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=294780, num_faces=294804
      Valid probs shape: (37, 83272)
    ✓ Random_20 (pose=(0.7235521887446188, 0.9197284483065689, 0.7628143019892315)): shape (37, 800, 800)
      Valid pixels: 59525/640000 (9.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=293191, num_faces=294804
      Valid probs shape: (37, 59525)
    ✓ Random_21 (pose=(2.4134584979510105, 2.2268315055979864, 1.0211943011024154)): shape (37, 800, 800)
      Valid pixels: 83041/640000 (13.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=294738, num_faces=294804
      Valid probs shape: (37, 83041)
    ✓ Random_22 (pose=(1.9228933091307256, -1.457156996079038, 2.9672468413203728)): shape (37, 800, 800)
      Valid pixels: 85427/640000 (13.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=15, max=294775, num_faces=294804
      Valid probs shape: (37, 85427)
    ✓ Random_23 (pose=(-0.7177180488981416, 0.6700703873485105, -0.3597635905538392)): shape (37, 800, 800)
      Valid pixels: 73944/640000 (11.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=294398, num_faces=294804
      Valid probs shape: (37, 73944)
    ✓ Random_24 (pose=(-0.5454387984223819, 1.7318659514993637, 1.9460481714490934)): shape (37, 800, 800)
      Valid pixels: 71170/640000 (11.1%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=165, max=294796, num_faces=294804
      Valid probs shape: (37, 71170)
    ✓ Random_25 (pose=(2.3465136140968896, 2.349399849462091, -1.4362142213520077)): shape (37, 800, 800)
      Valid pixels: 62196/640000 (9.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=294731, num_faces=294804
      Valid probs shape: (37, 62196)
    ✓ Random_26 (pose=(2.029661747248648, 1.0040175669712097, -1.3348561718048864)): shape (37, 800, 800)
      Valid pixels: 65808/640000 (10.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=142, max=294803, num_faces=294804
      Valid probs shape: (37, 65808)
    ✓ Random_27 (pose=(3.0641096091326236, 1.3647876812569715, 1.2141762418746023)): shape (37, 800, 800)
      Valid pixels: 95361/640000 (14.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=8, max=294802, num_faces=294804
      Valid probs shape: (37, 95361)
    ✓ Random_28 (pose=(1.6539194111762194, 1.234683563167728, 1.9261431515296605)): shape (37, 800, 800)
      Valid pixels: 72222/640000 (11.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=17, max=294578, num_faces=294804
      Valid probs shape: (37, 72222)
    ✓ Random_29 (pose=(1.6586771499565254, -0.9414624477183047, 2.0328320237123148)): shape (37, 800, 800)
      Valid pixels: 83220/640000 (13.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=13, max=294790, num_faces=294804
      Valid probs shape: (37, 83220)
    P stats: min=0.0000, max=0.9999, mean=0.0250
    Non-zero vertices: 136381/147404
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 11023  1616   889  2853     0  2579  1612  4937  6585]
  Ground Truth Stats:
    Labels shape: (147404,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-8/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7260
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7817
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7821

  RESULTS:
  RAW:         median(top-10)=0.8742, mean(top-10)=0.8839, median(all)=0.8122, mean(all)=0.7260
  + SMOOTHING: median(top-10)=0.9038, mean(top-10)=0.9105, median(all)=0.8424, mean(all)=0.7817 [+0.0296]
  + MRF:       median(top-10)=0.9044, mean(top-10)=0.9108, median(all)=0.8424, mean(all)=0.7821 [+0.0006]
  TOTAL IMPROVEMENT (median top-10): +0.0302

================================================================================
Subject: NKI-TRT-20-9
================================================================================
  Step 0: Generating predictions with V2 model (30 random views)...
  Mesh: 141802 vertices, 283600 faces
  Generating 30 random views...
  Generating predictions for 30 views (continuous camera pose)...
    ✓ Random_0 (pose=(0.8095546590086258, -1.2969929178224255, 2.2208036545592424)): shape (37, 800, 800)
      Valid pixels: 59687/640000 (9.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=12, max=283568, num_faces=283600
      Valid probs shape: (37, 59687)
    ✓ Random_1 (pose=(-1.8257095878406624, -1.6775595722375714, -1.0682133742869788)): shape (37, 800, 800)
      Valid pixels: 72736/640000 (11.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=9, max=283569, num_faces=283600
      Valid probs shape: (37, 72736)
    ✓ Random_2 (pose=(-2.2361402263850017, 2.43893694819495, 0.2458140196322942)): shape (37, 800, 800)
      Valid pixels: 71388/640000 (11.2%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=1, max=283593, num_faces=283600
      Valid probs shape: (37, 71388)
    ✓ Random_3 (pose=(-2.9206827465463006, 1.649985614265959, -0.4623540245423863)): shape (37, 800, 800)
      Valid pixels: 72814/640000 (11.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=196, max=283595, num_faces=283600
      Valid probs shape: (37, 72814)
    ✓ Random_4 (pose=(0.9901814114395169, -2.3820969074473193, 2.937475761556553)): shape (37, 800, 800)
      Valid pixels: 96329/640000 (15.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=106, max=283589, num_faces=283600
      Valid probs shape: (37, 96329)
    ✓ Random_5 (pose=(1.0012689123276246, -1.8133380914579709, -0.6455643911431883)): shape (37, 800, 800)
      Valid pixels: 81656/640000 (12.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=88, max=283599, num_faces=283600
      Valid probs shape: (37, 81656)
    ✓ Random_6 (pose=(2.612118897472511, 2.9471686694473203, -2.463030549469849)): shape (37, 800, 800)
      Valid pixels: 64486/640000 (10.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=283593, num_faces=283600
      Valid probs shape: (37, 64486)
    ✓ Random_7 (pose=(-3.0277158588423427, -1.8285306984842313, -2.851032834042401)): shape (37, 800, 800)
      Valid pixels: 79607/640000 (12.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=23, max=283590, num_faces=283600
      Valid probs shape: (37, 79607)
    ✓ Random_8 (pose=(-1.4660248287201691, 0.16020742352793738, 0.6254793815558002)): shape (37, 800, 800)
      Valid pixels: 80602/640000 (12.6%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=72, max=283599, num_faces=283600
      Valid probs shape: (37, 80602)
    ✓ Random_9 (pose=(2.748050490949626, 1.34286192528928, 2.0099436921116354)): shape (37, 800, 800)
      Valid pixels: 75607/640000 (11.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=308, max=283562, num_faces=283600
      Valid probs shape: (37, 75607)
    ✓ Random_10 (pose=(-0.077953764797837, -1.8143512395266976, 3.0306311926892544)): shape (37, 800, 800)
      Valid pixels: 61030/640000 (9.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=797, max=283562, num_faces=283600
      Valid probs shape: (37, 61030)
    ✓ Random_11 (pose=(-2.574669098307871, 1.1529439213659671, -1.4710608211168492)): shape (37, 800, 800)
      Valid pixels: 99698/640000 (15.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=82, max=283592, num_faces=283600
      Valid probs shape: (37, 99698)
    ✓ Random_12 (pose=(-1.2320061651587149, 1.9413592999701264, -2.114250854657046)): shape (37, 800, 800)
      Valid pixels: 81151/640000 (12.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=37, max=283562, num_faces=283600
      Valid probs shape: (37, 81151)
    ✓ Random_13 (pose=(-1.6001670515111321, 2.7377371602183382, -2.627083601526751)): shape (37, 800, 800)
      Valid pixels: 89068/640000 (13.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=283563, num_faces=283600
      Valid probs shape: (37, 89068)
    ✓ Random_14 (pose=(2.9027333121248553, -0.4046891214470074, 3.037663968232634)): shape (37, 800, 800)
      Valid pixels: 57447/640000 (9.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1246, max=283593, num_faces=283600
      Valid probs shape: (37, 57447)
    ✓ Random_15 (pose=(0.9483864903077706, 0.2562406586638488, -1.5749843349885086)): shape (37, 800, 800)
      Valid pixels: 57729/640000 (9.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=283512, num_faces=283600
      Valid probs shape: (37, 57729)
    ✓ Random_16 (pose=(0.666444336859938, 2.385046586657243, 0.033735707134973314)): shape (37, 800, 800)
      Valid pixels: 72187/640000 (11.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=935, max=283566, num_faces=283600
      Valid probs shape: (37, 72187)
    ✓ Random_17 (pose=(-2.9778178038620235, 1.0184317520396524, -1.8035763822207231)): shape (37, 800, 800)
      Valid pixels: 94590/640000 (14.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=430, max=283593, num_faces=283600
      Valid probs shape: (37, 94590)
    ✓ Random_18 (pose=(1.9333355441196272, 1.4125401285535553, 0.569516474345467)): shape (37, 800, 800)
      Valid pixels: 101581/640000 (15.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=283563, num_faces=283600
      Valid probs shape: (37, 101581)
    ✓ Random_19 (pose=(-0.08727867651448484, 0.2088844917196062, -0.3508659599904105)): shape (37, 800, 800)
      Valid pixels: 46836/640000 (7.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=280391, num_faces=283600
      Valid probs shape: (37, 46836)
    ✓ Random_20 (pose=(-0.998304629315593, -0.14203755390582273, -0.2982042084216774)): shape (37, 800, 800)
      Valid pixels: 92632/640000 (14.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=283589, num_faces=283600
      Valid probs shape: (37, 92632)
    ✓ Random_21 (pose=(0.24118295730184958, 0.9942554263994969, -0.5978250183369962)): shape (37, 800, 800)
      Valid pixels: 74221/640000 (11.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=283563, num_faces=283600
      Valid probs shape: (37, 74221)
    ✓ Random_22 (pose=(-2.2376220024425404, -1.398770045052926, -2.2379864063479733)): shape (37, 800, 800)
      Valid pixels: 100593/640000 (15.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=89, max=283563, num_faces=283600
      Valid probs shape: (37, 100593)
    ✓ Random_23 (pose=(0.8382908182816498, 2.4047525534658565, 1.4580305458563378)): shape (37, 800, 800)
      Valid pixels: 76341/640000 (11.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=9860, max=283589, num_faces=283600
      Valid probs shape: (37, 76341)
    ✓ Random_24 (pose=(-1.857719676906871, -0.19577673229559167, -0.6970501138692486)): shape (37, 800, 800)
      Valid pixels: 96367/640000 (15.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=80, max=283589, num_faces=283600
      Valid probs shape: (37, 96367)
    ✓ Random_25 (pose=(3.0146766362603996, -1.8791765080992615, 2.7510241384251266)): shape (37, 800, 800)
      Valid pixels: 67238/640000 (10.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=283594, num_faces=283600
      Valid probs shape: (37, 67238)
    ✓ Random_26 (pose=(-1.1657617304862915, 2.0622550229216365, -1.3014206044400727)): shape (37, 800, 800)
      Valid pixels: 59062/640000 (9.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=108, max=283582, num_faces=283600
      Valid probs shape: (37, 59062)
    ✓ Random_27 (pose=(-2.876362598539512, 1.693609515403807, -1.145600231671577)): shape (37, 800, 800)
      Valid pixels: 95266/640000 (14.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=32, max=283599, num_faces=283600
      Valid probs shape: (37, 95266)
    ✓ Random_28 (pose=(2.0611029992672734, -1.9539395481468882, -2.3689262405268723)): shape (37, 800, 800)
      Valid pixels: 65776/640000 (10.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=13, max=283593, num_faces=283600
      Valid probs shape: (37, 65776)
    ✓ Random_29 (pose=(-0.9176556728059171, 1.0460218666678749, -0.3512822131733371)): shape (37, 800, 800)
      Valid pixels: 91064/640000 (14.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=283562, num_faces=283600
      Valid probs shape: (37, 91064)
    P stats: min=0.0000, max=0.9999, mean=0.0251
    Non-zero vertices: 131936/141802
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 9866 1576  968 3335    0 2351  936 4559 7514]
  Ground Truth Stats:
    Labels shape: (141802,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-9/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7563
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8074
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8077

  RESULTS:
  RAW:         median(top-10)=0.9048, mean(top-10)=0.9019, median(all)=0.8168, mean(all)=0.7563
  + SMOOTHING: median(top-10)=0.9202, mean(top-10)=0.9195, median(all)=0.8553, mean(all)=0.8074 [+0.0154]
  + MRF:       median(top-10)=0.9204, mean(top-10)=0.9196, median(all)=0.8552, mean(all)=0.8077 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0157

================================================================================
Subject: OASIS-TRT-20-1
================================================================================
  Step 0: Generating predictions with V2 model (30 random views)...
  Mesh: 149052 vertices, 298100 faces
  Generating 30 random views...
  Generating predictions for 30 views (continuous camera pose)...
    ✓ Random_0 (pose=(-1.2645145764324146, 1.356958449763349, 2.036991763117226)): shape (37, 800, 800)
      Valid pixels: 64695/640000 (10.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8, max=297997, num_faces=298100
      Valid probs shape: (37, 64695)
    ✓ Random_1 (pose=(-0.3245921172346966, -1.0839298448809904, 1.3545461396029967)): shape (37, 800, 800)
      Valid pixels: 80901/640000 (12.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=298099, num_faces=298100
      Valid probs shape: (37, 80901)
    ✓ Random_2 (pose=(1.604685310661635, -1.3012471787811677, 2.5609964702841896)): shape (37, 800, 800)
      Valid pixels: 84978/640000 (13.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=9, max=298098, num_faces=298100
      Valid probs shape: (37, 84978)
    ✓ Random_3 (pose=(-2.585467171738321, -2.6296496539056275, 2.466122900715935)): shape (37, 800, 800)
      Valid pixels: 51369/640000 (8.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=297997, num_faces=298100
      Valid probs shape: (37, 51369)
    ✓ Random_4 (pose=(1.7935628395356176, 0.9694196877058161, 0.2064067720208973)): shape (37, 800, 800)
      Valid pixels: 81809/640000 (12.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=298099, num_faces=298100
      Valid probs shape: (37, 81809)
    ✓ Random_5 (pose=(-2.7929327313673227, -1.7174698088332103, -0.27007325987577735)): shape (37, 800, 800)
      Valid pixels: 58284/640000 (9.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=298098, num_faces=298100
      Valid probs shape: (37, 58284)
    ✓ Random_6 (pose=(1.6210616778982887, 1.8514446773646958, -0.6473339233010202)): shape (37, 800, 800)
      Valid pixels: 86861/640000 (13.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=298099, num_faces=298100
      Valid probs shape: (37, 86861)
    ✓ Random_7 (pose=(-1.3930483195968235, -0.31082267710055467, 0.365035094653829)): shape (37, 800, 800)
      Valid pixels: 66305/640000 (10.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=11, max=298093, num_faces=298100
      Valid probs shape: (37, 66305)
    ✓ Random_8 (pose=(0.37298118210417064, 1.168437082018304, -0.05036423269119972)): shape (37, 800, 800)
      Valid pixels: 53594/640000 (8.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=30, max=298089, num_faces=298100
      Valid probs shape: (37, 53594)
    ✓ Random_9 (pose=(2.586414895902161, -2.8340705031596967, 0.42987102435501834)): shape (37, 800, 800)
      Valid pixels: 46780/640000 (7.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=297855, num_faces=298100
      Valid probs shape: (37, 46780)
    ✓ Random_10 (pose=(-0.32317332532509946, 2.4566382460131653, 0.6383970418768499)): shape (37, 800, 800)
      Valid pixels: 70455/640000 (11.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3786, max=298098, num_faces=298100
      Valid probs shape: (37, 70455)
    ✓ Random_11 (pose=(-0.2631060604618578, -0.09703162133982213, 0.26521724739595287)): shape (37, 800, 800)
      Valid pixels: 41665/640000 (6.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=297917, num_faces=298100
      Valid probs shape: (37, 41665)
    ✓ Random_12 (pose=(-2.933941042285434, -2.3537689708078955, -0.5141486653254024)): shape (37, 800, 800)
      Valid pixels: 45287/640000 (7.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=298033, num_faces=298100
      Valid probs shape: (37, 45287)
    ✓ Random_13 (pose=(-0.577944711810046, 1.5432834189302973, 1.788559572827805)): shape (37, 800, 800)
      Valid pixels: 62015/640000 (9.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=9, max=297997, num_faces=298100
      Valid probs shape: (37, 62015)
    ✓ Random_14 (pose=(-0.18107344086062493, -2.841086993294206, 3.1385645147519874)): shape (37, 800, 800)
      Valid pixels: 40829/640000 (6.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1571, max=298099, num_faces=298100
      Valid probs shape: (37, 40829)
    ✓ Random_15 (pose=(-2.0590787877659724, 2.134577745207544, 2.395150177921667)): shape (37, 800, 800)
      Valid pixels: 86061/640000 (13.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=298099, num_faces=298100
      Valid probs shape: (37, 86061)
    ✓ Random_16 (pose=(2.5782261922722034, 2.661385921774581, -2.662044540837484)): shape (37, 800, 800)
      Valid pixels: 58955/640000 (9.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=297828, num_faces=298100
      Valid probs shape: (37, 58955)
    ✓ Random_17 (pose=(-2.5688897701635045, -1.1181227929822848, 0.6628617997349928)): shape (37, 800, 800)
      Valid pixels: 81136/640000 (12.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=173, max=298098, num_faces=298100
      Valid probs shape: (37, 81136)
    ✓ Random_18 (pose=(-1.7967597599328524, -2.6882162508964793, -0.22893473202702497)): shape (37, 800, 800)
      Valid pixels: 81295/640000 (12.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=12, max=298098, num_faces=298100
      Valid probs shape: (37, 81295)
    ✓ Random_19 (pose=(-1.8936637479145093, -2.5554975599656067, -2.3104325889881547)): shape (37, 800, 800)
      Valid pixels: 63527/640000 (9.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=298099, num_faces=298100
      Valid probs shape: (37, 63527)
    ✓ Random_20 (pose=(2.594933785298714, -2.3792638154881436, 1.2303167938226638)): shape (37, 800, 800)
      Valid pixels: 62489/640000 (9.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6, max=298031, num_faces=298100
      Valid probs shape: (37, 62489)
    ✓ Random_21 (pose=(2.2562104471375903, 1.277438877231054, -1.0187483168728702)): shape (37, 800, 800)
      Valid pixels: 56528/640000 (8.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=8, max=298079, num_faces=298100
      Valid probs shape: (37, 56528)
    ✓ Random_22 (pose=(2.0141758495476925, 1.3293257479164877, -1.4598612748888369)): shape (37, 800, 800)
      Valid pixels: 57528/640000 (9.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=297997, num_faces=298100
      Valid probs shape: (37, 57528)
    ✓ Random_23 (pose=(-2.8222299727736915, -0.6764054408751412, -0.054304239807644095)): shape (37, 800, 800)
      Valid pixels: 61005/640000 (9.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=11920, max=298099, num_faces=298100
      Valid probs shape: (37, 61005)
    ✓ Random_24 (pose=(-2.4014858903130976, 0.9312390163297692, 1.1187096056551482)): shape (37, 800, 800)
      Valid pixels: 62288/640000 (9.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=298093, num_faces=298100
      Valid probs shape: (37, 62288)
    ✓ Random_25 (pose=(1.405848352955898, -1.9796883489134665, 2.447657812114297)): shape (37, 800, 800)
      Valid pixels: 82077/640000 (12.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=37, max=298098, num_faces=298100
      Valid probs shape: (37, 82077)
    ✓ Random_26 (pose=(-2.4962688853259696, -1.022056797906929, -1.916401578519081)): shape (37, 800, 800)
      Valid pixels: 67524/640000 (10.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7, max=298099, num_faces=298100
      Valid probs shape: (37, 67524)
    ✓ Random_27 (pose=(-0.18383643134428063, -2.5922958764871957, -0.5081917911458893)): shape (37, 800, 800)
      Valid pixels: 49898/640000 (7.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1873, max=298095, num_faces=298100
      Valid probs shape: (37, 49898)
    ✓ Random_28 (pose=(-1.1158219166701215, -1.7253902110401091, 1.170709996851615)): shape (37, 800, 800)
      Valid pixels: 58927/640000 (9.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=297997, num_faces=298100
      Valid probs shape: (37, 58927)
    ✓ Random_29 (pose=(0.8214292786523294, 3.053098047690672, 0.4217411697168916)): shape (37, 800, 800)
      Valid pixels: 57328/640000 (9.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=466, max=298099, num_faces=298100
      Valid probs shape: (37, 57328)
    P stats: min=0.0000, max=1.0000, mean=0.0257
    Non-zero vertices: 141616/149052
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 7436 1559 1251 4078    0 2499 1074 4640 6738]
  Ground Truth Stats:
    Labels shape: (149052,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-1/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7732
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8171
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8174

  RESULTS:
  RAW:         median(top-10)=0.9093, mean(top-10)=0.9156, median(all)=0.8413, mean(all)=0.7732
  + SMOOTHING: median(top-10)=0.9279, mean(top-10)=0.9309, median(all)=0.8593, mean(all)=0.8171 [+0.0186]
  + MRF:       median(top-10)=0.9281, mean(top-10)=0.9311, median(all)=0.8597, mean(all)=0.8174 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0188

================================================================================
Subject: OASIS-TRT-20-10
================================================================================
  Step 0: Generating predictions with V2 model (30 random views)...
  Mesh: 129540 vertices, 259076 faces
  Generating 30 random views...
  Generating predictions for 30 views (continuous camera pose)...
    ✓ Random_0 (pose=(0.7302670089192693, 0.5901934381458518, -1.0259843218284512)): shape (37, 800, 800)
      Valid pixels: 76691/640000 (12.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=259071, num_faces=259076
      Valid probs shape: (37, 76691)
    ✓ Random_1 (pose=(0.046411074847591216, 2.7599380592905876, -3.0303042573276517)): shape (37, 800, 800)
      Valid pixels: 38547/640000 (6.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7891, max=259074, num_faces=259076
      Valid probs shape: (37, 38547)
    ✓ Random_2 (pose=(0.5041830294730376, 1.527963412446506, 0.2170396507564667)): shape (37, 800, 800)
      Valid pixels: 57297/640000 (9.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=259074, num_faces=259076
      Valid probs shape: (37, 57297)
    ✓ Random_3 (pose=(0.390087357755605, 2.082383804511097, -1.2027952021555959)): shape (37, 800, 800)
      Valid pixels: 76883/640000 (12.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=10, max=259069, num_faces=259076
      Valid probs shape: (37, 76883)
    ✓ Random_4 (pose=(-2.2433614253502756, -0.6035633808853094, 2.2794752038053323)): shape (37, 800, 800)
      Valid pixels: 58376/640000 (9.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1143, max=259074, num_faces=259076
      Valid probs shape: (37, 58376)
    ✓ Random_5 (pose=(2.412049177057912, 0.4858583382385655, 0.7446217440428722)): shape (37, 800, 800)
      Valid pixels: 65135/640000 (10.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=259071, num_faces=259076
      Valid probs shape: (37, 65135)
    ✓ Random_6 (pose=(-1.1587421007392997, 0.9392487348295662, -0.4340703209726757)): shape (37, 800, 800)
      Valid pixels: 80381/640000 (12.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=259073, num_faces=259076
      Valid probs shape: (37, 80381)
    ✓ Random_7 (pose=(-2.447701768877786, -1.475141489285883, -2.1232391572096407)): shape (37, 800, 800)
      Valid pixels: 83721/640000 (13.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=259071, num_faces=259076
      Valid probs shape: (37, 83721)
    ✓ Random_8 (pose=(-1.9512043020881333, 2.19019024334575, 2.8498326825737674)): shape (37, 800, 800)
      Valid pixels: 85706/640000 (13.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=259070, num_faces=259076
      Valid probs shape: (37, 85706)
    ✓ Random_9 (pose=(-2.5333102269488874, 1.7000111815141699, 1.1793789914775932)): shape (37, 800, 800)
      Valid pixels: 81440/640000 (12.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=259072, num_faces=259076
      Valid probs shape: (37, 81440)
    ✓ Random_10 (pose=(0.73573141634991, 1.7361208725202228, -2.6083551612860463)): shape (37, 800, 800)
      Valid pixels: 59702/640000 (9.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=50, max=259054, num_faces=259076
      Valid probs shape: (37, 59702)
    ✓ Random_11 (pose=(-0.09149998783088042, 1.6967362340202232, 1.0882756049145552)): shape (37, 800, 800)
      Valid pixels: 86615/640000 (13.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=259072, num_faces=259076
      Valid probs shape: (37, 86615)
    ✓ Random_12 (pose=(0.8223056016767103, 1.1342107867913436, 0.6037883719241419)): shape (37, 800, 800)
      Valid pixels: 54974/640000 (8.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=258998, num_faces=259076
      Valid probs shape: (37, 54974)
    ✓ Random_13 (pose=(-1.820816183714438, -2.9283635882948236, 0.6998213781651823)): shape (37, 800, 800)
      Valid pixels: 66297/640000 (10.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=7, max=258999, num_faces=259076
      Valid probs shape: (37, 66297)
    ✓ Random_14 (pose=(1.1860356614277991, -0.9505509177033846, -1.9284659308895125)): shape (37, 800, 800)
      Valid pixels: 63675/640000 (9.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=258999, num_faces=259076
      Valid probs shape: (37, 63675)
    ✓ Random_15 (pose=(-2.9335157001934737, 1.2098394420845748, 1.8155520707278754)): shape (37, 800, 800)
      Valid pixels: 79995/640000 (12.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=259071, num_faces=259076
      Valid probs shape: (37, 79995)
    ✓ Random_16 (pose=(-0.1663152876159577, -0.1176468216607911, -2.171136460245394)): shape (37, 800, 800)
      Valid pixels: 38542/640000 (6.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=204263, num_faces=259076
      Valid probs shape: (37, 38542)
    ✓ Random_17 (pose=(2.691206464972013, 1.292761111498531, -2.725592427543516)): shape (37, 800, 800)
      Valid pixels: 85026/640000 (13.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=60, max=259074, num_faces=259076
      Valid probs shape: (37, 85026)
    ✓ Random_18 (pose=(1.6116971709191805, -1.3795901349369404, 1.4016501369901953)): shape (37, 800, 800)
      Valid pixels: 55637/640000 (8.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=259074, num_faces=259076
      Valid probs shape: (37, 55637)
    ✓ Random_19 (pose=(1.3730948582054223, -2.3718343998704965, -0.7072090813177918)): shape (37, 800, 800)
      Valid pixels: 83740/640000 (13.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=11, max=259069, num_faces=259076
      Valid probs shape: (37, 83740)
    ✓ Random_20 (pose=(-1.7672207528189536, -0.5203298592217842, 2.9261152626491276)): shape (37, 800, 800)
      Valid pixels: 88102/640000 (13.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=259071, num_faces=259076
      Valid probs shape: (37, 88102)
    ✓ Random_21 (pose=(-1.0310769155172466, 3.014878113376425, -2.242260704786494)): shape (37, 800, 800)
      Valid pixels: 63166/640000 (9.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=259074, num_faces=259076
      Valid probs shape: (37, 63166)
    ✓ Random_22 (pose=(2.5189375873398534, 2.8204935236714084, 1.8417166918785712)): shape (37, 800, 800)
      Valid pixels: 45120/640000 (7.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=258898, num_faces=259076
      Valid probs shape: (37, 45120)
    ✓ Random_23 (pose=(-2.8238554264773303, 2.9483329262035145, -1.3491666762510979)): shape (37, 800, 800)
      Valid pixels: 46862/640000 (7.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=213922, num_faces=259076
      Valid probs shape: (37, 46862)
    ✓ Random_24 (pose=(2.7026573771003672, -0.6196395088277007, -1.666697995003925)): shape (37, 800, 800)
      Valid pixels: 59224/640000 (9.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=183, max=259074, num_faces=259076
      Valid probs shape: (37, 59224)
    ✓ Random_25 (pose=(-1.2492011937607195, -2.27722862593068, 0.07444201093969216)): shape (37, 800, 800)
      Valid pixels: 74151/640000 (11.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=70, max=259075, num_faces=259076
      Valid probs shape: (37, 74151)
    ✓ Random_26 (pose=(-1.70680614154918, -2.8476709295180505, 1.886641661180593)): shape (37, 800, 800)
      Valid pixels: 69783/640000 (10.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=27, max=259072, num_faces=259076
      Valid probs shape: (37, 69783)
    ✓ Random_27 (pose=(-1.5011101114360932, -1.8144474627488505, 1.0818265736177555)): shape (37, 800, 800)
      Valid pixels: 61996/640000 (9.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=75, max=259065, num_faces=259076
      Valid probs shape: (37, 61996)
    ✓ Random_28 (pose=(-2.708666886730276, -2.5096821507786617, 2.9577709552251505)): shape (37, 800, 800)
      Valid pixels: 61555/640000 (9.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=258998, num_faces=259076
      Valid probs shape: (37, 61555)
    ✓ Random_29 (pose=(0.8494872598344827, -2.173436304545011, -2.392752249088921)): shape (37, 800, 800)
      Valid pixels: 78304/640000 (12.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=445, max=259075, num_faces=259076
      Valid probs shape: (37, 78304)
    P stats: min=0.0000, max=0.9999, mean=0.0253
    Non-zero vertices: 121292/129540
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 8248 1083 1092 3587    0 2152 1128 4364 5897]
  Ground Truth Stats:
    Labels shape: (129540,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-10/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7772
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8292
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8294

  RESULTS:
  RAW:         median(top-10)=0.9017, mean(top-10)=0.9082, median(all)=0.8427, mean(all)=0.7772
  + SMOOTHING: median(top-10)=0.9297, mean(top-10)=0.9310, median(all)=0.8733, mean(all)=0.8292 [+0.0280]
  + MRF:       median(top-10)=0.9301, mean(top-10)=0.9313, median(all)=0.8738, mean(all)=0.8294 [+0.0004]
  TOTAL IMPROVEMENT (median top-10): +0.0284

================================================================================
Subject: OASIS-TRT-20-11
================================================================================
  Step 0: Generating predictions with V2 model (30 random views)...
  Mesh: 146531 vertices, 293058 faces
  Generating 30 random views...
  Generating predictions for 30 views (continuous camera pose)...
    ✓ Random_0 (pose=(2.380121431098452, 1.1660147472888447, -0.42237462962586436)): shape (37, 800, 800)
      Valid pixels: 76745/640000 (12.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=16, max=293054, num_faces=293058
      Valid probs shape: (37, 76745)
    ✓ Random_1 (pose=(-2.3370773282038075, 2.4859696472766224, 0.27839786012141987)): shape (37, 800, 800)
      Valid pixels: 65103/640000 (10.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=14, max=293057, num_faces=293058
      Valid probs shape: (37, 65103)
    ✓ Random_2 (pose=(-2.7170121835183942, -2.2996582377233135, 2.529280298833962)): shape (37, 800, 800)
      Valid pixels: 54544/640000 (8.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=11, max=293053, num_faces=293058
      Valid probs shape: (37, 54544)
    ✓ Random_3 (pose=(1.1268621928469793, -2.8127432876965752, -0.7283058800304665)): shape (37, 800, 800)
      Valid pixels: 84038/640000 (13.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=20, max=293056, num_faces=293058
      Valid probs shape: (37, 84038)
    ✓ Random_4 (pose=(0.3868589708903767, 1.8880895441737984, 0.2222072589823667)): shape (37, 800, 800)
      Valid pixels: 58086/640000 (9.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=39, max=293055, num_faces=293058
      Valid probs shape: (37, 58086)
    ✓ Random_5 (pose=(-2.9873757425995464, 2.8121889484209506, -1.3607012180509126)): shape (37, 800, 800)
      Valid pixels: 55085/640000 (8.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=291188, num_faces=293058
      Valid probs shape: (37, 55085)
    ✓ Random_6 (pose=(3.0978991080297034, -2.139597018799491, -2.625042180443993)): shape (37, 800, 800)
      Valid pixels: 70199/640000 (11.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=11, max=293055, num_faces=293058
      Valid probs shape: (37, 70199)
    ✓ Random_7 (pose=(-2.966364676882873, -3.0104869301526325, 0.18839557787975814)): shape (37, 800, 800)
      Valid pixels: 49079/640000 (7.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=292530, num_faces=293058
      Valid probs shape: (37, 49079)
    ✓ Random_8 (pose=(0.8552586251650527, 2.463094457750663, -3.0289815817624755)): shape (37, 800, 800)
      Valid pixels: 75909/640000 (11.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2415, max=293057, num_faces=293058
      Valid probs shape: (37, 75909)
    ✓ Random_9 (pose=(-0.10270974614766537, -2.172419615508793, 0.5894391198813858)): shape (37, 800, 800)
      Valid pixels: 70828/640000 (11.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=94, max=293056, num_faces=293058
      Valid probs shape: (37, 70828)
    ✓ Random_10 (pose=(1.2733396098495549, -1.8918105163308183, 3.062445978179036)): shape (37, 800, 800)
      Valid pixels: 94215/640000 (14.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=292587, num_faces=293058
      Valid probs shape: (37, 94215)
    ✓ Random_11 (pose=(1.69034195901044, -0.9448136675874257, -2.2166661653510933)): shape (37, 800, 800)
      Valid pixels: 69940/640000 (10.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=29, max=293057, num_faces=293058
      Valid probs shape: (37, 69940)
    ✓ Random_12 (pose=(-2.847033388424043, -0.1962476791568295, -2.961685805959293)): shape (37, 800, 800)
      Valid pixels: 50111/640000 (7.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=223, max=293057, num_faces=293058
      Valid probs shape: (37, 50111)
    ✓ Random_13 (pose=(1.5185827965942043, -2.803863131939216, -0.35238488605208085)): shape (37, 800, 800)
      Valid pixels: 99397/640000 (15.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=12, max=293055, num_faces=293058
      Valid probs shape: (37, 99397)
    ✓ Random_14 (pose=(1.570081590775441, 0.8871795205777415, 2.1305356328905685)): shape (37, 800, 800)
      Valid pixels: 84385/640000 (13.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=15, max=292498, num_faces=293058
      Valid probs shape: (37, 84385)
    ✓ Random_15 (pose=(2.0167361730717177, 2.25940903950546, 0.8209955060441594)): shape (37, 800, 800)
      Valid pixels: 84013/640000 (13.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=293055, num_faces=293058
      Valid probs shape: (37, 84013)
    ✓ Random_16 (pose=(-0.31306270357880894, 1.1092382216764278, 1.411922379171827)): shape (37, 800, 800)
      Valid pixels: 79931/640000 (12.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=19, max=293057, num_faces=293058
      Valid probs shape: (37, 79931)
    ✓ Random_17 (pose=(3.1019059199919727, -2.110582209912654, -2.186127003469309)): shape (37, 800, 800)
      Valid pixels: 83736/640000 (13.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=10, max=293055, num_faces=293058
      Valid probs shape: (37, 83736)
    ✓ Random_18 (pose=(1.6418547280584397, 0.2682598996939163, 1.8031830086587854)): shape (37, 800, 800)
      Valid pixels: 68804/640000 (10.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=10, max=291164, num_faces=293058
      Valid probs shape: (37, 68804)
    ✓ Random_19 (pose=(1.5863723574006094, -1.1483190059703066, -0.7015389680090363)): shape (37, 800, 800)
      Valid pixels: 95183/640000 (14.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=27, max=293055, num_faces=293058
      Valid probs shape: (37, 95183)
    ✓ Random_20 (pose=(-0.05526849195408312, -2.2463374349374665, -1.9012764321383364)): shape (37, 800, 800)
      Valid pixels: 84002/640000 (13.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=6032, max=293056, num_faces=293058
      Valid probs shape: (37, 84002)
    ✓ Random_21 (pose=(-2.9660974740997297, -1.9622829252172245, -0.11600235776880474)): shape (37, 800, 800)
      Valid pixels: 58896/640000 (9.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=291185, num_faces=293058
      Valid probs shape: (37, 58896)
    ✓ Random_22 (pose=(2.2628322584567435, -2.18015587577715, -2.2802299662841112)): shape (37, 800, 800)
      Valid pixels: 59309/640000 (9.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=293057, num_faces=293058
      Valid probs shape: (37, 59309)
    ✓ Random_23 (pose=(-0.21447425499942607, 3.051152984722764, 2.853027046948349)): shape (37, 800, 800)
      Valid pixels: 44231/640000 (6.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2488, max=293057, num_faces=293058
      Valid probs shape: (37, 44231)
    ✓ Random_24 (pose=(-0.9675437617148979, 1.263903709282772, 2.783563603847325)): shape (37, 800, 800)
      Valid pixels: 87890/640000 (13.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=19, max=293055, num_faces=293058
      Valid probs shape: (37, 87890)
    ✓ Random_25 (pose=(-1.931568777115317, -0.7149594685814931, 1.7124597833261541)): shape (37, 800, 800)
      Valid pixels: 62489/640000 (9.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=170, max=293054, num_faces=293058
      Valid probs shape: (37, 62489)
    ✓ Random_26 (pose=(-1.700443262361132, -1.2196351057208512, -2.069983526074224)): shape (37, 800, 800)
      Valid pixels: 70555/640000 (11.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=14, max=293055, num_faces=293058
      Valid probs shape: (37, 70555)
    ✓ Random_27 (pose=(-0.5118481817822262, -0.48303267564938457, 0.47327085379453493)): shape (37, 800, 800)
      Valid pixels: 53657/640000 (8.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=293055, num_faces=293058
      Valid probs shape: (37, 53657)
    ✓ Random_28 (pose=(1.5395252451287051, -2.063179438016001, -2.8720980533418494)): shape (37, 800, 800)
      Valid pixels: 85963/640000 (13.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=10, max=293057, num_faces=293058
      Valid probs shape: (37, 85963)
    ✓ Random_29 (pose=(-1.0794733230651428, 0.7955588232429318, 1.7123455025253564)): shape (37, 800, 800)
      Valid pixels: 60939/640000 (9.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=2, max=293052, num_faces=293058
      Valid probs shape: (37, 60939)
    P stats: min=0.0000, max=1.0000, mean=0.0250
    Non-zero vertices: 135322/146531
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 11209  1304  1129  3409     0  2515   901  5195  7329]
  Ground Truth Stats:
    Labels shape: (146531,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-11/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7789
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8386
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8388

  RESULTS:
  RAW:         median(top-10)=0.9046, mean(top-10)=0.9069, median(all)=0.8255, mean(all)=0.7789
  + SMOOTHING: median(top-10)=0.9317, mean(top-10)=0.9296, median(all)=0.8709, mean(all)=0.8386 [+0.0271]
  + MRF:       median(top-10)=0.9324, mean(top-10)=0.9300, median(all)=0.8710, mean(all)=0.8388 [+0.0006]
  TOTAL IMPROVEMENT (median top-10): +0.0277

================================================================================
Subject: OASIS-TRT-20-12
================================================================================
  Step 0: Generating predictions with V2 model (30 random views)...
  Mesh: 144559 vertices, 289114 faces
  Generating 30 random views...
  Generating predictions for 30 views (continuous camera pose)...
    ✓ Random_0 (pose=(0.23755286930578023, 2.3220194386979287, -1.6139306682063286)): shape (37, 800, 800)
      Valid pixels: 66034/640000 (10.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=104, max=289110, num_faces=289114
      Valid probs shape: (37, 66034)
    ✓ Random_1 (pose=(-1.2290735188451591, 0.09508488258203096, -0.35453687326955796)): shape (37, 800, 800)
      Valid pixels: 79190/640000 (12.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=289064, num_faces=289114
      Valid probs shape: (37, 79190)
    ✓ Random_2 (pose=(-2.778205250959324, -1.3740364839478598, -0.09601809059382571)): shape (37, 800, 800)
      Valid pixels: 65134/640000 (10.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=289111, num_faces=289114
      Valid probs shape: (37, 65134)
    ✓ Random_3 (pose=(3.009305995233081, 1.6635776867260308, -1.2962833500264777)): shape (37, 800, 800)
      Valid pixels: 72909/640000 (11.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=289111, num_faces=289114
      Valid probs shape: (37, 72909)
    ✓ Random_4 (pose=(-1.7922463737070393, -0.17264920283985852, -2.2359312259743835)): shape (37, 800, 800)
      Valid pixels: 65206/640000 (10.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=289057, num_faces=289114
      Valid probs shape: (37, 65206)
    ✓ Random_5 (pose=(-3.083312948704586, 2.7044122093810037, 1.7434656798209103)): shape (37, 800, 800)
      Valid pixels: 52448/640000 (8.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=288968, num_faces=289114
      Valid probs shape: (37, 52448)
    ✓ Random_6 (pose=(0.8132798139203992, 0.43516606942740843, -0.9810108013273315)): shape (37, 800, 800)
      Valid pixels: 75515/640000 (11.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=10, max=288988, num_faces=289114
      Valid probs shape: (37, 75515)
    ✓ Random_7 (pose=(-2.9041680381115884, -2.4029533543245836, -2.0549407253200935)): shape (37, 800, 800)
      Valid pixels: 69199/640000 (10.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=288984, num_faces=289114
      Valid probs shape: (37, 69199)
    ✓ Random_8 (pose=(-0.888533441960996, -1.0478565347501445, -0.9011600812751825)): shape (37, 800, 800)
      Valid pixels: 79255/640000 (12.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=10, max=289066, num_faces=289114
      Valid probs shape: (37, 79255)
    ✓ Random_9 (pose=(0.007793147129498745, 0.9771862706755572, -1.1854875891049228)): shape (37, 800, 800)
      Valid pixels: 68845/640000 (10.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=288987, num_faces=289114
      Valid probs shape: (37, 68845)
    ✓ Random_10 (pose=(-0.38230865013512005, -2.3531334423634163, -0.47954593141503565)): shape (37, 800, 800)
      Valid pixels: 63982/640000 (10.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=908, max=289110, num_faces=289114
      Valid probs shape: (37, 63982)
    ✓ Random_11 (pose=(-0.6050491209624864, -1.1565140147343285, 1.8077462958082604)): shape (37, 800, 800)
      Valid pixels: 86548/640000 (13.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=288988, num_faces=289114
      Valid probs shape: (37, 86548)
    ✓ Random_12 (pose=(-1.8462771283424328, 2.8970082976097355, -1.4968193053666252)): shape (37, 800, 800)
      Valid pixels: 56547/640000 (8.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=289067, num_faces=289114
      Valid probs shape: (37, 56547)
    ✓ Random_13 (pose=(1.9695165712509963, -0.3635494756074529, -0.5013494255756683)): shape (37, 800, 800)
      Valid pixels: 82951/640000 (13.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=48, max=288988, num_faces=289114
      Valid probs shape: (37, 82951)
    ✓ Random_14 (pose=(-1.9373717200644318, 0.9813396786470721, -1.1117075734456838)): shape (37, 800, 800)
      Valid pixels: 82053/640000 (12.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=13, max=289067, num_faces=289114
      Valid probs shape: (37, 82053)
    ✓ Random_15 (pose=(0.4511666794232787, -0.5009821337651745, 0.7146657480060399)): shape (37, 800, 800)
      Valid pixels: 63362/640000 (9.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=288968, num_faces=289114
      Valid probs shape: (37, 63362)
    ✓ Random_16 (pose=(-0.5302976039538501, -2.553198560063373, -0.10349236845753795)): shape (37, 800, 800)
      Valid pixels: 60117/640000 (9.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3287, max=289110, num_faces=289114
      Valid probs shape: (37, 60117)
    ✓ Random_17 (pose=(1.5063457864407148, -0.15103220674547746, -1.4015702662930722)): shape (37, 800, 800)
      Valid pixels: 61271/640000 (9.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=49, max=288985, num_faces=289114
      Valid probs shape: (37, 61271)
    ✓ Random_18 (pose=(0.393024078366516, -0.9982659651945291, -0.8497050243196185)): shape (37, 800, 800)
      Valid pixels: 58262/640000 (9.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=288953, num_faces=289114
      Valid probs shape: (37, 58262)
    ✓ Random_19 (pose=(0.1614119611378917, -1.2486008044490318, -0.8787545363792688)): shape (37, 800, 800)
      Valid pixels: 64510/640000 (10.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=12, max=288953, num_faces=289114
      Valid probs shape: (37, 64510)
    ✓ Random_20 (pose=(-2.159293258068285, -1.503852440770829, -1.7644027716434216)): shape (37, 800, 800)
      Valid pixels: 66599/640000 (10.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=289049, num_faces=289114
      Valid probs shape: (37, 66599)
    ✓ Random_21 (pose=(2.4541184551147834, -2.2498718891090275, 2.832122659653411)): shape (37, 800, 800)
      Valid pixels: 66602/640000 (10.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=289067, num_faces=289114
      Valid probs shape: (37, 66602)
    ✓ Random_22 (pose=(0.2530749154623315, -0.49137019381681535, -1.365452343020418)): shape (37, 800, 800)
      Valid pixels: 49549/640000 (7.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=13, max=288950, num_faces=289114
      Valid probs shape: (37, 49549)
    ✓ Random_23 (pose=(2.760155329087908, 0.3961381411007969, 0.9008485798020942)): shape (37, 800, 800)
      Valid pixels: 52601/640000 (8.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1247, max=289112, num_faces=289114
      Valid probs shape: (37, 52601)
    ✓ Random_24 (pose=(2.930478052638196, 1.3470383135062933, 2.6520277492740423)): shape (37, 800, 800)
      Valid pixels: 57485/640000 (9.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=289068, num_faces=289114
      Valid probs shape: (37, 57485)
    ✓ Random_25 (pose=(-1.5666597848017465, 2.9756786969952698, -1.7380965934683108)): shape (37, 800, 800)
      Valid pixels: 55086/640000 (8.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=289059, num_faces=289114
      Valid probs shape: (37, 55086)
    ✓ Random_26 (pose=(3.008384382524719, 1.7814818241220616, -1.9750567959610505)): shape (37, 800, 800)
      Valid pixels: 81918/640000 (12.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=289067, num_faces=289114
      Valid probs shape: (37, 81918)
    ✓ Random_27 (pose=(-3.0196021109738673, -2.2173637975095475, -2.9887875333770366)): shape (37, 800, 800)
      Valid pixels: 60275/640000 (9.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=288988, num_faces=289114
      Valid probs shape: (37, 60275)
    ✓ Random_28 (pose=(2.976837588816366, 0.3329216971597533, 2.377687829855672)): shape (37, 800, 800)
      Valid pixels: 43043/640000 (6.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6499, max=289113, num_faces=289114
      Valid probs shape: (37, 43043)
    ✓ Random_29 (pose=(1.6365020090910294, 2.330787864898161, -0.1233309698889058)): shape (37, 800, 800)
      Valid pixels: 89979/640000 (14.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=9, max=288987, num_faces=289114
      Valid probs shape: (37, 89979)
    P stats: min=0.0000, max=0.9999, mean=0.0252
    Non-zero vertices: 134843/144559
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 9716 1306 1186 2983    0 2002 1112 5262 5828]
  Ground Truth Stats:
    Labels shape: (144559,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-12/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7677
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8178
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8180

  RESULTS:
  RAW:         median(top-10)=0.8805, mean(top-10)=0.8865, median(all)=0.8244, mean(all)=0.7677
  + SMOOTHING: median(top-10)=0.9075, mean(top-10)=0.9113, median(all)=0.8560, mean(all)=0.8178 [+0.0270]
  + MRF:       median(top-10)=0.9072, mean(top-10)=0.9115, median(all)=0.8556, mean(all)=0.8180 [-0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0267

================================================================================
Subject: OASIS-TRT-20-13
================================================================================
  Step 0: Generating predictions with V2 model (30 random views)...
  Mesh: 122339 vertices, 244674 faces
  Generating 30 random views...
  Generating predictions for 30 views (continuous camera pose)...
    ✓ Random_0 (pose=(-0.3725089812652964, -2.054132245945544, -1.3760457477964048)): shape (37, 800, 800)
      Valid pixels: 85106/640000 (13.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=445, max=244671, num_faces=244674
      Valid probs shape: (37, 85106)
    ✓ Random_1 (pose=(0.9310805370526376, 0.481053562417356, -1.2055093649027435)): shape (37, 800, 800)
      Valid pixels: 71941/640000 (11.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=244672, num_faces=244674
      Valid probs shape: (37, 71941)
    ✓ Random_2 (pose=(-0.777350217831835, -2.4275847042500667, -2.1359525896161746)): shape (37, 800, 800)
      Valid pixels: 56310/640000 (8.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=235, max=244671, num_faces=244674
      Valid probs shape: (37, 56310)
    ✓ Random_3 (pose=(0.05122624197643377, -0.3141521352118688, -2.1225948313728793)): shape (37, 800, 800)
      Valid pixels: 55132/640000 (8.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=243667, num_faces=244674
      Valid probs shape: (37, 55132)
    ✓ Random_4 (pose=(0.02369436906294542, 0.32724557394289766, 1.2008228971333272)): shape (37, 800, 800)
      Valid pixels: 55373/640000 (8.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=243667, num_faces=244674
      Valid probs shape: (37, 55373)
    ✓ Random_5 (pose=(-3.033075045167296, 2.322108610612511, 0.9462448936286174)): shape (37, 800, 800)
      Valid pixels: 65687/640000 (10.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=244672, num_faces=244674
      Valid probs shape: (37, 65687)
    ✓ Random_6 (pose=(-2.3752291361462903, -1.4182572830234133, -0.37356060849898887)): shape (37, 800, 800)
      Valid pixels: 71143/640000 (11.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=27, max=244671, num_faces=244674
      Valid probs shape: (37, 71143)
    ✓ Random_7 (pose=(0.8038462408679488, -2.184807610568562, 1.472966088724882)): shape (37, 800, 800)
      Valid pixels: 72171/640000 (11.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=235, max=244602, num_faces=244674
      Valid probs shape: (37, 72171)
    ✓ Random_8 (pose=(2.21291752969133, 1.1368636925402829, -2.6424073759371067)): shape (37, 800, 800)
      Valid pixels: 88541/640000 (13.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=20, max=244672, num_faces=244674
      Valid probs shape: (37, 88541)
    ✓ Random_9 (pose=(-1.9709927122103112, 2.675022801806551, -2.5660682784266546)): shape (37, 800, 800)
      Valid pixels: 69090/640000 (10.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=244602, num_faces=244674
      Valid probs shape: (37, 69090)
    ✓ Random_10 (pose=(-2.3129600862420143, 1.3569887816310535, -0.13677961085646784)): shape (37, 800, 800)
      Valid pixels: 75799/640000 (11.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=319, max=244673, num_faces=244674
      Valid probs shape: (37, 75799)
    ✓ Random_11 (pose=(-1.3225691259871444, 2.8491074217002224, -0.7086407922178113)): shape (37, 800, 800)
      Valid pixels: 85070/640000 (13.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=96, max=244671, num_faces=244674
      Valid probs shape: (37, 85070)
    ✓ Random_12 (pose=(1.0525176747179295, -2.9555529500284035, 1.2884850422456662)): shape (37, 800, 800)
      Valid pixels: 64167/640000 (10.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=250, max=244600, num_faces=244674
      Valid probs shape: (37, 64167)
    ✓ Random_13 (pose=(-2.7844248301325374, 1.0727744881721053, 3.1300453953952045)): shape (37, 800, 800)
      Valid pixels: 65009/640000 (10.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=235, max=244598, num_faces=244674
      Valid probs shape: (37, 65009)
    ✓ Random_14 (pose=(-2.608806487534398, -1.8176693369470536, 1.3391051383061985)): shape (37, 800, 800)
      Valid pixels: 80502/640000 (12.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=0, max=244672, num_faces=244674
      Valid probs shape: (37, 80502)
    ✓ Random_15 (pose=(-3.10227983730759, 1.1969828471796893, 0.9415928295988278)): shape (37, 800, 800)
      Valid pixels: 89144/640000 (13.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=28, max=244672, num_faces=244674
      Valid probs shape: (37, 89144)
    ✓ Random_16 (pose=(-2.3393289062626126, 2.147711607022492, -0.4012113355286968)): shape (37, 800, 800)
      Valid pixels: 78622/640000 (12.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=7, max=244671, num_faces=244674
      Valid probs shape: (37, 78622)
    ✓ Random_17 (pose=(2.1119930941758174, -1.0741340901787102, -2.9991073422229646)): shape (37, 800, 800)
      Valid pixels: 74237/640000 (11.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=441, max=244673, num_faces=244674
      Valid probs shape: (37, 74237)
    ✓ Random_18 (pose=(-2.2315216337076524, 0.7985672543038174, 1.2142488235165194)): shape (37, 800, 800)
      Valid pixels: 60291/640000 (9.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1015, max=244673, num_faces=244674
      Valid probs shape: (37, 60291)
    ✓ Random_19 (pose=(-3.0334272126726196, -1.584481110100441, 0.8667481994308073)): shape (37, 800, 800)
      Valid pixels: 90816/640000 (14.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=244627, num_faces=244674
      Valid probs shape: (37, 90816)
    ✓ Random_20 (pose=(0.6167556134953749, 2.7791832265422984, 2.218207504167646)): shape (37, 800, 800)
      Valid pixels: 70481/640000 (11.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=21194, max=244671, num_faces=244674
      Valid probs shape: (37, 70481)
    ✓ Random_21 (pose=(2.5863076530431792, 1.8577508930729918, 1.2101948747185576)): shape (37, 800, 800)
      Valid pixels: 87600/640000 (13.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=10, max=244602, num_faces=244674
      Valid probs shape: (37, 87600)
    ✓ Random_22 (pose=(0.9447013692656103, -1.9030656573740046, -0.6841070267237819)): shape (37, 800, 800)
      Valid pixels: 68472/640000 (10.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=149, max=244673, num_faces=244674
      Valid probs shape: (37, 68472)
    ✓ Random_23 (pose=(0.5435609977910905, 2.7992938529377005, 2.578446193261982)): shape (37, 800, 800)
      Valid pixels: 67480/640000 (10.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=22700, max=244671, num_faces=244674
      Valid probs shape: (37, 67480)
    ✓ Random_24 (pose=(-1.8565876765553104, -2.4434548606669435, -1.0085742204607202)): shape (37, 800, 800)
      Valid pixels: 71190/640000 (11.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=244596, num_faces=244674
      Valid probs shape: (37, 71190)
    ✓ Random_25 (pose=(-3.0476188797081583, 3.030590720845879, -2.7606785681759374)): shape (37, 800, 800)
      Valid pixels: 43226/640000 (6.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=244158, num_faces=244674
      Valid probs shape: (37, 43226)
    ✓ Random_26 (pose=(-2.1699826841443164, 0.7741214692551726, 2.329417656076057)): shape (37, 800, 800)
      Valid pixels: 91797/640000 (14.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=29, max=244672, num_faces=244674
      Valid probs shape: (37, 91797)
    ✓ Random_27 (pose=(-0.28472035567346543, 0.05998562225724102, -0.16326088967879215)): shape (37, 800, 800)
      Valid pixels: 54069/640000 (8.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=243646, num_faces=244674
      Valid probs shape: (37, 54069)
    ✓ Random_28 (pose=(2.2593285073518414, -3.0600862562731974, 1.8002727189679746)): shape (37, 800, 800)
      Valid pixels: 62694/640000 (9.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=244597, num_faces=244674
      Valid probs shape: (37, 62694)
    ✓ Random_29 (pose=(1.3654103295315947, -2.317917039057221, 2.74999059385875)): shape (37, 800, 800)
      Valid pixels: 90741/640000 (14.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=244666, num_faces=244674
      Valid probs shape: (37, 90741)
    P stats: min=0.0000, max=1.0000, mean=0.0254
    Non-zero vertices: 115068/122339
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 7271 1164 1174 2984    0 1913  979 4027 5808]
  Ground Truth Stats:
    Labels shape: (122339,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-13/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7784
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8341
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8342

  RESULTS:
  RAW:         median(top-10)=0.8961, mean(top-10)=0.9031, median(all)=0.8278, mean(all)=0.7784
  + SMOOTHING: median(top-10)=0.9101, mean(top-10)=0.9207, median(all)=0.8780, mean(all)=0.8341 [+0.0140]
  + MRF:       median(top-10)=0.9106, mean(top-10)=0.9209, median(all)=0.8772, mean(all)=0.8342 [+0.0004]
  TOTAL IMPROVEMENT (median top-10): +0.0145

================================================================================
Subject: OASIS-TRT-20-14
================================================================================
  Step 0: Generating predictions with V2 model (30 random views)...
  Mesh: 128019 vertices, 256034 faces
  Generating 30 random views...
  Generating predictions for 30 views (continuous camera pose)...
    ✓ Random_0 (pose=(0.6769341827889064, 1.5691019330743554, -0.3722623001916934)): shape (37, 800, 800)
      Valid pixels: 72586/640000 (11.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7, max=255933, num_faces=256034
      Valid probs shape: (37, 72586)
    ✓ Random_1 (pose=(-0.1830257561177846, -1.0903919601821261, 0.10182036932228478)): shape (37, 800, 800)
      Valid pixels: 55789/640000 (8.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=5, max=256030, num_faces=256034
      Valid probs shape: (37, 55789)
    ✓ Random_2 (pose=(0.9751797352941018, 0.9161374893179115, -1.1370176817593483)): shape (37, 800, 800)
      Valid pixels: 87465/640000 (13.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=255933, num_faces=256034
      Valid probs shape: (37, 87465)
    ✓ Random_3 (pose=(2.364105431536732, 2.303999608703031, 1.3834622810360804)): shape (37, 800, 800)
      Valid pixels: 61329/640000 (9.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=255933, num_faces=256034
      Valid probs shape: (37, 61329)
    ✓ Random_4 (pose=(0.7167503820915022, -2.7890184921453867, 2.7479247102985864)): shape (37, 800, 800)
      Valid pixels: 73315/640000 (11.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=14945, max=256032, num_faces=256034
      Valid probs shape: (37, 73315)
    ✓ Random_5 (pose=(2.5465814116765326, -0.3480791892761914, 1.5469224724218789)): shape (37, 800, 800)
      Valid pixels: 61553/640000 (9.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=21242, max=256033, num_faces=256034
      Valid probs shape: (37, 61553)
    ✓ Random_6 (pose=(2.9959419319904423, -0.4626248298343203, 2.6167605351191776)): shape (37, 800, 800)
      Valid pixels: 49386/640000 (7.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=34183, max=256029, num_faces=256034
      Valid probs shape: (37, 49386)
    ✓ Random_7 (pose=(-2.0266774985421137, 1.6394481379221677, -2.2796896996940363)): shape (37, 800, 800)
      Valid pixels: 56523/640000 (8.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=255973, num_faces=256034
      Valid probs shape: (37, 56523)
    ✓ Random_8 (pose=(-0.036025177254246366, 0.01591876063259834, 2.7177301516700316)): shape (37, 800, 800)
      Valid pixels: 38843/640000 (6.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=255840, num_faces=256034
      Valid probs shape: (37, 38843)
    ✓ Random_9 (pose=(-1.0198209104553326, 1.6217190452451993, -0.1618285539944333)): shape (37, 800, 800)
      Valid pixels: 87894/640000 (13.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=255964, num_faces=256034
      Valid probs shape: (37, 87894)
    ✓ Random_10 (pose=(-0.5446935668302131, -3.1193540378982414, 2.9977111422308154)): shape (37, 800, 800)
      Valid pixels: 56097/640000 (8.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=302, max=256033, num_faces=256034
      Valid probs shape: (37, 56097)
    ✓ Random_11 (pose=(-1.0482835170713827, -1.0168744833572796, -1.6132422133707711)): shape (37, 800, 800)
      Valid pixels: 73520/640000 (11.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=255979, num_faces=256034
      Valid probs shape: (37, 73520)
    ✓ Random_12 (pose=(0.2819951281547972, -2.45545245107414, -1.5633485312439104)): shape (37, 800, 800)
      Valid pixels: 63286/640000 (9.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=510, max=256028, num_faces=256034
      Valid probs shape: (37, 63286)
    ✓ Random_13 (pose=(2.6740374352181187, 1.1381189636206743, 0.24088387285158586)): shape (37, 800, 800)
      Valid pixels: 83475/640000 (13.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=111, max=256033, num_faces=256034
      Valid probs shape: (37, 83475)
    ✓ Random_14 (pose=(-1.7273992943635654, 1.1972808581610979, -3.066981269567689)): shape (37, 800, 800)
      Valid pixels: 83196/640000 (13.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=17, max=255933, num_faces=256034
      Valid probs shape: (37, 83196)
    ✓ Random_15 (pose=(2.8608318754884765, 2.3921403815537934, -0.10902041551346242)): shape (37, 800, 800)
      Valid pixels: 56401/640000 (8.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=256030, num_faces=256034
      Valid probs shape: (37, 56401)
    ✓ Random_16 (pose=(2.465167958257303, -0.8991184880539138, -1.3402339360315492)): shape (37, 800, 800)
      Valid pixels: 83213/640000 (13.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=108, max=256033, num_faces=256034
      Valid probs shape: (37, 83213)
    ✓ Random_17 (pose=(-0.07802784085682557, 1.5501096564195187, 1.506590760944416)): shape (37, 800, 800)
      Valid pixels: 83297/640000 (13.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=0, max=256030, num_faces=256034
      Valid probs shape: (37, 83297)
    ✓ Random_18 (pose=(-1.3793058231029216, -0.5036601137450316, 1.160017712580916)): shape (37, 800, 800)
      Valid pixels: 59703/640000 (9.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=6, max=256030, num_faces=256034
      Valid probs shape: (37, 59703)
    ✓ Random_19 (pose=(2.2810377356662164, 0.603544839751144, -0.4591609796673959)): shape (37, 800, 800)
      Valid pixels: 74663/640000 (11.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=102, max=256033, num_faces=256034
      Valid probs shape: (37, 74663)
    ✓ Random_20 (pose=(2.5441373674714276, 2.6446286555391243, -0.9456639539970513)): shape (37, 800, 800)
      Valid pixels: 49991/640000 (7.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=256030, num_faces=256034
      Valid probs shape: (37, 49991)
    ✓ Random_21 (pose=(-1.1008083408073404, -2.4077711774925823, 0.441424118730128)): shape (37, 800, 800)
      Valid pixels: 64926/640000 (10.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=494, max=256030, num_faces=256034
      Valid probs shape: (37, 64926)
    ✓ Random_22 (pose=(1.214230222535881, 1.0963682732478572, 1.8537461993067517)): shape (37, 800, 800)
      Valid pixels: 81255/640000 (12.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8, max=255978, num_faces=256034
      Valid probs shape: (37, 81255)
    ✓ Random_23 (pose=(-2.1141529714034553, 2.8193307463294133, -2.9377343574899286)): shape (37, 800, 800)
      Valid pixels: 69948/640000 (10.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=255993, num_faces=256034
      Valid probs shape: (37, 69948)
    ✓ Random_24 (pose=(0.9443643386644851, 0.2130606301302138, -2.6891160508983836)): shape (37, 800, 800)
      Valid pixels: 61287/640000 (9.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=256030, num_faces=256034
      Valid probs shape: (37, 61287)
    ✓ Random_25 (pose=(1.5245839177719152, 1.5016059080723902, -2.6411598264599263)): shape (37, 800, 800)
      Valid pixels: 69718/640000 (10.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=42, max=256030, num_faces=256034
      Valid probs shape: (37, 69718)
    ✓ Random_26 (pose=(-0.6985888557059377, -0.03796866330064308, -1.780625457013268)): shape (37, 800, 800)
      Valid pixels: 45186/640000 (7.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=255113, num_faces=256034
      Valid probs shape: (37, 45186)
    ✓ Random_27 (pose=(-1.5302547135909923, 2.496840484955018, 2.6637532645673705)): shape (37, 800, 800)
      Valid pixels: 93859/640000 (14.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=17, max=256029, num_faces=256034
      Valid probs shape: (37, 93859)
    ✓ Random_28 (pose=(2.357064631219826, 0.269532295238482, 0.5497218270418536)): shape (37, 800, 800)
      Valid pixels: 66283/640000 (10.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=185, max=256029, num_faces=256034
      Valid probs shape: (37, 66283)
    ✓ Random_29 (pose=(-2.8256153931951493, -2.7708250656834963, 2.6165722771277586)): shape (37, 800, 800)
      Valid pixels: 45231/640000 (7.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=256030, num_faces=256034
      Valid probs shape: (37, 45231)
    P stats: min=0.0000, max=1.0000, mean=0.0261
    Non-zero vertices: 123624/128019
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 4395 1260 1070 3192    0 2006 1056 4065 5829]
  Ground Truth Stats:
    Labels shape: (128019,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-14/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7890
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8347
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8351

  RESULTS:
  RAW:         median(top-10)=0.8949, mean(top-10)=0.9002, median(all)=0.8512, mean(all)=0.7890
  + SMOOTHING: median(top-10)=0.9169, mean(top-10)=0.9201, median(all)=0.8860, mean(all)=0.8347 [+0.0220]
  + MRF:       median(top-10)=0.9174, mean(top-10)=0.9204, median(all)=0.8870, mean(all)=0.8351 [+0.0004]
  TOTAL IMPROVEMENT (median top-10): +0.0225

================================================================================
Subject: OASIS-TRT-20-15
================================================================================
  Step 0: Generating predictions with V2 model (30 random views)...
  Mesh: 121081 vertices, 242158 faces
  Generating 30 random views...
  Generating predictions for 30 views (continuous camera pose)...
    ✓ Random_0 (pose=(-1.1338698997168022, -2.365126170249132, -0.18120181664419688)): shape (37, 800, 800)
      Valid pixels: 75782/640000 (11.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=234, max=242151, num_faces=242158
      Valid probs shape: (37, 75782)
    ✓ Random_1 (pose=(-2.616621802307887, 2.3540288225190142, -0.3454162755105088)): shape (37, 800, 800)
      Valid pixels: 59652/640000 (9.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=241827, num_faces=242158
      Valid probs shape: (37, 59652)
    ✓ Random_2 (pose=(2.351227648087443, -0.6379539242676282, -1.8594153137799954)): shape (37, 800, 800)
      Valid pixels: 52089/640000 (8.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=69, max=242153, num_faces=242158
      Valid probs shape: (37, 52089)
    ✓ Random_3 (pose=(0.6260395117779018, -1.680007731056554, -0.8066474756740751)): shape (37, 800, 800)
      Valid pixels: 54051/640000 (8.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=62, max=242156, num_faces=242158
      Valid probs shape: (37, 54051)
    ✓ Random_4 (pose=(-2.6801805044677485, -0.7643860475089741, 1.7299876762587685)): shape (37, 800, 800)
      Valid pixels: 55883/640000 (8.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2738, max=242156, num_faces=242158
      Valid probs shape: (37, 55883)
    ✓ Random_5 (pose=(-0.5743864556631513, -1.4105694202422971, 2.793388160650598)): shape (37, 800, 800)
      Valid pixels: 66607/640000 (10.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=242157, num_faces=242158
      Valid probs shape: (37, 66607)
    ✓ Random_6 (pose=(0.38799960881939866, -0.4640874006148037, -0.4800101770305574)): shape (37, 800, 800)
      Valid pixels: 42680/640000 (6.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=242156, num_faces=242158
      Valid probs shape: (37, 42680)
    ✓ Random_7 (pose=(2.232487542207691, 0.5094105483917533, 0.3247735878405309)): shape (37, 800, 800)
      Valid pixels: 73964/640000 (11.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=242157, num_faces=242158
      Valid probs shape: (37, 73964)
    ✓ Random_8 (pose=(0.9694059172225682, 2.851847461305759, -1.3252585524530345)): shape (37, 800, 800)
      Valid pixels: 59944/640000 (9.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=76, max=242156, num_faces=242158
      Valid probs shape: (37, 59944)
    ✓ Random_9 (pose=(-0.31064881357936436, 1.9001631388015854, 0.6589889264752653)): shape (37, 800, 800)
      Valid pixels: 79826/640000 (12.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=704, max=241880, num_faces=242158
      Valid probs shape: (37, 79826)
    ✓ Random_10 (pose=(-1.2712874900230189, 1.0054796206188348, -1.1230592183156114)): shape (37, 800, 800)
      Valid pixels: 56720/640000 (8.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=240823, num_faces=242158
      Valid probs shape: (37, 56720)
    ✓ Random_11 (pose=(-2.3834038601742344, -0.8486924467227128, -2.56186563956723)): shape (37, 800, 800)
      Valid pixels: 76628/640000 (12.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=242157, num_faces=242158
      Valid probs shape: (37, 76628)
    ✓ Random_12 (pose=(1.1419917488111686, 1.0398406819201025, 2.4218998307325244)): shape (37, 800, 800)
      Valid pixels: 81578/640000 (12.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=9, max=241776, num_faces=242158
      Valid probs shape: (37, 81578)
    ✓ Random_13 (pose=(1.3268811854743063, 3.1035202628752936, -1.2666935105819228)): shape (37, 800, 800)
      Valid pixels: 62074/640000 (9.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=16, max=242156, num_faces=242158
      Valid probs shape: (37, 62074)
    ✓ Random_14 (pose=(-0.8187417444591403, 3.0084335694837403, -1.7821261998861797)): shape (37, 800, 800)
      Valid pixels: 49936/640000 (7.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=71, max=242157, num_faces=242158
      Valid probs shape: (37, 49936)
    ✓ Random_15 (pose=(-0.8434812772577063, -0.666697766113252, 2.345377199404793)): shape (37, 800, 800)
      Valid pixels: 76059/640000 (11.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=242155, num_faces=242158
      Valid probs shape: (37, 76059)
    ✓ Random_16 (pose=(-1.0331563539024176, 1.428771756965575, -0.2805003625942226)): shape (37, 800, 800)
      Valid pixels: 77781/640000 (12.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=241876, num_faces=242158
      Valid probs shape: (37, 77781)
    ✓ Random_17 (pose=(2.2952904713069042, -3.04610096114223, -2.5371839753026983)): shape (37, 800, 800)
      Valid pixels: 56653/640000 (8.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=241827, num_faces=242158
      Valid probs shape: (37, 56653)
    ✓ Random_18 (pose=(-0.9315334225192617, 1.883956833548547, -2.332243182228332)): shape (37, 800, 800)
      Valid pixels: 79870/640000 (12.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=17, max=242157, num_faces=242158
      Valid probs shape: (37, 79870)
    ✓ Random_19 (pose=(-2.649944367917398, 1.9047429747067905, 2.6064813914651372)): shape (37, 800, 800)
      Valid pixels: 68405/640000 (10.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=242157, num_faces=242158
      Valid probs shape: (37, 68405)
    ✓ Random_20 (pose=(1.248663113062734, -1.3963465019758559, -2.420179930887297)): shape (37, 800, 800)
      Valid pixels: 69241/640000 (10.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=10, max=242151, num_faces=242158
      Valid probs shape: (37, 69241)
    ✓ Random_21 (pose=(0.3812136153202008, -1.7923480127617344, 1.8786250190801006)): shape (37, 800, 800)
      Valid pixels: 65862/640000 (10.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=242157, num_faces=242158
      Valid probs shape: (37, 65862)
    ✓ Random_22 (pose=(0.4972609317531864, 2.0029018558558693, -1.2820707346931186)): shape (37, 800, 800)
      Valid pixels: 81761/640000 (12.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=242157, num_faces=242158
      Valid probs shape: (37, 81761)
    ✓ Random_23 (pose=(-0.39248447939289255, -2.7077206410853307, 0.37148102839351793)): shape (37, 800, 800)
      Valid pixels: 42201/640000 (6.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2747, max=242153, num_faces=242158
      Valid probs shape: (37, 42201)
    ✓ Random_24 (pose=(0.4552492863527733, 2.1440736481056817, 2.1358896485459313)): shape (37, 800, 800)
      Valid pixels: 74248/640000 (11.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=540, max=242145, num_faces=242158
      Valid probs shape: (37, 74248)
    ✓ Random_25 (pose=(2.8631816197325506, -0.3621578791636324, -1.5874318082714425)): shape (37, 800, 800)
      Valid pixels: 47277/640000 (7.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=68, max=242153, num_faces=242158
      Valid probs shape: (37, 47277)
    ✓ Random_26 (pose=(3.0046644525324266, 0.2038699638999959, 2.168790628732994)): shape (37, 800, 800)
      Valid pixels: 38842/640000 (6.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1165, max=242145, num_faces=242158
      Valid probs shape: (37, 38842)
    ✓ Random_27 (pose=(0.28454085385369554, 0.6639517259334049, -2.5924844351367753)): shape (37, 800, 800)
      Valid pixels: 44172/640000 (6.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=242156, num_faces=242158
      Valid probs shape: (37, 44172)
    ✓ Random_28 (pose=(2.220574662691307, -3.052823230126794, 2.2233186649493772)): shape (37, 800, 800)
      Valid pixels: 66014/640000 (10.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=241776, num_faces=242158
      Valid probs shape: (37, 66014)
    ✓ Random_29 (pose=(-2.6340769419140617, -1.2243417679739463, 1.99619544777594)): shape (37, 800, 800)
      Valid pixels: 57598/640000 (9.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=375, max=242153, num_faces=242158
      Valid probs shape: (37, 57598)
    P stats: min=0.0000, max=1.0000, mean=0.0258
    Non-zero vertices: 115671/121081
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 5410 1320 1104 2599    0 1455 1058 4377 4541]
  Ground Truth Stats:
    Labels shape: (121081,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-15/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7747
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8257
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8261

  RESULTS:
  RAW:         median(top-10)=0.8892, mean(top-10)=0.8943, median(all)=0.8338, mean(all)=0.7747
  + SMOOTHING: median(top-10)=0.9215, mean(top-10)=0.9212, median(all)=0.8687, mean(all)=0.8257 [+0.0323]
  + MRF:       median(top-10)=0.9216, mean(top-10)=0.9216, median(all)=0.8698, mean(all)=0.8261 [+0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0324

================================================================================
Subject: OASIS-TRT-20-16
================================================================================
  Step 0: Generating predictions with V2 model (30 random views)...
  Mesh: 137726 vertices, 275448 faces
  Generating 30 random views...
  Generating predictions for 30 views (continuous camera pose)...
    ✓ Random_0 (pose=(-2.92596557562822, -1.6154524339879122, 1.235361762587119)): shape (37, 800, 800)
      Valid pixels: 109265/640000 (17.1%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=5, max=275443, num_faces=275448
      Valid probs shape: (37, 109265)
    ✓ Random_1 (pose=(2.729082499231617, -2.63454733015744, -0.8444562729960539)): shape (37, 800, 800)
      Valid pixels: 80182/640000 (12.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=275446, num_faces=275448
      Valid probs shape: (37, 80182)
    ✓ Random_2 (pose=(-1.371127526987626, 2.9883607393211298, 2.2689995618247147)): shape (37, 800, 800)
      Valid pixels: 109736/640000 (17.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=5, max=275343, num_faces=275448
      Valid probs shape: (37, 109736)
    ✓ Random_3 (pose=(1.8396823042606858, -2.364063242917209, -1.2597440603874677)): shape (37, 800, 800)
      Valid pixels: 97661/640000 (15.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=275447, num_faces=275448
      Valid probs shape: (37, 97661)
    ✓ Random_4 (pose=(2.3088808001308854, 1.8278361822795377, 2.692220213711301)): shape (37, 800, 800)
      Valid pixels: 94758/640000 (14.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=2, max=275447, num_faces=275448
      Valid probs shape: (37, 94758)
    ✓ Random_5 (pose=(-0.8062231942784988, 3.0495823906936037, -1.3851265338385512)): shape (37, 800, 800)
      Valid pixels: 66379/640000 (10.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=26460, max=275446, num_faces=275448
      Valid probs shape: (37, 66379)
    ✓ Random_6 (pose=(-2.1449828038370424, 2.1542159287761065, 1.8519936854388694)): shape (37, 800, 800)
      Valid pixels: 104731/640000 (16.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=275447, num_faces=275448
      Valid probs shape: (37, 104731)
    ✓ Random_7 (pose=(1.9619979890957957, -2.9369878305282837, -0.2085371347573166)): shape (37, 800, 800)
      Valid pixels: 109004/640000 (17.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=275447, num_faces=275448
      Valid probs shape: (37, 109004)
    ✓ Random_8 (pose=(-2.3632693379341005, -2.884828560591755, 2.417529246802995)): shape (37, 800, 800)
      Valid pixels: 77343/640000 (12.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=275445, num_faces=275448
      Valid probs shape: (37, 77343)
    ✓ Random_9 (pose=(2.824164009739895, 1.08933682492024, -1.4237791471940193)): shape (37, 800, 800)
      Valid pixels: 87895/640000 (13.7%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=1789, max=275444, num_faces=275448
      Valid probs shape: (37, 87895)
    ✓ Random_10 (pose=(-0.7972544838562152, 1.6802379593616052, -0.3145766802182468)): shape (37, 800, 800)
      Valid pixels: 99155/640000 (15.5%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=5, max=275447, num_faces=275448
      Valid probs shape: (37, 99155)
    ✓ Random_11 (pose=(-2.8241295023940554, 3.068045485512134, 1.7757168167891173)): shape (37, 800, 800)
      Valid pixels: 51386/640000 (8.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=275343, num_faces=275448
      Valid probs shape: (37, 51386)
    ✓ Random_12 (pose=(-0.9136981103967363, -2.229581670188785, 1.5006088069722532)): shape (37, 800, 800)
      Valid pixels: 98746/640000 (15.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=39, max=275443, num_faces=275448
      Valid probs shape: (37, 98746)
    ✓ Random_13 (pose=(2.7246298296933666, 1.6195007195876805, 2.851655446168367)): shape (37, 800, 800)
      Valid pixels: 78937/640000 (12.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=275447, num_faces=275448
      Valid probs shape: (37, 78937)
    ✓ Random_14 (pose=(-2.786770673798851, 1.4509038595441508, -2.820204744290727)): shape (37, 800, 800)
      Valid pixels: 68282/640000 (10.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=18, max=275447, num_faces=275448
      Valid probs shape: (37, 68282)
    ✓ Random_15 (pose=(-0.08608559165653773, 0.4941385906873057, -1.955193556418048)): shape (37, 800, 800)
      Valid pixels: 72376/640000 (11.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=275445, num_faces=275448
      Valid probs shape: (37, 72376)
    ✓ Random_16 (pose=(2.4132317087823942, -0.08643906145489755, 1.2163571341280646)): shape (37, 800, 800)
      Valid pixels: 52721/640000 (8.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3320, max=275446, num_faces=275448
      Valid probs shape: (37, 52721)
    ✓ Random_17 (pose=(-0.5173502944785708, -2.0173807694751678, -1.2220219528049223)): shape (37, 800, 800)
      Valid pixels: 107431/640000 (16.8%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=593, max=275446, num_faces=275448
      Valid probs shape: (37, 107431)
    ✓ Random_18 (pose=(-0.5761925812266213, 2.066692615633732, 2.7251674197600737)): shape (37, 800, 800)
      Valid pixels: 84691/640000 (13.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=225, max=275442, num_faces=275448
      Valid probs shape: (37, 84691)
    ✓ Random_19 (pose=(2.1796753428810316, -0.05834635438040969, -2.730400029002676)): shape (37, 800, 800)
      Valid pixels: 87225/640000 (13.6%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=3935, max=275444, num_faces=275448
      Valid probs shape: (37, 87225)
    ✓ Random_20 (pose=(-2.696868704553026, 0.13591695981626462, -1.5120558442212237)): shape (37, 800, 800)
      Valid pixels: 62689/640000 (9.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=58369, max=275447, num_faces=275448
      Valid probs shape: (37, 62689)
    ✓ Random_21 (pose=(1.5668076430351219, -1.4960214000534326, 1.1253093419448383)): shape (37, 800, 800)
      Valid pixels: 72631/640000 (11.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=275447, num_faces=275448
      Valid probs shape: (37, 72631)
    ✓ Random_22 (pose=(-0.6060287466696965, 0.5700791797501172, 0.8777656418253823)): shape (37, 800, 800)
      Valid pixels: 81329/640000 (12.7%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=1, max=274930, num_faces=275448
      Valid probs shape: (37, 81329)
    ✓ Random_23 (pose=(1.7508280256582625, 0.8967505789579198, 2.404010378938213)): shape (37, 800, 800)
      Valid pixels: 106226/640000 (16.6%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=140, max=275446, num_faces=275448
      Valid probs shape: (37, 106226)
    ✓ Random_24 (pose=(0.29442448875086713, 0.450677947241779, -1.794534362529954)): shape (37, 800, 800)
      Valid pixels: 66595/640000 (10.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=275445, num_faces=275448
      Valid probs shape: (37, 66595)
    ✓ Random_25 (pose=(-2.871482926724688, -1.4137950824979504, -0.3906613550812361)): shape (37, 800, 800)
      Valid pixels: 65146/640000 (10.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=246, max=275447, num_faces=275448
      Valid probs shape: (37, 65146)
    ✓ Random_26 (pose=(0.8211816644532788, -3.0635709263754, 2.147048250952232)): shape (37, 800, 800)
      Valid pixels: 83782/640000 (13.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=22204, max=275446, num_faces=275448
      Valid probs shape: (37, 83782)
    ✓ Random_27 (pose=(-0.5940612762288051, 1.1021921269310715, -1.9568008360783375)): shape (37, 800, 800)
      Valid pixels: 98454/640000 (15.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=275447, num_faces=275448
      Valid probs shape: (37, 98454)
    ✓ Random_28 (pose=(-0.7659496720689609, 2.3149391074178727, -2.6532010001585205)): shape (37, 800, 800)
      Valid pixels: 107351/640000 (16.8%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=29, max=275447, num_faces=275448
      Valid probs shape: (37, 107351)
    ✓ Random_29 (pose=(1.2944426479869486, 0.1388440296965121, 0.5249118060154108)): shape (37, 800, 800)
      Valid pixels: 88700/640000 (13.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=275447, num_faces=275448
      Valid probs shape: (37, 88700)
    P stats: min=0.0000, max=0.9997, mean=0.0251
    Non-zero vertices: 127939/137726
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 9787 1435  997 3754    0 1642  864 4902 6874]
  Ground Truth Stats:
    Labels shape: (137726,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-16/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7753
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8340
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8340

  RESULTS:
  RAW:         median(top-10)=0.9098, mean(top-10)=0.9105, median(all)=0.8161, mean(all)=0.7753
  + SMOOTHING: median(top-10)=0.9328, mean(top-10)=0.9327, median(all)=0.8821, mean(all)=0.8340 [+0.0230]
  + MRF:       median(top-10)=0.9330, mean(top-10)=0.9328, median(all)=0.8817, mean(all)=0.8340 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0232

================================================================================
Subject: OASIS-TRT-20-17
================================================================================
  Step 0: Generating predictions with V2 model (30 random views)...
  Mesh: 148245 vertices, 296486 faces
  Generating 30 random views...
  Generating predictions for 30 views (continuous camera pose)...
    ✓ Random_0 (pose=(-0.9378388772738404, 1.3165044195529898, -0.9359884062224122)): shape (37, 800, 800)
      Valid pixels: 70115/640000 (11.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=296396, num_faces=296486
      Valid probs shape: (37, 70115)
    ✓ Random_1 (pose=(-2.6274865959666096, -1.924741402291661, 1.5580989535362075)): shape (37, 800, 800)
      Valid pixels: 84490/640000 (13.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=296396, num_faces=296486
      Valid probs shape: (37, 84490)
    ✓ Random_2 (pose=(1.7926759817561901, -1.4213367286821625, 2.1252519659946225)): shape (37, 800, 800)
      Valid pixels: 106462/640000 (16.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=4, max=296399, num_faces=296486
      Valid probs shape: (37, 106462)
    ✓ Random_3 (pose=(-2.258101072513386, 1.597608036355834, -2.5316717601702425)): shape (37, 800, 800)
      Valid pixels: 69580/640000 (10.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=296477, num_faces=296486
      Valid probs shape: (37, 69580)
    ✓ Random_4 (pose=(-2.5150046041415584, 1.9099718719384633, -1.7493119374781052)): shape (37, 800, 800)
      Valid pixels: 106212/640000 (16.6%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=11, max=296396, num_faces=296486
      Valid probs shape: (37, 106212)
    ✓ Random_5 (pose=(-0.05523497707546543, 3.095503198479154, 0.39833986361461493)): shape (37, 800, 800)
      Valid pixels: 52650/640000 (8.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=9636, max=296485, num_faces=296486
      Valid probs shape: (37, 52650)
    ✓ Random_6 (pose=(1.4550630144816319, 1.8695716175510029, -0.01901948654631358)): shape (37, 800, 800)
      Valid pixels: 112900/640000 (17.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=10, max=296477, num_faces=296486
      Valid probs shape: (37, 112900)
    ✓ Random_7 (pose=(2.0491410546413373, 1.4869957678884802, 1.405921880552449)): shape (37, 800, 800)
      Valid pixels: 79025/640000 (12.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=11, max=296477, num_faces=296486
      Valid probs shape: (37, 79025)
    ✓ Random_8 (pose=(-1.3243379196986882, -0.8363703027136138, 1.7986024690234954)): shape (37, 800, 800)
      Valid pixels: 86641/640000 (13.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=296475, num_faces=296486
      Valid probs shape: (37, 86641)
    ✓ Random_9 (pose=(-2.2338691298966804, -2.452755715901608, 0.019786553066535095)): shape (37, 800, 800)
      Valid pixels: 107121/640000 (16.7%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=11, max=296396, num_faces=296486
      Valid probs shape: (37, 107121)
    ✓ Random_10 (pose=(1.1132476783367062, -1.1968724151622838, -0.41661233129717967)): shape (37, 800, 800)
      Valid pixels: 101900/640000 (15.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=10, max=296485, num_faces=296486
      Valid probs shape: (37, 101900)
    ✓ Random_11 (pose=(2.2766973279549036, -2.3992189253185066, 0.1865589309875384)): shape (37, 800, 800)
      Valid pixels: 83738/640000 (13.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=296477, num_faces=296486
      Valid probs shape: (37, 83738)
    ✓ Random_12 (pose=(-1.325987274441057, -2.372615221804596, 0.23311503081156637)): shape (37, 800, 800)
      Valid pixels: 93048/640000 (14.5%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=12, max=296396, num_faces=296486
      Valid probs shape: (37, 93048)
    ✓ Random_13 (pose=(1.3172250797177592, 1.60013972283775, 1.9493870966977722)): shape (37, 800, 800)
      Valid pixels: 102651/640000 (16.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=8, max=296396, num_faces=296486
      Valid probs shape: (37, 102651)
    ✓ Random_14 (pose=(-2.871507369912634, -0.3467099303815244, -0.16146698753023792)): shape (37, 800, 800)
      Valid pixels: 59369/640000 (9.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=71156, max=296485, num_faces=296486
      Valid probs shape: (37, 59369)
    ✓ Random_15 (pose=(0.803322818688764, -0.36111436065713454, -1.4720963728713625)): shape (37, 800, 800)
      Valid pixels: 54224/640000 (8.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7, max=296484, num_faces=296486
      Valid probs shape: (37, 54224)
    ✓ Random_16 (pose=(-2.855120945869646, 3.0785917502693483, 1.917665395847342)): shape (37, 800, 800)
      Valid pixels: 47148/640000 (7.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=296477, num_faces=296486
      Valid probs shape: (37, 47148)
    ✓ Random_17 (pose=(-2.9108105039943193, -3.0560639391309956, -2.747806406017795)): shape (37, 800, 800)
      Valid pixels: 55456/640000 (8.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=296477, num_faces=296486
      Valid probs shape: (37, 55456)
    ✓ Random_18 (pose=(0.443341505887652, -0.05358456597391781, 0.6077688040808962)): shape (37, 800, 800)
      Valid pixels: 65168/640000 (10.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=296477, num_faces=296486
      Valid probs shape: (37, 65168)
    ✓ Random_19 (pose=(0.43309788776121794, -0.18780909190708162, 1.8567950301842604)): shape (37, 800, 800)
      Valid pixels: 62714/640000 (9.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=294425, num_faces=296486
      Valid probs shape: (37, 62714)
    ✓ Random_20 (pose=(2.6472663601341875, 1.3941805134334624, -2.8445082144282137)): shape (37, 800, 800)
      Valid pixels: 105656/640000 (16.5%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=157, max=296396, num_faces=296486
      Valid probs shape: (37, 105656)
    ✓ Random_21 (pose=(-1.4829833644604713, -2.6696003474616345, -2.0689385877134603)): shape (37, 800, 800)
      Valid pixels: 73138/640000 (11.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=11, max=296477, num_faces=296486
      Valid probs shape: (37, 73138)
    ✓ Random_22 (pose=(2.5773258775166132, -0.8373175885334163, -0.6156956563114351)): shape (37, 800, 800)
      Valid pixels: 94129/640000 (14.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=428, max=296477, num_faces=296486
      Valid probs shape: (37, 94129)
    ✓ Random_23 (pose=(1.147886936050801, 0.5132881349211167, 2.0158003818969847)): shape (37, 800, 800)
      Valid pixels: 102238/640000 (16.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=7, max=296396, num_faces=296486
      Valid probs shape: (37, 102238)
    ✓ Random_24 (pose=(0.6269384658480339, 0.7774603065526096, 1.3578005599826488)): shape (37, 800, 800)
      Valid pixels: 93521/640000 (14.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=295989, num_faces=296486
      Valid probs shape: (37, 93521)
    ✓ Random_25 (pose=(-0.38815591822848994, 2.688105341353424, -1.3378369395389234)): shape (37, 800, 800)
      Valid pixels: 53720/640000 (8.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2394, max=296475, num_faces=296486
      Valid probs shape: (37, 53720)
    ✓ Random_26 (pose=(-1.2191578835806218, 1.982267348847805, -2.509698671496073)): shape (37, 800, 800)
      Valid pixels: 104631/640000 (16.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=10, max=296477, num_faces=296486
      Valid probs shape: (37, 104631)
    ✓ Random_27 (pose=(-2.713731124061549, 2.90428263220804, 1.8951457599756942)): shape (37, 800, 800)
      Valid pixels: 58372/640000 (9.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=296477, num_faces=296486
      Valid probs shape: (37, 58372)
    ✓ Random_28 (pose=(1.579809812194945, 1.1237003034489152, 1.516969686654038)): shape (37, 800, 800)
      Valid pixels: 67224/640000 (10.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=10, max=296477, num_faces=296486
      Valid probs shape: (37, 67224)
    ✓ Random_29 (pose=(-2.262104607233201, -2.401823007383171, 0.2828978064726977)): shape (37, 800, 800)
      Valid pixels: 106139/640000 (16.6%)
      Probs stats: min=0.0000, max=0.9993, mean=0.0270
      Face IDs: min=4, max=296396, num_faces=296486
      Valid probs shape: (37, 106139)
    P stats: min=0.0000, max=0.9999, mean=0.0251
    Non-zero vertices: 137686/148245
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 10559  1131  1091  4247     0  1711  1213  4517  6293]
  Ground Truth Stats:
    Labels shape: (148245,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-17/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
    MRF iteration 5/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7441
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7976
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7983

  RESULTS:
  RAW:         median(top-10)=0.8708, mean(top-10)=0.8738, median(all)=0.7968, mean(all)=0.7441
  + SMOOTHING: median(top-10)=0.8996, mean(top-10)=0.9025, median(all)=0.8453, mean(all)=0.7976 [+0.0287]
  + MRF:       median(top-10)=0.9002, mean(top-10)=0.9030, median(all)=0.8463, mean(all)=0.7983 [+0.0007]
  TOTAL IMPROVEMENT (median top-10): +0.0294

================================================================================
Subject: OASIS-TRT-20-18
================================================================================
  Step 0: Generating predictions with V2 model (30 random views)...
  Mesh: 140676 vertices, 281348 faces
  Generating 30 random views...
  Generating predictions for 30 views (continuous camera pose)...
    ✓ Random_0 (pose=(-0.6565559392502291, 0.24618355145158954, 0.02772215658473476)): shape (37, 800, 800)
      Valid pixels: 66127/640000 (10.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=280392, num_faces=281348
      Valid probs shape: (37, 66127)
    ✓ Random_1 (pose=(1.6405913936045353, 2.3725404407630277, -2.6137014442600646)): shape (37, 800, 800)
      Valid pixels: 69535/640000 (10.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=13, max=281301, num_faces=281348
      Valid probs shape: (37, 69535)
    ✓ Random_2 (pose=(-2.0931880506785348, 1.9652234858552795, 2.2950777221945255)): shape (37, 800, 800)
      Valid pixels: 92142/640000 (14.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=281347, num_faces=281348
      Valid probs shape: (37, 92142)
    ✓ Random_3 (pose=(-0.06990417782272784, 0.2824455847670384, 1.3384695875903576)): shape (37, 800, 800)
      Valid pixels: 49382/640000 (7.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=281171, num_faces=281348
      Valid probs shape: (37, 49382)
    ✓ Random_4 (pose=(1.7067179023261136, 2.086142701561407, -3.1107803439854202)): shape (37, 800, 800)
      Valid pixels: 83124/640000 (13.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=13, max=281249, num_faces=281348
      Valid probs shape: (37, 83124)
    ✓ Random_5 (pose=(-1.4228794505606228, 0.779070898422892, -0.0025392578125256193)): shape (37, 800, 800)
      Valid pixels: 83255/640000 (13.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=281233, num_faces=281348
      Valid probs shape: (37, 83255)
    ✓ Random_6 (pose=(0.8688753113525935, 0.7462599464038493, -1.7159798069786258)): shape (37, 800, 800)
      Valid pixels: 72790/640000 (11.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=281347, num_faces=281348
      Valid probs shape: (37, 72790)
    ✓ Random_7 (pose=(2.9037454737471204, 0.9656476288909719, -2.766183971017188)): shape (37, 800, 800)
      Valid pixels: 79454/640000 (12.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4091, max=281304, num_faces=281348
      Valid probs shape: (37, 79454)
    ✓ Random_8 (pose=(2.132760383690509, -3.0462910887687484, 0.9739086622026596)): shape (37, 800, 800)
      Valid pixels: 55858/640000 (8.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=281345, num_faces=281348
      Valid probs shape: (37, 55858)
    ✓ Random_9 (pose=(-2.8320934936302846, 0.5874794825798579, 1.1500193073817746)): shape (37, 800, 800)
      Valid pixels: 61616/640000 (9.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=22, max=281347, num_faces=281348
      Valid probs shape: (37, 61616)
    ✓ Random_10 (pose=(-0.5197544701081158, 2.755552405345168, -1.7540401448598069)): shape (37, 800, 800)
      Valid pixels: 54605/640000 (8.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=762, max=281345, num_faces=281348
      Valid probs shape: (37, 54605)
    ✓ Random_11 (pose=(0.5794003385219781, -0.9976960783757209, -0.10816956432698177)): shape (37, 800, 800)
      Valid pixels: 78705/640000 (12.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=12, max=281347, num_faces=281348
      Valid probs shape: (37, 78705)
    ✓ Random_12 (pose=(0.8932613511300822, 3.1353687981729452, -0.577767967295661)): shape (37, 800, 800)
      Valid pixels: 76552/640000 (12.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=348, max=281347, num_faces=281348
      Valid probs shape: (37, 76552)
    ✓ Random_13 (pose=(0.7966877632825144, -0.1263382365611272, -1.126256590437293)): shape (37, 800, 800)
      Valid pixels: 59920/640000 (9.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=281347, num_faces=281348
      Valid probs shape: (37, 59920)
    ✓ Random_14 (pose=(1.3114810496238158, -0.4191106399389315, -1.9434699228379415)): shape (37, 800, 800)
      Valid pixels: 61788/640000 (9.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=281250, num_faces=281348
      Valid probs shape: (37, 61788)
    ✓ Random_15 (pose=(1.5078486250607241, -0.20420187522101374, -1.0195643824142948)): shape (37, 800, 800)
      Valid pixels: 87118/640000 (13.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=36, max=281347, num_faces=281348
      Valid probs shape: (37, 87118)
    ✓ Random_16 (pose=(-1.72705247847656, -2.410362355694605, -1.4875779852592115)): shape (37, 800, 800)
      Valid pixels: 61462/640000 (9.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=281297, num_faces=281348
      Valid probs shape: (37, 61462)
    ✓ Random_17 (pose=(2.1870656063235314, -2.291849216519079, -1.970426179767371)): shape (37, 800, 800)
      Valid pixels: 63755/640000 (10.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=13, max=281346, num_faces=281348
      Valid probs shape: (37, 63755)
    ✓ Random_18 (pose=(2.5316477398770516, 2.2217512703951137, 0.9428538573895073)): shape (37, 800, 800)
      Valid pixels: 76139/640000 (11.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=281346, num_faces=281348
      Valid probs shape: (37, 76139)
    ✓ Random_19 (pose=(0.7634334429073495, 2.2606383026027617, 0.13930570713049217)): shape (37, 800, 800)
      Valid pixels: 63028/640000 (9.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=281, max=281345, num_faces=281348
      Valid probs shape: (37, 63028)
    ✓ Random_20 (pose=(-0.897671388692618, 2.526918194137048, 2.2238206131599165)): shape (37, 800, 800)
      Valid pixels: 68601/640000 (10.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=330, max=281347, num_faces=281348
      Valid probs shape: (37, 68601)
    ✓ Random_21 (pose=(-0.20852314493235724, 3.1013253752419443, -1.4907396660274828)): shape (37, 800, 800)
      Valid pixels: 41742/640000 (6.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=14590, max=281304, num_faces=281348
      Valid probs shape: (37, 41742)
    ✓ Random_22 (pose=(-0.224032262047559, 1.7174595471496064, 1.911743866027062)): shape (37, 800, 800)
      Valid pixels: 68030/640000 (10.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=163, max=281299, num_faces=281348
      Valid probs shape: (37, 68030)
    ✓ Random_23 (pose=(-1.2934206593306872, -0.006323848177720137, -0.18303836143174212)): shape (37, 800, 800)
      Valid pixels: 82471/640000 (12.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=281237, num_faces=281348
      Valid probs shape: (37, 82471)
    ✓ Random_24 (pose=(-0.35808532869407106, -0.4669937557835029, -0.223898925159415)): shape (37, 800, 800)
      Valid pixels: 52740/640000 (8.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=281249, num_faces=281348
      Valid probs shape: (37, 52740)
    ✓ Random_25 (pose=(-0.9898523579711842, 2.131470658448542, 0.07392151361171173)): shape (37, 800, 800)
      Valid pixels: 87933/640000 (13.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=83, max=281301, num_faces=281348
      Valid probs shape: (37, 87933)
    ✓ Random_26 (pose=(-2.2689039319330466, -2.5948745832925493, 2.667577023214311)): shape (37, 800, 800)
      Valid pixels: 77245/640000 (12.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=281347, num_faces=281348
      Valid probs shape: (37, 77245)
    ✓ Random_27 (pose=(1.6974316390793716, -2.3624670130677137, -1.384980584485086)): shape (37, 800, 800)
      Valid pixels: 77199/640000 (12.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=36, max=281347, num_faces=281348
      Valid probs shape: (37, 77199)
    ✓ Random_28 (pose=(-2.4578536347809727, 0.497033125157905, 2.8679432684244714)): shape (37, 800, 800)
      Valid pixels: 65953/640000 (10.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=70, max=281344, num_faces=281348
      Valid probs shape: (37, 65953)
    ✓ Random_29 (pose=(2.654528569362048, -2.4630034962121043, 3.018020271634545)): shape (37, 800, 800)
      Valid pixels: 57285/640000 (9.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=281249, num_faces=281348
      Valid probs shape: (37, 57285)
    P stats: min=0.0000, max=0.9999, mean=0.0255
    Non-zero vertices: 132882/140676
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 7794 1375 1052 3464    0 2385 1256 4596 6525]
  Ground Truth Stats:
    Labels shape: (140676,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-18/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
    MRF iteration 5/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7652
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8138
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8141

  RESULTS:
  RAW:         median(top-10)=0.8787, mean(top-10)=0.8879, median(all)=0.8383, mean(all)=0.7652
  + SMOOTHING: median(top-10)=0.9007, mean(top-10)=0.9094, median(all)=0.8657, mean(all)=0.8138 [+0.0220]
  + MRF:       median(top-10)=0.9011, mean(top-10)=0.9097, median(all)=0.8661, mean(all)=0.8141 [+0.0004]
  TOTAL IMPROVEMENT (median top-10): +0.0224

================================================================================
Subject: OASIS-TRT-20-19
================================================================================
  Step 0: Generating predictions with V2 model (30 random views)...
  Mesh: 114731 vertices, 229458 faces
  Generating 30 random views...
  Generating predictions for 30 views (continuous camera pose)...
    ✓ Random_0 (pose=(-0.5162506136400307, 0.4534206383200474, -0.5447287240646626)): shape (37, 800, 800)
      Valid pixels: 75939/640000 (11.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=228802, num_faces=229458
      Valid probs shape: (37, 75939)
    ✓ Random_1 (pose=(-1.769201029858319, -1.2809670781993407, 2.2595721413418683)): shape (37, 800, 800)
      Valid pixels: 97486/640000 (15.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=33, max=229407, num_faces=229458
      Valid probs shape: (37, 97486)
    ✓ Random_2 (pose=(-3.0841938387664682, 2.0819544804476724, 1.8846504836043438)): shape (37, 800, 800)
      Valid pixels: 86067/640000 (13.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=229406, num_faces=229458
      Valid probs shape: (37, 86067)
    ✓ Random_3 (pose=(-0.6428637514461815, -2.9969152600238926, -0.6983936954698429)): shape (37, 800, 800)
      Valid pixels: 81409/640000 (12.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=19732, max=229453, num_faces=229458
      Valid probs shape: (37, 81409)
    ✓ Random_4 (pose=(-0.3102009860063415, -1.9369746767789169, -0.2159091104381985)): shape (37, 800, 800)
      Valid pixels: 76405/640000 (11.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1512, max=229457, num_faces=229458
      Valid probs shape: (37, 76405)
    ✓ Random_5 (pose=(1.762258762257158, 1.3219375518789587, -0.17775382026001596)): shape (37, 800, 800)
      Valid pixels: 114777/640000 (17.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=229407, num_faces=229458
      Valid probs shape: (37, 114777)
    ✓ Random_6 (pose=(1.0460722585082767, -2.0009945570996353, 2.2272835869729795)): shape (37, 800, 800)
      Valid pixels: 76263/640000 (11.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2183, max=229453, num_faces=229458
      Valid probs shape: (37, 76263)
    ✓ Random_7 (pose=(0.23751171986214725, 0.10877300070246587, -1.232060356581292)): shape (37, 800, 800)
      Valid pixels: 49456/640000 (7.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=229397, num_faces=229458
      Valid probs shape: (37, 49456)
    ✓ Random_8 (pose=(-2.8818988018386777, -3.023104982824865, -1.9624730636311527)): shape (37, 800, 800)
      Valid pixels: 51807/640000 (8.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=229199, num_faces=229458
      Valid probs shape: (37, 51807)
    ✓ Random_9 (pose=(-2.162311108553352, -3.080297406308642, 1.7506129905529724)): shape (37, 800, 800)
      Valid pixels: 64237/640000 (10.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=229406, num_faces=229458
      Valid probs shape: (37, 64237)
    ✓ Random_10 (pose=(-0.345202939256533, -0.6161913279913662, 1.9753665585902453)): shape (37, 800, 800)
      Valid pixels: 76043/640000 (11.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=229406, num_faces=229458
      Valid probs shape: (37, 76043)
    ✓ Random_11 (pose=(-1.8238254660872957, 2.500514493902328, -1.3944513416316258)): shape (37, 800, 800)
      Valid pixels: 87216/640000 (13.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=2, max=229452, num_faces=229458
      Valid probs shape: (37, 87216)
    ✓ Random_12 (pose=(-0.09120560736650773, 0.5961003580544935, 0.1025510017782385)): shape (37, 800, 800)
      Valid pixels: 70862/640000 (11.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=222178, num_faces=229458
      Valid probs shape: (37, 70862)
    ✓ Random_13 (pose=(0.5404309337685498, 1.3830232027454414, 0.3135406654580808)): shape (37, 800, 800)
      Valid pixels: 67177/640000 (10.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=10, max=229423, num_faces=229458
      Valid probs shape: (37, 67177)
    ✓ Random_14 (pose=(0.07472213173436915, -0.6142200338142132, -1.2706777578946702)): shape (37, 800, 800)
      Valid pixels: 69919/640000 (10.9%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=0, max=229275, num_faces=229458
      Valid probs shape: (37, 69919)
    ✓ Random_15 (pose=(-0.008776856453612591, -0.8685517273199688, 0.011001966486265946)): shape (37, 800, 800)
      Valid pixels: 59679/640000 (9.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=229407, num_faces=229458
      Valid probs shape: (37, 59679)
    ✓ Random_16 (pose=(0.5864457485254055, 0.8358498445509133, 0.4413618218841635)): shape (37, 800, 800)
      Valid pixels: 64664/640000 (10.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=229436, num_faces=229458
      Valid probs shape: (37, 64664)
    ✓ Random_17 (pose=(-1.8115825940890042, -0.7356198780987184, 2.2790554862945696)): shape (37, 800, 800)
      Valid pixels: 100059/640000 (15.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=86, max=229407, num_faces=229458
      Valid probs shape: (37, 100059)
    ✓ Random_18 (pose=(1.2666896739161082, 2.5354325966285636, 1.2684826802337588)): shape (37, 800, 800)
      Valid pixels: 64553/640000 (10.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2188, max=229454, num_faces=229458
      Valid probs shape: (37, 64553)
    ✓ Random_19 (pose=(-0.6920983176857076, -1.5628947189401012, -0.6324123766051444)): shape (37, 800, 800)
      Valid pixels: 91841/640000 (14.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=0, max=229457, num_faces=229458
      Valid probs shape: (37, 91841)
    ✓ Random_20 (pose=(2.5449787741672525, -1.5029918884835296, 2.431439309195924)): shape (37, 800, 800)
      Valid pixels: 91470/640000 (14.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=2, max=229453, num_faces=229458
      Valid probs shape: (37, 91470)
    ✓ Random_21 (pose=(-2.5107591568693817, 2.0653423294514486, -1.8517916377886168)): shape (37, 800, 800)
      Valid pixels: 96152/640000 (15.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=229452, num_faces=229458
      Valid probs shape: (37, 96152)
    ✓ Random_22 (pose=(2.022294108166924, 0.5115834428729609, -2.048614418078251)): shape (37, 800, 800)
      Valid pixels: 78251/640000 (12.2%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=1352, max=229453, num_faces=229458
      Valid probs shape: (37, 78251)
    ✓ Random_23 (pose=(3.0193177512913776, -1.1309008662096236, 2.3553476454549997)): shape (37, 800, 800)
      Valid pixels: 80796/640000 (12.6%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=1339, max=229453, num_faces=229458
      Valid probs shape: (37, 80796)
    ✓ Random_24 (pose=(-2.745929556335347, 1.5807720414388342, -0.3653129224331484)): shape (37, 800, 800)
      Valid pixels: 78834/640000 (12.3%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=42, max=229453, num_faces=229458
      Valid probs shape: (37, 78834)
    ✓ Random_25 (pose=(-2.2920020144446607, 0.9580534655336237, -2.4418727366458297)): shape (37, 800, 800)
      Valid pixels: 65610/640000 (10.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1296, max=229456, num_faces=229458
      Valid probs shape: (37, 65610)
    ✓ Random_26 (pose=(-2.920830991865093, 0.11999913913455318, -1.3667809297365436)): shape (37, 800, 800)
      Valid pixels: 54567/640000 (8.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=62884, max=229457, num_faces=229458
      Valid probs shape: (37, 54567)
    ✓ Random_27 (pose=(-0.9481635181365227, 1.5936737109094903, -2.6090785334417004)): shape (37, 800, 800)
      Valid pixels: 110666/640000 (17.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=229407, num_faces=229458
      Valid probs shape: (37, 110666)
    ✓ Random_28 (pose=(-3.03253485898179, -1.498858820692548, -2.2860490777168136)): shape (37, 800, 800)
      Valid pixels: 112205/640000 (17.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=229407, num_faces=229458
      Valid probs shape: (37, 112205)
    ✓ Random_29 (pose=(-1.2819978858305774, 0.5296386109325999, 1.7282518044800943)): shape (37, 800, 800)
      Valid pixels: 67260/640000 (10.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=229407, num_faces=229458
      Valid probs shape: (37, 67260)
    P stats: min=0.0000, max=0.9999, mean=0.0252
    Non-zero vertices: 106930/114731
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 7801 1133  928 2152    0 1942  801 3394 7105]
  Ground Truth Stats:
    Labels shape: (114731,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-19/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7525
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8104
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8108

  RESULTS:
  RAW:         median(top-10)=0.9013, mean(top-10)=0.9061, median(all)=0.8090, mean(all)=0.7525
  + SMOOTHING: median(top-10)=0.9236, mean(top-10)=0.9277, median(all)=0.8622, mean(all)=0.8104 [+0.0222]
  + MRF:       median(top-10)=0.9239, mean(top-10)=0.9280, median(all)=0.8634, mean(all)=0.8108 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0226

================================================================================
Subject: OASIS-TRT-20-2
================================================================================
  Step 0: Generating predictions with V2 model (30 random views)...
  Mesh: 153483 vertices, 306962 faces
  Generating 30 random views...
  Generating predictions for 30 views (continuous camera pose)...
    ✓ Random_0 (pose=(1.3899346590193842, 0.9115853445596498, -3.029317554683854)): shape (37, 800, 800)
      Valid pixels: 85033/640000 (13.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=2, max=306959, num_faces=306962
      Valid probs shape: (37, 85033)
    ✓ Random_1 (pose=(2.1695384858779887, -2.6358335012316716, -0.3569514033891772)): shape (37, 800, 800)
      Valid pixels: 89072/640000 (13.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=306868, num_faces=306962
      Valid probs shape: (37, 89072)
    ✓ Random_2 (pose=(-2.533056893685856, 0.7109913207119036, 2.8744762704372215)): shape (37, 800, 800)
      Valid pixels: 70790/640000 (11.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=13, max=306960, num_faces=306962
      Valid probs shape: (37, 70790)
    ✓ Random_3 (pose=(0.341190415047278, -1.9687522171735083, 2.8715110352700632)): shape (37, 800, 800)
      Valid pixels: 64195/640000 (10.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2549, max=305586, num_faces=306962
      Valid probs shape: (37, 64195)
    ✓ Random_4 (pose=(1.8093493784055754, -2.9870883081815287, -0.8795224849955607)): shape (37, 800, 800)
      Valid pixels: 91995/640000 (14.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=306961, num_faces=306962
      Valid probs shape: (37, 91995)
    ✓ Random_5 (pose=(-0.23437257417827695, 0.6933054176542188, -2.708775332368523)): shape (37, 800, 800)
      Valid pixels: 70195/640000 (11.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=306868, num_faces=306962
      Valid probs shape: (37, 70195)
    ✓ Random_6 (pose=(0.7509688481316243, 1.3165531346165107, 2.254820390907023)): shape (37, 800, 800)
      Valid pixels: 91192/640000 (14.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=9, max=306960, num_faces=306962
      Valid probs shape: (37, 91192)
    ✓ Random_7 (pose=(-0.7919835339737049, 2.7089825006256802, 2.0960963348742476)): shape (37, 800, 800)
      Valid pixels: 60426/640000 (9.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=275, max=306961, num_faces=306962
      Valid probs shape: (37, 60426)
    ✓ Random_8 (pose=(1.1435545135338145, -2.188453937748095, -0.8184408795715017)): shape (37, 800, 800)
      Valid pixels: 81465/640000 (12.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=106, max=306960, num_faces=306962
      Valid probs shape: (37, 81465)
    ✓ Random_9 (pose=(0.9953456528116007, 1.175381281512685, -2.524970729178172)): shape (37, 800, 800)
      Valid pixels: 66338/640000 (10.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=306958, num_faces=306962
      Valid probs shape: (37, 66338)
    ✓ Random_10 (pose=(1.6616281543063538, 2.5581535768451698, 1.0575915973788677)): shape (37, 800, 800)
      Valid pixels: 69918/640000 (10.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=306869, num_faces=306962
      Valid probs shape: (37, 69918)
    ✓ Random_11 (pose=(3.037181052888079, 0.7157267690957703, 1.4848292390778708)): shape (37, 800, 800)
      Valid pixels: 69459/640000 (10.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=86, max=306961, num_faces=306962
      Valid probs shape: (37, 69459)
    ✓ Random_12 (pose=(-1.4088977056703758, -3.101815148347599, 1.6545119572944307)): shape (37, 800, 800)
      Valid pixels: 67249/640000 (10.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=157, max=306960, num_faces=306962
      Valid probs shape: (37, 67249)
    ✓ Random_13 (pose=(-2.854347220861684, -1.6584825636612142, 1.0274205083730727)): shape (37, 800, 800)
      Valid pixels: 94818/640000 (14.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=306959, num_faces=306962
      Valid probs shape: (37, 94818)
    ✓ Random_14 (pose=(-1.2392690326024913, -2.3035845769430763, 0.38725567427021934)): shape (37, 800, 800)
      Valid pixels: 78251/640000 (12.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=483, max=306959, num_faces=306962
      Valid probs shape: (37, 78251)
    ✓ Random_15 (pose=(1.510218859989937, -2.779494836265762, -1.9133231935937443)): shape (37, 800, 800)
      Valid pixels: 68074/640000 (10.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=67, max=306959, num_faces=306962
      Valid probs shape: (37, 68074)
    ✓ Random_16 (pose=(1.9591207791410756, -2.8988522838573316, 1.352823467210511)): shape (37, 800, 800)
      Valid pixels: 59157/640000 (9.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=306709, num_faces=306962
      Valid probs shape: (37, 59157)
    ✓ Random_17 (pose=(1.260158180436747, 1.5005297503380879, -1.9598820788379667)): shape (37, 800, 800)
      Valid pixels: 63580/640000 (9.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=76, max=306960, num_faces=306962
      Valid probs shape: (37, 63580)
    ✓ Random_18 (pose=(-1.1038153644400994, -2.332913378210867, -0.07468102493267148)): shape (37, 800, 800)
      Valid pixels: 86291/640000 (13.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=80, max=306959, num_faces=306962
      Valid probs shape: (37, 86291)
    ✓ Random_19 (pose=(2.9357314031245627, 0.08794341806254202, 0.24338666324737623)): shape (37, 800, 800)
      Valid pixels: 44002/640000 (6.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1640, max=306960, num_faces=306962
      Valid probs shape: (37, 44002)
    ✓ Random_20 (pose=(2.2295489643186555, 1.8966194971969506, -2.836140856360562)): shape (37, 800, 800)
      Valid pixels: 94201/640000 (14.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=9, max=306727, num_faces=306962
      Valid probs shape: (37, 94201)
    ✓ Random_21 (pose=(-0.8821479158796701, 1.8396883315466512, -0.6105682078075825)): shape (37, 800, 800)
      Valid pixels: 75747/640000 (11.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=535, max=305597, num_faces=306962
      Valid probs shape: (37, 75747)
    ✓ Random_22 (pose=(0.6111224632018262, -0.2811608035557729, 2.592354984210444)): shape (37, 800, 800)
      Valid pixels: 66196/640000 (10.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=305649, num_faces=306962
      Valid probs shape: (37, 66196)
    ✓ Random_23 (pose=(-1.9344561645736715, -2.9921057247796896, -2.098019785973638)): shape (37, 800, 800)
      Valid pixels: 67866/640000 (10.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=306871, num_faces=306962
      Valid probs shape: (37, 67866)
    ✓ Random_24 (pose=(2.963027534957635, -1.289103998359473, 1.0191707682321223)): shape (37, 800, 800)
      Valid pixels: 92161/640000 (14.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=402, max=305594, num_faces=306962
      Valid probs shape: (37, 92161)
    ✓ Random_25 (pose=(1.5933798639016352, -0.4811873744838011, 0.4156858324021062)): shape (37, 800, 800)
      Valid pixels: 86097/640000 (13.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=306869, num_faces=306962
      Valid probs shape: (37, 86097)
    ✓ Random_26 (pose=(1.895879170246518, -0.8701148616027146, -1.2402471227746785)): shape (37, 800, 800)
      Valid pixels: 90015/640000 (14.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=110, max=306961, num_faces=306962
      Valid probs shape: (37, 90015)
    ✓ Random_27 (pose=(-2.601570997735002, 1.3362391933240634, 0.5229891959550166)): shape (37, 800, 800)
      Valid pixels: 64080/640000 (10.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=148, max=306960, num_faces=306962
      Valid probs shape: (37, 64080)
    ✓ Random_28 (pose=(-1.8692819994938548, -1.795337796243944, -1.3348667828230727)): shape (37, 800, 800)
      Valid pixels: 60449/640000 (9.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=306712, num_faces=306962
      Valid probs shape: (37, 60449)
    ✓ Random_29 (pose=(1.023212902471725, -2.4314814105989986, 1.0248410596376)): shape (37, 800, 800)
      Valid pixels: 75084/640000 (11.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=271, max=306869, num_faces=306962
      Valid probs shape: (37, 75084)
    P stats: min=0.0000, max=0.9999, mean=0.0251
    Non-zero vertices: 142711/153483
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 10772  1387  1285  3556     0  2405  1105  5357  6153]
  Ground Truth Stats:
    Labels shape: (153483,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-2/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7848
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8433
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8436

  RESULTS:
  RAW:         median(top-10)=0.9094, mean(top-10)=0.9140, median(all)=0.8621, mean(all)=0.7848
  + SMOOTHING: median(top-10)=0.9392, mean(top-10)=0.9383, median(all)=0.8955, mean(all)=0.8433 [+0.0298]
  + MRF:       median(top-10)=0.9396, mean(top-10)=0.9385, median(all)=0.8960, mean(all)=0.8436 [+0.0004]
  TOTAL IMPROVEMENT (median top-10): +0.0302

================================================================================
Subject: OASIS-TRT-20-20
================================================================================
  Step 0: Generating predictions with V2 model (30 random views)...
  Mesh: 124947 vertices, 249890 faces
  Generating 30 random views...
  Generating predictions for 30 views (continuous camera pose)...
    ✓ Random_0 (pose=(-2.4425639663497076, -0.5665859918530387, -0.9771253418093262)): shape (37, 800, 800)
      Valid pixels: 65279/640000 (10.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=11039, max=249719, num_faces=249890
      Valid probs shape: (37, 65279)
    ✓ Random_1 (pose=(-1.56943904249536, 1.5514774342788265, -0.08189183907656927)): shape (37, 800, 800)
      Valid pixels: 98651/640000 (15.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=18, max=249889, num_faces=249890
      Valid probs shape: (37, 98651)
    ✓ Random_2 (pose=(-1.6408238645439832, -0.08796003527413632, -0.6933657287476014)): shape (37, 800, 800)
      Valid pixels: 104340/640000 (16.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=249719, num_faces=249890
      Valid probs shape: (37, 104340)
    ✓ Random_3 (pose=(2.8813003022996195, -1.4235577391361887, 2.067607112265579)): shape (37, 800, 800)
      Valid pixels: 89613/640000 (14.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=9, max=249889, num_faces=249890
      Valid probs shape: (37, 89613)
    ✓ Random_4 (pose=(-0.062038493350514035, -2.9527343820815677, 0.5305670550086736)): shape (37, 800, 800)
      Valid pixels: 48291/640000 (7.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1818, max=249889, num_faces=249890
      Valid probs shape: (37, 48291)
    ✓ Random_5 (pose=(-1.5213302229618404, 1.7383075938805979, -1.326031889629204)): shape (37, 800, 800)
      Valid pixels: 83315/640000 (13.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=247, max=249719, num_faces=249890
      Valid probs shape: (37, 83315)
    ✓ Random_6 (pose=(1.2074341153178834, -0.02956970676735482, 0.9545209352568325)): shape (37, 800, 800)
      Valid pixels: 75339/640000 (11.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=249766, num_faces=249890
      Valid probs shape: (37, 75339)
    ✓ Random_7 (pose=(-2.5764589516121115, 0.013918377523528758, 0.8412012165987752)): shape (37, 800, 800)
      Valid pixels: 66534/640000 (10.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5042, max=249889, num_faces=249890
      Valid probs shape: (37, 66534)
    ✓ Random_8 (pose=(2.194132648051763, 2.582785361799653, -0.10405599908847618)): shape (37, 800, 800)
      Valid pixels: 98705/640000 (15.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=249874, num_faces=249890
      Valid probs shape: (37, 98705)
    ✓ Random_9 (pose=(-0.6557807451886908, -1.5741232119157689, -0.7022409630132969)): shape (37, 800, 800)
      Valid pixels: 89391/640000 (14.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=8, max=249889, num_faces=249890
      Valid probs shape: (37, 89391)
    ✓ Random_10 (pose=(-2.7448525101818597, 1.7791461844796022, 2.7367280289640314)): shape (37, 800, 800)
      Valid pixels: 78807/640000 (12.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=249861, num_faces=249890
      Valid probs shape: (37, 78807)
    ✓ Random_11 (pose=(2.980767206036644, -1.6356498137744706, -0.5306557096677924)): shape (37, 800, 800)
      Valid pixels: 77250/640000 (12.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=249861, num_faces=249890
      Valid probs shape: (37, 77250)
    ✓ Random_12 (pose=(0.9074061957350361, -0.05818095940079626, -1.4188113745201238)): shape (37, 800, 800)
      Valid pixels: 65308/640000 (10.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=249884, num_faces=249890
      Valid probs shape: (37, 65308)
    ✓ Random_13 (pose=(-0.8090897185847612, 0.5191491289153523, -2.687812264533563)): shape (37, 800, 800)
      Valid pixels: 90186/640000 (14.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=249854, num_faces=249890
      Valid probs shape: (37, 90186)
    ✓ Random_14 (pose=(-0.16052082594199835, 2.3349919838502435, -1.4478046355980958)): shape (37, 800, 800)
      Valid pixels: 68517/640000 (10.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=221, max=249874, num_faces=249890
      Valid probs shape: (37, 68517)
    ✓ Random_15 (pose=(-1.468453122443582, 1.8195486659914826, 2.418071830796573)): shape (37, 800, 800)
      Valid pixels: 104327/640000 (16.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=249884, num_faces=249890
      Valid probs shape: (37, 104327)
    ✓ Random_16 (pose=(-0.7864744407148638, -1.3452458641914509, -0.38298113973218895)): shape (37, 800, 800)
      Valid pixels: 81300/640000 (12.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=12, max=249889, num_faces=249890
      Valid probs shape: (37, 81300)
    ✓ Random_17 (pose=(-1.0599289038189768, 1.4736828909999904, 0.883987985661979)): shape (37, 800, 800)
      Valid pixels: 83253/640000 (13.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=18, max=249889, num_faces=249890
      Valid probs shape: (37, 83253)
    ✓ Random_18 (pose=(1.6048860822006592, -0.31663006348062916, 0.21158047395816837)): shape (37, 800, 800)
      Valid pixels: 95301/640000 (14.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=22, max=249875, num_faces=249890
      Valid probs shape: (37, 95301)
    ✓ Random_19 (pose=(0.931071730180907, -1.4133099816390922, 2.887377073871064)): shape (37, 800, 800)
      Valid pixels: 101014/640000 (15.8%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=3, max=249719, num_faces=249890
      Valid probs shape: (37, 101014)
    ✓ Random_20 (pose=(-0.11804508187183282, 1.4798635526425503, 0.6417960218920848)): shape (37, 800, 800)
      Valid pixels: 102434/640000 (16.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=3, max=249719, num_faces=249890
      Valid probs shape: (37, 102434)
    ✓ Random_21 (pose=(-2.056204609214941, 1.1606055443469785, -1.8132544115082487)): shape (37, 800, 800)
      Valid pixels: 83275/640000 (13.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=51, max=249719, num_faces=249890
      Valid probs shape: (37, 83275)
    ✓ Random_22 (pose=(-1.669633421502026, 0.8356682502143018, -3.0393665010131468)): shape (37, 800, 800)
      Valid pixels: 96574/640000 (15.1%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=11, max=249875, num_faces=249890
      Valid probs shape: (37, 96574)
    ✓ Random_23 (pose=(0.4968445677386315, 1.4701028509354925, -2.626520913984189)): shape (37, 800, 800)
      Valid pixels: 74507/640000 (11.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=10, max=249888, num_faces=249890
      Valid probs shape: (37, 74507)
    ✓ Random_24 (pose=(1.3235207582251585, 0.6601734786352389, -0.6994483234121094)): shape (37, 800, 800)
      Valid pixels: 107672/640000 (16.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=249875, num_faces=249890
      Valid probs shape: (37, 107672)
    ✓ Random_25 (pose=(2.7414707529093025, 0.5536372275038821, 2.268496003052282)): shape (37, 800, 800)
      Valid pixels: 55613/640000 (8.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=25975, max=249773, num_faces=249890
      Valid probs shape: (37, 55613)
    ✓ Random_26 (pose=(0.759490899677012, -2.986437457821372, -1.4146481518177056)): shape (37, 800, 800)
      Valid pixels: 66661/640000 (10.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=19, max=249889, num_faces=249890
      Valid probs shape: (37, 66661)
    ✓ Random_27 (pose=(-2.8165680501095136, 1.5850624493172347, 0.7276599608739938)): shape (37, 800, 800)
      Valid pixels: 93124/640000 (14.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=9, max=249886, num_faces=249890
      Valid probs shape: (37, 93124)
    ✓ Random_28 (pose=(1.188906130437739, -0.23709972669309254, 1.3199224591199528)): shape (37, 800, 800)
      Valid pixels: 70723/640000 (11.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=249766, num_faces=249890
      Valid probs shape: (37, 70723)
    ✓ Random_29 (pose=(1.6883774503814886, -0.05275944792430565, 0.30613786555084177)): shape (37, 800, 800)
      Valid pixels: 90722/640000 (14.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=22, max=249875, num_faces=249890
      Valid probs shape: (37, 90722)
    P stats: min=0.0000, max=0.9997, mean=0.0248
    Non-zero vertices: 114504/124947
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 10443   998   834  3202     0  1717   920  4574  5166]
  Ground Truth Stats:
    Labels shape: (124947,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-20/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7665
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8192
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8193

  RESULTS:
  RAW:         median(top-10)=0.8904, mean(top-10)=0.8954, median(all)=0.8169, mean(all)=0.7665
  + SMOOTHING: median(top-10)=0.9125, mean(top-10)=0.9187, median(all)=0.8635, mean(all)=0.8192 [+0.0221]
  + MRF:       median(top-10)=0.9126, mean(top-10)=0.9188, median(all)=0.8636, mean(all)=0.8193 [+0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.0222

================================================================================
Subject: OASIS-TRT-20-3
================================================================================
  Step 0: Generating predictions with V2 model (30 random views)...
  Mesh: 134843 vertices, 269682 faces
  Generating 30 random views...
  Generating predictions for 30 views (continuous camera pose)...
    ✓ Random_0 (pose=(0.986389343159173, 2.5242180243817547, 0.16243172541152706)): shape (37, 800, 800)
      Valid pixels: 71094/640000 (11.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=19, max=269639, num_faces=269682
      Valid probs shape: (37, 71094)
    ✓ Random_1 (pose=(-3.041423346204759, -1.6560121588600425, 2.13598651723618)): shape (37, 800, 800)
      Valid pixels: 69559/640000 (10.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=18, max=269638, num_faces=269682
      Valid probs shape: (37, 69559)
    ✓ Random_2 (pose=(2.3502017957855816, -1.48024853574466, 2.504850967261814)): shape (37, 800, 800)
      Valid pixels: 81591/640000 (12.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=70, max=269680, num_faces=269682
      Valid probs shape: (37, 81591)
    ✓ Random_3 (pose=(0.10527287299143673, 0.12131719397740781, 0.95082071048546)): shape (37, 800, 800)
      Valid pixels: 42001/640000 (6.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=268256, num_faces=269682
      Valid probs shape: (37, 42001)
    ✓ Random_4 (pose=(1.7381994461315387, -1.1295000005627123, -2.4668084114906357)): shape (37, 800, 800)
      Valid pixels: 67639/640000 (10.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=52, max=269638, num_faces=269682
      Valid probs shape: (37, 67639)
    ✓ Random_5 (pose=(-0.20704373646220553, 1.2873430360939384, 2.1365558795180366)): shape (37, 800, 800)
      Valid pixels: 65611/640000 (10.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=27, max=269638, num_faces=269682
      Valid probs shape: (37, 65611)
    ✓ Random_6 (pose=(-0.3356772214989152, 0.45087951240693913, 2.228378925187541)): shape (37, 800, 800)
      Valid pixels: 45016/640000 (7.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=269635, num_faces=269682
      Valid probs shape: (37, 45016)
    ✓ Random_7 (pose=(-2.168186162551434, -0.859152214492108, -2.4712418959645563)): shape (37, 800, 800)
      Valid pixels: 81802/640000 (12.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=24, max=269639, num_faces=269682
      Valid probs shape: (37, 81802)
    ✓ Random_8 (pose=(-0.27483911410607487, -0.6355327740638175, -2.979252041643416)): shape (37, 800, 800)
      Valid pixels: 48028/640000 (7.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=269633, num_faces=269682
      Valid probs shape: (37, 48028)
    ✓ Random_9 (pose=(0.1303005311448433, -0.8750663181552163, 1.8251543165860244)): shape (37, 800, 800)
      Valid pixels: 66373/640000 (10.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=269639, num_faces=269682
      Valid probs shape: (37, 66373)
    ✓ Random_10 (pose=(2.889053374697732, 1.404990122022161, -2.686608900642315)): shape (37, 800, 800)
      Valid pixels: 83602/640000 (13.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=269680, num_faces=269682
      Valid probs shape: (37, 83602)
    ✓ Random_11 (pose=(-3.0503350913558163, -1.6492961889504698, -3.106934705477149)): shape (37, 800, 800)
      Valid pixels: 62225/640000 (9.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=19, max=269639, num_faces=269682
      Valid probs shape: (37, 62225)
    ✓ Random_12 (pose=(-1.4739321647249293, -1.626257490571978, -1.3563424939802478)): shape (37, 800, 800)
      Valid pixels: 70457/640000 (11.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=269680, num_faces=269682
      Valid probs shape: (37, 70457)
    ✓ Random_13 (pose=(2.262030159562541, -1.0994303936718928, 1.046202006902158)): shape (37, 800, 800)
      Valid pixels: 57723/640000 (9.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=377, max=269680, num_faces=269682
      Valid probs shape: (37, 57723)
    ✓ Random_14 (pose=(0.057742277245277585, -0.17305254082046062, -0.6232868009810137)): shape (37, 800, 800)
      Valid pixels: 41363/640000 (6.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=269612, num_faces=269682
      Valid probs shape: (37, 41363)
    ✓ Random_15 (pose=(-0.09360069363040946, 2.7334106811629786, 0.1736913653110359)): shape (37, 800, 800)
      Valid pixels: 48335/640000 (7.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=48003, max=269677, num_faces=269682
      Valid probs shape: (37, 48335)
    ✓ Random_16 (pose=(0.1718238985123488, -0.8384984673431086, -0.2865494956130936)): shape (37, 800, 800)
      Valid pixels: 48451/640000 (7.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=269639, num_faces=269682
      Valid probs shape: (37, 48451)
    ✓ Random_17 (pose=(-0.5798332790744443, 1.2776248284184444, 2.7108050798525607)): shape (37, 800, 800)
      Valid pixels: 62175/640000 (9.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=27, max=269639, num_faces=269682
      Valid probs shape: (37, 62175)
    ✓ Random_18 (pose=(1.5867179320857794, 2.542573426424825, -1.5292802489541004)): shape (37, 800, 800)
      Valid pixels: 59943/640000 (9.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=34, max=269639, num_faces=269682
      Valid probs shape: (37, 59943)
    ✓ Random_19 (pose=(-0.6897168901173427, 2.4266408725838264, -1.802430583789543)): shape (37, 800, 800)
      Valid pixels: 64518/640000 (10.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=112, max=269634, num_faces=269682
      Valid probs shape: (37, 64518)
    ✓ Random_20 (pose=(1.6918298926628452, -1.1511480727639103, 0.11159951335510998)): shape (37, 800, 800)
      Valid pixels: 84836/640000 (13.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=26, max=269639, num_faces=269682
      Valid probs shape: (37, 84836)
    ✓ Random_21 (pose=(3.045403428490732, 0.6841043283561623, 2.541011089997748)): shape (37, 800, 800)
      Valid pixels: 50256/640000 (7.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=476, max=269674, num_faces=269682
      Valid probs shape: (37, 50256)
    ✓ Random_22 (pose=(0.4028571457294108, -2.9595251881469884, 0.584897876492152)): shape (37, 800, 800)
      Valid pixels: 51361/640000 (8.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=594, max=269639, num_faces=269682
      Valid probs shape: (37, 51361)
    ✓ Random_23 (pose=(0.032433490683239974, -1.1207424264747563, -1.1485991762725931)): shape (37, 800, 800)
      Valid pixels: 67838/640000 (10.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=269638, num_faces=269682
      Valid probs shape: (37, 67838)
    ✓ Random_24 (pose=(-2.3980586879287773, 0.5116915116734133, -1.7019023139241884)): shape (37, 800, 800)
      Valid pixels: 61486/640000 (9.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=19324, max=269680, num_faces=269682
      Valid probs shape: (37, 61486)
    ✓ Random_25 (pose=(-0.9852380316526141, -1.1442664147029746, 1.375854259112823)): shape (37, 800, 800)
      Valid pixels: 70741/640000 (11.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=11, max=269639, num_faces=269682
      Valid probs shape: (37, 70741)
    ✓ Random_26 (pose=(0.17297840466563708, 0.9643711162012947, 0.6277187222682485)): shape (37, 800, 800)
      Valid pixels: 68376/640000 (10.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=269680, num_faces=269682
      Valid probs shape: (37, 68376)
    ✓ Random_27 (pose=(-1.7707630692045482, -2.7259577446930203, -0.17754541956322178)): shape (37, 800, 800)
      Valid pixels: 86714/640000 (13.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=269680, num_faces=269682
      Valid probs shape: (37, 86714)
    ✓ Random_28 (pose=(1.1030127889587567, -0.5785720814151225, -3.0907231910343564)): shape (37, 800, 800)
      Valid pixels: 82781/640000 (12.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=5, max=269592, num_faces=269682
      Valid probs shape: (37, 82781)
    ✓ Random_29 (pose=(3.013117070704607, -1.4018360018233622, 1.556359198752527)): shape (37, 800, 800)
      Valid pixels: 87154/640000 (13.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=66, max=269681, num_faces=269682
      Valid probs shape: (37, 87154)
    P stats: min=0.0000, max=1.0000, mean=0.0253
    Non-zero vertices: 126238/134843
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 8605 1699 1083 3338    0 2282  902 3806 6928]
  Ground Truth Stats:
    Labels shape: (134843,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-3/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7619
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8082
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8086

  RESULTS:
  RAW:         median(top-10)=0.9160, mean(top-10)=0.9082, median(all)=0.8306, mean(all)=0.7619
  + SMOOTHING: median(top-10)=0.9336, mean(top-10)=0.9260, median(all)=0.8604, mean(all)=0.8082 [+0.0176]
  + MRF:       median(top-10)=0.9342, mean(top-10)=0.9262, median(all)=0.8611, mean(all)=0.8086 [+0.0006]
  TOTAL IMPROVEMENT (median top-10): +0.0182

================================================================================
Subject: OASIS-TRT-20-4
================================================================================
  Step 0: Generating predictions with V2 model (30 random views)...
  Mesh: 138101 vertices, 276198 faces
  Generating 30 random views...
  Generating predictions for 30 views (continuous camera pose)...
    ✓ Random_0 (pose=(-0.30791989032335554, -2.9438798432664353, -0.6879703362335916)): shape (37, 800, 800)
      Valid pixels: 62870/640000 (9.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1375, max=276197, num_faces=276198
      Valid probs shape: (37, 62870)
    ✓ Random_1 (pose=(-1.7080242554202698, 1.0178630555541766, -2.561410020681911)): shape (37, 800, 800)
      Valid pixels: 79220/640000 (12.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8, max=276194, num_faces=276198
      Valid probs shape: (37, 79220)
    ✓ Random_2 (pose=(-0.11264172612088563, 0.04009929253455802, -0.7061704418995549)): shape (37, 800, 800)
      Valid pixels: 48336/640000 (7.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=275053, num_faces=276198
      Valid probs shape: (37, 48336)
    ✓ Random_3 (pose=(2.488986685267248, -0.4326042712909972, 3.089909663541775)): shape (37, 800, 800)
      Valid pixels: 76311/640000 (11.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1366, max=276196, num_faces=276198
      Valid probs shape: (37, 76311)
    ✓ Random_4 (pose=(0.3389349261777941, -1.833326206358136, 2.2377272791384355)): shape (37, 800, 800)
      Valid pixels: 69193/640000 (10.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=133, max=276197, num_faces=276198
      Valid probs shape: (37, 69193)
    ✓ Random_5 (pose=(-0.657992813703137, 0.02872700514519666, 1.4446135869971597)): shape (37, 800, 800)
      Valid pixels: 49549/640000 (7.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=276182, num_faces=276198
      Valid probs shape: (37, 49549)
    ✓ Random_6 (pose=(1.9966809656034332, -2.7878409017677552, -0.8228083769844172)): shape (37, 800, 800)
      Valid pixels: 93005/640000 (14.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=276188, num_faces=276198
      Valid probs shape: (37, 93005)
    ✓ Random_7 (pose=(2.2398199319181122, 0.7548361392914975, -0.8245356485128044)): shape (37, 800, 800)
      Valid pixels: 75088/640000 (11.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=395, max=276197, num_faces=276198
      Valid probs shape: (37, 75088)
    ✓ Random_8 (pose=(2.4424967325290767, -1.464529899404993, -2.025647464008805)): shape (37, 800, 800)
      Valid pixels: 85859/640000 (13.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=79, max=276197, num_faces=276198
      Valid probs shape: (37, 85859)
    ✓ Random_9 (pose=(-0.9552096006440451, 2.8639855306346726, 0.5222354412780228)): shape (37, 800, 800)
      Valid pixels: 84024/640000 (13.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=544, max=276196, num_faces=276198
      Valid probs shape: (37, 84024)
    ✓ Random_10 (pose=(-1.9992241361220544, 0.5369801179164848, 2.855670297302823)): shape (37, 800, 800)
      Valid pixels: 100644/640000 (15.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=98, max=276193, num_faces=276198
      Valid probs shape: (37, 100644)
    ✓ Random_11 (pose=(-2.0608457450688373, -1.2410093676606115, 2.4097975538321323)): shape (37, 800, 800)
      Valid pixels: 83913/640000 (13.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=73, max=276195, num_faces=276198
      Valid probs shape: (37, 83913)
    ✓ Random_12 (pose=(-2.3715777226383996, 1.131035213544009, 0.3388939536409197)): shape (37, 800, 800)
      Valid pixels: 71577/640000 (11.2%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=445, max=276197, num_faces=276198
      Valid probs shape: (37, 71577)
    ✓ Random_13 (pose=(1.8902851161117997, -1.9055226782688597, 2.6967344198105616)): shape (37, 800, 800)
      Valid pixels: 99194/640000 (15.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=4, max=276196, num_faces=276198
      Valid probs shape: (37, 99194)
    ✓ Random_14 (pose=(0.4677079084327933, -1.417629000377424, 0.9561333554976894)): shape (37, 800, 800)
      Valid pixels: 105793/640000 (16.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=276197, num_faces=276198
      Valid probs shape: (37, 105793)
    ✓ Random_15 (pose=(3.0861958007032095, 1.5262487041487205, -1.9901075386322256)): shape (37, 800, 800)
      Valid pixels: 101325/640000 (15.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=276197, num_faces=276198
      Valid probs shape: (37, 101325)
    ✓ Random_16 (pose=(1.39608035490859, -0.1803032849448134, 1.1195085875828354)): shape (37, 800, 800)
      Valid pixels: 69493/640000 (10.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=276193, num_faces=276198
      Valid probs shape: (37, 69493)
    ✓ Random_17 (pose=(2.064084027453272, 1.5944775833142666, 2.487504332489247)): shape (37, 800, 800)
      Valid pixels: 84977/640000 (13.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=275472, num_faces=276198
      Valid probs shape: (37, 84977)
    ✓ Random_18 (pose=(-1.108041509084067, -1.3557885876307127, 0.8860696682837874)): shape (37, 800, 800)
      Valid pixels: 65174/640000 (10.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=54, max=276195, num_faces=276198
      Valid probs shape: (37, 65174)
    ✓ Random_19 (pose=(-2.847002874214297, 0.08058133080637075, -2.3676649330036543)): shape (37, 800, 800)
      Valid pixels: 44496/640000 (7.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5334, max=276197, num_faces=276198
      Valid probs shape: (37, 44496)
    ✓ Random_20 (pose=(-1.3748294391699183, -1.1469883065860227, 2.096083401525439)): shape (37, 800, 800)
      Valid pixels: 96061/640000 (15.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=276194, num_faces=276198
      Valid probs shape: (37, 96061)
    ✓ Random_21 (pose=(2.270286964158938, 2.5538272003157108, -0.7901448770658441)): shape (37, 800, 800)
      Valid pixels: 66730/640000 (10.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=276187, num_faces=276198
      Valid probs shape: (37, 66730)
    ✓ Random_22 (pose=(0.5266876123248934, 2.8406064727249536, 1.1376596881451082)): shape (37, 800, 800)
      Valid pixels: 50468/640000 (7.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=30754, max=276197, num_faces=276198
      Valid probs shape: (37, 50468)
    ✓ Random_23 (pose=(-0.032439252736901736, -2.8003619352221003, -0.8901285129083845)): shape (37, 800, 800)
      Valid pixels: 57790/640000 (9.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5788, max=276197, num_faces=276198
      Valid probs shape: (37, 57790)
    ✓ Random_24 (pose=(2.8177153044664207, 0.03609360132872963, 2.3017811846322074)): shape (37, 800, 800)
      Valid pixels: 55869/640000 (8.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=62290, max=276197, num_faces=276198
      Valid probs shape: (37, 55869)
    ✓ Random_25 (pose=(-2.218443697171427, -1.9998428107434916, 1.890452944694231)): shape (37, 800, 800)
      Valid pixels: 63199/640000 (9.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=276181, num_faces=276198
      Valid probs shape: (37, 63199)
    ✓ Random_26 (pose=(1.9641275135486058, -2.224283009856149, -2.7314581632886137)): shape (37, 800, 800)
      Valid pixels: 74511/640000 (11.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=276195, num_faces=276198
      Valid probs shape: (37, 74511)
    ✓ Random_27 (pose=(-0.16875197425777033, -1.7239762956127183, -2.4044325065013767)): shape (37, 800, 800)
      Valid pixels: 89200/640000 (13.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=23, max=275901, num_faces=276198
      Valid probs shape: (37, 89200)
    ✓ Random_28 (pose=(-0.8818630796668452, -2.3830288523392835, -1.135942821899985)): shape (37, 800, 800)
      Valid pixels: 91302/640000 (14.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=3530, max=276196, num_faces=276198
      Valid probs shape: (37, 91302)
    ✓ Random_29 (pose=(0.4315229240917944, -0.08056773950761231, -2.683131700006939)): shape (37, 800, 800)
      Valid pixels: 58726/640000 (9.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=0, max=275827, num_faces=276198
      Valid probs shape: (37, 58726)
    P stats: min=0.0000, max=0.9999, mean=0.0251
    Non-zero vertices: 128497/138101
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 9604  810  890 3437    0 1911  886 4375 5863]
  Ground Truth Stats:
    Labels shape: (138101,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-4/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7732
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8243
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8246

  RESULTS:
  RAW:         median(top-10)=0.9120, mean(top-10)=0.9141, median(all)=0.8416, mean(all)=0.7732
  + SMOOTHING: median(top-10)=0.9360, mean(top-10)=0.9356, median(all)=0.8828, mean(all)=0.8243 [+0.0240]
  + MRF:       median(top-10)=0.9358, mean(top-10)=0.9357, median(all)=0.8828, mean(all)=0.8246 [-0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0238

================================================================================
Subject: OASIS-TRT-20-5
================================================================================
  Step 0: Generating predictions with V2 model (30 random views)...
  Mesh: 151342 vertices, 302680 faces
  Generating 30 random views...
  Generating predictions for 30 views (continuous camera pose)...
    ✓ Random_0 (pose=(0.7163647787232699, -1.0890691247706732, 2.8425891846745746)): shape (37, 800, 800)
      Valid pixels: 86200/640000 (13.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=302679, num_faces=302680
      Valid probs shape: (37, 86200)
    ✓ Random_1 (pose=(-1.2383717441149436, 2.1747597147061333, 0.2913470280106689)): shape (37, 800, 800)
      Valid pixels: 98571/640000 (15.4%)
      Probs stats: min=0.0000, max=0.9995, mean=0.0270
      Face IDs: min=348, max=302679, num_faces=302680
      Valid probs shape: (37, 98571)
    ✓ Random_2 (pose=(-0.5659784783720965, -0.3950183089949064, -1.0507810271214217)): shape (37, 800, 800)
      Valid pixels: 81086/640000 (12.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=5, max=302511, num_faces=302680
      Valid probs shape: (37, 81086)
    ✓ Random_3 (pose=(-2.0593506625013935, 2.1053388088772023, -1.6413477324144712)): shape (37, 800, 800)
      Valid pixels: 81924/640000 (12.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=302679, num_faces=302680
      Valid probs shape: (37, 81924)
    ✓ Random_4 (pose=(2.5058400670527936, 0.3986556146764624, 0.6926819950632273)): shape (37, 800, 800)
      Valid pixels: 75955/640000 (11.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=302672, num_faces=302680
      Valid probs shape: (37, 75955)
    ✓ Random_5 (pose=(0.8772859170712026, 2.143681105293738, -2.554219872136941)): shape (37, 800, 800)
      Valid pixels: 75555/640000 (11.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=318, max=302678, num_faces=302680
      Valid probs shape: (37, 75555)
    ✓ Random_6 (pose=(-0.23067789944348283, 2.833638113521383, 2.389402319021112)): shape (37, 800, 800)
      Valid pixels: 58424/640000 (9.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4356, max=302674, num_faces=302680
      Valid probs shape: (37, 58424)
    ✓ Random_7 (pose=(0.26505937718018346, 0.9917337195088844, 2.2126006231481608)): shape (37, 800, 800)
      Valid pixels: 80614/640000 (12.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=4, max=302665, num_faces=302680
      Valid probs shape: (37, 80614)
    ✓ Random_8 (pose=(-1.4746948110297684, -1.7384579667657654, -1.1145253104030513)): shape (37, 800, 800)
      Valid pixels: 91180/640000 (14.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=302679, num_faces=302680
      Valid probs shape: (37, 91180)
    ✓ Random_9 (pose=(2.568331902742494, -0.002127387251643409, -2.118144020206196)): shape (37, 800, 800)
      Valid pixels: 69421/640000 (10.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5875, max=302677, num_faces=302680
      Valid probs shape: (37, 69421)
    ✓ Random_10 (pose=(-2.969948407384905, -1.1974991461448083, -1.6890898713960374)): shape (37, 800, 800)
      Valid pixels: 100137/640000 (15.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=302670, num_faces=302680
      Valid probs shape: (37, 100137)
    ✓ Random_11 (pose=(-0.9301873838625769, -2.609157256306388, 3.101694144699267)): shape (37, 800, 800)
      Valid pixels: 86526/640000 (13.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6, max=302671, num_faces=302680
      Valid probs shape: (37, 86526)
    ✓ Random_12 (pose=(-1.4539533988128812, -0.3274789205418198, -0.907052241617663)): shape (37, 800, 800)
      Valid pixels: 97508/640000 (15.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=302679, num_faces=302680
      Valid probs shape: (37, 97508)
    ✓ Random_13 (pose=(-2.1656811319472187, -1.63690850877507, 1.1798622543302617)): shape (37, 800, 800)
      Valid pixels: 83264/640000 (13.0%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=11, max=302679, num_faces=302680
      Valid probs shape: (37, 83264)
    ✓ Random_14 (pose=(0.6736980763272862, -1.1192063153796332, -3.0157472888638845)): shape (37, 800, 800)
      Valid pixels: 98877/640000 (15.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=302679, num_faces=302680
      Valid probs shape: (37, 98877)
    ✓ Random_15 (pose=(0.9834104592973141, -1.5453388659640108, -1.6416691445967138)): shape (37, 800, 800)
      Valid pixels: 77653/640000 (12.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=47, max=302679, num_faces=302680
      Valid probs shape: (37, 77653)
    ✓ Random_16 (pose=(1.843535151245339, -1.4157664619349155, 2.0364747740869458)): shape (37, 800, 800)
      Valid pixels: 98151/640000 (15.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=6, max=302679, num_faces=302680
      Valid probs shape: (37, 98151)
    ✓ Random_17 (pose=(2.2332864856701855, 2.034152427731682, 2.8995142705522525)): shape (37, 800, 800)
      Valid pixels: 96961/640000 (15.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=3, max=302679, num_faces=302680
      Valid probs shape: (37, 96961)
    ✓ Random_18 (pose=(-0.2237368354984164, -3.1199670545657137, 2.3872785797274085)): shape (37, 800, 800)
      Valid pixels: 51777/640000 (8.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5857, max=302674, num_faces=302680
      Valid probs shape: (37, 51777)
    ✓ Random_19 (pose=(-2.4074599204940506, 2.6987251935708247, -3.024922137732068)): shape (37, 800, 800)
      Valid pixels: 78034/640000 (12.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=302618, num_faces=302680
      Valid probs shape: (37, 78034)
    ✓ Random_20 (pose=(-1.7861554801595019, -2.4939544782794236, -2.4466498458697883)): shape (37, 800, 800)
      Valid pixels: 89943/640000 (14.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=302623, num_faces=302680
      Valid probs shape: (37, 89943)
    ✓ Random_21 (pose=(-1.1203162232110486, 0.07818101304304781, -2.828148147487609)): shape (37, 800, 800)
      Valid pixels: 92935/640000 (14.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=302626, num_faces=302680
      Valid probs shape: (37, 92935)
    ✓ Random_22 (pose=(1.9491977888156038, 2.1745896253717687, 2.0828417518448354)): shape (37, 800, 800)
      Valid pixels: 73933/640000 (11.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=302524, num_faces=302680
      Valid probs shape: (37, 73933)
    ✓ Random_23 (pose=(-0.12577817557490745, 1.4664227841036164, -0.47365067359703694)): shape (37, 800, 800)
      Valid pixels: 73396/640000 (11.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=302623, num_faces=302680
      Valid probs shape: (37, 73396)
    ✓ Random_24 (pose=(1.6738352105863905, 1.1385334255052815, -0.9240210761346339)): shape (37, 800, 800)
      Valid pixels: 93862/640000 (14.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=302668, num_faces=302680
      Valid probs shape: (37, 93862)
    ✓ Random_25 (pose=(0.857564852498224, 1.8523402585422373, -1.2300113689844039)): shape (37, 800, 800)
      Valid pixels: 108890/640000 (17.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=302670, num_faces=302680
      Valid probs shape: (37, 108890)
    ✓ Random_26 (pose=(3.071484257984066, -2.7965663873503224, -0.40220656693938306)): shape (37, 800, 800)
      Valid pixels: 59097/640000 (9.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=302610, num_faces=302680
      Valid probs shape: (37, 59097)
    ✓ Random_27 (pose=(2.3387494233522785, 2.4828396165262676, 0.1356698428518266)): shape (37, 800, 800)
      Valid pixels: 92303/640000 (14.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=302623, num_faces=302680
      Valid probs shape: (37, 92303)
    ✓ Random_28 (pose=(0.0035500144671991585, 1.6305390094071575, -0.12875311501539644)): shape (37, 800, 800)
      Valid pixels: 68265/640000 (10.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=302623, num_faces=302680
      Valid probs shape: (37, 68265)
    ✓ Random_29 (pose=(-2.6896328909745657, 0.0672583256260153, 1.9674341694149442)): shape (37, 800, 800)
      Valid pixels: 61766/640000 (9.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3349, max=302672, num_faces=302680
      Valid probs shape: (37, 61766)
    P stats: min=0.0000, max=0.9999, mean=0.0254
    Non-zero vertices: 142399/151342
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 8943  964  924 3658    0 2598 1223 6568 7084]
  Ground Truth Stats:
    Labels shape: (151342,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-5/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
    MRF iteration 5/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7445
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7907
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7910

  RESULTS:
  RAW:         median(top-10)=0.8978, mean(top-10)=0.9043, median(all)=0.8147, mean(all)=0.7445
  + SMOOTHING: median(top-10)=0.9283, mean(top-10)=0.9288, median(all)=0.8575, mean(all)=0.7907 [+0.0304]
  + MRF:       median(top-10)=0.9285, mean(top-10)=0.9291, median(all)=0.8576, mean(all)=0.7910 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0306

================================================================================
Subject: OASIS-TRT-20-6
================================================================================
  Step 0: Generating predictions with V2 model (30 random views)...
  Mesh: 152023 vertices, 304042 faces
  Generating 30 random views...
  Generating predictions for 30 views (continuous camera pose)...
    ✓ Random_0 (pose=(-2.64387423697537, -0.2735454351685971, 0.32735670280658047)): shape (37, 800, 800)
      Valid pixels: 64981/640000 (10.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=35310, max=304041, num_faces=304042
      Valid probs shape: (37, 64981)
    ✓ Random_1 (pose=(1.273642602101332, -1.4449678044889231, 2.783298117966729)): shape (37, 800, 800)
      Valid pixels: 92040/640000 (14.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=2, max=304041, num_faces=304042
      Valid probs shape: (37, 92040)
    ✓ Random_2 (pose=(0.03513785548176962, -1.5188602465341858, -1.9340736376524854)): shape (37, 800, 800)
      Valid pixels: 92932/640000 (14.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=303988, num_faces=304042
      Valid probs shape: (37, 92932)
    ✓ Random_3 (pose=(2.6897971197785955, 0.5962723646372643, -0.35664101283823424)): shape (37, 800, 800)
      Valid pixels: 61884/640000 (9.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1298, max=304040, num_faces=304042
      Valid probs shape: (37, 61884)
    ✓ Random_4 (pose=(2.3929750982849853, 2.6408979485421717, -0.4437556737172019)): shape (37, 800, 800)
      Valid pixels: 68460/640000 (10.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=304040, num_faces=304042
      Valid probs shape: (37, 68460)
    ✓ Random_5 (pose=(-2.3570852338182293, 0.21769792608465588, 3.0946379626591023)): shape (37, 800, 800)
      Valid pixels: 69856/640000 (10.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=49, max=304040, num_faces=304042
      Valid probs shape: (37, 69856)
    ✓ Random_6 (pose=(1.564745464972221, 3.1057639005823443, -1.894800192321229)): shape (37, 800, 800)
      Valid pixels: 63795/640000 (10.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=117, max=303949, num_faces=304042
      Valid probs shape: (37, 63795)
    ✓ Random_7 (pose=(0.28194697114682343, -2.5395995535770144, 2.710286130710439)): shape (37, 800, 800)
      Valid pixels: 48683/640000 (7.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=34327, max=304041, num_faces=304042
      Valid probs shape: (37, 48683)
    ✓ Random_8 (pose=(1.0810155891642665, 2.847078012509863, -3.126480114806039)): shape (37, 800, 800)
      Valid pixels: 78477/640000 (12.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=569, max=304041, num_faces=304042
      Valid probs shape: (37, 78477)
    ✓ Random_9 (pose=(1.8326184366810967, -0.7885303291056514, -2.6008135750923858)): shape (37, 800, 800)
      Valid pixels: 70827/640000 (11.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=92, max=304040, num_faces=304042
      Valid probs shape: (37, 70827)
    ✓ Random_10 (pose=(1.2251690028582427, 0.2788105595541137, 2.613545074109931)): shape (37, 800, 800)
      Valid pixels: 90620/640000 (14.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=303988, num_faces=304042
      Valid probs shape: (37, 90620)
    ✓ Random_11 (pose=(-0.5203734879163777, -0.4930609308544449, 1.7712805252145118)): shape (37, 800, 800)
      Valid pixels: 64369/640000 (10.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=304027, num_faces=304042
      Valid probs shape: (37, 64369)
    ✓ Random_12 (pose=(-1.2512132901403352, 0.16427409453607433, 0.45517585041634234)): shape (37, 800, 800)
      Valid pixels: 73903/640000 (11.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=303988, num_faces=304042
      Valid probs shape: (37, 73903)
    ✓ Random_13 (pose=(-1.0096331231678373, -0.8370256956901958, 1.238524688900542)): shape (37, 800, 800)
      Valid pixels: 60614/640000 (9.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=304010, num_faces=304042
      Valid probs shape: (37, 60614)
    ✓ Random_14 (pose=(1.4155765176125366, 3.106030438544808, -1.624783936274969)): shape (37, 800, 800)
      Valid pixels: 63929/640000 (10.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=384, max=303948, num_faces=304042
      Valid probs shape: (37, 63929)
    ✓ Random_15 (pose=(2.3888340549375, -0.4643407801646213, 1.7192323687208901)): shape (37, 800, 800)
      Valid pixels: 71140/640000 (11.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=9369, max=304041, num_faces=304042
      Valid probs shape: (37, 71140)
    ✓ Random_16 (pose=(-2.2407991233878226, -1.7757129021451628, -2.6547383715880404)): shape (37, 800, 800)
      Valid pixels: 95801/640000 (15.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=304029, num_faces=304042
      Valid probs shape: (37, 95801)
    ✓ Random_17 (pose=(0.2297827121896021, 2.3275030365327387, 1.9805652427212417)): shape (37, 800, 800)
      Valid pixels: 73250/640000 (11.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3076, max=304041, num_faces=304042
      Valid probs shape: (37, 73250)
    ✓ Random_18 (pose=(-2.0970169246367023, -0.40758456460424153, -1.9149133652333574)): shape (37, 800, 800)
      Valid pixels: 62794/640000 (9.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=304040, num_faces=304042
      Valid probs shape: (37, 62794)
    ✓ Random_19 (pose=(-1.739058315026933, 2.2830164901700636, -0.33030587746980045)): shape (37, 800, 800)
      Valid pixels: 91153/640000 (14.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=303988, num_faces=304042
      Valid probs shape: (37, 91153)
    ✓ Random_20 (pose=(-1.1105737989059152, 0.6670242468728649, 2.153431726094552)): shape (37, 800, 800)
      Valid pixels: 67855/640000 (10.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=304029, num_faces=304042
      Valid probs shape: (37, 67855)
    ✓ Random_21 (pose=(1.9278996809285838, -1.92149418418112, -1.8987289894993158)): shape (37, 800, 800)
      Valid pixels: 63139/640000 (9.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=18, max=303947, num_faces=304042
      Valid probs shape: (37, 63139)
    ✓ Random_22 (pose=(0.7442587175378841, -0.23396360387863835, 0.4629392774583585)): shape (37, 800, 800)
      Valid pixels: 66442/640000 (10.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=304029, num_faces=304042
      Valid probs shape: (37, 66442)
    ✓ Random_23 (pose=(-2.790611492732458, -1.8483267164019468, -3.0833686490913497)): shape (37, 800, 800)
      Valid pixels: 75703/640000 (11.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6, max=304029, num_faces=304042
      Valid probs shape: (37, 75703)
    ✓ Random_24 (pose=(-2.0487388078665223, -3.06826592696823, 1.435360731713219)): shape (37, 800, 800)
      Valid pixels: 56694/640000 (8.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8, max=304020, num_faces=304042
      Valid probs shape: (37, 56694)
    ✓ Random_25 (pose=(-0.6080797421725239, -0.18463815228996827, -2.8684793533564394)): shape (37, 800, 800)
      Valid pixels: 58559/640000 (9.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=304029, num_faces=304042
      Valid probs shape: (37, 58559)
    ✓ Random_26 (pose=(-0.3149611214185475, 0.35491142084298666, -0.6801298843460262)): shape (37, 800, 800)
      Valid pixels: 48799/640000 (7.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=301994, num_faces=304042
      Valid probs shape: (37, 48799)
    ✓ Random_27 (pose=(-1.0043769952970258, -0.982356913729169, 1.2169258559260445)): shape (37, 800, 800)
      Valid pixels: 62583/640000 (9.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=304027, num_faces=304042
      Valid probs shape: (37, 62583)
    ✓ Random_28 (pose=(-1.3893029160379686, 0.4484114955246321, -2.761670695631258)): shape (37, 800, 800)
      Valid pixels: 84579/640000 (13.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=304039, num_faces=304042
      Valid probs shape: (37, 84579)
    ✓ Random_29 (pose=(2.3360864618736423, -1.3977884454429654, -2.0469898681310834)): shape (37, 800, 800)
      Valid pixels: 73340/640000 (11.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=53, max=304039, num_faces=304042
      Valid probs shape: (37, 73340)
    P stats: min=0.0000, max=1.0000, mean=0.0253
    Non-zero vertices: 142069/152023
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 9954 1248 1309 4424    0 1999 1259 4846 6289]
  Ground Truth Stats:
    Labels shape: (152023,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-6/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7865
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8420
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8426

  RESULTS:
  RAW:         median(top-10)=0.8952, mean(top-10)=0.9010, median(all)=0.8296, mean(all)=0.7865
  + SMOOTHING: median(top-10)=0.9241, mean(top-10)=0.9262, median(all)=0.8845, mean(all)=0.8420 [+0.0289]
  + MRF:       median(top-10)=0.9245, mean(top-10)=0.9265, median(all)=0.8851, mean(all)=0.8426 [+0.0005]
  TOTAL IMPROVEMENT (median top-10): +0.0293

================================================================================
Subject: OASIS-TRT-20-7
================================================================================
  Step 0: Generating predictions with V2 model (30 random views)...
  Mesh: 142612 vertices, 285220 faces
  Generating 30 random views...
  Generating predictions for 30 views (continuous camera pose)...
    ✓ Random_0 (pose=(-0.12494769801286809, -2.808974731486833, 0.7301842310450004)): shape (37, 800, 800)
      Valid pixels: 57736/640000 (9.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2055, max=285218, num_faces=285220
      Valid probs shape: (37, 57736)
    ✓ Random_1 (pose=(2.651807096990411, 3.015375412131177, -2.8789400666546503)): shape (37, 800, 800)
      Valid pixels: 71349/640000 (11.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=0, max=285109, num_faces=285220
      Valid probs shape: (37, 71349)
    ✓ Random_2 (pose=(-2.561486300122369, 3.0957951315857395, -2.11853534965869)): shape (37, 800, 800)
      Valid pixels: 61077/640000 (9.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=284771, num_faces=285220
      Valid probs shape: (37, 61077)
    ✓ Random_3 (pose=(0.5808115473858018, 0.268997434816062, 1.2956775252799222)): shape (37, 800, 800)
      Valid pixels: 66690/640000 (10.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=285109, num_faces=285220
      Valid probs shape: (37, 66690)
    ✓ Random_4 (pose=(-2.5947098107228195, 1.7568672197249375, 1.6896875851725426)): shape (37, 800, 800)
      Valid pixels: 109293/640000 (17.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=285018, num_faces=285220
      Valid probs shape: (37, 109293)
    ✓ Random_5 (pose=(0.00021589202075400493, -0.5724101147929956, 1.4831552352054844)): shape (37, 800, 800)
      Valid pixels: 69338/640000 (10.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=284955, num_faces=285220
      Valid probs shape: (37, 69338)
    ✓ Random_6 (pose=(2.334327883902713, 1.0493688922450932, -3.0873278052515545)): shape (37, 800, 800)
      Valid pixels: 100442/640000 (15.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=182, max=285219, num_faces=285220
      Valid probs shape: (37, 100442)
    ✓ Random_7 (pose=(-0.8025019380368432, 1.2508075789246176, 0.1272777565874148)): shape (37, 800, 800)
      Valid pixels: 105670/640000 (16.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=285214, num_faces=285220
      Valid probs shape: (37, 105670)
    ✓ Random_8 (pose=(1.5450499710743086, 3.0389937488917225, -0.41505985722110195)): shape (37, 800, 800)
      Valid pixels: 112530/640000 (17.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=12, max=285015, num_faces=285220
      Valid probs shape: (37, 112530)
    ✓ Random_9 (pose=(-1.5267186433487674, -2.0137063776045103, -1.2363577181980066)): shape (37, 800, 800)
      Valid pixels: 88199/640000 (13.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=183, max=285217, num_faces=285220
      Valid probs shape: (37, 88199)
    ✓ Random_10 (pose=(-0.3988163049797602, -2.115986790957818, -2.904525883078194)): shape (37, 800, 800)
      Valid pixels: 63334/640000 (9.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2981, max=285218, num_faces=285220
      Valid probs shape: (37, 63334)
    ✓ Random_11 (pose=(-3.0553406700705783, 0.32280535453945314, -1.769811643877442)): shape (37, 800, 800)
      Valid pixels: 62373/640000 (9.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=23192, max=285219, num_faces=285220
      Valid probs shape: (37, 62373)
    ✓ Random_12 (pose=(-1.5094245078846162, 0.2370896883337381, 2.782493518391499)): shape (37, 800, 800)
      Valid pixels: 111838/640000 (17.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=13, max=284964, num_faces=285220
      Valid probs shape: (37, 111838)
    ✓ Random_13 (pose=(2.134033674316705, -1.9909411645145598, 2.7738541163318464)): shape (37, 800, 800)
      Valid pixels: 95645/640000 (14.9%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=16, max=285214, num_faces=285220
      Valid probs shape: (37, 95645)
    ✓ Random_14 (pose=(-1.7816140129102451, 0.8024548769845112, 1.0305026084763291)): shape (37, 800, 800)
      Valid pixels: 74439/640000 (11.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=118, max=285162, num_faces=285220
      Valid probs shape: (37, 74439)
    ✓ Random_15 (pose=(1.455703381734935, -1.466303103199933, 2.3466511242443167)): shape (37, 800, 800)
      Valid pixels: 100239/640000 (15.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=285217, num_faces=285220
      Valid probs shape: (37, 100239)
    ✓ Random_16 (pose=(-0.9162249552126132, 0.09289034531190987, 0.2627396018867212)): shape (37, 800, 800)
      Valid pixels: 84462/640000 (13.2%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=1, max=285161, num_faces=285220
      Valid probs shape: (37, 84462)
    ✓ Random_17 (pose=(-2.6444233546613374, -0.22716223184438, -1.9657506176734425)): shape (37, 800, 800)
      Valid pixels: 57245/640000 (8.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=77, max=285219, num_faces=285220
      Valid probs shape: (37, 57245)
    ✓ Random_18 (pose=(2.584200701891442, 2.4012968486995305, -1.5203594622273544)): shape (37, 800, 800)
      Valid pixels: 66782/640000 (10.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=284636, num_faces=285220
      Valid probs shape: (37, 66782)
    ✓ Random_19 (pose=(3.128230587719748, 0.15353047701749833, 3.0017474064367713)): shape (37, 800, 800)
      Valid pixels: 43974/640000 (6.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=14446, max=285219, num_faces=285220
      Valid probs shape: (37, 43974)
    ✓ Random_20 (pose=(0.9045853050048169, 0.9651046607180671, 0.14563369984295615)): shape (37, 800, 800)
      Valid pixels: 80379/640000 (12.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=284963, num_faces=285220
      Valid probs shape: (37, 80379)
    ✓ Random_21 (pose=(-2.6634931923047804, 2.887642577290314, 0.7554753503723353)): shape (37, 800, 800)
      Valid pixels: 53497/640000 (8.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=284775, num_faces=285220
      Valid probs shape: (37, 53497)
    ✓ Random_22 (pose=(-0.06384512461090708, -0.44223023510284687, 0.8561610782200733)): shape (37, 800, 800)
      Valid pixels: 56619/640000 (8.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=285162, num_faces=285220
      Valid probs shape: (37, 56619)
    ✓ Random_23 (pose=(-0.3150714682395952, 0.9162453788355842, 1.7278567370505868)): shape (37, 800, 800)
      Valid pixels: 74687/640000 (11.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=284384, num_faces=285220
      Valid probs shape: (37, 74687)
    ✓ Random_24 (pose=(-2.7998209719275744, 2.6666443133116893, 1.807835561064131)): shape (37, 800, 800)
      Valid pixels: 67898/640000 (10.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=285005, num_faces=285220
      Valid probs shape: (37, 67898)
    ✓ Random_25 (pose=(-2.6030261227645206, 2.1959932946879697, 2.7134549291237313)): shape (37, 800, 800)
      Valid pixels: 81649/640000 (12.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=284962, num_faces=285220
      Valid probs shape: (37, 81649)
    ✓ Random_26 (pose=(0.2113352155512449, 0.1600780525858001, 1.9985851332645348)): shape (37, 800, 800)
      Valid pixels: 60982/640000 (9.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=0, max=283734, num_faces=285220
      Valid probs shape: (37, 60982)
    ✓ Random_27 (pose=(2.2194477717322307, -1.7487433729327946, -1.687033148452751)): shape (37, 800, 800)
      Valid pixels: 95268/640000 (14.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=285166, num_faces=285220
      Valid probs shape: (37, 95268)
    ✓ Random_28 (pose=(2.700849070138098, -0.7224224953878999, -0.9906420376271403)): shape (37, 800, 800)
      Valid pixels: 90608/640000 (14.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=75, max=285214, num_faces=285220
      Valid probs shape: (37, 90608)
    ✓ Random_29 (pose=(-1.685997953434797, -3.112520772301468, 0.6430173794660292)): shape (37, 800, 800)
      Valid pixels: 82131/640000 (12.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=285162, num_faces=285220
      Valid probs shape: (37, 82131)
    P stats: min=0.0000, max=0.9999, mean=0.0258
    Non-zero vertices: 136041/142612
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 6571 1096 1055 3840    0 2267 1037 5555 7727]
  Ground Truth Stats:
    Labels shape: (142612,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-7/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7706
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8128
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8130

  RESULTS:
  RAW:         median(top-10)=0.9076, mean(top-10)=0.9121, median(all)=0.8426, mean(all)=0.7706
  + SMOOTHING: median(top-10)=0.9215, mean(top-10)=0.9284, median(all)=0.8781, mean(all)=0.8128 [+0.0139]
  + MRF:       median(top-10)=0.9219, mean(top-10)=0.9287, median(all)=0.8781, mean(all)=0.8130 [+0.0004]
  TOTAL IMPROVEMENT (median top-10): +0.0143

================================================================================
Subject: OASIS-TRT-20-8
================================================================================
  Step 0: Generating predictions with V2 model (30 random views)...
  Mesh: 139571 vertices, 279138 faces
  Generating 30 random views...
  Generating predictions for 30 views (continuous camera pose)...
    ✓ Random_0 (pose=(2.2692006115901258, -2.323173235256604, -3.1227242601328062)): shape (37, 800, 800)
      Valid pixels: 82071/640000 (12.8%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=6, max=279072, num_faces=279138
      Valid probs shape: (37, 82071)
    ✓ Random_1 (pose=(2.3620109661860083, -2.500326231021513, -1.3823897953429234)): shape (37, 800, 800)
      Valid pixels: 91003/640000 (14.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=279069, num_faces=279138
      Valid probs shape: (37, 91003)
    ✓ Random_2 (pose=(2.249654864063806, -0.03680453436932085, 0.5756043903823724)): shape (37, 800, 800)
      Valid pixels: 78707/640000 (12.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=94, max=279137, num_faces=279138
      Valid probs shape: (37, 78707)
    ✓ Random_3 (pose=(1.4866174143960214, -0.37654762022935007, -1.1222578028752133)): shape (37, 800, 800)
      Valid pixels: 91006/640000 (14.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=49, max=279072, num_faces=279138
      Valid probs shape: (37, 91006)
    ✓ Random_4 (pose=(-2.0910499714280006, 1.558359320807524, -0.6239660392986672)): shape (37, 800, 800)
      Valid pixels: 111953/640000 (17.5%)
      Probs stats: min=0.0000, max=0.9995, mean=0.0270
      Face IDs: min=11, max=279137, num_faces=279138
      Valid probs shape: (37, 111953)
    ✓ Random_5 (pose=(-1.1386754886066348, -1.2950251042236662, -2.7046235000350203)): shape (37, 800, 800)
      Valid pixels: 87620/640000 (13.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=279067, num_faces=279138
      Valid probs shape: (37, 87620)
    ✓ Random_6 (pose=(2.671646138947648, -0.8504921391399485, -2.086501280080988)): shape (37, 800, 800)
      Valid pixels: 83587/640000 (13.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=92, max=279072, num_faces=279138
      Valid probs shape: (37, 83587)
    ✓ Random_7 (pose=(2.2375343128635476, 1.565141701098983, 2.644758831858625)): shape (37, 800, 800)
      Valid pixels: 90435/640000 (14.1%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=3, max=279137, num_faces=279138
      Valid probs shape: (37, 90435)
    ✓ Random_8 (pose=(1.3116634779063574, 0.9616467188553228, 0.7194649091918217)): shape (37, 800, 800)
      Valid pixels: 84909/640000 (13.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=3, max=279067, num_faces=279138
      Valid probs shape: (37, 84909)
    ✓ Random_9 (pose=(1.4222015923773093, -1.8288716259944255, -2.67973053675257)): shape (37, 800, 800)
      Valid pixels: 100188/640000 (15.7%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=2, max=279134, num_faces=279138
      Valid probs shape: (37, 100188)
    ✓ Random_10 (pose=(0.10708132370334722, 2.683520045473143, 1.591020302934651)): shape (37, 800, 800)
      Valid pixels: 83649/640000 (13.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=25339, max=279137, num_faces=279138
      Valid probs shape: (37, 83649)
    ✓ Random_11 (pose=(0.8405047510232904, 0.5920808023650057, -2.6822475057447557)): shape (37, 800, 800)
      Valid pixels: 70597/640000 (11.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=0, max=279070, num_faces=279138
      Valid probs shape: (37, 70597)
    ✓ Random_12 (pose=(2.171618204715661, -1.722514604531323, -3.0976203543804477)): shape (37, 800, 800)
      Valid pixels: 87842/640000 (13.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=279130, num_faces=279138
      Valid probs shape: (37, 87842)
    ✓ Random_13 (pose=(3.0850308465294143, -1.1201433478705152, -2.975064967816588)): shape (37, 800, 800)
      Valid pixels: 74227/640000 (11.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=951, max=279072, num_faces=279138
      Valid probs shape: (37, 74227)
    ✓ Random_14 (pose=(-0.4095572227808102, 1.2829509697048422, 0.0581252096473599)): shape (37, 800, 800)
      Valid pixels: 92319/640000 (14.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=279137, num_faces=279138
      Valid probs shape: (37, 92319)
    ✓ Random_15 (pose=(2.3550513049883284, -1.019801355736845, -1.5752701167236738)): shape (37, 800, 800)
      Valid pixels: 102164/640000 (16.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=394, max=279069, num_faces=279138
      Valid probs shape: (37, 102164)
    ✓ Random_16 (pose=(2.3688314058997477, 1.739048399688052, -1.142328662356339)): shape (37, 800, 800)
      Valid pixels: 75958/640000 (11.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=96, max=279072, num_faces=279138
      Valid probs shape: (37, 75958)
    ✓ Random_17 (pose=(2.321928362967282, -1.8219346230047013, -0.10539911389056744)): shape (37, 800, 800)
      Valid pixels: 96740/640000 (15.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=279070, num_faces=279138
      Valid probs shape: (37, 96740)
    ✓ Random_18 (pose=(2.195015722368624, 0.9497676875477561, -2.779785265921065)): shape (37, 800, 800)
      Valid pixels: 111428/640000 (17.4%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=129, max=279137, num_faces=279138
      Valid probs shape: (37, 111428)
    ✓ Random_19 (pose=(-2.2705203862486463, 2.8941703737942293, -0.41073602848423985)): shape (37, 800, 800)
      Valid pixels: 94419/640000 (14.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=279128, num_faces=279138
      Valid probs shape: (37, 94419)
    ✓ Random_20 (pose=(2.2380541270635446, -1.539742524778931, -3.038142576010198)): shape (37, 800, 800)
      Valid pixels: 86536/640000 (13.5%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=142, max=279072, num_faces=279138
      Valid probs shape: (37, 86536)
    ✓ Random_21 (pose=(-1.6076295210636318, -2.18502029778834, -2.796157188841823)): shape (37, 800, 800)
      Valid pixels: 110622/640000 (17.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=279070, num_faces=279138
      Valid probs shape: (37, 110622)
    ✓ Random_22 (pose=(2.066752743550495, -0.19722577522744178, 1.020191598750909)): shape (37, 800, 800)
      Valid pixels: 71885/640000 (11.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=94, max=279136, num_faces=279138
      Valid probs shape: (37, 71885)
    ✓ Random_23 (pose=(1.7905852878703303, -0.24892488606856977, -2.7541781305293105)): shape (37, 800, 800)
      Valid pixels: 97041/640000 (15.2%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=135, max=279130, num_faces=279138
      Valid probs shape: (37, 97041)
    ✓ Random_24 (pose=(-2.597394476962175, 0.3561592193410248, 2.8127075160421438)): shape (37, 800, 800)
      Valid pixels: 73258/640000 (11.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=395, max=279137, num_faces=279138
      Valid probs shape: (37, 73258)
    ✓ Random_25 (pose=(1.0905780425294296, 0.6212649419495344, -0.8308717840317112)): shape (37, 800, 800)
      Valid pixels: 108609/640000 (17.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=279070, num_faces=279138
      Valid probs shape: (37, 108609)
    ✓ Random_26 (pose=(-2.518028774664761, -2.300050804480061, -0.9789185374904616)): shape (37, 800, 800)
      Valid pixels: 71095/640000 (11.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=278923, num_faces=279138
      Valid probs shape: (37, 71095)
    ✓ Random_27 (pose=(0.6047373254649488, 0.45491893373935, 2.0922702439730596)): shape (37, 800, 800)
      Valid pixels: 86686/640000 (13.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=279125, num_faces=279138
      Valid probs shape: (37, 86686)
    ✓ Random_28 (pose=(1.8589815670762606, 1.3230488220657755, -2.512352458870826)): shape (37, 800, 800)
      Valid pixels: 99014/640000 (15.5%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=0, max=279137, num_faces=279138
      Valid probs shape: (37, 99014)
    ✓ Random_29 (pose=(-0.08704249768264427, -2.96004761536928, 0.44632330427171674)): shape (37, 800, 800)
      Valid pixels: 57534/640000 (9.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6600, max=279137, num_faces=279138
      Valid probs shape: (37, 57534)
    P stats: min=0.0000, max=0.9999, mean=0.0250
    Non-zero vertices: 129039/139571
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 10532   981  1227  3268     0  2002   970  5594  5794]
  Ground Truth Stats:
    Labels shape: (139571,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-8/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7833
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8356
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8361

  RESULTS:
  RAW:         median(top-10)=0.8902, mean(top-10)=0.8983, median(all)=0.8382, mean(all)=0.7833
  + SMOOTHING: median(top-10)=0.9293, mean(top-10)=0.9273, median(all)=0.8797, mean(all)=0.8356 [+0.0390]
  + MRF:       median(top-10)=0.9297, mean(top-10)=0.9278, median(all)=0.8806, mean(all)=0.8361 [+0.0005]
  TOTAL IMPROVEMENT (median top-10): +0.0395

================================================================================
Subject: OASIS-TRT-20-9
================================================================================
  Step 0: Generating predictions with V2 model (30 random views)...
  Mesh: 134960 vertices, 269916 faces
  Generating 30 random views...
  Generating predictions for 30 views (continuous camera pose)...
    ✓ Random_0 (pose=(2.5469255739552947, 3.045476264587098, -2.851642774227801)): shape (37, 800, 800)
      Valid pixels: 56755/640000 (8.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=268413, num_faces=269916
      Valid probs shape: (37, 56755)
    ✓ Random_1 (pose=(-0.5709501475543011, 1.6363529280100497, -2.7488526166450113)): shape (37, 800, 800)
      Valid pixels: 95225/640000 (14.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=269911, num_faces=269916
      Valid probs shape: (37, 95225)
    ✓ Random_2 (pose=(2.2542086084547037, -0.2036517667323845, 0.2481060988323227)): shape (37, 800, 800)
      Valid pixels: 67450/640000 (10.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=230, max=269911, num_faces=269916
      Valid probs shape: (37, 67450)
    ✓ Random_3 (pose=(-0.14526248247295648, -2.125706253411801, -1.50007323664066)): shape (37, 800, 800)
      Valid pixels: 84420/640000 (13.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=561, max=269913, num_faces=269916
      Valid probs shape: (37, 84420)
    ✓ Random_4 (pose=(-1.498962461462612, 0.8018212953425472, -0.07043146821800628)): shape (37, 800, 800)
      Valid pixels: 88072/640000 (13.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=10, max=269910, num_faces=269916
      Valid probs shape: (37, 88072)
    ✓ Random_5 (pose=(-1.4884297242181712, 0.8948837633117499, -2.522799447184727)): shape (37, 800, 800)
      Valid pixels: 75331/640000 (11.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=12, max=269808, num_faces=269916
      Valid probs shape: (37, 75331)
    ✓ Random_6 (pose=(3.1414118931152766, -2.5858807820228873, -0.25380470042146985)): shape (37, 800, 800)
      Valid pixels: 48266/640000 (7.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=269594, num_faces=269916
      Valid probs shape: (37, 48266)
    ✓ Random_7 (pose=(-1.1558280094163536, -2.7256812936976593, 0.7991995020489839)): shape (37, 800, 800)
      Valid pixels: 66283/640000 (10.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=60, max=269915, num_faces=269916
      Valid probs shape: (37, 66283)
    ✓ Random_8 (pose=(-2.5449572332840265, -0.6193672184115195, 2.659709429400345)): shape (37, 800, 800)
      Valid pixels: 61519/640000 (9.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=479, max=269913, num_faces=269916
      Valid probs shape: (37, 61519)
    ✓ Random_9 (pose=(1.246536028934817, 0.4735184880008245, 1.9192695599266303)): shape (37, 800, 800)
      Valid pixels: 78844/640000 (12.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=269878, num_faces=269916
      Valid probs shape: (37, 78844)
    ✓ Random_10 (pose=(-1.0758170241462977, -0.5919559620359096, 0.3359156538579606)): shape (37, 800, 800)
      Valid pixels: 65483/640000 (10.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=11, max=269878, num_faces=269916
      Valid probs shape: (37, 65483)
    ✓ Random_11 (pose=(-1.5990506523279038, 2.627457059320931, -2.28973756311632)): shape (37, 800, 800)
      Valid pixels: 67825/640000 (10.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=18, max=269808, num_faces=269916
      Valid probs shape: (37, 67825)
    ✓ Random_12 (pose=(1.3254940085491667, 0.3279320395360843, -2.926290228049018)): shape (37, 800, 800)
      Valid pixels: 74225/640000 (11.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=269899, num_faces=269916
      Valid probs shape: (37, 74225)
    ✓ Random_13 (pose=(2.609222012484146, 2.36236900340064, -2.5413038011557547)): shape (37, 800, 800)
      Valid pixels: 74124/640000 (11.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=269877, num_faces=269916
      Valid probs shape: (37, 74124)
    ✓ Random_14 (pose=(-0.4395456358710814, 2.557108778367952, -2.715381341899116)): shape (37, 800, 800)
      Valid pixels: 66626/640000 (10.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1025, max=269911, num_faces=269916
      Valid probs shape: (37, 66626)
    ✓ Random_15 (pose=(-0.750015647513997, -0.5335978632810336, -2.895022055630592)): shape (37, 800, 800)
      Valid pixels: 63469/640000 (9.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=269753, num_faces=269916
      Valid probs shape: (37, 63469)
    ✓ Random_16 (pose=(-0.936036627121434, -0.48386549155249803, -0.4825853402283524)): shape (37, 800, 800)
      Valid pixels: 76605/640000 (12.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=269877, num_faces=269916
      Valid probs shape: (37, 76605)
    ✓ Random_17 (pose=(0.28167149442172645, -1.4178485393120974, 2.3772035040763493)): shape (37, 800, 800)
      Valid pixels: 63290/640000 (9.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=269808, num_faces=269916
      Valid probs shape: (37, 63290)
    ✓ Random_18 (pose=(1.2428737075295748, 2.6393776209225557, 2.083054025933178)): shape (37, 800, 800)
      Valid pixels: 85988/640000 (13.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=269900, num_faces=269916
      Valid probs shape: (37, 85988)
    ✓ Random_19 (pose=(0.7617529807653529, -1.5065783632723146, -2.9988137747015657)): shape (37, 800, 800)
      Valid pixels: 90735/640000 (14.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=10, max=269910, num_faces=269916
      Valid probs shape: (37, 90735)
    ✓ Random_20 (pose=(2.1996592976490694, -2.9227919856703237, -3.0363988092506973)): shape (37, 800, 800)
      Valid pixels: 66274/640000 (10.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=269860, num_faces=269916
      Valid probs shape: (37, 66274)
    ✓ Random_21 (pose=(0.2574055324128697, 2.4011942418844994, -1.2081331036254053)): shape (37, 800, 800)
      Valid pixels: 66778/640000 (10.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1202, max=269911, num_faces=269916
      Valid probs shape: (37, 66778)
    ✓ Random_22 (pose=(-2.874217662561413, 1.344191530024692, -2.285422870639705)): shape (37, 800, 800)
      Valid pixels: 84296/640000 (13.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=269876, num_faces=269916
      Valid probs shape: (37, 84296)
    ✓ Random_23 (pose=(2.3107044398506735, -1.7761681743454178, -1.7009035887540178)): shape (37, 800, 800)
      Valid pixels: 86659/640000 (13.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=269914, num_faces=269916
      Valid probs shape: (37, 86659)
    ✓ Random_24 (pose=(1.0610914562677944, 1.1223706789407562, -0.7629493994310876)): shape (37, 800, 800)
      Valid pixels: 95430/640000 (14.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=269901, num_faces=269916
      Valid probs shape: (37, 95430)
    ✓ Random_25 (pose=(-2.8850874180184145, 2.839961209318714, 2.4794581948021763)): shape (37, 800, 800)
      Valid pixels: 52189/640000 (8.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=269636, num_faces=269916
      Valid probs shape: (37, 52189)
    ✓ Random_26 (pose=(2.7892053632571745, 0.23264420721489243, -0.1388800549362701)): shape (37, 800, 800)
      Valid pixels: 48622/640000 (7.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1820, max=269915, num_faces=269916
      Valid probs shape: (37, 48622)
    ✓ Random_27 (pose=(2.457923962087089, 2.074519077858982, 0.2398807555864475)): shape (37, 800, 800)
      Valid pixels: 90421/640000 (14.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=12, max=269911, num_faces=269916
      Valid probs shape: (37, 90421)
    ✓ Random_28 (pose=(-2.090101965391889, 2.736687465196643, 2.672287769670916)): shape (37, 800, 800)
      Valid pixels: 87832/640000 (13.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=269804, num_faces=269916
      Valid probs shape: (37, 87832)
    ✓ Random_29 (pose=(2.5613168610097308, -2.362384011479687, 2.4914198429242553)): shape (37, 800, 800)
      Valid pixels: 67433/640000 (10.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=269877, num_faces=269916
      Valid probs shape: (37, 67433)
    P stats: min=0.0000, max=0.9999, mean=0.0256
    Non-zero vertices: 127609/134960
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 7351 1190  989 2881    0 2071 1212 5083 5489]
  Ground Truth Stats:
    Labels shape: (134960,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-9/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
    MRF iteration 5/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7839
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8322
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8322

  RESULTS:
  RAW:         median(top-10)=0.9064, mean(top-10)=0.9133, median(all)=0.8494, mean(all)=0.7839
  + SMOOTHING: median(top-10)=0.9353, mean(top-10)=0.9376, median(all)=0.8726, mean(all)=0.8322 [+0.0289]
  + MRF:       median(top-10)=0.9357, mean(top-10)=0.9378, median(all)=0.8723, mean(all)=0.8322 [+0.0005]
  TOTAL IMPROVEMENT (median top-10): +0.0294

================================================================================
Subject: Twins-2-1
================================================================================
  Step 0: Generating predictions with V2 model (30 random views)...
  Mesh: 145069 vertices, 290134 faces
  Generating 30 random views...
  Generating predictions for 30 views (continuous camera pose)...
    ✓ Random_0 (pose=(-1.7414993366310956, 2.6515981585635044, 1.2447631760056188)): shape (37, 800, 800)
      Valid pixels: 73561/640000 (11.5%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=20, max=290132, num_faces=290134
      Valid probs shape: (37, 73561)
    ✓ Random_1 (pose=(-1.2955230423481925, 0.21000623180924816, -1.9462239991238341)): shape (37, 800, 800)
      Valid pixels: 82913/640000 (13.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=3, max=290133, num_faces=290134
      Valid probs shape: (37, 82913)
    ✓ Random_2 (pose=(-2.1575478288983185, 2.3883738037991398, 0.2802438225326589)): shape (37, 800, 800)
      Valid pixels: 83460/640000 (13.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=2, max=290132, num_faces=290134
      Valid probs shape: (37, 83460)
    ✓ Random_3 (pose=(0.17251319305087032, 2.9743472008982623, -3.0832626654956736)): shape (37, 800, 800)
      Valid pixels: 67900/640000 (10.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=12071, max=290133, num_faces=290134
      Valid probs shape: (37, 67900)
    ✓ Random_4 (pose=(1.1021223617702063, 0.5690650887287902, 0.1251230712039737)): shape (37, 800, 800)
      Valid pixels: 104250/640000 (16.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=290130, num_faces=290134
      Valid probs shape: (37, 104250)
    ✓ Random_5 (pose=(1.904182404727485, 1.0714179515128128, -1.4007313169919222)): shape (37, 800, 800)
      Valid pixels: 78520/640000 (12.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=450, max=290133, num_faces=290134
      Valid probs shape: (37, 78520)
    ✓ Random_6 (pose=(2.735747934937545, 1.2954270838491508, -1.6749130118480122)): shape (37, 800, 800)
      Valid pixels: 102895/640000 (16.1%)
      Probs stats: min=0.0000, max=0.9995, mean=0.0270
      Face IDs: min=6, max=290133, num_faces=290134
      Valid probs shape: (37, 102895)
    ✓ Random_7 (pose=(0.5504397003811707, 2.2764721636223433, -2.4148029632140995)): shape (37, 800, 800)
      Valid pixels: 79626/640000 (12.4%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=1013, max=290133, num_faces=290134
      Valid probs shape: (37, 79626)
    ✓ Random_8 (pose=(-2.895877540142086, 0.9083241353273968, 0.7598170484145519)): shape (37, 800, 800)
      Valid pixels: 93561/640000 (14.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=828, max=290133, num_faces=290134
      Valid probs shape: (37, 93561)
    ✓ Random_9 (pose=(1.0078802169239793, -0.04963383194110138, -2.7164356059888783)): shape (37, 800, 800)
      Valid pixels: 91241/640000 (14.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=6, max=290028, num_faces=290134
      Valid probs shape: (37, 91241)
    ✓ Random_10 (pose=(-0.8421028116211189, -1.619628272708348, 1.8225744073948613)): shape (37, 800, 800)
      Valid pixels: 122441/640000 (19.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=290133, num_faces=290134
      Valid probs shape: (37, 122441)
    ✓ Random_11 (pose=(-1.8980772366540375, -2.28740668115639, 1.8337899777766884)): shape (37, 800, 800)
      Valid pixels: 70773/640000 (11.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=5, max=290133, num_faces=290134
      Valid probs shape: (37, 70773)
    ✓ Random_12 (pose=(0.712344381902493, 1.8841403061790327, -2.5226861869359913)): shape (37, 800, 800)
      Valid pixels: 79416/640000 (12.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=409, max=290132, num_faces=290134
      Valid probs shape: (37, 79416)
    ✓ Random_13 (pose=(0.15507562739417668, 0.9410776589988039, 2.1471820133307755)): shape (37, 800, 800)
      Valid pixels: 90021/640000 (14.1%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=6, max=290029, num_faces=290134
      Valid probs shape: (37, 90021)
    ✓ Random_14 (pose=(2.1407081797999954, 0.38762374224792495, -1.5707264278197766)): shape (37, 800, 800)
      Valid pixels: 82804/640000 (12.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1003, max=290133, num_faces=290134
      Valid probs shape: (37, 82804)
    ✓ Random_15 (pose=(-1.38387175032854, 2.794027804597291, -2.3811024398225484)): shape (37, 800, 800)
      Valid pixels: 96245/640000 (15.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=21, max=290125, num_faces=290134
      Valid probs shape: (37, 96245)
    ✓ Random_16 (pose=(0.776128089461297, -2.8261173959569565, 2.357352243484531)): shape (37, 800, 800)
      Valid pixels: 84654/640000 (13.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=18036, max=290132, num_faces=290134
      Valid probs shape: (37, 84654)
    ✓ Random_17 (pose=(2.2356084598188346, -1.2108519368927984, -0.5729215915981483)): shape (37, 800, 800)
      Valid pixels: 121203/640000 (18.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=232, max=290133, num_faces=290134
      Valid probs shape: (37, 121203)
    ✓ Random_18 (pose=(0.16768025036451029, -2.1249028813456423, -1.6618303800209921)): shape (37, 800, 800)
      Valid pixels: 104421/640000 (16.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=2573, max=290133, num_faces=290134
      Valid probs shape: (37, 104421)
    ✓ Random_19 (pose=(1.4878239835466767, 1.7668532390005725, -2.6262495758641107)): shape (37, 800, 800)
      Valid pixels: 94402/640000 (14.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=7, max=290132, num_faces=290134
      Valid probs shape: (37, 94402)
    ✓ Random_20 (pose=(1.8556382660105903, -0.8576724752438514, 1.318273958771158)): shape (37, 800, 800)
      Valid pixels: 69535/640000 (10.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=9, max=290077, num_faces=290134
      Valid probs shape: (37, 69535)
    ✓ Random_21 (pose=(2.476503397317485, 0.08655384121725351, 2.6102637998241898)): shape (37, 800, 800)
      Valid pixels: 90428/640000 (14.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=20461, max=290131, num_faces=290134
      Valid probs shape: (37, 90428)
    ✓ Random_22 (pose=(-0.8202414377293743, -1.0501064332703263, -2.4531678917211384)): shape (37, 800, 800)
      Valid pixels: 76734/640000 (12.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=290133, num_faces=290134
      Valid probs shape: (37, 76734)
    ✓ Random_23 (pose=(2.0339322964904065, -0.25113456635151277, 3.1028828097572507)): shape (37, 800, 800)
      Valid pixels: 106676/640000 (16.7%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=192, max=290132, num_faces=290134
      Valid probs shape: (37, 106676)
    ✓ Random_24 (pose=(2.9953503931412513, -1.2286490036404647, -3.046998784652734)): shape (37, 800, 800)
      Valid pixels: 80049/640000 (12.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=940, max=290133, num_faces=290134
      Valid probs shape: (37, 80049)
    ✓ Random_25 (pose=(-0.12827924542107327, -2.007363306185377, 2.3181422693981464)): shape (37, 800, 800)
      Valid pixels: 93533/640000 (14.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=506, max=290132, num_faces=290134
      Valid probs shape: (37, 93533)
    ✓ Random_26 (pose=(2.2095914851611598, 1.5796168973209292, 2.0535602236832595)): shape (37, 800, 800)
      Valid pixels: 73013/640000 (11.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=290133, num_faces=290134
      Valid probs shape: (37, 73013)
    ✓ Random_27 (pose=(-1.1565254824324136, -1.3630014621973698, 1.0900655874607414)): shape (37, 800, 800)
      Valid pixels: 73632/640000 (11.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=38, max=290133, num_faces=290134
      Valid probs shape: (37, 73632)
    ✓ Random_28 (pose=(1.5771610037978094, -2.9356664410484297, 2.1134813079895975)): shape (37, 800, 800)
      Valid pixels: 105440/640000 (16.5%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=8, max=289396, num_faces=290134
      Valid probs shape: (37, 105440)
    ✓ Random_29 (pose=(1.3830229731833628, -1.4324178158785146, -0.6174133879472778)): shape (37, 800, 800)
      Valid pixels: 114821/640000 (17.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=290133, num_faces=290134
      Valid probs shape: (37, 114821)
    P stats: min=0.0000, max=0.9998, mean=0.0244
    Non-zero vertices: 131048/145069
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 14021  1067   950  4157     0  1957   958  4953  6033]
  Ground Truth Stats:
    Labels shape: (145069,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/Twins-2-1/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7564
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8230
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8236

  RESULTS:
  RAW:         median(top-10)=0.9041, mean(top-10)=0.8985, median(all)=0.7969, mean(all)=0.7564
  + SMOOTHING: median(top-10)=0.9248, mean(top-10)=0.9196, median(all)=0.8537, mean(all)=0.8230 [+0.0207]
  + MRF:       median(top-10)=0.9250, mean(top-10)=0.9199, median(all)=0.8542, mean(all)=0.8236 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0209

================================================================================
Subject: Twins-2-2
================================================================================
  Step 0: Generating predictions with V2 model (30 random views)...
  Mesh: 149751 vertices, 299498 faces
  Generating 30 random views...
  Generating predictions for 30 views (continuous camera pose)...
    ✓ Random_0 (pose=(0.7898042326003325, -2.716968568288258, -2.562568679500405)): shape (37, 800, 800)
      Valid pixels: 109510/640000 (17.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=10186, max=299256, num_faces=299498
      Valid probs shape: (37, 109510)
    ✓ Random_1 (pose=(1.1309773475233307, -0.9916500284156813, 0.5370135322845035)): shape (37, 800, 800)
      Valid pixels: 129676/640000 (20.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=299497, num_faces=299498
      Valid probs shape: (37, 129676)
    ✓ Random_2 (pose=(1.9859815723485292, 0.32002014132599355, 2.91012187863197)): shape (37, 800, 800)
      Valid pixels: 125504/640000 (19.6%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=2967, max=299256, num_faces=299498
      Valid probs shape: (37, 125504)
    ✓ Random_3 (pose=(0.7627056216944399, 1.3023731440655641, -1.2358655272194115)): shape (37, 800, 800)
      Valid pixels: 134003/640000 (20.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=299497, num_faces=299498
      Valid probs shape: (37, 134003)
    ✓ Random_4 (pose=(0.07318468345222273, -3.12537362008907, -2.4684054662415145)): shape (37, 800, 800)
      Valid pixels: 69795/640000 (10.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=8992, max=299455, num_faces=299498
      Valid probs shape: (37, 69795)
    ✓ Random_5 (pose=(-2.7363129116217477, -1.5463597509652498, 0.9185758076745358)): shape (37, 800, 800)
      Valid pixels: 133158/640000 (20.8%)
      Probs stats: min=0.0000, max=0.9993, mean=0.0270
      Face IDs: min=25, max=298588, num_faces=299498
      Valid probs shape: (37, 133158)
    ✓ Random_6 (pose=(2.7860777864906296, 2.7083176008638246, 1.2029599035835377)): shape (37, 800, 800)
      Valid pixels: 90939/640000 (14.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=299454, num_faces=299498
      Valid probs shape: (37, 90939)
    ✓ Random_7 (pose=(2.501187100908835, -0.7789003600289419, -1.1596676279847262)): shape (37, 800, 800)
      Valid pixels: 135463/640000 (21.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=299497, num_faces=299498
      Valid probs shape: (37, 135463)
    ✓ Random_8 (pose=(-1.8809005544193718, 1.263906875277713, 0.2096042761204724)): shape (37, 800, 800)
      Valid pixels: 110474/640000 (17.3%)
      Probs stats: min=0.0000, max=0.9994, mean=0.0270
      Face IDs: min=25, max=298363, num_faces=299498
      Valid probs shape: (37, 110474)
    ✓ Random_9 (pose=(0.4447136617077554, -2.9567322271248035, -1.1033298194958046)): shape (37, 800, 800)
      Valid pixels: 84511/640000 (13.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5787, max=299494, num_faces=299498
      Valid probs shape: (37, 84511)
    ✓ Random_10 (pose=(-1.6937705207174274, -0.7801855017807897, -0.3414679870875328)): shape (37, 800, 800)
      Valid pixels: 132303/640000 (20.7%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=84, max=298588, num_faces=299498
      Valid probs shape: (37, 132303)
    ✓ Random_11 (pose=(-2.024537234606512, -0.7317987193183835, -0.7003503360593553)): shape (37, 800, 800)
      Valid pixels: 111449/640000 (17.4%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=913, max=299467, num_faces=299498
      Valid probs shape: (37, 111449)
    ✓ Random_12 (pose=(-0.11680009994369822, 1.3736103339811923, -1.3415812514269996)): shape (37, 800, 800)
      Valid pixels: 124274/640000 (19.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=5, max=299497, num_faces=299498
      Valid probs shape: (37, 124274)
    ✓ Random_13 (pose=(0.0638688405362342, -0.2106489930779607, 0.9568772727304999)): shape (37, 800, 800)
      Valid pixels: 71975/640000 (11.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=299438, num_faces=299498
      Valid probs shape: (37, 71975)
    ✓ Random_14 (pose=(2.3704484399524226, -0.707924232801521, -1.2212598015572278)): shape (37, 800, 800)
      Valid pixels: 133610/640000 (20.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=299497, num_faces=299498
      Valid probs shape: (37, 133610)
    ✓ Random_15 (pose=(1.3953195063418278, -0.98883058404452, -0.7813984597791324)): shape (37, 800, 800)
      Valid pixels: 117421/640000 (18.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=299497, num_faces=299498
      Valid probs shape: (37, 117421)
    ✓ Random_16 (pose=(-0.25675327484224164, -1.3931160121180157, -0.945058881632737)): shape (37, 800, 800)
      Valid pixels: 114786/640000 (17.9%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=2, max=299256, num_faces=299498
      Valid probs shape: (37, 114786)
    ✓ Random_17 (pose=(-0.9491291585484638, -0.16080828673841907, 0.2041810996913691)): shape (37, 800, 800)
      Valid pixels: 110677/640000 (17.3%)
      Probs stats: min=0.0000, max=0.9993, mean=0.0270
      Face IDs: min=0, max=299256, num_faces=299498
      Valid probs shape: (37, 110677)
    ✓ Random_18 (pose=(1.1983446075913813, 2.2077093669198673, -0.04604918388023327)): shape (37, 800, 800)
      Valid pixels: 131981/640000 (20.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=0, max=299497, num_faces=299498
      Valid probs shape: (37, 131981)
    ✓ Random_19 (pose=(-1.8713345415058464, 0.7415872458003436, 2.16195966423433)): shape (37, 800, 800)
      Valid pixels: 133861/640000 (20.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=299497, num_faces=299498
      Valid probs shape: (37, 133861)
    ✓ Random_20 (pose=(-2.089159595815064, 0.45750267222842833, 1.9441642055467003)): shape (37, 800, 800)
      Valid pixels: 125250/640000 (19.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=395, max=299497, num_faces=299498
      Valid probs shape: (37, 125250)
    ✓ Random_21 (pose=(1.2976402158252727, -2.7486192714321165, 0.8701689351339112)): shape (37, 800, 800)
      Valid pixels: 106667/640000 (16.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=299496, num_faces=299498
      Valid probs shape: (37, 106667)
    ✓ Random_22 (pose=(1.718264572638132, -0.09206325928991621, 1.3935509536094726)): shape (37, 800, 800)
      Valid pixels: 80204/640000 (12.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=299462, num_faces=299498
      Valid probs shape: (37, 80204)
    ✓ Random_23 (pose=(2.1923077706226897, -1.4653956648692255, -2.3073918462386684)): shape (37, 800, 800)
      Valid pixels: 84761/640000 (13.2%)
      Probs stats: min=0.0000, max=0.9995, mean=0.0270
      Face IDs: min=183, max=299496, num_faces=299498
      Valid probs shape: (37, 84761)
    ✓ Random_24 (pose=(1.3518535307860686, 2.8415721845842583, 1.6804693378786801)): shape (37, 800, 800)
      Valid pixels: 88621/640000 (13.8%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=1319, max=298361, num_faces=299498
      Valid probs shape: (37, 88621)
    ✓ Random_25 (pose=(2.3830321652165862, -2.2058226669261765, -2.4122175961255174)): shape (37, 800, 800)
      Valid pixels: 71751/640000 (11.2%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=3, max=299455, num_faces=299498
      Valid probs shape: (37, 71751)
    ✓ Random_26 (pose=(-0.8544038673506988, -2.946423742953207, -0.3578075424421434)): shape (37, 800, 800)
      Valid pixels: 113597/640000 (17.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=12156, max=299439, num_faces=299498
      Valid probs shape: (37, 113597)
    ✓ Random_27 (pose=(0.8293279581273083, 0.3048271814978034, 1.41999334140867)): shape (37, 800, 800)
      Valid pixels: 91513/640000 (14.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=298361, num_faces=299498
      Valid probs shape: (37, 91513)
    ✓ Random_28 (pose=(2.1957510702062732, 2.4916658539125747, 0.08160480038327744)): shape (37, 800, 800)
      Valid pixels: 121090/640000 (18.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=299497, num_faces=299498
      Valid probs shape: (37, 121090)
    ✓ Random_29 (pose=(0.7889330507118109, -1.7186751579424824, -1.2965600953377068)): shape (37, 800, 800)
      Valid pixels: 95146/640000 (14.9%)
      Probs stats: min=0.0000, max=0.9992, mean=0.0270
      Face IDs: min=102, max=299455, num_faces=299498
      Valid probs shape: (37, 95146)
    P stats: min=0.0000, max=0.9996, mean=0.0257
    Non-zero vertices: 142269/149751
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [   0 7482  988 1089 3989    0 2326  883 4971 7160]
  Ground Truth Stats:
    Labels shape: (149751,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/Twins-2-2/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.7630
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8093
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8096

  RESULTS:
  RAW:         median(top-10)=0.9051, mean(top-10)=0.9116, median(all)=0.8109, mean(all)=0.7630
  + SMOOTHING: median(top-10)=0.9283, mean(top-10)=0.9297, median(all)=0.8393, mean(all)=0.8093 [+0.0233]
  + MRF:       median(top-10)=0.9290, mean(top-10)=0.9301, median(all)=0.8396, mean(all)=0.8096 [+0.0006]
  TOTAL IMPROVEMENT (median top-10): +0.0239

================================================================================
AGGREGATE RESULTS ACROSS ALL TEST SUBJECTS
================================================================================
Number of subjects: 101

RAW PREDICTIONS:
  Median(top-10):  0.9002 ± 0.0124  (min: 0.8703, max: 0.9273)
  Mean(top-10):    0.9025 ± 0.0106  (min: 0.8738, max: 0.9255)
  Median(all):     0.8299 ± 0.0186  (min: 0.7616, max: 0.8623)
  Mean(all):       0.7674 ± 0.0174  (min: 0.6810, max: 0.7912)

+ SMOOTHING (α=0.75, 20 iter):
  Median(top-10):  0.9244 ± 0.0091  (min: 0.8996, max: 0.9415)
  Mean(top-10):    0.9261 ± 0.0080  (min: 0.9025, max: 0.9420)
  Median(all):     0.8677 ± 0.0160  (min: 0.8059, max: 0.8989)
  Mean(all):       0.8197 ± 0.0176  (min: 0.7304, max: 0.8453)
  Improvement:     median(top-10) +0.0242, mean(all) +0.0523

+ MRF (β=0.1, 5 iter):
  Median(top-10):  0.9247 ± 0.0090  (min: 0.9002, max: 0.9420)
  Mean(top-10):    0.9264 ± 0.0079  (min: 0.9030, max: 0.9422)
  Median(all):     0.8681 ± 0.0159  (min: 0.8062, max: 0.8990)
  Mean(all):       0.8200 ± 0.0176  (min: 0.7305, max: 0.8455)
  Improvement:     median(top-10) +0.0003, mean(all) +0.0003

TOTAL IMPROVEMENT (RAW → MRF):
  Median(top-10):  +0.0245
  Mean(top-10):    +0.0239
  Median(all):     +0.0382
  Mean(all):       +0.0526
================================================================================
