nohup: ignoring input
[GPU] PyTorch3D loaded - GPU raycasting AVAILABLE (FAST MODE: bin_size=None)
[GPU] PyTorch3D loaded - GPU raycasting AVAILABLE (will be enabled via --raycasting arg)
Auto-detected latest checkpoint: last.ckpt

Loading model from: /autofs/space/ballarat_004/users/np341/PRIR_Code/Training/White/prir_x_y_z_conditional_1_unet/models/xyz_random_views_7794326/last.ckpt
✓ Model loaded (using TRAIN mode due to corrupted BN running stats)

================================================================================
Testing VIEW-CONDITIONED model V2 (Arbitrary Views) with PyTorch3D pipeline
Checkpoint: /autofs/space/ballarat_004/users/np341/PRIR_Code/Training/White/prir_x_y_z_conditional_1_unet/models/xyz_random_views_7794326/last.ckpt
Test data: /autofs/space/ballarat_004/users/np341/mindboggle2
Using all default views: ['Front', 'Back', 'Left', 'Right', 'Top', 'Bottom']
1. Generate predictions using V2 model (continuous camera pose)
2. Iterative smoothing (α=0.75, 20 iter)
3. MRF with ICM (β=0.1)
================================================================================

Found 101 test subjects

================================================================================
Subject: Afterthought-1
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 130921 vertices, 261838 faces
  Rendering 6 predefined views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 130921 vertices, 261838 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (52544 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (102793 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (94972 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (67847 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (47950 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (72380 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 52544/640000 (8.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=0, max=261300, num_faces=261838
      Valid probs shape: (37, 52544)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 47950/640000 (7.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3568, max=261837, num_faces=261838
      Valid probs shape: (37, 47950)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 72380/640000 (11.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=34, max=261836, num_faces=261838
      Valid probs shape: (37, 72380)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 67847/640000 (10.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=11, max=261746, num_faces=261838
      Valid probs shape: (37, 67847)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 94972/640000 (14.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=11, max=261835, num_faces=261838
      Valid probs shape: (37, 94972)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 102793/640000 (16.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=261837, num_faces=261838
      Valid probs shape: (37, 102793)
    P stats: min=0.0000, max=0.9999, mean=0.0200
    Non-zero vertices: 96668/130921
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 34253   702   854  2733     0  1476   916  2872  4558]
  Ground Truth Stats:
    Labels shape: (130921,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/Afterthought-1/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6611
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8092
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8095

  RESULTS:
  RAW:         median(top-10)=0.8020, mean(top-10)=0.8033, median(all)=0.7153, mean(all)=0.6611
  + SMOOTHING: median(top-10)=0.9036, mean(top-10)=0.9012, median(all)=0.8458, mean(all)=0.8092 [+0.1016]
  + MRF:       median(top-10)=0.9037, mean(top-10)=0.9013, median(all)=0.8462, mean(all)=0.8095 [+0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.1017

================================================================================
Subject: Colin27-1
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 182414 vertices, 364824 faces
  Rendering 6 predefined views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 182414 vertices, 364824 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (43071 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (97725 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (89326 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (56504 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (42980 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (61050 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 43071/640000 (6.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=364539, num_faces=364824
      Valid probs shape: (37, 43071)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 42980/640000 (6.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=119742, max=364669, num_faces=364824
      Valid probs shape: (37, 42980)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 61050/640000 (9.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=136, max=364823, num_faces=364824
      Valid probs shape: (37, 61050)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 56504/640000 (8.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=364669, num_faces=364824
      Valid probs shape: (37, 56504)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 89326/640000 (14.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8, max=364541, num_faces=364824
      Valid probs shape: (37, 89326)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 97725/640000 (15.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=96, max=364820, num_faces=364824
      Valid probs shape: (37, 97725)
    P stats: min=0.0000, max=1.0000, mean=0.0194
    Non-zero vertices: 130641/182414
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 51773  1133  1387  3899     0  2486   912  4660  7089]
  Ground Truth Stats:
    Labels shape: (182414,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/Colin27-1/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6409
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7705
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7706

  RESULTS:
  RAW:         median(top-10)=0.7764, mean(top-10)=0.7801, median(all)=0.6768, mean(all)=0.6409
  + SMOOTHING: median(top-10)=0.8745, mean(top-10)=0.8753, median(all)=0.8049, mean(all)=0.7705 [+0.0980]
  + MRF:       median(top-10)=0.8753, mean(top-10)=0.8759, median(all)=0.8035, mean(all)=0.7706 [+0.0008]
  TOTAL IMPROVEMENT (median top-10): +0.0988

================================================================================
Subject: HLN-12-1
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 138729 vertices, 277454 faces
  Rendering 6 predefined views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 138729 vertices, 277454 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (55392 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (110033 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (101081 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (71993 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (58637 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (75986 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 55392/640000 (8.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=277356, num_faces=277454
      Valid probs shape: (37, 55392)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 58637/640000 (9.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=14742, max=277439, num_faces=277454
      Valid probs shape: (37, 58637)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 75986/640000 (11.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=277453, num_faces=277454
      Valid probs shape: (37, 75986)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 71993/640000 (11.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=277337, num_faces=277454
      Valid probs shape: (37, 71993)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 101081/640000 (15.8%)
      Probs stats: min=0.0000, max=0.9994, mean=0.0270
      Face IDs: min=9, max=277285, num_faces=277454
      Valid probs shape: (37, 101081)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 110033/640000 (17.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=4, max=277453, num_faces=277454
      Valid probs shape: (37, 110033)
    P stats: min=0.0000, max=1.0000, mean=0.0197
    Non-zero vertices: 100890/138729
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 37839   636   860  2678     0  1698   691  3509  5160]
  Ground Truth Stats:
    Labels shape: (138729,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/HLN-12-1/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6548
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7976
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7980

  RESULTS:
  RAW:         median(top-10)=0.7610, mean(top-10)=0.7743, median(all)=0.7102, mean(all)=0.6548
  + SMOOTHING: median(top-10)=0.9006, mean(top-10)=0.8991, median(all)=0.8346, mean(all)=0.7976 [+0.1397]
  + MRF:       median(top-10)=0.9012, mean(top-10)=0.8997, median(all)=0.8354, mean(all)=0.7980 [+0.0006]
  TOTAL IMPROVEMENT (median top-10): +0.1402

================================================================================
Subject: HLN-12-10
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 134639 vertices, 269274 faces
  Rendering 6 predefined views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 134639 vertices, 269274 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (49208 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (103318 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (96400 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (63448 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (48636 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (67763 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 49208/640000 (7.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=268227, num_faces=269274
      Valid probs shape: (37, 49208)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 48636/640000 (7.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=90443, max=269273, num_faces=269274
      Valid probs shape: (37, 48636)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 67763/640000 (10.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=18, max=269267, num_faces=269274
      Valid probs shape: (37, 67763)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 63448/640000 (9.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=269272, num_faces=269274
      Valid probs shape: (37, 63448)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 96400/640000 (15.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=5, max=269228, num_faces=269274
      Valid probs shape: (37, 96400)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 103318/640000 (16.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=33, max=269273, num_faces=269274
      Valid probs shape: (37, 103318)
    P stats: min=0.0000, max=1.0000, mean=0.0197
    Non-zero vertices: 98072/134639
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 36567   804  1130  2461     0  2110   959  3546  4020]
  Ground Truth Stats:
    Labels shape: (134639,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/HLN-12-10/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6436
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7824
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7829

  RESULTS:
  RAW:         median(top-10)=0.7912, mean(top-10)=0.8112, median(all)=0.6912, mean(all)=0.6436
  + SMOOTHING: median(top-10)=0.9012, mean(top-10)=0.8980, median(all)=0.8399, mean(all)=0.7824 [+0.1100]
  + MRF:       median(top-10)=0.9017, mean(top-10)=0.8983, median(all)=0.8402, mean(all)=0.7829 [+0.0005]
  TOTAL IMPROVEMENT (median top-10): +0.1105

================================================================================
Subject: HLN-12-11
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 130710 vertices, 261416 faces
  Rendering 6 predefined views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 130710 vertices, 261416 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (54132 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (108773 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (99782 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (70200 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (53644 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (73452 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 54132/640000 (8.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=260363, num_faces=261416
      Valid probs shape: (37, 54132)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 53644/640000 (8.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=8184, max=261302, num_faces=261416
      Valid probs shape: (37, 53644)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 73452/640000 (11.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=174, max=261415, num_faces=261416
      Valid probs shape: (37, 73452)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 70200/640000 (11.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=17, max=260417, num_faces=261416
      Valid probs shape: (37, 70200)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 99782/640000 (15.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=3, max=261118, num_faces=261416
      Valid probs shape: (37, 99782)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 108773/640000 (17.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=9, max=261270, num_faces=261416
      Valid probs shape: (37, 108773)
    P stats: min=0.0000, max=0.9999, mean=0.0199
    Non-zero vertices: 96021/130710
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 34689   795   784  2438     0  1546  1051  3315  4474]
  Ground Truth Stats:
    Labels shape: (130710,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/HLN-12-11/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6480
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7688
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7690

  RESULTS:
  RAW:         median(top-10)=0.7778, mean(top-10)=0.7873, median(all)=0.7114, mean(all)=0.6480
  + SMOOTHING: median(top-10)=0.8973, mean(top-10)=0.8918, median(all)=0.8138, mean(all)=0.7688 [+0.1195]
  + MRF:       median(top-10)=0.8975, mean(top-10)=0.8921, median(all)=0.8143, mean(all)=0.7690 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.1197

================================================================================
Subject: HLN-12-12
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 148128 vertices, 296252 faces
  Rendering 6 predefined views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 148128 vertices, 296252 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (36488 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (87809 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (81986 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (54622 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (39079 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (58147 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 36488/640000 (5.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=295661, num_faces=296252
      Valid probs shape: (37, 36488)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 39079/640000 (6.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=19163, max=296251, num_faces=296252
      Valid probs shape: (37, 39079)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 58147/640000 (9.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=63, max=296199, num_faces=296252
      Valid probs shape: (37, 58147)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 54622/640000 (8.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=28, max=295788, num_faces=296252
      Valid probs shape: (37, 54622)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 81986/640000 (12.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=296228, num_faces=296252
      Valid probs shape: (37, 81986)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 87809/640000 (13.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=296202, num_faces=296252
      Valid probs shape: (37, 87809)
    P stats: min=0.0000, max=1.0000, mean=0.0190
    Non-zero vertices: 104357/148128
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 43771   666   630  3111     0  1975   917  4854  5332]
  Ground Truth Stats:
    Labels shape: (148128,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/HLN-12-12/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6301
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7718
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7724

  RESULTS:
  RAW:         median(top-10)=0.7669, mean(top-10)=0.7833, median(all)=0.7092, mean(all)=0.6301
  + SMOOTHING: median(top-10)=0.8952, mean(top-10)=0.8967, median(all)=0.8142, mean(all)=0.7718 [+0.1283]
  + MRF:       median(top-10)=0.8955, mean(top-10)=0.8972, median(all)=0.8145, mean(all)=0.7724 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.1286

================================================================================
Subject: HLN-12-2
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 146833 vertices, 293662 faces
  Rendering 6 predefined views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 146833 vertices, 293662 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (46607 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (103885 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (96694 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (62897 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (44360 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (66086 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 46607/640000 (7.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=291413, num_faces=293662
      Valid probs shape: (37, 46607)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 44360/640000 (6.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=702, max=293660, num_faces=293662
      Valid probs shape: (37, 44360)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 66086/640000 (10.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=293660, num_faces=293662
      Valid probs shape: (37, 66086)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 62897/640000 (9.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=293652, num_faces=293662
      Valid probs shape: (37, 62897)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 96694/640000 (15.1%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=0, max=293660, num_faces=293662
      Valid probs shape: (37, 96694)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 103885/640000 (16.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=293617, num_faces=293662
      Valid probs shape: (37, 103885)
    P stats: min=0.0000, max=1.0000, mean=0.0198
    Non-zero vertices: 107451/146833
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 39382   502   964  3306     0  1501  1021  3624  4542]
  Ground Truth Stats:
    Labels shape: (146833,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/HLN-12-2/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6446
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7842
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7848

  RESULTS:
  RAW:         median(top-10)=0.7850, mean(top-10)=0.7880, median(all)=0.6742, mean(all)=0.6446
  + SMOOTHING: median(top-10)=0.8916, mean(top-10)=0.8935, median(all)=0.8319, mean(all)=0.7842 [+0.1066]
  + MRF:       median(top-10)=0.8920, mean(top-10)=0.8942, median(all)=0.8317, mean(all)=0.7848 [+0.0004]
  TOTAL IMPROVEMENT (median top-10): +0.1070

================================================================================
Subject: HLN-12-3
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 150991 vertices, 301978 faces
  Rendering 6 predefined views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 150991 vertices, 301978 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (50763 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (103869 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (95766 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (69662 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (47677 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (73690 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 50763/640000 (7.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=300913, num_faces=301978
      Valid probs shape: (37, 50763)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 47677/640000 (7.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=12685, max=301976, num_faces=301978
      Valid probs shape: (37, 47677)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 73690/640000 (11.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=301977, num_faces=301978
      Valid probs shape: (37, 73690)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 69662/640000 (10.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=301909, num_faces=301978
      Valid probs shape: (37, 69662)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 95766/640000 (15.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=4, max=301976, num_faces=301978
      Valid probs shape: (37, 95766)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 103869/640000 (16.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7, max=301969, num_faces=301978
      Valid probs shape: (37, 103869)
    P stats: min=0.0000, max=1.0000, mean=0.0187
    Non-zero vertices: 104277/150991
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 46714   578  1174  2752     0  1754   918  3439  5125]
  Ground Truth Stats:
    Labels shape: (150991,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/HLN-12-3/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6296
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7755
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7759

  RESULTS:
  RAW:         median(top-10)=0.7748, mean(top-10)=0.7777, median(all)=0.6870, mean(all)=0.6296
  + SMOOTHING: median(top-10)=0.8997, mean(top-10)=0.8995, median(all)=0.8179, mean(all)=0.7755 [+0.1249]
  + MRF:       median(top-10)=0.9002, mean(top-10)=0.8999, median(all)=0.8185, mean(all)=0.7759 [+0.0005]
  TOTAL IMPROVEMENT (median top-10): +0.1254

================================================================================
Subject: HLN-12-4
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 137751 vertices, 275498 faces
  Rendering 6 predefined views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 137751 vertices, 275498 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (45362 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (101448 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (93148 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (61368 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (40991 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (65568 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 45362/640000 (7.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=274427, num_faces=275498
      Valid probs shape: (37, 45362)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 40991/640000 (6.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=15917, max=275497, num_faces=275498
      Valid probs shape: (37, 40991)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 65568/640000 (10.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=15, max=275497, num_faces=275498
      Valid probs shape: (37, 65568)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 61368/640000 (9.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=275424, num_faces=275498
      Valid probs shape: (37, 61368)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 93148/640000 (14.6%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=11, max=275447, num_faces=275498
      Valid probs shape: (37, 93148)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 101448/640000 (15.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=10, max=275493, num_faces=275498
      Valid probs shape: (37, 101448)
    P stats: min=0.0000, max=1.0000, mean=0.0195
    Non-zero vertices: 99507/137751
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 38244   742   980  3103     0  2244   811  3266  4638]
  Ground Truth Stats:
    Labels shape: (137751,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/HLN-12-4/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6444
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=33
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7766
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=33
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7771

  RESULTS:
  RAW:         median(top-10)=0.7830, mean(top-10)=0.7965, median(all)=0.6974, mean(all)=0.6444
  + SMOOTHING: median(top-10)=0.8865, mean(top-10)=0.8945, median(all)=0.8286, mean(all)=0.7766 [+0.1035]
  + MRF:       median(top-10)=0.8873, mean(top-10)=0.8952, median(all)=0.8294, mean(all)=0.7771 [+0.0008]
  TOTAL IMPROVEMENT (median top-10): +0.1043

================================================================================
Subject: HLN-12-5
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 167182 vertices, 334360 faces
  Rendering 6 predefined views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 167182 vertices, 334360 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (59201 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (119392 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (108361 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (76922 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (58160 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (81303 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 59201/640000 (9.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=333773, num_faces=334360
      Valid probs shape: (37, 59201)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 58160/640000 (9.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=11446, max=334358, num_faces=334360
      Valid probs shape: (37, 58160)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 81303/640000 (12.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=97, max=334358, num_faces=334360
      Valid probs shape: (37, 81303)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 76922/640000 (12.0%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=1, max=333104, num_faces=334360
      Valid probs shape: (37, 76922)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 108361/640000 (16.9%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=4, max=334359, num_faces=334360
      Valid probs shape: (37, 108361)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 119392/640000 (18.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=6, max=334330, num_faces=334360
      Valid probs shape: (37, 119392)
    P stats: min=0.0000, max=0.9999, mean=0.0189
    Non-zero vertices: 117006/167182
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 50176   870  1464  2821     0  1816   892  4083  5367]
  Ground Truth Stats:
    Labels shape: (167182,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/HLN-12-5/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6290
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7786
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7787

  RESULTS:
  RAW:         median(top-10)=0.7632, mean(top-10)=0.7639, median(all)=0.7043, mean(all)=0.6290
  + SMOOTHING: median(top-10)=0.8681, mean(top-10)=0.8754, median(all)=0.8188, mean(all)=0.7786 [+0.1048]
  + MRF:       median(top-10)=0.8677, mean(top-10)=0.8753, median(all)=0.8190, mean(all)=0.7787 [-0.0004]
  TOTAL IMPROVEMENT (median top-10): +0.1045

================================================================================
Subject: HLN-12-6
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 149409 vertices, 298814 faces
  Rendering 6 predefined views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 149409 vertices, 298814 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (48687 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (106170 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (98195 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (63466 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (48654 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (67125 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 48687/640000 (7.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=298186, num_faces=298814
      Valid probs shape: (37, 48687)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 48654/640000 (7.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=113698, max=298813, num_faces=298814
      Valid probs shape: (37, 48654)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 67125/640000 (10.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=180, max=298810, num_faces=298814
      Valid probs shape: (37, 67125)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 63466/640000 (9.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=298813, num_faces=298814
      Valid probs shape: (37, 63466)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 98195/640000 (15.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=298813, num_faces=298814
      Valid probs shape: (37, 98195)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 106170/640000 (16.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=298813, num_faces=298814
      Valid probs shape: (37, 106170)
    P stats: min=0.0000, max=1.0000, mean=0.0185
    Non-zero vertices: 102038/149409
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 47371   670   828  2767     0  1833   698  4378  5293]
  Ground Truth Stats:
    Labels shape: (149409,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/HLN-12-6/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6211
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7611
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7612

  RESULTS:
  RAW:         median(top-10)=0.7649, mean(top-10)=0.7686, median(all)=0.6775, mean(all)=0.6211
  + SMOOTHING: median(top-10)=0.8998, mean(top-10)=0.9029, median(all)=0.7983, mean(all)=0.7611 [+0.1349]
  + MRF:       median(top-10)=0.9004, mean(top-10)=0.9031, median(all)=0.7982, mean(all)=0.7612 [+0.0007]
  TOTAL IMPROVEMENT (median top-10): +0.1355

================================================================================
Subject: HLN-12-7
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 122042 vertices, 244080 faces
  Rendering 6 predefined views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 122042 vertices, 244080 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (48174 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (97942 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (90170 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (66958 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (46544 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (70897 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 48174/640000 (7.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=243668, num_faces=244080
      Valid probs shape: (37, 48174)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 46544/640000 (7.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5059, max=244079, num_faces=244080
      Valid probs shape: (37, 46544)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 70897/640000 (11.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=32, max=244078, num_faces=244080
      Valid probs shape: (37, 70897)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 66958/640000 (10.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=244060, num_faces=244080
      Valid probs shape: (37, 66958)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 90170/640000 (14.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=12, max=244078, num_faces=244080
      Valid probs shape: (37, 90170)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 97942/640000 (15.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7, max=243977, num_faces=244080
      Valid probs shape: (37, 97942)
    P stats: min=0.0000, max=1.0000, mean=0.0198
    Non-zero vertices: 89361/122042
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 32681   604  1069  2608     0  1596   818  3347  3595]
  Ground Truth Stats:
    Labels shape: (122042,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/HLN-12-7/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6595
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7858
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7860

  RESULTS:
  RAW:         median(top-10)=0.7905, mean(top-10)=0.7975, median(all)=0.7219, mean(all)=0.6595
  + SMOOTHING: median(top-10)=0.8933, mean(top-10)=0.8954, median(all)=0.8521, mean(all)=0.7858 [+0.1028]
  + MRF:       median(top-10)=0.8932, mean(top-10)=0.8956, median(all)=0.8523, mean(all)=0.7860 [-0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.1027

================================================================================
Subject: HLN-12-8
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 163705 vertices, 327406 faces
  Rendering 6 predefined views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 163705 vertices, 327406 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (40393 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (100424 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (93719 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (62442 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (41836 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (64666 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 40393/640000 (6.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=326193, num_faces=327406
      Valid probs shape: (37, 40393)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 41836/640000 (6.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6877, max=327405, num_faces=327406
      Valid probs shape: (37, 41836)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 64666/640000 (10.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8, max=327269, num_faces=327406
      Valid probs shape: (37, 64666)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 62442/640000 (9.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=327404, num_faces=327406
      Valid probs shape: (37, 62442)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 93719/640000 (14.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=4, max=327402, num_faces=327406
      Valid probs shape: (37, 93719)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 100424/640000 (15.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=327264, num_faces=327406
      Valid probs shape: (37, 100424)
    P stats: min=0.0000, max=1.0000, mean=0.0191
    Non-zero vertices: 115976/163705
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 47729   640  1446  2910     0  1877  1048  4035  5059]
  Ground Truth Stats:
    Labels shape: (163705,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/HLN-12-8/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6346
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7807
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7813

  RESULTS:
  RAW:         median(top-10)=0.7812, mean(top-10)=0.7858, median(all)=0.6999, mean(all)=0.6346
  + SMOOTHING: median(top-10)=0.8808, mean(top-10)=0.8840, median(all)=0.8246, mean(all)=0.7807 [+0.0996]
  + MRF:       median(top-10)=0.8813, mean(top-10)=0.8844, median(all)=0.8247, mean(all)=0.7813 [+0.0005]
  TOTAL IMPROVEMENT (median top-10): +0.1000

================================================================================
Subject: HLN-12-9
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 137393 vertices, 274782 faces
  Rendering 6 predefined views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 137393 vertices, 274782 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (46497 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (104898 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (97052 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (68112 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (46952 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (70884 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 46497/640000 (7.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=274139, num_faces=274782
      Valid probs shape: (37, 46497)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 46952/640000 (7.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=13241, max=274780, num_faces=274782
      Valid probs shape: (37, 46952)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 70884/640000 (11.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=11, max=274778, num_faces=274782
      Valid probs shape: (37, 70884)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 68112/640000 (10.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=274759, num_faces=274782
      Valid probs shape: (37, 68112)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 97052/640000 (15.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=274775, num_faces=274782
      Valid probs shape: (37, 97052)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 104898/640000 (16.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=274781, num_faces=274782
      Valid probs shape: (37, 104898)
    P stats: min=0.0000, max=1.0000, mean=0.0198
    Non-zero vertices: 100691/137393
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 36702   597   983  2731     0  1767   830  3692  4777]
  Ground Truth Stats:
    Labels shape: (137393,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/HLN-12-9/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6542
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7922
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7930

  RESULTS:
  RAW:         median(top-10)=0.7891, mean(top-10)=0.8002, median(all)=0.7066, mean(all)=0.6542
  + SMOOTHING: median(top-10)=0.8996, mean(top-10)=0.9017, median(all)=0.8351, mean(all)=0.7922 [+0.1105]
  + MRF:       median(top-10)=0.8999, mean(top-10)=0.9022, median(all)=0.8361, mean(all)=0.7930 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.1108

================================================================================
Subject: MMRR-21-1
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 130631 vertices, 261258 faces
  Rendering 6 predefined views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 130631 vertices, 261258 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (40722 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (99817 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (92769 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (57787 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (39358 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (61484 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 40722/640000 (6.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=259583, num_faces=261258
      Valid probs shape: (37, 40722)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 39358/640000 (6.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7127, max=261255, num_faces=261258
      Valid probs shape: (37, 39358)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 61484/640000 (9.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=81, max=261129, num_faces=261258
      Valid probs shape: (37, 61484)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 57787/640000 (9.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=261254, num_faces=261258
      Valid probs shape: (37, 57787)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 92769/640000 (14.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=6, max=261257, num_faces=261258
      Valid probs shape: (37, 92769)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 99817/640000 (15.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7, max=261192, num_faces=261258
      Valid probs shape: (37, 99817)
    P stats: min=0.0000, max=1.0000, mean=0.0195
    Non-zero vertices: 94316/130631
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 36315   518   861  2491     0  1121   602  3566  4435]
  Ground Truth Stats:
    Labels shape: (130631,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-1/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6559
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8111
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8117

  RESULTS:
  RAW:         median(top-10)=0.7992, mean(top-10)=0.8034, median(all)=0.7084, mean(all)=0.6559
  + SMOOTHING: median(top-10)=0.8938, mean(top-10)=0.9065, median(all)=0.8530, mean(all)=0.8111 [+0.0946]
  + MRF:       median(top-10)=0.8940, mean(top-10)=0.9071, median(all)=0.8534, mean(all)=0.8117 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0948

================================================================================
Subject: MMRR-21-10
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 148162 vertices, 296320 faces
  Rendering 6 predefined views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 148162 vertices, 296320 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (43482 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (98186 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (91751 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (60436 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (42061 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (64853 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 43482/640000 (6.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=293646, num_faces=296320
      Valid probs shape: (37, 43482)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 42061/640000 (6.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=8175, max=296319, num_faces=296320
      Valid probs shape: (37, 42061)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 64853/640000 (10.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=11, max=296097, num_faces=296320
      Valid probs shape: (37, 64853)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 60436/640000 (9.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=296313, num_faces=296320
      Valid probs shape: (37, 60436)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 91751/640000 (14.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=296313, num_faces=296320
      Valid probs shape: (37, 91751)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 98186/640000 (15.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=296319, num_faces=296320
      Valid probs shape: (37, 98186)
    P stats: min=0.0000, max=1.0000, mean=0.0192
    Non-zero vertices: 105240/148162
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 42922   715   761  2744     0  1850   995  4269  5521]
  Ground Truth Stats:
    Labels shape: (148162,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-10/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6384
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7947
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7951

  RESULTS:
  RAW:         median(top-10)=0.7798, mean(top-10)=0.7907, median(all)=0.6952, mean(all)=0.6384
  + SMOOTHING: median(top-10)=0.8933, mean(top-10)=0.8904, median(all)=0.8379, mean(all)=0.7947 [+0.1135]
  + MRF:       median(top-10)=0.8935, mean(top-10)=0.8907, median(all)=0.8385, mean(all)=0.7951 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.1137

================================================================================
Subject: MMRR-21-11
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 136982 vertices, 273960 faces
  Rendering 6 predefined views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 136982 vertices, 273960 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (52146 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (110529 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (101692 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (69534 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (48724 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (73385 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 52146/640000 (8.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=0, max=272575, num_faces=273960
      Valid probs shape: (37, 52146)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 48724/640000 (7.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=14048, max=273957, num_faces=273960
      Valid probs shape: (37, 48724)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 73385/640000 (11.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=273951, num_faces=273960
      Valid probs shape: (37, 73385)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 69534/640000 (10.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=16, max=273953, num_faces=273960
      Valid probs shape: (37, 69534)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 101692/640000 (15.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=5, max=273957, num_faces=273960
      Valid probs shape: (37, 101692)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 110529/640000 (17.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=9, max=273959, num_faces=273960
      Valid probs shape: (37, 110529)
    P stats: min=0.0000, max=1.0000, mean=0.0197
    Non-zero vertices: 99681/136982
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 37301   957   759  1855     0  1383   787  3527  5020]
  Ground Truth Stats:
    Labels shape: (136982,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-11/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
    MRF iteration 5/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.5845
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7011
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7014

  RESULTS:
  RAW:         median(top-10)=0.7695, mean(top-10)=0.7680, median(all)=0.6712, mean(all)=0.5845
  + SMOOTHING: median(top-10)=0.8602, mean(top-10)=0.8641, median(all)=0.7750, mean(all)=0.7011 [+0.0906]
  + MRF:       median(top-10)=0.8604, mean(top-10)=0.8645, median(all)=0.7751, mean(all)=0.7014 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0909

================================================================================
Subject: MMRR-21-12
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 102602 vertices, 205200 faces
  Rendering 6 predefined views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 102602 vertices, 205200 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (47593 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (99656 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (92170 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (63142 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (48707 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (67036 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 47593/640000 (7.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=204378, num_faces=205200
      Valid probs shape: (37, 47593)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 48707/640000 (7.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=61823, max=205199, num_faces=205200
      Valid probs shape: (37, 48707)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 67036/640000 (10.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8, max=205182, num_faces=205200
      Valid probs shape: (37, 67036)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 63142/640000 (9.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=205183, num_faces=205200
      Valid probs shape: (37, 63142)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 92170/640000 (14.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=5, max=205115, num_faces=205200
      Valid probs shape: (37, 92170)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 99656/640000 (15.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=205196, num_faces=205200
      Valid probs shape: (37, 99656)
    P stats: min=0.0000, max=1.0000, mean=0.0201
    Non-zero vertices: 76274/102602
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 26328   657   862  1382     0  1316   715  2573  3136]
  Ground Truth Stats:
    Labels shape: (102602,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-12/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6562
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7908
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7912

  RESULTS:
  RAW:         median(top-10)=0.8096, mean(top-10)=0.8166, median(all)=0.7084, mean(all)=0.6562
  + SMOOTHING: median(top-10)=0.8929, mean(top-10)=0.8952, median(all)=0.8267, mean(all)=0.7908 [+0.0834]
  + MRF:       median(top-10)=0.8937, mean(top-10)=0.8956, median(all)=0.8261, mean(all)=0.7912 [+0.0008]
  TOTAL IMPROVEMENT (median top-10): +0.0841

================================================================================
Subject: MMRR-21-13
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 128887 vertices, 257770 faces
  Rendering 6 predefined views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 128887 vertices, 257770 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (66987 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (128645 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (116270 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (81198 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (61231 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (85980 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 66987/640000 (10.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=0, max=255193, num_faces=257770
      Valid probs shape: (37, 66987)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 61231/640000 (9.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2134, max=257767, num_faces=257770
      Valid probs shape: (37, 61231)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 85980/640000 (13.4%)
      Probs stats: min=0.0000, max=0.9995, mean=0.0270
      Face IDs: min=38, max=257765, num_faces=257770
      Valid probs shape: (37, 85980)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 81198/640000 (12.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=257709, num_faces=257770
      Valid probs shape: (37, 81198)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 116270/640000 (18.2%)
      Probs stats: min=0.0000, max=0.9995, mean=0.0270
      Face IDs: min=4, max=257765, num_faces=257770
      Valid probs shape: (37, 116270)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 128645/640000 (20.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=0, max=257769, num_faces=257770
      Valid probs shape: (37, 128645)
    P stats: min=0.0000, max=0.9998, mean=0.0198
    Non-zero vertices: 94344/128887
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 34543   482   943  2274     0  1410   665  3569  4362]
  Ground Truth Stats:
    Labels shape: (128887,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-13/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6314
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7713
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7719

  RESULTS:
  RAW:         median(top-10)=0.7724, mean(top-10)=0.7746, median(all)=0.6835, mean(all)=0.6314
  + SMOOTHING: median(top-10)=0.8787, mean(top-10)=0.8814, median(all)=0.8309, mean(all)=0.7713 [+0.1063]
  + MRF:       median(top-10)=0.8787, mean(top-10)=0.8817, median(all)=0.8318, mean(all)=0.7719 [+0.0000]
  TOTAL IMPROVEMENT (median top-10): +0.1063

================================================================================
Subject: MMRR-21-14
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 127387 vertices, 254770 faces
  Rendering 6 predefined views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 127387 vertices, 254770 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (43715 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (101762 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (93528 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (63818 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (42955 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (68349 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 43715/640000 (6.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=252386, num_faces=254770
      Valid probs shape: (37, 43715)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 42955/640000 (6.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3019, max=254769, num_faces=254770
      Valid probs shape: (37, 42955)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 68349/640000 (10.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8, max=254768, num_faces=254770
      Valid probs shape: (37, 68349)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 63818/640000 (10.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=252424, num_faces=254770
      Valid probs shape: (37, 63818)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 93528/640000 (14.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=254769, num_faces=254770
      Valid probs shape: (37, 93528)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 101762/640000 (15.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=254767, num_faces=254770
      Valid probs shape: (37, 101762)
    P stats: min=0.0000, max=1.0000, mean=0.0201
    Non-zero vertices: 94509/127387
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 32878   908  1009  3081     0  1444  1001  3672  3927]
  Ground Truth Stats:
    Labels shape: (127387,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-14/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6414
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7709
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7715

  RESULTS:
  RAW:         median(top-10)=0.7959, mean(top-10)=0.8081, median(all)=0.6850, mean(all)=0.6414
  + SMOOTHING: median(top-10)=0.8965, mean(top-10)=0.8972, median(all)=0.7940, mean(all)=0.7709 [+0.1007]
  + MRF:       median(top-10)=0.8971, mean(top-10)=0.8978, median(all)=0.7955, mean(all)=0.7715 [+0.0005]
  TOTAL IMPROVEMENT (median top-10): +0.1012

================================================================================
Subject: MMRR-21-15
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 137028 vertices, 274052 faces
  Rendering 6 predefined views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 137028 vertices, 274052 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (36305 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (90305 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (83430 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (57339 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (37026 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (60830 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 36305/640000 (5.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=273817, num_faces=274052
      Valid probs shape: (37, 36305)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 37026/640000 (5.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=22460, max=274051, num_faces=274052
      Valid probs shape: (37, 37026)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 60830/640000 (9.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=274040, num_faces=274052
      Valid probs shape: (37, 60830)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 57339/640000 (9.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=274047, num_faces=274052
      Valid probs shape: (37, 57339)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 83430/640000 (13.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=16, max=274045, num_faces=274052
      Valid probs shape: (37, 83430)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 90305/640000 (14.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=273971, num_faces=274052
      Valid probs shape: (37, 90305)
    P stats: min=0.0000, max=1.0000, mean=0.0191
    Non-zero vertices: 96753/137028
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 40275   680  1032  3273     0  1776   723  3295  4844]
  Ground Truth Stats:
    Labels shape: (137028,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-15/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6498
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7953
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7960

  RESULTS:
  RAW:         median(top-10)=0.7810, mean(top-10)=0.7954, median(all)=0.7067, mean(all)=0.6498
  + SMOOTHING: median(top-10)=0.9025, mean(top-10)=0.9053, median(all)=0.8482, mean(all)=0.7953 [+0.1216]
  + MRF:       median(top-10)=0.9031, mean(top-10)=0.9057, median(all)=0.8489, mean(all)=0.7960 [+0.0005]
  TOTAL IMPROVEMENT (median top-10): +0.1221

================================================================================
Subject: MMRR-21-16
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 147500 vertices, 294996 faces
  Rendering 6 predefined views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 147500 vertices, 294996 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (40557 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (93518 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (86953 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (58863 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (38920 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (62272 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 40557/640000 (6.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=294196, num_faces=294996
      Valid probs shape: (37, 40557)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 38920/640000 (6.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6867, max=294995, num_faces=294996
      Valid probs shape: (37, 38920)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 62272/640000 (9.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=59, max=294924, num_faces=294996
      Valid probs shape: (37, 62272)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 58863/640000 (9.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=294995, num_faces=294996
      Valid probs shape: (37, 58863)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 86953/640000 (13.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8, max=294991, num_faces=294996
      Valid probs shape: (37, 86953)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 93518/640000 (14.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=294925, num_faces=294996
      Valid probs shape: (37, 93518)
    P stats: min=0.0000, max=1.0000, mean=0.0192
    Non-zero vertices: 104726/147500
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 42774   549  1090  2772     0  1826   955  3597  4892]
  Ground Truth Stats:
    Labels shape: (147500,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-16/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6384
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7717
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7718

  RESULTS:
  RAW:         median(top-10)=0.7887, mean(top-10)=0.7882, median(all)=0.7151, mean(all)=0.6384
  + SMOOTHING: median(top-10)=0.9039, mean(top-10)=0.9067, median(all)=0.8211, mean(all)=0.7717 [+0.1152]
  + MRF:       median(top-10)=0.9042, mean(top-10)=0.9068, median(all)=0.8222, mean(all)=0.7718 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.1155

================================================================================
Subject: MMRR-21-17
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 126138 vertices, 252272 faces
  Rendering 6 predefined views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 126138 vertices, 252272 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (45826 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (102759 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (94668 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (62077 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (44356 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (67469 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 45826/640000 (7.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=251586, num_faces=252272
      Valid probs shape: (37, 45826)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 44356/640000 (6.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6043, max=252264, num_faces=252272
      Valid probs shape: (37, 44356)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 67469/640000 (10.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=13, max=252204, num_faces=252272
      Valid probs shape: (37, 67469)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 62077/640000 (9.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=252270, num_faces=252272
      Valid probs shape: (37, 62077)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 94668/640000 (14.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=252271, num_faces=252272
      Valid probs shape: (37, 94668)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 102759/640000 (16.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=252204, num_faces=252272
      Valid probs shape: (37, 102759)
    P stats: min=0.0000, max=1.0000, mean=0.0206
    Non-zero vertices: 96328/126138
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 29810   790  1163  2399     0  2066   800  3682  3849]
  Ground Truth Stats:
    Labels shape: (126138,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-17/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6568
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=33
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7648
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=33
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7649

  RESULTS:
  RAW:         median(top-10)=0.8040, mean(top-10)=0.8124, median(all)=0.7278, mean(all)=0.6568
  + SMOOTHING: median(top-10)=0.8983, mean(top-10)=0.9051, median(all)=0.8325, mean(all)=0.7648 [+0.0944]
  + MRF:       median(top-10)=0.8989, mean(top-10)=0.9053, median(all)=0.8328, mean(all)=0.7649 [+0.0006]
  TOTAL IMPROVEMENT (median top-10): +0.0949

================================================================================
Subject: MMRR-21-18
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 131379 vertices, 262754 faces
  Rendering 6 predefined views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 131379 vertices, 262754 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (42260 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (92118 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (84982 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (62715 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (41126 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (66753 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 42260/640000 (6.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=262449, num_faces=262754
      Valid probs shape: (37, 42260)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 41126/640000 (6.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6780, max=262753, num_faces=262754
      Valid probs shape: (37, 41126)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 66753/640000 (10.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=214, max=262643, num_faces=262754
      Valid probs shape: (37, 66753)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 62715/640000 (9.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=262751, num_faces=262754
      Valid probs shape: (37, 62715)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 84982/640000 (13.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=8, max=262751, num_faces=262754
      Valid probs shape: (37, 84982)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 92118/640000 (14.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=262753, num_faces=262754
      Valid probs shape: (37, 92118)
    P stats: min=0.0000, max=1.0000, mean=0.0195
    Non-zero vertices: 94664/131379
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 36715   526  1136  2881     0  1253   805  3267  4270]
  Ground Truth Stats:
    Labels shape: (131379,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-18/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6418
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7758
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7757

  RESULTS:
  RAW:         median(top-10)=0.7892, mean(top-10)=0.8012, median(all)=0.7097, mean(all)=0.6418
  + SMOOTHING: median(top-10)=0.9001, mean(top-10)=0.9067, median(all)=0.8219, mean(all)=0.7758 [+0.1108]
  + MRF:       median(top-10)=0.9004, mean(top-10)=0.9070, median(all)=0.8225, mean(all)=0.7757 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.1112

================================================================================
Subject: MMRR-21-19
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 145253 vertices, 290502 faces
  Rendering 6 predefined views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 145253 vertices, 290502 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (51928 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (105292 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (97397 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (68573 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (47572 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (71543 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 51928/640000 (8.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=288277, num_faces=290502
      Valid probs shape: (37, 51928)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 47572/640000 (7.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7741, max=290501, num_faces=290502
      Valid probs shape: (37, 47572)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 71543/640000 (11.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=39, max=290501, num_faces=290502
      Valid probs shape: (37, 71543)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 68573/640000 (10.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=3, max=288242, num_faces=290502
      Valid probs shape: (37, 68573)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 97397/640000 (15.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=4, max=290499, num_faces=290502
      Valid probs shape: (37, 97397)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 105292/640000 (16.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=290500, num_faces=290502
      Valid probs shape: (37, 105292)
    P stats: min=0.0000, max=1.0000, mean=0.0197
    Non-zero vertices: 106032/145253
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 39221   642   893  3093     0  1352   903  3949  6105]
  Ground Truth Stats:
    Labels shape: (145253,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-19/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6304
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7589
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7591

  RESULTS:
  RAW:         median(top-10)=0.7687, mean(top-10)=0.7800, median(all)=0.6801, mean(all)=0.6304
  + SMOOTHING: median(top-10)=0.8805, mean(top-10)=0.8801, median(all)=0.8277, mean(all)=0.7589 [+0.1118]
  + MRF:       median(top-10)=0.8808, mean(top-10)=0.8803, median(all)=0.8279, mean(all)=0.7591 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.1121

================================================================================
Subject: MMRR-21-2
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 148593 vertices, 297182 faces
  Rendering 6 predefined views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 148593 vertices, 297182 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (42385 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (102060 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (95048 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (62600 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (42580 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (66044 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 42385/640000 (6.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=296841, num_faces=297182
      Valid probs shape: (37, 42385)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 42580/640000 (6.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=98388, max=297178, num_faces=297182
      Valid probs shape: (37, 42580)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 66044/640000 (10.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=9, max=297181, num_faces=297182
      Valid probs shape: (37, 66044)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 62600/640000 (9.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=26, max=297130, num_faces=297182
      Valid probs shape: (37, 62600)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 95048/640000 (14.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=22, max=297179, num_faces=297182
      Valid probs shape: (37, 95048)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 102060/640000 (15.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=297154, num_faces=297182
      Valid probs shape: (37, 102060)
    P stats: min=0.0000, max=1.0000, mean=0.0188
    Non-zero vertices: 103496/148593
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 45097   699  1060  3310     0  1745   870  3731  4505]
  Ground Truth Stats:
    Labels shape: (148593,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-2/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
    MRF iteration 5/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6384
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7969
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7973

  RESULTS:
  RAW:         median(top-10)=0.7692, mean(top-10)=0.7881, median(all)=0.6824, mean(all)=0.6384
  + SMOOTHING: median(top-10)=0.8991, mean(top-10)=0.9001, median(all)=0.8566, mean(all)=0.7969 [+0.1299]
  + MRF:       median(top-10)=0.9001, mean(top-10)=0.9007, median(all)=0.8569, mean(all)=0.7973 [+0.0010]
  TOTAL IMPROVEMENT (median top-10): +0.1309

================================================================================
Subject: MMRR-21-20
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 149927 vertices, 299850 faces
  Rendering 6 predefined views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 149927 vertices, 299850 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (36611 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (95169 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (88213 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (53954 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (38415 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (58097 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 36611/640000 (5.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=299499, num_faces=299850
      Valid probs shape: (37, 36611)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 38415/640000 (6.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=108468, max=299830, num_faces=299850
      Valid probs shape: (37, 38415)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 58097/640000 (9.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=30, max=299849, num_faces=299850
      Valid probs shape: (37, 58097)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 53954/640000 (8.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=14, max=299435, num_faces=299850
      Valid probs shape: (37, 53954)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 88213/640000 (13.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=299844, num_faces=299850
      Valid probs shape: (37, 88213)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 95169/640000 (14.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=10, max=299848, num_faces=299850
      Valid probs shape: (37, 95169)
    P stats: min=0.0000, max=1.0000, mean=0.0189
    Non-zero vertices: 105025/149927
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 44902   730  1109  2821     0  2122   814  4337  4516]
  Ground Truth Stats:
    Labels shape: (149927,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-20/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
    MRF iteration 5/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6445
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7876
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7878

  RESULTS:
  RAW:         median(top-10)=0.8096, mean(top-10)=0.8136, median(all)=0.7005, mean(all)=0.6445
  + SMOOTHING: median(top-10)=0.8987, mean(top-10)=0.9075, median(all)=0.8374, mean(all)=0.7876 [+0.0891]
  + MRF:       median(top-10)=0.8995, mean(top-10)=0.9078, median(all)=0.8379, mean(all)=0.7878 [+0.0008]
  TOTAL IMPROVEMENT (median top-10): +0.0899

================================================================================
Subject: MMRR-21-21
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 137496 vertices, 274988 faces
  Rendering 6 predefined views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 137496 vertices, 274988 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (47031 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (98307 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (90811 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (62835 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (46473 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (65724 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 47031/640000 (7.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=274023, num_faces=274988
      Valid probs shape: (37, 47031)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 46473/640000 (7.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=9681, max=274987, num_faces=274988
      Valid probs shape: (37, 46473)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 65724/640000 (10.3%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=0, max=274985, num_faces=274988
      Valid probs shape: (37, 65724)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 62835/640000 (9.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=273341, num_faces=274988
      Valid probs shape: (37, 62835)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 90811/640000 (14.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=0, max=274983, num_faces=274988
      Valid probs shape: (37, 90811)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 98307/640000 (15.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=274987, num_faces=274988
      Valid probs shape: (37, 98307)
    P stats: min=0.0000, max=1.0000, mean=0.0195
    Non-zero vertices: 99223/137496
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 38273   654   896  2420     0  1566   829  3997  5566]
  Ground Truth Stats:
    Labels shape: (137496,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-21/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6341
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7731
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7736

  RESULTS:
  RAW:         median(top-10)=0.7900, mean(top-10)=0.7945, median(all)=0.6907, mean(all)=0.6341
  + SMOOTHING: median(top-10)=0.8995, mean(top-10)=0.8987, median(all)=0.8318, mean(all)=0.7731 [+0.1095]
  + MRF:       median(top-10)=0.9001, mean(top-10)=0.8989, median(all)=0.8312, mean(all)=0.7736 [+0.0006]
  TOTAL IMPROVEMENT (median top-10): +0.1101

================================================================================
Subject: MMRR-21-3
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 144159 vertices, 288314 faces
  Rendering 6 predefined views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 144159 vertices, 288314 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (41049 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (95902 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (88656 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (58779 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (41207 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (64155 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 41049/640000 (6.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=287561, num_faces=288314
      Valid probs shape: (37, 41049)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 41207/640000 (6.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3218, max=288306, num_faces=288314
      Valid probs shape: (37, 41207)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 64155/640000 (10.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=77, max=288310, num_faces=288314
      Valid probs shape: (37, 64155)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 58779/640000 (9.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=8, max=287559, num_faces=288314
      Valid probs shape: (37, 58779)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 88656/640000 (13.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=29, max=288307, num_faces=288314
      Valid probs shape: (37, 88656)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 95902/640000 (15.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=288313, num_faces=288314
      Valid probs shape: (37, 95902)
    P stats: min=0.0000, max=1.0000, mean=0.0196
    Non-zero vertices: 104731/144159
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 39428   728   858  2950     0  1772  1045  3294  4769]
  Ground Truth Stats:
    Labels shape: (144159,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-3/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6512
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8013
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8017

  RESULTS:
  RAW:         median(top-10)=0.7791, mean(top-10)=0.7908, median(all)=0.7003, mean(all)=0.6512
  + SMOOTHING: median(top-10)=0.9027, mean(top-10)=0.9077, median(all)=0.8300, mean(all)=0.8013 [+0.1235]
  + MRF:       median(top-10)=0.9031, mean(top-10)=0.9081, median(all)=0.8304, mean(all)=0.8017 [+0.0005]
  TOTAL IMPROVEMENT (median top-10): +0.1240

================================================================================
Subject: MMRR-21-4
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 118034 vertices, 236064 faces
  Rendering 6 predefined views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 118034 vertices, 236064 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (43440 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (97256 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (90207 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (60094 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (39125 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (63499 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 43440/640000 (6.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=234903, num_faces=236064
      Valid probs shape: (37, 43440)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 39125/640000 (6.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5985, max=236062, num_faces=236064
      Valid probs shape: (37, 39125)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 63499/640000 (9.9%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=12, max=236010, num_faces=236064
      Valid probs shape: (37, 63499)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 60094/640000 (9.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=236063, num_faces=236064
      Valid probs shape: (37, 60094)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 90207/640000 (14.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=111, max=236061, num_faces=236064
      Valid probs shape: (37, 90207)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 97256/640000 (15.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=236016, num_faces=236064
      Valid probs shape: (37, 97256)
    P stats: min=0.0000, max=1.0000, mean=0.0203
    Non-zero vertices: 88733/118034
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 29301   839   818  2759     0  1236   961  2995  3691]
  Ground Truth Stats:
    Labels shape: (118034,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-4/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6562
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=33
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7754
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=33
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7756

  RESULTS:
  RAW:         median(top-10)=0.8143, mean(top-10)=0.8166, median(all)=0.7107, mean(all)=0.6562
  + SMOOTHING: median(top-10)=0.9018, mean(top-10)=0.9030, median(all)=0.8297, mean(all)=0.7754 [+0.0875]
  + MRF:       median(top-10)=0.9019, mean(top-10)=0.9033, median(all)=0.8298, mean(all)=0.7756 [+0.0000]
  TOTAL IMPROVEMENT (median top-10): +0.0876

================================================================================
Subject: MMRR-21-5
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 145215 vertices, 290426 faces
  Rendering 6 predefined views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 145215 vertices, 290426 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (48001 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (106845 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (98217 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (66489 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (45026 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (70402 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 48001/640000 (7.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=288562, num_faces=290426
      Valid probs shape: (37, 48001)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 45026/640000 (7.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4365, max=290418, num_faces=290426
      Valid probs shape: (37, 45026)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 70402/640000 (11.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=114, max=290425, num_faces=290426
      Valid probs shape: (37, 70402)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 66489/640000 (10.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=290404, num_faces=290426
      Valid probs shape: (37, 66489)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 98217/640000 (15.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=290284, num_faces=290426
      Valid probs shape: (37, 98217)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 106845/640000 (16.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=290425, num_faces=290426
      Valid probs shape: (37, 106845)
    P stats: min=0.0000, max=1.0000, mean=0.0195
    Non-zero vertices: 104953/145215
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 40262   684  1001  3906     0  1774   970  3242  4325]
  Ground Truth Stats:
    Labels shape: (145215,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-5/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6548
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7962
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7964

  RESULTS:
  RAW:         median(top-10)=0.7862, mean(top-10)=0.7919, median(all)=0.7153, mean(all)=0.6548
  + SMOOTHING: median(top-10)=0.8906, mean(top-10)=0.9007, median(all)=0.8333, mean(all)=0.7962 [+0.1044]
  + MRF:       median(top-10)=0.8909, mean(top-10)=0.9010, median(all)=0.8342, mean(all)=0.7964 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.1046

================================================================================
Subject: MMRR-21-6
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 128994 vertices, 257984 faces
  Rendering 6 predefined views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 128994 vertices, 257984 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (43829 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (101514 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (94216 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (61404 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (46186 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (65533 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 43829/640000 (6.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=256952, num_faces=257984
      Valid probs shape: (37, 43829)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 46186/640000 (7.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=92692, max=257980, num_faces=257984
      Valid probs shape: (37, 46186)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 65533/640000 (10.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=257982, num_faces=257984
      Valid probs shape: (37, 65533)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 61404/640000 (9.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=257522, num_faces=257984
      Valid probs shape: (37, 61404)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 94216/640000 (14.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=26, max=257943, num_faces=257984
      Valid probs shape: (37, 94216)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 101514/640000 (15.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=257975, num_faces=257984
      Valid probs shape: (37, 101514)
    P stats: min=0.0000, max=1.0000, mean=0.0195
    Non-zero vertices: 93242/128994
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 35752   931   895  2747     0  1430   724  3870  3906]
  Ground Truth Stats:
    Labels shape: (128994,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-6/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6529
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7923
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7926

  RESULTS:
  RAW:         median(top-10)=0.7828, mean(top-10)=0.8004, median(all)=0.7101, mean(all)=0.6529
  + SMOOTHING: median(top-10)=0.8908, mean(top-10)=0.8963, median(all)=0.8397, mean(all)=0.7923 [+0.1079]
  + MRF:       median(top-10)=0.8910, mean(top-10)=0.8966, median(all)=0.8401, mean(all)=0.7926 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.1082

================================================================================
Subject: MMRR-21-7
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 148998 vertices, 297992 faces
  Rendering 6 predefined views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 148998 vertices, 297992 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (38894 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (91708 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (84613 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (54443 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (38235 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (58012 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 38894/640000 (6.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=245177, num_faces=297992
      Valid probs shape: (37, 38894)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 38235/640000 (6.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=8599, max=297986, num_faces=297992
      Valid probs shape: (37, 38235)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 58012/640000 (9.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=297956, num_faces=297992
      Valid probs shape: (37, 58012)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 54443/640000 (8.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=297878, num_faces=297992
      Valid probs shape: (37, 54443)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 84613/640000 (13.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=13, max=297991, num_faces=297992
      Valid probs shape: (37, 84613)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 91708/640000 (14.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=297815, num_faces=297992
      Valid probs shape: (37, 91708)
    P stats: min=0.0000, max=1.0000, mean=0.0193
    Non-zero vertices: 106389/148998
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 42609   703  1286  2939     0  1629   819  4012  4494]
  Ground Truth Stats:
    Labels shape: (148998,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-7/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6528
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7954
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7956

  RESULTS:
  RAW:         median(top-10)=0.7831, mean(top-10)=0.7914, median(all)=0.7062, mean(all)=0.6528
  + SMOOTHING: median(top-10)=0.9084, mean(top-10)=0.9053, median(all)=0.8404, mean(all)=0.7954 [+0.1253]
  + MRF:       median(top-10)=0.9083, mean(top-10)=0.9055, median(all)=0.8399, mean(all)=0.7956 [-0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.1252

================================================================================
Subject: MMRR-21-8
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 124399 vertices, 248794 faces
  Rendering 6 predefined views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 124399 vertices, 248794 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (42512 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (101126 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (92934 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (57556 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (41363 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (61873 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 42512/640000 (6.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=247416, num_faces=248794
      Valid probs shape: (37, 42512)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 41363/640000 (6.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4180, max=248779, num_faces=248794
      Valid probs shape: (37, 41363)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 61873/640000 (9.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=108, max=248793, num_faces=248794
      Valid probs shape: (37, 61873)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 57556/640000 (9.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=248520, num_faces=248794
      Valid probs shape: (37, 57556)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 92934/640000 (14.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=248788, num_faces=248794
      Valid probs shape: (37, 92934)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 101126/640000 (15.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=248793, num_faces=248794
      Valid probs shape: (37, 101126)
    P stats: min=0.0000, max=1.0000, mean=0.0195
    Non-zero vertices: 89926/124399
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 34473   580  1017  2677     0  1589   915  2808  4701]
  Ground Truth Stats:
    Labels shape: (124399,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-8/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6500
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7833
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7835

  RESULTS:
  RAW:         median(top-10)=0.7966, mean(top-10)=0.8073, median(all)=0.7050, mean(all)=0.6500
  + SMOOTHING: median(top-10)=0.8932, mean(top-10)=0.8945, median(all)=0.8452, mean(all)=0.7833 [+0.0966]
  + MRF:       median(top-10)=0.8935, mean(top-10)=0.8951, median(all)=0.8460, mean(all)=0.7835 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0969

================================================================================
Subject: MMRR-21-9
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 131827 vertices, 263650 faces
  Rendering 6 predefined views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 131827 vertices, 263650 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (46196 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (102595 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (94766 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (63258 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (44518 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (66524 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 46196/640000 (7.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=263279, num_faces=263650
      Valid probs shape: (37, 46196)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 44518/640000 (7.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5442, max=263649, num_faces=263650
      Valid probs shape: (37, 44518)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 66524/640000 (10.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=263643, num_faces=263650
      Valid probs shape: (37, 66524)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 63258/640000 (9.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=263649, num_faces=263650
      Valid probs shape: (37, 63258)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 94766/640000 (14.8%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=51, max=263649, num_faces=263650
      Valid probs shape: (37, 94766)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 102595/640000 (16.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=25, max=263645, num_faces=263650
      Valid probs shape: (37, 102595)
    P stats: min=0.0000, max=1.0000, mean=0.0194
    Non-zero vertices: 94585/131827
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 37242   573   970  2995     0  1313   752  3439  4529]
  Ground Truth Stats:
    Labels shape: (131827,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-21-9/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6572
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8059
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8064

  RESULTS:
  RAW:         median(top-10)=0.7967, mean(top-10)=0.8017, median(all)=0.7012, mean(all)=0.6572
  + SMOOTHING: median(top-10)=0.9073, mean(top-10)=0.9090, median(all)=0.8504, mean(all)=0.8059 [+0.1107]
  + MRF:       median(top-10)=0.9082, mean(top-10)=0.9095, median(all)=0.8508, mean(all)=0.8064 [+0.0009]
  TOTAL IMPROVEMENT (median top-10): +0.1116

================================================================================
Subject: MMRR-3T7T-2-1
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 150156 vertices, 300308 faces
  Rendering 6 predefined views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 150156 vertices, 300308 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (50095 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (113043 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (103661 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (66639 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (47856 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (69905 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 50095/640000 (7.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=299529, num_faces=300308
      Valid probs shape: (37, 50095)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 47856/640000 (7.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3871, max=300280, num_faces=300308
      Valid probs shape: (37, 47856)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 69905/640000 (10.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=35, max=300100, num_faces=300308
      Valid probs shape: (37, 69905)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 66639/640000 (10.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=300301, num_faces=300308
      Valid probs shape: (37, 66639)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 103661/640000 (16.2%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=2, max=300279, num_faces=300308
      Valid probs shape: (37, 103661)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 113043/640000 (17.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=300307, num_faces=300308
      Valid probs shape: (37, 113043)
    P stats: min=0.0000, max=0.9999, mean=0.0195
    Non-zero vertices: 108101/150156
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 42055   722   919  3452     0  1180   895  4312  5119]
  Ground Truth Stats:
    Labels shape: (150156,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-3T7T-2-1/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6211
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7621
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7625

  RESULTS:
  RAW:         median(top-10)=0.7504, mean(top-10)=0.7661, median(all)=0.6813, mean(all)=0.6211
  + SMOOTHING: median(top-10)=0.8839, mean(top-10)=0.8929, median(all)=0.8224, mean(all)=0.7621 [+0.1335]
  + MRF:       median(top-10)=0.8844, mean(top-10)=0.8935, median(all)=0.8230, mean(all)=0.7625 [+0.0005]
  TOTAL IMPROVEMENT (median top-10): +0.1340

================================================================================
Subject: MMRR-3T7T-2-2
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 135252 vertices, 270500 faces
  Rendering 6 predefined views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 135252 vertices, 270500 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (50737 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (99471 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (91732 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (62641 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (47436 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (65567 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 50737/640000 (7.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=270240, num_faces=270500
      Valid probs shape: (37, 50737)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 47436/640000 (7.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5387, max=270499, num_faces=270500
      Valid probs shape: (37, 47436)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 65567/640000 (10.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5, max=270491, num_faces=270500
      Valid probs shape: (37, 65567)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 62641/640000 (9.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=10, max=270497, num_faces=270500
      Valid probs shape: (37, 62641)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 91732/640000 (14.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=26, max=270499, num_faces=270500
      Valid probs shape: (37, 91732)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 99471/640000 (15.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=270411, num_faces=270500
      Valid probs shape: (37, 99471)
    P stats: min=0.0000, max=1.0000, mean=0.0194
    Non-zero vertices: 96978/135252
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 38274   748   827  2664     0  1235   858  3402  4844]
  Ground Truth Stats:
    Labels shape: (135252,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/MMRR-3T7T-2-2/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6459
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7875
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7878

  RESULTS:
  RAW:         median(top-10)=0.7816, mean(top-10)=0.7895, median(all)=0.7032, mean(all)=0.6459
  + SMOOTHING: median(top-10)=0.9020, mean(top-10)=0.9032, median(all)=0.8452, mean(all)=0.7875 [+0.1204]
  + MRF:       median(top-10)=0.9023, mean(top-10)=0.9036, median(all)=0.8449, mean(all)=0.7878 [+0.0004]
  TOTAL IMPROVEMENT (median top-10): +0.1208

================================================================================
Subject: NKI-RS-22-1
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 137338 vertices, 274672 faces
  Rendering 6 predefined views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 137338 vertices, 274672 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (45287 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (103328 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (95368 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (62148 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (44184 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (67015 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 45287/640000 (7.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=273342, num_faces=274672
      Valid probs shape: (37, 45287)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 44184/640000 (6.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4630, max=274671, num_faces=274672
      Valid probs shape: (37, 44184)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 67015/640000 (10.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=127, max=274669, num_faces=274672
      Valid probs shape: (37, 67015)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 62148/640000 (9.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=273780, num_faces=274672
      Valid probs shape: (37, 62148)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 95368/640000 (14.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=93, max=274645, num_faces=274672
      Valid probs shape: (37, 95368)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 103328/640000 (16.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=274664, num_faces=274672
      Valid probs shape: (37, 103328)
    P stats: min=0.0000, max=1.0000, mean=0.0198
    Non-zero vertices: 100446/137338
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 36892   653   737  2863     0  1899   976  3331  4233]
  Ground Truth Stats:
    Labels shape: (137338,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-1/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6476
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7803
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7805

  RESULTS:
  RAW:         median(top-10)=0.7819, mean(top-10)=0.7908, median(all)=0.6965, mean(all)=0.6476
  + SMOOTHING: median(top-10)=0.8902, mean(top-10)=0.8917, median(all)=0.8197, mean(all)=0.7803 [+0.1082]
  + MRF:       median(top-10)=0.8902, mean(top-10)=0.8920, median(all)=0.8202, mean(all)=0.7805 [+0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.1083

================================================================================
Subject: NKI-RS-22-10
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 130448 vertices, 260892 faces
  Rendering 6 predefined views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 130448 vertices, 260892 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (49141 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (109988 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (102168 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (65401 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (47715 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (70340 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 49141/640000 (7.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=259346, num_faces=260892
      Valid probs shape: (37, 49141)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 47715/640000 (7.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5879, max=260883, num_faces=260892
      Valid probs shape: (37, 47715)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 70340/640000 (11.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=52, max=260891, num_faces=260892
      Valid probs shape: (37, 70340)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 65401/640000 (10.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=9, max=260733, num_faces=260892
      Valid probs shape: (37, 65401)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 102168/640000 (16.0%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=2, max=260804, num_faces=260892
      Valid probs shape: (37, 102168)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 109988/640000 (17.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=260885, num_faces=260892
      Valid probs shape: (37, 109988)
    P stats: min=0.0000, max=1.0000, mean=0.0200
    Non-zero vertices: 96387/130448
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 34061   808   857  2075     0  1664   732  3171  4597]
  Ground Truth Stats:
    Labels shape: (130448,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-10/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6555
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7906
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7907

  RESULTS:
  RAW:         median(top-10)=0.7872, mean(top-10)=0.8003, median(all)=0.7029, mean(all)=0.6555
  + SMOOTHING: median(top-10)=0.8942, mean(top-10)=0.9008, median(all)=0.8352, mean(all)=0.7906 [+0.1070]
  + MRF:       median(top-10)=0.8946, mean(top-10)=0.9012, median(all)=0.8361, mean(all)=0.7907 [+0.0004]
  TOTAL IMPROVEMENT (median top-10): +0.1074

================================================================================
Subject: NKI-RS-22-11
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 138161 vertices, 276318 faces
  Rendering 6 predefined views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 138161 vertices, 276318 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (41198 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (100125 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (92740 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (59370 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (42813 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (64767 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 41198/640000 (6.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=275546, num_faces=276318
      Valid probs shape: (37, 41198)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 42813/640000 (6.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=15873, max=276313, num_faces=276318
      Valid probs shape: (37, 42813)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 64767/640000 (10.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=2, max=276313, num_faces=276318
      Valid probs shape: (37, 64767)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 59370/640000 (9.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=42, max=273260, num_faces=276318
      Valid probs shape: (37, 59370)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 92740/640000 (14.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=12, max=276315, num_faces=276318
      Valid probs shape: (37, 92740)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 100125/640000 (15.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=40, max=276235, num_faces=276318
      Valid probs shape: (37, 100125)
    P stats: min=0.0000, max=1.0000, mean=0.0194
    Non-zero vertices: 99048/138161
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 39113   791  1102  2885     0  1714   925  3145  4480]
  Ground Truth Stats:
    Labels shape: (138161,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-11/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6594
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8131
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8132

  RESULTS:
  RAW:         median(top-10)=0.8004, mean(top-10)=0.8059, median(all)=0.7102, mean(all)=0.6594
  + SMOOTHING: median(top-10)=0.9094, mean(top-10)=0.9098, median(all)=0.8462, mean(all)=0.8131 [+0.1090]
  + MRF:       median(top-10)=0.9099, mean(top-10)=0.9102, median(all)=0.8460, mean(all)=0.8132 [+0.0004]
  TOTAL IMPROVEMENT (median top-10): +0.1094

================================================================================
Subject: NKI-RS-22-12
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 144832 vertices, 289660 faces
  Rendering 6 predefined views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 144832 vertices, 289660 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (41471 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (92137 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (85395 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (62927 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (41614 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (65719 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 41471/640000 (6.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=287505, num_faces=289660
      Valid probs shape: (37, 41471)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 41614/640000 (6.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=9909, max=289650, num_faces=289660
      Valid probs shape: (37, 41614)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 65719/640000 (10.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=57, max=289658, num_faces=289660
      Valid probs shape: (37, 65719)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 62927/640000 (9.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=9, max=289650, num_faces=289660
      Valid probs shape: (37, 62927)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 85395/640000 (13.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=15, max=289637, num_faces=289660
      Valid probs shape: (37, 85395)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 92137/640000 (14.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=34, max=289648, num_faces=289660
      Valid probs shape: (37, 92137)
    P stats: min=0.0000, max=1.0000, mean=0.0195
    Non-zero vertices: 104604/144832
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 40228   666   940  2407     0  2071   771  3661  4361]
  Ground Truth Stats:
    Labels shape: (144832,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-12/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6529
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7961
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7968

  RESULTS:
  RAW:         median(top-10)=0.7761, mean(top-10)=0.7807, median(all)=0.7162, mean(all)=0.6529
  + SMOOTHING: median(top-10)=0.8944, mean(top-10)=0.9033, median(all)=0.8325, mean(all)=0.7961 [+0.1182]
  + MRF:       median(top-10)=0.8951, mean(top-10)=0.9037, median(all)=0.8330, mean(all)=0.7968 [+0.0007]
  TOTAL IMPROVEMENT (median top-10): +0.1190

================================================================================
Subject: NKI-RS-22-13
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 121451 vertices, 242898 faces
  Rendering 6 predefined views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 121451 vertices, 242898 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (36598 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (92195 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (86311 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (55101 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (36296 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (59009 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 36598/640000 (5.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=241624, num_faces=242898
      Valid probs shape: (37, 36598)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 36296/640000 (5.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6217, max=242895, num_faces=242898
      Valid probs shape: (37, 36296)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 59009/640000 (9.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=31, max=242895, num_faces=242898
      Valid probs shape: (37, 59009)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 55101/640000 (8.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=241719, num_faces=242898
      Valid probs shape: (37, 55101)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 86311/640000 (13.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=44, max=242896, num_faces=242898
      Valid probs shape: (37, 86311)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 92195/640000 (14.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7, max=242887, num_faces=242898
      Valid probs shape: (37, 92195)
    P stats: min=0.0000, max=1.0000, mean=0.0201
    Non-zero vertices: 90306/121451
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 31145   668   831  2492     0  1660   865  2973  3977]
  Ground Truth Stats:
    Labels shape: (121451,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-13/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6586
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7809
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7813

  RESULTS:
  RAW:         median(top-10)=0.8064, mean(top-10)=0.8114, median(all)=0.7016, mean(all)=0.6586
  + SMOOTHING: median(top-10)=0.9029, mean(top-10)=0.9090, median(all)=0.8419, mean(all)=0.7809 [+0.0966]
  + MRF:       median(top-10)=0.9027, mean(top-10)=0.9093, median(all)=0.8434, mean(all)=0.7813 [-0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0964

================================================================================
Subject: NKI-RS-22-14
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 142823 vertices, 285642 faces
  Rendering 6 predefined views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 142823 vertices, 285642 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (38420 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (89373 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (82739 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (57667 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (38739 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (61574 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 38420/640000 (6.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=285011, num_faces=285642
      Valid probs shape: (37, 38420)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 38739/640000 (6.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=34614, max=285634, num_faces=285642
      Valid probs shape: (37, 38739)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 61574/640000 (9.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=38, max=285641, num_faces=285642
      Valid probs shape: (37, 61574)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 57667/640000 (9.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=284369, num_faces=285642
      Valid probs shape: (37, 57667)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 82739/640000 (12.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=15, max=285641, num_faces=285642
      Valid probs shape: (37, 82739)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 89373/640000 (14.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=285638, num_faces=285642
      Valid probs shape: (37, 89373)
    P stats: min=0.0000, max=1.0000, mean=0.0195
    Non-zero vertices: 102926/142823
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 39897   642  1234  2358     0  1906  1042  3777  5409]
  Ground Truth Stats:
    Labels shape: (142823,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-14/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6522
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7861
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7865

  RESULTS:
  RAW:         median(top-10)=0.8066, mean(top-10)=0.8099, median(all)=0.7058, mean(all)=0.6522
  + SMOOTHING: median(top-10)=0.8976, mean(top-10)=0.8980, median(all)=0.8403, mean(all)=0.7861 [+0.0910]
  + MRF:       median(top-10)=0.8980, mean(top-10)=0.8983, median(all)=0.8405, mean(all)=0.7865 [+0.0004]
  TOTAL IMPROVEMENT (median top-10): +0.0914

================================================================================
Subject: NKI-RS-22-15
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 158740 vertices, 317476 faces
  Rendering 6 predefined views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 158740 vertices, 317476 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (52622 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (107581 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (99208 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (68580 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (48994 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (73061 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 52622/640000 (8.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=316278, num_faces=317476
      Valid probs shape: (37, 52622)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 48994/640000 (7.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=12753, max=317401, num_faces=317476
      Valid probs shape: (37, 48994)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 73061/640000 (11.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=317474, num_faces=317476
      Valid probs shape: (37, 73061)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 68580/640000 (10.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=25, max=316189, num_faces=317476
      Valid probs shape: (37, 68580)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 99208/640000 (15.5%)
      Probs stats: min=0.0000, max=0.9995, mean=0.0270
      Face IDs: min=12, max=317475, num_faces=317476
      Valid probs shape: (37, 99208)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 107581/640000 (16.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=81, max=317474, num_faces=317476
      Valid probs shape: (37, 107581)
    P stats: min=0.0000, max=1.0000, mean=0.0196
    Non-zero vertices: 115385/158740
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 43355   492  1071  4209     0  1368  1195  3809  5770]
  Ground Truth Stats:
    Labels shape: (158740,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-15/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6424
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7792
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7795

  RESULTS:
  RAW:         median(top-10)=0.7839, mean(top-10)=0.7897, median(all)=0.6932, mean(all)=0.6424
  + SMOOTHING: median(top-10)=0.8834, mean(top-10)=0.8885, median(all)=0.8371, mean(all)=0.7792 [+0.0994]
  + MRF:       median(top-10)=0.8837, mean(top-10)=0.8889, median(all)=0.8387, mean(all)=0.7795 [+0.0004]
  TOTAL IMPROVEMENT (median top-10): +0.0998

================================================================================
Subject: NKI-RS-22-16
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 137370 vertices, 274736 faces
  Rendering 6 predefined views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 137370 vertices, 274736 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (60878 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (121155 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (111643 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (73936 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (56493 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (77034 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 60878/640000 (9.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=273269, num_faces=274736
      Valid probs shape: (37, 60878)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 56493/640000 (8.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=10110, max=274735, num_faces=274736
      Valid probs shape: (37, 56493)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 77034/640000 (12.0%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=19, max=274733, num_faces=274736
      Valid probs shape: (37, 77034)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 73936/640000 (11.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=10, max=274625, num_faces=274736
      Valid probs shape: (37, 73936)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 111643/640000 (17.4%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=6, max=274663, num_faces=274736
      Valid probs shape: (37, 111643)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 121155/640000 (18.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=7, max=274733, num_faces=274736
      Valid probs shape: (37, 121155)
    P stats: min=0.0000, max=0.9999, mean=0.0194
    Non-zero vertices: 98822/137370
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 38548   802  1121  2487     0  1639   737  3808  4224]
  Ground Truth Stats:
    Labels shape: (137370,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-16/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6372
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7720
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7724

  RESULTS:
  RAW:         median(top-10)=0.7574, mean(top-10)=0.7722, median(all)=0.6971, mean(all)=0.6372
  + SMOOTHING: median(top-10)=0.8986, mean(top-10)=0.8977, median(all)=0.8151, mean(all)=0.7720 [+0.1412]
  + MRF:       median(top-10)=0.8989, mean(top-10)=0.8983, median(all)=0.8167, mean(all)=0.7724 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.1415

================================================================================
Subject: NKI-RS-22-17
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 161773 vertices, 323542 faces
  Rendering 6 predefined views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 161773 vertices, 323542 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (48573 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (105047 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (96598 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (63636 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (46204 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (68115 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 48573/640000 (7.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=323100, num_faces=323542
      Valid probs shape: (37, 48573)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 46204/640000 (7.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=21528, max=323535, num_faces=323542
      Valid probs shape: (37, 46204)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 68115/640000 (10.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=323541, num_faces=323542
      Valid probs shape: (37, 68115)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 63636/640000 (9.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=321667, num_faces=323542
      Valid probs shape: (37, 63636)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 96598/640000 (15.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=323503, num_faces=323542
      Valid probs shape: (37, 96598)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 105047/640000 (16.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=323478, num_faces=323542
      Valid probs shape: (37, 105047)
    P stats: min=0.0000, max=1.0000, mean=0.0193
    Non-zero vertices: 115472/161773
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 46301   775   771  3249     0  1838  1007  4299  5720]
  Ground Truth Stats:
    Labels shape: (161773,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-17/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
    MRF iteration 5/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6385
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7822
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7824

  RESULTS:
  RAW:         median(top-10)=0.7912, mean(top-10)=0.7967, median(all)=0.6978, mean(all)=0.6385
  + SMOOTHING: median(top-10)=0.8971, mean(top-10)=0.9020, median(all)=0.8401, mean(all)=0.7822 [+0.1059]
  + MRF:       median(top-10)=0.8972, mean(top-10)=0.9024, median(all)=0.8402, mean(all)=0.7824 [+0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.1061

================================================================================
Subject: NKI-RS-22-18
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 147633 vertices, 295262 faces
  Rendering 6 predefined views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 147633 vertices, 295262 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (40958 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (99199 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (93062 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (57401 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (40878 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (60794 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 40958/640000 (6.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=294742, num_faces=295262
      Valid probs shape: (37, 40958)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 40878/640000 (6.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=8084, max=295260, num_faces=295262
      Valid probs shape: (37, 40878)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 60794/640000 (9.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=67, max=295261, num_faces=295262
      Valid probs shape: (37, 60794)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 57401/640000 (9.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=294979, num_faces=295262
      Valid probs shape: (37, 57401)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 93062/640000 (14.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=295219, num_faces=295262
      Valid probs shape: (37, 93062)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 99199/640000 (15.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=10, max=295261, num_faces=295262
      Valid probs shape: (37, 99199)
    P stats: min=0.0000, max=1.0000, mean=0.0196
    Non-zero vertices: 107126/147633
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 40507  1149   729  3250     0  1793   841  3939  5828]
  Ground Truth Stats:
    Labels shape: (147633,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-18/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6350
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=33
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7677
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=33
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7682

  RESULTS:
  RAW:         median(top-10)=0.7904, mean(top-10)=0.7958, median(all)=0.7003, mean(all)=0.6350
  + SMOOTHING: median(top-10)=0.8842, mean(top-10)=0.8893, median(all)=0.8146, mean(all)=0.7677 [+0.0938]
  + MRF:       median(top-10)=0.8843, mean(top-10)=0.8896, median(all)=0.8149, mean(all)=0.7682 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0940

================================================================================
Subject: NKI-RS-22-19
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 141397 vertices, 282790 faces
  Rendering 6 predefined views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 141397 vertices, 282790 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (39596 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (90573 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (84472 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (55290 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (40823 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (58701 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 39596/640000 (6.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=282348, num_faces=282790
      Valid probs shape: (37, 39596)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 40823/640000 (6.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=79382, max=282789, num_faces=282790
      Valid probs shape: (37, 40823)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 58701/640000 (9.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=145, max=282787, num_faces=282790
      Valid probs shape: (37, 58701)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 55290/640000 (8.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7, max=282724, num_faces=282790
      Valid probs shape: (37, 55290)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 84472/640000 (13.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=18, max=282789, num_faces=282790
      Valid probs shape: (37, 84472)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 90573/640000 (14.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=282781, num_faces=282790
      Valid probs shape: (37, 90573)
    P stats: min=0.0000, max=1.0000, mean=0.0193
    Non-zero vertices: 100736/141397
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 40661  1003  1216  2717     0  1326   897  3584  4108]
  Ground Truth Stats:
    Labels shape: (141397,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-19/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6450
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7871
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7879

  RESULTS:
  RAW:         median(top-10)=0.7874, mean(top-10)=0.7932, median(all)=0.7077, mean(all)=0.6450
  + SMOOTHING: median(top-10)=0.8981, mean(top-10)=0.8989, median(all)=0.8484, mean(all)=0.7871 [+0.1107]
  + MRF:       median(top-10)=0.8991, mean(top-10)=0.8996, median(all)=0.8487, mean(all)=0.7879 [+0.0010]
  TOTAL IMPROVEMENT (median top-10): +0.1117

================================================================================
Subject: NKI-RS-22-2
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 137791 vertices, 275578 faces
  Rendering 6 predefined views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 137791 vertices, 275578 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (41713 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (98370 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (91177 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (59941 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (42811 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (64305 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 41713/640000 (6.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=275020, num_faces=275578
      Valid probs shape: (37, 41713)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 42811/640000 (6.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=84363, max=275571, num_faces=275578
      Valid probs shape: (37, 42811)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 64305/640000 (10.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=220, max=275496, num_faces=275578
      Valid probs shape: (37, 64305)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 59941/640000 (9.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=17, max=275574, num_faces=275578
      Valid probs shape: (37, 59941)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 91177/640000 (14.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=10, max=275577, num_faces=275578
      Valid probs shape: (37, 91177)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 98370/640000 (15.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8, max=275479, num_faces=275578
      Valid probs shape: (37, 98370)
    P stats: min=0.0000, max=1.0000, mean=0.0194
    Non-zero vertices: 98822/137791
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 38969   686   853  2811     0  1322   743  3553  4863]
  Ground Truth Stats:
    Labels shape: (137791,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-2/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6512
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7901
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7908

  RESULTS:
  RAW:         median(top-10)=0.7763, mean(top-10)=0.7893, median(all)=0.7163, mean(all)=0.6512
  + SMOOTHING: median(top-10)=0.8896, mean(top-10)=0.8944, median(all)=0.8363, mean(all)=0.7901 [+0.1133]
  + MRF:       median(top-10)=0.8900, mean(top-10)=0.8948, median(all)=0.8376, mean(all)=0.7908 [+0.0004]
  TOTAL IMPROVEMENT (median top-10): +0.1137

================================================================================
Subject: NKI-RS-22-20
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 140825 vertices, 281646 faces
  Rendering 6 predefined views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 140825 vertices, 281646 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (46994 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (98993 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (91927 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (64277 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (44569 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (69436 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 46994/640000 (7.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=0, max=280536, num_faces=281646
      Valid probs shape: (37, 46994)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 44569/640000 (7.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=12187, max=281645, num_faces=281646
      Valid probs shape: (37, 44569)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 69436/640000 (10.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=12, max=281644, num_faces=281646
      Valid probs shape: (37, 69436)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 64277/640000 (10.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=281478, num_faces=281646
      Valid probs shape: (37, 64277)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 91927/640000 (14.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=15, max=281543, num_faces=281646
      Valid probs shape: (37, 91927)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 98993/640000 (15.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=281593, num_faces=281646
      Valid probs shape: (37, 98993)
    P stats: min=0.0000, max=1.0000, mean=0.0197
    Non-zero vertices: 102843/140825
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 37982  1121   757  2855     0  2026   883  3615  4980]
  Ground Truth Stats:
    Labels shape: (140825,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-20/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6376
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7710
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7716

  RESULTS:
  RAW:         median(top-10)=0.7556, mean(top-10)=0.7718, median(all)=0.6986, mean(all)=0.6376
  + SMOOTHING: median(top-10)=0.8927, mean(top-10)=0.8951, median(all)=0.7899, mean(all)=0.7710 [+0.1371]
  + MRF:       median(top-10)=0.8935, mean(top-10)=0.8955, median(all)=0.7909, mean(all)=0.7716 [+0.0008]
  TOTAL IMPROVEMENT (median top-10): +0.1379

================================================================================
Subject: NKI-RS-22-21
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 138920 vertices, 277836 faces
  Rendering 6 predefined views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 138920 vertices, 277836 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (37030 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (91149 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (84535 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (57596 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (38904 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (61445 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 37030/640000 (5.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=277575, num_faces=277836
      Valid probs shape: (37, 37030)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 38904/640000 (6.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=88692, max=277835, num_faces=277836
      Valid probs shape: (37, 38904)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 61445/640000 (9.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=151, max=277834, num_faces=277836
      Valid probs shape: (37, 61445)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 57596/640000 (9.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=277102, num_faces=277836
      Valid probs shape: (37, 57596)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 84535/640000 (13.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=50, max=277834, num_faces=277836
      Valid probs shape: (37, 84535)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 91149/640000 (14.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=31, max=277833, num_faces=277836
      Valid probs shape: (37, 91149)
    P stats: min=0.0000, max=1.0000, mean=0.0195
    Non-zero vertices: 100277/138920
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 38643   759  1190  3059     0  2002   850  4065  4319]
  Ground Truth Stats:
    Labels shape: (138920,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-21/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6638
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8016
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8021

  RESULTS:
  RAW:         median(top-10)=0.7900, mean(top-10)=0.7966, median(all)=0.7267, mean(all)=0.6638
  + SMOOTHING: median(top-10)=0.8847, mean(top-10)=0.8917, median(all)=0.8420, mean(all)=0.8016 [+0.0947]
  + MRF:       median(top-10)=0.8852, mean(top-10)=0.8920, median(all)=0.8445, mean(all)=0.8021 [+0.0005]
  TOTAL IMPROVEMENT (median top-10): +0.0952

================================================================================
Subject: NKI-RS-22-22
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 129976 vertices, 259948 faces
  Rendering 6 predefined views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 129976 vertices, 259948 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (40622 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (89596 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (82409 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (60325 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (40560 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (63598 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 40622/640000 (6.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=259591, num_faces=259948
      Valid probs shape: (37, 40622)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 40560/640000 (6.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=9361, max=259946, num_faces=259948
      Valid probs shape: (37, 40560)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 63598/640000 (9.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=259946, num_faces=259948
      Valid probs shape: (37, 63598)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 60325/640000 (9.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=19, max=258566, num_faces=259948
      Valid probs shape: (37, 60325)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 82409/640000 (12.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=259938, num_faces=259948
      Valid probs shape: (37, 82409)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 89596/640000 (14.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=17, max=259946, num_faces=259948
      Valid probs shape: (37, 89596)
    P stats: min=0.0000, max=1.0000, mean=0.0196
    Non-zero vertices: 94232/129976
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 35]
    Pred label counts: [    0 35744   623   699  2692     0  1487   910  3493  3973]
  Ground Truth Stats:
    Labels shape: (129976,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-22/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6520
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=33
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7883
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=33
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7886

  RESULTS:
  RAW:         median(top-10)=0.7954, mean(top-10)=0.7995, median(all)=0.7208, mean(all)=0.6520
  + SMOOTHING: median(top-10)=0.8986, mean(top-10)=0.9081, median(all)=0.8378, mean(all)=0.7883 [+0.1033]
  + MRF:       median(top-10)=0.8988, mean(top-10)=0.9086, median(all)=0.8380, mean(all)=0.7886 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.1034

================================================================================
Subject: NKI-RS-22-3
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 136714 vertices, 273424 faces
  Rendering 6 predefined views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 136714 vertices, 273424 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (45893 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (104259 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (96665 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (65161 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (46438 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (69652 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 45893/640000 (7.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=273165, num_faces=273424
      Valid probs shape: (37, 45893)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 46438/640000 (7.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=80834, max=273421, num_faces=273424
      Valid probs shape: (37, 46438)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 69652/640000 (10.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=72, max=273373, num_faces=273424
      Valid probs shape: (37, 69652)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 65161/640000 (10.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=11, max=272215, num_faces=273424
      Valid probs shape: (37, 65161)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 96665/640000 (15.1%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=7, max=273373, num_faces=273424
      Valid probs shape: (37, 96665)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 104259/640000 (16.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=273422, num_faces=273424
      Valid probs shape: (37, 104259)
    P stats: min=0.0000, max=1.0000, mean=0.0192
    Non-zero vertices: 97168/136714
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 39546   743  1005  2746     0  1973   839  3740  5981]
  Ground Truth Stats:
    Labels shape: (136714,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-3/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6457
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7788
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7792

  RESULTS:
  RAW:         median(top-10)=0.7850, mean(top-10)=0.7935, median(all)=0.6843, mean(all)=0.6457
  + SMOOTHING: median(top-10)=0.8778, mean(top-10)=0.8839, median(all)=0.8090, mean(all)=0.7788 [+0.0928]
  + MRF:       median(top-10)=0.8784, mean(top-10)=0.8843, median(all)=0.8104, mean(all)=0.7792 [+0.0005]
  TOTAL IMPROVEMENT (median top-10): +0.0933

================================================================================
Subject: NKI-RS-22-4
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 169171 vertices, 338338 faces
  Rendering 6 predefined views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 169171 vertices, 338338 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (42245 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (96402 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (89504 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (58527 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (43508 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (61307 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 42245/640000 (6.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=338014, num_faces=338338
      Valid probs shape: (37, 42245)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 43508/640000 (6.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=58771, max=338337, num_faces=338338
      Valid probs shape: (37, 43508)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 61307/640000 (9.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=26, max=338337, num_faces=338338
      Valid probs shape: (37, 61307)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 58527/640000 (9.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=338292, num_faces=338338
      Valid probs shape: (37, 58527)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 89504/640000 (14.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=23, max=338334, num_faces=338338
      Valid probs shape: (37, 89504)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 96402/640000 (15.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=13, max=338337, num_faces=338338
      Valid probs shape: (37, 96402)
    P stats: min=0.0000, max=1.0000, mean=0.0193
    Non-zero vertices: 120917/169171
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 48254   954  1064  3078     0  2163  1094  4030  5303]
  Ground Truth Stats:
    Labels shape: (169171,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-4/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6178
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7552
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7557

  RESULTS:
  RAW:         median(top-10)=0.7499, mean(top-10)=0.7675, median(all)=0.6661, mean(all)=0.6178
  + SMOOTHING: median(top-10)=0.8668, mean(top-10)=0.8744, median(all)=0.8061, mean(all)=0.7552 [+0.1170]
  + MRF:       median(top-10)=0.8669, mean(top-10)=0.8747, median(all)=0.8064, mean(all)=0.7557 [+0.0000]
  TOTAL IMPROVEMENT (median top-10): +0.1170

================================================================================
Subject: NKI-RS-22-5
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 138967 vertices, 277930 faces
  Rendering 6 predefined views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 138967 vertices, 277930 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (38796 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (94455 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (87120 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (61512 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (43181 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (64778 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 38796/640000 (6.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=277611, num_faces=277930
      Valid probs shape: (37, 38796)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 43181/640000 (6.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=78802, max=277861, num_faces=277930
      Valid probs shape: (37, 43181)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 64778/640000 (10.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=35, max=277926, num_faces=277930
      Valid probs shape: (37, 64778)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 61512/640000 (9.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=12, max=277686, num_faces=277930
      Valid probs shape: (37, 61512)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 87120/640000 (13.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=46, max=277927, num_faces=277930
      Valid probs shape: (37, 87120)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 94455/640000 (14.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=277917, num_faces=277930
      Valid probs shape: (37, 94455)
    P stats: min=0.0000, max=1.0000, mean=0.0197
    Non-zero vertices: 101203/138967
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 37764  1011   842  3340     0  1571   980  3392  3551]
  Ground Truth Stats:
    Labels shape: (138967,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-5/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6459
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=33
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7746
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=33
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7753

  RESULTS:
  RAW:         median(top-10)=0.7950, mean(top-10)=0.7991, median(all)=0.7177, mean(all)=0.6459
  + SMOOTHING: median(top-10)=0.8772, mean(top-10)=0.8887, median(all)=0.8223, mean(all)=0.7746 [+0.0822]
  + MRF:       median(top-10)=0.8774, mean(top-10)=0.8892, median(all)=0.8234, mean(all)=0.7753 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0824

================================================================================
Subject: NKI-RS-22-6
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 185380 vertices, 370756 faces
  Rendering 6 predefined views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 185380 vertices, 370756 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (37975 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (94997 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (87741 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (58267 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (37683 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (61644 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 37975/640000 (5.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=368665, num_faces=370756
      Valid probs shape: (37, 37975)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 37683/640000 (5.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=11526, max=370755, num_faces=370756
      Valid probs shape: (37, 37683)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 61644/640000 (9.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=159, max=370715, num_faces=370756
      Valid probs shape: (37, 61644)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 58267/640000 (9.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=10, max=370749, num_faces=370756
      Valid probs shape: (37, 58267)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 87741/640000 (13.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=15, max=370751, num_faces=370756
      Valid probs shape: (37, 87741)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 94997/640000 (14.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7, max=370715, num_faces=370756
      Valid probs shape: (37, 94997)
    P stats: min=0.0000, max=1.0000, mean=0.0184
    Non-zero vertices: 126450/185380
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 58930   774  1313  3082     0  2586   892  5006  6423]
  Ground Truth Stats:
    Labels shape: (185380,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-6/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6159
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7695
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7697

  RESULTS:
  RAW:         median(top-10)=0.7733, mean(top-10)=0.7860, median(all)=0.6740, mean(all)=0.6159
  + SMOOTHING: median(top-10)=0.8960, mean(top-10)=0.8998, median(all)=0.8327, mean(all)=0.7695 [+0.1227]
  + MRF:       median(top-10)=0.8961, mean(top-10)=0.9001, median(all)=0.8331, mean(all)=0.7697 [+0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.1228

================================================================================
Subject: NKI-RS-22-7
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 153181 vertices, 306358 faces
  Rendering 6 predefined views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 153181 vertices, 306358 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (45703 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (113298 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (105058 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (65545 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (45870 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (68386 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 45703/640000 (7.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=303782, num_faces=306358
      Valid probs shape: (37, 45703)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 45870/640000 (7.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=23996, max=306357, num_faces=306358
      Valid probs shape: (37, 45870)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 68386/640000 (10.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=679, max=306159, num_faces=306358
      Valid probs shape: (37, 68386)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 65545/640000 (10.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=12, max=306357, num_faces=306358
      Valid probs shape: (37, 65545)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 105058/640000 (16.4%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=15, max=306353, num_faces=306358
      Valid probs shape: (37, 105058)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 113298/640000 (17.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=7, max=306250, num_faces=306358
      Valid probs shape: (37, 113298)
    P stats: min=0.0000, max=1.0000, mean=0.0194
    Non-zero vertices: 109791/153181
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 43390   883   925  3561     0  2402  1007  3732  4025]
  Ground Truth Stats:
    Labels shape: (153181,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-7/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6472
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=33
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7854
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=33
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7858

  RESULTS:
  RAW:         median(top-10)=0.7789, mean(top-10)=0.7901, median(all)=0.7169, mean(all)=0.6472
  + SMOOTHING: median(top-10)=0.8967, mean(top-10)=0.9030, median(all)=0.8388, mean(all)=0.7854 [+0.1178]
  + MRF:       median(top-10)=0.8982, mean(top-10)=0.9039, median(all)=0.8389, mean(all)=0.7858 [+0.0015]
  TOTAL IMPROVEMENT (median top-10): +0.1193

================================================================================
Subject: NKI-RS-22-8
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 158049 vertices, 316094 faces
  Rendering 6 predefined views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 158049 vertices, 316094 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (45236 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (103105 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (95107 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (59871 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (41772 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (63833 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 45236/640000 (7.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=314971, num_faces=316094
      Valid probs shape: (37, 45236)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 41772/640000 (6.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=9468, max=316093, num_faces=316094
      Valid probs shape: (37, 41772)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 63833/640000 (10.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=47, max=316093, num_faces=316094
      Valid probs shape: (37, 63833)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 59871/640000 (9.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7, max=315774, num_faces=316094
      Valid probs shape: (37, 59871)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 95107/640000 (14.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=316092, num_faces=316094
      Valid probs shape: (37, 95107)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 103105/640000 (16.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=10, max=315966, num_faces=316094
      Valid probs shape: (37, 103105)
    P stats: min=0.0000, max=1.0000, mean=0.0195
    Non-zero vertices: 114321/158049
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 43728   555   902  2845     0  2191  1029  3828  4483]
  Ground Truth Stats:
    Labels shape: (158049,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-8/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6321
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7787
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7792

  RESULTS:
  RAW:         median(top-10)=0.7737, mean(top-10)=0.7790, median(all)=0.6848, mean(all)=0.6321
  + SMOOTHING: median(top-10)=0.8932, mean(top-10)=0.8965, median(all)=0.8214, mean(all)=0.7787 [+0.1194]
  + MRF:       median(top-10)=0.8933, mean(top-10)=0.8968, median(all)=0.8228, mean(all)=0.7792 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.1196

================================================================================
Subject: NKI-RS-22-9
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 129746 vertices, 259488 faces
  Rendering 6 predefined views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 129746 vertices, 259488 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (37843 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (95155 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (88008 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (57170 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (39294 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (60501 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 37843/640000 (5.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=258930, num_faces=259488
      Valid probs shape: (37, 37843)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 39294/640000 (6.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=12570, max=259486, num_faces=259488
      Valid probs shape: (37, 39294)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 60501/640000 (9.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=54, max=259438, num_faces=259488
      Valid probs shape: (37, 60501)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 57170/640000 (8.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=259482, num_faces=259488
      Valid probs shape: (37, 57170)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 88008/640000 (13.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=9, max=259485, num_faces=259488
      Valid probs shape: (37, 88008)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 95155/640000 (14.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=22, max=259427, num_faces=259488
      Valid probs shape: (37, 95155)
    P stats: min=0.0000, max=1.0000, mean=0.0198
    Non-zero vertices: 94822/129746
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 34924   797   695  2432     0  1819  1000  3301  4412]
  Ground Truth Stats:
    Labels shape: (129746,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-RS-22-9/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
    MRF iteration 5/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6581
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7880
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7882

  RESULTS:
  RAW:         median(top-10)=0.8081, mean(top-10)=0.8140, median(all)=0.7253, mean(all)=0.6581
  + SMOOTHING: median(top-10)=0.8912, mean(top-10)=0.9029, median(all)=0.8476, mean(all)=0.7880 [+0.0831]
  + MRF:       median(top-10)=0.8921, mean(top-10)=0.9032, median(all)=0.8483, mean(all)=0.7882 [+0.0009]
  TOTAL IMPROVEMENT (median top-10): +0.0840

================================================================================
Subject: NKI-TRT-20-1
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 143932 vertices, 287860 faces
  Rendering 6 predefined views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 143932 vertices, 287860 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (67888 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (137970 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (126140 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (80166 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (63930 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (83159 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 67888/640000 (10.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=286822, num_faces=287860
      Valid probs shape: (37, 67888)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 63930/640000 (10.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5447, max=287859, num_faces=287860
      Valid probs shape: (37, 63930)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 83159/640000 (13.0%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=231, max=287858, num_faces=287860
      Valid probs shape: (37, 83159)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 80166/640000 (12.5%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=11, max=287857, num_faces=287860
      Valid probs shape: (37, 80166)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 126140/640000 (19.7%)
      Probs stats: min=0.0000, max=0.9988, mean=0.0270
      Face IDs: min=2, max=287856, num_faces=287860
      Valid probs shape: (37, 126140)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 137970/640000 (21.6%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=1, max=287850, num_faces=287860
      Valid probs shape: (37, 137970)
    P stats: min=0.0000, max=0.9999, mean=0.0197
    Non-zero vertices: 104887/143932
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 39045   759   893  2827     0  1354   812  3692  5428]
  Ground Truth Stats:
    Labels shape: (143932,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-1/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6359
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7765
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7766

  RESULTS:
  RAW:         median(top-10)=0.7652, mean(top-10)=0.7724, median(all)=0.6810, mean(all)=0.6359
  + SMOOTHING: median(top-10)=0.8891, mean(top-10)=0.8857, median(all)=0.8198, mean(all)=0.7765 [+0.1240]
  + MRF:       median(top-10)=0.8893, mean(top-10)=0.8860, median(all)=0.8201, mean(all)=0.7766 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.1242

================================================================================
Subject: NKI-TRT-20-10
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 122978 vertices, 245952 faces
  Rendering 6 predefined views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 122978 vertices, 245952 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (34190 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (85586 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (80586 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (53598 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (34834 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (56948 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 34190/640000 (5.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=245557, num_faces=245952
      Valid probs shape: (37, 34190)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 34834/640000 (5.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5627, max=245951, num_faces=245952
      Valid probs shape: (37, 34834)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 56948/640000 (8.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=76, max=245951, num_faces=245952
      Valid probs shape: (37, 56948)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 53598/640000 (8.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7, max=245950, num_faces=245952
      Valid probs shape: (37, 53598)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 80586/640000 (12.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=69, max=245872, num_faces=245952
      Valid probs shape: (37, 80586)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 85586/640000 (13.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=245944, num_faces=245952
      Valid probs shape: (37, 85586)
    P stats: min=0.0000, max=1.0000, mean=0.0201
    Non-zero vertices: 91659/122978
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 31319   945   620  2214     0  1690   792  2995  4434]
  Ground Truth Stats:
    Labels shape: (122978,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-10/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6629
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7854
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7856

  RESULTS:
  RAW:         median(top-10)=0.8148, mean(top-10)=0.8216, median(all)=0.7275, mean(all)=0.6629
  + SMOOTHING: median(top-10)=0.9031, mean(top-10)=0.9038, median(all)=0.8267, mean(all)=0.7854 [+0.0883]
  + MRF:       median(top-10)=0.9033, mean(top-10)=0.9041, median(all)=0.8277, mean(all)=0.7856 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0885

================================================================================
Subject: NKI-TRT-20-11
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 146103 vertices, 292202 faces
  Rendering 6 predefined views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 146103 vertices, 292202 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (56077 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (114253 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (105159 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (72184 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (52179 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (76746 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 56077/640000 (8.8%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=0, max=290542, num_faces=292202
      Valid probs shape: (37, 56077)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 52179/640000 (8.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=13569, max=292200, num_faces=292202
      Valid probs shape: (37, 52179)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 76746/640000 (12.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=133, max=292138, num_faces=292202
      Valid probs shape: (37, 76746)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 72184/640000 (11.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=18, max=292001, num_faces=292202
      Valid probs shape: (37, 72184)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 105159/640000 (16.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=31, max=292198, num_faces=292202
      Valid probs shape: (37, 105159)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 114253/640000 (17.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=67, max=292199, num_faces=292202
      Valid probs shape: (37, 114253)
    P stats: min=0.0000, max=1.0000, mean=0.0201
    Non-zero vertices: 108571/146103
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 37532   467   957  3450     0  2046  1023  3459  3380]
  Ground Truth Stats:
    Labels shape: (146103,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-11/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6290
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7505
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7511

  RESULTS:
  RAW:         median(top-10)=0.7879, mean(top-10)=0.7974, median(all)=0.6586, mean(all)=0.6290
  + SMOOTHING: median(top-10)=0.8752, mean(top-10)=0.8834, median(all)=0.8046, mean(all)=0.7505 [+0.0873]
  + MRF:       median(top-10)=0.8765, mean(top-10)=0.8840, median(all)=0.8055, mean(all)=0.7511 [+0.0013]
  TOTAL IMPROVEMENT (median top-10): +0.0886

================================================================================
Subject: NKI-TRT-20-12
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 117868 vertices, 235732 faces
  Rendering 6 predefined views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 117868 vertices, 235732 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (52947 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (109775 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (101459 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (68499 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (50808 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (71967 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 52947/640000 (8.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=235274, num_faces=235732
      Valid probs shape: (37, 52947)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 50808/640000 (7.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5282, max=235731, num_faces=235732
      Valid probs shape: (37, 50808)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 71967/640000 (11.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=14, max=235731, num_faces=235732
      Valid probs shape: (37, 71967)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 68499/640000 (10.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=56, max=235591, num_faces=235732
      Valid probs shape: (37, 68499)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 101459/640000 (15.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8, max=235731, num_faces=235732
      Valid probs shape: (37, 101459)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 109775/640000 (17.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=14, max=235538, num_faces=235732
      Valid probs shape: (37, 109775)
    P stats: min=0.0000, max=1.0000, mean=0.0205
    Non-zero vertices: 89437/117868
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 28431   516   897  2743     0  2012   761  2954  4224]
  Ground Truth Stats:
    Labels shape: (117868,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-12/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6479
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7797
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7801

  RESULTS:
  RAW:         median(top-10)=0.8128, mean(top-10)=0.8137, median(all)=0.6998, mean(all)=0.6479
  + SMOOTHING: median(top-10)=0.8819, mean(top-10)=0.8878, median(all)=0.8260, mean(all)=0.7797 [+0.0690]
  + MRF:       median(top-10)=0.8813, mean(top-10)=0.8880, median(all)=0.8267, mean(all)=0.7801 [-0.0006]
  TOTAL IMPROVEMENT (median top-10): +0.0685

================================================================================
Subject: NKI-TRT-20-13
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 168760 vertices, 337516 faces
  Rendering 6 predefined views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 168760 vertices, 337516 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (44960 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (106173 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (97807 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (61870 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (40673 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (67331 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 44960/640000 (7.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=335666, num_faces=337516
      Valid probs shape: (37, 44960)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 40673/640000 (6.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3422, max=337515, num_faces=337516
      Valid probs shape: (37, 40673)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 67331/640000 (10.5%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=4, max=337514, num_faces=337516
      Valid probs shape: (37, 67331)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 61870/640000 (9.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=19, max=337513, num_faces=337516
      Valid probs shape: (37, 61870)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 97807/640000 (15.3%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=0, max=337504, num_faces=337516
      Valid probs shape: (37, 97807)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 106173/640000 (16.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=337515, num_faces=337516
      Valid probs shape: (37, 106173)
    P stats: min=0.0000, max=1.0000, mean=0.0190
    Non-zero vertices: 118673/168760
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 50087   842  1637  3326     0  2072   840  3854  5732]
  Ground Truth Stats:
    Labels shape: (168760,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-13/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6375
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7959
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7964

  RESULTS:
  RAW:         median(top-10)=0.7585, mean(top-10)=0.7814, median(all)=0.7024, mean(all)=0.6375
  + SMOOTHING: median(top-10)=0.9051, mean(top-10)=0.9072, median(all)=0.8206, mean(all)=0.7959 [+0.1466]
  + MRF:       median(top-10)=0.9058, mean(top-10)=0.9078, median(all)=0.8217, mean(all)=0.7964 [+0.0007]
  TOTAL IMPROVEMENT (median top-10): +0.1473

================================================================================
Subject: NKI-TRT-20-14
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 142909 vertices, 285814 faces
  Rendering 6 predefined views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 142909 vertices, 285814 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (38361 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (89283 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (82643 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (57466 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (38597 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (61279 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 38361/640000 (6.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=285292, num_faces=285814
      Valid probs shape: (37, 38361)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 38597/640000 (6.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=33050, max=285813, num_faces=285814
      Valid probs shape: (37, 38597)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 61279/640000 (9.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=11, max=285813, num_faces=285814
      Valid probs shape: (37, 61279)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 57466/640000 (9.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6, max=284740, num_faces=285814
      Valid probs shape: (37, 57466)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 82643/640000 (12.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7, max=285807, num_faces=285814
      Valid probs shape: (37, 82643)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 89283/640000 (14.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=285812, num_faces=285814
      Valid probs shape: (37, 89283)
    P stats: min=0.0000, max=1.0000, mean=0.0195
    Non-zero vertices: 102852/142909
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 40057   646  1170  2383     0  1996   913  3708  5289]
  Ground Truth Stats:
    Labels shape: (142909,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-14/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6485
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7857
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7863

  RESULTS:
  RAW:         median(top-10)=0.8027, mean(top-10)=0.8108, median(all)=0.7000, mean(all)=0.6485
  + SMOOTHING: median(top-10)=0.9036, mean(top-10)=0.9023, median(all)=0.8473, mean(all)=0.7857 [+0.1009]
  + MRF:       median(top-10)=0.9038, mean(top-10)=0.9024, median(all)=0.8479, mean(all)=0.7863 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.1011

================================================================================
Subject: NKI-TRT-20-15
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 133351 vertices, 266698 faces
  Rendering 6 predefined views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 133351 vertices, 266698 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (52553 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (117608 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (108238 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (67884 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (48951 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (72211 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 52553/640000 (8.2%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=0, max=264940, num_faces=266698
      Valid probs shape: (37, 52553)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 48951/640000 (7.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5986, max=266697, num_faces=266698
      Valid probs shape: (37, 48951)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 72211/640000 (11.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=15, max=266663, num_faces=266698
      Valid probs shape: (37, 72211)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 67884/640000 (10.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=36, max=266694, num_faces=266698
      Valid probs shape: (37, 67884)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 108238/640000 (16.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=6, max=266694, num_faces=266698
      Valid probs shape: (37, 108238)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 117608/640000 (18.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=40, max=266697, num_faces=266698
      Valid probs shape: (37, 117608)
    P stats: min=0.0000, max=1.0000, mean=0.0199
    Non-zero vertices: 98005/133351
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 35346   490  1048  2715     0  1568   848  3953  4068]
  Ground Truth Stats:
    Labels shape: (133351,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-15/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6484
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7851
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7857

  RESULTS:
  RAW:         median(top-10)=0.7796, mean(top-10)=0.7936, median(all)=0.7052, mean(all)=0.6484
  + SMOOTHING: median(top-10)=0.9050, mean(top-10)=0.9012, median(all)=0.8233, mean(all)=0.7851 [+0.1253]
  + MRF:       median(top-10)=0.9051, mean(top-10)=0.9017, median(all)=0.8237, mean(all)=0.7857 [+0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.1255

================================================================================
Subject: NKI-TRT-20-16
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 157852 vertices, 315700 faces
  Rendering 6 predefined views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 157852 vertices, 315700 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (46602 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (102366 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (94297 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (62479 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (43111 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (65928 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 46602/640000 (7.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=17, max=313592, num_faces=315700
      Valid probs shape: (37, 46602)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 43111/640000 (6.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=11363, max=315698, num_faces=315700
      Valid probs shape: (37, 43111)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 65928/640000 (10.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=18, max=315699, num_faces=315700
      Valid probs shape: (37, 65928)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 62479/640000 (9.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=23, max=315554, num_faces=315700
      Valid probs shape: (37, 62479)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 94297/640000 (14.7%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=120, max=315698, num_faces=315700
      Valid probs shape: (37, 94297)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 102366/640000 (16.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=4, max=315625, num_faces=315700
      Valid probs shape: (37, 102366)
    P stats: min=0.0000, max=1.0000, mean=0.0198
    Non-zero vertices: 115920/157852
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 41932   762   959  3442     0  1516   876  4153  4607]
  Ground Truth Stats:
    Labels shape: (157852,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-16/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6508
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7890
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7892

  RESULTS:
  RAW:         median(top-10)=0.7903, mean(top-10)=0.8002, median(all)=0.7315, mean(all)=0.6508
  + SMOOTHING: median(top-10)=0.8998, mean(top-10)=0.9050, median(all)=0.8332, mean(all)=0.7890 [+0.1095]
  + MRF:       median(top-10)=0.9005, mean(top-10)=0.9055, median(all)=0.8334, mean(all)=0.7892 [+0.0007]
  TOTAL IMPROVEMENT (median top-10): +0.1102

================================================================================
Subject: NKI-TRT-20-17
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 135896 vertices, 271788 faces
  Rendering 6 predefined views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 135896 vertices, 271788 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (39906 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (91766 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (85085 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (62551 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (41247 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (65301 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 39906/640000 (6.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=271433, num_faces=271788
      Valid probs shape: (37, 39906)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 41247/640000 (6.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=69015, max=271785, num_faces=271788
      Valid probs shape: (37, 41247)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 65301/640000 (10.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=91, max=271787, num_faces=271788
      Valid probs shape: (37, 65301)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 62551/640000 (9.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=271717, num_faces=271788
      Valid probs shape: (37, 62551)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 85085/640000 (13.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=271719, num_faces=271788
      Valid probs shape: (37, 85085)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 91766/640000 (14.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=271787, num_faces=271788
      Valid probs shape: (37, 91766)
    P stats: min=0.0000, max=1.0000, mean=0.0195
    Non-zero vertices: 97942/135896
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 37954   517  1096  2324     0  1475   952  3726  4521]
  Ground Truth Stats:
    Labels shape: (135896,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-17/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6206
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=33
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7505
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=33
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7510

  RESULTS:
  RAW:         median(top-10)=0.7797, mean(top-10)=0.7936, median(all)=0.6777, mean(all)=0.6206
  + SMOOTHING: median(top-10)=0.8916, mean(top-10)=0.8951, median(all)=0.8114, mean(all)=0.7505 [+0.1119]
  + MRF:       median(top-10)=0.8921, mean(top-10)=0.8955, median(all)=0.8130, mean(all)=0.7510 [+0.0005]
  TOTAL IMPROVEMENT (median top-10): +0.1123

================================================================================
Subject: NKI-TRT-20-18
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 132036 vertices, 264068 faces
  Rendering 6 predefined views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 132036 vertices, 264068 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (46068 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (105884 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (98544 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (64160 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (44177 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (69284 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 46068/640000 (7.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=262706, num_faces=264068
      Valid probs shape: (37, 46068)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 44177/640000 (6.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5409, max=264064, num_faces=264068
      Valid probs shape: (37, 44177)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 69284/640000 (10.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=26, max=264065, num_faces=264068
      Valid probs shape: (37, 69284)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 64160/640000 (10.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=31, max=263811, num_faces=264068
      Valid probs shape: (37, 64160)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 98544/640000 (15.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=110, max=264066, num_faces=264068
      Valid probs shape: (37, 98544)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 105884/640000 (16.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=11, max=264062, num_faces=264068
      Valid probs shape: (37, 105884)
    P stats: min=0.0000, max=1.0000, mean=0.0203
    Non-zero vertices: 98943/132036
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 33093   796   862  2953     0  1695   951  3320  4859]
  Ground Truth Stats:
    Labels shape: (132036,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-18/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6635
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7905
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7907

  RESULTS:
  RAW:         median(top-10)=0.7927, mean(top-10)=0.7957, median(all)=0.7110, mean(all)=0.6635
  + SMOOTHING: median(top-10)=0.8944, mean(top-10)=0.9021, median(all)=0.8382, mean(all)=0.7905 [+0.1016]
  + MRF:       median(top-10)=0.8945, mean(top-10)=0.9026, median(all)=0.8390, mean(all)=0.7907 [+0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.1017

================================================================================
Subject: NKI-TRT-20-19
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 131542 vertices, 263080 faces
  Rendering 6 predefined views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 131542 vertices, 263080 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (37626 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (86904 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (80874 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (58563 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (36440 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (61386 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 37626/640000 (5.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=11, max=262783, num_faces=263080
      Valid probs shape: (37, 37626)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 36440/640000 (5.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=75068, max=263079, num_faces=263080
      Valid probs shape: (37, 36440)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 61386/640000 (9.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=120, max=263078, num_faces=263080
      Valid probs shape: (37, 61386)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 58563/640000 (9.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=15, max=262998, num_faces=263080
      Valid probs shape: (37, 58563)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 80874/640000 (12.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=263070, num_faces=263080
      Valid probs shape: (37, 80874)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 86904/640000 (13.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7, max=263016, num_faces=263080
      Valid probs shape: (37, 86904)
    P stats: min=0.0000, max=1.0000, mean=0.0197
    Non-zero vertices: 95946/131542
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 35596   783   849  2337     0  1707   818  3665  4748]
  Ground Truth Stats:
    Labels shape: (131542,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-19/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6546
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7903
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7904

  RESULTS:
  RAW:         median(top-10)=0.7972, mean(top-10)=0.8022, median(all)=0.7109, mean(all)=0.6546
  + SMOOTHING: median(top-10)=0.9105, mean(top-10)=0.9115, median(all)=0.8359, mean(all)=0.7903 [+0.1133]
  + MRF:       median(top-10)=0.9111, mean(top-10)=0.9119, median(all)=0.8355, mean(all)=0.7904 [+0.0007]
  TOTAL IMPROVEMENT (median top-10): +0.1139

================================================================================
Subject: NKI-TRT-20-2
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 174172 vertices, 348340 faces
  Rendering 6 predefined views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 174172 vertices, 348340 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (39346 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (91664 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (85308 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (57480 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (40244 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (61084 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 39346/640000 (6.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=347747, num_faces=348340
      Valid probs shape: (37, 39346)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 40244/640000 (6.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7161, max=348339, num_faces=348340
      Valid probs shape: (37, 40244)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 61084/640000 (9.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=37, max=348339, num_faces=348340
      Valid probs shape: (37, 61084)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 57480/640000 (9.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=13, max=347576, num_faces=348340
      Valid probs shape: (37, 57480)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 85308/640000 (13.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=10, max=348339, num_faces=348340
      Valid probs shape: (37, 85308)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 91664/640000 (14.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=13, max=348273, num_faces=348340
      Valid probs shape: (37, 91664)
    P stats: min=0.0000, max=1.0000, mean=0.0185
    Non-zero vertices: 119267/174172
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 54905  1155  1084  3434     0  2044   992  4107  6282]
  Ground Truth Stats:
    Labels shape: (174172,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-2/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6283
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7820
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7826

  RESULTS:
  RAW:         median(top-10)=0.7605, mean(top-10)=0.7642, median(all)=0.6973, mean(all)=0.6283
  + SMOOTHING: median(top-10)=0.8843, mean(top-10)=0.8852, median(all)=0.8320, mean(all)=0.7820 [+0.1238]
  + MRF:       median(top-10)=0.8845, mean(top-10)=0.8856, median(all)=0.8326, mean(all)=0.7826 [+0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.1240

================================================================================
Subject: NKI-TRT-20-20
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 147840 vertices, 295676 faces
  Rendering 6 predefined views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 147840 vertices, 295676 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (57883 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (120896 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (110660 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (74517 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (51800 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (79035 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 57883/640000 (9.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=0, max=292902, num_faces=295676
      Valid probs shape: (37, 57883)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 51800/640000 (8.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=10504, max=295675, num_faces=295676
      Valid probs shape: (37, 51800)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 79035/640000 (12.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=31, max=295675, num_faces=295676
      Valid probs shape: (37, 79035)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 74517/640000 (11.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=97, max=295650, num_faces=295676
      Valid probs shape: (37, 74517)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 110660/640000 (17.3%)
      Probs stats: min=0.0000, max=0.9995, mean=0.0270
      Face IDs: min=20, max=295675, num_faces=295676
      Valid probs shape: (37, 110660)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 120896/640000 (18.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=34, max=295668, num_faces=295676
      Valid probs shape: (37, 120896)
    P stats: min=0.0000, max=1.0000, mean=0.0196
    Non-zero vertices: 107451/147840
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 40389   904   968  3715     0  1777   769  3342  3895]
  Ground Truth Stats:
    Labels shape: (147840,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-20/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
    MRF iteration 5/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6513
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7896
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7900

  RESULTS:
  RAW:         median(top-10)=0.7775, mean(top-10)=0.7844, median(all)=0.6825, mean(all)=0.6513
  + SMOOTHING: median(top-10)=0.8948, mean(top-10)=0.8955, median(all)=0.8410, mean(all)=0.7896 [+0.1173]
  + MRF:       median(top-10)=0.8953, mean(top-10)=0.8958, median(all)=0.8419, mean(all)=0.7900 [+0.0005]
  TOTAL IMPROVEMENT (median top-10): +0.1178

================================================================================
Subject: NKI-TRT-20-3
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 123781 vertices, 247558 faces
  Rendering 6 predefined views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 123781 vertices, 247558 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (57423 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (119159 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (109764 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (73742 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (55403 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (77075 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 57423/640000 (9.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=245403, num_faces=247558
      Valid probs shape: (37, 57423)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 55403/640000 (8.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=12715, max=247557, num_faces=247558
      Valid probs shape: (37, 55403)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 77075/640000 (12.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=32, max=247557, num_faces=247558
      Valid probs shape: (37, 77075)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 73742/640000 (11.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=40, max=245384, num_faces=247558
      Valid probs shape: (37, 73742)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 109764/640000 (17.2%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=13, max=247557, num_faces=247558
      Valid probs shape: (37, 109764)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 119159/640000 (18.6%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=39, max=247553, num_faces=247558
      Valid probs shape: (37, 119159)
    P stats: min=0.0000, max=1.0000, mean=0.0199
    Non-zero vertices: 90946/123781
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 32835   463   954  3051     0  1557   665  3285  3715]
  Ground Truth Stats:
    Labels shape: (123781,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-3/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6550
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7871
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7877

  RESULTS:
  RAW:         median(top-10)=0.7877, mean(top-10)=0.7879, median(all)=0.6927, mean(all)=0.6550
  + SMOOTHING: median(top-10)=0.8799, mean(top-10)=0.8852, median(all)=0.8380, mean(all)=0.7871 [+0.0922]
  + MRF:       median(top-10)=0.8801, mean(top-10)=0.8858, median(all)=0.8386, mean(all)=0.7877 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0925

================================================================================
Subject: NKI-TRT-20-4
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 158207 vertices, 316410 faces
  Rendering 6 predefined views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 158207 vertices, 316410 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (56591 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (115124 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (104032 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (73926 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (53553 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (76147 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 56591/640000 (8.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=3, max=313958, num_faces=316410
      Valid probs shape: (37, 56591)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 53553/640000 (8.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=5376, max=316408, num_faces=316410
      Valid probs shape: (37, 53553)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 76147/640000 (11.9%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=30, max=316396, num_faces=316410
      Valid probs shape: (37, 76147)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 73926/640000 (11.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=17, max=316407, num_faces=316410
      Valid probs shape: (37, 73926)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 104032/640000 (16.3%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=21, max=316396, num_faces=316410
      Valid probs shape: (37, 104032)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 115124/640000 (18.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=10, max=316409, num_faces=316410
      Valid probs shape: (37, 115124)
    P stats: min=0.0000, max=1.0000, mean=0.0190
    Non-zero vertices: 110945/158207
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 47262   586  1004  3188     0  2424   993  4112  4748]
  Ground Truth Stats:
    Labels shape: (158207,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-4/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
    MRF iteration 5/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6212
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7703
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7708

  RESULTS:
  RAW:         median(top-10)=0.7706, mean(top-10)=0.7739, median(all)=0.6797, mean(all)=0.6212
  + SMOOTHING: median(top-10)=0.8812, mean(top-10)=0.8841, median(all)=0.8171, mean(all)=0.7703 [+0.1106]
  + MRF:       median(top-10)=0.8819, mean(top-10)=0.8847, median(all)=0.8164, mean(all)=0.7708 [+0.0008]
  TOTAL IMPROVEMENT (median top-10): +0.1113

================================================================================
Subject: NKI-TRT-20-5
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 137753 vertices, 275502 faces
  Rendering 6 predefined views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 137753 vertices, 275502 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (45787 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (103903 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (96260 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (64915 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (46216 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (69483 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 45787/640000 (7.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=275331, num_faces=275502
      Valid probs shape: (37, 45787)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 46216/640000 (7.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=81515, max=275498, num_faces=275502
      Valid probs shape: (37, 46216)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 69483/640000 (10.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=89, max=275462, num_faces=275502
      Valid probs shape: (37, 69483)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 64915/640000 (10.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=233, max=273940, num_faces=275502
      Valid probs shape: (37, 64915)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 96260/640000 (15.0%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=0, max=275454, num_faces=275502
      Valid probs shape: (37, 96260)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 103903/640000 (16.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=275501, num_faces=275502
      Valid probs shape: (37, 103903)
    P stats: min=0.0000, max=1.0000, mean=0.0191
    Non-zero vertices: 97575/137753
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 40178   759  1102  2691     0  1956   848  3572  6074]
  Ground Truth Stats:
    Labels shape: (137753,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-5/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6487
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7835
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7840

  RESULTS:
  RAW:         median(top-10)=0.7811, mean(top-10)=0.7960, median(all)=0.6933, mean(all)=0.6487
  + SMOOTHING: median(top-10)=0.8861, mean(top-10)=0.8890, median(all)=0.8210, mean(all)=0.7835 [+0.1051]
  + MRF:       median(top-10)=0.8866, mean(top-10)=0.8893, median(all)=0.8211, mean(all)=0.7840 [+0.0004]
  TOTAL IMPROVEMENT (median top-10): +0.1055

================================================================================
Subject: NKI-TRT-20-6
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 158025 vertices, 316046 faces
  Rendering 6 predefined views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 158025 vertices, 316046 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (48945 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (109618 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (101944 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (64143 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (46253 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (68278 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 48945/640000 (7.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=313445, num_faces=316046
      Valid probs shape: (37, 48945)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 46253/640000 (7.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=9581, max=316045, num_faces=316046
      Valid probs shape: (37, 46253)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 68278/640000 (10.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=14, max=316045, num_faces=316046
      Valid probs shape: (37, 68278)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 64143/640000 (10.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=23, max=314903, num_faces=316046
      Valid probs shape: (37, 64143)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 101944/640000 (15.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=3, max=316041, num_faces=316046
      Valid probs shape: (37, 101944)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 109618/640000 (17.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=11, max=316043, num_faces=316046
      Valid probs shape: (37, 109618)
    P stats: min=0.0000, max=1.0000, mean=0.0197
    Non-zero vertices: 114991/158025
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 43034   689   830  3111     0  1726   927  4732  5894]
  Ground Truth Stats:
    Labels shape: (158025,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-6/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6477
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7961
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7963

  RESULTS:
  RAW:         median(top-10)=0.7756, mean(top-10)=0.7870, median(all)=0.7004, mean(all)=0.6477
  + SMOOTHING: median(top-10)=0.9003, mean(top-10)=0.9014, median(all)=0.8467, mean(all)=0.7961 [+0.1246]
  + MRF:       median(top-10)=0.9005, mean(top-10)=0.9017, median(all)=0.8462, mean(all)=0.7963 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.1249

================================================================================
Subject: NKI-TRT-20-7
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 145017 vertices, 290030 faces
  Rendering 6 predefined views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 145017 vertices, 290030 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (46206 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (100869 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (93314 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (65317 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (45944 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (69009 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 46206/640000 (7.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=287933, num_faces=290030
      Valid probs shape: (37, 46206)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 45944/640000 (7.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=12788, max=290029, num_faces=290030
      Valid probs shape: (37, 45944)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 69009/640000 (10.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=15, max=290021, num_faces=290030
      Valid probs shape: (37, 69009)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 65317/640000 (10.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=288169, num_faces=290030
      Valid probs shape: (37, 65317)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 93314/640000 (14.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=3, max=290029, num_faces=290030
      Valid probs shape: (37, 93314)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 100869/640000 (15.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=289950, num_faces=290030
      Valid probs shape: (37, 100869)
    P stats: min=0.0000, max=1.0000, mean=0.0187
    Non-zero vertices: 100151/145017
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 44866   797   987  3213     0  1664   804  3805  4090]
  Ground Truth Stats:
    Labels shape: (145017,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-7/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6274
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7837
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7844

  RESULTS:
  RAW:         median(top-10)=0.7809, mean(top-10)=0.7891, median(all)=0.6768, mean(all)=0.6274
  + SMOOTHING: median(top-10)=0.8810, mean(top-10)=0.8900, median(all)=0.8457, mean(all)=0.7837 [+0.1001]
  + MRF:       median(top-10)=0.8818, mean(top-10)=0.8905, median(all)=0.8475, mean(all)=0.7844 [+0.0007]
  TOTAL IMPROVEMENT (median top-10): +0.1008

================================================================================
Subject: NKI-TRT-20-8
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 147404 vertices, 294804 faces
  Rendering 6 predefined views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 147404 vertices, 294804 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (45232 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (95531 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (89220 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (60469 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (45913 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (65474 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 45232/640000 (7.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=294004, num_faces=294804
      Valid probs shape: (37, 45232)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 45913/640000 (7.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=9296, max=294773, num_faces=294804
      Valid probs shape: (37, 45913)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 65474/640000 (10.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=10, max=294801, num_faces=294804
      Valid probs shape: (37, 65474)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 60469/640000 (9.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=293206, num_faces=294804
      Valid probs shape: (37, 60469)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 89220/640000 (13.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=4, max=294572, num_faces=294804
      Valid probs shape: (37, 89220)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 95531/640000 (14.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=17, max=294762, num_faces=294804
      Valid probs shape: (37, 95531)
    P stats: min=0.0000, max=1.0000, mean=0.0193
    Non-zero vertices: 105164/147404
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 42240   865   727  2429     0  1920  1045  3864  5366]
  Ground Truth Stats:
    Labels shape: (147404,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-8/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6055
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7360
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7368

  RESULTS:
  RAW:         median(top-10)=0.7489, mean(top-10)=0.7651, median(all)=0.6739, mean(all)=0.6055
  + SMOOTHING: median(top-10)=0.8758, mean(top-10)=0.8828, median(all)=0.7729, mean(all)=0.7360 [+0.1268]
  + MRF:       median(top-10)=0.8765, mean(top-10)=0.8835, median(all)=0.7733, mean(all)=0.7368 [+0.0007]
  TOTAL IMPROVEMENT (median top-10): +0.1276

================================================================================
Subject: NKI-TRT-20-9
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 141802 vertices, 283600 faces
  Rendering 6 predefined views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 141802 vertices, 283600 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (43920 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (107762 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (100632 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (59095 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (42677 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (64692 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 43920/640000 (6.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=282393, num_faces=283600
      Valid probs shape: (37, 43920)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 42677/640000 (6.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=92555, max=283589, num_faces=283600
      Valid probs shape: (37, 42677)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 64692/640000 (10.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=84, max=283592, num_faces=283600
      Valid probs shape: (37, 64692)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 59095/640000 (9.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=31, max=283581, num_faces=283600
      Valid probs shape: (37, 59095)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 100632/640000 (15.7%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=12, max=283593, num_faces=283600
      Valid probs shape: (37, 100632)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 107762/640000 (16.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=89, max=283508, num_faces=283600
      Valid probs shape: (37, 107762)
    P stats: min=0.0000, max=1.0000, mean=0.0197
    Non-zero vertices: 103233/141802
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 38569   653   878  2689     0  1895   825  3883  5303]
  Ground Truth Stats:
    Labels shape: (141802,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/NKI-TRT-20-9/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6416
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7884
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7891

  RESULTS:
  RAW:         median(top-10)=0.7670, mean(top-10)=0.7859, median(all)=0.6805, mean(all)=0.6416
  + SMOOTHING: median(top-10)=0.8708, mean(top-10)=0.8833, median(all)=0.8316, mean(all)=0.7884 [+0.1037]
  + MRF:       median(top-10)=0.8712, mean(top-10)=0.8838, median(all)=0.8325, mean(all)=0.7891 [+0.0004]
  TOTAL IMPROVEMENT (median top-10): +0.1041

================================================================================
Subject: OASIS-TRT-20-1
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 149052 vertices, 298100 faces
  Rendering 6 predefined views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 149052 vertices, 298100 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (34898 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (83452 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (78012 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (55866 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (36923 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (58059 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 34898/640000 (5.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=297991, num_faces=298100
      Valid probs shape: (37, 34898)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 36923/640000 (5.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=106573, max=298095, num_faces=298100
      Valid probs shape: (37, 36923)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 58059/640000 (9.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6, max=297997, num_faces=298100
      Valid probs shape: (37, 58059)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 55866/640000 (8.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=298098, num_faces=298100
      Valid probs shape: (37, 55866)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 78012/640000 (12.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=19, max=298098, num_faces=298100
      Valid probs shape: (37, 78012)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 83452/640000 (13.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=298099, num_faces=298100
      Valid probs shape: (37, 83452)
    P stats: min=0.0000, max=1.0000, mean=0.0198
    Non-zero vertices: 109143/149052
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 39909   687  1244  3360     0  1793   923  3683  5062]
  Ground Truth Stats:
    Labels shape: (149052,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-1/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6432
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7827
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7829

  RESULTS:
  RAW:         median(top-10)=0.7900, mean(top-10)=0.7971, median(all)=0.7004, mean(all)=0.6432
  + SMOOTHING: median(top-10)=0.9017, mean(top-10)=0.9058, median(all)=0.8302, mean(all)=0.7827 [+0.1118]
  + MRF:       median(top-10)=0.9025, mean(top-10)=0.9061, median(all)=0.8300, mean(all)=0.7829 [+0.0008]
  TOTAL IMPROVEMENT (median top-10): +0.1125

================================================================================
Subject: OASIS-TRT-20-10
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 129540 vertices, 259076 faces
  Rendering 6 predefined views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 129540 vertices, 259076 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (39211 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (87219 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (80591 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (56268 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (41624 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (60533 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 39211/640000 (6.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=258993, num_faces=259076
      Valid probs shape: (37, 39211)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 41624/640000 (6.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=71807, max=259072, num_faces=259076
      Valid probs shape: (37, 41624)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 60533/640000 (9.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=49, max=258999, num_faces=259076
      Valid probs shape: (37, 60533)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 56268/640000 (8.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=258889, num_faces=259076
      Valid probs shape: (37, 56268)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 80591/640000 (12.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=259075, num_faces=259076
      Valid probs shape: (37, 80591)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 87219/640000 (13.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4, max=259070, num_faces=259076
      Valid probs shape: (37, 87219)
    P stats: min=0.0000, max=1.0000, mean=0.0198
    Non-zero vertices: 94975/129540
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 34565   624   889  3174     0  2016   897  3422  4269]
  Ground Truth Stats:
    Labels shape: (129540,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-10/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6634
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7961
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7964

  RESULTS:
  RAW:         median(top-10)=0.8191, mean(top-10)=0.8196, median(all)=0.7105, mean(all)=0.6634
  + SMOOTHING: median(top-10)=0.9057, mean(top-10)=0.9074, median(all)=0.8433, mean(all)=0.7961 [+0.0866]
  + MRF:       median(top-10)=0.9062, mean(top-10)=0.9077, median(all)=0.8440, mean(all)=0.7964 [+0.0005]
  TOTAL IMPROVEMENT (median top-10): +0.0871

================================================================================
Subject: OASIS-TRT-20-11
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 146531 vertices, 293058 faces
  Rendering 6 predefined views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 146531 vertices, 293058 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (41981 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (98450 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (90253 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (58376 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (42979 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (62441 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 41981/640000 (6.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=292530, num_faces=293058
      Valid probs shape: (37, 41981)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 42979/640000 (6.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=93611, max=293057, num_faces=293058
      Valid probs shape: (37, 42979)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 62441/640000 (9.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=95, max=293057, num_faces=293058
      Valid probs shape: (37, 62441)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 58376/640000 (9.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=11, max=291165, num_faces=293058
      Valid probs shape: (37, 58376)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 90253/640000 (14.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=293057, num_faces=293058
      Valid probs shape: (37, 90253)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 98450/640000 (15.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=6, max=293055, num_faces=293058
      Valid probs shape: (37, 98450)
    P stats: min=0.0000, max=1.0000, mean=0.0190
    Non-zero vertices: 103089/146531
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 43442   793   933  3044     0  2015   869  3491  5435]
  Ground Truth Stats:
    Labels shape: (146531,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-11/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6409
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7787
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7791

  RESULTS:
  RAW:         median(top-10)=0.7762, mean(top-10)=0.7951, median(all)=0.7123, mean(all)=0.6409
  + SMOOTHING: median(top-10)=0.8989, mean(top-10)=0.9019, median(all)=0.8507, mean(all)=0.7787 [+0.1228]
  + MRF:       median(top-10)=0.8999, mean(top-10)=0.9024, median(all)=0.8515, mean(all)=0.7791 [+0.0009]
  TOTAL IMPROVEMENT (median top-10): +0.1237

================================================================================
Subject: OASIS-TRT-20-12
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 144559 vertices, 289114 faces
  Rendering 6 predefined views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 144559 vertices, 289114 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (36042 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (88037 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (82442 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (54615 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (37958 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (57015 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 36042/640000 (5.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=288909, num_faces=289114
      Valid probs shape: (37, 36042)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 37958/640000 (5.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=90761, max=289112, num_faces=289114
      Valid probs shape: (37, 37958)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 57015/640000 (8.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=108, max=289113, num_faces=289114
      Valid probs shape: (37, 57015)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 54615/640000 (8.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=289067, num_faces=289114
      Valid probs shape: (37, 54615)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 82442/640000 (12.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=13, max=289113, num_faces=289114
      Valid probs shape: (37, 82442)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 88037/640000 (13.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=10, max=288987, num_faces=289114
      Valid probs shape: (37, 88037)
    P stats: min=0.0000, max=1.0000, mean=0.0194
    Non-zero vertices: 103539/144559
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 41020   801   941  2535     0  1141   802  4424  4442]
  Ground Truth Stats:
    Labels shape: (144559,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-12/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
    MRF iteration 5/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6305
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7648
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7652

  RESULTS:
  RAW:         median(top-10)=0.7781, mean(top-10)=0.7847, median(all)=0.6805, mean(all)=0.6305
  + SMOOTHING: median(top-10)=0.8715, mean(top-10)=0.8801, median(all)=0.8097, mean(all)=0.7648 [+0.0933]
  + MRF:       median(top-10)=0.8721, mean(top-10)=0.8806, median(all)=0.8099, mean(all)=0.7652 [+0.0006]
  TOTAL IMPROVEMENT (median top-10): +0.0940

================================================================================
Subject: OASIS-TRT-20-13
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 122339 vertices, 244674 faces
  Rendering 6 predefined views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 122339 vertices, 244674 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (45391 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (95734 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (89843 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (58036 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (42510 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (62395 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 45391/640000 (7.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=244285, num_faces=244674
      Valid probs shape: (37, 45391)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 42510/640000 (6.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1697, max=244670, num_faces=244674
      Valid probs shape: (37, 42510)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 62395/640000 (9.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=32, max=244673, num_faces=244674
      Valid probs shape: (37, 62395)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 58036/640000 (9.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=18, max=244598, num_faces=244674
      Valid probs shape: (37, 58036)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 89843/640000 (14.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=244671, num_faces=244674
      Valid probs shape: (37, 89843)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 95734/640000 (15.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=29, max=244603, num_faces=244674
      Valid probs shape: (37, 95734)
    P stats: min=0.0000, max=1.0000, mean=0.0198
    Non-zero vertices: 89756/122339
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 32583   610  1033  2467     0  1473   891  3415  4535]
  Ground Truth Stats:
    Labels shape: (122339,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-13/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6573
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7981
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7987

  RESULTS:
  RAW:         median(top-10)=0.7924, mean(top-10)=0.8013, median(all)=0.7097, mean(all)=0.6573
  + SMOOTHING: median(top-10)=0.8920, mean(top-10)=0.8957, median(all)=0.8396, mean(all)=0.7981 [+0.0997]
  + MRF:       median(top-10)=0.8925, mean(top-10)=0.8962, median(all)=0.8411, mean(all)=0.7987 [+0.0005]
  TOTAL IMPROVEMENT (median top-10): +0.1001

================================================================================
Subject: OASIS-TRT-20-14
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 128019 vertices, 256034 faces
  Rendering 6 predefined views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 128019 vertices, 256034 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (39254 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (90095 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (83820 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (57551 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (36944 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (59959 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 39254/640000 (6.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=255840, num_faces=256034
      Valid probs shape: (37, 39254)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 36944/640000 (5.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3602, max=256033, num_faces=256034
      Valid probs shape: (37, 36944)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 59959/640000 (9.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=39, max=256030, num_faces=256034
      Valid probs shape: (37, 59959)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 57551/640000 (9.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=34, max=255980, num_faces=256034
      Valid probs shape: (37, 57551)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 83820/640000 (13.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=256030, num_faces=256034
      Valid probs shape: (37, 83820)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 90095/640000 (14.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=17, max=255933, num_faces=256034
      Valid probs shape: (37, 90095)
    P stats: min=0.0000, max=1.0000, mean=0.0203
    Non-zero vertices: 96015/128019
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 32004   604  1085  2812     0  1739   897  3036  4759]
  Ground Truth Stats:
    Labels shape: (128019,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-14/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6861
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8088
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8094

  RESULTS:
  RAW:         median(top-10)=0.8325, mean(top-10)=0.8258, median(all)=0.7379, mean(all)=0.6861
  + SMOOTHING: median(top-10)=0.8945, mean(top-10)=0.8993, median(all)=0.8599, mean(all)=0.8088 [+0.0619]
  + MRF:       median(top-10)=0.8951, mean(top-10)=0.8999, median(all)=0.8601, mean(all)=0.8094 [+0.0006]
  TOTAL IMPROVEMENT (median top-10): +0.0625

================================================================================
Subject: OASIS-TRT-20-15
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 121081 vertices, 242158 faces
  Rendering 6 predefined views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 121081 vertices, 242158 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (37244 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (84927 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (78839 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (49967 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (35868 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (53730 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 37244/640000 (5.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=241986, num_faces=242158
      Valid probs shape: (37, 37244)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 35868/640000 (5.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1858, max=242087, num_faces=242158
      Valid probs shape: (37, 35868)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 53730/640000 (8.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=18, max=242156, num_faces=242158
      Valid probs shape: (37, 53730)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 49967/640000 (7.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=15, max=242153, num_faces=242158
      Valid probs shape: (37, 49967)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 78839/640000 (12.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8, max=242146, num_faces=242158
      Valid probs shape: (37, 78839)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 84927/640000 (13.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=8, max=242157, num_faces=242158
      Valid probs shape: (37, 84927)
    P stats: min=0.0000, max=1.0000, mean=0.0201
    Non-zero vertices: 90120/121081
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 30961   578   771  2082     0  1522   719  3437  4051]
  Ground Truth Stats:
    Labels shape: (121081,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-15/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6583
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7845
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7846

  RESULTS:
  RAW:         median(top-10)=0.8054, mean(top-10)=0.8126, median(all)=0.7275, mean(all)=0.6583
  + SMOOTHING: median(top-10)=0.8980, mean(top-10)=0.8988, median(all)=0.8457, mean(all)=0.7845 [+0.0926]
  + MRF:       median(top-10)=0.8992, mean(top-10)=0.8994, median(all)=0.8465, mean(all)=0.7846 [+0.0011]
  TOTAL IMPROVEMENT (median top-10): +0.0937

================================================================================
Subject: OASIS-TRT-20-16
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 137726 vertices, 275448 faces
  Rendering 6 predefined views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 137726 vertices, 275448 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (49473 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (114953 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (106146 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (70914 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (49269 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (70829 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 49473/640000 (7.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=273640, num_faces=275448
      Valid probs shape: (37, 49473)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 49269/640000 (7.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=13131, max=275447, num_faces=275448
      Valid probs shape: (37, 49269)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 70829/640000 (11.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=75, max=275343, num_faces=275448
      Valid probs shape: (37, 70829)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 70914/640000 (11.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=2, max=275447, num_faces=275448
      Valid probs shape: (37, 70914)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 106146/640000 (16.6%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=5, max=275443, num_faces=275448
      Valid probs shape: (37, 106146)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 114953/640000 (18.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=2, max=275447, num_faces=275448
      Valid probs shape: (37, 114953)
    P stats: min=0.0000, max=0.9999, mean=0.0197
    Non-zero vertices: 100584/137726
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 37142   717   796  2619     0  1252   821  3514  5177]
  Ground Truth Stats:
    Labels shape: (137726,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-16/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6433
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7676
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7680

  RESULTS:
  RAW:         median(top-10)=0.7746, mean(top-10)=0.7821, median(all)=0.7041, mean(all)=0.6433
  + SMOOTHING: median(top-10)=0.8828, mean(top-10)=0.8854, median(all)=0.8223, mean(all)=0.7676 [+0.1083]
  + MRF:       median(top-10)=0.8837, mean(top-10)=0.8861, median(all)=0.8229, mean(all)=0.7680 [+0.0008]
  TOTAL IMPROVEMENT (median top-10): +0.1091

================================================================================
Subject: OASIS-TRT-20-17
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 148245 vertices, 296486 faces
  Rendering 6 predefined views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 148245 vertices, 296486 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (51715 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (115408 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (107645 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (68068 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (50659 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (70910 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 51715/640000 (8.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1, max=294676, num_faces=296486
      Valid probs shape: (37, 51715)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 50659/640000 (7.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=8075, max=296485, num_faces=296486
      Valid probs shape: (37, 50659)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 70910/640000 (11.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=50, max=296485, num_faces=296486
      Valid probs shape: (37, 70910)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 68068/640000 (10.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=12, max=296430, num_faces=296486
      Valid probs shape: (37, 68068)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 107645/640000 (16.8%)
      Probs stats: min=0.0000, max=0.9993, mean=0.0270
      Face IDs: min=2, max=296396, num_faces=296486
      Valid probs shape: (37, 107645)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 115408/640000 (18.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=10, max=296477, num_faces=296486
      Valid probs shape: (37, 115408)
    P stats: min=0.0000, max=1.0000, mean=0.0197
    Non-zero vertices: 107816/148245
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 40429   572  1002  3255     0  1572  1045  3681  4650]
  Ground Truth Stats:
    Labels shape: (148245,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-17/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6391
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7718
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7725

  RESULTS:
  RAW:         median(top-10)=0.7674, mean(top-10)=0.7659, median(all)=0.6715, mean(all)=0.6391
  + SMOOTHING: median(top-10)=0.8628, mean(top-10)=0.8708, median(all)=0.8129, mean(all)=0.7718 [+0.0954]
  + MRF:       median(top-10)=0.8639, mean(top-10)=0.8713, median(all)=0.8141, mean(all)=0.7725 [+0.0010]
  TOTAL IMPROVEMENT (median top-10): +0.0965

================================================================================
Subject: OASIS-TRT-20-18
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 140676 vertices, 281348 faces
  Rendering 6 predefined views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 140676 vertices, 281348 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (40662 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (87949 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (81536 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (63250 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (38590 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (65363 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 40662/640000 (6.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=280399, num_faces=281348
      Valid probs shape: (37, 40662)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 38590/640000 (6.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=17190, max=281304, num_faces=281348
      Valid probs shape: (37, 38590)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 65363/640000 (10.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=16, max=281320, num_faces=281348
      Valid probs shape: (37, 65363)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 63250/640000 (9.9%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=281304, num_faces=281348
      Valid probs shape: (37, 63250)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 81536/640000 (12.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=9, max=281300, num_faces=281348
      Valid probs shape: (37, 81536)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 87949/640000 (13.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=281344, num_faces=281348
      Valid probs shape: (37, 87949)
    P stats: min=0.0000, max=1.0000, mean=0.0197
    Non-zero vertices: 102765/140676
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 37911   950   910  2821     0  1734   972  3406  5107]
  Ground Truth Stats:
    Labels shape: (140676,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-18/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6508
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7955
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7965

  RESULTS:
  RAW:         median(top-10)=0.7729, mean(top-10)=0.7818, median(all)=0.6991, mean(all)=0.6508
  + SMOOTHING: median(top-10)=0.8827, mean(top-10)=0.8882, median(all)=0.8281, mean(all)=0.7955 [+0.1098]
  + MRF:       median(top-10)=0.8830, mean(top-10)=0.8889, median(all)=0.8292, mean(all)=0.7965 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.1101

================================================================================
Subject: OASIS-TRT-20-19
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 114731 vertices, 229458 faces
  Rendering 6 predefined views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 114731 vertices, 229458 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (49919 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (108156 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (99940 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (68793 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (45569 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (70695 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 49919/640000 (7.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=196461, num_faces=229458
      Valid probs shape: (37, 49919)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 45569/640000 (7.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3859, max=229457, num_faces=229458
      Valid probs shape: (37, 45569)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 70695/640000 (11.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=8, max=229407, num_faces=229458
      Valid probs shape: (37, 70695)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 68793/640000 (10.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=12, max=229450, num_faces=229458
      Valid probs shape: (37, 68793)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 99940/640000 (15.6%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=2, max=229453, num_faces=229458
      Valid probs shape: (37, 99940)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 108156/640000 (16.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=10, max=229407, num_faces=229458
      Valid probs shape: (37, 108156)
    P stats: min=0.0000, max=0.9999, mean=0.0201
    Non-zero vertices: 85514/114731
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 29217   884   898  2224     0  1549   817  2776  4782]
  Ground Truth Stats:
    Labels shape: (114731,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-19/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6317
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7567
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7569

  RESULTS:
  RAW:         median(top-10)=0.7853, mean(top-10)=0.7981, median(all)=0.7162, mean(all)=0.6317
  + SMOOTHING: median(top-10)=0.8981, mean(top-10)=0.8970, median(all)=0.8178, mean(all)=0.7567 [+0.1128]
  + MRF:       median(top-10)=0.8985, mean(top-10)=0.8974, median(all)=0.8188, mean(all)=0.7569 [+0.0004]
  TOTAL IMPROVEMENT (median top-10): +0.1132

================================================================================
Subject: OASIS-TRT-20-2
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 153483 vertices, 306962 faces
  Rendering 6 predefined views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 153483 vertices, 306962 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (39581 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (99182 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (92163 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (61992 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (39869 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (64109 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 39581/640000 (6.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=305651, num_faces=306962
      Valid probs shape: (37, 39581)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 39869/640000 (6.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=4290, max=306960, num_faces=306962
      Valid probs shape: (37, 39869)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 64109/640000 (10.0%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=80, max=306957, num_faces=306962
      Valid probs shape: (37, 64109)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 61992/640000 (9.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=9, max=305551, num_faces=306962
      Valid probs shape: (37, 61992)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 92163/640000 (14.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=7, max=306960, num_faces=306962
      Valid probs shape: (37, 92163)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 99182/640000 (15.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=8, max=306958, num_faces=306962
      Valid probs shape: (37, 99182)
    P stats: min=0.0000, max=1.0000, mean=0.0193
    Non-zero vertices: 109328/153483
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 44155   931  1275  2860     0  1714   839  3604  5050]
  Ground Truth Stats:
    Labels shape: (153483,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-2/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
    MRF iteration 5/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6625
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8091
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8097

  RESULTS:
  RAW:         median(top-10)=0.7945, mean(top-10)=0.8158, median(all)=0.7065, mean(all)=0.6625
  + SMOOTHING: median(top-10)=0.9018, mean(top-10)=0.9063, median(all)=0.8613, mean(all)=0.8091 [+0.1072]
  + MRF:       median(top-10)=0.9033, mean(top-10)=0.9070, median(all)=0.8621, mean(all)=0.8097 [+0.0015]
  TOTAL IMPROVEMENT (median top-10): +0.1088

================================================================================
Subject: OASIS-TRT-20-20
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 124947 vertices, 249890 faces
  Rendering 6 predefined views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 124947 vertices, 249890 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (46936 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (103220 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (96293 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (73038 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (49086 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (74947 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 46936/640000 (7.3%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=248676, num_faces=249890
      Valid probs shape: (37, 46936)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 49086/640000 (7.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=13792, max=249889, num_faces=249890
      Valid probs shape: (37, 49086)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 74947/640000 (11.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=14, max=249888, num_faces=249890
      Valid probs shape: (37, 74947)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 73038/640000 (11.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=350, max=249719, num_faces=249890
      Valid probs shape: (37, 73038)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 96293/640000 (15.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=19, max=249889, num_faces=249890
      Valid probs shape: (37, 96293)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 103220/640000 (16.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=22, max=249875, num_faces=249890
      Valid probs shape: (37, 103220)
    P stats: min=0.0000, max=1.0000, mean=0.0199
    Non-zero vertices: 92038/124947
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 32909   615   890  2669     0  1304   766  3298  4426]
  Ground Truth Stats:
    Labels shape: (124947,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-20/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6592
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8048
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8054

  RESULTS:
  RAW:         median(top-10)=0.7767, mean(top-10)=0.7951, median(all)=0.7147, mean(all)=0.6592
  + SMOOTHING: median(top-10)=0.9008, mean(top-10)=0.8992, median(all)=0.8451, mean(all)=0.8048 [+0.1241]
  + MRF:       median(top-10)=0.9011, mean(top-10)=0.8997, median(all)=0.8461, mean(all)=0.8054 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.1245

================================================================================
Subject: OASIS-TRT-20-3
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 134843 vertices, 269682 faces
  Rendering 6 predefined views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 134843 vertices, 269682 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (39504 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (90470 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (84416 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (56195 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (36289 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (59553 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 39504/640000 (6.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=268605, num_faces=269682
      Valid probs shape: (37, 39504)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 36289/640000 (5.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=1702, max=269676, num_faces=269682
      Valid probs shape: (37, 36289)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 59553/640000 (9.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=28, max=269639, num_faces=269682
      Valid probs shape: (37, 59553)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 56195/640000 (8.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=2, max=269680, num_faces=269682
      Valid probs shape: (37, 56195)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 84416/640000 (13.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=41, max=269677, num_faces=269682
      Valid probs shape: (37, 84416)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 90470/640000 (14.1%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=43, max=269639, num_faces=269682
      Valid probs shape: (37, 90470)
    P stats: min=0.0000, max=1.0000, mean=0.0201
    Non-zero vertices: 100508/134843
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 34335   875   964  2603     0  2114   816  3367  5230]
  Ground Truth Stats:
    Labels shape: (134843,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-3/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6502
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7787
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7794

  RESULTS:
  RAW:         median(top-10)=0.7842, mean(top-10)=0.7977, median(all)=0.7061, mean(all)=0.6502
  + SMOOTHING: median(top-10)=0.8852, mean(top-10)=0.8883, median(all)=0.8392, mean(all)=0.7787 [+0.1010]
  + MRF:       median(top-10)=0.8853, mean(top-10)=0.8885, median(all)=0.8391, mean(all)=0.7794 [+0.0001]
  TOTAL IMPROVEMENT (median top-10): +0.1011

================================================================================
Subject: OASIS-TRT-20-4
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 138101 vertices, 276198 faces
  Rendering 6 predefined views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 138101 vertices, 276198 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (44423 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (105060 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (96489 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (62926 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (42565 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (64568 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 44423/640000 (6.9%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=0, max=275053, num_faces=276198
      Valid probs shape: (37, 44423)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 42565/640000 (6.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=14853, max=276197, num_faces=276198
      Valid probs shape: (37, 42565)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 64568/640000 (10.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=55, max=276197, num_faces=276198
      Valid probs shape: (37, 64568)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 62926/640000 (9.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=12, max=276085, num_faces=276198
      Valid probs shape: (37, 62926)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 96489/640000 (15.1%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=2, max=276196, num_faces=276198
      Valid probs shape: (37, 96489)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 105060/640000 (16.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=276197, num_faces=276198
      Valid probs shape: (37, 105060)
    P stats: min=0.0000, max=1.0000, mean=0.0196
    Non-zero vertices: 100044/138101
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 38057   381   796  2544     0  1448   876  3339  4759]
  Ground Truth Stats:
    Labels shape: (138101,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-4/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6443
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7764
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7769

  RESULTS:
  RAW:         median(top-10)=0.7938, mean(top-10)=0.8028, median(all)=0.7167, mean(all)=0.6443
  + SMOOTHING: median(top-10)=0.9016, mean(top-10)=0.9026, median(all)=0.8471, mean(all)=0.7764 [+0.1078]
  + MRF:       median(top-10)=0.9021, mean(top-10)=0.9029, median(all)=0.8475, mean(all)=0.7769 [+0.0004]
  TOTAL IMPROVEMENT (median top-10): +0.1082

================================================================================
Subject: OASIS-TRT-20-5
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 151342 vertices, 302680 faces
  Rendering 6 predefined views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 151342 vertices, 302680 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (47526 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (107952 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (99043 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (66833 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (48800 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (69896 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 47526/640000 (7.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=300478, num_faces=302680
      Valid probs shape: (37, 47526)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 48800/640000 (7.6%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=8895, max=302677, num_faces=302680
      Valid probs shape: (37, 48800)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 69896/640000 (10.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=302676, num_faces=302680
      Valid probs shape: (37, 69896)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 66833/640000 (10.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=302524, num_faces=302680
      Valid probs shape: (37, 66833)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 99043/640000 (15.5%)
      Probs stats: min=0.0000, max=0.9997, mean=0.0270
      Face IDs: min=7, max=302679, num_faces=302680
      Valid probs shape: (37, 99043)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 107952/640000 (16.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=5, max=302626, num_faces=302680
      Valid probs shape: (37, 107952)
    P stats: min=0.0000, max=1.0000, mean=0.0195
    Non-zero vertices: 109267/151342
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 42075   914   748  2820     0  1804   712  4792  5041]
  Ground Truth Stats:
    Labels shape: (151342,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-5/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
    MRF iteration 5/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6360
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7587
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7585

  RESULTS:
  RAW:         median(top-10)=0.7772, mean(top-10)=0.7905, median(all)=0.7048, mean(all)=0.6360
  + SMOOTHING: median(top-10)=0.8890, mean(top-10)=0.8931, median(all)=0.8209, mean(all)=0.7587 [+0.1119]
  + MRF:       median(top-10)=0.8895, mean(top-10)=0.8934, median(all)=0.8212, mean(all)=0.7585 [+0.0005]
  TOTAL IMPROVEMENT (median top-10): +0.1124

================================================================================
Subject: OASIS-TRT-20-6
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 152023 vertices, 304042 faces
  Rendering 6 predefined views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 152023 vertices, 304042 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (40314 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (94482 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (87724 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (60176 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (38682 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (64030 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 40314/640000 (6.3%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=303158, num_faces=304042
      Valid probs shape: (37, 40314)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 38682/640000 (6.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=11916, max=304041, num_faces=304042
      Valid probs shape: (37, 38682)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 64030/640000 (10.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=363, max=303949, num_faces=304042
      Valid probs shape: (37, 64030)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 60176/640000 (9.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=303982, num_faces=304042
      Valid probs shape: (37, 60176)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 87724/640000 (13.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=21, max=304041, num_faces=304042
      Valid probs shape: (37, 87724)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 94482/640000 (14.8%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=3, max=304039, num_faces=304042
      Valid probs shape: (37, 94482)
    P stats: min=0.0000, max=1.0000, mean=0.0193
    Non-zero vertices: 108825/152023
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 43198   777  1117  3798     0  1280  1029  3599  4713]
  Ground Truth Stats:
    Labels shape: (152023,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-6/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6533
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7948
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7953

  RESULTS:
  RAW:         median(top-10)=0.7906, mean(top-10)=0.7977, median(all)=0.7048, mean(all)=0.6533
  + SMOOTHING: median(top-10)=0.8871, mean(top-10)=0.8881, median(all)=0.8508, mean(all)=0.7948 [+0.0964]
  + MRF:       median(top-10)=0.8873, mean(top-10)=0.8886, median(all)=0.8515, mean(all)=0.7953 [+0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.0967

================================================================================
Subject: OASIS-TRT-20-7
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 142612 vertices, 285220 faces
  Rendering 6 predefined views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 142612 vertices, 285220 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (49637 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (109534 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (101356 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (68179 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (44776 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (70082 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 49637/640000 (7.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=283734, num_faces=285220
      Valid probs shape: (37, 49637)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 44776/640000 (7.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=6557, max=285219, num_faces=285220
      Valid probs shape: (37, 44776)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 70082/640000 (11.0%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=75, max=285162, num_faces=285220
      Valid probs shape: (37, 70082)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 68179/640000 (10.7%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=111, max=285217, num_faces=285220
      Valid probs shape: (37, 68179)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 101356/640000 (15.8%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=3, max=285212, num_faces=285220
      Valid probs shape: (37, 101356)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 109534/640000 (17.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=1, max=284967, num_faces=285220
      Valid probs shape: (37, 109534)
    P stats: min=0.0000, max=1.0000, mean=0.0201
    Non-zero vertices: 106137/142612
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 36475   661   777  2953     0  1511   954  3820  5427]
  Ground Truth Stats:
    Labels shape: (142612,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-7/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6661
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8038
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.8043

  RESULTS:
  RAW:         median(top-10)=0.8014, mean(top-10)=0.7989, median(all)=0.7172, mean(all)=0.6661
  + SMOOTHING: median(top-10)=0.8977, mean(top-10)=0.9030, median(all)=0.8427, mean(all)=0.8038 [+0.0962]
  + MRF:       median(top-10)=0.8979, mean(top-10)=0.9035, median(all)=0.8433, mean(all)=0.8043 [+0.0002]
  TOTAL IMPROVEMENT (median top-10): +0.0964

================================================================================
Subject: OASIS-TRT-20-8
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 139571 vertices, 279138 faces
  Rendering 6 predefined views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 139571 vertices, 279138 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (53574 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (119555 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (109685 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (67837 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (53622 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (73282 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 53574/640000 (8.4%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=0, max=276754, num_faces=279138
      Valid probs shape: (37, 53574)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 53622/640000 (8.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=7805, max=279137, num_faces=279138
      Valid probs shape: (37, 53622)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 73282/640000 (11.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=260, max=279072, num_faces=279138
      Valid probs shape: (37, 73282)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 67837/640000 (10.6%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=279132, num_faces=279138
      Valid probs shape: (37, 67837)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 109685/640000 (17.1%)
      Probs stats: min=0.0000, max=0.9996, mean=0.0270
      Face IDs: min=5, max=279137, num_faces=279138
      Valid probs shape: (37, 109685)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 119555/640000 (18.7%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=3, max=279070, num_faces=279138
      Valid probs shape: (37, 119555)
    P stats: min=0.0000, max=1.0000, mean=0.0195
    Non-zero vertices: 100910/139571
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 38661   670  1126  2866     0  1386   668  4199  4621]
  Ground Truth Stats:
    Labels shape: (139571,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-8/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6480
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7809
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7816

  RESULTS:
  RAW:         median(top-10)=0.7876, mean(top-10)=0.8017, median(all)=0.7085, mean(all)=0.6480
  + SMOOTHING: median(top-10)=0.8960, mean(top-10)=0.9043, median(all)=0.8389, mean(all)=0.7809 [+0.1084]
  + MRF:       median(top-10)=0.8960, mean(top-10)=0.9048, median(all)=0.8390, mean(all)=0.7816 [-0.0000]
  TOTAL IMPROVEMENT (median top-10): +0.1083

================================================================================
Subject: OASIS-TRT-20-9
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 134960 vertices, 269916 faces
  Rendering 6 predefined views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 134960 vertices, 269916 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (39896 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (92848 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (86201 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (60492 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (41512 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (63225 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 39896/640000 (6.2%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=0, max=269455, num_faces=269916
      Valid probs shape: (37, 39896)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 41512/640000 (6.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=99479, max=269911, num_faces=269916
      Valid probs shape: (37, 41512)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 63225/640000 (9.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=17, max=269914, num_faces=269916
      Valid probs shape: (37, 63225)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 60492/640000 (9.5%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=14, max=269678, num_faces=269916
      Valid probs shape: (37, 60492)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 86201/640000 (13.5%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=1, max=269910, num_faces=269916
      Valid probs shape: (37, 86201)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 92848/640000 (14.5%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=8, max=269805, num_faces=269916
      Valid probs shape: (37, 92848)
    P stats: min=0.0000, max=1.0000, mean=0.0197
    Non-zero vertices: 98173/134960
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 36787   647   802  2412     0  1588   876  3621  3867]
  Ground Truth Stats:
    Labels shape: (134960,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/OASIS-TRT-20-9/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6561
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7984
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7985

  RESULTS:
  RAW:         median(top-10)=0.7762, mean(top-10)=0.7943, median(all)=0.7116, mean(all)=0.6561
  + SMOOTHING: median(top-10)=0.9085, mean(top-10)=0.9116, median(all)=0.8324, mean(all)=0.7984 [+0.1324]
  + MRF:       median(top-10)=0.9083, mean(top-10)=0.9119, median(all)=0.8326, mean(all)=0.7985 [-0.0003]
  TOTAL IMPROVEMENT (median top-10): +0.1321

================================================================================
Subject: Twins-2-1
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 145069 vertices, 290134 faces
  Rendering 6 predefined views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 145069 vertices, 290134 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (58252 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (123953 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (113508 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (71956 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (55547 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (75840 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 58252/640000 (9.1%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=288530, num_faces=290134
      Valid probs shape: (37, 58252)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 55547/640000 (8.7%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=12072, max=290132, num_faces=290134
      Valid probs shape: (37, 55547)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 75840/640000 (11.8%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=416, max=290133, num_faces=290134
      Valid probs shape: (37, 75840)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 71956/640000 (11.2%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=3, max=287839, num_faces=290134
      Valid probs shape: (37, 71956)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 113508/640000 (17.7%)
      Probs stats: min=0.0000, max=0.9994, mean=0.0270
      Face IDs: min=1, max=290132, num_faces=290134
      Valid probs shape: (37, 113508)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 123953/640000 (19.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=7, max=290133, num_faces=290134
      Valid probs shape: (37, 123953)
    P stats: min=0.0000, max=1.0000, mean=0.0199
    Non-zero vertices: 106760/145069
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 38309   716   930  3716     0  1450   991  4116  4660]
  Ground Truth Stats:
    Labels shape: (145069,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/Twins-2-1/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
    MRF iteration 4/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6426
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7759
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7761

  RESULTS:
  RAW:         median(top-10)=0.7908, mean(top-10)=0.7951, median(all)=0.7050, mean(all)=0.6426
  + SMOOTHING: median(top-10)=0.8932, mean(top-10)=0.8885, median(all)=0.8254, mean(all)=0.7759 [+0.1024]
  + MRF:       median(top-10)=0.8936, mean(top-10)=0.8886, median(all)=0.8249, mean(all)=0.7761 [+0.0004]
  TOTAL IMPROVEMENT (median top-10): +0.1028

================================================================================
Subject: Twins-2-2
================================================================================
  Step 0: Generating predictions with V2 model (arbitrary views)...
  Mesh: 149751 vertices, 299498 faces
  Rendering 6 predefined views with PyTorch3D...
  [PyTorch3D] Starting raycasting...
  [PyTorch3D] Using device: cuda:0
  [PyTorch3D] Loading mesh data...
  [PyTorch3D] Mesh: 149751 vertices, 299498 faces
  [PyTorch3D] Uploading mesh to GPU...
  [PyTorch3D] Computing face normals...
  [PyTorch3D] Computing camera matrices...
  [PyTorch3D] Processing 6 views (canonical, no augmentation)...
  [PyTorch3D] Rendering view 1/6: Front... Done! (72774 valid pixels)
  [PyTorch3D] Rendering view 2/6: Bottom... Done! (140891 valid pixels)
  [PyTorch3D] Rendering view 3/6: Top... Done! (128357 valid pixels)
  [PyTorch3D] Rendering view 4/6: Right... Done! (80531 valid pixels)
  [PyTorch3D] Rendering view 5/6: Back... Done! (66855 valid pixels)
  [PyTorch3D] Rendering view 6/6: Left... Done! (82607 valid pixels)
  [PyTorch3D] Raycasting complete!
  Generating predictions for 6 views (continuous camera pose)...
    ✓ Front (pose=(0.0, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 72774/640000 (11.4%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=0, max=298357, num_faces=299498
      Valid probs shape: (37, 72774)
    ✓ Back (pose=(3.141592653589793, 0.0, 0.0)): shape (37, 800, 800)
      Valid pixels: 66855/640000 (10.4%)
      Probs stats: min=0.0000, max=1.0000, mean=0.0270
      Face IDs: min=11300, max=299460, num_faces=299498
      Valid probs shape: (37, 66855)
    ✓ Left (pose=(0.0, -1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 82607/640000 (12.9%)
      Probs stats: min=0.0000, max=0.9999, mean=0.0270
      Face IDs: min=202, max=299497, num_faces=299498
      Valid probs shape: (37, 82607)
    ✓ Right (pose=(0.0, 1.5707963267948966, 0.0)): shape (37, 800, 800)
      Valid pixels: 80531/640000 (12.6%)
      Probs stats: min=0.0000, max=0.9995, mean=0.0270
      Face IDs: min=3, max=298358, num_faces=299498
      Valid probs shape: (37, 80531)
    ✓ Top (pose=(-1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 128357/640000 (20.1%)
      Probs stats: min=0.0000, max=0.9995, mean=0.0270
      Face IDs: min=1, max=299256, num_faces=299498
      Valid probs shape: (37, 128357)
    ✓ Bottom (pose=(1.5707963267948966, 0.0, 3.141592653589793)): shape (37, 800, 800)
      Valid pixels: 140891/640000 (22.0%)
      Probs stats: min=0.0000, max=0.9998, mean=0.0270
      Face IDs: min=5, max=299497, num_faces=299498
      Valid probs shape: (37, 140891)
    P stats: min=0.0000, max=1.0000, mean=0.0197
    Non-zero vertices: 109275/149751
  ✓ Aggregation complete
  Predicted Labels Distribution:
    Unique pred_raw labels: [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    Pred label counts: [    0 40476   419   919  3245     0  1591   701  3953  5136]
  Ground Truth Stats:
    Labels shape: (149751,)
    Unique labels: [-1  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35]
    CTab len: 36
  ✓ Raw prediction saved to: /autofs/space/ballarat_004/users/np341/mindboggle2/Twins-2-2/pred_conditioned_v2_pytorch3d
  Building vertex adjacency...
  Step 1: Smoothing probabilities (20 iter, α=0.75)...
    Smoothing iteration 0/20...
    Smoothing iteration 5/20...
    Smoothing iteration 10/20...
    Smoothing iteration 15/20...
  ✓ Smoothing complete
  Step 2: MRF refinement (β=0.1)...
    MRF iteration 1/5...
    MRF iteration 2/5...
    MRF iteration 3/5...
  ✓ MRF refinement complete
    Dice calculation debug:
      Pred labels: min=0, max=35, unique=35
      GT labels:   min=-1, max=35, unique=35
      Computed 35 valid scores. Mean: 0.6195
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7462
    Dice calculation debug:
      Pred labels: min=1, max=35, unique=34
      GT labels:   min=-1, max=35, unique=35
      Computed 34 valid scores. Mean: 0.7467

  RESULTS:
  RAW:         median(top-10)=0.7756, mean(top-10)=0.7825, median(all)=0.6631, mean(all)=0.6195
  + SMOOTHING: median(top-10)=0.8820, mean(top-10)=0.8800, median(all)=0.7800, mean(all)=0.7462 [+0.1064]
  + MRF:       median(top-10)=0.8830, mean(top-10)=0.8805, median(all)=0.7799, mean(all)=0.7467 [+0.0009]
  TOTAL IMPROVEMENT (median top-10): +0.1073

================================================================================
AGGREGATE RESULTS ACROSS ALL TEST SUBJECTS
================================================================================
Number of subjects: 101

RAW PREDICTIONS:
  Median(top-10):  0.7844 ± 0.0155  (min: 0.7489, max: 0.8325)
  Mean(top-10):    0.7930 ± 0.0139  (min: 0.7639, max: 0.8258)
  Median(all):     0.7005 ± 0.0162  (min: 0.6586, max: 0.7379)
  Mean(all):       0.6444 ± 0.0143  (min: 0.5845, max: 0.6861)

+ SMOOTHING (α=0.75, 20 iter):
  Median(top-10):  0.8924 ± 0.0107  (min: 0.8602, max: 0.9105)
  Mean(top-10):    0.8958 ± 0.0097  (min: 0.8641, max: 0.9116)
  Median(all):     0.8299 ± 0.0170  (min: 0.7729, max: 0.8613)
  Mean(all):       0.7816 ± 0.0167  (min: 0.7011, max: 0.8131)
  Improvement:     median(top-10) +0.1079, mean(all) +0.1373

+ MRF (β=0.1, 5 iter):
  Median(top-10):  0.8928 ± 0.0107  (min: 0.8604, max: 0.9111)
  Mean(top-10):    0.8962 ± 0.0097  (min: 0.8645, max: 0.9119)
  Median(all):     0.8305 ± 0.0170  (min: 0.7733, max: 0.8621)
  Mean(all):       0.7820 ± 0.0167  (min: 0.7014, max: 0.8132)
  Improvement:     median(top-10) +0.0004, mean(all) +0.0004

TOTAL IMPROVEMENT (RAW → MRF):
  Median(top-10):  +0.1084
  Mean(top-10):    +0.1032
  Median(all):     +0.1299
  Mean(all):       +0.1377
================================================================================
